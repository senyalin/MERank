<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>[2205.05625] Quantum Self-Attention Neural Networks for Text Classification</title><meta property="og:description" content="An emerging direction of quantum computing is to establish meaningful quantum applications in various fields of artificial intelligence, including natural language processing (NLP). Although some efforts based on synta…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Quantum Self-Attention Neural Networks for Text Classification">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Quantum Self-Attention Neural Networks for Text Classification">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2205.05625">

<!--Generated on Wed Jul 13 02:06:12 2022 by LaTeXML (version 0.8.6) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="dark";
    var current_theme = localStorage.getItem("halloween_theme");
    if(current_theme){
      if(current_theme == "light"){
        theme = "light";
      } }
    else if(!window.matchMedia) { return false; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("halloween_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("halloween_theme", "dark"); }
      else {
        localStorage.setItem("halloween_theme", "light"); } }
    else {
        localStorage.setItem("halloween_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv.0.7.5.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.1.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Quantum Self-Attention Neural Networks 
<br class="ltx_break">for Text Classification</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Guangxi Li
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">Institute for Quantum Computing, Baidu Research, Beijing 100193, China
</span>
<span class="ltx_contact ltx_role_affiliation">Centre for Quantum Software and Information, University of Technology Sydney, NSW 2007, Australia
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Xuanqiang Zhao
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">Institute for Quantum Computing, Baidu Research, Beijing 100193, China
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Xin Wang
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">Institute for Quantum Computing, Baidu Research, Beijing 100193, China
</span></span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id1.id1" class="ltx_p">An emerging direction of quantum computing is to establish meaningful quantum applications in various fields of artificial intelligence, including natural language processing (NLP). Although some efforts based on syntactic analysis have opened the door to research in Quantum NLP (QNLP), limitations such as heavy syntactic preprocessing and syntax-dependent network architecture make them impracticable on larger and real-world data sets. In this paper, we propose a new simple network architecture, called the quantum self-attention neural network (QSANN), which can make up for these limitations. Specifically, we introduce the self-attention mechanism into quantum neural networks and then utilize a Gaussian projected quantum self-attention serving as a sensible quantum version of self-attention. As a result, QSANN is effective and scalable on larger data sets and has the desirable property of being implementable on near-term quantum devices. In particular, our QSANN outperforms the best existing QNLP model based on syntactic analysis as well as a simple classical self-attention neural network in numerical experiments of text classification tasks on public data sets. We further show that our method exhibits robustness to low-level quantum noises.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p"><span id="S1.p1.1.1" class="ltx_text ltx_font_italic">Quantum computing</span> is a promising paradigm <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite> for fast computations that can provide substantial advantages in solving valuable problems <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>. With major academic and industry efforts on developing quantum algorithms and quantum hardware, it has led to an increasing number of powerful applications in areas including optimization <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>, cryptography <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>, chemistry <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>, <a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>, and machine learning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>, <a href="#bib.bib12" title="" class="ltx_ref">12</a>, <a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Quantum devices available currently known as the <span id="S1.p2.1.1" class="ltx_text ltx_font_italic">noisy intermediate-scale quantum</span> (NISQ) devices <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> have up to a few hundred physical qubits. They are affected by coherent and incoherent noise, making the practical implementation of many advantageous quantum algorithms less feasible. But such devices with 50-100 qubits already allow one to achieve quantum advantage against the most powerful classical supercomputers on certain carefully designed tasks <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>, <a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>.
To explore practical applications with near-term quantum devices, plenty of NISQ algorithms <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>, <a href="#bib.bib18" title="" class="ltx_ref">18</a>, <a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite> appear to be the best hope for obtaining quantum advantage in fields such as quantum chemistry <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite>, optimization <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>, and machine learning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>, <a href="#bib.bib23" title="" class="ltx_ref">23</a>, <a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite>.
In particular, those algorithms
dealing
with machine learning problems, by employing <span id="S1.p2.1.2" class="ltx_text ltx_font_italic">parameterized quantum circuits</span> (PQCs) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite> (also called <span id="S1.p2.1.3" class="ltx_text ltx_font_italic">quantum neural networks</span> (QNNs) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite>), show great potential in the field of <span id="S1.p2.1.4" class="ltx_text ltx_font_italic">quantum machine learning</span> (QML).
However, in <span id="S1.p2.1.5" class="ltx_text ltx_font_italic">artificial intelligence</span> (AI), the study of QML in the NISQ era is still in its infancy. Thus it is desirable to
explore more QML algorithms exploiting the power that lies within the NISQ devices.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p"><span id="S1.p3.1.1" class="ltx_text ltx_font_italic">Natural language processing</span> (NLP) is a key subfield of AI that aims to give machines the ability to understand human language. Common NLP tasks include speech recognition, machine translation, text classification, etc., many of which have greatly facilitated our life. Due to human language’s high complexity and flexibility, NLP tasks are generally challenging to implement. Thus, it is natural to think about whether and how quantum computing can enhance machines’ performance on NLP. Some works focus on quantum-inspired language models <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>, <a href="#bib.bib28" title="" class="ltx_ref">28</a>, <a href="#bib.bib29" title="" class="ltx_ref">29</a>, <a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite> with borrowed ideas from quantum mechanics. Another approach, known as <span id="S1.p3.1.2" class="ltx_text ltx_font_italic">quantum natural language processing</span> (QNLP), seeks to develop quantum-native NLP models that can be implemented on quantum devices <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>, <a href="#bib.bib32" title="" class="ltx_ref">32</a>, <a href="#bib.bib33" title="" class="ltx_ref">33</a>, <a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite>. Most of these QNLP proposals, though at the frontier, lack scalability as they are based on syntactic analysis, which is a preprocessing task requiring significant effort, especially for large data sets. Furthermore, these syntax-based methods employ different PQCs for sentences with different syntactical structures and thus are not flexible enough to process the innumerable complex expressions possible in human language.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">To overcome these drawbacks in current QNLP models, we propose the <span id="S1.p4.1.1" class="ltx_text ltx_font_italic">quantum self-attention neural network</span> (QSANN), where the self-attention mechanism is introduced into quantum neural networks. Our motivation comes from the excellent performance of self-attention on various NLP tasks such as language modeling <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite>, machine translation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib36" title="" class="ltx_ref">36</a>]</cite>, question answering <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite>, and text classification <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib38" title="" class="ltx_ref">38</a>]</cite>. We also note that a recently proposed method <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib39" title="" class="ltx_ref">39</a>]</cite> for quantum state tomography, an important task in quantum computing, adopts the self-attention mechanism and achieves decent results.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">In each quantum self-attention layer of QSANN, we first encode the inputs into high-dimensional quantum states, then apply PQCs on them according to the layout of the self-attention neural networks, and finally adopt a <span id="S1.p5.1.1" class="ltx_text ltx_font_italic">Gaussian projected quantum self-attention</span> (GPQSA) to obtain the output effectively.
To evaluate the performance of our model, we conduct numerical experiments of text classification with different data sets. The results show that QSANN outperforms the currently best known QNLP model as well as a simple classical self-attention neural network on test accuracy, implying potential quantum advantages of our method.
Our contributions are multi-fold:</p>
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">Our proposal is the first QNLP algorithm with a detailed circuit implementation scheme based on the self-attention mechanism. This method can be implemented on NISQ devices and is more practicable on large data sets compared with previously known QNLP methods based on syntactic analysis.
</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">In QSANN, we introduce the Gaussian projected quantum self-attention, which can efficiently dig out the correlations between words in high-dimensional quantum feature space. Furthermore, visualization of self-attention coefficients on text classification tasks confirms its ability to focus on the most relevant words.
</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">We experimentally demonstrate that QSANN outperforms existing QNLP methods based on syntactic analysis <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite> and simple classical self-attention neural networks on several public data sets for text classification. Numerical results also imply that QSANN is resilient to quantum noise.</p>
</div>
</li>
</ul>
</div>
<section id="S1.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">1.1 </span>Preliminaries and Notations</h3>

<section id="S1.SS1.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">1.1.1 </span>Quantum Basis</h4>

<div id="S1.SS1.SSS1.p1" class="ltx_para">
<p id="S1.SS1.SSS1.p1.7" class="ltx_p">Here, some basic concepts about quantum computing necessary for this paper are briefly introduced (for more details, see <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib41" title="" class="ltx_ref">41</a>]</cite>).
In quantum computing, quantum information is usually represented by <math id="S1.SS1.SSS1.p1.1.m1.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S1.SS1.SSS1.p1.1.m1.1a"><mi id="S1.SS1.SSS1.p1.1.m1.1.1" xref="S1.SS1.SSS1.p1.1.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S1.SS1.SSS1.p1.1.m1.1b"><ci id="S1.SS1.SSS1.p1.1.m1.1.1.cmml" xref="S1.SS1.SSS1.p1.1.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.SS1.SSS1.p1.1.m1.1c">n</annotation><annotation encoding="application/x-llamapun" id="S1.SS1.SSS1.p1.1.m1.1d">italic_n</annotation></semantics></math>-qubit (pure) quantum states over Hilbert space <math id="S1.SS1.SSS1.p1.2.m2.1" class="ltx_Math" alttext="{{\mathbb{C}}}^{2^{n}}" display="inline"><semantics id="S1.SS1.SSS1.p1.2.m2.1a"><msup id="S1.SS1.SSS1.p1.2.m2.1.1" xref="S1.SS1.SSS1.p1.2.m2.1.1.cmml"><mi id="S1.SS1.SSS1.p1.2.m2.1.1.2" xref="S1.SS1.SSS1.p1.2.m2.1.1.2.cmml">ℂ</mi><msup id="S1.SS1.SSS1.p1.2.m2.1.1.3" xref="S1.SS1.SSS1.p1.2.m2.1.1.3.cmml"><mn id="S1.SS1.SSS1.p1.2.m2.1.1.3.2" xref="S1.SS1.SSS1.p1.2.m2.1.1.3.2.cmml">2</mn><mi id="S1.SS1.SSS1.p1.2.m2.1.1.3.3" xref="S1.SS1.SSS1.p1.2.m2.1.1.3.3.cmml">n</mi></msup></msup><annotation-xml encoding="MathML-Content" id="S1.SS1.SSS1.p1.2.m2.1b"><apply id="S1.SS1.SSS1.p1.2.m2.1.1.cmml" xref="S1.SS1.SSS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S1.SS1.SSS1.p1.2.m2.1.1.1.cmml" xref="S1.SS1.SSS1.p1.2.m2.1.1">superscript</csymbol><ci id="S1.SS1.SSS1.p1.2.m2.1.1.2.cmml" xref="S1.SS1.SSS1.p1.2.m2.1.1.2">ℂ</ci><apply id="S1.SS1.SSS1.p1.2.m2.1.1.3.cmml" xref="S1.SS1.SSS1.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S1.SS1.SSS1.p1.2.m2.1.1.3.1.cmml" xref="S1.SS1.SSS1.p1.2.m2.1.1.3">superscript</csymbol><cn type="integer" id="S1.SS1.SSS1.p1.2.m2.1.1.3.2.cmml" xref="S1.SS1.SSS1.p1.2.m2.1.1.3.2">2</cn><ci id="S1.SS1.SSS1.p1.2.m2.1.1.3.3.cmml" xref="S1.SS1.SSS1.p1.2.m2.1.1.3.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.SS1.SSS1.p1.2.m2.1c">{{\mathbb{C}}}^{2^{n}}</annotation><annotation encoding="application/x-llamapun" id="S1.SS1.SSS1.p1.2.m2.1d">blackboard_C start_POSTSUPERSCRIPT 2 start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>. In particular, a pure quantum state could be represented by a unit vector <math id="S1.SS1.SSS1.p1.3.m3.1" class="ltx_Math" alttext="\ket{\psi}\in{{\mathbb{C}}}^{2^{n}}" display="inline"><semantics id="S1.SS1.SSS1.p1.3.m3.1a"><mrow id="S1.SS1.SSS1.p1.3.m3.1.1" xref="S1.SS1.SSS1.p1.3.m3.1.1.cmml"><mrow id="S1.SS1.SSS1.p1.3.m3.1.1.2" xref="S1.SS1.SSS1.p1.3.m3.1.1.2.cmml"><merror class="ltx_ERROR undefined undefined" id="S1.SS1.SSS1.p1.3.m3.1.1.2.2" xref="S1.SS1.SSS1.p1.3.m3.1.1.2.2b.cmml"><mtext id="S1.SS1.SSS1.p1.3.m3.1.1.2.2a" xref="S1.SS1.SSS1.p1.3.m3.1.1.2.2b.cmml">\ket</mtext></merror><mo id="S1.SS1.SSS1.p1.3.m3.1.1.2.1" xref="S1.SS1.SSS1.p1.3.m3.1.1.2.1.cmml">⁢</mo><mi id="S1.SS1.SSS1.p1.3.m3.1.1.2.3" xref="S1.SS1.SSS1.p1.3.m3.1.1.2.3.cmml">ψ</mi></mrow><mo id="S1.SS1.SSS1.p1.3.m3.1.1.1" xref="S1.SS1.SSS1.p1.3.m3.1.1.1.cmml">∈</mo><msup id="S1.SS1.SSS1.p1.3.m3.1.1.3" xref="S1.SS1.SSS1.p1.3.m3.1.1.3.cmml"><mi id="S1.SS1.SSS1.p1.3.m3.1.1.3.2" xref="S1.SS1.SSS1.p1.3.m3.1.1.3.2.cmml">ℂ</mi><msup id="S1.SS1.SSS1.p1.3.m3.1.1.3.3" xref="S1.SS1.SSS1.p1.3.m3.1.1.3.3.cmml"><mn id="S1.SS1.SSS1.p1.3.m3.1.1.3.3.2" xref="S1.SS1.SSS1.p1.3.m3.1.1.3.3.2.cmml">2</mn><mi id="S1.SS1.SSS1.p1.3.m3.1.1.3.3.3" xref="S1.SS1.SSS1.p1.3.m3.1.1.3.3.3.cmml">n</mi></msup></msup></mrow><annotation-xml encoding="MathML-Content" id="S1.SS1.SSS1.p1.3.m3.1b"><apply id="S1.SS1.SSS1.p1.3.m3.1.1.cmml" xref="S1.SS1.SSS1.p1.3.m3.1.1"><in id="S1.SS1.SSS1.p1.3.m3.1.1.1.cmml" xref="S1.SS1.SSS1.p1.3.m3.1.1.1"></in><apply id="S1.SS1.SSS1.p1.3.m3.1.1.2.cmml" xref="S1.SS1.SSS1.p1.3.m3.1.1.2"><times id="S1.SS1.SSS1.p1.3.m3.1.1.2.1.cmml" xref="S1.SS1.SSS1.p1.3.m3.1.1.2.1"></times><ci id="S1.SS1.SSS1.p1.3.m3.1.1.2.2b.cmml" xref="S1.SS1.SSS1.p1.3.m3.1.1.2.2"><merror class="ltx_ERROR undefined undefined" id="S1.SS1.SSS1.p1.3.m3.1.1.2.2.cmml" xref="S1.SS1.SSS1.p1.3.m3.1.1.2.2"><mtext id="S1.SS1.SSS1.p1.3.m3.1.1.2.2a.cmml" xref="S1.SS1.SSS1.p1.3.m3.1.1.2.2">\ket</mtext></merror></ci><ci id="S1.SS1.SSS1.p1.3.m3.1.1.2.3.cmml" xref="S1.SS1.SSS1.p1.3.m3.1.1.2.3">𝜓</ci></apply><apply id="S1.SS1.SSS1.p1.3.m3.1.1.3.cmml" xref="S1.SS1.SSS1.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="S1.SS1.SSS1.p1.3.m3.1.1.3.1.cmml" xref="S1.SS1.SSS1.p1.3.m3.1.1.3">superscript</csymbol><ci id="S1.SS1.SSS1.p1.3.m3.1.1.3.2.cmml" xref="S1.SS1.SSS1.p1.3.m3.1.1.3.2">ℂ</ci><apply id="S1.SS1.SSS1.p1.3.m3.1.1.3.3.cmml" xref="S1.SS1.SSS1.p1.3.m3.1.1.3.3"><csymbol cd="ambiguous" id="S1.SS1.SSS1.p1.3.m3.1.1.3.3.1.cmml" xref="S1.SS1.SSS1.p1.3.m3.1.1.3.3">superscript</csymbol><cn type="integer" id="S1.SS1.SSS1.p1.3.m3.1.1.3.3.2.cmml" xref="S1.SS1.SSS1.p1.3.m3.1.1.3.3.2">2</cn><ci id="S1.SS1.SSS1.p1.3.m3.1.1.3.3.3.cmml" xref="S1.SS1.SSS1.p1.3.m3.1.1.3.3.3">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.SS1.SSS1.p1.3.m3.1c">\ket{\psi}\in{{\mathbb{C}}}^{2^{n}}</annotation><annotation encoding="application/x-llamapun" id="S1.SS1.SSS1.p1.3.m3.1d">italic_ψ ∈ blackboard_C start_POSTSUPERSCRIPT 2 start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> (or <math id="S1.SS1.SSS1.p1.4.m4.1" class="ltx_Math" alttext="\bra{\psi}" display="inline"><semantics id="S1.SS1.SSS1.p1.4.m4.1a"><mrow id="S1.SS1.SSS1.p1.4.m4.1.1" xref="S1.SS1.SSS1.p1.4.m4.1.1.cmml"><merror class="ltx_ERROR undefined undefined" id="S1.SS1.SSS1.p1.4.m4.1.1.2" xref="S1.SS1.SSS1.p1.4.m4.1.1.2b.cmml"><mtext id="S1.SS1.SSS1.p1.4.m4.1.1.2a" xref="S1.SS1.SSS1.p1.4.m4.1.1.2b.cmml">\bra</mtext></merror><mo id="S1.SS1.SSS1.p1.4.m4.1.1.1" xref="S1.SS1.SSS1.p1.4.m4.1.1.1.cmml">⁢</mo><mi id="S1.SS1.SSS1.p1.4.m4.1.1.3" xref="S1.SS1.SSS1.p1.4.m4.1.1.3.cmml">ψ</mi></mrow><annotation-xml encoding="MathML-Content" id="S1.SS1.SSS1.p1.4.m4.1b"><apply id="S1.SS1.SSS1.p1.4.m4.1.1.cmml" xref="S1.SS1.SSS1.p1.4.m4.1.1"><times id="S1.SS1.SSS1.p1.4.m4.1.1.1.cmml" xref="S1.SS1.SSS1.p1.4.m4.1.1.1"></times><ci id="S1.SS1.SSS1.p1.4.m4.1.1.2b.cmml" xref="S1.SS1.SSS1.p1.4.m4.1.1.2"><merror class="ltx_ERROR undefined undefined" id="S1.SS1.SSS1.p1.4.m4.1.1.2.cmml" xref="S1.SS1.SSS1.p1.4.m4.1.1.2"><mtext id="S1.SS1.SSS1.p1.4.m4.1.1.2a.cmml" xref="S1.SS1.SSS1.p1.4.m4.1.1.2">\bra</mtext></merror></ci><ci id="S1.SS1.SSS1.p1.4.m4.1.1.3.cmml" xref="S1.SS1.SSS1.p1.4.m4.1.1.3">𝜓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.SS1.SSS1.p1.4.m4.1c">\bra{\psi}</annotation><annotation encoding="application/x-llamapun" id="S1.SS1.SSS1.p1.4.m4.1d">italic_ψ</annotation></semantics></math>), where the <span id="S1.SS1.SSS1.p1.7.1" class="ltx_text ltx_font_italic">ket</span> notation <math id="S1.SS1.SSS1.p1.5.m5.1" class="ltx_Math" alttext="\ket{}" display="inline"><semantics id="S1.SS1.SSS1.p1.5.m5.1a"><merror class="ltx_ERROR undefined undefined" id="S1.SS1.SSS1.p1.5.m5.1.1" xref="S1.SS1.SSS1.p1.5.m5.1.1b.cmml"><mtext id="S1.SS1.SSS1.p1.5.m5.1.1a" xref="S1.SS1.SSS1.p1.5.m5.1.1b.cmml">\ket</mtext></merror><annotation-xml encoding="MathML-Content" id="S1.SS1.SSS1.p1.5.m5.1b"><ci id="S1.SS1.SSS1.p1.5.m5.1.1b.cmml" xref="S1.SS1.SSS1.p1.5.m5.1.1"><merror class="ltx_ERROR undefined undefined" id="S1.SS1.SSS1.p1.5.m5.1.1.cmml" xref="S1.SS1.SSS1.p1.5.m5.1.1"><mtext id="S1.SS1.SSS1.p1.5.m5.1.1a.cmml" xref="S1.SS1.SSS1.p1.5.m5.1.1">\ket</mtext></merror></ci></annotation-xml><annotation encoding="application/x-tex" id="S1.SS1.SSS1.p1.5.m5.1c">\ket{}</annotation></semantics></math> denotes a column vector and the <span id="S1.SS1.SSS1.p1.7.2" class="ltx_text ltx_font_italic">bra</span> notation <math id="S1.SS1.SSS1.p1.6.m6.1" class="ltx_Math" alttext="\bra{\psi}=\ket{\psi}^{\dagger}" display="inline"><semantics id="S1.SS1.SSS1.p1.6.m6.1a"><mrow id="S1.SS1.SSS1.p1.6.m6.1.1" xref="S1.SS1.SSS1.p1.6.m6.1.1.cmml"><mrow id="S1.SS1.SSS1.p1.6.m6.1.1.2" xref="S1.SS1.SSS1.p1.6.m6.1.1.2.cmml"><merror class="ltx_ERROR undefined undefined" id="S1.SS1.SSS1.p1.6.m6.1.1.2.2" xref="S1.SS1.SSS1.p1.6.m6.1.1.2.2b.cmml"><mtext id="S1.SS1.SSS1.p1.6.m6.1.1.2.2a" xref="S1.SS1.SSS1.p1.6.m6.1.1.2.2b.cmml">\bra</mtext></merror><mo id="S1.SS1.SSS1.p1.6.m6.1.1.2.1" xref="S1.SS1.SSS1.p1.6.m6.1.1.2.1.cmml">⁢</mo><mi id="S1.SS1.SSS1.p1.6.m6.1.1.2.3" xref="S1.SS1.SSS1.p1.6.m6.1.1.2.3.cmml">ψ</mi></mrow><mo id="S1.SS1.SSS1.p1.6.m6.1.1.1" xref="S1.SS1.SSS1.p1.6.m6.1.1.1.cmml">=</mo><mrow id="S1.SS1.SSS1.p1.6.m6.1.1.3" xref="S1.SS1.SSS1.p1.6.m6.1.1.3.cmml"><merror class="ltx_ERROR undefined undefined" id="S1.SS1.SSS1.p1.6.m6.1.1.3.2" xref="S1.SS1.SSS1.p1.6.m6.1.1.3.2b.cmml"><mtext id="S1.SS1.SSS1.p1.6.m6.1.1.3.2a" xref="S1.SS1.SSS1.p1.6.m6.1.1.3.2b.cmml">\ket</mtext></merror><mo id="S1.SS1.SSS1.p1.6.m6.1.1.3.1" xref="S1.SS1.SSS1.p1.6.m6.1.1.3.1.cmml">⁢</mo><msup id="S1.SS1.SSS1.p1.6.m6.1.1.3.3" xref="S1.SS1.SSS1.p1.6.m6.1.1.3.3.cmml"><mi id="S1.SS1.SSS1.p1.6.m6.1.1.3.3.2" xref="S1.SS1.SSS1.p1.6.m6.1.1.3.3.2.cmml">ψ</mi><mo id="S1.SS1.SSS1.p1.6.m6.1.1.3.3.3" xref="S1.SS1.SSS1.p1.6.m6.1.1.3.3.3.cmml">†</mo></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.SS1.SSS1.p1.6.m6.1b"><apply id="S1.SS1.SSS1.p1.6.m6.1.1.cmml" xref="S1.SS1.SSS1.p1.6.m6.1.1"><eq id="S1.SS1.SSS1.p1.6.m6.1.1.1.cmml" xref="S1.SS1.SSS1.p1.6.m6.1.1.1"></eq><apply id="S1.SS1.SSS1.p1.6.m6.1.1.2.cmml" xref="S1.SS1.SSS1.p1.6.m6.1.1.2"><times id="S1.SS1.SSS1.p1.6.m6.1.1.2.1.cmml" xref="S1.SS1.SSS1.p1.6.m6.1.1.2.1"></times><ci id="S1.SS1.SSS1.p1.6.m6.1.1.2.2b.cmml" xref="S1.SS1.SSS1.p1.6.m6.1.1.2.2"><merror class="ltx_ERROR undefined undefined" id="S1.SS1.SSS1.p1.6.m6.1.1.2.2.cmml" xref="S1.SS1.SSS1.p1.6.m6.1.1.2.2"><mtext id="S1.SS1.SSS1.p1.6.m6.1.1.2.2a.cmml" xref="S1.SS1.SSS1.p1.6.m6.1.1.2.2">\bra</mtext></merror></ci><ci id="S1.SS1.SSS1.p1.6.m6.1.1.2.3.cmml" xref="S1.SS1.SSS1.p1.6.m6.1.1.2.3">𝜓</ci></apply><apply id="S1.SS1.SSS1.p1.6.m6.1.1.3.cmml" xref="S1.SS1.SSS1.p1.6.m6.1.1.3"><times id="S1.SS1.SSS1.p1.6.m6.1.1.3.1.cmml" xref="S1.SS1.SSS1.p1.6.m6.1.1.3.1"></times><ci id="S1.SS1.SSS1.p1.6.m6.1.1.3.2b.cmml" xref="S1.SS1.SSS1.p1.6.m6.1.1.3.2"><merror class="ltx_ERROR undefined undefined" id="S1.SS1.SSS1.p1.6.m6.1.1.3.2.cmml" xref="S1.SS1.SSS1.p1.6.m6.1.1.3.2"><mtext id="S1.SS1.SSS1.p1.6.m6.1.1.3.2a.cmml" xref="S1.SS1.SSS1.p1.6.m6.1.1.3.2">\ket</mtext></merror></ci><apply id="S1.SS1.SSS1.p1.6.m6.1.1.3.3.cmml" xref="S1.SS1.SSS1.p1.6.m6.1.1.3.3"><csymbol cd="ambiguous" id="S1.SS1.SSS1.p1.6.m6.1.1.3.3.1.cmml" xref="S1.SS1.SSS1.p1.6.m6.1.1.3.3">superscript</csymbol><ci id="S1.SS1.SSS1.p1.6.m6.1.1.3.3.2.cmml" xref="S1.SS1.SSS1.p1.6.m6.1.1.3.3.2">𝜓</ci><ci id="S1.SS1.SSS1.p1.6.m6.1.1.3.3.3.cmml" xref="S1.SS1.SSS1.p1.6.m6.1.1.3.3.3">†</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.SS1.SSS1.p1.6.m6.1c">\bra{\psi}=\ket{\psi}^{\dagger}</annotation><annotation encoding="application/x-llamapun" id="S1.SS1.SSS1.p1.6.m6.1d">italic_ψ = italic_ψ start_POSTSUPERSCRIPT † end_POSTSUPERSCRIPT</annotation></semantics></math> with <math id="S1.SS1.SSS1.p1.7.m7.1" class="ltx_Math" alttext="\dagger" display="inline"><semantics id="S1.SS1.SSS1.p1.7.m7.1a"><mo id="S1.SS1.SSS1.p1.7.m7.1.1" xref="S1.SS1.SSS1.p1.7.m7.1.1.cmml">†</mo><annotation-xml encoding="MathML-Content" id="S1.SS1.SSS1.p1.7.m7.1b"><ci id="S1.SS1.SSS1.p1.7.m7.1.1.cmml" xref="S1.SS1.SSS1.p1.7.m7.1.1">†</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.SS1.SSS1.p1.7.m7.1c">\dagger</annotation><annotation encoding="application/x-llamapun" id="S1.SS1.SSS1.p1.7.m7.1d">†</annotation></semantics></math> referring to conjugate transpose denotes a row vector.</p>
</div>
<div id="S1.SS1.SSS1.p2" class="ltx_para">
<p id="S1.SS1.SSS1.p2.5" class="ltx_p">The evolution of a pure quantum state <math id="S1.SS1.SSS1.p2.1.m1.1" class="ltx_Math" alttext="\ket{\psi}" display="inline"><semantics id="S1.SS1.SSS1.p2.1.m1.1a"><mrow id="S1.SS1.SSS1.p2.1.m1.1.1" xref="S1.SS1.SSS1.p2.1.m1.1.1.cmml"><merror class="ltx_ERROR undefined undefined" id="S1.SS1.SSS1.p2.1.m1.1.1.2" xref="S1.SS1.SSS1.p2.1.m1.1.1.2b.cmml"><mtext id="S1.SS1.SSS1.p2.1.m1.1.1.2a" xref="S1.SS1.SSS1.p2.1.m1.1.1.2b.cmml">\ket</mtext></merror><mo id="S1.SS1.SSS1.p2.1.m1.1.1.1" xref="S1.SS1.SSS1.p2.1.m1.1.1.1.cmml">⁢</mo><mi id="S1.SS1.SSS1.p2.1.m1.1.1.3" xref="S1.SS1.SSS1.p2.1.m1.1.1.3.cmml">ψ</mi></mrow><annotation-xml encoding="MathML-Content" id="S1.SS1.SSS1.p2.1.m1.1b"><apply id="S1.SS1.SSS1.p2.1.m1.1.1.cmml" xref="S1.SS1.SSS1.p2.1.m1.1.1"><times id="S1.SS1.SSS1.p2.1.m1.1.1.1.cmml" xref="S1.SS1.SSS1.p2.1.m1.1.1.1"></times><ci id="S1.SS1.SSS1.p2.1.m1.1.1.2b.cmml" xref="S1.SS1.SSS1.p2.1.m1.1.1.2"><merror class="ltx_ERROR undefined undefined" id="S1.SS1.SSS1.p2.1.m1.1.1.2.cmml" xref="S1.SS1.SSS1.p2.1.m1.1.1.2"><mtext id="S1.SS1.SSS1.p2.1.m1.1.1.2a.cmml" xref="S1.SS1.SSS1.p2.1.m1.1.1.2">\ket</mtext></merror></ci><ci id="S1.SS1.SSS1.p2.1.m1.1.1.3.cmml" xref="S1.SS1.SSS1.p2.1.m1.1.1.3">𝜓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.SS1.SSS1.p2.1.m1.1c">\ket{\psi}</annotation><annotation encoding="application/x-llamapun" id="S1.SS1.SSS1.p2.1.m1.1d">italic_ψ</annotation></semantics></math> is mathematically described by applying a quantum circuit (or a quantum gate), i.e., <math id="S1.SS1.SSS1.p2.2.m2.1" class="ltx_Math" alttext="\ket{\psi^{\prime}}=U\ket{\psi}" display="inline"><semantics id="S1.SS1.SSS1.p2.2.m2.1a"><mrow id="S1.SS1.SSS1.p2.2.m2.1.1" xref="S1.SS1.SSS1.p2.2.m2.1.1.cmml"><mrow id="S1.SS1.SSS1.p2.2.m2.1.1.2" xref="S1.SS1.SSS1.p2.2.m2.1.1.2.cmml"><merror class="ltx_ERROR undefined undefined" id="S1.SS1.SSS1.p2.2.m2.1.1.2.2" xref="S1.SS1.SSS1.p2.2.m2.1.1.2.2b.cmml"><mtext id="S1.SS1.SSS1.p2.2.m2.1.1.2.2a" xref="S1.SS1.SSS1.p2.2.m2.1.1.2.2b.cmml">\ket</mtext></merror><mo id="S1.SS1.SSS1.p2.2.m2.1.1.2.1" xref="S1.SS1.SSS1.p2.2.m2.1.1.2.1.cmml">⁢</mo><msup id="S1.SS1.SSS1.p2.2.m2.1.1.2.3" xref="S1.SS1.SSS1.p2.2.m2.1.1.2.3.cmml"><mi id="S1.SS1.SSS1.p2.2.m2.1.1.2.3.2" xref="S1.SS1.SSS1.p2.2.m2.1.1.2.3.2.cmml">ψ</mi><mo id="S1.SS1.SSS1.p2.2.m2.1.1.2.3.3" xref="S1.SS1.SSS1.p2.2.m2.1.1.2.3.3.cmml">′</mo></msup></mrow><mo id="S1.SS1.SSS1.p2.2.m2.1.1.1" xref="S1.SS1.SSS1.p2.2.m2.1.1.1.cmml">=</mo><mrow id="S1.SS1.SSS1.p2.2.m2.1.1.3" xref="S1.SS1.SSS1.p2.2.m2.1.1.3.cmml"><mi id="S1.SS1.SSS1.p2.2.m2.1.1.3.2" xref="S1.SS1.SSS1.p2.2.m2.1.1.3.2.cmml">U</mi><mo id="S1.SS1.SSS1.p2.2.m2.1.1.3.1" xref="S1.SS1.SSS1.p2.2.m2.1.1.3.1.cmml">⁢</mo><merror class="ltx_ERROR undefined undefined" id="S1.SS1.SSS1.p2.2.m2.1.1.3.3" xref="S1.SS1.SSS1.p2.2.m2.1.1.3.3b.cmml"><mtext id="S1.SS1.SSS1.p2.2.m2.1.1.3.3a" xref="S1.SS1.SSS1.p2.2.m2.1.1.3.3b.cmml">\ket</mtext></merror><mo id="S1.SS1.SSS1.p2.2.m2.1.1.3.1a" xref="S1.SS1.SSS1.p2.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S1.SS1.SSS1.p2.2.m2.1.1.3.4" xref="S1.SS1.SSS1.p2.2.m2.1.1.3.4.cmml">ψ</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.SS1.SSS1.p2.2.m2.1b"><apply id="S1.SS1.SSS1.p2.2.m2.1.1.cmml" xref="S1.SS1.SSS1.p2.2.m2.1.1"><eq id="S1.SS1.SSS1.p2.2.m2.1.1.1.cmml" xref="S1.SS1.SSS1.p2.2.m2.1.1.1"></eq><apply id="S1.SS1.SSS1.p2.2.m2.1.1.2.cmml" xref="S1.SS1.SSS1.p2.2.m2.1.1.2"><times id="S1.SS1.SSS1.p2.2.m2.1.1.2.1.cmml" xref="S1.SS1.SSS1.p2.2.m2.1.1.2.1"></times><ci id="S1.SS1.SSS1.p2.2.m2.1.1.2.2b.cmml" xref="S1.SS1.SSS1.p2.2.m2.1.1.2.2"><merror class="ltx_ERROR undefined undefined" id="S1.SS1.SSS1.p2.2.m2.1.1.2.2.cmml" xref="S1.SS1.SSS1.p2.2.m2.1.1.2.2"><mtext id="S1.SS1.SSS1.p2.2.m2.1.1.2.2a.cmml" xref="S1.SS1.SSS1.p2.2.m2.1.1.2.2">\ket</mtext></merror></ci><apply id="S1.SS1.SSS1.p2.2.m2.1.1.2.3.cmml" xref="S1.SS1.SSS1.p2.2.m2.1.1.2.3"><csymbol cd="ambiguous" id="S1.SS1.SSS1.p2.2.m2.1.1.2.3.1.cmml" xref="S1.SS1.SSS1.p2.2.m2.1.1.2.3">superscript</csymbol><ci id="S1.SS1.SSS1.p2.2.m2.1.1.2.3.2.cmml" xref="S1.SS1.SSS1.p2.2.m2.1.1.2.3.2">𝜓</ci><ci id="S1.SS1.SSS1.p2.2.m2.1.1.2.3.3.cmml" xref="S1.SS1.SSS1.p2.2.m2.1.1.2.3.3">′</ci></apply></apply><apply id="S1.SS1.SSS1.p2.2.m2.1.1.3.cmml" xref="S1.SS1.SSS1.p2.2.m2.1.1.3"><times id="S1.SS1.SSS1.p2.2.m2.1.1.3.1.cmml" xref="S1.SS1.SSS1.p2.2.m2.1.1.3.1"></times><ci id="S1.SS1.SSS1.p2.2.m2.1.1.3.2.cmml" xref="S1.SS1.SSS1.p2.2.m2.1.1.3.2">𝑈</ci><ci id="S1.SS1.SSS1.p2.2.m2.1.1.3.3b.cmml" xref="S1.SS1.SSS1.p2.2.m2.1.1.3.3"><merror class="ltx_ERROR undefined undefined" id="S1.SS1.SSS1.p2.2.m2.1.1.3.3.cmml" xref="S1.SS1.SSS1.p2.2.m2.1.1.3.3"><mtext id="S1.SS1.SSS1.p2.2.m2.1.1.3.3a.cmml" xref="S1.SS1.SSS1.p2.2.m2.1.1.3.3">\ket</mtext></merror></ci><ci id="S1.SS1.SSS1.p2.2.m2.1.1.3.4.cmml" xref="S1.SS1.SSS1.p2.2.m2.1.1.3.4">𝜓</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.SS1.SSS1.p2.2.m2.1c">\ket{\psi^{\prime}}=U\ket{\psi}</annotation><annotation encoding="application/x-llamapun" id="S1.SS1.SSS1.p2.2.m2.1d">italic_ψ start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT = italic_U italic_ψ</annotation></semantics></math>, where <math id="S1.SS1.SSS1.p2.3.m3.1" class="ltx_Math" alttext="U" display="inline"><semantics id="S1.SS1.SSS1.p2.3.m3.1a"><mi id="S1.SS1.SSS1.p2.3.m3.1.1" xref="S1.SS1.SSS1.p2.3.m3.1.1.cmml">U</mi><annotation-xml encoding="MathML-Content" id="S1.SS1.SSS1.p2.3.m3.1b"><ci id="S1.SS1.SSS1.p2.3.m3.1.1.cmml" xref="S1.SS1.SSS1.p2.3.m3.1.1">𝑈</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.SS1.SSS1.p2.3.m3.1c">U</annotation><annotation encoding="application/x-llamapun" id="S1.SS1.SSS1.p2.3.m3.1d">italic_U</annotation></semantics></math> is the unitary operator (matrix) representing the quantum circuit and <math id="S1.SS1.SSS1.p2.4.m4.1" class="ltx_Math" alttext="\ket{\psi^{\prime}}" display="inline"><semantics id="S1.SS1.SSS1.p2.4.m4.1a"><mrow id="S1.SS1.SSS1.p2.4.m4.1.1" xref="S1.SS1.SSS1.p2.4.m4.1.1.cmml"><merror class="ltx_ERROR undefined undefined" id="S1.SS1.SSS1.p2.4.m4.1.1.2" xref="S1.SS1.SSS1.p2.4.m4.1.1.2b.cmml"><mtext id="S1.SS1.SSS1.p2.4.m4.1.1.2a" xref="S1.SS1.SSS1.p2.4.m4.1.1.2b.cmml">\ket</mtext></merror><mo id="S1.SS1.SSS1.p2.4.m4.1.1.1" xref="S1.SS1.SSS1.p2.4.m4.1.1.1.cmml">⁢</mo><msup id="S1.SS1.SSS1.p2.4.m4.1.1.3" xref="S1.SS1.SSS1.p2.4.m4.1.1.3.cmml"><mi id="S1.SS1.SSS1.p2.4.m4.1.1.3.2" xref="S1.SS1.SSS1.p2.4.m4.1.1.3.2.cmml">ψ</mi><mo id="S1.SS1.SSS1.p2.4.m4.1.1.3.3" xref="S1.SS1.SSS1.p2.4.m4.1.1.3.3.cmml">′</mo></msup></mrow><annotation-xml encoding="MathML-Content" id="S1.SS1.SSS1.p2.4.m4.1b"><apply id="S1.SS1.SSS1.p2.4.m4.1.1.cmml" xref="S1.SS1.SSS1.p2.4.m4.1.1"><times id="S1.SS1.SSS1.p2.4.m4.1.1.1.cmml" xref="S1.SS1.SSS1.p2.4.m4.1.1.1"></times><ci id="S1.SS1.SSS1.p2.4.m4.1.1.2b.cmml" xref="S1.SS1.SSS1.p2.4.m4.1.1.2"><merror class="ltx_ERROR undefined undefined" id="S1.SS1.SSS1.p2.4.m4.1.1.2.cmml" xref="S1.SS1.SSS1.p2.4.m4.1.1.2"><mtext id="S1.SS1.SSS1.p2.4.m4.1.1.2a.cmml" xref="S1.SS1.SSS1.p2.4.m4.1.1.2">\ket</mtext></merror></ci><apply id="S1.SS1.SSS1.p2.4.m4.1.1.3.cmml" xref="S1.SS1.SSS1.p2.4.m4.1.1.3"><csymbol cd="ambiguous" id="S1.SS1.SSS1.p2.4.m4.1.1.3.1.cmml" xref="S1.SS1.SSS1.p2.4.m4.1.1.3">superscript</csymbol><ci id="S1.SS1.SSS1.p2.4.m4.1.1.3.2.cmml" xref="S1.SS1.SSS1.p2.4.m4.1.1.3.2">𝜓</ci><ci id="S1.SS1.SSS1.p2.4.m4.1.1.3.3.cmml" xref="S1.SS1.SSS1.p2.4.m4.1.1.3.3">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.SS1.SSS1.p2.4.m4.1c">\ket{\psi^{\prime}}</annotation><annotation encoding="application/x-llamapun" id="S1.SS1.SSS1.p2.4.m4.1d">italic_ψ start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> is the quantum state after evolution. Common single-qubit quantum gates include Hadamard gate <math id="S1.SS1.SSS1.p2.5.m5.1" class="ltx_Math" alttext="H" display="inline"><semantics id="S1.SS1.SSS1.p2.5.m5.1a"><mi id="S1.SS1.SSS1.p2.5.m5.1.1" xref="S1.SS1.SSS1.p2.5.m5.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S1.SS1.SSS1.p2.5.m5.1b"><ci id="S1.SS1.SSS1.p2.5.m5.1.1.cmml" xref="S1.SS1.SSS1.p2.5.m5.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.SS1.SSS1.p2.5.m5.1c">H</annotation><annotation encoding="application/x-llamapun" id="S1.SS1.SSS1.p2.5.m5.1d">italic_H</annotation></semantics></math> and Pauli operators</p>
<table id="S1.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S1.E9"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S1.E9.m1.6" class="ltx_Math" alttext="\displaystyle H:=\frac{1}{\sqrt{2}}\begin{bmatrix}1&amp;1\\
1&amp;-1\end{bmatrix},\ X:=\begin{bmatrix}0&amp;1\\
1&amp;0\end{bmatrix},Y:=\begin{bmatrix}0&amp;-i\\
i&amp;0\end{bmatrix},Z:=\begin{bmatrix}1&amp;0\\
0&amp;-1\end{bmatrix}" display="inline"><semantics id="S1.E9.m1.6a"><mrow id="S1.E9.m1.6.6.2" xref="S1.E9.m1.6.6.3.cmml"><mrow id="S1.E9.m1.5.5.1.1" xref="S1.E9.m1.5.5.1.1.cmml"><mi id="S1.E9.m1.5.5.1.1.2" xref="S1.E9.m1.5.5.1.1.2.cmml">H</mi><mo id="S1.E9.m1.5.5.1.1.1" xref="S1.E9.m1.5.5.1.1.1.cmml">:=</mo><mrow id="S1.E9.m1.5.5.1.1.3" xref="S1.E9.m1.5.5.1.1.3.cmml"><mstyle displaystyle="true" id="S1.E9.m1.5.5.1.1.3.2" xref="S1.E9.m1.5.5.1.1.3.2.cmml"><mfrac id="S1.E9.m1.5.5.1.1.3.2a" xref="S1.E9.m1.5.5.1.1.3.2.cmml"><mn id="S1.E9.m1.5.5.1.1.3.2.2" xref="S1.E9.m1.5.5.1.1.3.2.2.cmml">1</mn><msqrt id="S1.E9.m1.5.5.1.1.3.2.3" xref="S1.E9.m1.5.5.1.1.3.2.3.cmml"><mn id="S1.E9.m1.5.5.1.1.3.2.3.2" xref="S1.E9.m1.5.5.1.1.3.2.3.2.cmml">2</mn></msqrt></mfrac></mstyle><mo id="S1.E9.m1.5.5.1.1.3.1" xref="S1.E9.m1.5.5.1.1.3.1.cmml">⁢</mo><mrow id="S1.E9.m1.1.1a.3" xref="S1.E9.m1.1.1a.2.cmml"><mo id="S1.E9.m1.1.1a.3.1" xref="S1.E9.m1.1.1a.2.1.cmml">[</mo><mtable columnspacing="5pt" rowspacing="0pt" id="S1.E9.m1.1.1.1.1" xref="S1.E9.m1.1.1.1.1.cmml"><mtr id="S1.E9.m1.1.1.1.1a" xref="S1.E9.m1.1.1.1.1.cmml"><mtd columnalign="center" id="S1.E9.m1.1.1.1.1b" xref="S1.E9.m1.1.1.1.1.cmml"><mn id="S1.E1.1.1" xref="S1.E1.1.1.cmml">1</mn></mtd><mtd columnalign="center" id="S1.E9.m1.1.1.1.1c" xref="S1.E9.m1.1.1.1.1.cmml"><mn id="S1.E1.2.1" xref="S1.E1.2.1.cmml">1</mn></mtd></mtr><mtr id="S1.E9.m1.1.1.1.1d" xref="S1.E9.m1.1.1.1.1.cmml"><mtd columnalign="center" id="S1.E9.m1.1.1.1.1e" xref="S1.E9.m1.1.1.1.1.cmml"><mn id="S1.E2.1.1" xref="S1.E2.1.1.cmml">1</mn></mtd><mtd columnalign="center" id="S1.E9.m1.1.1.1.1f" xref="S1.E9.m1.1.1.1.1.cmml"><mrow id="S1.E2.2.1" xref="S1.E2.2.1.cmml"><mo id="S1.E2.2.1.1" xref="S1.E2.2.1.1.cmml">-</mo><mn id="S1.E2.2.1.2" xref="S1.E2.2.1.2.cmml">1</mn></mrow></mtd></mtr></mtable><mo id="S1.E9.m1.1.1a.3.2" xref="S1.E9.m1.1.1a.2.1.cmml">]</mo></mrow></mrow></mrow><mo rspace="7.5pt" id="S1.E9.m1.6.6.2.3" xref="S1.E9.m1.6.6.3a.cmml">,</mo><mrow id="S1.E9.m1.6.6.2.2.2" xref="S1.E9.m1.6.6.2.2.3.cmml"><mrow id="S1.E9.m1.6.6.2.2.1.1" xref="S1.E9.m1.6.6.2.2.1.1.cmml"><mi id="S1.E9.m1.6.6.2.2.1.1.2" xref="S1.E9.m1.6.6.2.2.1.1.2.cmml">X</mi><mo id="S1.E9.m1.6.6.2.2.1.1.1" xref="S1.E9.m1.6.6.2.2.1.1.1.cmml">:=</mo><mrow id="S1.E9.m1.2.2a.3" xref="S1.E9.m1.2.2a.2.cmml"><mo id="S1.E9.m1.2.2a.3.1" xref="S1.E9.m1.2.2a.2.1.cmml">[</mo><mtable columnspacing="5pt" rowspacing="0pt" id="S1.E9.m1.2.2.1.1" xref="S1.E9.m1.2.2.1.1.cmml"><mtr id="S1.E9.m1.2.2.1.1a" xref="S1.E9.m1.2.2.1.1.cmml"><mtd columnalign="center" id="S1.E9.m1.2.2.1.1b" xref="S1.E9.m1.2.2.1.1.cmml"><mn id="S1.E3.1.1" xref="S1.E3.1.1.cmml">0</mn></mtd><mtd columnalign="center" id="S1.E9.m1.2.2.1.1c" xref="S1.E9.m1.2.2.1.1.cmml"><mn id="S1.E3.2.1" xref="S1.E3.2.1.cmml">1</mn></mtd></mtr><mtr id="S1.E9.m1.2.2.1.1d" xref="S1.E9.m1.2.2.1.1.cmml"><mtd columnalign="center" id="S1.E9.m1.2.2.1.1e" xref="S1.E9.m1.2.2.1.1.cmml"><mn id="S1.E4.1.1" xref="S1.E4.1.1.cmml">1</mn></mtd><mtd columnalign="center" id="S1.E9.m1.2.2.1.1f" xref="S1.E9.m1.2.2.1.1.cmml"><mn id="S1.E4.2.1" xref="S1.E4.2.1.cmml">0</mn></mtd></mtr></mtable><mo id="S1.E9.m1.2.2a.3.2" xref="S1.E9.m1.2.2a.2.1.cmml">]</mo></mrow></mrow><mo id="S1.E9.m1.6.6.2.2.2.3" xref="S1.E9.m1.6.6.2.2.3a.cmml">,</mo><mrow id="S1.E9.m1.6.6.2.2.2.2.2" xref="S1.E9.m1.6.6.2.2.2.2.3.cmml"><mrow id="S1.E9.m1.6.6.2.2.2.2.1.1" xref="S1.E9.m1.6.6.2.2.2.2.1.1.cmml"><mi id="S1.E9.m1.6.6.2.2.2.2.1.1.2" xref="S1.E9.m1.6.6.2.2.2.2.1.1.2.cmml">Y</mi><mo id="S1.E9.m1.6.6.2.2.2.2.1.1.1" xref="S1.E9.m1.6.6.2.2.2.2.1.1.1.cmml">:=</mo><mrow id="S1.E9.m1.3.3a.3" xref="S1.E9.m1.3.3a.2.cmml"><mo id="S1.E9.m1.3.3a.3.1" xref="S1.E9.m1.3.3a.2.1.cmml">[</mo><mtable columnspacing="5pt" rowspacing="0pt" id="S1.E9.m1.3.3.1.1" xref="S1.E9.m1.3.3.1.1.cmml"><mtr id="S1.E9.m1.3.3.1.1a" xref="S1.E9.m1.3.3.1.1.cmml"><mtd columnalign="center" id="S1.E9.m1.3.3.1.1b" xref="S1.E9.m1.3.3.1.1.cmml"><mn id="S1.E5.1.1" xref="S1.E5.1.1.cmml">0</mn></mtd><mtd columnalign="center" id="S1.E9.m1.3.3.1.1c" xref="S1.E9.m1.3.3.1.1.cmml"><mrow id="S1.E5.2.1" xref="S1.E5.2.1.cmml"><mo id="S1.E5.2.1.1" xref="S1.E5.2.1.1.cmml">-</mo><mi id="S1.E5.2.1.2" xref="S1.E5.2.1.2.cmml">i</mi></mrow></mtd></mtr><mtr id="S1.E9.m1.3.3.1.1d" xref="S1.E9.m1.3.3.1.1.cmml"><mtd columnalign="center" id="S1.E9.m1.3.3.1.1e" xref="S1.E9.m1.3.3.1.1.cmml"><mi id="S1.E6.1.1" xref="S1.E6.1.1.cmml">i</mi></mtd><mtd columnalign="center" id="S1.E9.m1.3.3.1.1f" xref="S1.E9.m1.3.3.1.1.cmml"><mn id="S1.E6.2.1" xref="S1.E6.2.1.cmml">0</mn></mtd></mtr></mtable><mo id="S1.E9.m1.3.3a.3.2" xref="S1.E9.m1.3.3a.2.1.cmml">]</mo></mrow></mrow><mo id="S1.E9.m1.6.6.2.2.2.2.2.3" xref="S1.E9.m1.6.6.2.2.2.2.3a.cmml">,</mo><mrow id="S1.E9.m1.6.6.2.2.2.2.2.2" xref="S1.E9.m1.6.6.2.2.2.2.2.2.cmml"><mi id="S1.E9.m1.6.6.2.2.2.2.2.2.2" xref="S1.E9.m1.6.6.2.2.2.2.2.2.2.cmml">Z</mi><mo id="S1.E9.m1.6.6.2.2.2.2.2.2.1" xref="S1.E9.m1.6.6.2.2.2.2.2.2.1.cmml">:=</mo><mrow id="S1.E9.m1.4.4a.3" xref="S1.E9.m1.4.4a.2.cmml"><mo id="S1.E9.m1.4.4a.3.1" xref="S1.E9.m1.4.4a.2.1.cmml">[</mo><mtable columnspacing="5pt" rowspacing="0pt" id="S1.E9.m1.4.4.1.1" xref="S1.E9.m1.4.4.1.1.cmml"><mtr id="S1.E9.m1.4.4.1.1a" xref="S1.E9.m1.4.4.1.1.cmml"><mtd columnalign="center" id="S1.E9.m1.4.4.1.1b" xref="S1.E9.m1.4.4.1.1.cmml"><mn id="S1.E7.1.1" xref="S1.E7.1.1.cmml">1</mn></mtd><mtd columnalign="center" id="S1.E9.m1.4.4.1.1c" xref="S1.E9.m1.4.4.1.1.cmml"><mn id="S1.E7.2.1" xref="S1.E7.2.1.cmml">0</mn></mtd></mtr><mtr id="S1.E9.m1.4.4.1.1d" xref="S1.E9.m1.4.4.1.1.cmml"><mtd columnalign="center" id="S1.E9.m1.4.4.1.1e" xref="S1.E9.m1.4.4.1.1.cmml"><mn id="S1.E8.1.1" xref="S1.E8.1.1.cmml">0</mn></mtd><mtd columnalign="center" id="S1.E9.m1.4.4.1.1f" xref="S1.E9.m1.4.4.1.1.cmml"><mrow id="S1.E8.2.1" xref="S1.E8.2.1.cmml"><mo id="S1.E8.2.1.1" xref="S1.E8.2.1.1.cmml">-</mo><mn id="S1.E8.2.1.2" xref="S1.E8.2.1.2.cmml">1</mn></mrow></mtd></mtr></mtable><mo id="S1.E9.m1.4.4a.3.2" xref="S1.E9.m1.4.4a.2.1.cmml">]</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.E9.m1.6b"><apply id="S1.E9.m1.6.6.3.cmml" xref="S1.E9.m1.6.6.2"><csymbol cd="ambiguous" id="S1.E9.m1.6.6.3a.cmml" xref="S1.E9.m1.6.6.2.3">formulae-sequence</csymbol><apply id="S1.E9.m1.5.5.1.1.cmml" xref="S1.E9.m1.5.5.1.1"><csymbol cd="latexml" id="S1.E9.m1.5.5.1.1.1.cmml" xref="S1.E9.m1.5.5.1.1.1">assign</csymbol><ci id="S1.E9.m1.5.5.1.1.2.cmml" xref="S1.E9.m1.5.5.1.1.2">𝐻</ci><apply id="S1.E9.m1.5.5.1.1.3.cmml" xref="S1.E9.m1.5.5.1.1.3"><times id="S1.E9.m1.5.5.1.1.3.1.cmml" xref="S1.E9.m1.5.5.1.1.3.1"></times><apply id="S1.E9.m1.5.5.1.1.3.2.cmml" xref="S1.E9.m1.5.5.1.1.3.2"><divide id="S1.E9.m1.5.5.1.1.3.2.1.cmml" xref="S1.E9.m1.5.5.1.1.3.2"></divide><cn type="integer" id="S1.E9.m1.5.5.1.1.3.2.2.cmml" xref="S1.E9.m1.5.5.1.1.3.2.2">1</cn><apply id="S1.E9.m1.5.5.1.1.3.2.3.cmml" xref="S1.E9.m1.5.5.1.1.3.2.3"><root id="S1.E9.m1.5.5.1.1.3.2.3a.cmml" xref="S1.E9.m1.5.5.1.1.3.2.3"></root><cn type="integer" id="S1.E9.m1.5.5.1.1.3.2.3.2.cmml" xref="S1.E9.m1.5.5.1.1.3.2.3.2">2</cn></apply></apply><apply id="S1.E9.m1.1.1a.2.cmml" xref="S1.E9.m1.1.1a.3"><csymbol cd="latexml" id="S1.E9.m1.1.1a.2.1.cmml" xref="S1.E9.m1.1.1a.3.1">matrix</csymbol><matrix id="S1.E9.m1.1.1.1.1.cmml" xref="S1.E9.m1.1.1.1.1"><matrixrow id="S1.E9.m1.1.1.1.1a.cmml" xref="S1.E9.m1.1.1.1.1"><cn type="integer" id="S1.E1.1.1.cmml" xref="S1.E1.1.1">1</cn><cn type="integer" id="S1.E1.2.1.cmml" xref="S1.E1.2.1">1</cn></matrixrow><matrixrow id="S1.E9.m1.1.1.1.1b.cmml" xref="S1.E9.m1.1.1.1.1"><cn type="integer" id="S1.E2.1.1.cmml" xref="S1.E2.1.1">1</cn><apply id="S1.E2.2.1.cmml" xref="S1.E2.2.1"><minus id="S1.E2.2.1.1.cmml" xref="S1.E2.2.1.1"></minus><cn type="integer" id="S1.E2.2.1.2.cmml" xref="S1.E2.2.1.2">1</cn></apply></matrixrow></matrix></apply></apply></apply><apply id="S1.E9.m1.6.6.2.2.3.cmml" xref="S1.E9.m1.6.6.2.2.2"><csymbol cd="ambiguous" id="S1.E9.m1.6.6.2.2.3a.cmml" xref="S1.E9.m1.6.6.2.2.2.3">formulae-sequence</csymbol><apply id="S1.E9.m1.6.6.2.2.1.1.cmml" xref="S1.E9.m1.6.6.2.2.1.1"><csymbol cd="latexml" id="S1.E9.m1.6.6.2.2.1.1.1.cmml" xref="S1.E9.m1.6.6.2.2.1.1.1">assign</csymbol><ci id="S1.E9.m1.6.6.2.2.1.1.2.cmml" xref="S1.E9.m1.6.6.2.2.1.1.2">𝑋</ci><apply id="S1.E9.m1.2.2a.2.cmml" xref="S1.E9.m1.2.2a.3"><csymbol cd="latexml" id="S1.E9.m1.2.2a.2.1.cmml" xref="S1.E9.m1.2.2a.3.1">matrix</csymbol><matrix id="S1.E9.m1.2.2.1.1.cmml" xref="S1.E9.m1.2.2.1.1"><matrixrow id="S1.E9.m1.2.2.1.1a.cmml" xref="S1.E9.m1.2.2.1.1"><cn type="integer" id="S1.E3.1.1.cmml" xref="S1.E3.1.1">0</cn><cn type="integer" id="S1.E3.2.1.cmml" xref="S1.E3.2.1">1</cn></matrixrow><matrixrow id="S1.E9.m1.2.2.1.1b.cmml" xref="S1.E9.m1.2.2.1.1"><cn type="integer" id="S1.E4.1.1.cmml" xref="S1.E4.1.1">1</cn><cn type="integer" id="S1.E4.2.1.cmml" xref="S1.E4.2.1">0</cn></matrixrow></matrix></apply></apply><apply id="S1.E9.m1.6.6.2.2.2.2.3.cmml" xref="S1.E9.m1.6.6.2.2.2.2.2"><csymbol cd="ambiguous" id="S1.E9.m1.6.6.2.2.2.2.3a.cmml" xref="S1.E9.m1.6.6.2.2.2.2.2.3">formulae-sequence</csymbol><apply id="S1.E9.m1.6.6.2.2.2.2.1.1.cmml" xref="S1.E9.m1.6.6.2.2.2.2.1.1"><csymbol cd="latexml" id="S1.E9.m1.6.6.2.2.2.2.1.1.1.cmml" xref="S1.E9.m1.6.6.2.2.2.2.1.1.1">assign</csymbol><ci id="S1.E9.m1.6.6.2.2.2.2.1.1.2.cmml" xref="S1.E9.m1.6.6.2.2.2.2.1.1.2">𝑌</ci><apply id="S1.E9.m1.3.3a.2.cmml" xref="S1.E9.m1.3.3a.3"><csymbol cd="latexml" id="S1.E9.m1.3.3a.2.1.cmml" xref="S1.E9.m1.3.3a.3.1">matrix</csymbol><matrix id="S1.E9.m1.3.3.1.1.cmml" xref="S1.E9.m1.3.3.1.1"><matrixrow id="S1.E9.m1.3.3.1.1a.cmml" xref="S1.E9.m1.3.3.1.1"><cn type="integer" id="S1.E5.1.1.cmml" xref="S1.E5.1.1">0</cn><apply id="S1.E5.2.1.cmml" xref="S1.E5.2.1"><minus id="S1.E5.2.1.1.cmml" xref="S1.E5.2.1.1"></minus><ci id="S1.E5.2.1.2.cmml" xref="S1.E5.2.1.2">𝑖</ci></apply></matrixrow><matrixrow id="S1.E9.m1.3.3.1.1b.cmml" xref="S1.E9.m1.3.3.1.1"><ci id="S1.E6.1.1.cmml" xref="S1.E6.1.1">𝑖</ci><cn type="integer" id="S1.E6.2.1.cmml" xref="S1.E6.2.1">0</cn></matrixrow></matrix></apply></apply><apply id="S1.E9.m1.6.6.2.2.2.2.2.2.cmml" xref="S1.E9.m1.6.6.2.2.2.2.2.2"><csymbol cd="latexml" id="S1.E9.m1.6.6.2.2.2.2.2.2.1.cmml" xref="S1.E9.m1.6.6.2.2.2.2.2.2.1">assign</csymbol><ci id="S1.E9.m1.6.6.2.2.2.2.2.2.2.cmml" xref="S1.E9.m1.6.6.2.2.2.2.2.2.2">𝑍</ci><apply id="S1.E9.m1.4.4a.2.cmml" xref="S1.E9.m1.4.4a.3"><csymbol cd="latexml" id="S1.E9.m1.4.4a.2.1.cmml" xref="S1.E9.m1.4.4a.3.1">matrix</csymbol><matrix id="S1.E9.m1.4.4.1.1.cmml" xref="S1.E9.m1.4.4.1.1"><matrixrow id="S1.E9.m1.4.4.1.1a.cmml" xref="S1.E9.m1.4.4.1.1"><cn type="integer" id="S1.E7.1.1.cmml" xref="S1.E7.1.1">1</cn><cn type="integer" id="S1.E7.2.1.cmml" xref="S1.E7.2.1">0</cn></matrixrow><matrixrow id="S1.E9.m1.4.4.1.1b.cmml" xref="S1.E9.m1.4.4.1.1"><cn type="integer" id="S1.E8.1.1.cmml" xref="S1.E8.1.1">0</cn><apply id="S1.E8.2.1.cmml" xref="S1.E8.2.1"><minus id="S1.E8.2.1.1.cmml" xref="S1.E8.2.1.1"></minus><cn type="integer" id="S1.E8.2.1.2.cmml" xref="S1.E8.2.1.2">1</cn></apply></matrixrow></matrix></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.E9.m1.6c">\displaystyle H:=\frac{1}{\sqrt{2}}\begin{bmatrix}1&amp;1\\
1&amp;-1\end{bmatrix},\ X:=\begin{bmatrix}0&amp;1\\
1&amp;0\end{bmatrix},Y:=\begin{bmatrix}0&amp;-i\\
i&amp;0\end{bmatrix},Z:=\begin{bmatrix}1&amp;0\\
0&amp;-1\end{bmatrix}</annotation><annotation encoding="application/x-llamapun" id="S1.E9.m1.6d">italic_H := divide start_ARG 1 end_ARG start_ARG square-root start_ARG 2 end_ARG end_ARG [ start_ARG start_ROW start_CELL 1 end_CELL start_CELL 1 end_CELL end_ROW start_ROW start_CELL 1 end_CELL start_CELL - 1 end_CELL end_ROW end_ARG ] , italic_X := [ start_ARG start_ROW start_CELL 0 end_CELL start_CELL 1 end_CELL end_ROW start_ROW start_CELL 1 end_CELL start_CELL 0 end_CELL end_ROW end_ARG ] , italic_Y := [ start_ARG start_ROW start_CELL 0 end_CELL start_CELL - italic_i end_CELL end_ROW start_ROW start_CELL italic_i end_CELL start_CELL 0 end_CELL end_ROW end_ARG ] , italic_Z := [ start_ARG start_ROW start_CELL 1 end_CELL start_CELL 0 end_CELL end_ROW start_ROW start_CELL 0 end_CELL start_CELL - 1 end_CELL end_ROW end_ARG ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p id="S1.SS1.SSS1.p2.15" class="ltx_p">and their corresponding rotation gates denoted by <math id="S1.SS1.SSS1.p2.6.m1.1" class="ltx_Math" alttext="R_{P}(\theta)" display="inline"><semantics id="S1.SS1.SSS1.p2.6.m1.1a"><mrow id="S1.SS1.SSS1.p2.6.m1.1.2" xref="S1.SS1.SSS1.p2.6.m1.1.2.cmml"><msub id="S1.SS1.SSS1.p2.6.m1.1.2.2" xref="S1.SS1.SSS1.p2.6.m1.1.2.2.cmml"><mi id="S1.SS1.SSS1.p2.6.m1.1.2.2.2" xref="S1.SS1.SSS1.p2.6.m1.1.2.2.2.cmml">R</mi><mi id="S1.SS1.SSS1.p2.6.m1.1.2.2.3" xref="S1.SS1.SSS1.p2.6.m1.1.2.2.3.cmml">P</mi></msub><mo id="S1.SS1.SSS1.p2.6.m1.1.2.1" xref="S1.SS1.SSS1.p2.6.m1.1.2.1.cmml">⁢</mo><mrow id="S1.SS1.SSS1.p2.6.m1.1.2.3.2" xref="S1.SS1.SSS1.p2.6.m1.1.2.cmml"><mo stretchy="false" id="S1.SS1.SSS1.p2.6.m1.1.2.3.2.1" xref="S1.SS1.SSS1.p2.6.m1.1.2.cmml">(</mo><mi id="S1.SS1.SSS1.p2.6.m1.1.1" xref="S1.SS1.SSS1.p2.6.m1.1.1.cmml">θ</mi><mo stretchy="false" id="S1.SS1.SSS1.p2.6.m1.1.2.3.2.2" xref="S1.SS1.SSS1.p2.6.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.SS1.SSS1.p2.6.m1.1b"><apply id="S1.SS1.SSS1.p2.6.m1.1.2.cmml" xref="S1.SS1.SSS1.p2.6.m1.1.2"><times id="S1.SS1.SSS1.p2.6.m1.1.2.1.cmml" xref="S1.SS1.SSS1.p2.6.m1.1.2.1"></times><apply id="S1.SS1.SSS1.p2.6.m1.1.2.2.cmml" xref="S1.SS1.SSS1.p2.6.m1.1.2.2"><csymbol cd="ambiguous" id="S1.SS1.SSS1.p2.6.m1.1.2.2.1.cmml" xref="S1.SS1.SSS1.p2.6.m1.1.2.2">subscript</csymbol><ci id="S1.SS1.SSS1.p2.6.m1.1.2.2.2.cmml" xref="S1.SS1.SSS1.p2.6.m1.1.2.2.2">𝑅</ci><ci id="S1.SS1.SSS1.p2.6.m1.1.2.2.3.cmml" xref="S1.SS1.SSS1.p2.6.m1.1.2.2.3">𝑃</ci></apply><ci id="S1.SS1.SSS1.p2.6.m1.1.1.cmml" xref="S1.SS1.SSS1.p2.6.m1.1.1">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.SS1.SSS1.p2.6.m1.1c">R_{P}(\theta)</annotation><annotation encoding="application/x-llamapun" id="S1.SS1.SSS1.p2.6.m1.1d">italic_R start_POSTSUBSCRIPT italic_P end_POSTSUBSCRIPT ( italic_θ )</annotation></semantics></math> <math id="S1.SS1.SSS1.p2.7.m2.1" class="ltx_Math" alttext=":=" display="inline"><semantics id="S1.SS1.SSS1.p2.7.m2.1a"><mo id="S1.SS1.SSS1.p2.7.m2.1.1" xref="S1.SS1.SSS1.p2.7.m2.1.1.cmml">:=</mo><annotation-xml encoding="MathML-Content" id="S1.SS1.SSS1.p2.7.m2.1b"><csymbol cd="latexml" id="S1.SS1.SSS1.p2.7.m2.1.1.cmml" xref="S1.SS1.SSS1.p2.7.m2.1.1">assign</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S1.SS1.SSS1.p2.7.m2.1c">:=</annotation><annotation encoding="application/x-llamapun" id="S1.SS1.SSS1.p2.7.m2.1d">:=</annotation></semantics></math> <math id="S1.SS1.SSS1.p2.8.m3.1" class="ltx_Math" alttext="\text{exp}(-i\theta P/2)" display="inline"><semantics id="S1.SS1.SSS1.p2.8.m3.1a"><mrow id="S1.SS1.SSS1.p2.8.m3.1.1" xref="S1.SS1.SSS1.p2.8.m3.1.1.cmml"><mtext id="S1.SS1.SSS1.p2.8.m3.1.1.3" xref="S1.SS1.SSS1.p2.8.m3.1.1.3a.cmml">exp</mtext><mo id="S1.SS1.SSS1.p2.8.m3.1.1.2" xref="S1.SS1.SSS1.p2.8.m3.1.1.2.cmml">⁢</mo><mrow id="S1.SS1.SSS1.p2.8.m3.1.1.1.1" xref="S1.SS1.SSS1.p2.8.m3.1.1.1.1.1.cmml"><mo stretchy="false" id="S1.SS1.SSS1.p2.8.m3.1.1.1.1.2" xref="S1.SS1.SSS1.p2.8.m3.1.1.1.1.1.cmml">(</mo><mrow id="S1.SS1.SSS1.p2.8.m3.1.1.1.1.1" xref="S1.SS1.SSS1.p2.8.m3.1.1.1.1.1.cmml"><mo id="S1.SS1.SSS1.p2.8.m3.1.1.1.1.1.1" xref="S1.SS1.SSS1.p2.8.m3.1.1.1.1.1.1.cmml">-</mo><mrow id="S1.SS1.SSS1.p2.8.m3.1.1.1.1.1.2" xref="S1.SS1.SSS1.p2.8.m3.1.1.1.1.1.2.cmml"><mrow id="S1.SS1.SSS1.p2.8.m3.1.1.1.1.1.2.2" xref="S1.SS1.SSS1.p2.8.m3.1.1.1.1.1.2.2.cmml"><mi id="S1.SS1.SSS1.p2.8.m3.1.1.1.1.1.2.2.2" xref="S1.SS1.SSS1.p2.8.m3.1.1.1.1.1.2.2.2.cmml">i</mi><mo id="S1.SS1.SSS1.p2.8.m3.1.1.1.1.1.2.2.1" xref="S1.SS1.SSS1.p2.8.m3.1.1.1.1.1.2.2.1.cmml">⁢</mo><mi id="S1.SS1.SSS1.p2.8.m3.1.1.1.1.1.2.2.3" xref="S1.SS1.SSS1.p2.8.m3.1.1.1.1.1.2.2.3.cmml">θ</mi><mo id="S1.SS1.SSS1.p2.8.m3.1.1.1.1.1.2.2.1a" xref="S1.SS1.SSS1.p2.8.m3.1.1.1.1.1.2.2.1.cmml">⁢</mo><mi id="S1.SS1.SSS1.p2.8.m3.1.1.1.1.1.2.2.4" xref="S1.SS1.SSS1.p2.8.m3.1.1.1.1.1.2.2.4.cmml">P</mi></mrow><mo id="S1.SS1.SSS1.p2.8.m3.1.1.1.1.1.2.1" xref="S1.SS1.SSS1.p2.8.m3.1.1.1.1.1.2.1.cmml">/</mo><mn id="S1.SS1.SSS1.p2.8.m3.1.1.1.1.1.2.3" xref="S1.SS1.SSS1.p2.8.m3.1.1.1.1.1.2.3.cmml">2</mn></mrow></mrow><mo stretchy="false" id="S1.SS1.SSS1.p2.8.m3.1.1.1.1.3" xref="S1.SS1.SSS1.p2.8.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.SS1.SSS1.p2.8.m3.1b"><apply id="S1.SS1.SSS1.p2.8.m3.1.1.cmml" xref="S1.SS1.SSS1.p2.8.m3.1.1"><times id="S1.SS1.SSS1.p2.8.m3.1.1.2.cmml" xref="S1.SS1.SSS1.p2.8.m3.1.1.2"></times><ci id="S1.SS1.SSS1.p2.8.m3.1.1.3a.cmml" xref="S1.SS1.SSS1.p2.8.m3.1.1.3"><mtext id="S1.SS1.SSS1.p2.8.m3.1.1.3.cmml" xref="S1.SS1.SSS1.p2.8.m3.1.1.3">exp</mtext></ci><apply id="S1.SS1.SSS1.p2.8.m3.1.1.1.1.1.cmml" xref="S1.SS1.SSS1.p2.8.m3.1.1.1.1"><minus id="S1.SS1.SSS1.p2.8.m3.1.1.1.1.1.1.cmml" xref="S1.SS1.SSS1.p2.8.m3.1.1.1.1.1.1"></minus><apply id="S1.SS1.SSS1.p2.8.m3.1.1.1.1.1.2.cmml" xref="S1.SS1.SSS1.p2.8.m3.1.1.1.1.1.2"><divide id="S1.SS1.SSS1.p2.8.m3.1.1.1.1.1.2.1.cmml" xref="S1.SS1.SSS1.p2.8.m3.1.1.1.1.1.2.1"></divide><apply id="S1.SS1.SSS1.p2.8.m3.1.1.1.1.1.2.2.cmml" xref="S1.SS1.SSS1.p2.8.m3.1.1.1.1.1.2.2"><times id="S1.SS1.SSS1.p2.8.m3.1.1.1.1.1.2.2.1.cmml" xref="S1.SS1.SSS1.p2.8.m3.1.1.1.1.1.2.2.1"></times><ci id="S1.SS1.SSS1.p2.8.m3.1.1.1.1.1.2.2.2.cmml" xref="S1.SS1.SSS1.p2.8.m3.1.1.1.1.1.2.2.2">𝑖</ci><ci id="S1.SS1.SSS1.p2.8.m3.1.1.1.1.1.2.2.3.cmml" xref="S1.SS1.SSS1.p2.8.m3.1.1.1.1.1.2.2.3">𝜃</ci><ci id="S1.SS1.SSS1.p2.8.m3.1.1.1.1.1.2.2.4.cmml" xref="S1.SS1.SSS1.p2.8.m3.1.1.1.1.1.2.2.4">𝑃</ci></apply><cn type="integer" id="S1.SS1.SSS1.p2.8.m3.1.1.1.1.1.2.3.cmml" xref="S1.SS1.SSS1.p2.8.m3.1.1.1.1.1.2.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.SS1.SSS1.p2.8.m3.1c">\text{exp}(-i\theta P/2)</annotation><annotation encoding="application/x-llamapun" id="S1.SS1.SSS1.p2.8.m3.1d">exp ( - italic_i italic_θ italic_P / 2 )</annotation></semantics></math> <math id="S1.SS1.SSS1.p2.9.m4.1" class="ltx_Math" alttext="=\cos\frac{\theta}{2}I-i\sin\frac{\theta}{2}P" display="inline"><semantics id="S1.SS1.SSS1.p2.9.m4.1a"><mrow id="S1.SS1.SSS1.p2.9.m4.1.1" xref="S1.SS1.SSS1.p2.9.m4.1.1.cmml"><mi id="S1.SS1.SSS1.p2.9.m4.1.1.2" xref="S1.SS1.SSS1.p2.9.m4.1.1.2.cmml"></mi><mo id="S1.SS1.SSS1.p2.9.m4.1.1.1" xref="S1.SS1.SSS1.p2.9.m4.1.1.1.cmml">=</mo><mrow id="S1.SS1.SSS1.p2.9.m4.1.1.3" xref="S1.SS1.SSS1.p2.9.m4.1.1.3.cmml"><mrow id="S1.SS1.SSS1.p2.9.m4.1.1.3.2" xref="S1.SS1.SSS1.p2.9.m4.1.1.3.2.cmml"><mi id="S1.SS1.SSS1.p2.9.m4.1.1.3.2.1" xref="S1.SS1.SSS1.p2.9.m4.1.1.3.2.1.cmml">cos</mi><mo id="S1.SS1.SSS1.p2.9.m4.1.1.3.2a" xref="S1.SS1.SSS1.p2.9.m4.1.1.3.2.cmml">⁡</mo><mrow id="S1.SS1.SSS1.p2.9.m4.1.1.3.2.2" xref="S1.SS1.SSS1.p2.9.m4.1.1.3.2.2.cmml"><mfrac id="S1.SS1.SSS1.p2.9.m4.1.1.3.2.2.2" xref="S1.SS1.SSS1.p2.9.m4.1.1.3.2.2.2.cmml"><mi id="S1.SS1.SSS1.p2.9.m4.1.1.3.2.2.2.2" xref="S1.SS1.SSS1.p2.9.m4.1.1.3.2.2.2.2.cmml">θ</mi><mn id="S1.SS1.SSS1.p2.9.m4.1.1.3.2.2.2.3" xref="S1.SS1.SSS1.p2.9.m4.1.1.3.2.2.2.3.cmml">2</mn></mfrac><mo id="S1.SS1.SSS1.p2.9.m4.1.1.3.2.2.1" xref="S1.SS1.SSS1.p2.9.m4.1.1.3.2.2.1.cmml">⁢</mo><mi id="S1.SS1.SSS1.p2.9.m4.1.1.3.2.2.3" xref="S1.SS1.SSS1.p2.9.m4.1.1.3.2.2.3.cmml">I</mi></mrow></mrow><mo id="S1.SS1.SSS1.p2.9.m4.1.1.3.1" xref="S1.SS1.SSS1.p2.9.m4.1.1.3.1.cmml">-</mo><mrow id="S1.SS1.SSS1.p2.9.m4.1.1.3.3" xref="S1.SS1.SSS1.p2.9.m4.1.1.3.3.cmml"><mi id="S1.SS1.SSS1.p2.9.m4.1.1.3.3.2" xref="S1.SS1.SSS1.p2.9.m4.1.1.3.3.2.cmml">i</mi><mo id="S1.SS1.SSS1.p2.9.m4.1.1.3.3.1" xref="S1.SS1.SSS1.p2.9.m4.1.1.3.3.1.cmml">⁢</mo><mrow id="S1.SS1.SSS1.p2.9.m4.1.1.3.3.3" xref="S1.SS1.SSS1.p2.9.m4.1.1.3.3.3.cmml"><mi id="S1.SS1.SSS1.p2.9.m4.1.1.3.3.3.1" xref="S1.SS1.SSS1.p2.9.m4.1.1.3.3.3.1.cmml">sin</mi><mo id="S1.SS1.SSS1.p2.9.m4.1.1.3.3.3a" xref="S1.SS1.SSS1.p2.9.m4.1.1.3.3.3.cmml">⁡</mo><mrow id="S1.SS1.SSS1.p2.9.m4.1.1.3.3.3.2" xref="S1.SS1.SSS1.p2.9.m4.1.1.3.3.3.2.cmml"><mfrac id="S1.SS1.SSS1.p2.9.m4.1.1.3.3.3.2.2" xref="S1.SS1.SSS1.p2.9.m4.1.1.3.3.3.2.2.cmml"><mi id="S1.SS1.SSS1.p2.9.m4.1.1.3.3.3.2.2.2" xref="S1.SS1.SSS1.p2.9.m4.1.1.3.3.3.2.2.2.cmml">θ</mi><mn id="S1.SS1.SSS1.p2.9.m4.1.1.3.3.3.2.2.3" xref="S1.SS1.SSS1.p2.9.m4.1.1.3.3.3.2.2.3.cmml">2</mn></mfrac><mo id="S1.SS1.SSS1.p2.9.m4.1.1.3.3.3.2.1" xref="S1.SS1.SSS1.p2.9.m4.1.1.3.3.3.2.1.cmml">⁢</mo><mi id="S1.SS1.SSS1.p2.9.m4.1.1.3.3.3.2.3" xref="S1.SS1.SSS1.p2.9.m4.1.1.3.3.3.2.3.cmml">P</mi></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.SS1.SSS1.p2.9.m4.1b"><apply id="S1.SS1.SSS1.p2.9.m4.1.1.cmml" xref="S1.SS1.SSS1.p2.9.m4.1.1"><eq id="S1.SS1.SSS1.p2.9.m4.1.1.1.cmml" xref="S1.SS1.SSS1.p2.9.m4.1.1.1"></eq><csymbol cd="latexml" id="S1.SS1.SSS1.p2.9.m4.1.1.2.cmml" xref="S1.SS1.SSS1.p2.9.m4.1.1.2">absent</csymbol><apply id="S1.SS1.SSS1.p2.9.m4.1.1.3.cmml" xref="S1.SS1.SSS1.p2.9.m4.1.1.3"><minus id="S1.SS1.SSS1.p2.9.m4.1.1.3.1.cmml" xref="S1.SS1.SSS1.p2.9.m4.1.1.3.1"></minus><apply id="S1.SS1.SSS1.p2.9.m4.1.1.3.2.cmml" xref="S1.SS1.SSS1.p2.9.m4.1.1.3.2"><cos id="S1.SS1.SSS1.p2.9.m4.1.1.3.2.1.cmml" xref="S1.SS1.SSS1.p2.9.m4.1.1.3.2.1"></cos><apply id="S1.SS1.SSS1.p2.9.m4.1.1.3.2.2.cmml" xref="S1.SS1.SSS1.p2.9.m4.1.1.3.2.2"><times id="S1.SS1.SSS1.p2.9.m4.1.1.3.2.2.1.cmml" xref="S1.SS1.SSS1.p2.9.m4.1.1.3.2.2.1"></times><apply id="S1.SS1.SSS1.p2.9.m4.1.1.3.2.2.2.cmml" xref="S1.SS1.SSS1.p2.9.m4.1.1.3.2.2.2"><divide id="S1.SS1.SSS1.p2.9.m4.1.1.3.2.2.2.1.cmml" xref="S1.SS1.SSS1.p2.9.m4.1.1.3.2.2.2"></divide><ci id="S1.SS1.SSS1.p2.9.m4.1.1.3.2.2.2.2.cmml" xref="S1.SS1.SSS1.p2.9.m4.1.1.3.2.2.2.2">𝜃</ci><cn type="integer" id="S1.SS1.SSS1.p2.9.m4.1.1.3.2.2.2.3.cmml" xref="S1.SS1.SSS1.p2.9.m4.1.1.3.2.2.2.3">2</cn></apply><ci id="S1.SS1.SSS1.p2.9.m4.1.1.3.2.2.3.cmml" xref="S1.SS1.SSS1.p2.9.m4.1.1.3.2.2.3">𝐼</ci></apply></apply><apply id="S1.SS1.SSS1.p2.9.m4.1.1.3.3.cmml" xref="S1.SS1.SSS1.p2.9.m4.1.1.3.3"><times id="S1.SS1.SSS1.p2.9.m4.1.1.3.3.1.cmml" xref="S1.SS1.SSS1.p2.9.m4.1.1.3.3.1"></times><ci id="S1.SS1.SSS1.p2.9.m4.1.1.3.3.2.cmml" xref="S1.SS1.SSS1.p2.9.m4.1.1.3.3.2">𝑖</ci><apply id="S1.SS1.SSS1.p2.9.m4.1.1.3.3.3.cmml" xref="S1.SS1.SSS1.p2.9.m4.1.1.3.3.3"><sin id="S1.SS1.SSS1.p2.9.m4.1.1.3.3.3.1.cmml" xref="S1.SS1.SSS1.p2.9.m4.1.1.3.3.3.1"></sin><apply id="S1.SS1.SSS1.p2.9.m4.1.1.3.3.3.2.cmml" xref="S1.SS1.SSS1.p2.9.m4.1.1.3.3.3.2"><times id="S1.SS1.SSS1.p2.9.m4.1.1.3.3.3.2.1.cmml" xref="S1.SS1.SSS1.p2.9.m4.1.1.3.3.3.2.1"></times><apply id="S1.SS1.SSS1.p2.9.m4.1.1.3.3.3.2.2.cmml" xref="S1.SS1.SSS1.p2.9.m4.1.1.3.3.3.2.2"><divide id="S1.SS1.SSS1.p2.9.m4.1.1.3.3.3.2.2.1.cmml" xref="S1.SS1.SSS1.p2.9.m4.1.1.3.3.3.2.2"></divide><ci id="S1.SS1.SSS1.p2.9.m4.1.1.3.3.3.2.2.2.cmml" xref="S1.SS1.SSS1.p2.9.m4.1.1.3.3.3.2.2.2">𝜃</ci><cn type="integer" id="S1.SS1.SSS1.p2.9.m4.1.1.3.3.3.2.2.3.cmml" xref="S1.SS1.SSS1.p2.9.m4.1.1.3.3.3.2.2.3">2</cn></apply><ci id="S1.SS1.SSS1.p2.9.m4.1.1.3.3.3.2.3.cmml" xref="S1.SS1.SSS1.p2.9.m4.1.1.3.3.3.2.3">𝑃</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.SS1.SSS1.p2.9.m4.1c">=\cos\frac{\theta}{2}I-i\sin\frac{\theta}{2}P</annotation><annotation encoding="application/x-llamapun" id="S1.SS1.SSS1.p2.9.m4.1d">= roman_cos divide start_ARG italic_θ end_ARG start_ARG 2 end_ARG italic_I - italic_i roman_sin divide start_ARG italic_θ end_ARG start_ARG 2 end_ARG italic_P</annotation></semantics></math>, where the rotation angle <math id="S1.SS1.SSS1.p2.10.m5.2" class="ltx_Math" alttext="\theta\in[0,2\pi)" display="inline"><semantics id="S1.SS1.SSS1.p2.10.m5.2a"><mrow id="S1.SS1.SSS1.p2.10.m5.2.2" xref="S1.SS1.SSS1.p2.10.m5.2.2.cmml"><mi id="S1.SS1.SSS1.p2.10.m5.2.2.3" xref="S1.SS1.SSS1.p2.10.m5.2.2.3.cmml">θ</mi><mo id="S1.SS1.SSS1.p2.10.m5.2.2.2" xref="S1.SS1.SSS1.p2.10.m5.2.2.2.cmml">∈</mo><mrow id="S1.SS1.SSS1.p2.10.m5.2.2.1.1" xref="S1.SS1.SSS1.p2.10.m5.2.2.1.2.cmml"><mo stretchy="false" id="S1.SS1.SSS1.p2.10.m5.2.2.1.1.2" xref="S1.SS1.SSS1.p2.10.m5.2.2.1.2.cmml">[</mo><mn id="S1.SS1.SSS1.p2.10.m5.1.1" xref="S1.SS1.SSS1.p2.10.m5.1.1.cmml">0</mn><mo id="S1.SS1.SSS1.p2.10.m5.2.2.1.1.3" xref="S1.SS1.SSS1.p2.10.m5.2.2.1.2.cmml">,</mo><mrow id="S1.SS1.SSS1.p2.10.m5.2.2.1.1.1" xref="S1.SS1.SSS1.p2.10.m5.2.2.1.1.1.cmml"><mn id="S1.SS1.SSS1.p2.10.m5.2.2.1.1.1.2" xref="S1.SS1.SSS1.p2.10.m5.2.2.1.1.1.2.cmml">2</mn><mo id="S1.SS1.SSS1.p2.10.m5.2.2.1.1.1.1" xref="S1.SS1.SSS1.p2.10.m5.2.2.1.1.1.1.cmml">⁢</mo><mi id="S1.SS1.SSS1.p2.10.m5.2.2.1.1.1.3" xref="S1.SS1.SSS1.p2.10.m5.2.2.1.1.1.3.cmml">π</mi></mrow><mo stretchy="false" id="S1.SS1.SSS1.p2.10.m5.2.2.1.1.4" xref="S1.SS1.SSS1.p2.10.m5.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.SS1.SSS1.p2.10.m5.2b"><apply id="S1.SS1.SSS1.p2.10.m5.2.2.cmml" xref="S1.SS1.SSS1.p2.10.m5.2.2"><in id="S1.SS1.SSS1.p2.10.m5.2.2.2.cmml" xref="S1.SS1.SSS1.p2.10.m5.2.2.2"></in><ci id="S1.SS1.SSS1.p2.10.m5.2.2.3.cmml" xref="S1.SS1.SSS1.p2.10.m5.2.2.3">𝜃</ci><interval closure="closed-open" id="S1.SS1.SSS1.p2.10.m5.2.2.1.2.cmml" xref="S1.SS1.SSS1.p2.10.m5.2.2.1.1"><cn type="integer" id="S1.SS1.SSS1.p2.10.m5.1.1.cmml" xref="S1.SS1.SSS1.p2.10.m5.1.1">0</cn><apply id="S1.SS1.SSS1.p2.10.m5.2.2.1.1.1.cmml" xref="S1.SS1.SSS1.p2.10.m5.2.2.1.1.1"><times id="S1.SS1.SSS1.p2.10.m5.2.2.1.1.1.1.cmml" xref="S1.SS1.SSS1.p2.10.m5.2.2.1.1.1.1"></times><cn type="integer" id="S1.SS1.SSS1.p2.10.m5.2.2.1.1.1.2.cmml" xref="S1.SS1.SSS1.p2.10.m5.2.2.1.1.1.2">2</cn><ci id="S1.SS1.SSS1.p2.10.m5.2.2.1.1.1.3.cmml" xref="S1.SS1.SSS1.p2.10.m5.2.2.1.1.1.3">𝜋</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.SS1.SSS1.p2.10.m5.2c">\theta\in[0,2\pi)</annotation><annotation encoding="application/x-llamapun" id="S1.SS1.SSS1.p2.10.m5.2d">italic_θ ∈ [ 0 , 2 italic_π )</annotation></semantics></math> and <math id="S1.SS1.SSS1.p2.11.m6.3" class="ltx_Math" alttext="P\in\{X,Y,Z\}" display="inline"><semantics id="S1.SS1.SSS1.p2.11.m6.3a"><mrow id="S1.SS1.SSS1.p2.11.m6.3.4" xref="S1.SS1.SSS1.p2.11.m6.3.4.cmml"><mi id="S1.SS1.SSS1.p2.11.m6.3.4.2" xref="S1.SS1.SSS1.p2.11.m6.3.4.2.cmml">P</mi><mo id="S1.SS1.SSS1.p2.11.m6.3.4.1" xref="S1.SS1.SSS1.p2.11.m6.3.4.1.cmml">∈</mo><mrow id="S1.SS1.SSS1.p2.11.m6.3.4.3.2" xref="S1.SS1.SSS1.p2.11.m6.3.4.3.1.cmml"><mo stretchy="false" id="S1.SS1.SSS1.p2.11.m6.3.4.3.2.1" xref="S1.SS1.SSS1.p2.11.m6.3.4.3.1.cmml">{</mo><mi id="S1.SS1.SSS1.p2.11.m6.1.1" xref="S1.SS1.SSS1.p2.11.m6.1.1.cmml">X</mi><mo id="S1.SS1.SSS1.p2.11.m6.3.4.3.2.2" xref="S1.SS1.SSS1.p2.11.m6.3.4.3.1.cmml">,</mo><mi id="S1.SS1.SSS1.p2.11.m6.2.2" xref="S1.SS1.SSS1.p2.11.m6.2.2.cmml">Y</mi><mo id="S1.SS1.SSS1.p2.11.m6.3.4.3.2.3" xref="S1.SS1.SSS1.p2.11.m6.3.4.3.1.cmml">,</mo><mi id="S1.SS1.SSS1.p2.11.m6.3.3" xref="S1.SS1.SSS1.p2.11.m6.3.3.cmml">Z</mi><mo stretchy="false" id="S1.SS1.SSS1.p2.11.m6.3.4.3.2.4" xref="S1.SS1.SSS1.p2.11.m6.3.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.SS1.SSS1.p2.11.m6.3b"><apply id="S1.SS1.SSS1.p2.11.m6.3.4.cmml" xref="S1.SS1.SSS1.p2.11.m6.3.4"><in id="S1.SS1.SSS1.p2.11.m6.3.4.1.cmml" xref="S1.SS1.SSS1.p2.11.m6.3.4.1"></in><ci id="S1.SS1.SSS1.p2.11.m6.3.4.2.cmml" xref="S1.SS1.SSS1.p2.11.m6.3.4.2">𝑃</ci><set id="S1.SS1.SSS1.p2.11.m6.3.4.3.1.cmml" xref="S1.SS1.SSS1.p2.11.m6.3.4.3.2"><ci id="S1.SS1.SSS1.p2.11.m6.1.1.cmml" xref="S1.SS1.SSS1.p2.11.m6.1.1">𝑋</ci><ci id="S1.SS1.SSS1.p2.11.m6.2.2.cmml" xref="S1.SS1.SSS1.p2.11.m6.2.2">𝑌</ci><ci id="S1.SS1.SSS1.p2.11.m6.3.3.cmml" xref="S1.SS1.SSS1.p2.11.m6.3.3">𝑍</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.SS1.SSS1.p2.11.m6.3c">P\in\{X,Y,Z\}</annotation><annotation encoding="application/x-llamapun" id="S1.SS1.SSS1.p2.11.m6.3d">italic_P ∈ { italic_X , italic_Y , italic_Z }</annotation></semantics></math>. Multiple-qubit quantum gates mainly include, in this paper, the identity gate <math id="S1.SS1.SSS1.p2.12.m7.1" class="ltx_Math" alttext="I" display="inline"><semantics id="S1.SS1.SSS1.p2.12.m7.1a"><mi id="S1.SS1.SSS1.p2.12.m7.1.1" xref="S1.SS1.SSS1.p2.12.m7.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="S1.SS1.SSS1.p2.12.m7.1b"><ci id="S1.SS1.SSS1.p2.12.m7.1.1.cmml" xref="S1.SS1.SSS1.p2.12.m7.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.SS1.SSS1.p2.12.m7.1c">I</annotation><annotation encoding="application/x-llamapun" id="S1.SS1.SSS1.p2.12.m7.1d">italic_I</annotation></semantics></math>, the CNOT gate and the tensor product of single-qubit gates, e.g., <math id="S1.SS1.SSS1.p2.13.m8.1" class="ltx_Math" alttext="Z\otimes Z" display="inline"><semantics id="S1.SS1.SSS1.p2.13.m8.1a"><mrow id="S1.SS1.SSS1.p2.13.m8.1.1" xref="S1.SS1.SSS1.p2.13.m8.1.1.cmml"><mi id="S1.SS1.SSS1.p2.13.m8.1.1.2" xref="S1.SS1.SSS1.p2.13.m8.1.1.2.cmml">Z</mi><mo id="S1.SS1.SSS1.p2.13.m8.1.1.1" xref="S1.SS1.SSS1.p2.13.m8.1.1.1.cmml">⊗</mo><mi id="S1.SS1.SSS1.p2.13.m8.1.1.3" xref="S1.SS1.SSS1.p2.13.m8.1.1.3.cmml">Z</mi></mrow><annotation-xml encoding="MathML-Content" id="S1.SS1.SSS1.p2.13.m8.1b"><apply id="S1.SS1.SSS1.p2.13.m8.1.1.cmml" xref="S1.SS1.SSS1.p2.13.m8.1.1"><csymbol cd="latexml" id="S1.SS1.SSS1.p2.13.m8.1.1.1.cmml" xref="S1.SS1.SSS1.p2.13.m8.1.1.1">tensor-product</csymbol><ci id="S1.SS1.SSS1.p2.13.m8.1.1.2.cmml" xref="S1.SS1.SSS1.p2.13.m8.1.1.2">𝑍</ci><ci id="S1.SS1.SSS1.p2.13.m8.1.1.3.cmml" xref="S1.SS1.SSS1.p2.13.m8.1.1.3">𝑍</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.SS1.SSS1.p2.13.m8.1c">Z\otimes Z</annotation><annotation encoding="application/x-llamapun" id="S1.SS1.SSS1.p2.13.m8.1d">italic_Z ⊗ italic_Z</annotation></semantics></math>, <math id="S1.SS1.SSS1.p2.14.m9.1" class="ltx_Math" alttext="Z\otimes I" display="inline"><semantics id="S1.SS1.SSS1.p2.14.m9.1a"><mrow id="S1.SS1.SSS1.p2.14.m9.1.1" xref="S1.SS1.SSS1.p2.14.m9.1.1.cmml"><mi id="S1.SS1.SSS1.p2.14.m9.1.1.2" xref="S1.SS1.SSS1.p2.14.m9.1.1.2.cmml">Z</mi><mo id="S1.SS1.SSS1.p2.14.m9.1.1.1" xref="S1.SS1.SSS1.p2.14.m9.1.1.1.cmml">⊗</mo><mi id="S1.SS1.SSS1.p2.14.m9.1.1.3" xref="S1.SS1.SSS1.p2.14.m9.1.1.3.cmml">I</mi></mrow><annotation-xml encoding="MathML-Content" id="S1.SS1.SSS1.p2.14.m9.1b"><apply id="S1.SS1.SSS1.p2.14.m9.1.1.cmml" xref="S1.SS1.SSS1.p2.14.m9.1.1"><csymbol cd="latexml" id="S1.SS1.SSS1.p2.14.m9.1.1.1.cmml" xref="S1.SS1.SSS1.p2.14.m9.1.1.1">tensor-product</csymbol><ci id="S1.SS1.SSS1.p2.14.m9.1.1.2.cmml" xref="S1.SS1.SSS1.p2.14.m9.1.1.2">𝑍</ci><ci id="S1.SS1.SSS1.p2.14.m9.1.1.3.cmml" xref="S1.SS1.SSS1.p2.14.m9.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.SS1.SSS1.p2.14.m9.1c">Z\otimes I</annotation><annotation encoding="application/x-llamapun" id="S1.SS1.SSS1.p2.14.m9.1d">italic_Z ⊗ italic_I</annotation></semantics></math>, <math id="S1.SS1.SSS1.p2.15.m10.1" class="ltx_Math" alttext="Z^{\otimes n}" display="inline"><semantics id="S1.SS1.SSS1.p2.15.m10.1a"><msup id="S1.SS1.SSS1.p2.15.m10.1.1" xref="S1.SS1.SSS1.p2.15.m10.1.1.cmml"><mi id="S1.SS1.SSS1.p2.15.m10.1.1.2" xref="S1.SS1.SSS1.p2.15.m10.1.1.2.cmml">Z</mi><mrow id="S1.SS1.SSS1.p2.15.m10.1.1.3" xref="S1.SS1.SSS1.p2.15.m10.1.1.3.cmml"><mi id="S1.SS1.SSS1.p2.15.m10.1.1.3.2" xref="S1.SS1.SSS1.p2.15.m10.1.1.3.2.cmml"></mi><mo id="S1.SS1.SSS1.p2.15.m10.1.1.3.1" xref="S1.SS1.SSS1.p2.15.m10.1.1.3.1.cmml">⊗</mo><mi id="S1.SS1.SSS1.p2.15.m10.1.1.3.3" xref="S1.SS1.SSS1.p2.15.m10.1.1.3.3.cmml">n</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S1.SS1.SSS1.p2.15.m10.1b"><apply id="S1.SS1.SSS1.p2.15.m10.1.1.cmml" xref="S1.SS1.SSS1.p2.15.m10.1.1"><csymbol cd="ambiguous" id="S1.SS1.SSS1.p2.15.m10.1.1.1.cmml" xref="S1.SS1.SSS1.p2.15.m10.1.1">superscript</csymbol><ci id="S1.SS1.SSS1.p2.15.m10.1.1.2.cmml" xref="S1.SS1.SSS1.p2.15.m10.1.1.2">𝑍</ci><apply id="S1.SS1.SSS1.p2.15.m10.1.1.3.cmml" xref="S1.SS1.SSS1.p2.15.m10.1.1.3"><csymbol cd="latexml" id="S1.SS1.SSS1.p2.15.m10.1.1.3.1.cmml" xref="S1.SS1.SSS1.p2.15.m10.1.1.3.1">tensor-product</csymbol><csymbol cd="latexml" id="S1.SS1.SSS1.p2.15.m10.1.1.3.2.cmml" xref="S1.SS1.SSS1.p2.15.m10.1.1.3.2">absent</csymbol><ci id="S1.SS1.SSS1.p2.15.m10.1.1.3.3.cmml" xref="S1.SS1.SSS1.p2.15.m10.1.1.3.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.SS1.SSS1.p2.15.m10.1c">Z^{\otimes n}</annotation><annotation encoding="application/x-llamapun" id="S1.SS1.SSS1.p2.15.m10.1d">italic_Z start_POSTSUPERSCRIPT ⊗ italic_n end_POSTSUPERSCRIPT</annotation></semantics></math> and so on.</p>
</div>
<div id="S1.SS1.SSS1.p3" class="ltx_para">
<p id="S1.SS1.SSS1.p3.9" class="ltx_p">Quantum measurement is a way to extract classical information from a quantum state. For instance, given a quantum state <math id="S1.SS1.SSS1.p3.1.m1.1" class="ltx_Math" alttext="\ket{\psi}" display="inline"><semantics id="S1.SS1.SSS1.p3.1.m1.1a"><mrow id="S1.SS1.SSS1.p3.1.m1.1.1" xref="S1.SS1.SSS1.p3.1.m1.1.1.cmml"><merror class="ltx_ERROR undefined undefined" id="S1.SS1.SSS1.p3.1.m1.1.1.2" xref="S1.SS1.SSS1.p3.1.m1.1.1.2b.cmml"><mtext id="S1.SS1.SSS1.p3.1.m1.1.1.2a" xref="S1.SS1.SSS1.p3.1.m1.1.1.2b.cmml">\ket</mtext></merror><mo id="S1.SS1.SSS1.p3.1.m1.1.1.1" xref="S1.SS1.SSS1.p3.1.m1.1.1.1.cmml">⁢</mo><mi id="S1.SS1.SSS1.p3.1.m1.1.1.3" xref="S1.SS1.SSS1.p3.1.m1.1.1.3.cmml">ψ</mi></mrow><annotation-xml encoding="MathML-Content" id="S1.SS1.SSS1.p3.1.m1.1b"><apply id="S1.SS1.SSS1.p3.1.m1.1.1.cmml" xref="S1.SS1.SSS1.p3.1.m1.1.1"><times id="S1.SS1.SSS1.p3.1.m1.1.1.1.cmml" xref="S1.SS1.SSS1.p3.1.m1.1.1.1"></times><ci id="S1.SS1.SSS1.p3.1.m1.1.1.2b.cmml" xref="S1.SS1.SSS1.p3.1.m1.1.1.2"><merror class="ltx_ERROR undefined undefined" id="S1.SS1.SSS1.p3.1.m1.1.1.2.cmml" xref="S1.SS1.SSS1.p3.1.m1.1.1.2"><mtext id="S1.SS1.SSS1.p3.1.m1.1.1.2a.cmml" xref="S1.SS1.SSS1.p3.1.m1.1.1.2">\ket</mtext></merror></ci><ci id="S1.SS1.SSS1.p3.1.m1.1.1.3.cmml" xref="S1.SS1.SSS1.p3.1.m1.1.1.3">𝜓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.SS1.SSS1.p3.1.m1.1c">\ket{\psi}</annotation><annotation encoding="application/x-llamapun" id="S1.SS1.SSS1.p3.1.m1.1d">italic_ψ</annotation></semantics></math> and an observable <math id="S1.SS1.SSS1.p3.2.m2.1" class="ltx_Math" alttext="O" display="inline"><semantics id="S1.SS1.SSS1.p3.2.m2.1a"><mi id="S1.SS1.SSS1.p3.2.m2.1.1" xref="S1.SS1.SSS1.p3.2.m2.1.1.cmml">O</mi><annotation-xml encoding="MathML-Content" id="S1.SS1.SSS1.p3.2.m2.1b"><ci id="S1.SS1.SSS1.p3.2.m2.1.1.cmml" xref="S1.SS1.SSS1.p3.2.m2.1.1">𝑂</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.SS1.SSS1.p3.2.m2.1c">O</annotation><annotation encoding="application/x-llamapun" id="S1.SS1.SSS1.p3.2.m2.1d">italic_O</annotation></semantics></math>, one could design quantum measurements to obtain the information <math id="S1.SS1.SSS1.p3.3.m3.1" class="ltx_Math" alttext="\bra{\psi}O\ket{\psi}" display="inline"><semantics id="S1.SS1.SSS1.p3.3.m3.1a"><mrow id="S1.SS1.SSS1.p3.3.m3.1.1" xref="S1.SS1.SSS1.p3.3.m3.1.1.cmml"><merror class="ltx_ERROR undefined undefined" id="S1.SS1.SSS1.p3.3.m3.1.1.2" xref="S1.SS1.SSS1.p3.3.m3.1.1.2b.cmml"><mtext id="S1.SS1.SSS1.p3.3.m3.1.1.2a" xref="S1.SS1.SSS1.p3.3.m3.1.1.2b.cmml">\bra</mtext></merror><mo id="S1.SS1.SSS1.p3.3.m3.1.1.1" xref="S1.SS1.SSS1.p3.3.m3.1.1.1.cmml">⁢</mo><mi id="S1.SS1.SSS1.p3.3.m3.1.1.3" xref="S1.SS1.SSS1.p3.3.m3.1.1.3.cmml">ψ</mi><mo id="S1.SS1.SSS1.p3.3.m3.1.1.1a" xref="S1.SS1.SSS1.p3.3.m3.1.1.1.cmml">⁢</mo><mi id="S1.SS1.SSS1.p3.3.m3.1.1.4" xref="S1.SS1.SSS1.p3.3.m3.1.1.4.cmml">O</mi><mo id="S1.SS1.SSS1.p3.3.m3.1.1.1b" xref="S1.SS1.SSS1.p3.3.m3.1.1.1.cmml">⁢</mo><merror class="ltx_ERROR undefined undefined" id="S1.SS1.SSS1.p3.3.m3.1.1.5" xref="S1.SS1.SSS1.p3.3.m3.1.1.5b.cmml"><mtext id="S1.SS1.SSS1.p3.3.m3.1.1.5a" xref="S1.SS1.SSS1.p3.3.m3.1.1.5b.cmml">\ket</mtext></merror><mo id="S1.SS1.SSS1.p3.3.m3.1.1.1c" xref="S1.SS1.SSS1.p3.3.m3.1.1.1.cmml">⁢</mo><mi id="S1.SS1.SSS1.p3.3.m3.1.1.6" xref="S1.SS1.SSS1.p3.3.m3.1.1.6.cmml">ψ</mi></mrow><annotation-xml encoding="MathML-Content" id="S1.SS1.SSS1.p3.3.m3.1b"><apply id="S1.SS1.SSS1.p3.3.m3.1.1.cmml" xref="S1.SS1.SSS1.p3.3.m3.1.1"><times id="S1.SS1.SSS1.p3.3.m3.1.1.1.cmml" xref="S1.SS1.SSS1.p3.3.m3.1.1.1"></times><ci id="S1.SS1.SSS1.p3.3.m3.1.1.2b.cmml" xref="S1.SS1.SSS1.p3.3.m3.1.1.2"><merror class="ltx_ERROR undefined undefined" id="S1.SS1.SSS1.p3.3.m3.1.1.2.cmml" xref="S1.SS1.SSS1.p3.3.m3.1.1.2"><mtext id="S1.SS1.SSS1.p3.3.m3.1.1.2a.cmml" xref="S1.SS1.SSS1.p3.3.m3.1.1.2">\bra</mtext></merror></ci><ci id="S1.SS1.SSS1.p3.3.m3.1.1.3.cmml" xref="S1.SS1.SSS1.p3.3.m3.1.1.3">𝜓</ci><ci id="S1.SS1.SSS1.p3.3.m3.1.1.4.cmml" xref="S1.SS1.SSS1.p3.3.m3.1.1.4">𝑂</ci><ci id="S1.SS1.SSS1.p3.3.m3.1.1.5b.cmml" xref="S1.SS1.SSS1.p3.3.m3.1.1.5"><merror class="ltx_ERROR undefined undefined" id="S1.SS1.SSS1.p3.3.m3.1.1.5.cmml" xref="S1.SS1.SSS1.p3.3.m3.1.1.5"><mtext id="S1.SS1.SSS1.p3.3.m3.1.1.5a.cmml" xref="S1.SS1.SSS1.p3.3.m3.1.1.5">\ket</mtext></merror></ci><ci id="S1.SS1.SSS1.p3.3.m3.1.1.6.cmml" xref="S1.SS1.SSS1.p3.3.m3.1.1.6">𝜓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.SS1.SSS1.p3.3.m3.1c">\bra{\psi}O\ket{\psi}</annotation><annotation encoding="application/x-llamapun" id="S1.SS1.SSS1.p3.3.m3.1d">italic_ψ italic_O italic_ψ</annotation></semantics></math>. Within this work, we focus on the hardware-efficient Pauli measurements, i.e., setting <math id="S1.SS1.SSS1.p3.4.m4.1" class="ltx_Math" alttext="O" display="inline"><semantics id="S1.SS1.SSS1.p3.4.m4.1a"><mi id="S1.SS1.SSS1.p3.4.m4.1.1" xref="S1.SS1.SSS1.p3.4.m4.1.1.cmml">O</mi><annotation-xml encoding="MathML-Content" id="S1.SS1.SSS1.p3.4.m4.1b"><ci id="S1.SS1.SSS1.p3.4.m4.1.1.cmml" xref="S1.SS1.SSS1.p3.4.m4.1.1">𝑂</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.SS1.SSS1.p3.4.m4.1c">O</annotation><annotation encoding="application/x-llamapun" id="S1.SS1.SSS1.p3.4.m4.1d">italic_O</annotation></semantics></math> as Pauli operators or their tensor products. For instance, we could choose <math id="S1.SS1.SSS1.p3.5.m5.1" class="ltx_Math" alttext="Z_{1}=Z\otimes I^{\otimes(n-1)}" display="inline"><semantics id="S1.SS1.SSS1.p3.5.m5.1a"><mrow id="S1.SS1.SSS1.p3.5.m5.1.2" xref="S1.SS1.SSS1.p3.5.m5.1.2.cmml"><msub id="S1.SS1.SSS1.p3.5.m5.1.2.2" xref="S1.SS1.SSS1.p3.5.m5.1.2.2.cmml"><mi id="S1.SS1.SSS1.p3.5.m5.1.2.2.2" xref="S1.SS1.SSS1.p3.5.m5.1.2.2.2.cmml">Z</mi><mn id="S1.SS1.SSS1.p3.5.m5.1.2.2.3" xref="S1.SS1.SSS1.p3.5.m5.1.2.2.3.cmml">1</mn></msub><mo id="S1.SS1.SSS1.p3.5.m5.1.2.1" xref="S1.SS1.SSS1.p3.5.m5.1.2.1.cmml">=</mo><mrow id="S1.SS1.SSS1.p3.5.m5.1.2.3" xref="S1.SS1.SSS1.p3.5.m5.1.2.3.cmml"><mi id="S1.SS1.SSS1.p3.5.m5.1.2.3.2" xref="S1.SS1.SSS1.p3.5.m5.1.2.3.2.cmml">Z</mi><mo id="S1.SS1.SSS1.p3.5.m5.1.2.3.1" xref="S1.SS1.SSS1.p3.5.m5.1.2.3.1.cmml">⊗</mo><msup id="S1.SS1.SSS1.p3.5.m5.1.2.3.3" xref="S1.SS1.SSS1.p3.5.m5.1.2.3.3.cmml"><mi id="S1.SS1.SSS1.p3.5.m5.1.2.3.3.2" xref="S1.SS1.SSS1.p3.5.m5.1.2.3.3.2.cmml">I</mi><mrow id="S1.SS1.SSS1.p3.5.m5.1.1.1" xref="S1.SS1.SSS1.p3.5.m5.1.1.1.cmml"><mi id="S1.SS1.SSS1.p3.5.m5.1.1.1.3" xref="S1.SS1.SSS1.p3.5.m5.1.1.1.3.cmml"></mi><mo id="S1.SS1.SSS1.p3.5.m5.1.1.1.2" xref="S1.SS1.SSS1.p3.5.m5.1.1.1.2.cmml">⊗</mo><mrow id="S1.SS1.SSS1.p3.5.m5.1.1.1.1.1" xref="S1.SS1.SSS1.p3.5.m5.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S1.SS1.SSS1.p3.5.m5.1.1.1.1.1.2" xref="S1.SS1.SSS1.p3.5.m5.1.1.1.1.1.1.cmml">(</mo><mrow id="S1.SS1.SSS1.p3.5.m5.1.1.1.1.1.1" xref="S1.SS1.SSS1.p3.5.m5.1.1.1.1.1.1.cmml"><mi id="S1.SS1.SSS1.p3.5.m5.1.1.1.1.1.1.2" xref="S1.SS1.SSS1.p3.5.m5.1.1.1.1.1.1.2.cmml">n</mi><mo id="S1.SS1.SSS1.p3.5.m5.1.1.1.1.1.1.1" xref="S1.SS1.SSS1.p3.5.m5.1.1.1.1.1.1.1.cmml">-</mo><mn id="S1.SS1.SSS1.p3.5.m5.1.1.1.1.1.1.3" xref="S1.SS1.SSS1.p3.5.m5.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S1.SS1.SSS1.p3.5.m5.1.1.1.1.1.3" xref="S1.SS1.SSS1.p3.5.m5.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.SS1.SSS1.p3.5.m5.1b"><apply id="S1.SS1.SSS1.p3.5.m5.1.2.cmml" xref="S1.SS1.SSS1.p3.5.m5.1.2"><eq id="S1.SS1.SSS1.p3.5.m5.1.2.1.cmml" xref="S1.SS1.SSS1.p3.5.m5.1.2.1"></eq><apply id="S1.SS1.SSS1.p3.5.m5.1.2.2.cmml" xref="S1.SS1.SSS1.p3.5.m5.1.2.2"><csymbol cd="ambiguous" id="S1.SS1.SSS1.p3.5.m5.1.2.2.1.cmml" xref="S1.SS1.SSS1.p3.5.m5.1.2.2">subscript</csymbol><ci id="S1.SS1.SSS1.p3.5.m5.1.2.2.2.cmml" xref="S1.SS1.SSS1.p3.5.m5.1.2.2.2">𝑍</ci><cn type="integer" id="S1.SS1.SSS1.p3.5.m5.1.2.2.3.cmml" xref="S1.SS1.SSS1.p3.5.m5.1.2.2.3">1</cn></apply><apply id="S1.SS1.SSS1.p3.5.m5.1.2.3.cmml" xref="S1.SS1.SSS1.p3.5.m5.1.2.3"><csymbol cd="latexml" id="S1.SS1.SSS1.p3.5.m5.1.2.3.1.cmml" xref="S1.SS1.SSS1.p3.5.m5.1.2.3.1">tensor-product</csymbol><ci id="S1.SS1.SSS1.p3.5.m5.1.2.3.2.cmml" xref="S1.SS1.SSS1.p3.5.m5.1.2.3.2">𝑍</ci><apply id="S1.SS1.SSS1.p3.5.m5.1.2.3.3.cmml" xref="S1.SS1.SSS1.p3.5.m5.1.2.3.3"><csymbol cd="ambiguous" id="S1.SS1.SSS1.p3.5.m5.1.2.3.3.1.cmml" xref="S1.SS1.SSS1.p3.5.m5.1.2.3.3">superscript</csymbol><ci id="S1.SS1.SSS1.p3.5.m5.1.2.3.3.2.cmml" xref="S1.SS1.SSS1.p3.5.m5.1.2.3.3.2">𝐼</ci><apply id="S1.SS1.SSS1.p3.5.m5.1.1.1.cmml" xref="S1.SS1.SSS1.p3.5.m5.1.1.1"><csymbol cd="latexml" id="S1.SS1.SSS1.p3.5.m5.1.1.1.2.cmml" xref="S1.SS1.SSS1.p3.5.m5.1.1.1.2">tensor-product</csymbol><csymbol cd="latexml" id="S1.SS1.SSS1.p3.5.m5.1.1.1.3.cmml" xref="S1.SS1.SSS1.p3.5.m5.1.1.1.3">absent</csymbol><apply id="S1.SS1.SSS1.p3.5.m5.1.1.1.1.1.1.cmml" xref="S1.SS1.SSS1.p3.5.m5.1.1.1.1.1"><minus id="S1.SS1.SSS1.p3.5.m5.1.1.1.1.1.1.1.cmml" xref="S1.SS1.SSS1.p3.5.m5.1.1.1.1.1.1.1"></minus><ci id="S1.SS1.SSS1.p3.5.m5.1.1.1.1.1.1.2.cmml" xref="S1.SS1.SSS1.p3.5.m5.1.1.1.1.1.1.2">𝑛</ci><cn type="integer" id="S1.SS1.SSS1.p3.5.m5.1.1.1.1.1.1.3.cmml" xref="S1.SS1.SSS1.p3.5.m5.1.1.1.1.1.1.3">1</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.SS1.SSS1.p3.5.m5.1c">Z_{1}=Z\otimes I^{\otimes(n-1)}</annotation><annotation encoding="application/x-llamapun" id="S1.SS1.SSS1.p3.5.m5.1d">italic_Z start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = italic_Z ⊗ italic_I start_POSTSUPERSCRIPT ⊗ ( italic_n - 1 ) end_POSTSUPERSCRIPT</annotation></semantics></math>, <math id="S1.SS1.SSS1.p3.6.m6.1" class="ltx_Math" alttext="X_{2}=" display="inline"><semantics id="S1.SS1.SSS1.p3.6.m6.1a"><mrow id="S1.SS1.SSS1.p3.6.m6.1.1" xref="S1.SS1.SSS1.p3.6.m6.1.1.cmml"><msub id="S1.SS1.SSS1.p3.6.m6.1.1.2" xref="S1.SS1.SSS1.p3.6.m6.1.1.2.cmml"><mi id="S1.SS1.SSS1.p3.6.m6.1.1.2.2" xref="S1.SS1.SSS1.p3.6.m6.1.1.2.2.cmml">X</mi><mn id="S1.SS1.SSS1.p3.6.m6.1.1.2.3" xref="S1.SS1.SSS1.p3.6.m6.1.1.2.3.cmml">2</mn></msub><mo id="S1.SS1.SSS1.p3.6.m6.1.1.1" xref="S1.SS1.SSS1.p3.6.m6.1.1.1.cmml">=</mo><mi id="S1.SS1.SSS1.p3.6.m6.1.1.3" xref="S1.SS1.SSS1.p3.6.m6.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S1.SS1.SSS1.p3.6.m6.1b"><apply id="S1.SS1.SSS1.p3.6.m6.1.1.cmml" xref="S1.SS1.SSS1.p3.6.m6.1.1"><eq id="S1.SS1.SSS1.p3.6.m6.1.1.1.cmml" xref="S1.SS1.SSS1.p3.6.m6.1.1.1"></eq><apply id="S1.SS1.SSS1.p3.6.m6.1.1.2.cmml" xref="S1.SS1.SSS1.p3.6.m6.1.1.2"><csymbol cd="ambiguous" id="S1.SS1.SSS1.p3.6.m6.1.1.2.1.cmml" xref="S1.SS1.SSS1.p3.6.m6.1.1.2">subscript</csymbol><ci id="S1.SS1.SSS1.p3.6.m6.1.1.2.2.cmml" xref="S1.SS1.SSS1.p3.6.m6.1.1.2.2">𝑋</ci><cn type="integer" id="S1.SS1.SSS1.p3.6.m6.1.1.2.3.cmml" xref="S1.SS1.SSS1.p3.6.m6.1.1.2.3">2</cn></apply><csymbol cd="latexml" id="S1.SS1.SSS1.p3.6.m6.1.1.3.cmml" xref="S1.SS1.SSS1.p3.6.m6.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.SS1.SSS1.p3.6.m6.1c">X_{2}=</annotation><annotation encoding="application/x-llamapun" id="S1.SS1.SSS1.p3.6.m6.1d">italic_X start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT =</annotation></semantics></math> <math id="S1.SS1.SSS1.p3.7.m7.1" class="ltx_Math" alttext="I\otimes X\otimes I^{\otimes(n-2)}" display="inline"><semantics id="S1.SS1.SSS1.p3.7.m7.1a"><mrow id="S1.SS1.SSS1.p3.7.m7.1.2" xref="S1.SS1.SSS1.p3.7.m7.1.2.cmml"><mi id="S1.SS1.SSS1.p3.7.m7.1.2.2" xref="S1.SS1.SSS1.p3.7.m7.1.2.2.cmml">I</mi><mo id="S1.SS1.SSS1.p3.7.m7.1.2.1" xref="S1.SS1.SSS1.p3.7.m7.1.2.1.cmml">⊗</mo><mi id="S1.SS1.SSS1.p3.7.m7.1.2.3" xref="S1.SS1.SSS1.p3.7.m7.1.2.3.cmml">X</mi><mo id="S1.SS1.SSS1.p3.7.m7.1.2.1a" xref="S1.SS1.SSS1.p3.7.m7.1.2.1.cmml">⊗</mo><msup id="S1.SS1.SSS1.p3.7.m7.1.2.4" xref="S1.SS1.SSS1.p3.7.m7.1.2.4.cmml"><mi id="S1.SS1.SSS1.p3.7.m7.1.2.4.2" xref="S1.SS1.SSS1.p3.7.m7.1.2.4.2.cmml">I</mi><mrow id="S1.SS1.SSS1.p3.7.m7.1.1.1" xref="S1.SS1.SSS1.p3.7.m7.1.1.1.cmml"><mi id="S1.SS1.SSS1.p3.7.m7.1.1.1.3" xref="S1.SS1.SSS1.p3.7.m7.1.1.1.3.cmml"></mi><mo id="S1.SS1.SSS1.p3.7.m7.1.1.1.2" xref="S1.SS1.SSS1.p3.7.m7.1.1.1.2.cmml">⊗</mo><mrow id="S1.SS1.SSS1.p3.7.m7.1.1.1.1.1" xref="S1.SS1.SSS1.p3.7.m7.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S1.SS1.SSS1.p3.7.m7.1.1.1.1.1.2" xref="S1.SS1.SSS1.p3.7.m7.1.1.1.1.1.1.cmml">(</mo><mrow id="S1.SS1.SSS1.p3.7.m7.1.1.1.1.1.1" xref="S1.SS1.SSS1.p3.7.m7.1.1.1.1.1.1.cmml"><mi id="S1.SS1.SSS1.p3.7.m7.1.1.1.1.1.1.2" xref="S1.SS1.SSS1.p3.7.m7.1.1.1.1.1.1.2.cmml">n</mi><mo id="S1.SS1.SSS1.p3.7.m7.1.1.1.1.1.1.1" xref="S1.SS1.SSS1.p3.7.m7.1.1.1.1.1.1.1.cmml">-</mo><mn id="S1.SS1.SSS1.p3.7.m7.1.1.1.1.1.1.3" xref="S1.SS1.SSS1.p3.7.m7.1.1.1.1.1.1.3.cmml">2</mn></mrow><mo stretchy="false" id="S1.SS1.SSS1.p3.7.m7.1.1.1.1.1.3" xref="S1.SS1.SSS1.p3.7.m7.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S1.SS1.SSS1.p3.7.m7.1b"><apply id="S1.SS1.SSS1.p3.7.m7.1.2.cmml" xref="S1.SS1.SSS1.p3.7.m7.1.2"><csymbol cd="latexml" id="S1.SS1.SSS1.p3.7.m7.1.2.1.cmml" xref="S1.SS1.SSS1.p3.7.m7.1.2.1">tensor-product</csymbol><ci id="S1.SS1.SSS1.p3.7.m7.1.2.2.cmml" xref="S1.SS1.SSS1.p3.7.m7.1.2.2">𝐼</ci><ci id="S1.SS1.SSS1.p3.7.m7.1.2.3.cmml" xref="S1.SS1.SSS1.p3.7.m7.1.2.3">𝑋</ci><apply id="S1.SS1.SSS1.p3.7.m7.1.2.4.cmml" xref="S1.SS1.SSS1.p3.7.m7.1.2.4"><csymbol cd="ambiguous" id="S1.SS1.SSS1.p3.7.m7.1.2.4.1.cmml" xref="S1.SS1.SSS1.p3.7.m7.1.2.4">superscript</csymbol><ci id="S1.SS1.SSS1.p3.7.m7.1.2.4.2.cmml" xref="S1.SS1.SSS1.p3.7.m7.1.2.4.2">𝐼</ci><apply id="S1.SS1.SSS1.p3.7.m7.1.1.1.cmml" xref="S1.SS1.SSS1.p3.7.m7.1.1.1"><csymbol cd="latexml" id="S1.SS1.SSS1.p3.7.m7.1.1.1.2.cmml" xref="S1.SS1.SSS1.p3.7.m7.1.1.1.2">tensor-product</csymbol><csymbol cd="latexml" id="S1.SS1.SSS1.p3.7.m7.1.1.1.3.cmml" xref="S1.SS1.SSS1.p3.7.m7.1.1.1.3">absent</csymbol><apply id="S1.SS1.SSS1.p3.7.m7.1.1.1.1.1.1.cmml" xref="S1.SS1.SSS1.p3.7.m7.1.1.1.1.1"><minus id="S1.SS1.SSS1.p3.7.m7.1.1.1.1.1.1.1.cmml" xref="S1.SS1.SSS1.p3.7.m7.1.1.1.1.1.1.1"></minus><ci id="S1.SS1.SSS1.p3.7.m7.1.1.1.1.1.1.2.cmml" xref="S1.SS1.SSS1.p3.7.m7.1.1.1.1.1.1.2">𝑛</ci><cn type="integer" id="S1.SS1.SSS1.p3.7.m7.1.1.1.1.1.1.3.cmml" xref="S1.SS1.SSS1.p3.7.m7.1.1.1.1.1.1.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.SS1.SSS1.p3.7.m7.1c">I\otimes X\otimes I^{\otimes(n-2)}</annotation><annotation encoding="application/x-llamapun" id="S1.SS1.SSS1.p3.7.m7.1d">italic_I ⊗ italic_X ⊗ italic_I start_POSTSUPERSCRIPT ⊗ ( italic_n - 2 ) end_POSTSUPERSCRIPT</annotation></semantics></math>, <math id="S1.SS1.SSS1.p3.8.m8.1" class="ltx_Math" alttext="Z_{1}Z_{2}=Z\otimes Z\otimes I^{\otimes(n-2)}" display="inline"><semantics id="S1.SS1.SSS1.p3.8.m8.1a"><mrow id="S1.SS1.SSS1.p3.8.m8.1.2" xref="S1.SS1.SSS1.p3.8.m8.1.2.cmml"><mrow id="S1.SS1.SSS1.p3.8.m8.1.2.2" xref="S1.SS1.SSS1.p3.8.m8.1.2.2.cmml"><msub id="S1.SS1.SSS1.p3.8.m8.1.2.2.2" xref="S1.SS1.SSS1.p3.8.m8.1.2.2.2.cmml"><mi id="S1.SS1.SSS1.p3.8.m8.1.2.2.2.2" xref="S1.SS1.SSS1.p3.8.m8.1.2.2.2.2.cmml">Z</mi><mn id="S1.SS1.SSS1.p3.8.m8.1.2.2.2.3" xref="S1.SS1.SSS1.p3.8.m8.1.2.2.2.3.cmml">1</mn></msub><mo id="S1.SS1.SSS1.p3.8.m8.1.2.2.1" xref="S1.SS1.SSS1.p3.8.m8.1.2.2.1.cmml">⁢</mo><msub id="S1.SS1.SSS1.p3.8.m8.1.2.2.3" xref="S1.SS1.SSS1.p3.8.m8.1.2.2.3.cmml"><mi id="S1.SS1.SSS1.p3.8.m8.1.2.2.3.2" xref="S1.SS1.SSS1.p3.8.m8.1.2.2.3.2.cmml">Z</mi><mn id="S1.SS1.SSS1.p3.8.m8.1.2.2.3.3" xref="S1.SS1.SSS1.p3.8.m8.1.2.2.3.3.cmml">2</mn></msub></mrow><mo id="S1.SS1.SSS1.p3.8.m8.1.2.1" xref="S1.SS1.SSS1.p3.8.m8.1.2.1.cmml">=</mo><mrow id="S1.SS1.SSS1.p3.8.m8.1.2.3" xref="S1.SS1.SSS1.p3.8.m8.1.2.3.cmml"><mi id="S1.SS1.SSS1.p3.8.m8.1.2.3.2" xref="S1.SS1.SSS1.p3.8.m8.1.2.3.2.cmml">Z</mi><mo id="S1.SS1.SSS1.p3.8.m8.1.2.3.1" xref="S1.SS1.SSS1.p3.8.m8.1.2.3.1.cmml">⊗</mo><mi id="S1.SS1.SSS1.p3.8.m8.1.2.3.3" xref="S1.SS1.SSS1.p3.8.m8.1.2.3.3.cmml">Z</mi><mo id="S1.SS1.SSS1.p3.8.m8.1.2.3.1a" xref="S1.SS1.SSS1.p3.8.m8.1.2.3.1.cmml">⊗</mo><msup id="S1.SS1.SSS1.p3.8.m8.1.2.3.4" xref="S1.SS1.SSS1.p3.8.m8.1.2.3.4.cmml"><mi id="S1.SS1.SSS1.p3.8.m8.1.2.3.4.2" xref="S1.SS1.SSS1.p3.8.m8.1.2.3.4.2.cmml">I</mi><mrow id="S1.SS1.SSS1.p3.8.m8.1.1.1" xref="S1.SS1.SSS1.p3.8.m8.1.1.1.cmml"><mi id="S1.SS1.SSS1.p3.8.m8.1.1.1.3" xref="S1.SS1.SSS1.p3.8.m8.1.1.1.3.cmml"></mi><mo id="S1.SS1.SSS1.p3.8.m8.1.1.1.2" xref="S1.SS1.SSS1.p3.8.m8.1.1.1.2.cmml">⊗</mo><mrow id="S1.SS1.SSS1.p3.8.m8.1.1.1.1.1" xref="S1.SS1.SSS1.p3.8.m8.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S1.SS1.SSS1.p3.8.m8.1.1.1.1.1.2" xref="S1.SS1.SSS1.p3.8.m8.1.1.1.1.1.1.cmml">(</mo><mrow id="S1.SS1.SSS1.p3.8.m8.1.1.1.1.1.1" xref="S1.SS1.SSS1.p3.8.m8.1.1.1.1.1.1.cmml"><mi id="S1.SS1.SSS1.p3.8.m8.1.1.1.1.1.1.2" xref="S1.SS1.SSS1.p3.8.m8.1.1.1.1.1.1.2.cmml">n</mi><mo id="S1.SS1.SSS1.p3.8.m8.1.1.1.1.1.1.1" xref="S1.SS1.SSS1.p3.8.m8.1.1.1.1.1.1.1.cmml">-</mo><mn id="S1.SS1.SSS1.p3.8.m8.1.1.1.1.1.1.3" xref="S1.SS1.SSS1.p3.8.m8.1.1.1.1.1.1.3.cmml">2</mn></mrow><mo stretchy="false" id="S1.SS1.SSS1.p3.8.m8.1.1.1.1.1.3" xref="S1.SS1.SSS1.p3.8.m8.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.SS1.SSS1.p3.8.m8.1b"><apply id="S1.SS1.SSS1.p3.8.m8.1.2.cmml" xref="S1.SS1.SSS1.p3.8.m8.1.2"><eq id="S1.SS1.SSS1.p3.8.m8.1.2.1.cmml" xref="S1.SS1.SSS1.p3.8.m8.1.2.1"></eq><apply id="S1.SS1.SSS1.p3.8.m8.1.2.2.cmml" xref="S1.SS1.SSS1.p3.8.m8.1.2.2"><times id="S1.SS1.SSS1.p3.8.m8.1.2.2.1.cmml" xref="S1.SS1.SSS1.p3.8.m8.1.2.2.1"></times><apply id="S1.SS1.SSS1.p3.8.m8.1.2.2.2.cmml" xref="S1.SS1.SSS1.p3.8.m8.1.2.2.2"><csymbol cd="ambiguous" id="S1.SS1.SSS1.p3.8.m8.1.2.2.2.1.cmml" xref="S1.SS1.SSS1.p3.8.m8.1.2.2.2">subscript</csymbol><ci id="S1.SS1.SSS1.p3.8.m8.1.2.2.2.2.cmml" xref="S1.SS1.SSS1.p3.8.m8.1.2.2.2.2">𝑍</ci><cn type="integer" id="S1.SS1.SSS1.p3.8.m8.1.2.2.2.3.cmml" xref="S1.SS1.SSS1.p3.8.m8.1.2.2.2.3">1</cn></apply><apply id="S1.SS1.SSS1.p3.8.m8.1.2.2.3.cmml" xref="S1.SS1.SSS1.p3.8.m8.1.2.2.3"><csymbol cd="ambiguous" id="S1.SS1.SSS1.p3.8.m8.1.2.2.3.1.cmml" xref="S1.SS1.SSS1.p3.8.m8.1.2.2.3">subscript</csymbol><ci id="S1.SS1.SSS1.p3.8.m8.1.2.2.3.2.cmml" xref="S1.SS1.SSS1.p3.8.m8.1.2.2.3.2">𝑍</ci><cn type="integer" id="S1.SS1.SSS1.p3.8.m8.1.2.2.3.3.cmml" xref="S1.SS1.SSS1.p3.8.m8.1.2.2.3.3">2</cn></apply></apply><apply id="S1.SS1.SSS1.p3.8.m8.1.2.3.cmml" xref="S1.SS1.SSS1.p3.8.m8.1.2.3"><csymbol cd="latexml" id="S1.SS1.SSS1.p3.8.m8.1.2.3.1.cmml" xref="S1.SS1.SSS1.p3.8.m8.1.2.3.1">tensor-product</csymbol><ci id="S1.SS1.SSS1.p3.8.m8.1.2.3.2.cmml" xref="S1.SS1.SSS1.p3.8.m8.1.2.3.2">𝑍</ci><ci id="S1.SS1.SSS1.p3.8.m8.1.2.3.3.cmml" xref="S1.SS1.SSS1.p3.8.m8.1.2.3.3">𝑍</ci><apply id="S1.SS1.SSS1.p3.8.m8.1.2.3.4.cmml" xref="S1.SS1.SSS1.p3.8.m8.1.2.3.4"><csymbol cd="ambiguous" id="S1.SS1.SSS1.p3.8.m8.1.2.3.4.1.cmml" xref="S1.SS1.SSS1.p3.8.m8.1.2.3.4">superscript</csymbol><ci id="S1.SS1.SSS1.p3.8.m8.1.2.3.4.2.cmml" xref="S1.SS1.SSS1.p3.8.m8.1.2.3.4.2">𝐼</ci><apply id="S1.SS1.SSS1.p3.8.m8.1.1.1.cmml" xref="S1.SS1.SSS1.p3.8.m8.1.1.1"><csymbol cd="latexml" id="S1.SS1.SSS1.p3.8.m8.1.1.1.2.cmml" xref="S1.SS1.SSS1.p3.8.m8.1.1.1.2">tensor-product</csymbol><csymbol cd="latexml" id="S1.SS1.SSS1.p3.8.m8.1.1.1.3.cmml" xref="S1.SS1.SSS1.p3.8.m8.1.1.1.3">absent</csymbol><apply id="S1.SS1.SSS1.p3.8.m8.1.1.1.1.1.1.cmml" xref="S1.SS1.SSS1.p3.8.m8.1.1.1.1.1"><minus id="S1.SS1.SSS1.p3.8.m8.1.1.1.1.1.1.1.cmml" xref="S1.SS1.SSS1.p3.8.m8.1.1.1.1.1.1.1"></minus><ci id="S1.SS1.SSS1.p3.8.m8.1.1.1.1.1.1.2.cmml" xref="S1.SS1.SSS1.p3.8.m8.1.1.1.1.1.1.2">𝑛</ci><cn type="integer" id="S1.SS1.SSS1.p3.8.m8.1.1.1.1.1.1.3.cmml" xref="S1.SS1.SSS1.p3.8.m8.1.1.1.1.1.1.3">2</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.SS1.SSS1.p3.8.m8.1c">Z_{1}Z_{2}=Z\otimes Z\otimes I^{\otimes(n-2)}</annotation><annotation encoding="application/x-llamapun" id="S1.SS1.SSS1.p3.8.m8.1d">italic_Z start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT italic_Z start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT = italic_Z ⊗ italic_Z ⊗ italic_I start_POSTSUPERSCRIPT ⊗ ( italic_n - 2 ) end_POSTSUPERSCRIPT</annotation></semantics></math>, etc., with <math id="S1.SS1.SSS1.p3.9.m9.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S1.SS1.SSS1.p3.9.m9.1a"><mi id="S1.SS1.SSS1.p3.9.m9.1.1" xref="S1.SS1.SSS1.p3.9.m9.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S1.SS1.SSS1.p3.9.m9.1b"><ci id="S1.SS1.SSS1.p3.9.m9.1.1.cmml" xref="S1.SS1.SSS1.p3.9.m9.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.SS1.SSS1.p3.9.m9.1c">n</annotation><annotation encoding="application/x-llamapun" id="S1.SS1.SSS1.p3.9.m9.1d">italic_n</annotation></semantics></math> qubits in total.</p>
</div>
</section>
<section id="S1.SS1.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">1.1.2 </span>Text Classification</h4>

<div id="S1.SS1.SSS2.p1" class="ltx_para">
<p id="S1.SS1.SSS2.p1.1" class="ltx_p">As one of the central and basic tasks in NLP field, the text classification is to assign a given text sequence to one of the predefined categories. Examples of text classification tasks considered in this paper include topic classification and sentiment analysis. A commonly adopted approach in machine learning is to train a model with a set of pre-labeled sequences. When fed a new sequence, the trained model will be able to predict its category based on the experience learned from the training data set.</p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/2205.05625/assets/graph/QSAL.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="550" height="369" alt="Sketch of a quantum self-attention layer (QSAL). On quantum devices, the classical inputs ">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Sketch of a quantum self-attention layer (QSAL). On quantum devices, the classical inputs <math id="S1.F1.8.m1.2" class="ltx_Math" alttext="\{\bm{y}^{(l-1)}_{s}\}" display="inline"><semantics id="S1.F1.8.m1.2b"><mrow id="S1.F1.8.m1.2.2.1" xref="S1.F1.8.m1.2.2.2.cmml"><mo stretchy="false" id="S1.F1.8.m1.2.2.1.2" xref="S1.F1.8.m1.2.2.2.cmml">{</mo><msubsup id="S1.F1.8.m1.2.2.1.1" xref="S1.F1.8.m1.2.2.1.1.cmml"><mi id="S1.F1.8.m1.2.2.1.1.2.2" xref="S1.F1.8.m1.2.2.1.1.2.2.cmml">𝒚</mi><mi id="S1.F1.8.m1.2.2.1.1.3" xref="S1.F1.8.m1.2.2.1.1.3.cmml">s</mi><mrow id="S1.F1.8.m1.1.1.1.1" xref="S1.F1.8.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S1.F1.8.m1.1.1.1.1.2" xref="S1.F1.8.m1.1.1.1.1.1.cmml">(</mo><mrow id="S1.F1.8.m1.1.1.1.1.1" xref="S1.F1.8.m1.1.1.1.1.1.cmml"><mi id="S1.F1.8.m1.1.1.1.1.1.2" xref="S1.F1.8.m1.1.1.1.1.1.2.cmml">l</mi><mo id="S1.F1.8.m1.1.1.1.1.1.1" xref="S1.F1.8.m1.1.1.1.1.1.1.cmml">-</mo><mn id="S1.F1.8.m1.1.1.1.1.1.3" xref="S1.F1.8.m1.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S1.F1.8.m1.1.1.1.1.3" xref="S1.F1.8.m1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="S1.F1.8.m1.2.2.1.3" xref="S1.F1.8.m1.2.2.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S1.F1.8.m1.2c"><set id="S1.F1.8.m1.2.2.2.cmml" xref="S1.F1.8.m1.2.2.1"><apply id="S1.F1.8.m1.2.2.1.1.cmml" xref="S1.F1.8.m1.2.2.1.1"><csymbol cd="ambiguous" id="S1.F1.8.m1.2.2.1.1.1.cmml" xref="S1.F1.8.m1.2.2.1.1">subscript</csymbol><apply id="S1.F1.8.m1.2.2.1.1.2.cmml" xref="S1.F1.8.m1.2.2.1.1"><csymbol cd="ambiguous" id="S1.F1.8.m1.2.2.1.1.2.1.cmml" xref="S1.F1.8.m1.2.2.1.1">superscript</csymbol><ci id="S1.F1.8.m1.2.2.1.1.2.2.cmml" xref="S1.F1.8.m1.2.2.1.1.2.2">𝒚</ci><apply id="S1.F1.8.m1.1.1.1.1.1.cmml" xref="S1.F1.8.m1.1.1.1.1"><minus id="S1.F1.8.m1.1.1.1.1.1.1.cmml" xref="S1.F1.8.m1.1.1.1.1.1.1"></minus><ci id="S1.F1.8.m1.1.1.1.1.1.2.cmml" xref="S1.F1.8.m1.1.1.1.1.1.2">𝑙</ci><cn type="integer" id="S1.F1.8.m1.1.1.1.1.1.3.cmml" xref="S1.F1.8.m1.1.1.1.1.1.3">1</cn></apply></apply><ci id="S1.F1.8.m1.2.2.1.1.3.cmml" xref="S1.F1.8.m1.2.2.1.1.3">𝑠</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.8.m1.2d">\{\bm{y}^{(l-1)}_{s}\}</annotation><annotation encoding="application/x-llamapun" id="S1.F1.8.m1.2e">{ bold_italic_y start_POSTSUPERSCRIPT ( italic_l - 1 ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT }</annotation></semantics></math> are used as the rotation angles of quantum ansatzes (purple dashed boxes) to encode them into their corresponding quantum states <math id="S1.F1.9.m2.1" class="ltx_Math" alttext="\{\ket{\psi_{s}}\}" display="inline"><semantics id="S1.F1.9.m2.1b"><mrow id="S1.F1.9.m2.1.1.1" xref="S1.F1.9.m2.1.1.2.cmml"><mo stretchy="false" id="S1.F1.9.m2.1.1.1.2" xref="S1.F1.9.m2.1.1.2.cmml">{</mo><mrow id="S1.F1.9.m2.1.1.1.1" xref="S1.F1.9.m2.1.1.1.1.cmml"><merror class="ltx_ERROR undefined undefined" id="S1.F1.9.m2.1.1.1.1.2" xref="S1.F1.9.m2.1.1.1.1.2b.cmml"><mtext id="S1.F1.9.m2.1.1.1.1.2b" xref="S1.F1.9.m2.1.1.1.1.2b.cmml">\ket</mtext></merror><mo id="S1.F1.9.m2.1.1.1.1.1" xref="S1.F1.9.m2.1.1.1.1.1.cmml">⁢</mo><msub id="S1.F1.9.m2.1.1.1.1.3" xref="S1.F1.9.m2.1.1.1.1.3.cmml"><mi id="S1.F1.9.m2.1.1.1.1.3.2" xref="S1.F1.9.m2.1.1.1.1.3.2.cmml">ψ</mi><mi id="S1.F1.9.m2.1.1.1.1.3.3" xref="S1.F1.9.m2.1.1.1.1.3.3.cmml">s</mi></msub></mrow><mo stretchy="false" id="S1.F1.9.m2.1.1.1.3" xref="S1.F1.9.m2.1.1.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S1.F1.9.m2.1c"><set id="S1.F1.9.m2.1.1.2.cmml" xref="S1.F1.9.m2.1.1.1"><apply id="S1.F1.9.m2.1.1.1.1.cmml" xref="S1.F1.9.m2.1.1.1.1"><times id="S1.F1.9.m2.1.1.1.1.1.cmml" xref="S1.F1.9.m2.1.1.1.1.1"></times><ci id="S1.F1.9.m2.1.1.1.1.2b.cmml" xref="S1.F1.9.m2.1.1.1.1.2"><merror class="ltx_ERROR undefined undefined" id="S1.F1.9.m2.1.1.1.1.2.cmml" xref="S1.F1.9.m2.1.1.1.1.2"><mtext id="S1.F1.9.m2.1.1.1.1.2a.cmml" xref="S1.F1.9.m2.1.1.1.1.2">\ket</mtext></merror></ci><apply id="S1.F1.9.m2.1.1.1.1.3.cmml" xref="S1.F1.9.m2.1.1.1.1.3"><csymbol cd="ambiguous" id="S1.F1.9.m2.1.1.1.1.3.1.cmml" xref="S1.F1.9.m2.1.1.1.1.3">subscript</csymbol><ci id="S1.F1.9.m2.1.1.1.1.3.2.cmml" xref="S1.F1.9.m2.1.1.1.1.3.2">𝜓</ci><ci id="S1.F1.9.m2.1.1.1.1.3.3.cmml" xref="S1.F1.9.m2.1.1.1.1.3.3">𝑠</ci></apply></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.9.m2.1d">\{\ket{\psi_{s}}\}</annotation><annotation encoding="application/x-llamapun" id="S1.F1.9.m2.1e">{ italic_ψ start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT }</annotation></semantics></math>. Then for each state, there are three different classes of ansatzes (red dashed boxes) need to be executed, where the top two classes denote the query and key parts, and the bottom one denotes the value part. On classical computers, the measurement outputs of the query part <math id="S1.F1.10.m3.1" class="ltx_Math" alttext="\langle Z_{q}\rangle_{s}" display="inline"><semantics id="S1.F1.10.m3.1b"><msub id="S1.F1.10.m3.1.1" xref="S1.F1.10.m3.1.1.cmml"><mrow id="S1.F1.10.m3.1.1.1.1" xref="S1.F1.10.m3.1.1.1.2.cmml"><mo stretchy="false" id="S1.F1.10.m3.1.1.1.1.2" xref="S1.F1.10.m3.1.1.1.2.1.cmml">⟨</mo><msub id="S1.F1.10.m3.1.1.1.1.1" xref="S1.F1.10.m3.1.1.1.1.1.cmml"><mi id="S1.F1.10.m3.1.1.1.1.1.2" xref="S1.F1.10.m3.1.1.1.1.1.2.cmml">Z</mi><mi id="S1.F1.10.m3.1.1.1.1.1.3" xref="S1.F1.10.m3.1.1.1.1.1.3.cmml">q</mi></msub><mo stretchy="false" id="S1.F1.10.m3.1.1.1.1.3" xref="S1.F1.10.m3.1.1.1.2.1.cmml">⟩</mo></mrow><mi id="S1.F1.10.m3.1.1.3" xref="S1.F1.10.m3.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S1.F1.10.m3.1c"><apply id="S1.F1.10.m3.1.1.cmml" xref="S1.F1.10.m3.1.1"><csymbol cd="ambiguous" id="S1.F1.10.m3.1.1.2.cmml" xref="S1.F1.10.m3.1.1">subscript</csymbol><apply id="S1.F1.10.m3.1.1.1.2.cmml" xref="S1.F1.10.m3.1.1.1.1"><csymbol cd="latexml" id="S1.F1.10.m3.1.1.1.2.1.cmml" xref="S1.F1.10.m3.1.1.1.1.2">delimited-⟨⟩</csymbol><apply id="S1.F1.10.m3.1.1.1.1.1.cmml" xref="S1.F1.10.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="S1.F1.10.m3.1.1.1.1.1.1.cmml" xref="S1.F1.10.m3.1.1.1.1.1">subscript</csymbol><ci id="S1.F1.10.m3.1.1.1.1.1.2.cmml" xref="S1.F1.10.m3.1.1.1.1.1.2">𝑍</ci><ci id="S1.F1.10.m3.1.1.1.1.1.3.cmml" xref="S1.F1.10.m3.1.1.1.1.1.3">𝑞</ci></apply></apply><ci id="S1.F1.10.m3.1.1.3.cmml" xref="S1.F1.10.m3.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.10.m3.1d">\langle Z_{q}\rangle_{s}</annotation><annotation encoding="application/x-llamapun" id="S1.F1.10.m3.1e">⟨ italic_Z start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT ⟩ start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> and the key part <math id="S1.F1.11.m4.1" class="ltx_Math" alttext="\langle Z_{k}\rangle_{j}" display="inline"><semantics id="S1.F1.11.m4.1b"><msub id="S1.F1.11.m4.1.1" xref="S1.F1.11.m4.1.1.cmml"><mrow id="S1.F1.11.m4.1.1.1.1" xref="S1.F1.11.m4.1.1.1.2.cmml"><mo stretchy="false" id="S1.F1.11.m4.1.1.1.1.2" xref="S1.F1.11.m4.1.1.1.2.1.cmml">⟨</mo><msub id="S1.F1.11.m4.1.1.1.1.1" xref="S1.F1.11.m4.1.1.1.1.1.cmml"><mi id="S1.F1.11.m4.1.1.1.1.1.2" xref="S1.F1.11.m4.1.1.1.1.1.2.cmml">Z</mi><mi id="S1.F1.11.m4.1.1.1.1.1.3" xref="S1.F1.11.m4.1.1.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="S1.F1.11.m4.1.1.1.1.3" xref="S1.F1.11.m4.1.1.1.2.1.cmml">⟩</mo></mrow><mi id="S1.F1.11.m4.1.1.3" xref="S1.F1.11.m4.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S1.F1.11.m4.1c"><apply id="S1.F1.11.m4.1.1.cmml" xref="S1.F1.11.m4.1.1"><csymbol cd="ambiguous" id="S1.F1.11.m4.1.1.2.cmml" xref="S1.F1.11.m4.1.1">subscript</csymbol><apply id="S1.F1.11.m4.1.1.1.2.cmml" xref="S1.F1.11.m4.1.1.1.1"><csymbol cd="latexml" id="S1.F1.11.m4.1.1.1.2.1.cmml" xref="S1.F1.11.m4.1.1.1.1.2">delimited-⟨⟩</csymbol><apply id="S1.F1.11.m4.1.1.1.1.1.cmml" xref="S1.F1.11.m4.1.1.1.1.1"><csymbol cd="ambiguous" id="S1.F1.11.m4.1.1.1.1.1.1.cmml" xref="S1.F1.11.m4.1.1.1.1.1">subscript</csymbol><ci id="S1.F1.11.m4.1.1.1.1.1.2.cmml" xref="S1.F1.11.m4.1.1.1.1.1.2">𝑍</ci><ci id="S1.F1.11.m4.1.1.1.1.1.3.cmml" xref="S1.F1.11.m4.1.1.1.1.1.3">𝑘</ci></apply></apply><ci id="S1.F1.11.m4.1.1.3.cmml" xref="S1.F1.11.m4.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.11.m4.1d">\langle Z_{k}\rangle_{j}</annotation><annotation encoding="application/x-llamapun" id="S1.F1.11.m4.1e">⟨ italic_Z start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ⟩ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> are computed through a Gaussian function to obtain the quantum self-attention coefficients <math id="S1.F1.12.m5.2" class="ltx_Math" alttext="\alpha_{s,j}" display="inline"><semantics id="S1.F1.12.m5.2b"><msub id="S1.F1.12.m5.2.3" xref="S1.F1.12.m5.2.3.cmml"><mi id="S1.F1.12.m5.2.3.2" xref="S1.F1.12.m5.2.3.2.cmml">α</mi><mrow id="S1.F1.12.m5.2.2.2.4" xref="S1.F1.12.m5.2.2.2.3.cmml"><mi id="S1.F1.12.m5.1.1.1.1" xref="S1.F1.12.m5.1.1.1.1.cmml">s</mi><mo id="S1.F1.12.m5.2.2.2.4.1" xref="S1.F1.12.m5.2.2.2.3.cmml">,</mo><mi id="S1.F1.12.m5.2.2.2.2" xref="S1.F1.12.m5.2.2.2.2.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S1.F1.12.m5.2c"><apply id="S1.F1.12.m5.2.3.cmml" xref="S1.F1.12.m5.2.3"><csymbol cd="ambiguous" id="S1.F1.12.m5.2.3.1.cmml" xref="S1.F1.12.m5.2.3">subscript</csymbol><ci id="S1.F1.12.m5.2.3.2.cmml" xref="S1.F1.12.m5.2.3.2">𝛼</ci><list id="S1.F1.12.m5.2.2.2.3.cmml" xref="S1.F1.12.m5.2.2.2.4"><ci id="S1.F1.12.m5.1.1.1.1.cmml" xref="S1.F1.12.m5.1.1.1.1">𝑠</ci><ci id="S1.F1.12.m5.2.2.2.2.cmml" xref="S1.F1.12.m5.2.2.2.2">𝑗</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.12.m5.2d">\alpha_{s,j}</annotation><annotation encoding="application/x-llamapun" id="S1.F1.12.m5.2e">italic_α start_POSTSUBSCRIPT italic_s , italic_j end_POSTSUBSCRIPT</annotation></semantics></math> (green circles); we calculate classically weighted sums of the measurement outputs of the value part (small colored squares) and add the inputs to get the outputs <math id="S1.F1.13.m6.2" class="ltx_Math" alttext="\{\bm{y}^{(l)}_{s}\}" display="inline"><semantics id="S1.F1.13.m6.2b"><mrow id="S1.F1.13.m6.2.2.1" xref="S1.F1.13.m6.2.2.2.cmml"><mo stretchy="false" id="S1.F1.13.m6.2.2.1.2" xref="S1.F1.13.m6.2.2.2.cmml">{</mo><msubsup id="S1.F1.13.m6.2.2.1.1" xref="S1.F1.13.m6.2.2.1.1.cmml"><mi id="S1.F1.13.m6.2.2.1.1.2.2" xref="S1.F1.13.m6.2.2.1.1.2.2.cmml">𝒚</mi><mi id="S1.F1.13.m6.2.2.1.1.3" xref="S1.F1.13.m6.2.2.1.1.3.cmml">s</mi><mrow id="S1.F1.13.m6.1.1.1.3" xref="S1.F1.13.m6.2.2.1.1.cmml"><mo stretchy="false" id="S1.F1.13.m6.1.1.1.3.1" xref="S1.F1.13.m6.2.2.1.1.cmml">(</mo><mi id="S1.F1.13.m6.1.1.1.1" xref="S1.F1.13.m6.1.1.1.1.cmml">l</mi><mo stretchy="false" id="S1.F1.13.m6.1.1.1.3.2" xref="S1.F1.13.m6.2.2.1.1.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="S1.F1.13.m6.2.2.1.3" xref="S1.F1.13.m6.2.2.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S1.F1.13.m6.2c"><set id="S1.F1.13.m6.2.2.2.cmml" xref="S1.F1.13.m6.2.2.1"><apply id="S1.F1.13.m6.2.2.1.1.cmml" xref="S1.F1.13.m6.2.2.1.1"><csymbol cd="ambiguous" id="S1.F1.13.m6.2.2.1.1.1.cmml" xref="S1.F1.13.m6.2.2.1.1">subscript</csymbol><apply id="S1.F1.13.m6.2.2.1.1.2.cmml" xref="S1.F1.13.m6.2.2.1.1"><csymbol cd="ambiguous" id="S1.F1.13.m6.2.2.1.1.2.1.cmml" xref="S1.F1.13.m6.2.2.1.1">superscript</csymbol><ci id="S1.F1.13.m6.2.2.1.1.2.2.cmml" xref="S1.F1.13.m6.2.2.1.1.2.2">𝒚</ci><ci id="S1.F1.13.m6.1.1.1.1.cmml" xref="S1.F1.13.m6.1.1.1.1">𝑙</ci></apply><ci id="S1.F1.13.m6.2.2.1.1.3.cmml" xref="S1.F1.13.m6.2.2.1.1.3">𝑠</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.13.m6.2d">\{\bm{y}^{(l)}_{s}\}</annotation><annotation encoding="application/x-llamapun" id="S1.F1.13.m6.2e">{ bold_italic_y start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT }</annotation></semantics></math>, where the weights are the normalized coefficients <math id="S1.F1.14.m7.2" class="ltx_Math" alttext="\tilde{\alpha}_{s,j}" display="inline"><semantics id="S1.F1.14.m7.2b"><msub id="S1.F1.14.m7.2.3" xref="S1.F1.14.m7.2.3.cmml"><mover accent="true" id="S1.F1.14.m7.2.3.2" xref="S1.F1.14.m7.2.3.2.cmml"><mi id="S1.F1.14.m7.2.3.2.2" xref="S1.F1.14.m7.2.3.2.2.cmml">α</mi><mo stretchy="false" id="S1.F1.14.m7.2.3.2.1" xref="S1.F1.14.m7.2.3.2.1.cmml">~</mo></mover><mrow id="S1.F1.14.m7.2.2.2.4" xref="S1.F1.14.m7.2.2.2.3.cmml"><mi id="S1.F1.14.m7.1.1.1.1" xref="S1.F1.14.m7.1.1.1.1.cmml">s</mi><mo id="S1.F1.14.m7.2.2.2.4.1" xref="S1.F1.14.m7.2.2.2.3.cmml">,</mo><mi id="S1.F1.14.m7.2.2.2.2" xref="S1.F1.14.m7.2.2.2.2.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S1.F1.14.m7.2c"><apply id="S1.F1.14.m7.2.3.cmml" xref="S1.F1.14.m7.2.3"><csymbol cd="ambiguous" id="S1.F1.14.m7.2.3.1.cmml" xref="S1.F1.14.m7.2.3">subscript</csymbol><apply id="S1.F1.14.m7.2.3.2.cmml" xref="S1.F1.14.m7.2.3.2"><ci id="S1.F1.14.m7.2.3.2.1.cmml" xref="S1.F1.14.m7.2.3.2.1">~</ci><ci id="S1.F1.14.m7.2.3.2.2.cmml" xref="S1.F1.14.m7.2.3.2.2">𝛼</ci></apply><list id="S1.F1.14.m7.2.2.2.3.cmml" xref="S1.F1.14.m7.2.2.2.4"><ci id="S1.F1.14.m7.1.1.1.1.cmml" xref="S1.F1.14.m7.1.1.1.1">𝑠</ci><ci id="S1.F1.14.m7.2.2.2.2.cmml" xref="S1.F1.14.m7.2.2.2.2">𝑗</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.14.m7.2d">\tilde{\alpha}_{s,j}</annotation><annotation encoding="application/x-llamapun" id="S1.F1.14.m7.2e">over~ start_ARG italic_α end_ARG start_POSTSUBSCRIPT italic_s , italic_j end_POSTSUBSCRIPT</annotation></semantics></math>, cf. Eq. (<a href="#S2.E16" title="(16) ‣ 2.1 Quantum Self-Attention Layer ‣ 2 Method ‣ Quantum Self-Attention Neural Networks for Text Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">16</span></a>).</figcaption>
</figure>
</section>
<section id="S1.SS1.SSS3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">1.1.3 </span>Self-Attention Mechanism</h4>

<div id="S1.SS1.SSS3.p1" class="ltx_para">
<p id="S1.SS1.SSS3.p1.7" class="ltx_p">In a self-attention neural network layer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib36" title="" class="ltx_ref">36</a>]</cite>,
the input data <math id="S1.SS1.SSS3.p1.1.m1.1" class="ltx_Math" alttext="\{x_{s}\in\mathbb{R}^{d}\}_{s=1}^{S}" display="inline"><semantics id="S1.SS1.SSS3.p1.1.m1.1a"><msubsup id="S1.SS1.SSS3.p1.1.m1.1.1" xref="S1.SS1.SSS3.p1.1.m1.1.1.cmml"><mrow id="S1.SS1.SSS3.p1.1.m1.1.1.1.1.1" xref="S1.SS1.SSS3.p1.1.m1.1.1.1.1.2.cmml"><mo stretchy="false" id="S1.SS1.SSS3.p1.1.m1.1.1.1.1.1.2" xref="S1.SS1.SSS3.p1.1.m1.1.1.1.1.2.cmml">{</mo><mrow id="S1.SS1.SSS3.p1.1.m1.1.1.1.1.1.1" xref="S1.SS1.SSS3.p1.1.m1.1.1.1.1.1.1.cmml"><msub id="S1.SS1.SSS3.p1.1.m1.1.1.1.1.1.1.2" xref="S1.SS1.SSS3.p1.1.m1.1.1.1.1.1.1.2.cmml"><mi id="S1.SS1.SSS3.p1.1.m1.1.1.1.1.1.1.2.2" xref="S1.SS1.SSS3.p1.1.m1.1.1.1.1.1.1.2.2.cmml">x</mi><mi id="S1.SS1.SSS3.p1.1.m1.1.1.1.1.1.1.2.3" xref="S1.SS1.SSS3.p1.1.m1.1.1.1.1.1.1.2.3.cmml">s</mi></msub><mo id="S1.SS1.SSS3.p1.1.m1.1.1.1.1.1.1.1" xref="S1.SS1.SSS3.p1.1.m1.1.1.1.1.1.1.1.cmml">∈</mo><msup id="S1.SS1.SSS3.p1.1.m1.1.1.1.1.1.1.3" xref="S1.SS1.SSS3.p1.1.m1.1.1.1.1.1.1.3.cmml"><mi id="S1.SS1.SSS3.p1.1.m1.1.1.1.1.1.1.3.2" xref="S1.SS1.SSS3.p1.1.m1.1.1.1.1.1.1.3.2.cmml">ℝ</mi><mi id="S1.SS1.SSS3.p1.1.m1.1.1.1.1.1.1.3.3" xref="S1.SS1.SSS3.p1.1.m1.1.1.1.1.1.1.3.3.cmml">d</mi></msup></mrow><mo stretchy="false" id="S1.SS1.SSS3.p1.1.m1.1.1.1.1.1.3" xref="S1.SS1.SSS3.p1.1.m1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S1.SS1.SSS3.p1.1.m1.1.1.1.3" xref="S1.SS1.SSS3.p1.1.m1.1.1.1.3.cmml"><mi id="S1.SS1.SSS3.p1.1.m1.1.1.1.3.2" xref="S1.SS1.SSS3.p1.1.m1.1.1.1.3.2.cmml">s</mi><mo id="S1.SS1.SSS3.p1.1.m1.1.1.1.3.1" xref="S1.SS1.SSS3.p1.1.m1.1.1.1.3.1.cmml">=</mo><mn id="S1.SS1.SSS3.p1.1.m1.1.1.1.3.3" xref="S1.SS1.SSS3.p1.1.m1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S1.SS1.SSS3.p1.1.m1.1.1.3" xref="S1.SS1.SSS3.p1.1.m1.1.1.3.cmml">S</mi></msubsup><annotation-xml encoding="MathML-Content" id="S1.SS1.SSS3.p1.1.m1.1b"><apply id="S1.SS1.SSS3.p1.1.m1.1.1.cmml" xref="S1.SS1.SSS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S1.SS1.SSS3.p1.1.m1.1.1.2.cmml" xref="S1.SS1.SSS3.p1.1.m1.1.1">superscript</csymbol><apply id="S1.SS1.SSS3.p1.1.m1.1.1.1.cmml" xref="S1.SS1.SSS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S1.SS1.SSS3.p1.1.m1.1.1.1.2.cmml" xref="S1.SS1.SSS3.p1.1.m1.1.1">subscript</csymbol><set id="S1.SS1.SSS3.p1.1.m1.1.1.1.1.2.cmml" xref="S1.SS1.SSS3.p1.1.m1.1.1.1.1.1"><apply id="S1.SS1.SSS3.p1.1.m1.1.1.1.1.1.1.cmml" xref="S1.SS1.SSS3.p1.1.m1.1.1.1.1.1.1"><in id="S1.SS1.SSS3.p1.1.m1.1.1.1.1.1.1.1.cmml" xref="S1.SS1.SSS3.p1.1.m1.1.1.1.1.1.1.1"></in><apply id="S1.SS1.SSS3.p1.1.m1.1.1.1.1.1.1.2.cmml" xref="S1.SS1.SSS3.p1.1.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S1.SS1.SSS3.p1.1.m1.1.1.1.1.1.1.2.1.cmml" xref="S1.SS1.SSS3.p1.1.m1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S1.SS1.SSS3.p1.1.m1.1.1.1.1.1.1.2.2.cmml" xref="S1.SS1.SSS3.p1.1.m1.1.1.1.1.1.1.2.2">𝑥</ci><ci id="S1.SS1.SSS3.p1.1.m1.1.1.1.1.1.1.2.3.cmml" xref="S1.SS1.SSS3.p1.1.m1.1.1.1.1.1.1.2.3">𝑠</ci></apply><apply id="S1.SS1.SSS3.p1.1.m1.1.1.1.1.1.1.3.cmml" xref="S1.SS1.SSS3.p1.1.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S1.SS1.SSS3.p1.1.m1.1.1.1.1.1.1.3.1.cmml" xref="S1.SS1.SSS3.p1.1.m1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S1.SS1.SSS3.p1.1.m1.1.1.1.1.1.1.3.2.cmml" xref="S1.SS1.SSS3.p1.1.m1.1.1.1.1.1.1.3.2">ℝ</ci><ci id="S1.SS1.SSS3.p1.1.m1.1.1.1.1.1.1.3.3.cmml" xref="S1.SS1.SSS3.p1.1.m1.1.1.1.1.1.1.3.3">𝑑</ci></apply></apply></set><apply id="S1.SS1.SSS3.p1.1.m1.1.1.1.3.cmml" xref="S1.SS1.SSS3.p1.1.m1.1.1.1.3"><eq id="S1.SS1.SSS3.p1.1.m1.1.1.1.3.1.cmml" xref="S1.SS1.SSS3.p1.1.m1.1.1.1.3.1"></eq><ci id="S1.SS1.SSS3.p1.1.m1.1.1.1.3.2.cmml" xref="S1.SS1.SSS3.p1.1.m1.1.1.1.3.2">𝑠</ci><cn type="integer" id="S1.SS1.SSS3.p1.1.m1.1.1.1.3.3.cmml" xref="S1.SS1.SSS3.p1.1.m1.1.1.1.3.3">1</cn></apply></apply><ci id="S1.SS1.SSS3.p1.1.m1.1.1.3.cmml" xref="S1.SS1.SSS3.p1.1.m1.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.SS1.SSS3.p1.1.m1.1c">\{x_{s}\in\mathbb{R}^{d}\}_{s=1}^{S}</annotation><annotation encoding="application/x-llamapun" id="S1.SS1.SSS3.p1.1.m1.1d">{ italic_x start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT } start_POSTSUBSCRIPT italic_s = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_S end_POSTSUPERSCRIPT</annotation></semantics></math> are linearly mapped, via three weight matrices, i.e., query <math id="S1.SS1.SSS3.p1.2.m2.1" class="ltx_Math" alttext="W_{q}\in\mathbb{R}^{d\times d}" display="inline"><semantics id="S1.SS1.SSS3.p1.2.m2.1a"><mrow id="S1.SS1.SSS3.p1.2.m2.1.1" xref="S1.SS1.SSS3.p1.2.m2.1.1.cmml"><msub id="S1.SS1.SSS3.p1.2.m2.1.1.2" xref="S1.SS1.SSS3.p1.2.m2.1.1.2.cmml"><mi id="S1.SS1.SSS3.p1.2.m2.1.1.2.2" xref="S1.SS1.SSS3.p1.2.m2.1.1.2.2.cmml">W</mi><mi id="S1.SS1.SSS3.p1.2.m2.1.1.2.3" xref="S1.SS1.SSS3.p1.2.m2.1.1.2.3.cmml">q</mi></msub><mo id="S1.SS1.SSS3.p1.2.m2.1.1.1" xref="S1.SS1.SSS3.p1.2.m2.1.1.1.cmml">∈</mo><msup id="S1.SS1.SSS3.p1.2.m2.1.1.3" xref="S1.SS1.SSS3.p1.2.m2.1.1.3.cmml"><mi id="S1.SS1.SSS3.p1.2.m2.1.1.3.2" xref="S1.SS1.SSS3.p1.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S1.SS1.SSS3.p1.2.m2.1.1.3.3" xref="S1.SS1.SSS3.p1.2.m2.1.1.3.3.cmml"><mi id="S1.SS1.SSS3.p1.2.m2.1.1.3.3.2" xref="S1.SS1.SSS3.p1.2.m2.1.1.3.3.2.cmml">d</mi><mo id="S1.SS1.SSS3.p1.2.m2.1.1.3.3.1" xref="S1.SS1.SSS3.p1.2.m2.1.1.3.3.1.cmml">×</mo><mi id="S1.SS1.SSS3.p1.2.m2.1.1.3.3.3" xref="S1.SS1.SSS3.p1.2.m2.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S1.SS1.SSS3.p1.2.m2.1b"><apply id="S1.SS1.SSS3.p1.2.m2.1.1.cmml" xref="S1.SS1.SSS3.p1.2.m2.1.1"><in id="S1.SS1.SSS3.p1.2.m2.1.1.1.cmml" xref="S1.SS1.SSS3.p1.2.m2.1.1.1"></in><apply id="S1.SS1.SSS3.p1.2.m2.1.1.2.cmml" xref="S1.SS1.SSS3.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="S1.SS1.SSS3.p1.2.m2.1.1.2.1.cmml" xref="S1.SS1.SSS3.p1.2.m2.1.1.2">subscript</csymbol><ci id="S1.SS1.SSS3.p1.2.m2.1.1.2.2.cmml" xref="S1.SS1.SSS3.p1.2.m2.1.1.2.2">𝑊</ci><ci id="S1.SS1.SSS3.p1.2.m2.1.1.2.3.cmml" xref="S1.SS1.SSS3.p1.2.m2.1.1.2.3">𝑞</ci></apply><apply id="S1.SS1.SSS3.p1.2.m2.1.1.3.cmml" xref="S1.SS1.SSS3.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S1.SS1.SSS3.p1.2.m2.1.1.3.1.cmml" xref="S1.SS1.SSS3.p1.2.m2.1.1.3">superscript</csymbol><ci id="S1.SS1.SSS3.p1.2.m2.1.1.3.2.cmml" xref="S1.SS1.SSS3.p1.2.m2.1.1.3.2">ℝ</ci><apply id="S1.SS1.SSS3.p1.2.m2.1.1.3.3.cmml" xref="S1.SS1.SSS3.p1.2.m2.1.1.3.3"><times id="S1.SS1.SSS3.p1.2.m2.1.1.3.3.1.cmml" xref="S1.SS1.SSS3.p1.2.m2.1.1.3.3.1"></times><ci id="S1.SS1.SSS3.p1.2.m2.1.1.3.3.2.cmml" xref="S1.SS1.SSS3.p1.2.m2.1.1.3.3.2">𝑑</ci><ci id="S1.SS1.SSS3.p1.2.m2.1.1.3.3.3.cmml" xref="S1.SS1.SSS3.p1.2.m2.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.SS1.SSS3.p1.2.m2.1c">W_{q}\in\mathbb{R}^{d\times d}</annotation><annotation encoding="application/x-llamapun" id="S1.SS1.SSS3.p1.2.m2.1d">italic_W start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>, key <math id="S1.SS1.SSS3.p1.3.m3.1" class="ltx_Math" alttext="W_{k}\in\mathbb{R}^{d\times d}" display="inline"><semantics id="S1.SS1.SSS3.p1.3.m3.1a"><mrow id="S1.SS1.SSS3.p1.3.m3.1.1" xref="S1.SS1.SSS3.p1.3.m3.1.1.cmml"><msub id="S1.SS1.SSS3.p1.3.m3.1.1.2" xref="S1.SS1.SSS3.p1.3.m3.1.1.2.cmml"><mi id="S1.SS1.SSS3.p1.3.m3.1.1.2.2" xref="S1.SS1.SSS3.p1.3.m3.1.1.2.2.cmml">W</mi><mi id="S1.SS1.SSS3.p1.3.m3.1.1.2.3" xref="S1.SS1.SSS3.p1.3.m3.1.1.2.3.cmml">k</mi></msub><mo id="S1.SS1.SSS3.p1.3.m3.1.1.1" xref="S1.SS1.SSS3.p1.3.m3.1.1.1.cmml">∈</mo><msup id="S1.SS1.SSS3.p1.3.m3.1.1.3" xref="S1.SS1.SSS3.p1.3.m3.1.1.3.cmml"><mi id="S1.SS1.SSS3.p1.3.m3.1.1.3.2" xref="S1.SS1.SSS3.p1.3.m3.1.1.3.2.cmml">ℝ</mi><mrow id="S1.SS1.SSS3.p1.3.m3.1.1.3.3" xref="S1.SS1.SSS3.p1.3.m3.1.1.3.3.cmml"><mi id="S1.SS1.SSS3.p1.3.m3.1.1.3.3.2" xref="S1.SS1.SSS3.p1.3.m3.1.1.3.3.2.cmml">d</mi><mo id="S1.SS1.SSS3.p1.3.m3.1.1.3.3.1" xref="S1.SS1.SSS3.p1.3.m3.1.1.3.3.1.cmml">×</mo><mi id="S1.SS1.SSS3.p1.3.m3.1.1.3.3.3" xref="S1.SS1.SSS3.p1.3.m3.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S1.SS1.SSS3.p1.3.m3.1b"><apply id="S1.SS1.SSS3.p1.3.m3.1.1.cmml" xref="S1.SS1.SSS3.p1.3.m3.1.1"><in id="S1.SS1.SSS3.p1.3.m3.1.1.1.cmml" xref="S1.SS1.SSS3.p1.3.m3.1.1.1"></in><apply id="S1.SS1.SSS3.p1.3.m3.1.1.2.cmml" xref="S1.SS1.SSS3.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="S1.SS1.SSS3.p1.3.m3.1.1.2.1.cmml" xref="S1.SS1.SSS3.p1.3.m3.1.1.2">subscript</csymbol><ci id="S1.SS1.SSS3.p1.3.m3.1.1.2.2.cmml" xref="S1.SS1.SSS3.p1.3.m3.1.1.2.2">𝑊</ci><ci id="S1.SS1.SSS3.p1.3.m3.1.1.2.3.cmml" xref="S1.SS1.SSS3.p1.3.m3.1.1.2.3">𝑘</ci></apply><apply id="S1.SS1.SSS3.p1.3.m3.1.1.3.cmml" xref="S1.SS1.SSS3.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="S1.SS1.SSS3.p1.3.m3.1.1.3.1.cmml" xref="S1.SS1.SSS3.p1.3.m3.1.1.3">superscript</csymbol><ci id="S1.SS1.SSS3.p1.3.m3.1.1.3.2.cmml" xref="S1.SS1.SSS3.p1.3.m3.1.1.3.2">ℝ</ci><apply id="S1.SS1.SSS3.p1.3.m3.1.1.3.3.cmml" xref="S1.SS1.SSS3.p1.3.m3.1.1.3.3"><times id="S1.SS1.SSS3.p1.3.m3.1.1.3.3.1.cmml" xref="S1.SS1.SSS3.p1.3.m3.1.1.3.3.1"></times><ci id="S1.SS1.SSS3.p1.3.m3.1.1.3.3.2.cmml" xref="S1.SS1.SSS3.p1.3.m3.1.1.3.3.2">𝑑</ci><ci id="S1.SS1.SSS3.p1.3.m3.1.1.3.3.3.cmml" xref="S1.SS1.SSS3.p1.3.m3.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.SS1.SSS3.p1.3.m3.1c">W_{k}\in\mathbb{R}^{d\times d}</annotation><annotation encoding="application/x-llamapun" id="S1.SS1.SSS3.p1.3.m3.1d">italic_W start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> and value <math id="S1.SS1.SSS3.p1.4.m4.1" class="ltx_Math" alttext="W_{v}\in\mathbb{R}^{d\times d}" display="inline"><semantics id="S1.SS1.SSS3.p1.4.m4.1a"><mrow id="S1.SS1.SSS3.p1.4.m4.1.1" xref="S1.SS1.SSS3.p1.4.m4.1.1.cmml"><msub id="S1.SS1.SSS3.p1.4.m4.1.1.2" xref="S1.SS1.SSS3.p1.4.m4.1.1.2.cmml"><mi id="S1.SS1.SSS3.p1.4.m4.1.1.2.2" xref="S1.SS1.SSS3.p1.4.m4.1.1.2.2.cmml">W</mi><mi id="S1.SS1.SSS3.p1.4.m4.1.1.2.3" xref="S1.SS1.SSS3.p1.4.m4.1.1.2.3.cmml">v</mi></msub><mo id="S1.SS1.SSS3.p1.4.m4.1.1.1" xref="S1.SS1.SSS3.p1.4.m4.1.1.1.cmml">∈</mo><msup id="S1.SS1.SSS3.p1.4.m4.1.1.3" xref="S1.SS1.SSS3.p1.4.m4.1.1.3.cmml"><mi id="S1.SS1.SSS3.p1.4.m4.1.1.3.2" xref="S1.SS1.SSS3.p1.4.m4.1.1.3.2.cmml">ℝ</mi><mrow id="S1.SS1.SSS3.p1.4.m4.1.1.3.3" xref="S1.SS1.SSS3.p1.4.m4.1.1.3.3.cmml"><mi id="S1.SS1.SSS3.p1.4.m4.1.1.3.3.2" xref="S1.SS1.SSS3.p1.4.m4.1.1.3.3.2.cmml">d</mi><mo id="S1.SS1.SSS3.p1.4.m4.1.1.3.3.1" xref="S1.SS1.SSS3.p1.4.m4.1.1.3.3.1.cmml">×</mo><mi id="S1.SS1.SSS3.p1.4.m4.1.1.3.3.3" xref="S1.SS1.SSS3.p1.4.m4.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S1.SS1.SSS3.p1.4.m4.1b"><apply id="S1.SS1.SSS3.p1.4.m4.1.1.cmml" xref="S1.SS1.SSS3.p1.4.m4.1.1"><in id="S1.SS1.SSS3.p1.4.m4.1.1.1.cmml" xref="S1.SS1.SSS3.p1.4.m4.1.1.1"></in><apply id="S1.SS1.SSS3.p1.4.m4.1.1.2.cmml" xref="S1.SS1.SSS3.p1.4.m4.1.1.2"><csymbol cd="ambiguous" id="S1.SS1.SSS3.p1.4.m4.1.1.2.1.cmml" xref="S1.SS1.SSS3.p1.4.m4.1.1.2">subscript</csymbol><ci id="S1.SS1.SSS3.p1.4.m4.1.1.2.2.cmml" xref="S1.SS1.SSS3.p1.4.m4.1.1.2.2">𝑊</ci><ci id="S1.SS1.SSS3.p1.4.m4.1.1.2.3.cmml" xref="S1.SS1.SSS3.p1.4.m4.1.1.2.3">𝑣</ci></apply><apply id="S1.SS1.SSS3.p1.4.m4.1.1.3.cmml" xref="S1.SS1.SSS3.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="S1.SS1.SSS3.p1.4.m4.1.1.3.1.cmml" xref="S1.SS1.SSS3.p1.4.m4.1.1.3">superscript</csymbol><ci id="S1.SS1.SSS3.p1.4.m4.1.1.3.2.cmml" xref="S1.SS1.SSS3.p1.4.m4.1.1.3.2">ℝ</ci><apply id="S1.SS1.SSS3.p1.4.m4.1.1.3.3.cmml" xref="S1.SS1.SSS3.p1.4.m4.1.1.3.3"><times id="S1.SS1.SSS3.p1.4.m4.1.1.3.3.1.cmml" xref="S1.SS1.SSS3.p1.4.m4.1.1.3.3.1"></times><ci id="S1.SS1.SSS3.p1.4.m4.1.1.3.3.2.cmml" xref="S1.SS1.SSS3.p1.4.m4.1.1.3.3.2">𝑑</ci><ci id="S1.SS1.SSS3.p1.4.m4.1.1.3.3.3.cmml" xref="S1.SS1.SSS3.p1.4.m4.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.SS1.SSS3.p1.4.m4.1c">W_{v}\in\mathbb{R}^{d\times d}</annotation><annotation encoding="application/x-llamapun" id="S1.SS1.SSS3.p1.4.m4.1d">italic_W start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>, to three parts <math id="S1.SS1.SSS3.p1.5.m5.1" class="ltx_Math" alttext="W_{q}x_{s}" display="inline"><semantics id="S1.SS1.SSS3.p1.5.m5.1a"><mrow id="S1.SS1.SSS3.p1.5.m5.1.1" xref="S1.SS1.SSS3.p1.5.m5.1.1.cmml"><msub id="S1.SS1.SSS3.p1.5.m5.1.1.2" xref="S1.SS1.SSS3.p1.5.m5.1.1.2.cmml"><mi id="S1.SS1.SSS3.p1.5.m5.1.1.2.2" xref="S1.SS1.SSS3.p1.5.m5.1.1.2.2.cmml">W</mi><mi id="S1.SS1.SSS3.p1.5.m5.1.1.2.3" xref="S1.SS1.SSS3.p1.5.m5.1.1.2.3.cmml">q</mi></msub><mo id="S1.SS1.SSS3.p1.5.m5.1.1.1" xref="S1.SS1.SSS3.p1.5.m5.1.1.1.cmml">⁢</mo><msub id="S1.SS1.SSS3.p1.5.m5.1.1.3" xref="S1.SS1.SSS3.p1.5.m5.1.1.3.cmml"><mi id="S1.SS1.SSS3.p1.5.m5.1.1.3.2" xref="S1.SS1.SSS3.p1.5.m5.1.1.3.2.cmml">x</mi><mi id="S1.SS1.SSS3.p1.5.m5.1.1.3.3" xref="S1.SS1.SSS3.p1.5.m5.1.1.3.3.cmml">s</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S1.SS1.SSS3.p1.5.m5.1b"><apply id="S1.SS1.SSS3.p1.5.m5.1.1.cmml" xref="S1.SS1.SSS3.p1.5.m5.1.1"><times id="S1.SS1.SSS3.p1.5.m5.1.1.1.cmml" xref="S1.SS1.SSS3.p1.5.m5.1.1.1"></times><apply id="S1.SS1.SSS3.p1.5.m5.1.1.2.cmml" xref="S1.SS1.SSS3.p1.5.m5.1.1.2"><csymbol cd="ambiguous" id="S1.SS1.SSS3.p1.5.m5.1.1.2.1.cmml" xref="S1.SS1.SSS3.p1.5.m5.1.1.2">subscript</csymbol><ci id="S1.SS1.SSS3.p1.5.m5.1.1.2.2.cmml" xref="S1.SS1.SSS3.p1.5.m5.1.1.2.2">𝑊</ci><ci id="S1.SS1.SSS3.p1.5.m5.1.1.2.3.cmml" xref="S1.SS1.SSS3.p1.5.m5.1.1.2.3">𝑞</ci></apply><apply id="S1.SS1.SSS3.p1.5.m5.1.1.3.cmml" xref="S1.SS1.SSS3.p1.5.m5.1.1.3"><csymbol cd="ambiguous" id="S1.SS1.SSS3.p1.5.m5.1.1.3.1.cmml" xref="S1.SS1.SSS3.p1.5.m5.1.1.3">subscript</csymbol><ci id="S1.SS1.SSS3.p1.5.m5.1.1.3.2.cmml" xref="S1.SS1.SSS3.p1.5.m5.1.1.3.2">𝑥</ci><ci id="S1.SS1.SSS3.p1.5.m5.1.1.3.3.cmml" xref="S1.SS1.SSS3.p1.5.m5.1.1.3.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.SS1.SSS3.p1.5.m5.1c">W_{q}x_{s}</annotation><annotation encoding="application/x-llamapun" id="S1.SS1.SSS3.p1.5.m5.1d">italic_W start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT italic_x start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math>, <math id="S1.SS1.SSS3.p1.6.m6.1" class="ltx_Math" alttext="W_{k}x_{s}" display="inline"><semantics id="S1.SS1.SSS3.p1.6.m6.1a"><mrow id="S1.SS1.SSS3.p1.6.m6.1.1" xref="S1.SS1.SSS3.p1.6.m6.1.1.cmml"><msub id="S1.SS1.SSS3.p1.6.m6.1.1.2" xref="S1.SS1.SSS3.p1.6.m6.1.1.2.cmml"><mi id="S1.SS1.SSS3.p1.6.m6.1.1.2.2" xref="S1.SS1.SSS3.p1.6.m6.1.1.2.2.cmml">W</mi><mi id="S1.SS1.SSS3.p1.6.m6.1.1.2.3" xref="S1.SS1.SSS3.p1.6.m6.1.1.2.3.cmml">k</mi></msub><mo id="S1.SS1.SSS3.p1.6.m6.1.1.1" xref="S1.SS1.SSS3.p1.6.m6.1.1.1.cmml">⁢</mo><msub id="S1.SS1.SSS3.p1.6.m6.1.1.3" xref="S1.SS1.SSS3.p1.6.m6.1.1.3.cmml"><mi id="S1.SS1.SSS3.p1.6.m6.1.1.3.2" xref="S1.SS1.SSS3.p1.6.m6.1.1.3.2.cmml">x</mi><mi id="S1.SS1.SSS3.p1.6.m6.1.1.3.3" xref="S1.SS1.SSS3.p1.6.m6.1.1.3.3.cmml">s</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S1.SS1.SSS3.p1.6.m6.1b"><apply id="S1.SS1.SSS3.p1.6.m6.1.1.cmml" xref="S1.SS1.SSS3.p1.6.m6.1.1"><times id="S1.SS1.SSS3.p1.6.m6.1.1.1.cmml" xref="S1.SS1.SSS3.p1.6.m6.1.1.1"></times><apply id="S1.SS1.SSS3.p1.6.m6.1.1.2.cmml" xref="S1.SS1.SSS3.p1.6.m6.1.1.2"><csymbol cd="ambiguous" id="S1.SS1.SSS3.p1.6.m6.1.1.2.1.cmml" xref="S1.SS1.SSS3.p1.6.m6.1.1.2">subscript</csymbol><ci id="S1.SS1.SSS3.p1.6.m6.1.1.2.2.cmml" xref="S1.SS1.SSS3.p1.6.m6.1.1.2.2">𝑊</ci><ci id="S1.SS1.SSS3.p1.6.m6.1.1.2.3.cmml" xref="S1.SS1.SSS3.p1.6.m6.1.1.2.3">𝑘</ci></apply><apply id="S1.SS1.SSS3.p1.6.m6.1.1.3.cmml" xref="S1.SS1.SSS3.p1.6.m6.1.1.3"><csymbol cd="ambiguous" id="S1.SS1.SSS3.p1.6.m6.1.1.3.1.cmml" xref="S1.SS1.SSS3.p1.6.m6.1.1.3">subscript</csymbol><ci id="S1.SS1.SSS3.p1.6.m6.1.1.3.2.cmml" xref="S1.SS1.SSS3.p1.6.m6.1.1.3.2">𝑥</ci><ci id="S1.SS1.SSS3.p1.6.m6.1.1.3.3.cmml" xref="S1.SS1.SSS3.p1.6.m6.1.1.3.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.SS1.SSS3.p1.6.m6.1c">W_{k}x_{s}</annotation><annotation encoding="application/x-llamapun" id="S1.SS1.SSS3.p1.6.m6.1d">italic_W start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT italic_x start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math>, <math id="S1.SS1.SSS3.p1.7.m7.1" class="ltx_Math" alttext="W_{v}x_{s}" display="inline"><semantics id="S1.SS1.SSS3.p1.7.m7.1a"><mrow id="S1.SS1.SSS3.p1.7.m7.1.1" xref="S1.SS1.SSS3.p1.7.m7.1.1.cmml"><msub id="S1.SS1.SSS3.p1.7.m7.1.1.2" xref="S1.SS1.SSS3.p1.7.m7.1.1.2.cmml"><mi id="S1.SS1.SSS3.p1.7.m7.1.1.2.2" xref="S1.SS1.SSS3.p1.7.m7.1.1.2.2.cmml">W</mi><mi id="S1.SS1.SSS3.p1.7.m7.1.1.2.3" xref="S1.SS1.SSS3.p1.7.m7.1.1.2.3.cmml">v</mi></msub><mo id="S1.SS1.SSS3.p1.7.m7.1.1.1" xref="S1.SS1.SSS3.p1.7.m7.1.1.1.cmml">⁢</mo><msub id="S1.SS1.SSS3.p1.7.m7.1.1.3" xref="S1.SS1.SSS3.p1.7.m7.1.1.3.cmml"><mi id="S1.SS1.SSS3.p1.7.m7.1.1.3.2" xref="S1.SS1.SSS3.p1.7.m7.1.1.3.2.cmml">x</mi><mi id="S1.SS1.SSS3.p1.7.m7.1.1.3.3" xref="S1.SS1.SSS3.p1.7.m7.1.1.3.3.cmml">s</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S1.SS1.SSS3.p1.7.m7.1b"><apply id="S1.SS1.SSS3.p1.7.m7.1.1.cmml" xref="S1.SS1.SSS3.p1.7.m7.1.1"><times id="S1.SS1.SSS3.p1.7.m7.1.1.1.cmml" xref="S1.SS1.SSS3.p1.7.m7.1.1.1"></times><apply id="S1.SS1.SSS3.p1.7.m7.1.1.2.cmml" xref="S1.SS1.SSS3.p1.7.m7.1.1.2"><csymbol cd="ambiguous" id="S1.SS1.SSS3.p1.7.m7.1.1.2.1.cmml" xref="S1.SS1.SSS3.p1.7.m7.1.1.2">subscript</csymbol><ci id="S1.SS1.SSS3.p1.7.m7.1.1.2.2.cmml" xref="S1.SS1.SSS3.p1.7.m7.1.1.2.2">𝑊</ci><ci id="S1.SS1.SSS3.p1.7.m7.1.1.2.3.cmml" xref="S1.SS1.SSS3.p1.7.m7.1.1.2.3">𝑣</ci></apply><apply id="S1.SS1.SSS3.p1.7.m7.1.1.3.cmml" xref="S1.SS1.SSS3.p1.7.m7.1.1.3"><csymbol cd="ambiguous" id="S1.SS1.SSS3.p1.7.m7.1.1.3.1.cmml" xref="S1.SS1.SSS3.p1.7.m7.1.1.3">subscript</csymbol><ci id="S1.SS1.SSS3.p1.7.m7.1.1.3.2.cmml" xref="S1.SS1.SSS3.p1.7.m7.1.1.3.2">𝑥</ci><ci id="S1.SS1.SSS3.p1.7.m7.1.1.3.3.cmml" xref="S1.SS1.SSS3.p1.7.m7.1.1.3.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.SS1.SSS3.p1.7.m7.1c">W_{v}x_{s}</annotation><annotation encoding="application/x-llamapun" id="S1.SS1.SSS3.p1.7.m7.1d">italic_W start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT italic_x start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math>, respectively, and by applying inner product on the query and key parts, the output is computed as</p>
</div>
<div id="S1.SS1.SSS3.p2" class="ltx_para">
<table id="S1.EGx2" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S1.E10"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S1.E10.m1.6" class="ltx_Math" alttext="\displaystyle y_{s}=\sum_{j=1}^{S}a_{s,j}\cdot W_{v}x_{j}\qquad\text{with}%
\qquad a_{s,j}=\frac{\text{e}^{x_{s}^{\top}W_{q}^{\top}W_{k}x_{j}}}{\sum_{l=1}%
^{S}\text{e}^{x_{s}^{\top}W_{q}^{\top}W_{k}x_{l}}}," display="inline"><semantics id="S1.E10.m1.6a"><mrow id="S1.E10.m1.6.6.1"><mrow id="S1.E10.m1.6.6.1.1.2" xref="S1.E10.m1.6.6.1.1.3.cmml"><mrow id="S1.E10.m1.6.6.1.1.1.1" xref="S1.E10.m1.6.6.1.1.1.1.cmml"><msub id="S1.E10.m1.6.6.1.1.1.1.3" xref="S1.E10.m1.6.6.1.1.1.1.3.cmml"><mi id="S1.E10.m1.6.6.1.1.1.1.3.2" xref="S1.E10.m1.6.6.1.1.1.1.3.2.cmml">y</mi><mi id="S1.E10.m1.6.6.1.1.1.1.3.3" xref="S1.E10.m1.6.6.1.1.1.1.3.3.cmml">s</mi></msub><mo id="S1.E10.m1.6.6.1.1.1.1.2" xref="S1.E10.m1.6.6.1.1.1.1.2.cmml">=</mo><mrow id="S1.E10.m1.6.6.1.1.1.1.1.1" xref="S1.E10.m1.6.6.1.1.1.1.1.2.cmml"><mrow id="S1.E10.m1.6.6.1.1.1.1.1.1.1" xref="S1.E10.m1.6.6.1.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S1.E10.m1.6.6.1.1.1.1.1.1.1.1" xref="S1.E10.m1.6.6.1.1.1.1.1.1.1.1.cmml"><munderover id="S1.E10.m1.6.6.1.1.1.1.1.1.1.1a" xref="S1.E10.m1.6.6.1.1.1.1.1.1.1.1.cmml"><mo largeop="true" movablelimits="false" symmetric="true" id="S1.E10.m1.6.6.1.1.1.1.1.1.1.1.2.2" xref="S1.E10.m1.6.6.1.1.1.1.1.1.1.1.2.2.cmml">∑</mo><mrow id="S1.E10.m1.6.6.1.1.1.1.1.1.1.1.2.3" xref="S1.E10.m1.6.6.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S1.E10.m1.6.6.1.1.1.1.1.1.1.1.2.3.2" xref="S1.E10.m1.6.6.1.1.1.1.1.1.1.1.2.3.2.cmml">j</mi><mo id="S1.E10.m1.6.6.1.1.1.1.1.1.1.1.2.3.1" xref="S1.E10.m1.6.6.1.1.1.1.1.1.1.1.2.3.1.cmml">=</mo><mn id="S1.E10.m1.6.6.1.1.1.1.1.1.1.1.2.3.3" xref="S1.E10.m1.6.6.1.1.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow><mi id="S1.E10.m1.6.6.1.1.1.1.1.1.1.1.3" xref="S1.E10.m1.6.6.1.1.1.1.1.1.1.1.3.cmml">S</mi></munderover></mstyle><mrow id="S1.E10.m1.6.6.1.1.1.1.1.1.1.2" xref="S1.E10.m1.6.6.1.1.1.1.1.1.1.2.cmml"><mrow id="S1.E10.m1.6.6.1.1.1.1.1.1.1.2.2" xref="S1.E10.m1.6.6.1.1.1.1.1.1.1.2.2.cmml"><msub id="S1.E10.m1.6.6.1.1.1.1.1.1.1.2.2.2" xref="S1.E10.m1.6.6.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S1.E10.m1.6.6.1.1.1.1.1.1.1.2.2.2.2" xref="S1.E10.m1.6.6.1.1.1.1.1.1.1.2.2.2.2.cmml">a</mi><mrow id="S1.E10.m1.2.2.2.4" xref="S1.E10.m1.2.2.2.3.cmml"><mi id="S1.E10.m1.1.1.1.1" xref="S1.E10.m1.1.1.1.1.cmml">s</mi><mo id="S1.E10.m1.2.2.2.4.1" xref="S1.E10.m1.2.2.2.3.cmml">,</mo><mi id="S1.E10.m1.2.2.2.2" xref="S1.E10.m1.2.2.2.2.cmml">j</mi></mrow></msub><mo id="S1.E10.m1.6.6.1.1.1.1.1.1.1.2.2.1" xref="S1.E10.m1.6.6.1.1.1.1.1.1.1.2.2.1.cmml">⋅</mo><msub id="S1.E10.m1.6.6.1.1.1.1.1.1.1.2.2.3" xref="S1.E10.m1.6.6.1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S1.E10.m1.6.6.1.1.1.1.1.1.1.2.2.3.2" xref="S1.E10.m1.6.6.1.1.1.1.1.1.1.2.2.3.2.cmml">W</mi><mi id="S1.E10.m1.6.6.1.1.1.1.1.1.1.2.2.3.3" xref="S1.E10.m1.6.6.1.1.1.1.1.1.1.2.2.3.3.cmml">v</mi></msub></mrow><mo id="S1.E10.m1.6.6.1.1.1.1.1.1.1.2.1" xref="S1.E10.m1.6.6.1.1.1.1.1.1.1.2.1.cmml">⁢</mo><msub id="S1.E10.m1.6.6.1.1.1.1.1.1.1.2.3" xref="S1.E10.m1.6.6.1.1.1.1.1.1.1.2.3.cmml"><mi id="S1.E10.m1.6.6.1.1.1.1.1.1.1.2.3.2" xref="S1.E10.m1.6.6.1.1.1.1.1.1.1.2.3.2.cmml">x</mi><mi id="S1.E10.m1.6.6.1.1.1.1.1.1.1.2.3.3" xref="S1.E10.m1.6.6.1.1.1.1.1.1.1.2.3.3.cmml">j</mi></msub></mrow></mrow><mo mathvariant="italic" separator="true" id="S1.E10.m1.6.6.1.1.1.1.1.1.2" xref="S1.E10.m1.6.6.1.1.1.1.1.2.cmml">  </mo><mtext id="S1.E10.m1.5.5" xref="S1.E10.m1.5.5a.cmml">with</mtext></mrow></mrow><mo mathvariant="italic" separator="true" id="S1.E10.m1.6.6.1.1.2.3" xref="S1.E10.m1.6.6.1.1.3a.cmml">  </mo><mrow id="S1.E10.m1.6.6.1.1.2.2" xref="S1.E10.m1.6.6.1.1.2.2.cmml"><msub id="S1.E10.m1.6.6.1.1.2.2.2" xref="S1.E10.m1.6.6.1.1.2.2.2.cmml"><mi id="S1.E10.m1.6.6.1.1.2.2.2.2" xref="S1.E10.m1.6.6.1.1.2.2.2.2.cmml">a</mi><mrow id="S1.E10.m1.4.4.2.4" xref="S1.E10.m1.4.4.2.3.cmml"><mi id="S1.E10.m1.3.3.1.1" xref="S1.E10.m1.3.3.1.1.cmml">s</mi><mo id="S1.E10.m1.4.4.2.4.1" xref="S1.E10.m1.4.4.2.3.cmml">,</mo><mi id="S1.E10.m1.4.4.2.2" xref="S1.E10.m1.4.4.2.2.cmml">j</mi></mrow></msub><mo id="S1.E10.m1.6.6.1.1.2.2.1" xref="S1.E10.m1.6.6.1.1.2.2.1.cmml">=</mo><mstyle displaystyle="true" id="S1.E10.m1.6.6.1.1.2.2.3" xref="S1.E10.m1.6.6.1.1.2.2.3.cmml"><mfrac id="S1.E10.m1.6.6.1.1.2.2.3a" xref="S1.E10.m1.6.6.1.1.2.2.3.cmml"><msup id="S1.E10.m1.6.6.1.1.2.2.3.2" xref="S1.E10.m1.6.6.1.1.2.2.3.2.cmml"><mtext id="S1.E10.m1.6.6.1.1.2.2.3.2.2" xref="S1.E10.m1.6.6.1.1.2.2.3.2.2a.cmml">e</mtext><mrow id="S1.E10.m1.6.6.1.1.2.2.3.2.3" xref="S1.E10.m1.6.6.1.1.2.2.3.2.3.cmml"><msubsup id="S1.E10.m1.6.6.1.1.2.2.3.2.3.2" xref="S1.E10.m1.6.6.1.1.2.2.3.2.3.2.cmml"><mi id="S1.E10.m1.6.6.1.1.2.2.3.2.3.2.2.2" xref="S1.E10.m1.6.6.1.1.2.2.3.2.3.2.2.2.cmml">x</mi><mi id="S1.E10.m1.6.6.1.1.2.2.3.2.3.2.2.3" xref="S1.E10.m1.6.6.1.1.2.2.3.2.3.2.2.3.cmml">s</mi><mo id="S1.E10.m1.6.6.1.1.2.2.3.2.3.2.3" xref="S1.E10.m1.6.6.1.1.2.2.3.2.3.2.3.cmml">⊤</mo></msubsup><mo id="S1.E10.m1.6.6.1.1.2.2.3.2.3.1" xref="S1.E10.m1.6.6.1.1.2.2.3.2.3.1.cmml">⁢</mo><msubsup id="S1.E10.m1.6.6.1.1.2.2.3.2.3.3" xref="S1.E10.m1.6.6.1.1.2.2.3.2.3.3.cmml"><mi id="S1.E10.m1.6.6.1.1.2.2.3.2.3.3.2.2" xref="S1.E10.m1.6.6.1.1.2.2.3.2.3.3.2.2.cmml">W</mi><mi id="S1.E10.m1.6.6.1.1.2.2.3.2.3.3.2.3" xref="S1.E10.m1.6.6.1.1.2.2.3.2.3.3.2.3.cmml">q</mi><mo id="S1.E10.m1.6.6.1.1.2.2.3.2.3.3.3" xref="S1.E10.m1.6.6.1.1.2.2.3.2.3.3.3.cmml">⊤</mo></msubsup><mo id="S1.E10.m1.6.6.1.1.2.2.3.2.3.1a" xref="S1.E10.m1.6.6.1.1.2.2.3.2.3.1.cmml">⁢</mo><msub id="S1.E10.m1.6.6.1.1.2.2.3.2.3.4" xref="S1.E10.m1.6.6.1.1.2.2.3.2.3.4.cmml"><mi id="S1.E10.m1.6.6.1.1.2.2.3.2.3.4.2" xref="S1.E10.m1.6.6.1.1.2.2.3.2.3.4.2.cmml">W</mi><mi id="S1.E10.m1.6.6.1.1.2.2.3.2.3.4.3" xref="S1.E10.m1.6.6.1.1.2.2.3.2.3.4.3.cmml">k</mi></msub><mo id="S1.E10.m1.6.6.1.1.2.2.3.2.3.1b" xref="S1.E10.m1.6.6.1.1.2.2.3.2.3.1.cmml">⁢</mo><msub id="S1.E10.m1.6.6.1.1.2.2.3.2.3.5" xref="S1.E10.m1.6.6.1.1.2.2.3.2.3.5.cmml"><mi id="S1.E10.m1.6.6.1.1.2.2.3.2.3.5.2" xref="S1.E10.m1.6.6.1.1.2.2.3.2.3.5.2.cmml">x</mi><mi id="S1.E10.m1.6.6.1.1.2.2.3.2.3.5.3" xref="S1.E10.m1.6.6.1.1.2.2.3.2.3.5.3.cmml">j</mi></msub></mrow></msup><mrow id="S1.E10.m1.6.6.1.1.2.2.3.3" xref="S1.E10.m1.6.6.1.1.2.2.3.3.cmml"><msubsup id="S1.E10.m1.6.6.1.1.2.2.3.3.1" xref="S1.E10.m1.6.6.1.1.2.2.3.3.1.cmml"><mo largeop="true" symmetric="true" id="S1.E10.m1.6.6.1.1.2.2.3.3.1.2.2" xref="S1.E10.m1.6.6.1.1.2.2.3.3.1.2.2.cmml">∑</mo><mrow id="S1.E10.m1.6.6.1.1.2.2.3.3.1.2.3" xref="S1.E10.m1.6.6.1.1.2.2.3.3.1.2.3.cmml"><mi id="S1.E10.m1.6.6.1.1.2.2.3.3.1.2.3.2" xref="S1.E10.m1.6.6.1.1.2.2.3.3.1.2.3.2.cmml">l</mi><mo id="S1.E10.m1.6.6.1.1.2.2.3.3.1.2.3.1" xref="S1.E10.m1.6.6.1.1.2.2.3.3.1.2.3.1.cmml">=</mo><mn id="S1.E10.m1.6.6.1.1.2.2.3.3.1.2.3.3" xref="S1.E10.m1.6.6.1.1.2.2.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="S1.E10.m1.6.6.1.1.2.2.3.3.1.3" xref="S1.E10.m1.6.6.1.1.2.2.3.3.1.3.cmml">S</mi></msubsup><msup id="S1.E10.m1.6.6.1.1.2.2.3.3.2" xref="S1.E10.m1.6.6.1.1.2.2.3.3.2.cmml"><mtext id="S1.E10.m1.6.6.1.1.2.2.3.3.2.2" xref="S1.E10.m1.6.6.1.1.2.2.3.3.2.2a.cmml">e</mtext><mrow id="S1.E10.m1.6.6.1.1.2.2.3.3.2.3" xref="S1.E10.m1.6.6.1.1.2.2.3.3.2.3.cmml"><msubsup id="S1.E10.m1.6.6.1.1.2.2.3.3.2.3.2" xref="S1.E10.m1.6.6.1.1.2.2.3.3.2.3.2.cmml"><mi id="S1.E10.m1.6.6.1.1.2.2.3.3.2.3.2.2.2" xref="S1.E10.m1.6.6.1.1.2.2.3.3.2.3.2.2.2.cmml">x</mi><mi id="S1.E10.m1.6.6.1.1.2.2.3.3.2.3.2.2.3" xref="S1.E10.m1.6.6.1.1.2.2.3.3.2.3.2.2.3.cmml">s</mi><mo id="S1.E10.m1.6.6.1.1.2.2.3.3.2.3.2.3" xref="S1.E10.m1.6.6.1.1.2.2.3.3.2.3.2.3.cmml">⊤</mo></msubsup><mo id="S1.E10.m1.6.6.1.1.2.2.3.3.2.3.1" xref="S1.E10.m1.6.6.1.1.2.2.3.3.2.3.1.cmml">⁢</mo><msubsup id="S1.E10.m1.6.6.1.1.2.2.3.3.2.3.3" xref="S1.E10.m1.6.6.1.1.2.2.3.3.2.3.3.cmml"><mi id="S1.E10.m1.6.6.1.1.2.2.3.3.2.3.3.2.2" xref="S1.E10.m1.6.6.1.1.2.2.3.3.2.3.3.2.2.cmml">W</mi><mi id="S1.E10.m1.6.6.1.1.2.2.3.3.2.3.3.2.3" xref="S1.E10.m1.6.6.1.1.2.2.3.3.2.3.3.2.3.cmml">q</mi><mo id="S1.E10.m1.6.6.1.1.2.2.3.3.2.3.3.3" xref="S1.E10.m1.6.6.1.1.2.2.3.3.2.3.3.3.cmml">⊤</mo></msubsup><mo id="S1.E10.m1.6.6.1.1.2.2.3.3.2.3.1a" xref="S1.E10.m1.6.6.1.1.2.2.3.3.2.3.1.cmml">⁢</mo><msub id="S1.E10.m1.6.6.1.1.2.2.3.3.2.3.4" xref="S1.E10.m1.6.6.1.1.2.2.3.3.2.3.4.cmml"><mi id="S1.E10.m1.6.6.1.1.2.2.3.3.2.3.4.2" xref="S1.E10.m1.6.6.1.1.2.2.3.3.2.3.4.2.cmml">W</mi><mi id="S1.E10.m1.6.6.1.1.2.2.3.3.2.3.4.3" xref="S1.E10.m1.6.6.1.1.2.2.3.3.2.3.4.3.cmml">k</mi></msub><mo id="S1.E10.m1.6.6.1.1.2.2.3.3.2.3.1b" xref="S1.E10.m1.6.6.1.1.2.2.3.3.2.3.1.cmml">⁢</mo><msub id="S1.E10.m1.6.6.1.1.2.2.3.3.2.3.5" xref="S1.E10.m1.6.6.1.1.2.2.3.3.2.3.5.cmml"><mi id="S1.E10.m1.6.6.1.1.2.2.3.3.2.3.5.2" xref="S1.E10.m1.6.6.1.1.2.2.3.3.2.3.5.2.cmml">x</mi><mi id="S1.E10.m1.6.6.1.1.2.2.3.3.2.3.5.3" xref="S1.E10.m1.6.6.1.1.2.2.3.3.2.3.5.3.cmml">l</mi></msub></mrow></msup></mrow></mfrac></mstyle></mrow></mrow><mo id="S1.E10.m1.6.6.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S1.E10.m1.6b"><apply id="S1.E10.m1.6.6.1.1.3.cmml" xref="S1.E10.m1.6.6.1.1.2"><csymbol cd="ambiguous" id="S1.E10.m1.6.6.1.1.3a.cmml" xref="S1.E10.m1.6.6.1.1.2.3">formulae-sequence</csymbol><apply id="S1.E10.m1.6.6.1.1.1.1.cmml" xref="S1.E10.m1.6.6.1.1.1.1"><eq id="S1.E10.m1.6.6.1.1.1.1.2.cmml" xref="S1.E10.m1.6.6.1.1.1.1.2"></eq><apply id="S1.E10.m1.6.6.1.1.1.1.3.cmml" xref="S1.E10.m1.6.6.1.1.1.1.3"><csymbol cd="ambiguous" id="S1.E10.m1.6.6.1.1.1.1.3.1.cmml" xref="S1.E10.m1.6.6.1.1.1.1.3">subscript</csymbol><ci id="S1.E10.m1.6.6.1.1.1.1.3.2.cmml" xref="S1.E10.m1.6.6.1.1.1.1.3.2">𝑦</ci><ci id="S1.E10.m1.6.6.1.1.1.1.3.3.cmml" xref="S1.E10.m1.6.6.1.1.1.1.3.3">𝑠</ci></apply><list id="S1.E10.m1.6.6.1.1.1.1.1.2.cmml" xref="S1.E10.m1.6.6.1.1.1.1.1.1"><apply id="S1.E10.m1.6.6.1.1.1.1.1.1.1.cmml" xref="S1.E10.m1.6.6.1.1.1.1.1.1.1"><apply id="S1.E10.m1.6.6.1.1.1.1.1.1.1.1.cmml" xref="S1.E10.m1.6.6.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S1.E10.m1.6.6.1.1.1.1.1.1.1.1.1.cmml" xref="S1.E10.m1.6.6.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S1.E10.m1.6.6.1.1.1.1.1.1.1.1.2.cmml" xref="S1.E10.m1.6.6.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S1.E10.m1.6.6.1.1.1.1.1.1.1.1.2.1.cmml" xref="S1.E10.m1.6.6.1.1.1.1.1.1.1.1">subscript</csymbol><sum id="S1.E10.m1.6.6.1.1.1.1.1.1.1.1.2.2.cmml" xref="S1.E10.m1.6.6.1.1.1.1.1.1.1.1.2.2"></sum><apply id="S1.E10.m1.6.6.1.1.1.1.1.1.1.1.2.3.cmml" xref="S1.E10.m1.6.6.1.1.1.1.1.1.1.1.2.3"><eq id="S1.E10.m1.6.6.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S1.E10.m1.6.6.1.1.1.1.1.1.1.1.2.3.1"></eq><ci id="S1.E10.m1.6.6.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S1.E10.m1.6.6.1.1.1.1.1.1.1.1.2.3.2">𝑗</ci><cn type="integer" id="S1.E10.m1.6.6.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S1.E10.m1.6.6.1.1.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="S1.E10.m1.6.6.1.1.1.1.1.1.1.1.3.cmml" xref="S1.E10.m1.6.6.1.1.1.1.1.1.1.1.3">𝑆</ci></apply><apply id="S1.E10.m1.6.6.1.1.1.1.1.1.1.2.cmml" xref="S1.E10.m1.6.6.1.1.1.1.1.1.1.2"><times id="S1.E10.m1.6.6.1.1.1.1.1.1.1.2.1.cmml" xref="S1.E10.m1.6.6.1.1.1.1.1.1.1.2.1"></times><apply id="S1.E10.m1.6.6.1.1.1.1.1.1.1.2.2.cmml" xref="S1.E10.m1.6.6.1.1.1.1.1.1.1.2.2"><ci id="S1.E10.m1.6.6.1.1.1.1.1.1.1.2.2.1.cmml" xref="S1.E10.m1.6.6.1.1.1.1.1.1.1.2.2.1">⋅</ci><apply id="S1.E10.m1.6.6.1.1.1.1.1.1.1.2.2.2.cmml" xref="S1.E10.m1.6.6.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S1.E10.m1.6.6.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S1.E10.m1.6.6.1.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S1.E10.m1.6.6.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S1.E10.m1.6.6.1.1.1.1.1.1.1.2.2.2.2">𝑎</ci><list id="S1.E10.m1.2.2.2.3.cmml" xref="S1.E10.m1.2.2.2.4"><ci id="S1.E10.m1.1.1.1.1.cmml" xref="S1.E10.m1.1.1.1.1">𝑠</ci><ci id="S1.E10.m1.2.2.2.2.cmml" xref="S1.E10.m1.2.2.2.2">𝑗</ci></list></apply><apply id="S1.E10.m1.6.6.1.1.1.1.1.1.1.2.2.3.cmml" xref="S1.E10.m1.6.6.1.1.1.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S1.E10.m1.6.6.1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S1.E10.m1.6.6.1.1.1.1.1.1.1.2.2.3">subscript</csymbol><ci id="S1.E10.m1.6.6.1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S1.E10.m1.6.6.1.1.1.1.1.1.1.2.2.3.2">𝑊</ci><ci id="S1.E10.m1.6.6.1.1.1.1.1.1.1.2.2.3.3.cmml" xref="S1.E10.m1.6.6.1.1.1.1.1.1.1.2.2.3.3">𝑣</ci></apply></apply><apply id="S1.E10.m1.6.6.1.1.1.1.1.1.1.2.3.cmml" xref="S1.E10.m1.6.6.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S1.E10.m1.6.6.1.1.1.1.1.1.1.2.3.1.cmml" xref="S1.E10.m1.6.6.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S1.E10.m1.6.6.1.1.1.1.1.1.1.2.3.2.cmml" xref="S1.E10.m1.6.6.1.1.1.1.1.1.1.2.3.2">𝑥</ci><ci id="S1.E10.m1.6.6.1.1.1.1.1.1.1.2.3.3.cmml" xref="S1.E10.m1.6.6.1.1.1.1.1.1.1.2.3.3">𝑗</ci></apply></apply></apply><ci id="S1.E10.m1.5.5a.cmml" xref="S1.E10.m1.5.5"><mtext id="S1.E10.m1.5.5.cmml" xref="S1.E10.m1.5.5">with</mtext></ci></list></apply><apply id="S1.E10.m1.6.6.1.1.2.2.cmml" xref="S1.E10.m1.6.6.1.1.2.2"><eq id="S1.E10.m1.6.6.1.1.2.2.1.cmml" xref="S1.E10.m1.6.6.1.1.2.2.1"></eq><apply id="S1.E10.m1.6.6.1.1.2.2.2.cmml" xref="S1.E10.m1.6.6.1.1.2.2.2"><csymbol cd="ambiguous" id="S1.E10.m1.6.6.1.1.2.2.2.1.cmml" xref="S1.E10.m1.6.6.1.1.2.2.2">subscript</csymbol><ci id="S1.E10.m1.6.6.1.1.2.2.2.2.cmml" xref="S1.E10.m1.6.6.1.1.2.2.2.2">𝑎</ci><list id="S1.E10.m1.4.4.2.3.cmml" xref="S1.E10.m1.4.4.2.4"><ci id="S1.E10.m1.3.3.1.1.cmml" xref="S1.E10.m1.3.3.1.1">𝑠</ci><ci id="S1.E10.m1.4.4.2.2.cmml" xref="S1.E10.m1.4.4.2.2">𝑗</ci></list></apply><apply id="S1.E10.m1.6.6.1.1.2.2.3.cmml" xref="S1.E10.m1.6.6.1.1.2.2.3"><divide id="S1.E10.m1.6.6.1.1.2.2.3.1.cmml" xref="S1.E10.m1.6.6.1.1.2.2.3"></divide><apply id="S1.E10.m1.6.6.1.1.2.2.3.2.cmml" xref="S1.E10.m1.6.6.1.1.2.2.3.2"><csymbol cd="ambiguous" id="S1.E10.m1.6.6.1.1.2.2.3.2.1.cmml" xref="S1.E10.m1.6.6.1.1.2.2.3.2">superscript</csymbol><ci id="S1.E10.m1.6.6.1.1.2.2.3.2.2a.cmml" xref="S1.E10.m1.6.6.1.1.2.2.3.2.2"><mtext id="S1.E10.m1.6.6.1.1.2.2.3.2.2.cmml" xref="S1.E10.m1.6.6.1.1.2.2.3.2.2">e</mtext></ci><apply id="S1.E10.m1.6.6.1.1.2.2.3.2.3.cmml" xref="S1.E10.m1.6.6.1.1.2.2.3.2.3"><times id="S1.E10.m1.6.6.1.1.2.2.3.2.3.1.cmml" xref="S1.E10.m1.6.6.1.1.2.2.3.2.3.1"></times><apply id="S1.E10.m1.6.6.1.1.2.2.3.2.3.2.cmml" xref="S1.E10.m1.6.6.1.1.2.2.3.2.3.2"><csymbol cd="ambiguous" id="S1.E10.m1.6.6.1.1.2.2.3.2.3.2.1.cmml" xref="S1.E10.m1.6.6.1.1.2.2.3.2.3.2">superscript</csymbol><apply id="S1.E10.m1.6.6.1.1.2.2.3.2.3.2.2.cmml" xref="S1.E10.m1.6.6.1.1.2.2.3.2.3.2"><csymbol cd="ambiguous" id="S1.E10.m1.6.6.1.1.2.2.3.2.3.2.2.1.cmml" xref="S1.E10.m1.6.6.1.1.2.2.3.2.3.2">subscript</csymbol><ci id="S1.E10.m1.6.6.1.1.2.2.3.2.3.2.2.2.cmml" xref="S1.E10.m1.6.6.1.1.2.2.3.2.3.2.2.2">𝑥</ci><ci id="S1.E10.m1.6.6.1.1.2.2.3.2.3.2.2.3.cmml" xref="S1.E10.m1.6.6.1.1.2.2.3.2.3.2.2.3">𝑠</ci></apply><csymbol cd="latexml" id="S1.E10.m1.6.6.1.1.2.2.3.2.3.2.3.cmml" xref="S1.E10.m1.6.6.1.1.2.2.3.2.3.2.3">top</csymbol></apply><apply id="S1.E10.m1.6.6.1.1.2.2.3.2.3.3.cmml" xref="S1.E10.m1.6.6.1.1.2.2.3.2.3.3"><csymbol cd="ambiguous" id="S1.E10.m1.6.6.1.1.2.2.3.2.3.3.1.cmml" xref="S1.E10.m1.6.6.1.1.2.2.3.2.3.3">superscript</csymbol><apply id="S1.E10.m1.6.6.1.1.2.2.3.2.3.3.2.cmml" xref="S1.E10.m1.6.6.1.1.2.2.3.2.3.3"><csymbol cd="ambiguous" id="S1.E10.m1.6.6.1.1.2.2.3.2.3.3.2.1.cmml" xref="S1.E10.m1.6.6.1.1.2.2.3.2.3.3">subscript</csymbol><ci id="S1.E10.m1.6.6.1.1.2.2.3.2.3.3.2.2.cmml" xref="S1.E10.m1.6.6.1.1.2.2.3.2.3.3.2.2">𝑊</ci><ci id="S1.E10.m1.6.6.1.1.2.2.3.2.3.3.2.3.cmml" xref="S1.E10.m1.6.6.1.1.2.2.3.2.3.3.2.3">𝑞</ci></apply><csymbol cd="latexml" id="S1.E10.m1.6.6.1.1.2.2.3.2.3.3.3.cmml" xref="S1.E10.m1.6.6.1.1.2.2.3.2.3.3.3">top</csymbol></apply><apply id="S1.E10.m1.6.6.1.1.2.2.3.2.3.4.cmml" xref="S1.E10.m1.6.6.1.1.2.2.3.2.3.4"><csymbol cd="ambiguous" id="S1.E10.m1.6.6.1.1.2.2.3.2.3.4.1.cmml" xref="S1.E10.m1.6.6.1.1.2.2.3.2.3.4">subscript</csymbol><ci id="S1.E10.m1.6.6.1.1.2.2.3.2.3.4.2.cmml" xref="S1.E10.m1.6.6.1.1.2.2.3.2.3.4.2">𝑊</ci><ci id="S1.E10.m1.6.6.1.1.2.2.3.2.3.4.3.cmml" xref="S1.E10.m1.6.6.1.1.2.2.3.2.3.4.3">𝑘</ci></apply><apply id="S1.E10.m1.6.6.1.1.2.2.3.2.3.5.cmml" xref="S1.E10.m1.6.6.1.1.2.2.3.2.3.5"><csymbol cd="ambiguous" id="S1.E10.m1.6.6.1.1.2.2.3.2.3.5.1.cmml" xref="S1.E10.m1.6.6.1.1.2.2.3.2.3.5">subscript</csymbol><ci id="S1.E10.m1.6.6.1.1.2.2.3.2.3.5.2.cmml" xref="S1.E10.m1.6.6.1.1.2.2.3.2.3.5.2">𝑥</ci><ci id="S1.E10.m1.6.6.1.1.2.2.3.2.3.5.3.cmml" xref="S1.E10.m1.6.6.1.1.2.2.3.2.3.5.3">𝑗</ci></apply></apply></apply><apply id="S1.E10.m1.6.6.1.1.2.2.3.3.cmml" xref="S1.E10.m1.6.6.1.1.2.2.3.3"><apply id="S1.E10.m1.6.6.1.1.2.2.3.3.1.cmml" xref="S1.E10.m1.6.6.1.1.2.2.3.3.1"><csymbol cd="ambiguous" id="S1.E10.m1.6.6.1.1.2.2.3.3.1.1.cmml" xref="S1.E10.m1.6.6.1.1.2.2.3.3.1">superscript</csymbol><apply id="S1.E10.m1.6.6.1.1.2.2.3.3.1.2.cmml" xref="S1.E10.m1.6.6.1.1.2.2.3.3.1"><csymbol cd="ambiguous" id="S1.E10.m1.6.6.1.1.2.2.3.3.1.2.1.cmml" xref="S1.E10.m1.6.6.1.1.2.2.3.3.1">subscript</csymbol><sum id="S1.E10.m1.6.6.1.1.2.2.3.3.1.2.2.cmml" xref="S1.E10.m1.6.6.1.1.2.2.3.3.1.2.2"></sum><apply id="S1.E10.m1.6.6.1.1.2.2.3.3.1.2.3.cmml" xref="S1.E10.m1.6.6.1.1.2.2.3.3.1.2.3"><eq id="S1.E10.m1.6.6.1.1.2.2.3.3.1.2.3.1.cmml" xref="S1.E10.m1.6.6.1.1.2.2.3.3.1.2.3.1"></eq><ci id="S1.E10.m1.6.6.1.1.2.2.3.3.1.2.3.2.cmml" xref="S1.E10.m1.6.6.1.1.2.2.3.3.1.2.3.2">𝑙</ci><cn type="integer" id="S1.E10.m1.6.6.1.1.2.2.3.3.1.2.3.3.cmml" xref="S1.E10.m1.6.6.1.1.2.2.3.3.1.2.3.3">1</cn></apply></apply><ci id="S1.E10.m1.6.6.1.1.2.2.3.3.1.3.cmml" xref="S1.E10.m1.6.6.1.1.2.2.3.3.1.3">𝑆</ci></apply><apply id="S1.E10.m1.6.6.1.1.2.2.3.3.2.cmml" xref="S1.E10.m1.6.6.1.1.2.2.3.3.2"><csymbol cd="ambiguous" id="S1.E10.m1.6.6.1.1.2.2.3.3.2.1.cmml" xref="S1.E10.m1.6.6.1.1.2.2.3.3.2">superscript</csymbol><ci id="S1.E10.m1.6.6.1.1.2.2.3.3.2.2a.cmml" xref="S1.E10.m1.6.6.1.1.2.2.3.3.2.2"><mtext id="S1.E10.m1.6.6.1.1.2.2.3.3.2.2.cmml" xref="S1.E10.m1.6.6.1.1.2.2.3.3.2.2">e</mtext></ci><apply id="S1.E10.m1.6.6.1.1.2.2.3.3.2.3.cmml" xref="S1.E10.m1.6.6.1.1.2.2.3.3.2.3"><times id="S1.E10.m1.6.6.1.1.2.2.3.3.2.3.1.cmml" xref="S1.E10.m1.6.6.1.1.2.2.3.3.2.3.1"></times><apply id="S1.E10.m1.6.6.1.1.2.2.3.3.2.3.2.cmml" xref="S1.E10.m1.6.6.1.1.2.2.3.3.2.3.2"><csymbol cd="ambiguous" id="S1.E10.m1.6.6.1.1.2.2.3.3.2.3.2.1.cmml" xref="S1.E10.m1.6.6.1.1.2.2.3.3.2.3.2">superscript</csymbol><apply id="S1.E10.m1.6.6.1.1.2.2.3.3.2.3.2.2.cmml" xref="S1.E10.m1.6.6.1.1.2.2.3.3.2.3.2"><csymbol cd="ambiguous" id="S1.E10.m1.6.6.1.1.2.2.3.3.2.3.2.2.1.cmml" xref="S1.E10.m1.6.6.1.1.2.2.3.3.2.3.2">subscript</csymbol><ci id="S1.E10.m1.6.6.1.1.2.2.3.3.2.3.2.2.2.cmml" xref="S1.E10.m1.6.6.1.1.2.2.3.3.2.3.2.2.2">𝑥</ci><ci id="S1.E10.m1.6.6.1.1.2.2.3.3.2.3.2.2.3.cmml" xref="S1.E10.m1.6.6.1.1.2.2.3.3.2.3.2.2.3">𝑠</ci></apply><csymbol cd="latexml" id="S1.E10.m1.6.6.1.1.2.2.3.3.2.3.2.3.cmml" xref="S1.E10.m1.6.6.1.1.2.2.3.3.2.3.2.3">top</csymbol></apply><apply id="S1.E10.m1.6.6.1.1.2.2.3.3.2.3.3.cmml" xref="S1.E10.m1.6.6.1.1.2.2.3.3.2.3.3"><csymbol cd="ambiguous" id="S1.E10.m1.6.6.1.1.2.2.3.3.2.3.3.1.cmml" xref="S1.E10.m1.6.6.1.1.2.2.3.3.2.3.3">superscript</csymbol><apply id="S1.E10.m1.6.6.1.1.2.2.3.3.2.3.3.2.cmml" xref="S1.E10.m1.6.6.1.1.2.2.3.3.2.3.3"><csymbol cd="ambiguous" id="S1.E10.m1.6.6.1.1.2.2.3.3.2.3.3.2.1.cmml" xref="S1.E10.m1.6.6.1.1.2.2.3.3.2.3.3">subscript</csymbol><ci id="S1.E10.m1.6.6.1.1.2.2.3.3.2.3.3.2.2.cmml" xref="S1.E10.m1.6.6.1.1.2.2.3.3.2.3.3.2.2">𝑊</ci><ci id="S1.E10.m1.6.6.1.1.2.2.3.3.2.3.3.2.3.cmml" xref="S1.E10.m1.6.6.1.1.2.2.3.3.2.3.3.2.3">𝑞</ci></apply><csymbol cd="latexml" id="S1.E10.m1.6.6.1.1.2.2.3.3.2.3.3.3.cmml" xref="S1.E10.m1.6.6.1.1.2.2.3.3.2.3.3.3">top</csymbol></apply><apply id="S1.E10.m1.6.6.1.1.2.2.3.3.2.3.4.cmml" xref="S1.E10.m1.6.6.1.1.2.2.3.3.2.3.4"><csymbol cd="ambiguous" id="S1.E10.m1.6.6.1.1.2.2.3.3.2.3.4.1.cmml" xref="S1.E10.m1.6.6.1.1.2.2.3.3.2.3.4">subscript</csymbol><ci id="S1.E10.m1.6.6.1.1.2.2.3.3.2.3.4.2.cmml" xref="S1.E10.m1.6.6.1.1.2.2.3.3.2.3.4.2">𝑊</ci><ci id="S1.E10.m1.6.6.1.1.2.2.3.3.2.3.4.3.cmml" xref="S1.E10.m1.6.6.1.1.2.2.3.3.2.3.4.3">𝑘</ci></apply><apply id="S1.E10.m1.6.6.1.1.2.2.3.3.2.3.5.cmml" xref="S1.E10.m1.6.6.1.1.2.2.3.3.2.3.5"><csymbol cd="ambiguous" id="S1.E10.m1.6.6.1.1.2.2.3.3.2.3.5.1.cmml" xref="S1.E10.m1.6.6.1.1.2.2.3.3.2.3.5">subscript</csymbol><ci id="S1.E10.m1.6.6.1.1.2.2.3.3.2.3.5.2.cmml" xref="S1.E10.m1.6.6.1.1.2.2.3.3.2.3.5.2">𝑥</ci><ci id="S1.E10.m1.6.6.1.1.2.2.3.3.2.3.5.3.cmml" xref="S1.E10.m1.6.6.1.1.2.2.3.3.2.3.5.3">𝑙</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.E10.m1.6c">\displaystyle y_{s}=\sum_{j=1}^{S}a_{s,j}\cdot W_{v}x_{j}\qquad\text{with}%
\qquad a_{s,j}=\frac{\text{e}^{x_{s}^{\top}W_{q}^{\top}W_{k}x_{j}}}{\sum_{l=1}%
^{S}\text{e}^{x_{s}^{\top}W_{q}^{\top}W_{k}x_{l}}},</annotation><annotation encoding="application/x-llamapun" id="S1.E10.m1.6d">italic_y start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_S end_POSTSUPERSCRIPT italic_a start_POSTSUBSCRIPT italic_s , italic_j end_POSTSUBSCRIPT ⋅ italic_W start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT italic_x start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT with italic_a start_POSTSUBSCRIPT italic_s , italic_j end_POSTSUBSCRIPT = divide start_ARG e start_POSTSUPERSCRIPT italic_x start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT italic_W start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT italic_W start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT italic_x start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUPERSCRIPT end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_l = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_S end_POSTSUPERSCRIPT e start_POSTSUPERSCRIPT italic_x start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT italic_W start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT italic_W start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT italic_x start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT end_POSTSUPERSCRIPT end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<p id="S1.SS1.SSS3.p2.1" class="ltx_p">where <math id="S1.SS1.SSS3.p2.1.m1.2" class="ltx_Math" alttext="a_{s,j}" display="inline"><semantics id="S1.SS1.SSS3.p2.1.m1.2a"><msub id="S1.SS1.SSS3.p2.1.m1.2.3" xref="S1.SS1.SSS3.p2.1.m1.2.3.cmml"><mi id="S1.SS1.SSS3.p2.1.m1.2.3.2" xref="S1.SS1.SSS3.p2.1.m1.2.3.2.cmml">a</mi><mrow id="S1.SS1.SSS3.p2.1.m1.2.2.2.4" xref="S1.SS1.SSS3.p2.1.m1.2.2.2.3.cmml"><mi id="S1.SS1.SSS3.p2.1.m1.1.1.1.1" xref="S1.SS1.SSS3.p2.1.m1.1.1.1.1.cmml">s</mi><mo id="S1.SS1.SSS3.p2.1.m1.2.2.2.4.1" xref="S1.SS1.SSS3.p2.1.m1.2.2.2.3.cmml">,</mo><mi id="S1.SS1.SSS3.p2.1.m1.2.2.2.2" xref="S1.SS1.SSS3.p2.1.m1.2.2.2.2.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S1.SS1.SSS3.p2.1.m1.2b"><apply id="S1.SS1.SSS3.p2.1.m1.2.3.cmml" xref="S1.SS1.SSS3.p2.1.m1.2.3"><csymbol cd="ambiguous" id="S1.SS1.SSS3.p2.1.m1.2.3.1.cmml" xref="S1.SS1.SSS3.p2.1.m1.2.3">subscript</csymbol><ci id="S1.SS1.SSS3.p2.1.m1.2.3.2.cmml" xref="S1.SS1.SSS3.p2.1.m1.2.3.2">𝑎</ci><list id="S1.SS1.SSS3.p2.1.m1.2.2.2.3.cmml" xref="S1.SS1.SSS3.p2.1.m1.2.2.2.4"><ci id="S1.SS1.SSS3.p2.1.m1.1.1.1.1.cmml" xref="S1.SS1.SSS3.p2.1.m1.1.1.1.1">𝑠</ci><ci id="S1.SS1.SSS3.p2.1.m1.2.2.2.2.cmml" xref="S1.SS1.SSS3.p2.1.m1.2.2.2.2">𝑗</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.SS1.SSS3.p2.1.m1.2c">a_{s,j}</annotation><annotation encoding="application/x-llamapun" id="S1.SS1.SSS3.p2.1.m1.2d">italic_a start_POSTSUBSCRIPT italic_s , italic_j end_POSTSUBSCRIPT</annotation></semantics></math> denote the self-attention coefficients.</p>
</div>
</section>
</section>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Method</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p">In this section, we will introduce the QSANN in detail, which mainly consists of <span id="S2.p1.1.1" class="ltx_text ltx_font_italic">quantum self-attention layer</span> (QSAL), loss function, analytical gradients and analysis.
</p>
</div>
<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Quantum Self-Attention Layer</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.1" class="ltx_p">In the classical self-attention mechanism <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib36" title="" class="ltx_ref">36</a>]</cite>, there are mainly three components (vectors), i.e., queries, keys and values, where queries and keys are computed as weights assigned to corresponding values to obtain final outputs.
Inspired by this mechanism, in QSAL we design the quantum analogs of these components. The overall picture of QSAL is illustrated in Fig. <a href="#S1.F1" title="Figure 1 ‣ 1.1.2 Text Classification ‣ 1.1 Preliminaries and Notations ‣ 1 Introduction ‣ Quantum Self-Attention Neural Networks for Text Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<div id="S2.SS1.p2" class="ltx_para">
<p id="S2.SS1.p2.5" class="ltx_p">For the classical input data <math id="S2.SS1.p2.1.m1.1" class="ltx_Math" alttext="\{\bm{y}^{(l-1)}_{s}" display="inline"><semantics id="S2.SS1.p2.1.m1.1a"><mrow id="S2.SS1.p2.1.m1.1b"><mo stretchy="false" id="S2.SS1.p2.1.m1.1.2" xref="S2.SS1.p2.1.m1.1.2.cmml">{</mo><msubsup id="S2.SS1.p2.1.m1.1.3" xref="S2.SS1.p2.1.m1.1.3.cmml"><mi id="S2.SS1.p2.1.m1.1.3.2.2" xref="S2.SS1.p2.1.m1.1.3.2.2.cmml">𝒚</mi><mi id="S2.SS1.p2.1.m1.1.3.3" xref="S2.SS1.p2.1.m1.1.3.3.cmml">s</mi><mrow id="S2.SS1.p2.1.m1.1.1.1.1" xref="S2.SS1.p2.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS1.p2.1.m1.1.1.1.1.2" xref="S2.SS1.p2.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS1.p2.1.m1.1.1.1.1.1" xref="S2.SS1.p2.1.m1.1.1.1.1.1.cmml"><mi id="S2.SS1.p2.1.m1.1.1.1.1.1.2" xref="S2.SS1.p2.1.m1.1.1.1.1.1.2.cmml">l</mi><mo id="S2.SS1.p2.1.m1.1.1.1.1.1.1" xref="S2.SS1.p2.1.m1.1.1.1.1.1.1.cmml">-</mo><mn id="S2.SS1.p2.1.m1.1.1.1.1.1.3" xref="S2.SS1.p2.1.m1.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S2.SS1.p2.1.m1.1.1.1.1.3" xref="S2.SS1.p2.1.m1.1.1.1.1.1.cmml">)</mo></mrow></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.1.m1.1c"><cerror id="S2.SS1.p2.1.m1.1d"><csymbol cd="ambiguous" id="S2.SS1.p2.1.m1.1e">fragments</csymbol><ci id="S2.SS1.p2.1.m1.1.2.cmml" xref="S2.SS1.p2.1.m1.1.2">{</ci><apply id="S2.SS1.p2.1.m1.1.3.cmml" xref="S2.SS1.p2.1.m1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p2.1.m1.1.3.1.cmml" xref="S2.SS1.p2.1.m1.1.3">subscript</csymbol><apply id="S2.SS1.p2.1.m1.1.3.2.cmml" xref="S2.SS1.p2.1.m1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p2.1.m1.1.3.2.1.cmml" xref="S2.SS1.p2.1.m1.1.3">superscript</csymbol><ci id="S2.SS1.p2.1.m1.1.3.2.2.cmml" xref="S2.SS1.p2.1.m1.1.3.2.2">𝒚</ci><apply id="S2.SS1.p2.1.m1.1.1.1.1.1.cmml" xref="S2.SS1.p2.1.m1.1.1.1.1"><minus id="S2.SS1.p2.1.m1.1.1.1.1.1.1.cmml" xref="S2.SS1.p2.1.m1.1.1.1.1.1.1"></minus><ci id="S2.SS1.p2.1.m1.1.1.1.1.1.2.cmml" xref="S2.SS1.p2.1.m1.1.1.1.1.1.2">𝑙</ci><cn type="integer" id="S2.SS1.p2.1.m1.1.1.1.1.1.3.cmml" xref="S2.SS1.p2.1.m1.1.1.1.1.1.3">1</cn></apply></apply><ci id="S2.SS1.p2.1.m1.1.3.3.cmml" xref="S2.SS1.p2.1.m1.1.3.3">𝑠</ci></apply></cerror></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.1.m1.1f">\{\bm{y}^{(l-1)}_{s}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.1.m1.1g">{ bold_italic_y start_POSTSUPERSCRIPT ( italic_l - 1 ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> <math id="S2.SS1.p2.2.m2.1" class="ltx_Math" alttext="\in\mathbb{R}^{d}\}" display="inline"><semantics id="S2.SS1.p2.2.m2.1a"><mrow id="S2.SS1.p2.2.m2.1b"><mo id="S2.SS1.p2.2.m2.1.1" xref="S2.SS1.p2.2.m2.1.1.cmml">∈</mo><msup id="S2.SS1.p2.2.m2.1.2" xref="S2.SS1.p2.2.m2.1.2.cmml"><mi id="S2.SS1.p2.2.m2.1.2.2" xref="S2.SS1.p2.2.m2.1.2.2.cmml">ℝ</mi><mi id="S2.SS1.p2.2.m2.1.2.3" xref="S2.SS1.p2.2.m2.1.2.3.cmml">d</mi></msup><mo stretchy="false" id="S2.SS1.p2.2.m2.1.3" xref="S2.SS1.p2.2.m2.1.3.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.2.m2.1c"><cerror id="S2.SS1.p2.2.m2.1d"><csymbol cd="ambiguous" id="S2.SS1.p2.2.m2.1e">fragments</csymbol><in id="S2.SS1.p2.2.m2.1.1.cmml" xref="S2.SS1.p2.2.m2.1.1"></in><apply id="S2.SS1.p2.2.m2.1.2.cmml" xref="S2.SS1.p2.2.m2.1.2"><csymbol cd="ambiguous" id="S2.SS1.p2.2.m2.1.2.1.cmml" xref="S2.SS1.p2.2.m2.1.2">superscript</csymbol><ci id="S2.SS1.p2.2.m2.1.2.2.cmml" xref="S2.SS1.p2.2.m2.1.2.2">ℝ</ci><ci id="S2.SS1.p2.2.m2.1.2.3.cmml" xref="S2.SS1.p2.2.m2.1.2.3">𝑑</ci></apply><ci id="S2.SS1.p2.2.m2.1.3.cmml" xref="S2.SS1.p2.2.m2.1.3">}</ci></cerror></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.2.m2.1f">\in\mathbb{R}^{d}\}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.2.m2.1g">∈ blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT }</annotation></semantics></math> of the <math id="S2.SS1.p2.3.m3.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S2.SS1.p2.3.m3.1a"><mi id="S2.SS1.p2.3.m3.1.1" xref="S2.SS1.p2.3.m3.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.3.m3.1b"><ci id="S2.SS1.p2.3.m3.1.1.cmml" xref="S2.SS1.p2.3.m3.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.3.m3.1c">l</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.3.m3.1d">italic_l</annotation></semantics></math>-th QSAL, we first use a quantum ansatz <math id="S2.SS1.p2.4.m4.1" class="ltx_Math" alttext="U_{enc}" display="inline"><semantics id="S2.SS1.p2.4.m4.1a"><msub id="S2.SS1.p2.4.m4.1.1" xref="S2.SS1.p2.4.m4.1.1.cmml"><mi id="S2.SS1.p2.4.m4.1.1.2" xref="S2.SS1.p2.4.m4.1.1.2.cmml">U</mi><mrow id="S2.SS1.p2.4.m4.1.1.3" xref="S2.SS1.p2.4.m4.1.1.3.cmml"><mi id="S2.SS1.p2.4.m4.1.1.3.2" xref="S2.SS1.p2.4.m4.1.1.3.2.cmml">e</mi><mo id="S2.SS1.p2.4.m4.1.1.3.1" xref="S2.SS1.p2.4.m4.1.1.3.1.cmml">⁢</mo><mi id="S2.SS1.p2.4.m4.1.1.3.3" xref="S2.SS1.p2.4.m4.1.1.3.3.cmml">n</mi><mo id="S2.SS1.p2.4.m4.1.1.3.1a" xref="S2.SS1.p2.4.m4.1.1.3.1.cmml">⁢</mo><mi id="S2.SS1.p2.4.m4.1.1.3.4" xref="S2.SS1.p2.4.m4.1.1.3.4.cmml">c</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.4.m4.1b"><apply id="S2.SS1.p2.4.m4.1.1.cmml" xref="S2.SS1.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.4.m4.1.1.1.cmml" xref="S2.SS1.p2.4.m4.1.1">subscript</csymbol><ci id="S2.SS1.p2.4.m4.1.1.2.cmml" xref="S2.SS1.p2.4.m4.1.1.2">𝑈</ci><apply id="S2.SS1.p2.4.m4.1.1.3.cmml" xref="S2.SS1.p2.4.m4.1.1.3"><times id="S2.SS1.p2.4.m4.1.1.3.1.cmml" xref="S2.SS1.p2.4.m4.1.1.3.1"></times><ci id="S2.SS1.p2.4.m4.1.1.3.2.cmml" xref="S2.SS1.p2.4.m4.1.1.3.2">𝑒</ci><ci id="S2.SS1.p2.4.m4.1.1.3.3.cmml" xref="S2.SS1.p2.4.m4.1.1.3.3">𝑛</ci><ci id="S2.SS1.p2.4.m4.1.1.3.4.cmml" xref="S2.SS1.p2.4.m4.1.1.3.4">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.4.m4.1c">U_{enc}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.4.m4.1d">italic_U start_POSTSUBSCRIPT italic_e italic_n italic_c end_POSTSUBSCRIPT</annotation></semantics></math> to encode them into an <math id="S2.SS1.p2.5.m5.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S2.SS1.p2.5.m5.1a"><mi id="S2.SS1.p2.5.m5.1.1" xref="S2.SS1.p2.5.m5.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.5.m5.1b"><ci id="S2.SS1.p2.5.m5.1.1.cmml" xref="S2.SS1.p2.5.m5.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.5.m5.1c">n</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.5.m5.1d">italic_n</annotation></semantics></math>-qubit quantum Hilbert space, i.e.,</p>
<table id="S1.EGx3" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S2.E11"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E11.m1.2" class="ltx_Math" alttext="\displaystyle\ket{\psi_{s}}=U_{enc}(\bm{y}^{(l-1)}_{s})H^{\otimes n}\ket{0^{n}%
},\quad 1\leq s\leq S," display="inline"><semantics id="S2.E11.m1.2a"><mrow id="S2.E11.m1.2.2.1"><mrow id="S2.E11.m1.2.2.1.1.2" xref="S2.E11.m1.2.2.1.1.3.cmml"><mrow id="S2.E11.m1.2.2.1.1.1.1" xref="S2.E11.m1.2.2.1.1.1.1.cmml"><mrow id="S2.E11.m1.2.2.1.1.1.1.3" xref="S2.E11.m1.2.2.1.1.1.1.3.cmml"><merror class="ltx_ERROR undefined undefined" id="S2.E11.m1.2.2.1.1.1.1.3.2" xref="S2.E11.m1.2.2.1.1.1.1.3.2b.cmml"><mtext id="S2.E11.m1.2.2.1.1.1.1.3.2a" xref="S2.E11.m1.2.2.1.1.1.1.3.2b.cmml">\ket</mtext></merror><mo id="S2.E11.m1.2.2.1.1.1.1.3.1" xref="S2.E11.m1.2.2.1.1.1.1.3.1.cmml">⁢</mo><msub id="S2.E11.m1.2.2.1.1.1.1.3.3" xref="S2.E11.m1.2.2.1.1.1.1.3.3.cmml"><mi id="S2.E11.m1.2.2.1.1.1.1.3.3.2" xref="S2.E11.m1.2.2.1.1.1.1.3.3.2.cmml">ψ</mi><mi id="S2.E11.m1.2.2.1.1.1.1.3.3.3" xref="S2.E11.m1.2.2.1.1.1.1.3.3.3.cmml">s</mi></msub></mrow><mo id="S2.E11.m1.2.2.1.1.1.1.2" xref="S2.E11.m1.2.2.1.1.1.1.2.cmml">=</mo><mrow id="S2.E11.m1.2.2.1.1.1.1.1" xref="S2.E11.m1.2.2.1.1.1.1.1.cmml"><msub id="S2.E11.m1.2.2.1.1.1.1.1.3" xref="S2.E11.m1.2.2.1.1.1.1.1.3.cmml"><mi id="S2.E11.m1.2.2.1.1.1.1.1.3.2" xref="S2.E11.m1.2.2.1.1.1.1.1.3.2.cmml">U</mi><mrow id="S2.E11.m1.2.2.1.1.1.1.1.3.3" xref="S2.E11.m1.2.2.1.1.1.1.1.3.3.cmml"><mi id="S2.E11.m1.2.2.1.1.1.1.1.3.3.2" xref="S2.E11.m1.2.2.1.1.1.1.1.3.3.2.cmml">e</mi><mo id="S2.E11.m1.2.2.1.1.1.1.1.3.3.1" xref="S2.E11.m1.2.2.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.E11.m1.2.2.1.1.1.1.1.3.3.3" xref="S2.E11.m1.2.2.1.1.1.1.1.3.3.3.cmml">n</mi><mo id="S2.E11.m1.2.2.1.1.1.1.1.3.3.1a" xref="S2.E11.m1.2.2.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.E11.m1.2.2.1.1.1.1.1.3.3.4" xref="S2.E11.m1.2.2.1.1.1.1.1.3.3.4.cmml">c</mi></mrow></msub><mo id="S2.E11.m1.2.2.1.1.1.1.1.2" xref="S2.E11.m1.2.2.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E11.m1.2.2.1.1.1.1.1.1.1" xref="S2.E11.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E11.m1.2.2.1.1.1.1.1.1.1.2" xref="S2.E11.m1.2.2.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S2.E11.m1.2.2.1.1.1.1.1.1.1.1" xref="S2.E11.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E11.m1.2.2.1.1.1.1.1.1.1.1.2.2" xref="S2.E11.m1.2.2.1.1.1.1.1.1.1.1.2.2.cmml">𝒚</mi><mi id="S2.E11.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S2.E11.m1.2.2.1.1.1.1.1.1.1.1.3.cmml">s</mi><mrow id="S2.E11.m1.1.1.1.1" xref="S2.E11.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E11.m1.1.1.1.1.2" xref="S2.E11.m1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E11.m1.1.1.1.1.1" xref="S2.E11.m1.1.1.1.1.1.cmml"><mi id="S2.E11.m1.1.1.1.1.1.2" xref="S2.E11.m1.1.1.1.1.1.2.cmml">l</mi><mo id="S2.E11.m1.1.1.1.1.1.1" xref="S2.E11.m1.1.1.1.1.1.1.cmml">-</mo><mn id="S2.E11.m1.1.1.1.1.1.3" xref="S2.E11.m1.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S2.E11.m1.1.1.1.1.3" xref="S2.E11.m1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="S2.E11.m1.2.2.1.1.1.1.1.1.1.3" xref="S2.E11.m1.2.2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.E11.m1.2.2.1.1.1.1.1.2a" xref="S2.E11.m1.2.2.1.1.1.1.1.2.cmml">⁢</mo><msup id="S2.E11.m1.2.2.1.1.1.1.1.4" xref="S2.E11.m1.2.2.1.1.1.1.1.4.cmml"><mi id="S2.E11.m1.2.2.1.1.1.1.1.4.2" xref="S2.E11.m1.2.2.1.1.1.1.1.4.2.cmml">H</mi><mrow id="S2.E11.m1.2.2.1.1.1.1.1.4.3" xref="S2.E11.m1.2.2.1.1.1.1.1.4.3.cmml"><mi id="S2.E11.m1.2.2.1.1.1.1.1.4.3.2" xref="S2.E11.m1.2.2.1.1.1.1.1.4.3.2.cmml"></mi><mo id="S2.E11.m1.2.2.1.1.1.1.1.4.3.1" xref="S2.E11.m1.2.2.1.1.1.1.1.4.3.1.cmml">⊗</mo><mi id="S2.E11.m1.2.2.1.1.1.1.1.4.3.3" xref="S2.E11.m1.2.2.1.1.1.1.1.4.3.3.cmml">n</mi></mrow></msup><mo id="S2.E11.m1.2.2.1.1.1.1.1.2b" xref="S2.E11.m1.2.2.1.1.1.1.1.2.cmml">⁢</mo><merror class="ltx_ERROR undefined undefined" id="S2.E11.m1.2.2.1.1.1.1.1.5" xref="S2.E11.m1.2.2.1.1.1.1.1.5b.cmml"><mtext id="S2.E11.m1.2.2.1.1.1.1.1.5a" xref="S2.E11.m1.2.2.1.1.1.1.1.5b.cmml">\ket</mtext></merror><mo id="S2.E11.m1.2.2.1.1.1.1.1.2c" xref="S2.E11.m1.2.2.1.1.1.1.1.2.cmml">⁢</mo><msup id="S2.E11.m1.2.2.1.1.1.1.1.6" xref="S2.E11.m1.2.2.1.1.1.1.1.6.cmml"><mn id="S2.E11.m1.2.2.1.1.1.1.1.6.2" xref="S2.E11.m1.2.2.1.1.1.1.1.6.2.cmml">0</mn><mi id="S2.E11.m1.2.2.1.1.1.1.1.6.3" xref="S2.E11.m1.2.2.1.1.1.1.1.6.3.cmml">n</mi></msup></mrow></mrow><mo rspace="12.5pt" id="S2.E11.m1.2.2.1.1.2.3" xref="S2.E11.m1.2.2.1.1.3a.cmml">,</mo><mrow id="S2.E11.m1.2.2.1.1.2.2" xref="S2.E11.m1.2.2.1.1.2.2.cmml"><mn id="S2.E11.m1.2.2.1.1.2.2.2" xref="S2.E11.m1.2.2.1.1.2.2.2.cmml">1</mn><mo id="S2.E11.m1.2.2.1.1.2.2.3" xref="S2.E11.m1.2.2.1.1.2.2.3.cmml">≤</mo><mi id="S2.E11.m1.2.2.1.1.2.2.4" xref="S2.E11.m1.2.2.1.1.2.2.4.cmml">s</mi><mo id="S2.E11.m1.2.2.1.1.2.2.5" xref="S2.E11.m1.2.2.1.1.2.2.5.cmml">≤</mo><mi id="S2.E11.m1.2.2.1.1.2.2.6" xref="S2.E11.m1.2.2.1.1.2.2.6.cmml">S</mi></mrow></mrow><mo id="S2.E11.m1.2.2.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E11.m1.2b"><apply id="S2.E11.m1.2.2.1.1.3.cmml" xref="S2.E11.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S2.E11.m1.2.2.1.1.3a.cmml" xref="S2.E11.m1.2.2.1.1.2.3">formulae-sequence</csymbol><apply id="S2.E11.m1.2.2.1.1.1.1.cmml" xref="S2.E11.m1.2.2.1.1.1.1"><eq id="S2.E11.m1.2.2.1.1.1.1.2.cmml" xref="S2.E11.m1.2.2.1.1.1.1.2"></eq><apply id="S2.E11.m1.2.2.1.1.1.1.3.cmml" xref="S2.E11.m1.2.2.1.1.1.1.3"><times id="S2.E11.m1.2.2.1.1.1.1.3.1.cmml" xref="S2.E11.m1.2.2.1.1.1.1.3.1"></times><ci id="S2.E11.m1.2.2.1.1.1.1.3.2b.cmml" xref="S2.E11.m1.2.2.1.1.1.1.3.2"><merror class="ltx_ERROR undefined undefined" id="S2.E11.m1.2.2.1.1.1.1.3.2.cmml" xref="S2.E11.m1.2.2.1.1.1.1.3.2"><mtext id="S2.E11.m1.2.2.1.1.1.1.3.2a.cmml" xref="S2.E11.m1.2.2.1.1.1.1.3.2">\ket</mtext></merror></ci><apply id="S2.E11.m1.2.2.1.1.1.1.3.3.cmml" xref="S2.E11.m1.2.2.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E11.m1.2.2.1.1.1.1.3.3.1.cmml" xref="S2.E11.m1.2.2.1.1.1.1.3.3">subscript</csymbol><ci id="S2.E11.m1.2.2.1.1.1.1.3.3.2.cmml" xref="S2.E11.m1.2.2.1.1.1.1.3.3.2">𝜓</ci><ci id="S2.E11.m1.2.2.1.1.1.1.3.3.3.cmml" xref="S2.E11.m1.2.2.1.1.1.1.3.3.3">𝑠</ci></apply></apply><apply id="S2.E11.m1.2.2.1.1.1.1.1.cmml" xref="S2.E11.m1.2.2.1.1.1.1.1"><times id="S2.E11.m1.2.2.1.1.1.1.1.2.cmml" xref="S2.E11.m1.2.2.1.1.1.1.1.2"></times><apply id="S2.E11.m1.2.2.1.1.1.1.1.3.cmml" xref="S2.E11.m1.2.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E11.m1.2.2.1.1.1.1.1.3.1.cmml" xref="S2.E11.m1.2.2.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E11.m1.2.2.1.1.1.1.1.3.2.cmml" xref="S2.E11.m1.2.2.1.1.1.1.1.3.2">𝑈</ci><apply id="S2.E11.m1.2.2.1.1.1.1.1.3.3.cmml" xref="S2.E11.m1.2.2.1.1.1.1.1.3.3"><times id="S2.E11.m1.2.2.1.1.1.1.1.3.3.1.cmml" xref="S2.E11.m1.2.2.1.1.1.1.1.3.3.1"></times><ci id="S2.E11.m1.2.2.1.1.1.1.1.3.3.2.cmml" xref="S2.E11.m1.2.2.1.1.1.1.1.3.3.2">𝑒</ci><ci id="S2.E11.m1.2.2.1.1.1.1.1.3.3.3.cmml" xref="S2.E11.m1.2.2.1.1.1.1.1.3.3.3">𝑛</ci><ci id="S2.E11.m1.2.2.1.1.1.1.1.3.3.4.cmml" xref="S2.E11.m1.2.2.1.1.1.1.1.3.3.4">𝑐</ci></apply></apply><apply id="S2.E11.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S2.E11.m1.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E11.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E11.m1.2.2.1.1.1.1.1.1.1">subscript</csymbol><apply id="S2.E11.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E11.m1.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E11.m1.2.2.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E11.m1.2.2.1.1.1.1.1.1.1">superscript</csymbol><ci id="S2.E11.m1.2.2.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E11.m1.2.2.1.1.1.1.1.1.1.1.2.2">𝒚</ci><apply id="S2.E11.m1.1.1.1.1.1.cmml" xref="S2.E11.m1.1.1.1.1"><minus id="S2.E11.m1.1.1.1.1.1.1.cmml" xref="S2.E11.m1.1.1.1.1.1.1"></minus><ci id="S2.E11.m1.1.1.1.1.1.2.cmml" xref="S2.E11.m1.1.1.1.1.1.2">𝑙</ci><cn type="integer" id="S2.E11.m1.1.1.1.1.1.3.cmml" xref="S2.E11.m1.1.1.1.1.1.3">1</cn></apply></apply><ci id="S2.E11.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E11.m1.2.2.1.1.1.1.1.1.1.1.3">𝑠</ci></apply><apply id="S2.E11.m1.2.2.1.1.1.1.1.4.cmml" xref="S2.E11.m1.2.2.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.E11.m1.2.2.1.1.1.1.1.4.1.cmml" xref="S2.E11.m1.2.2.1.1.1.1.1.4">superscript</csymbol><ci id="S2.E11.m1.2.2.1.1.1.1.1.4.2.cmml" xref="S2.E11.m1.2.2.1.1.1.1.1.4.2">𝐻</ci><apply id="S2.E11.m1.2.2.1.1.1.1.1.4.3.cmml" xref="S2.E11.m1.2.2.1.1.1.1.1.4.3"><csymbol cd="latexml" id="S2.E11.m1.2.2.1.1.1.1.1.4.3.1.cmml" xref="S2.E11.m1.2.2.1.1.1.1.1.4.3.1">tensor-product</csymbol><csymbol cd="latexml" id="S2.E11.m1.2.2.1.1.1.1.1.4.3.2.cmml" xref="S2.E11.m1.2.2.1.1.1.1.1.4.3.2">absent</csymbol><ci id="S2.E11.m1.2.2.1.1.1.1.1.4.3.3.cmml" xref="S2.E11.m1.2.2.1.1.1.1.1.4.3.3">𝑛</ci></apply></apply><ci id="S2.E11.m1.2.2.1.1.1.1.1.5b.cmml" xref="S2.E11.m1.2.2.1.1.1.1.1.5"><merror class="ltx_ERROR undefined undefined" id="S2.E11.m1.2.2.1.1.1.1.1.5.cmml" xref="S2.E11.m1.2.2.1.1.1.1.1.5"><mtext id="S2.E11.m1.2.2.1.1.1.1.1.5a.cmml" xref="S2.E11.m1.2.2.1.1.1.1.1.5">\ket</mtext></merror></ci><apply id="S2.E11.m1.2.2.1.1.1.1.1.6.cmml" xref="S2.E11.m1.2.2.1.1.1.1.1.6"><csymbol cd="ambiguous" id="S2.E11.m1.2.2.1.1.1.1.1.6.1.cmml" xref="S2.E11.m1.2.2.1.1.1.1.1.6">superscript</csymbol><cn type="integer" id="S2.E11.m1.2.2.1.1.1.1.1.6.2.cmml" xref="S2.E11.m1.2.2.1.1.1.1.1.6.2">0</cn><ci id="S2.E11.m1.2.2.1.1.1.1.1.6.3.cmml" xref="S2.E11.m1.2.2.1.1.1.1.1.6.3">𝑛</ci></apply></apply></apply><apply id="S2.E11.m1.2.2.1.1.2.2.cmml" xref="S2.E11.m1.2.2.1.1.2.2"><and id="S2.E11.m1.2.2.1.1.2.2a.cmml" xref="S2.E11.m1.2.2.1.1.2.2"></and><apply id="S2.E11.m1.2.2.1.1.2.2b.cmml" xref="S2.E11.m1.2.2.1.1.2.2"><leq id="S2.E11.m1.2.2.1.1.2.2.3.cmml" xref="S2.E11.m1.2.2.1.1.2.2.3"></leq><cn type="integer" id="S2.E11.m1.2.2.1.1.2.2.2.cmml" xref="S2.E11.m1.2.2.1.1.2.2.2">1</cn><ci id="S2.E11.m1.2.2.1.1.2.2.4.cmml" xref="S2.E11.m1.2.2.1.1.2.2.4">𝑠</ci></apply><apply id="S2.E11.m1.2.2.1.1.2.2c.cmml" xref="S2.E11.m1.2.2.1.1.2.2"><leq id="S2.E11.m1.2.2.1.1.2.2.5.cmml" xref="S2.E11.m1.2.2.1.1.2.2.5"></leq><share href="#S2.E11.m1.2.2.1.1.2.2.4.cmml" id="S2.E11.m1.2.2.1.1.2.2d.cmml" xref="S2.E11.m1.2.2.1.1.2.2"></share><ci id="S2.E11.m1.2.2.1.1.2.2.6.cmml" xref="S2.E11.m1.2.2.1.1.2.2.6">𝑆</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E11.m1.2c">\displaystyle\ket{\psi_{s}}=U_{enc}(\bm{y}^{(l-1)}_{s})H^{\otimes n}\ket{0^{n}%
},\quad 1\leq s\leq S,</annotation><annotation encoding="application/x-llamapun" id="S2.E11.m1.2d">italic_ψ start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT = italic_U start_POSTSUBSCRIPT italic_e italic_n italic_c end_POSTSUBSCRIPT ( bold_italic_y start_POSTSUPERSCRIPT ( italic_l - 1 ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ) italic_H start_POSTSUPERSCRIPT ⊗ italic_n end_POSTSUPERSCRIPT 0 start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT , 1 ≤ italic_s ≤ italic_S ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
<p id="S2.SS1.p2.7" class="ltx_p">where <math id="S2.SS1.p2.6.m1.1" class="ltx_Math" alttext="H" display="inline"><semantics id="S2.SS1.p2.6.m1.1a"><mi id="S2.SS1.p2.6.m1.1.1" xref="S2.SS1.p2.6.m1.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.6.m1.1b"><ci id="S2.SS1.p2.6.m1.1.1.cmml" xref="S2.SS1.p2.6.m1.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.6.m1.1c">H</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.6.m1.1d">italic_H</annotation></semantics></math> denotes the Hadamard gate and <math id="S2.SS1.p2.7.m2.1" class="ltx_Math" alttext="S" display="inline"><semantics id="S2.SS1.p2.7.m2.1a"><mi id="S2.SS1.p2.7.m2.1.1" xref="S2.SS1.p2.7.m2.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.7.m2.1b"><ci id="S2.SS1.p2.7.m2.1.1.cmml" xref="S2.SS1.p2.7.m2.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.7.m2.1c">S</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.7.m2.1d">italic_S</annotation></semantics></math> denotes the number of input vectors in a data sample.</p>
</div>
<div id="S2.SS1.p3" class="ltx_para">
<p id="S2.SS1.p3.10" class="ltx_p">Then we use another three quantum ansatzes, i.e., <math id="S2.SS1.p3.1.m1.1" class="ltx_Math" alttext="U_{q}" display="inline"><semantics id="S2.SS1.p3.1.m1.1a"><msub id="S2.SS1.p3.1.m1.1.1" xref="S2.SS1.p3.1.m1.1.1.cmml"><mi id="S2.SS1.p3.1.m1.1.1.2" xref="S2.SS1.p3.1.m1.1.1.2.cmml">U</mi><mi id="S2.SS1.p3.1.m1.1.1.3" xref="S2.SS1.p3.1.m1.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.1.m1.1b"><apply id="S2.SS1.p3.1.m1.1.1.cmml" xref="S2.SS1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p3.1.m1.1.1.1.cmml" xref="S2.SS1.p3.1.m1.1.1">subscript</csymbol><ci id="S2.SS1.p3.1.m1.1.1.2.cmml" xref="S2.SS1.p3.1.m1.1.1.2">𝑈</ci><ci id="S2.SS1.p3.1.m1.1.1.3.cmml" xref="S2.SS1.p3.1.m1.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.1.m1.1c">U_{q}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.1.m1.1d">italic_U start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math>, <math id="S2.SS1.p3.2.m2.1" class="ltx_Math" alttext="U_{k}" display="inline"><semantics id="S2.SS1.p3.2.m2.1a"><msub id="S2.SS1.p3.2.m2.1.1" xref="S2.SS1.p3.2.m2.1.1.cmml"><mi id="S2.SS1.p3.2.m2.1.1.2" xref="S2.SS1.p3.2.m2.1.1.2.cmml">U</mi><mi id="S2.SS1.p3.2.m2.1.1.3" xref="S2.SS1.p3.2.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.2.m2.1b"><apply id="S2.SS1.p3.2.m2.1.1.cmml" xref="S2.SS1.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS1.p3.2.m2.1.1.1.cmml" xref="S2.SS1.p3.2.m2.1.1">subscript</csymbol><ci id="S2.SS1.p3.2.m2.1.1.2.cmml" xref="S2.SS1.p3.2.m2.1.1.2">𝑈</ci><ci id="S2.SS1.p3.2.m2.1.1.3.cmml" xref="S2.SS1.p3.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.2.m2.1c">U_{k}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.2.m2.1d">italic_U start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>, <math id="S2.SS1.p3.3.m3.1" class="ltx_Math" alttext="U_{v}" display="inline"><semantics id="S2.SS1.p3.3.m3.1a"><msub id="S2.SS1.p3.3.m3.1.1" xref="S2.SS1.p3.3.m3.1.1.cmml"><mi id="S2.SS1.p3.3.m3.1.1.2" xref="S2.SS1.p3.3.m3.1.1.2.cmml">U</mi><mi id="S2.SS1.p3.3.m3.1.1.3" xref="S2.SS1.p3.3.m3.1.1.3.cmml">v</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.3.m3.1b"><apply id="S2.SS1.p3.3.m3.1.1.cmml" xref="S2.SS1.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS1.p3.3.m3.1.1.1.cmml" xref="S2.SS1.p3.3.m3.1.1">subscript</csymbol><ci id="S2.SS1.p3.3.m3.1.1.2.cmml" xref="S2.SS1.p3.3.m3.1.1.2">𝑈</ci><ci id="S2.SS1.p3.3.m3.1.1.3.cmml" xref="S2.SS1.p3.3.m3.1.1.3">𝑣</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.3.m3.1c">U_{v}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.3.m3.1d">italic_U start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT</annotation></semantics></math> with parameters <math id="S2.SS1.p3.4.m4.1" class="ltx_Math" alttext="\bm{\theta}_{q}" display="inline"><semantics id="S2.SS1.p3.4.m4.1a"><msub id="S2.SS1.p3.4.m4.1.1" xref="S2.SS1.p3.4.m4.1.1.cmml"><mi id="S2.SS1.p3.4.m4.1.1.2" xref="S2.SS1.p3.4.m4.1.1.2.cmml">𝜽</mi><mi id="S2.SS1.p3.4.m4.1.1.3" xref="S2.SS1.p3.4.m4.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.4.m4.1b"><apply id="S2.SS1.p3.4.m4.1.1.cmml" xref="S2.SS1.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS1.p3.4.m4.1.1.1.cmml" xref="S2.SS1.p3.4.m4.1.1">subscript</csymbol><ci id="S2.SS1.p3.4.m4.1.1.2.cmml" xref="S2.SS1.p3.4.m4.1.1.2">𝜽</ci><ci id="S2.SS1.p3.4.m4.1.1.3.cmml" xref="S2.SS1.p3.4.m4.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.4.m4.1c">\bm{\theta}_{q}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.4.m4.1d">bold_italic_θ start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math>, <math id="S2.SS1.p3.5.m5.1" class="ltx_Math" alttext="\bm{\theta}_{k}" display="inline"><semantics id="S2.SS1.p3.5.m5.1a"><msub id="S2.SS1.p3.5.m5.1.1" xref="S2.SS1.p3.5.m5.1.1.cmml"><mi id="S2.SS1.p3.5.m5.1.1.2" xref="S2.SS1.p3.5.m5.1.1.2.cmml">𝜽</mi><mi id="S2.SS1.p3.5.m5.1.1.3" xref="S2.SS1.p3.5.m5.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.5.m5.1b"><apply id="S2.SS1.p3.5.m5.1.1.cmml" xref="S2.SS1.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS1.p3.5.m5.1.1.1.cmml" xref="S2.SS1.p3.5.m5.1.1">subscript</csymbol><ci id="S2.SS1.p3.5.m5.1.1.2.cmml" xref="S2.SS1.p3.5.m5.1.1.2">𝜽</ci><ci id="S2.SS1.p3.5.m5.1.1.3.cmml" xref="S2.SS1.p3.5.m5.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.5.m5.1c">\bm{\theta}_{k}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.5.m5.1d">bold_italic_θ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>, <math id="S2.SS1.p3.6.m6.1" class="ltx_Math" alttext="\bm{\theta}_{v}" display="inline"><semantics id="S2.SS1.p3.6.m6.1a"><msub id="S2.SS1.p3.6.m6.1.1" xref="S2.SS1.p3.6.m6.1.1.cmml"><mi id="S2.SS1.p3.6.m6.1.1.2" xref="S2.SS1.p3.6.m6.1.1.2.cmml">𝜽</mi><mi id="S2.SS1.p3.6.m6.1.1.3" xref="S2.SS1.p3.6.m6.1.1.3.cmml">v</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.6.m6.1b"><apply id="S2.SS1.p3.6.m6.1.1.cmml" xref="S2.SS1.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S2.SS1.p3.6.m6.1.1.1.cmml" xref="S2.SS1.p3.6.m6.1.1">subscript</csymbol><ci id="S2.SS1.p3.6.m6.1.1.2.cmml" xref="S2.SS1.p3.6.m6.1.1.2">𝜽</ci><ci id="S2.SS1.p3.6.m6.1.1.3.cmml" xref="S2.SS1.p3.6.m6.1.1.3">𝑣</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.6.m6.1c">\bm{\theta}_{v}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.6.m6.1d">bold_italic_θ start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT</annotation></semantics></math>, to represent the query, key and value parts, respectively.
Concretely, for each input state <math id="S2.SS1.p3.7.m7.1" class="ltx_Math" alttext="\ket{\psi_{s}}" display="inline"><semantics id="S2.SS1.p3.7.m7.1a"><mrow id="S2.SS1.p3.7.m7.1.1" xref="S2.SS1.p3.7.m7.1.1.cmml"><merror class="ltx_ERROR undefined undefined" id="S2.SS1.p3.7.m7.1.1.2" xref="S2.SS1.p3.7.m7.1.1.2b.cmml"><mtext id="S2.SS1.p3.7.m7.1.1.2a" xref="S2.SS1.p3.7.m7.1.1.2b.cmml">\ket</mtext></merror><mo id="S2.SS1.p3.7.m7.1.1.1" xref="S2.SS1.p3.7.m7.1.1.1.cmml">⁢</mo><msub id="S2.SS1.p3.7.m7.1.1.3" xref="S2.SS1.p3.7.m7.1.1.3.cmml"><mi id="S2.SS1.p3.7.m7.1.1.3.2" xref="S2.SS1.p3.7.m7.1.1.3.2.cmml">ψ</mi><mi id="S2.SS1.p3.7.m7.1.1.3.3" xref="S2.SS1.p3.7.m7.1.1.3.3.cmml">s</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.7.m7.1b"><apply id="S2.SS1.p3.7.m7.1.1.cmml" xref="S2.SS1.p3.7.m7.1.1"><times id="S2.SS1.p3.7.m7.1.1.1.cmml" xref="S2.SS1.p3.7.m7.1.1.1"></times><ci id="S2.SS1.p3.7.m7.1.1.2b.cmml" xref="S2.SS1.p3.7.m7.1.1.2"><merror class="ltx_ERROR undefined undefined" id="S2.SS1.p3.7.m7.1.1.2.cmml" xref="S2.SS1.p3.7.m7.1.1.2"><mtext id="S2.SS1.p3.7.m7.1.1.2a.cmml" xref="S2.SS1.p3.7.m7.1.1.2">\ket</mtext></merror></ci><apply id="S2.SS1.p3.7.m7.1.1.3.cmml" xref="S2.SS1.p3.7.m7.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p3.7.m7.1.1.3.1.cmml" xref="S2.SS1.p3.7.m7.1.1.3">subscript</csymbol><ci id="S2.SS1.p3.7.m7.1.1.3.2.cmml" xref="S2.SS1.p3.7.m7.1.1.3.2">𝜓</ci><ci id="S2.SS1.p3.7.m7.1.1.3.3.cmml" xref="S2.SS1.p3.7.m7.1.1.3.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.7.m7.1c">\ket{\psi_{s}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.7.m7.1d">italic_ψ start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math>, we denote by <math id="S2.SS1.p3.8.m8.1" class="ltx_Math" alttext="\langle Z_{q}\rangle_{s}" display="inline"><semantics id="S2.SS1.p3.8.m8.1a"><msub id="S2.SS1.p3.8.m8.1.1" xref="S2.SS1.p3.8.m8.1.1.cmml"><mrow id="S2.SS1.p3.8.m8.1.1.1.1" xref="S2.SS1.p3.8.m8.1.1.1.2.cmml"><mo stretchy="false" id="S2.SS1.p3.8.m8.1.1.1.1.2" xref="S2.SS1.p3.8.m8.1.1.1.2.1.cmml">⟨</mo><msub id="S2.SS1.p3.8.m8.1.1.1.1.1" xref="S2.SS1.p3.8.m8.1.1.1.1.1.cmml"><mi id="S2.SS1.p3.8.m8.1.1.1.1.1.2" xref="S2.SS1.p3.8.m8.1.1.1.1.1.2.cmml">Z</mi><mi id="S2.SS1.p3.8.m8.1.1.1.1.1.3" xref="S2.SS1.p3.8.m8.1.1.1.1.1.3.cmml">q</mi></msub><mo stretchy="false" id="S2.SS1.p3.8.m8.1.1.1.1.3" xref="S2.SS1.p3.8.m8.1.1.1.2.1.cmml">⟩</mo></mrow><mi id="S2.SS1.p3.8.m8.1.1.3" xref="S2.SS1.p3.8.m8.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.8.m8.1b"><apply id="S2.SS1.p3.8.m8.1.1.cmml" xref="S2.SS1.p3.8.m8.1.1"><csymbol cd="ambiguous" id="S2.SS1.p3.8.m8.1.1.2.cmml" xref="S2.SS1.p3.8.m8.1.1">subscript</csymbol><apply id="S2.SS1.p3.8.m8.1.1.1.2.cmml" xref="S2.SS1.p3.8.m8.1.1.1.1"><csymbol cd="latexml" id="S2.SS1.p3.8.m8.1.1.1.2.1.cmml" xref="S2.SS1.p3.8.m8.1.1.1.1.2">delimited-⟨⟩</csymbol><apply id="S2.SS1.p3.8.m8.1.1.1.1.1.cmml" xref="S2.SS1.p3.8.m8.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p3.8.m8.1.1.1.1.1.1.cmml" xref="S2.SS1.p3.8.m8.1.1.1.1.1">subscript</csymbol><ci id="S2.SS1.p3.8.m8.1.1.1.1.1.2.cmml" xref="S2.SS1.p3.8.m8.1.1.1.1.1.2">𝑍</ci><ci id="S2.SS1.p3.8.m8.1.1.1.1.1.3.cmml" xref="S2.SS1.p3.8.m8.1.1.1.1.1.3">𝑞</ci></apply></apply><ci id="S2.SS1.p3.8.m8.1.1.3.cmml" xref="S2.SS1.p3.8.m8.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.8.m8.1c">\langle Z_{q}\rangle_{s}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.8.m8.1d">⟨ italic_Z start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT ⟩ start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> and <math id="S2.SS1.p3.9.m9.1" class="ltx_Math" alttext="\langle Z_{k}\rangle_{s}" display="inline"><semantics id="S2.SS1.p3.9.m9.1a"><msub id="S2.SS1.p3.9.m9.1.1" xref="S2.SS1.p3.9.m9.1.1.cmml"><mrow id="S2.SS1.p3.9.m9.1.1.1.1" xref="S2.SS1.p3.9.m9.1.1.1.2.cmml"><mo stretchy="false" id="S2.SS1.p3.9.m9.1.1.1.1.2" xref="S2.SS1.p3.9.m9.1.1.1.2.1.cmml">⟨</mo><msub id="S2.SS1.p3.9.m9.1.1.1.1.1" xref="S2.SS1.p3.9.m9.1.1.1.1.1.cmml"><mi id="S2.SS1.p3.9.m9.1.1.1.1.1.2" xref="S2.SS1.p3.9.m9.1.1.1.1.1.2.cmml">Z</mi><mi id="S2.SS1.p3.9.m9.1.1.1.1.1.3" xref="S2.SS1.p3.9.m9.1.1.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="S2.SS1.p3.9.m9.1.1.1.1.3" xref="S2.SS1.p3.9.m9.1.1.1.2.1.cmml">⟩</mo></mrow><mi id="S2.SS1.p3.9.m9.1.1.3" xref="S2.SS1.p3.9.m9.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.9.m9.1b"><apply id="S2.SS1.p3.9.m9.1.1.cmml" xref="S2.SS1.p3.9.m9.1.1"><csymbol cd="ambiguous" id="S2.SS1.p3.9.m9.1.1.2.cmml" xref="S2.SS1.p3.9.m9.1.1">subscript</csymbol><apply id="S2.SS1.p3.9.m9.1.1.1.2.cmml" xref="S2.SS1.p3.9.m9.1.1.1.1"><csymbol cd="latexml" id="S2.SS1.p3.9.m9.1.1.1.2.1.cmml" xref="S2.SS1.p3.9.m9.1.1.1.1.2">delimited-⟨⟩</csymbol><apply id="S2.SS1.p3.9.m9.1.1.1.1.1.cmml" xref="S2.SS1.p3.9.m9.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p3.9.m9.1.1.1.1.1.1.cmml" xref="S2.SS1.p3.9.m9.1.1.1.1.1">subscript</csymbol><ci id="S2.SS1.p3.9.m9.1.1.1.1.1.2.cmml" xref="S2.SS1.p3.9.m9.1.1.1.1.1.2">𝑍</ci><ci id="S2.SS1.p3.9.m9.1.1.1.1.1.3.cmml" xref="S2.SS1.p3.9.m9.1.1.1.1.1.3">𝑘</ci></apply></apply><ci id="S2.SS1.p3.9.m9.1.1.3.cmml" xref="S2.SS1.p3.9.m9.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.9.m9.1c">\langle Z_{k}\rangle_{s}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.9.m9.1d">⟨ italic_Z start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ⟩ start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> the Pauli-<math id="S2.SS1.p3.10.m10.1" class="ltx_Math" alttext="Z_{1}" display="inline"><semantics id="S2.SS1.p3.10.m10.1a"><msub id="S2.SS1.p3.10.m10.1.1" xref="S2.SS1.p3.10.m10.1.1.cmml"><mi id="S2.SS1.p3.10.m10.1.1.2" xref="S2.SS1.p3.10.m10.1.1.2.cmml">Z</mi><mn id="S2.SS1.p3.10.m10.1.1.3" xref="S2.SS1.p3.10.m10.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.10.m10.1b"><apply id="S2.SS1.p3.10.m10.1.1.cmml" xref="S2.SS1.p3.10.m10.1.1"><csymbol cd="ambiguous" id="S2.SS1.p3.10.m10.1.1.1.cmml" xref="S2.SS1.p3.10.m10.1.1">subscript</csymbol><ci id="S2.SS1.p3.10.m10.1.1.2.cmml" xref="S2.SS1.p3.10.m10.1.1.2">𝑍</ci><cn type="integer" id="S2.SS1.p3.10.m10.1.1.3.cmml" xref="S2.SS1.p3.10.m10.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.10.m10.1c">Z_{1}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.10.m10.1d">italic_Z start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> measurement outputs of the query and key parts, respectively, where
</p>
<table id="S1.EGx4" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S2.Ex1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.Ex1.m1.1" class="ltx_Math" alttext="\displaystyle\langle Z_{q}\rangle_{s}" display="inline"><semantics id="S2.Ex1.m1.1a"><msub id="S2.Ex1.m1.1.1" xref="S2.Ex1.m1.1.1.cmml"><mrow id="S2.Ex1.m1.1.1.1.1" xref="S2.Ex1.m1.1.1.1.2.cmml"><mo stretchy="false" id="S2.Ex1.m1.1.1.1.1.2" xref="S2.Ex1.m1.1.1.1.2.1.cmml">⟨</mo><msub id="S2.Ex1.m1.1.1.1.1.1" xref="S2.Ex1.m1.1.1.1.1.1.cmml"><mi id="S2.Ex1.m1.1.1.1.1.1.2" xref="S2.Ex1.m1.1.1.1.1.1.2.cmml">Z</mi><mi id="S2.Ex1.m1.1.1.1.1.1.3" xref="S2.Ex1.m1.1.1.1.1.1.3.cmml">q</mi></msub><mo stretchy="false" id="S2.Ex1.m1.1.1.1.1.3" xref="S2.Ex1.m1.1.1.1.2.1.cmml">⟩</mo></mrow><mi id="S2.Ex1.m1.1.1.3" xref="S2.Ex1.m1.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S2.Ex1.m1.1b"><apply id="S2.Ex1.m1.1.1.cmml" xref="S2.Ex1.m1.1.1"><csymbol cd="ambiguous" id="S2.Ex1.m1.1.1.2.cmml" xref="S2.Ex1.m1.1.1">subscript</csymbol><apply id="S2.Ex1.m1.1.1.1.2.cmml" xref="S2.Ex1.m1.1.1.1.1"><csymbol cd="latexml" id="S2.Ex1.m1.1.1.1.2.1.cmml" xref="S2.Ex1.m1.1.1.1.1.2">delimited-⟨⟩</csymbol><apply id="S2.Ex1.m1.1.1.1.1.1.cmml" xref="S2.Ex1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.Ex1.m1.1.1.1.1.1.1.cmml" xref="S2.Ex1.m1.1.1.1.1.1">subscript</csymbol><ci id="S2.Ex1.m1.1.1.1.1.1.2.cmml" xref="S2.Ex1.m1.1.1.1.1.1.2">𝑍</ci><ci id="S2.Ex1.m1.1.1.1.1.1.3.cmml" xref="S2.Ex1.m1.1.1.1.1.1.3">𝑞</ci></apply></apply><ci id="S2.Ex1.m1.1.1.3.cmml" xref="S2.Ex1.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex1.m1.1c">\displaystyle\langle Z_{q}\rangle_{s}</annotation><annotation encoding="application/x-llamapun" id="S2.Ex1.m1.1d">⟨ italic_Z start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT ⟩ start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.Ex1.m2.1" class="ltx_Math" alttext="\displaystyle:=\bra{\psi_{s}}U_{q}^{\dagger}(\bm{\theta}_{q})Z_{1}U_{q}(\bm{%
\theta}_{q})\ket{\psi_{s}}," display="inline"><semantics id="S2.Ex1.m2.1a"><mrow id="S2.Ex1.m2.1.1.1" xref="S2.Ex1.m2.1.1.1.1.cmml"><mrow id="S2.Ex1.m2.1.1.1.1" xref="S2.Ex1.m2.1.1.1.1.cmml"><mi id="S2.Ex1.m2.1.1.1.1.4" xref="S2.Ex1.m2.1.1.1.1.4.cmml"></mi><mo id="S2.Ex1.m2.1.1.1.1.3" xref="S2.Ex1.m2.1.1.1.1.3.cmml">:=</mo><mrow id="S2.Ex1.m2.1.1.1.1.2" xref="S2.Ex1.m2.1.1.1.1.2.cmml"><merror class="ltx_ERROR undefined undefined" id="S2.Ex1.m2.1.1.1.1.2.4" xref="S2.Ex1.m2.1.1.1.1.2.4b.cmml"><mtext id="S2.Ex1.m2.1.1.1.1.2.4a" xref="S2.Ex1.m2.1.1.1.1.2.4b.cmml">\bra</mtext></merror><mo id="S2.Ex1.m2.1.1.1.1.2.3" xref="S2.Ex1.m2.1.1.1.1.2.3.cmml">⁢</mo><msub id="S2.Ex1.m2.1.1.1.1.2.5" xref="S2.Ex1.m2.1.1.1.1.2.5.cmml"><mi id="S2.Ex1.m2.1.1.1.1.2.5.2" xref="S2.Ex1.m2.1.1.1.1.2.5.2.cmml">ψ</mi><mi id="S2.Ex1.m2.1.1.1.1.2.5.3" xref="S2.Ex1.m2.1.1.1.1.2.5.3.cmml">s</mi></msub><mo id="S2.Ex1.m2.1.1.1.1.2.3a" xref="S2.Ex1.m2.1.1.1.1.2.3.cmml">⁢</mo><msubsup id="S2.Ex1.m2.1.1.1.1.2.6" xref="S2.Ex1.m2.1.1.1.1.2.6.cmml"><mi id="S2.Ex1.m2.1.1.1.1.2.6.2.2" xref="S2.Ex1.m2.1.1.1.1.2.6.2.2.cmml">U</mi><mi id="S2.Ex1.m2.1.1.1.1.2.6.2.3" xref="S2.Ex1.m2.1.1.1.1.2.6.2.3.cmml">q</mi><mo id="S2.Ex1.m2.1.1.1.1.2.6.3" xref="S2.Ex1.m2.1.1.1.1.2.6.3.cmml">†</mo></msubsup><mo id="S2.Ex1.m2.1.1.1.1.2.3b" xref="S2.Ex1.m2.1.1.1.1.2.3.cmml">⁢</mo><mrow id="S2.Ex1.m2.1.1.1.1.1.1.1" xref="S2.Ex1.m2.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.Ex1.m2.1.1.1.1.1.1.1.2" xref="S2.Ex1.m2.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S2.Ex1.m2.1.1.1.1.1.1.1.1" xref="S2.Ex1.m2.1.1.1.1.1.1.1.1.cmml"><mi id="S2.Ex1.m2.1.1.1.1.1.1.1.1.2" xref="S2.Ex1.m2.1.1.1.1.1.1.1.1.2.cmml">𝜽</mi><mi id="S2.Ex1.m2.1.1.1.1.1.1.1.1.3" xref="S2.Ex1.m2.1.1.1.1.1.1.1.1.3.cmml">q</mi></msub><mo stretchy="false" id="S2.Ex1.m2.1.1.1.1.1.1.1.3" xref="S2.Ex1.m2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.Ex1.m2.1.1.1.1.2.3c" xref="S2.Ex1.m2.1.1.1.1.2.3.cmml">⁢</mo><msub id="S2.Ex1.m2.1.1.1.1.2.7" xref="S2.Ex1.m2.1.1.1.1.2.7.cmml"><mi id="S2.Ex1.m2.1.1.1.1.2.7.2" xref="S2.Ex1.m2.1.1.1.1.2.7.2.cmml">Z</mi><mn id="S2.Ex1.m2.1.1.1.1.2.7.3" xref="S2.Ex1.m2.1.1.1.1.2.7.3.cmml">1</mn></msub><mo id="S2.Ex1.m2.1.1.1.1.2.3d" xref="S2.Ex1.m2.1.1.1.1.2.3.cmml">⁢</mo><msub id="S2.Ex1.m2.1.1.1.1.2.8" xref="S2.Ex1.m2.1.1.1.1.2.8.cmml"><mi id="S2.Ex1.m2.1.1.1.1.2.8.2" xref="S2.Ex1.m2.1.1.1.1.2.8.2.cmml">U</mi><mi id="S2.Ex1.m2.1.1.1.1.2.8.3" xref="S2.Ex1.m2.1.1.1.1.2.8.3.cmml">q</mi></msub><mo id="S2.Ex1.m2.1.1.1.1.2.3e" xref="S2.Ex1.m2.1.1.1.1.2.3.cmml">⁢</mo><mrow id="S2.Ex1.m2.1.1.1.1.2.2.1" xref="S2.Ex1.m2.1.1.1.1.2.2.1.1.cmml"><mo stretchy="false" id="S2.Ex1.m2.1.1.1.1.2.2.1.2" xref="S2.Ex1.m2.1.1.1.1.2.2.1.1.cmml">(</mo><msub id="S2.Ex1.m2.1.1.1.1.2.2.1.1" xref="S2.Ex1.m2.1.1.1.1.2.2.1.1.cmml"><mi id="S2.Ex1.m2.1.1.1.1.2.2.1.1.2" xref="S2.Ex1.m2.1.1.1.1.2.2.1.1.2.cmml">𝜽</mi><mi id="S2.Ex1.m2.1.1.1.1.2.2.1.1.3" xref="S2.Ex1.m2.1.1.1.1.2.2.1.1.3.cmml">q</mi></msub><mo stretchy="false" id="S2.Ex1.m2.1.1.1.1.2.2.1.3" xref="S2.Ex1.m2.1.1.1.1.2.2.1.1.cmml">)</mo></mrow><mo id="S2.Ex1.m2.1.1.1.1.2.3f" xref="S2.Ex1.m2.1.1.1.1.2.3.cmml">⁢</mo><merror class="ltx_ERROR undefined undefined" id="S2.Ex1.m2.1.1.1.1.2.9" xref="S2.Ex1.m2.1.1.1.1.2.9b.cmml"><mtext id="S2.Ex1.m2.1.1.1.1.2.9a" xref="S2.Ex1.m2.1.1.1.1.2.9b.cmml">\ket</mtext></merror><mo id="S2.Ex1.m2.1.1.1.1.2.3g" xref="S2.Ex1.m2.1.1.1.1.2.3.cmml">⁢</mo><msub id="S2.Ex1.m2.1.1.1.1.2.10" xref="S2.Ex1.m2.1.1.1.1.2.10.cmml"><mi id="S2.Ex1.m2.1.1.1.1.2.10.2" xref="S2.Ex1.m2.1.1.1.1.2.10.2.cmml">ψ</mi><mi id="S2.Ex1.m2.1.1.1.1.2.10.3" xref="S2.Ex1.m2.1.1.1.1.2.10.3.cmml">s</mi></msub></mrow></mrow><mo id="S2.Ex1.m2.1.1.1.2" xref="S2.Ex1.m2.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex1.m2.1b"><apply id="S2.Ex1.m2.1.1.1.1.cmml" xref="S2.Ex1.m2.1.1.1"><csymbol cd="latexml" id="S2.Ex1.m2.1.1.1.1.3.cmml" xref="S2.Ex1.m2.1.1.1.1.3">assign</csymbol><csymbol cd="latexml" id="S2.Ex1.m2.1.1.1.1.4.cmml" xref="S2.Ex1.m2.1.1.1.1.4">absent</csymbol><apply id="S2.Ex1.m2.1.1.1.1.2.cmml" xref="S2.Ex1.m2.1.1.1.1.2"><times id="S2.Ex1.m2.1.1.1.1.2.3.cmml" xref="S2.Ex1.m2.1.1.1.1.2.3"></times><ci id="S2.Ex1.m2.1.1.1.1.2.4b.cmml" xref="S2.Ex1.m2.1.1.1.1.2.4"><merror class="ltx_ERROR undefined undefined" id="S2.Ex1.m2.1.1.1.1.2.4.cmml" xref="S2.Ex1.m2.1.1.1.1.2.4"><mtext id="S2.Ex1.m2.1.1.1.1.2.4a.cmml" xref="S2.Ex1.m2.1.1.1.1.2.4">\bra</mtext></merror></ci><apply id="S2.Ex1.m2.1.1.1.1.2.5.cmml" xref="S2.Ex1.m2.1.1.1.1.2.5"><csymbol cd="ambiguous" id="S2.Ex1.m2.1.1.1.1.2.5.1.cmml" xref="S2.Ex1.m2.1.1.1.1.2.5">subscript</csymbol><ci id="S2.Ex1.m2.1.1.1.1.2.5.2.cmml" xref="S2.Ex1.m2.1.1.1.1.2.5.2">𝜓</ci><ci id="S2.Ex1.m2.1.1.1.1.2.5.3.cmml" xref="S2.Ex1.m2.1.1.1.1.2.5.3">𝑠</ci></apply><apply id="S2.Ex1.m2.1.1.1.1.2.6.cmml" xref="S2.Ex1.m2.1.1.1.1.2.6"><csymbol cd="ambiguous" id="S2.Ex1.m2.1.1.1.1.2.6.1.cmml" xref="S2.Ex1.m2.1.1.1.1.2.6">superscript</csymbol><apply id="S2.Ex1.m2.1.1.1.1.2.6.2.cmml" xref="S2.Ex1.m2.1.1.1.1.2.6"><csymbol cd="ambiguous" id="S2.Ex1.m2.1.1.1.1.2.6.2.1.cmml" xref="S2.Ex1.m2.1.1.1.1.2.6">subscript</csymbol><ci id="S2.Ex1.m2.1.1.1.1.2.6.2.2.cmml" xref="S2.Ex1.m2.1.1.1.1.2.6.2.2">𝑈</ci><ci id="S2.Ex1.m2.1.1.1.1.2.6.2.3.cmml" xref="S2.Ex1.m2.1.1.1.1.2.6.2.3">𝑞</ci></apply><ci id="S2.Ex1.m2.1.1.1.1.2.6.3.cmml" xref="S2.Ex1.m2.1.1.1.1.2.6.3">†</ci></apply><apply id="S2.Ex1.m2.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex1.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.Ex1.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex1.m2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.Ex1.m2.1.1.1.1.1.1.1.1.2.cmml" xref="S2.Ex1.m2.1.1.1.1.1.1.1.1.2">𝜽</ci><ci id="S2.Ex1.m2.1.1.1.1.1.1.1.1.3.cmml" xref="S2.Ex1.m2.1.1.1.1.1.1.1.1.3">𝑞</ci></apply><apply id="S2.Ex1.m2.1.1.1.1.2.7.cmml" xref="S2.Ex1.m2.1.1.1.1.2.7"><csymbol cd="ambiguous" id="S2.Ex1.m2.1.1.1.1.2.7.1.cmml" xref="S2.Ex1.m2.1.1.1.1.2.7">subscript</csymbol><ci id="S2.Ex1.m2.1.1.1.1.2.7.2.cmml" xref="S2.Ex1.m2.1.1.1.1.2.7.2">𝑍</ci><cn type="integer" id="S2.Ex1.m2.1.1.1.1.2.7.3.cmml" xref="S2.Ex1.m2.1.1.1.1.2.7.3">1</cn></apply><apply id="S2.Ex1.m2.1.1.1.1.2.8.cmml" xref="S2.Ex1.m2.1.1.1.1.2.8"><csymbol cd="ambiguous" id="S2.Ex1.m2.1.1.1.1.2.8.1.cmml" xref="S2.Ex1.m2.1.1.1.1.2.8">subscript</csymbol><ci id="S2.Ex1.m2.1.1.1.1.2.8.2.cmml" xref="S2.Ex1.m2.1.1.1.1.2.8.2">𝑈</ci><ci id="S2.Ex1.m2.1.1.1.1.2.8.3.cmml" xref="S2.Ex1.m2.1.1.1.1.2.8.3">𝑞</ci></apply><apply id="S2.Ex1.m2.1.1.1.1.2.2.1.1.cmml" xref="S2.Ex1.m2.1.1.1.1.2.2.1"><csymbol cd="ambiguous" id="S2.Ex1.m2.1.1.1.1.2.2.1.1.1.cmml" xref="S2.Ex1.m2.1.1.1.1.2.2.1">subscript</csymbol><ci id="S2.Ex1.m2.1.1.1.1.2.2.1.1.2.cmml" xref="S2.Ex1.m2.1.1.1.1.2.2.1.1.2">𝜽</ci><ci id="S2.Ex1.m2.1.1.1.1.2.2.1.1.3.cmml" xref="S2.Ex1.m2.1.1.1.1.2.2.1.1.3">𝑞</ci></apply><ci id="S2.Ex1.m2.1.1.1.1.2.9b.cmml" xref="S2.Ex1.m2.1.1.1.1.2.9"><merror class="ltx_ERROR undefined undefined" id="S2.Ex1.m2.1.1.1.1.2.9.cmml" xref="S2.Ex1.m2.1.1.1.1.2.9"><mtext id="S2.Ex1.m2.1.1.1.1.2.9a.cmml" xref="S2.Ex1.m2.1.1.1.1.2.9">\ket</mtext></merror></ci><apply id="S2.Ex1.m2.1.1.1.1.2.10.cmml" xref="S2.Ex1.m2.1.1.1.1.2.10"><csymbol cd="ambiguous" id="S2.Ex1.m2.1.1.1.1.2.10.1.cmml" xref="S2.Ex1.m2.1.1.1.1.2.10">subscript</csymbol><ci id="S2.Ex1.m2.1.1.1.1.2.10.2.cmml" xref="S2.Ex1.m2.1.1.1.1.2.10.2">𝜓</ci><ci id="S2.Ex1.m2.1.1.1.1.2.10.3.cmml" xref="S2.Ex1.m2.1.1.1.1.2.10.3">𝑠</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex1.m2.1c">\displaystyle:=\bra{\psi_{s}}U_{q}^{\dagger}(\bm{\theta}_{q})Z_{1}U_{q}(\bm{%
\theta}_{q})\ket{\psi_{s}},</annotation><annotation encoding="application/x-llamapun" id="S2.Ex1.m2.1d">:= italic_ψ start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT italic_U start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT start_POSTSUPERSCRIPT † end_POSTSUPERSCRIPT ( bold_italic_θ start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT ) italic_Z start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT italic_U start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT ( bold_italic_θ start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT ) italic_ψ start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S2.E12"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E12.m1.1" class="ltx_Math" alttext="\displaystyle\langle Z_{k}\rangle_{s}" display="inline"><semantics id="S2.E12.m1.1a"><msub id="S2.E12.m1.1.1" xref="S2.E12.m1.1.1.cmml"><mrow id="S2.E12.m1.1.1.1.1" xref="S2.E12.m1.1.1.1.2.cmml"><mo stretchy="false" id="S2.E12.m1.1.1.1.1.2" xref="S2.E12.m1.1.1.1.2.1.cmml">⟨</mo><msub id="S2.E12.m1.1.1.1.1.1" xref="S2.E12.m1.1.1.1.1.1.cmml"><mi id="S2.E12.m1.1.1.1.1.1.2" xref="S2.E12.m1.1.1.1.1.1.2.cmml">Z</mi><mi id="S2.E12.m1.1.1.1.1.1.3" xref="S2.E12.m1.1.1.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="S2.E12.m1.1.1.1.1.3" xref="S2.E12.m1.1.1.1.2.1.cmml">⟩</mo></mrow><mi id="S2.E12.m1.1.1.3" xref="S2.E12.m1.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S2.E12.m1.1b"><apply id="S2.E12.m1.1.1.cmml" xref="S2.E12.m1.1.1"><csymbol cd="ambiguous" id="S2.E12.m1.1.1.2.cmml" xref="S2.E12.m1.1.1">subscript</csymbol><apply id="S2.E12.m1.1.1.1.2.cmml" xref="S2.E12.m1.1.1.1.1"><csymbol cd="latexml" id="S2.E12.m1.1.1.1.2.1.cmml" xref="S2.E12.m1.1.1.1.1.2">delimited-⟨⟩</csymbol><apply id="S2.E12.m1.1.1.1.1.1.cmml" xref="S2.E12.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E12.m1.1.1.1.1.1.1.cmml" xref="S2.E12.m1.1.1.1.1.1">subscript</csymbol><ci id="S2.E12.m1.1.1.1.1.1.2.cmml" xref="S2.E12.m1.1.1.1.1.1.2">𝑍</ci><ci id="S2.E12.m1.1.1.1.1.1.3.cmml" xref="S2.E12.m1.1.1.1.1.1.3">𝑘</ci></apply></apply><ci id="S2.E12.m1.1.1.3.cmml" xref="S2.E12.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E12.m1.1c">\displaystyle\langle Z_{k}\rangle_{s}</annotation><annotation encoding="application/x-llamapun" id="S2.E12.m1.1d">⟨ italic_Z start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ⟩ start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E12.m2.1" class="ltx_Math" alttext="\displaystyle:=\bra{\psi_{s}}U_{k}^{\dagger}(\bm{\theta}_{k})Z_{1}U_{k}(\bm{%
\theta}_{k})\ket{\psi_{s}}." display="inline"><semantics id="S2.E12.m2.1a"><mrow id="S2.E12.m2.1.1.1" xref="S2.E12.m2.1.1.1.1.cmml"><mrow id="S2.E12.m2.1.1.1.1" xref="S2.E12.m2.1.1.1.1.cmml"><mi id="S2.E12.m2.1.1.1.1.4" xref="S2.E12.m2.1.1.1.1.4.cmml"></mi><mo id="S2.E12.m2.1.1.1.1.3" xref="S2.E12.m2.1.1.1.1.3.cmml">:=</mo><mrow id="S2.E12.m2.1.1.1.1.2" xref="S2.E12.m2.1.1.1.1.2.cmml"><merror class="ltx_ERROR undefined undefined" id="S2.E12.m2.1.1.1.1.2.4" xref="S2.E12.m2.1.1.1.1.2.4b.cmml"><mtext id="S2.E12.m2.1.1.1.1.2.4a" xref="S2.E12.m2.1.1.1.1.2.4b.cmml">\bra</mtext></merror><mo id="S2.E12.m2.1.1.1.1.2.3" xref="S2.E12.m2.1.1.1.1.2.3.cmml">⁢</mo><msub id="S2.E12.m2.1.1.1.1.2.5" xref="S2.E12.m2.1.1.1.1.2.5.cmml"><mi id="S2.E12.m2.1.1.1.1.2.5.2" xref="S2.E12.m2.1.1.1.1.2.5.2.cmml">ψ</mi><mi id="S2.E12.m2.1.1.1.1.2.5.3" xref="S2.E12.m2.1.1.1.1.2.5.3.cmml">s</mi></msub><mo id="S2.E12.m2.1.1.1.1.2.3a" xref="S2.E12.m2.1.1.1.1.2.3.cmml">⁢</mo><msubsup id="S2.E12.m2.1.1.1.1.2.6" xref="S2.E12.m2.1.1.1.1.2.6.cmml"><mi id="S2.E12.m2.1.1.1.1.2.6.2.2" xref="S2.E12.m2.1.1.1.1.2.6.2.2.cmml">U</mi><mi id="S2.E12.m2.1.1.1.1.2.6.2.3" xref="S2.E12.m2.1.1.1.1.2.6.2.3.cmml">k</mi><mo id="S2.E12.m2.1.1.1.1.2.6.3" xref="S2.E12.m2.1.1.1.1.2.6.3.cmml">†</mo></msubsup><mo id="S2.E12.m2.1.1.1.1.2.3b" xref="S2.E12.m2.1.1.1.1.2.3.cmml">⁢</mo><mrow id="S2.E12.m2.1.1.1.1.1.1.1" xref="S2.E12.m2.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E12.m2.1.1.1.1.1.1.1.2" xref="S2.E12.m2.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S2.E12.m2.1.1.1.1.1.1.1.1" xref="S2.E12.m2.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E12.m2.1.1.1.1.1.1.1.1.2" xref="S2.E12.m2.1.1.1.1.1.1.1.1.2.cmml">𝜽</mi><mi id="S2.E12.m2.1.1.1.1.1.1.1.1.3" xref="S2.E12.m2.1.1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="S2.E12.m2.1.1.1.1.1.1.1.3" xref="S2.E12.m2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.E12.m2.1.1.1.1.2.3c" xref="S2.E12.m2.1.1.1.1.2.3.cmml">⁢</mo><msub id="S2.E12.m2.1.1.1.1.2.7" xref="S2.E12.m2.1.1.1.1.2.7.cmml"><mi id="S2.E12.m2.1.1.1.1.2.7.2" xref="S2.E12.m2.1.1.1.1.2.7.2.cmml">Z</mi><mn id="S2.E12.m2.1.1.1.1.2.7.3" xref="S2.E12.m2.1.1.1.1.2.7.3.cmml">1</mn></msub><mo id="S2.E12.m2.1.1.1.1.2.3d" xref="S2.E12.m2.1.1.1.1.2.3.cmml">⁢</mo><msub id="S2.E12.m2.1.1.1.1.2.8" xref="S2.E12.m2.1.1.1.1.2.8.cmml"><mi id="S2.E12.m2.1.1.1.1.2.8.2" xref="S2.E12.m2.1.1.1.1.2.8.2.cmml">U</mi><mi id="S2.E12.m2.1.1.1.1.2.8.3" xref="S2.E12.m2.1.1.1.1.2.8.3.cmml">k</mi></msub><mo id="S2.E12.m2.1.1.1.1.2.3e" xref="S2.E12.m2.1.1.1.1.2.3.cmml">⁢</mo><mrow id="S2.E12.m2.1.1.1.1.2.2.1" xref="S2.E12.m2.1.1.1.1.2.2.1.1.cmml"><mo stretchy="false" id="S2.E12.m2.1.1.1.1.2.2.1.2" xref="S2.E12.m2.1.1.1.1.2.2.1.1.cmml">(</mo><msub id="S2.E12.m2.1.1.1.1.2.2.1.1" xref="S2.E12.m2.1.1.1.1.2.2.1.1.cmml"><mi id="S2.E12.m2.1.1.1.1.2.2.1.1.2" xref="S2.E12.m2.1.1.1.1.2.2.1.1.2.cmml">𝜽</mi><mi id="S2.E12.m2.1.1.1.1.2.2.1.1.3" xref="S2.E12.m2.1.1.1.1.2.2.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="S2.E12.m2.1.1.1.1.2.2.1.3" xref="S2.E12.m2.1.1.1.1.2.2.1.1.cmml">)</mo></mrow><mo id="S2.E12.m2.1.1.1.1.2.3f" xref="S2.E12.m2.1.1.1.1.2.3.cmml">⁢</mo><merror class="ltx_ERROR undefined undefined" id="S2.E12.m2.1.1.1.1.2.9" xref="S2.E12.m2.1.1.1.1.2.9b.cmml"><mtext id="S2.E12.m2.1.1.1.1.2.9a" xref="S2.E12.m2.1.1.1.1.2.9b.cmml">\ket</mtext></merror><mo id="S2.E12.m2.1.1.1.1.2.3g" xref="S2.E12.m2.1.1.1.1.2.3.cmml">⁢</mo><msub id="S2.E12.m2.1.1.1.1.2.10" xref="S2.E12.m2.1.1.1.1.2.10.cmml"><mi id="S2.E12.m2.1.1.1.1.2.10.2" xref="S2.E12.m2.1.1.1.1.2.10.2.cmml">ψ</mi><mi id="S2.E12.m2.1.1.1.1.2.10.3" xref="S2.E12.m2.1.1.1.1.2.10.3.cmml">s</mi></msub></mrow></mrow><mo id="S2.E12.m2.1.1.1.2" xref="S2.E12.m2.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E12.m2.1b"><apply id="S2.E12.m2.1.1.1.1.cmml" xref="S2.E12.m2.1.1.1"><csymbol cd="latexml" id="S2.E12.m2.1.1.1.1.3.cmml" xref="S2.E12.m2.1.1.1.1.3">assign</csymbol><csymbol cd="latexml" id="S2.E12.m2.1.1.1.1.4.cmml" xref="S2.E12.m2.1.1.1.1.4">absent</csymbol><apply id="S2.E12.m2.1.1.1.1.2.cmml" xref="S2.E12.m2.1.1.1.1.2"><times id="S2.E12.m2.1.1.1.1.2.3.cmml" xref="S2.E12.m2.1.1.1.1.2.3"></times><ci id="S2.E12.m2.1.1.1.1.2.4b.cmml" xref="S2.E12.m2.1.1.1.1.2.4"><merror class="ltx_ERROR undefined undefined" id="S2.E12.m2.1.1.1.1.2.4.cmml" xref="S2.E12.m2.1.1.1.1.2.4"><mtext id="S2.E12.m2.1.1.1.1.2.4a.cmml" xref="S2.E12.m2.1.1.1.1.2.4">\bra</mtext></merror></ci><apply id="S2.E12.m2.1.1.1.1.2.5.cmml" xref="S2.E12.m2.1.1.1.1.2.5"><csymbol cd="ambiguous" id="S2.E12.m2.1.1.1.1.2.5.1.cmml" xref="S2.E12.m2.1.1.1.1.2.5">subscript</csymbol><ci id="S2.E12.m2.1.1.1.1.2.5.2.cmml" xref="S2.E12.m2.1.1.1.1.2.5.2">𝜓</ci><ci id="S2.E12.m2.1.1.1.1.2.5.3.cmml" xref="S2.E12.m2.1.1.1.1.2.5.3">𝑠</ci></apply><apply id="S2.E12.m2.1.1.1.1.2.6.cmml" xref="S2.E12.m2.1.1.1.1.2.6"><csymbol cd="ambiguous" id="S2.E12.m2.1.1.1.1.2.6.1.cmml" xref="S2.E12.m2.1.1.1.1.2.6">superscript</csymbol><apply id="S2.E12.m2.1.1.1.1.2.6.2.cmml" xref="S2.E12.m2.1.1.1.1.2.6"><csymbol cd="ambiguous" id="S2.E12.m2.1.1.1.1.2.6.2.1.cmml" xref="S2.E12.m2.1.1.1.1.2.6">subscript</csymbol><ci id="S2.E12.m2.1.1.1.1.2.6.2.2.cmml" xref="S2.E12.m2.1.1.1.1.2.6.2.2">𝑈</ci><ci id="S2.E12.m2.1.1.1.1.2.6.2.3.cmml" xref="S2.E12.m2.1.1.1.1.2.6.2.3">𝑘</ci></apply><ci id="S2.E12.m2.1.1.1.1.2.6.3.cmml" xref="S2.E12.m2.1.1.1.1.2.6.3">†</ci></apply><apply id="S2.E12.m2.1.1.1.1.1.1.1.1.cmml" xref="S2.E12.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E12.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E12.m2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E12.m2.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E12.m2.1.1.1.1.1.1.1.1.2">𝜽</ci><ci id="S2.E12.m2.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E12.m2.1.1.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="S2.E12.m2.1.1.1.1.2.7.cmml" xref="S2.E12.m2.1.1.1.1.2.7"><csymbol cd="ambiguous" id="S2.E12.m2.1.1.1.1.2.7.1.cmml" xref="S2.E12.m2.1.1.1.1.2.7">subscript</csymbol><ci id="S2.E12.m2.1.1.1.1.2.7.2.cmml" xref="S2.E12.m2.1.1.1.1.2.7.2">𝑍</ci><cn type="integer" id="S2.E12.m2.1.1.1.1.2.7.3.cmml" xref="S2.E12.m2.1.1.1.1.2.7.3">1</cn></apply><apply id="S2.E12.m2.1.1.1.1.2.8.cmml" xref="S2.E12.m2.1.1.1.1.2.8"><csymbol cd="ambiguous" id="S2.E12.m2.1.1.1.1.2.8.1.cmml" xref="S2.E12.m2.1.1.1.1.2.8">subscript</csymbol><ci id="S2.E12.m2.1.1.1.1.2.8.2.cmml" xref="S2.E12.m2.1.1.1.1.2.8.2">𝑈</ci><ci id="S2.E12.m2.1.1.1.1.2.8.3.cmml" xref="S2.E12.m2.1.1.1.1.2.8.3">𝑘</ci></apply><apply id="S2.E12.m2.1.1.1.1.2.2.1.1.cmml" xref="S2.E12.m2.1.1.1.1.2.2.1"><csymbol cd="ambiguous" id="S2.E12.m2.1.1.1.1.2.2.1.1.1.cmml" xref="S2.E12.m2.1.1.1.1.2.2.1">subscript</csymbol><ci id="S2.E12.m2.1.1.1.1.2.2.1.1.2.cmml" xref="S2.E12.m2.1.1.1.1.2.2.1.1.2">𝜽</ci><ci id="S2.E12.m2.1.1.1.1.2.2.1.1.3.cmml" xref="S2.E12.m2.1.1.1.1.2.2.1.1.3">𝑘</ci></apply><ci id="S2.E12.m2.1.1.1.1.2.9b.cmml" xref="S2.E12.m2.1.1.1.1.2.9"><merror class="ltx_ERROR undefined undefined" id="S2.E12.m2.1.1.1.1.2.9.cmml" xref="S2.E12.m2.1.1.1.1.2.9"><mtext id="S2.E12.m2.1.1.1.1.2.9a.cmml" xref="S2.E12.m2.1.1.1.1.2.9">\ket</mtext></merror></ci><apply id="S2.E12.m2.1.1.1.1.2.10.cmml" xref="S2.E12.m2.1.1.1.1.2.10"><csymbol cd="ambiguous" id="S2.E12.m2.1.1.1.1.2.10.1.cmml" xref="S2.E12.m2.1.1.1.1.2.10">subscript</csymbol><ci id="S2.E12.m2.1.1.1.1.2.10.2.cmml" xref="S2.E12.m2.1.1.1.1.2.10.2">𝜓</ci><ci id="S2.E12.m2.1.1.1.1.2.10.3.cmml" xref="S2.E12.m2.1.1.1.1.2.10.3">𝑠</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E12.m2.1c">\displaystyle:=\bra{\psi_{s}}U_{k}^{\dagger}(\bm{\theta}_{k})Z_{1}U_{k}(\bm{%
\theta}_{k})\ket{\psi_{s}}.</annotation><annotation encoding="application/x-llamapun" id="S2.E12.m2.1d">:= italic_ψ start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT italic_U start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT † end_POSTSUPERSCRIPT ( bold_italic_θ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) italic_Z start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT italic_U start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ( bold_italic_θ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) italic_ψ start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
<p id="S2.SS1.p3.11" class="ltx_p">The measurement outputs of the value part are represented by a <math id="S2.SS1.p3.11.m1.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S2.SS1.p3.11.m1.1a"><mi id="S2.SS1.p3.11.m1.1.1" xref="S2.SS1.p3.11.m1.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.11.m1.1b"><ci id="S2.SS1.p3.11.m1.1.1.cmml" xref="S2.SS1.p3.11.m1.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.11.m1.1c">d</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.11.m1.1d">italic_d</annotation></semantics></math>-dimensional vector</p>
<table id="S1.EGx5" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S2.E14"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E14.m1.2" class="ltx_Math" alttext="\displaystyle\bm{o}_{s}:=\begin{bmatrix}\langle P_{1}\rangle_{s}&amp;\langle P_{2}%
\rangle_{s}&amp;\cdots&amp;\langle P_{d}\rangle_{s}\end{bmatrix}^{\top}," display="inline"><semantics id="S2.E14.m1.2a"><mrow id="S2.E14.m1.2.2.1" xref="S2.E14.m1.2.2.1.1.cmml"><mrow id="S2.E14.m1.2.2.1.1" xref="S2.E14.m1.2.2.1.1.cmml"><msub id="S2.E14.m1.2.2.1.1.2" xref="S2.E14.m1.2.2.1.1.2.cmml"><mi id="S2.E14.m1.2.2.1.1.2.2" xref="S2.E14.m1.2.2.1.1.2.2.cmml">𝒐</mi><mi id="S2.E14.m1.2.2.1.1.2.3" xref="S2.E14.m1.2.2.1.1.2.3.cmml">s</mi></msub><mo id="S2.E14.m1.2.2.1.1.1" xref="S2.E14.m1.2.2.1.1.1.cmml">:=</mo><msup id="S2.E14.m1.2.2.1.1.3" xref="S2.E14.m1.2.2.1.1.3.cmml"><mrow id="S2.E14.m1.1.1a.3" xref="S2.E14.m1.1.1a.2.cmml"><mo id="S2.E14.m1.1.1a.3.1" xref="S2.E14.m1.1.1a.2.1.cmml">[</mo><mtable columnspacing="5pt" id="S2.E14.m1.1.1.1.1" xref="S2.E14.m1.1.1.1.1.cmml"><mtr id="S2.E14.m1.1.1.1.1a" xref="S2.E14.m1.1.1.1.1.cmml"><mtd columnalign="center" id="S2.E14.m1.1.1.1.1b" xref="S2.E14.m1.1.1.1.1.cmml"><msub id="S2.E13.1.1" xref="S2.E13.1.1.cmml"><mrow id="S2.E13.1.1.1.1" xref="S2.E13.1.1.1.2.cmml"><mo stretchy="false" id="S2.E13.1.1.1.1.2" xref="S2.E13.1.1.1.2.1.cmml">⟨</mo><msub id="S2.E13.1.1.1.1.1" xref="S2.E13.1.1.1.1.1.cmml"><mi id="S2.E13.1.1.1.1.1.2" xref="S2.E13.1.1.1.1.1.2.cmml">P</mi><mn id="S2.E13.1.1.1.1.1.3" xref="S2.E13.1.1.1.1.1.3.cmml">1</mn></msub><mo stretchy="false" id="S2.E13.1.1.1.1.3" xref="S2.E13.1.1.1.2.1.cmml">⟩</mo></mrow><mi id="S2.E13.1.1.3" xref="S2.E13.1.1.3.cmml">s</mi></msub></mtd><mtd columnalign="center" id="S2.E14.m1.1.1.1.1c" xref="S2.E14.m1.1.1.1.1.cmml"><msub id="S2.E13.2.1" xref="S2.E13.2.1.cmml"><mrow id="S2.E13.2.1.1.1" xref="S2.E13.2.1.1.2.cmml"><mo stretchy="false" id="S2.E13.2.1.1.1.2" xref="S2.E13.2.1.1.2.1.cmml">⟨</mo><msub id="S2.E13.2.1.1.1.1" xref="S2.E13.2.1.1.1.1.cmml"><mi id="S2.E13.2.1.1.1.1.2" xref="S2.E13.2.1.1.1.1.2.cmml">P</mi><mn id="S2.E13.2.1.1.1.1.3" xref="S2.E13.2.1.1.1.1.3.cmml">2</mn></msub><mo stretchy="false" id="S2.E13.2.1.1.1.3" xref="S2.E13.2.1.1.2.1.cmml">⟩</mo></mrow><mi id="S2.E13.2.1.3" xref="S2.E13.2.1.3.cmml">s</mi></msub></mtd><mtd columnalign="center" id="S2.E14.m1.1.1.1.1d" xref="S2.E14.m1.1.1.1.1.cmml"><mi mathvariant="normal" id="S2.E13.4.1" xref="S2.E13.4.1.cmml">⋯</mi></mtd><mtd columnalign="center" id="S2.E14.m1.1.1.1.1e" xref="S2.E14.m1.1.1.1.1.cmml"><msub id="S2.E13.3.1" xref="S2.E13.3.1.cmml"><mrow id="S2.E13.3.1.1.1" xref="S2.E13.3.1.1.2.cmml"><mo stretchy="false" id="S2.E13.3.1.1.1.2" xref="S2.E13.3.1.1.2.1.cmml">⟨</mo><msub id="S2.E13.3.1.1.1.1" xref="S2.E13.3.1.1.1.1.cmml"><mi id="S2.E13.3.1.1.1.1.2" xref="S2.E13.3.1.1.1.1.2.cmml">P</mi><mi id="S2.E13.3.1.1.1.1.3" xref="S2.E13.3.1.1.1.1.3.cmml">d</mi></msub><mo stretchy="false" id="S2.E13.3.1.1.1.3" xref="S2.E13.3.1.1.2.1.cmml">⟩</mo></mrow><mi id="S2.E13.3.1.3" xref="S2.E13.3.1.3.cmml">s</mi></msub></mtd></mtr></mtable><mo id="S2.E14.m1.1.1a.3.2" xref="S2.E14.m1.1.1a.2.1.cmml">]</mo></mrow><mo id="S2.E14.m1.2.2.1.1.3.2" xref="S2.E14.m1.2.2.1.1.3.2.cmml">⊤</mo></msup></mrow><mo id="S2.E14.m1.2.2.1.2" xref="S2.E14.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E14.m1.2b"><apply id="S2.E14.m1.2.2.1.1.cmml" xref="S2.E14.m1.2.2.1"><csymbol cd="latexml" id="S2.E14.m1.2.2.1.1.1.cmml" xref="S2.E14.m1.2.2.1.1.1">assign</csymbol><apply id="S2.E14.m1.2.2.1.1.2.cmml" xref="S2.E14.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S2.E14.m1.2.2.1.1.2.1.cmml" xref="S2.E14.m1.2.2.1.1.2">subscript</csymbol><ci id="S2.E14.m1.2.2.1.1.2.2.cmml" xref="S2.E14.m1.2.2.1.1.2.2">𝒐</ci><ci id="S2.E14.m1.2.2.1.1.2.3.cmml" xref="S2.E14.m1.2.2.1.1.2.3">𝑠</ci></apply><apply id="S2.E14.m1.2.2.1.1.3.cmml" xref="S2.E14.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S2.E14.m1.2.2.1.1.3.1.cmml" xref="S2.E14.m1.2.2.1.1.3">superscript</csymbol><apply id="S2.E14.m1.1.1a.2.cmml" xref="S2.E14.m1.1.1a.3"><csymbol cd="latexml" id="S2.E14.m1.1.1a.2.1.cmml" xref="S2.E14.m1.1.1a.3.1">matrix</csymbol><matrix id="S2.E14.m1.1.1.1.1.cmml" xref="S2.E14.m1.1.1.1.1"><matrixrow id="S2.E14.m1.1.1.1.1a.cmml" xref="S2.E14.m1.1.1.1.1"><apply id="S2.E13.1.1.cmml" xref="S2.E13.1.1"><csymbol cd="ambiguous" id="S2.E13.1.1.2.cmml" xref="S2.E13.1.1">subscript</csymbol><apply id="S2.E13.1.1.1.2.cmml" xref="S2.E13.1.1.1.1"><csymbol cd="latexml" id="S2.E13.1.1.1.2.1.cmml" xref="S2.E13.1.1.1.1.2">delimited-⟨⟩</csymbol><apply id="S2.E13.1.1.1.1.1.cmml" xref="S2.E13.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E13.1.1.1.1.1.1.cmml" xref="S2.E13.1.1.1.1.1">subscript</csymbol><ci id="S2.E13.1.1.1.1.1.2.cmml" xref="S2.E13.1.1.1.1.1.2">𝑃</ci><cn type="integer" id="S2.E13.1.1.1.1.1.3.cmml" xref="S2.E13.1.1.1.1.1.3">1</cn></apply></apply><ci id="S2.E13.1.1.3.cmml" xref="S2.E13.1.1.3">𝑠</ci></apply><apply id="S2.E13.2.1.cmml" xref="S2.E13.2.1"><csymbol cd="ambiguous" id="S2.E13.2.1.2.cmml" xref="S2.E13.2.1">subscript</csymbol><apply id="S2.E13.2.1.1.2.cmml" xref="S2.E13.2.1.1.1"><csymbol cd="latexml" id="S2.E13.2.1.1.2.1.cmml" xref="S2.E13.2.1.1.1.2">delimited-⟨⟩</csymbol><apply id="S2.E13.2.1.1.1.1.cmml" xref="S2.E13.2.1.1.1.1"><csymbol cd="ambiguous" id="S2.E13.2.1.1.1.1.1.cmml" xref="S2.E13.2.1.1.1.1">subscript</csymbol><ci id="S2.E13.2.1.1.1.1.2.cmml" xref="S2.E13.2.1.1.1.1.2">𝑃</ci><cn type="integer" id="S2.E13.2.1.1.1.1.3.cmml" xref="S2.E13.2.1.1.1.1.3">2</cn></apply></apply><ci id="S2.E13.2.1.3.cmml" xref="S2.E13.2.1.3">𝑠</ci></apply><ci id="S2.E13.4.1.cmml" xref="S2.E13.4.1">⋯</ci><apply id="S2.E13.3.1.cmml" xref="S2.E13.3.1"><csymbol cd="ambiguous" id="S2.E13.3.1.2.cmml" xref="S2.E13.3.1">subscript</csymbol><apply id="S2.E13.3.1.1.2.cmml" xref="S2.E13.3.1.1.1"><csymbol cd="latexml" id="S2.E13.3.1.1.2.1.cmml" xref="S2.E13.3.1.1.1.2">delimited-⟨⟩</csymbol><apply id="S2.E13.3.1.1.1.1.cmml" xref="S2.E13.3.1.1.1.1"><csymbol cd="ambiguous" id="S2.E13.3.1.1.1.1.1.cmml" xref="S2.E13.3.1.1.1.1">subscript</csymbol><ci id="S2.E13.3.1.1.1.1.2.cmml" xref="S2.E13.3.1.1.1.1.2">𝑃</ci><ci id="S2.E13.3.1.1.1.1.3.cmml" xref="S2.E13.3.1.1.1.1.3">𝑑</ci></apply></apply><ci id="S2.E13.3.1.3.cmml" xref="S2.E13.3.1.3">𝑠</ci></apply></matrixrow></matrix></apply><csymbol cd="latexml" id="S2.E14.m1.2.2.1.1.3.2.cmml" xref="S2.E14.m1.2.2.1.1.3.2">top</csymbol></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E14.m1.2c">\displaystyle\bm{o}_{s}:=\begin{bmatrix}\langle P_{1}\rangle_{s}&amp;\langle P_{2}%
\rangle_{s}&amp;\cdots&amp;\langle P_{d}\rangle_{s}\end{bmatrix}^{\top},</annotation><annotation encoding="application/x-llamapun" id="S2.E14.m1.2d">bold_italic_o start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT := [ start_ARG start_ROW start_CELL ⟨ italic_P start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ⟩ start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT end_CELL start_CELL ⟨ italic_P start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ⟩ start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT end_CELL start_CELL ⋯ end_CELL start_CELL ⟨ italic_P start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT ⟩ start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT end_CELL end_ROW end_ARG ] start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(14)</span></td>
</tr></tbody>
</table>
<p id="S2.SS1.p3.14" class="ltx_p">where <math id="S2.SS1.p3.12.m1.1" class="ltx_Math" alttext="\langle P_{j}\rangle_{s}" display="inline"><semantics id="S2.SS1.p3.12.m1.1a"><msub id="S2.SS1.p3.12.m1.1.1" xref="S2.SS1.p3.12.m1.1.1.cmml"><mrow id="S2.SS1.p3.12.m1.1.1.1.1" xref="S2.SS1.p3.12.m1.1.1.1.2.cmml"><mo stretchy="false" id="S2.SS1.p3.12.m1.1.1.1.1.2" xref="S2.SS1.p3.12.m1.1.1.1.2.1.cmml">⟨</mo><msub id="S2.SS1.p3.12.m1.1.1.1.1.1" xref="S2.SS1.p3.12.m1.1.1.1.1.1.cmml"><mi id="S2.SS1.p3.12.m1.1.1.1.1.1.2" xref="S2.SS1.p3.12.m1.1.1.1.1.1.2.cmml">P</mi><mi id="S2.SS1.p3.12.m1.1.1.1.1.1.3" xref="S2.SS1.p3.12.m1.1.1.1.1.1.3.cmml">j</mi></msub><mo stretchy="false" id="S2.SS1.p3.12.m1.1.1.1.1.3" xref="S2.SS1.p3.12.m1.1.1.1.2.1.cmml">⟩</mo></mrow><mi id="S2.SS1.p3.12.m1.1.1.3" xref="S2.SS1.p3.12.m1.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.12.m1.1b"><apply id="S2.SS1.p3.12.m1.1.1.cmml" xref="S2.SS1.p3.12.m1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p3.12.m1.1.1.2.cmml" xref="S2.SS1.p3.12.m1.1.1">subscript</csymbol><apply id="S2.SS1.p3.12.m1.1.1.1.2.cmml" xref="S2.SS1.p3.12.m1.1.1.1.1"><csymbol cd="latexml" id="S2.SS1.p3.12.m1.1.1.1.2.1.cmml" xref="S2.SS1.p3.12.m1.1.1.1.1.2">delimited-⟨⟩</csymbol><apply id="S2.SS1.p3.12.m1.1.1.1.1.1.cmml" xref="S2.SS1.p3.12.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p3.12.m1.1.1.1.1.1.1.cmml" xref="S2.SS1.p3.12.m1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS1.p3.12.m1.1.1.1.1.1.2.cmml" xref="S2.SS1.p3.12.m1.1.1.1.1.1.2">𝑃</ci><ci id="S2.SS1.p3.12.m1.1.1.1.1.1.3.cmml" xref="S2.SS1.p3.12.m1.1.1.1.1.1.3">𝑗</ci></apply></apply><ci id="S2.SS1.p3.12.m1.1.1.3.cmml" xref="S2.SS1.p3.12.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.12.m1.1c">\langle P_{j}\rangle_{s}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.12.m1.1d">⟨ italic_P start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ⟩ start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> <math id="S2.SS1.p3.13.m2.2" class="ltx_Math" alttext="=\bra{\psi_{s}}U_{v}^{\dagger}(\bm{\theta}_{v})P_{j}U_{v}(\bm{\theta}_{v})\ket%
{\psi_{s}}" display="inline"><semantics id="S2.SS1.p3.13.m2.2a"><mrow id="S2.SS1.p3.13.m2.2.2" xref="S2.SS1.p3.13.m2.2.2.cmml"><mi id="S2.SS1.p3.13.m2.2.2.4" xref="S2.SS1.p3.13.m2.2.2.4.cmml"></mi><mo id="S2.SS1.p3.13.m2.2.2.3" xref="S2.SS1.p3.13.m2.2.2.3.cmml">=</mo><mrow id="S2.SS1.p3.13.m2.2.2.2" xref="S2.SS1.p3.13.m2.2.2.2.cmml"><merror class="ltx_ERROR undefined undefined" id="S2.SS1.p3.13.m2.2.2.2.4" xref="S2.SS1.p3.13.m2.2.2.2.4b.cmml"><mtext id="S2.SS1.p3.13.m2.2.2.2.4a" xref="S2.SS1.p3.13.m2.2.2.2.4b.cmml">\bra</mtext></merror><mo id="S2.SS1.p3.13.m2.2.2.2.3" xref="S2.SS1.p3.13.m2.2.2.2.3.cmml">⁢</mo><msub id="S2.SS1.p3.13.m2.2.2.2.5" xref="S2.SS1.p3.13.m2.2.2.2.5.cmml"><mi id="S2.SS1.p3.13.m2.2.2.2.5.2" xref="S2.SS1.p3.13.m2.2.2.2.5.2.cmml">ψ</mi><mi id="S2.SS1.p3.13.m2.2.2.2.5.3" xref="S2.SS1.p3.13.m2.2.2.2.5.3.cmml">s</mi></msub><mo id="S2.SS1.p3.13.m2.2.2.2.3a" xref="S2.SS1.p3.13.m2.2.2.2.3.cmml">⁢</mo><msubsup id="S2.SS1.p3.13.m2.2.2.2.6" xref="S2.SS1.p3.13.m2.2.2.2.6.cmml"><mi id="S2.SS1.p3.13.m2.2.2.2.6.2.2" xref="S2.SS1.p3.13.m2.2.2.2.6.2.2.cmml">U</mi><mi id="S2.SS1.p3.13.m2.2.2.2.6.2.3" xref="S2.SS1.p3.13.m2.2.2.2.6.2.3.cmml">v</mi><mo id="S2.SS1.p3.13.m2.2.2.2.6.3" xref="S2.SS1.p3.13.m2.2.2.2.6.3.cmml">†</mo></msubsup><mo id="S2.SS1.p3.13.m2.2.2.2.3b" xref="S2.SS1.p3.13.m2.2.2.2.3.cmml">⁢</mo><mrow id="S2.SS1.p3.13.m2.1.1.1.1.1" xref="S2.SS1.p3.13.m2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS1.p3.13.m2.1.1.1.1.1.2" xref="S2.SS1.p3.13.m2.1.1.1.1.1.1.cmml">(</mo><msub id="S2.SS1.p3.13.m2.1.1.1.1.1.1" xref="S2.SS1.p3.13.m2.1.1.1.1.1.1.cmml"><mi id="S2.SS1.p3.13.m2.1.1.1.1.1.1.2" xref="S2.SS1.p3.13.m2.1.1.1.1.1.1.2.cmml">𝜽</mi><mi id="S2.SS1.p3.13.m2.1.1.1.1.1.1.3" xref="S2.SS1.p3.13.m2.1.1.1.1.1.1.3.cmml">v</mi></msub><mo stretchy="false" id="S2.SS1.p3.13.m2.1.1.1.1.1.3" xref="S2.SS1.p3.13.m2.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.SS1.p3.13.m2.2.2.2.3c" xref="S2.SS1.p3.13.m2.2.2.2.3.cmml">⁢</mo><msub id="S2.SS1.p3.13.m2.2.2.2.7" xref="S2.SS1.p3.13.m2.2.2.2.7.cmml"><mi id="S2.SS1.p3.13.m2.2.2.2.7.2" xref="S2.SS1.p3.13.m2.2.2.2.7.2.cmml">P</mi><mi id="S2.SS1.p3.13.m2.2.2.2.7.3" xref="S2.SS1.p3.13.m2.2.2.2.7.3.cmml">j</mi></msub><mo id="S2.SS1.p3.13.m2.2.2.2.3d" xref="S2.SS1.p3.13.m2.2.2.2.3.cmml">⁢</mo><msub id="S2.SS1.p3.13.m2.2.2.2.8" xref="S2.SS1.p3.13.m2.2.2.2.8.cmml"><mi id="S2.SS1.p3.13.m2.2.2.2.8.2" xref="S2.SS1.p3.13.m2.2.2.2.8.2.cmml">U</mi><mi id="S2.SS1.p3.13.m2.2.2.2.8.3" xref="S2.SS1.p3.13.m2.2.2.2.8.3.cmml">v</mi></msub><mo id="S2.SS1.p3.13.m2.2.2.2.3e" xref="S2.SS1.p3.13.m2.2.2.2.3.cmml">⁢</mo><mrow id="S2.SS1.p3.13.m2.2.2.2.2.1" xref="S2.SS1.p3.13.m2.2.2.2.2.1.1.cmml"><mo stretchy="false" id="S2.SS1.p3.13.m2.2.2.2.2.1.2" xref="S2.SS1.p3.13.m2.2.2.2.2.1.1.cmml">(</mo><msub id="S2.SS1.p3.13.m2.2.2.2.2.1.1" xref="S2.SS1.p3.13.m2.2.2.2.2.1.1.cmml"><mi id="S2.SS1.p3.13.m2.2.2.2.2.1.1.2" xref="S2.SS1.p3.13.m2.2.2.2.2.1.1.2.cmml">𝜽</mi><mi id="S2.SS1.p3.13.m2.2.2.2.2.1.1.3" xref="S2.SS1.p3.13.m2.2.2.2.2.1.1.3.cmml">v</mi></msub><mo stretchy="false" id="S2.SS1.p3.13.m2.2.2.2.2.1.3" xref="S2.SS1.p3.13.m2.2.2.2.2.1.1.cmml">)</mo></mrow><mo id="S2.SS1.p3.13.m2.2.2.2.3f" xref="S2.SS1.p3.13.m2.2.2.2.3.cmml">⁢</mo><merror class="ltx_ERROR undefined undefined" id="S2.SS1.p3.13.m2.2.2.2.9" xref="S2.SS1.p3.13.m2.2.2.2.9b.cmml"><mtext id="S2.SS1.p3.13.m2.2.2.2.9a" xref="S2.SS1.p3.13.m2.2.2.2.9b.cmml">\ket</mtext></merror><mo id="S2.SS1.p3.13.m2.2.2.2.3g" xref="S2.SS1.p3.13.m2.2.2.2.3.cmml">⁢</mo><msub id="S2.SS1.p3.13.m2.2.2.2.10" xref="S2.SS1.p3.13.m2.2.2.2.10.cmml"><mi id="S2.SS1.p3.13.m2.2.2.2.10.2" xref="S2.SS1.p3.13.m2.2.2.2.10.2.cmml">ψ</mi><mi id="S2.SS1.p3.13.m2.2.2.2.10.3" xref="S2.SS1.p3.13.m2.2.2.2.10.3.cmml">s</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.13.m2.2b"><apply id="S2.SS1.p3.13.m2.2.2.cmml" xref="S2.SS1.p3.13.m2.2.2"><eq id="S2.SS1.p3.13.m2.2.2.3.cmml" xref="S2.SS1.p3.13.m2.2.2.3"></eq><csymbol cd="latexml" id="S2.SS1.p3.13.m2.2.2.4.cmml" xref="S2.SS1.p3.13.m2.2.2.4">absent</csymbol><apply id="S2.SS1.p3.13.m2.2.2.2.cmml" xref="S2.SS1.p3.13.m2.2.2.2"><times id="S2.SS1.p3.13.m2.2.2.2.3.cmml" xref="S2.SS1.p3.13.m2.2.2.2.3"></times><ci id="S2.SS1.p3.13.m2.2.2.2.4b.cmml" xref="S2.SS1.p3.13.m2.2.2.2.4"><merror class="ltx_ERROR undefined undefined" id="S2.SS1.p3.13.m2.2.2.2.4.cmml" xref="S2.SS1.p3.13.m2.2.2.2.4"><mtext id="S2.SS1.p3.13.m2.2.2.2.4a.cmml" xref="S2.SS1.p3.13.m2.2.2.2.4">\bra</mtext></merror></ci><apply id="S2.SS1.p3.13.m2.2.2.2.5.cmml" xref="S2.SS1.p3.13.m2.2.2.2.5"><csymbol cd="ambiguous" id="S2.SS1.p3.13.m2.2.2.2.5.1.cmml" xref="S2.SS1.p3.13.m2.2.2.2.5">subscript</csymbol><ci id="S2.SS1.p3.13.m2.2.2.2.5.2.cmml" xref="S2.SS1.p3.13.m2.2.2.2.5.2">𝜓</ci><ci id="S2.SS1.p3.13.m2.2.2.2.5.3.cmml" xref="S2.SS1.p3.13.m2.2.2.2.5.3">𝑠</ci></apply><apply id="S2.SS1.p3.13.m2.2.2.2.6.cmml" xref="S2.SS1.p3.13.m2.2.2.2.6"><csymbol cd="ambiguous" id="S2.SS1.p3.13.m2.2.2.2.6.1.cmml" xref="S2.SS1.p3.13.m2.2.2.2.6">superscript</csymbol><apply id="S2.SS1.p3.13.m2.2.2.2.6.2.cmml" xref="S2.SS1.p3.13.m2.2.2.2.6"><csymbol cd="ambiguous" id="S2.SS1.p3.13.m2.2.2.2.6.2.1.cmml" xref="S2.SS1.p3.13.m2.2.2.2.6">subscript</csymbol><ci id="S2.SS1.p3.13.m2.2.2.2.6.2.2.cmml" xref="S2.SS1.p3.13.m2.2.2.2.6.2.2">𝑈</ci><ci id="S2.SS1.p3.13.m2.2.2.2.6.2.3.cmml" xref="S2.SS1.p3.13.m2.2.2.2.6.2.3">𝑣</ci></apply><ci id="S2.SS1.p3.13.m2.2.2.2.6.3.cmml" xref="S2.SS1.p3.13.m2.2.2.2.6.3">†</ci></apply><apply id="S2.SS1.p3.13.m2.1.1.1.1.1.1.cmml" xref="S2.SS1.p3.13.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p3.13.m2.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p3.13.m2.1.1.1.1.1">subscript</csymbol><ci id="S2.SS1.p3.13.m2.1.1.1.1.1.1.2.cmml" xref="S2.SS1.p3.13.m2.1.1.1.1.1.1.2">𝜽</ci><ci id="S2.SS1.p3.13.m2.1.1.1.1.1.1.3.cmml" xref="S2.SS1.p3.13.m2.1.1.1.1.1.1.3">𝑣</ci></apply><apply id="S2.SS1.p3.13.m2.2.2.2.7.cmml" xref="S2.SS1.p3.13.m2.2.2.2.7"><csymbol cd="ambiguous" id="S2.SS1.p3.13.m2.2.2.2.7.1.cmml" xref="S2.SS1.p3.13.m2.2.2.2.7">subscript</csymbol><ci id="S2.SS1.p3.13.m2.2.2.2.7.2.cmml" xref="S2.SS1.p3.13.m2.2.2.2.7.2">𝑃</ci><ci id="S2.SS1.p3.13.m2.2.2.2.7.3.cmml" xref="S2.SS1.p3.13.m2.2.2.2.7.3">𝑗</ci></apply><apply id="S2.SS1.p3.13.m2.2.2.2.8.cmml" xref="S2.SS1.p3.13.m2.2.2.2.8"><csymbol cd="ambiguous" id="S2.SS1.p3.13.m2.2.2.2.8.1.cmml" xref="S2.SS1.p3.13.m2.2.2.2.8">subscript</csymbol><ci id="S2.SS1.p3.13.m2.2.2.2.8.2.cmml" xref="S2.SS1.p3.13.m2.2.2.2.8.2">𝑈</ci><ci id="S2.SS1.p3.13.m2.2.2.2.8.3.cmml" xref="S2.SS1.p3.13.m2.2.2.2.8.3">𝑣</ci></apply><apply id="S2.SS1.p3.13.m2.2.2.2.2.1.1.cmml" xref="S2.SS1.p3.13.m2.2.2.2.2.1"><csymbol cd="ambiguous" id="S2.SS1.p3.13.m2.2.2.2.2.1.1.1.cmml" xref="S2.SS1.p3.13.m2.2.2.2.2.1">subscript</csymbol><ci id="S2.SS1.p3.13.m2.2.2.2.2.1.1.2.cmml" xref="S2.SS1.p3.13.m2.2.2.2.2.1.1.2">𝜽</ci><ci id="S2.SS1.p3.13.m2.2.2.2.2.1.1.3.cmml" xref="S2.SS1.p3.13.m2.2.2.2.2.1.1.3">𝑣</ci></apply><ci id="S2.SS1.p3.13.m2.2.2.2.9b.cmml" xref="S2.SS1.p3.13.m2.2.2.2.9"><merror class="ltx_ERROR undefined undefined" id="S2.SS1.p3.13.m2.2.2.2.9.cmml" xref="S2.SS1.p3.13.m2.2.2.2.9"><mtext id="S2.SS1.p3.13.m2.2.2.2.9a.cmml" xref="S2.SS1.p3.13.m2.2.2.2.9">\ket</mtext></merror></ci><apply id="S2.SS1.p3.13.m2.2.2.2.10.cmml" xref="S2.SS1.p3.13.m2.2.2.2.10"><csymbol cd="ambiguous" id="S2.SS1.p3.13.m2.2.2.2.10.1.cmml" xref="S2.SS1.p3.13.m2.2.2.2.10">subscript</csymbol><ci id="S2.SS1.p3.13.m2.2.2.2.10.2.cmml" xref="S2.SS1.p3.13.m2.2.2.2.10.2">𝜓</ci><ci id="S2.SS1.p3.13.m2.2.2.2.10.3.cmml" xref="S2.SS1.p3.13.m2.2.2.2.10.3">𝑠</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.13.m2.2c">=\bra{\psi_{s}}U_{v}^{\dagger}(\bm{\theta}_{v})P_{j}U_{v}(\bm{\theta}_{v})\ket%
{\psi_{s}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.13.m2.2d">= italic_ψ start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT italic_U start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT start_POSTSUPERSCRIPT † end_POSTSUPERSCRIPT ( bold_italic_θ start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT ) italic_P start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT italic_U start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT ( bold_italic_θ start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT ) italic_ψ start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math>.
Here, each <math id="S2.SS1.p3.14.m3.4" class="ltx_Math" alttext="P_{j}\in\left\{I,X,Y,Z\right\}^{\otimes n}" display="inline"><semantics id="S2.SS1.p3.14.m3.4a"><mrow id="S2.SS1.p3.14.m3.4.5" xref="S2.SS1.p3.14.m3.4.5.cmml"><msub id="S2.SS1.p3.14.m3.4.5.2" xref="S2.SS1.p3.14.m3.4.5.2.cmml"><mi id="S2.SS1.p3.14.m3.4.5.2.2" xref="S2.SS1.p3.14.m3.4.5.2.2.cmml">P</mi><mi id="S2.SS1.p3.14.m3.4.5.2.3" xref="S2.SS1.p3.14.m3.4.5.2.3.cmml">j</mi></msub><mo id="S2.SS1.p3.14.m3.4.5.1" xref="S2.SS1.p3.14.m3.4.5.1.cmml">∈</mo><msup id="S2.SS1.p3.14.m3.4.5.3" xref="S2.SS1.p3.14.m3.4.5.3.cmml"><mrow id="S2.SS1.p3.14.m3.4.5.3.2.2" xref="S2.SS1.p3.14.m3.4.5.3.2.1.cmml"><mo id="S2.SS1.p3.14.m3.4.5.3.2.2.1" xref="S2.SS1.p3.14.m3.4.5.3.2.1.cmml">{</mo><mi id="S2.SS1.p3.14.m3.1.1" xref="S2.SS1.p3.14.m3.1.1.cmml">I</mi><mo id="S2.SS1.p3.14.m3.4.5.3.2.2.2" xref="S2.SS1.p3.14.m3.4.5.3.2.1.cmml">,</mo><mi id="S2.SS1.p3.14.m3.2.2" xref="S2.SS1.p3.14.m3.2.2.cmml">X</mi><mo id="S2.SS1.p3.14.m3.4.5.3.2.2.3" xref="S2.SS1.p3.14.m3.4.5.3.2.1.cmml">,</mo><mi id="S2.SS1.p3.14.m3.3.3" xref="S2.SS1.p3.14.m3.3.3.cmml">Y</mi><mo id="S2.SS1.p3.14.m3.4.5.3.2.2.4" xref="S2.SS1.p3.14.m3.4.5.3.2.1.cmml">,</mo><mi id="S2.SS1.p3.14.m3.4.4" xref="S2.SS1.p3.14.m3.4.4.cmml">Z</mi><mo id="S2.SS1.p3.14.m3.4.5.3.2.2.5" xref="S2.SS1.p3.14.m3.4.5.3.2.1.cmml">}</mo></mrow><mrow id="S2.SS1.p3.14.m3.4.5.3.3" xref="S2.SS1.p3.14.m3.4.5.3.3.cmml"><mi id="S2.SS1.p3.14.m3.4.5.3.3.2" xref="S2.SS1.p3.14.m3.4.5.3.3.2.cmml"></mi><mo id="S2.SS1.p3.14.m3.4.5.3.3.1" xref="S2.SS1.p3.14.m3.4.5.3.3.1.cmml">⊗</mo><mi id="S2.SS1.p3.14.m3.4.5.3.3.3" xref="S2.SS1.p3.14.m3.4.5.3.3.3.cmml">n</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.14.m3.4b"><apply id="S2.SS1.p3.14.m3.4.5.cmml" xref="S2.SS1.p3.14.m3.4.5"><in id="S2.SS1.p3.14.m3.4.5.1.cmml" xref="S2.SS1.p3.14.m3.4.5.1"></in><apply id="S2.SS1.p3.14.m3.4.5.2.cmml" xref="S2.SS1.p3.14.m3.4.5.2"><csymbol cd="ambiguous" id="S2.SS1.p3.14.m3.4.5.2.1.cmml" xref="S2.SS1.p3.14.m3.4.5.2">subscript</csymbol><ci id="S2.SS1.p3.14.m3.4.5.2.2.cmml" xref="S2.SS1.p3.14.m3.4.5.2.2">𝑃</ci><ci id="S2.SS1.p3.14.m3.4.5.2.3.cmml" xref="S2.SS1.p3.14.m3.4.5.2.3">𝑗</ci></apply><apply id="S2.SS1.p3.14.m3.4.5.3.cmml" xref="S2.SS1.p3.14.m3.4.5.3"><csymbol cd="ambiguous" id="S2.SS1.p3.14.m3.4.5.3.1.cmml" xref="S2.SS1.p3.14.m3.4.5.3">superscript</csymbol><set id="S2.SS1.p3.14.m3.4.5.3.2.1.cmml" xref="S2.SS1.p3.14.m3.4.5.3.2.2"><ci id="S2.SS1.p3.14.m3.1.1.cmml" xref="S2.SS1.p3.14.m3.1.1">𝐼</ci><ci id="S2.SS1.p3.14.m3.2.2.cmml" xref="S2.SS1.p3.14.m3.2.2">𝑋</ci><ci id="S2.SS1.p3.14.m3.3.3.cmml" xref="S2.SS1.p3.14.m3.3.3">𝑌</ci><ci id="S2.SS1.p3.14.m3.4.4.cmml" xref="S2.SS1.p3.14.m3.4.4">𝑍</ci></set><apply id="S2.SS1.p3.14.m3.4.5.3.3.cmml" xref="S2.SS1.p3.14.m3.4.5.3.3"><csymbol cd="latexml" id="S2.SS1.p3.14.m3.4.5.3.3.1.cmml" xref="S2.SS1.p3.14.m3.4.5.3.3.1">tensor-product</csymbol><csymbol cd="latexml" id="S2.SS1.p3.14.m3.4.5.3.3.2.cmml" xref="S2.SS1.p3.14.m3.4.5.3.3.2">absent</csymbol><ci id="S2.SS1.p3.14.m3.4.5.3.3.3.cmml" xref="S2.SS1.p3.14.m3.4.5.3.3.3">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.14.m3.4c">P_{j}\in\left\{I,X,Y,Z\right\}^{\otimes n}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.14.m3.4d">italic_P start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ∈ { italic_I , italic_X , italic_Y , italic_Z } start_POSTSUPERSCRIPT ⊗ italic_n end_POSTSUPERSCRIPT</annotation></semantics></math> denotes a Pauli observable.</p>
</div>
<div id="S2.SS1.p4" class="ltx_para">
<p id="S2.SS1.p4.2" class="ltx_p">Finally, by combining Eqs. (<a href="#S2.Ex1" title="2.1 Quantum Self-Attention Layer ‣ 2 Method ‣ Quantum Self-Attention Neural Networks for Text Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2.1</span></a>) and (<a href="#S2.E14" title="(14) ‣ 2.1 Quantum Self-Attention Layer ‣ 2 Method ‣ Quantum Self-Attention Neural Networks for Text Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">14</span></a>), the classical output <math id="S2.SS1.p4.1.m1.2" class="ltx_Math" alttext="\{\bm{y}^{(l)}_{s}\in\mathbb{R}^{d}\}" display="inline"><semantics id="S2.SS1.p4.1.m1.2a"><mrow id="S2.SS1.p4.1.m1.2.2.1" xref="S2.SS1.p4.1.m1.2.2.2.cmml"><mo stretchy="false" id="S2.SS1.p4.1.m1.2.2.1.2" xref="S2.SS1.p4.1.m1.2.2.2.cmml">{</mo><mrow id="S2.SS1.p4.1.m1.2.2.1.1" xref="S2.SS1.p4.1.m1.2.2.1.1.cmml"><msubsup id="S2.SS1.p4.1.m1.2.2.1.1.2" xref="S2.SS1.p4.1.m1.2.2.1.1.2.cmml"><mi id="S2.SS1.p4.1.m1.2.2.1.1.2.2.2" xref="S2.SS1.p4.1.m1.2.2.1.1.2.2.2.cmml">𝒚</mi><mi id="S2.SS1.p4.1.m1.2.2.1.1.2.3" xref="S2.SS1.p4.1.m1.2.2.1.1.2.3.cmml">s</mi><mrow id="S2.SS1.p4.1.m1.1.1.1.3" xref="S2.SS1.p4.1.m1.2.2.1.1.2.cmml"><mo stretchy="false" id="S2.SS1.p4.1.m1.1.1.1.3.1" xref="S2.SS1.p4.1.m1.2.2.1.1.2.cmml">(</mo><mi id="S2.SS1.p4.1.m1.1.1.1.1" xref="S2.SS1.p4.1.m1.1.1.1.1.cmml">l</mi><mo stretchy="false" id="S2.SS1.p4.1.m1.1.1.1.3.2" xref="S2.SS1.p4.1.m1.2.2.1.1.2.cmml">)</mo></mrow></msubsup><mo id="S2.SS1.p4.1.m1.2.2.1.1.1" xref="S2.SS1.p4.1.m1.2.2.1.1.1.cmml">∈</mo><msup id="S2.SS1.p4.1.m1.2.2.1.1.3" xref="S2.SS1.p4.1.m1.2.2.1.1.3.cmml"><mi id="S2.SS1.p4.1.m1.2.2.1.1.3.2" xref="S2.SS1.p4.1.m1.2.2.1.1.3.2.cmml">ℝ</mi><mi id="S2.SS1.p4.1.m1.2.2.1.1.3.3" xref="S2.SS1.p4.1.m1.2.2.1.1.3.3.cmml">d</mi></msup></mrow><mo stretchy="false" id="S2.SS1.p4.1.m1.2.2.1.3" xref="S2.SS1.p4.1.m1.2.2.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.1.m1.2b"><set id="S2.SS1.p4.1.m1.2.2.2.cmml" xref="S2.SS1.p4.1.m1.2.2.1"><apply id="S2.SS1.p4.1.m1.2.2.1.1.cmml" xref="S2.SS1.p4.1.m1.2.2.1.1"><in id="S2.SS1.p4.1.m1.2.2.1.1.1.cmml" xref="S2.SS1.p4.1.m1.2.2.1.1.1"></in><apply id="S2.SS1.p4.1.m1.2.2.1.1.2.cmml" xref="S2.SS1.p4.1.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p4.1.m1.2.2.1.1.2.1.cmml" xref="S2.SS1.p4.1.m1.2.2.1.1.2">subscript</csymbol><apply id="S2.SS1.p4.1.m1.2.2.1.1.2.2.cmml" xref="S2.SS1.p4.1.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p4.1.m1.2.2.1.1.2.2.1.cmml" xref="S2.SS1.p4.1.m1.2.2.1.1.2">superscript</csymbol><ci id="S2.SS1.p4.1.m1.2.2.1.1.2.2.2.cmml" xref="S2.SS1.p4.1.m1.2.2.1.1.2.2.2">𝒚</ci><ci id="S2.SS1.p4.1.m1.1.1.1.1.cmml" xref="S2.SS1.p4.1.m1.1.1.1.1">𝑙</ci></apply><ci id="S2.SS1.p4.1.m1.2.2.1.1.2.3.cmml" xref="S2.SS1.p4.1.m1.2.2.1.1.2.3">𝑠</ci></apply><apply id="S2.SS1.p4.1.m1.2.2.1.1.3.cmml" xref="S2.SS1.p4.1.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p4.1.m1.2.2.1.1.3.1.cmml" xref="S2.SS1.p4.1.m1.2.2.1.1.3">superscript</csymbol><ci id="S2.SS1.p4.1.m1.2.2.1.1.3.2.cmml" xref="S2.SS1.p4.1.m1.2.2.1.1.3.2">ℝ</ci><ci id="S2.SS1.p4.1.m1.2.2.1.1.3.3.cmml" xref="S2.SS1.p4.1.m1.2.2.1.1.3.3">𝑑</ci></apply></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.1.m1.2c">\{\bm{y}^{(l)}_{s}\in\mathbb{R}^{d}\}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p4.1.m1.2d">{ bold_italic_y start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT }</annotation></semantics></math> of the <math id="S2.SS1.p4.2.m2.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S2.SS1.p4.2.m2.1a"><mi id="S2.SS1.p4.2.m2.1.1" xref="S2.SS1.p4.2.m2.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.2.m2.1b"><ci id="S2.SS1.p4.2.m2.1.1.cmml" xref="S2.SS1.p4.2.m2.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.2.m2.1c">l</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p4.2.m2.1d">italic_l</annotation></semantics></math>-th QSAL are computed as follows:</p>
<table id="S1.EGx6" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S2.E15"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E15.m1.5" class="ltx_Math" alttext="\displaystyle\bm{y}^{(l)}_{s}=\bm{y}^{(l-1)}_{s}+\sum_{j=1}^{S}\tilde{\alpha}_%
{s,j}\cdot\bm{o}_{j}," display="inline"><semantics id="S2.E15.m1.5a"><mrow id="S2.E15.m1.5.5.1" xref="S2.E15.m1.5.5.1.1.cmml"><mrow id="S2.E15.m1.5.5.1.1" xref="S2.E15.m1.5.5.1.1.cmml"><msubsup id="S2.E15.m1.5.5.1.1.2" xref="S2.E15.m1.5.5.1.1.2.cmml"><mi id="S2.E15.m1.5.5.1.1.2.2.2" xref="S2.E15.m1.5.5.1.1.2.2.2.cmml">𝒚</mi><mi id="S2.E15.m1.5.5.1.1.2.3" xref="S2.E15.m1.5.5.1.1.2.3.cmml">s</mi><mrow id="S2.E15.m1.1.1.1.3" xref="S2.E15.m1.5.5.1.1.2.cmml"><mo stretchy="false" id="S2.E15.m1.1.1.1.3.1" xref="S2.E15.m1.5.5.1.1.2.cmml">(</mo><mi id="S2.E15.m1.1.1.1.1" xref="S2.E15.m1.1.1.1.1.cmml">l</mi><mo stretchy="false" id="S2.E15.m1.1.1.1.3.2" xref="S2.E15.m1.5.5.1.1.2.cmml">)</mo></mrow></msubsup><mo id="S2.E15.m1.5.5.1.1.1" xref="S2.E15.m1.5.5.1.1.1.cmml">=</mo><mrow id="S2.E15.m1.5.5.1.1.3" xref="S2.E15.m1.5.5.1.1.3.cmml"><msubsup id="S2.E15.m1.5.5.1.1.3.2" xref="S2.E15.m1.5.5.1.1.3.2.cmml"><mi id="S2.E15.m1.5.5.1.1.3.2.2.2" xref="S2.E15.m1.5.5.1.1.3.2.2.2.cmml">𝒚</mi><mi id="S2.E15.m1.5.5.1.1.3.2.3" xref="S2.E15.m1.5.5.1.1.3.2.3.cmml">s</mi><mrow id="S2.E15.m1.2.2.1.1" xref="S2.E15.m1.2.2.1.1.1.cmml"><mo stretchy="false" id="S2.E15.m1.2.2.1.1.2" xref="S2.E15.m1.2.2.1.1.1.cmml">(</mo><mrow id="S2.E15.m1.2.2.1.1.1" xref="S2.E15.m1.2.2.1.1.1.cmml"><mi id="S2.E15.m1.2.2.1.1.1.2" xref="S2.E15.m1.2.2.1.1.1.2.cmml">l</mi><mo id="S2.E15.m1.2.2.1.1.1.1" xref="S2.E15.m1.2.2.1.1.1.1.cmml">-</mo><mn id="S2.E15.m1.2.2.1.1.1.3" xref="S2.E15.m1.2.2.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S2.E15.m1.2.2.1.1.3" xref="S2.E15.m1.2.2.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S2.E15.m1.5.5.1.1.3.1" xref="S2.E15.m1.5.5.1.1.3.1.cmml">+</mo><mrow id="S2.E15.m1.5.5.1.1.3.3" xref="S2.E15.m1.5.5.1.1.3.3.cmml"><mstyle displaystyle="true" id="S2.E15.m1.5.5.1.1.3.3.1" xref="S2.E15.m1.5.5.1.1.3.3.1.cmml"><munderover id="S2.E15.m1.5.5.1.1.3.3.1a" xref="S2.E15.m1.5.5.1.1.3.3.1.cmml"><mo largeop="true" movablelimits="false" symmetric="true" id="S2.E15.m1.5.5.1.1.3.3.1.2.2" xref="S2.E15.m1.5.5.1.1.3.3.1.2.2.cmml">∑</mo><mrow id="S2.E15.m1.5.5.1.1.3.3.1.2.3" xref="S2.E15.m1.5.5.1.1.3.3.1.2.3.cmml"><mi id="S2.E15.m1.5.5.1.1.3.3.1.2.3.2" xref="S2.E15.m1.5.5.1.1.3.3.1.2.3.2.cmml">j</mi><mo id="S2.E15.m1.5.5.1.1.3.3.1.2.3.1" xref="S2.E15.m1.5.5.1.1.3.3.1.2.3.1.cmml">=</mo><mn id="S2.E15.m1.5.5.1.1.3.3.1.2.3.3" xref="S2.E15.m1.5.5.1.1.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="S2.E15.m1.5.5.1.1.3.3.1.3" xref="S2.E15.m1.5.5.1.1.3.3.1.3.cmml">S</mi></munderover></mstyle><mrow id="S2.E15.m1.5.5.1.1.3.3.2" xref="S2.E15.m1.5.5.1.1.3.3.2.cmml"><msub id="S2.E15.m1.5.5.1.1.3.3.2.2" xref="S2.E15.m1.5.5.1.1.3.3.2.2.cmml"><mover accent="true" id="S2.E15.m1.5.5.1.1.3.3.2.2.2" xref="S2.E15.m1.5.5.1.1.3.3.2.2.2.cmml"><mi id="S2.E15.m1.5.5.1.1.3.3.2.2.2.2" xref="S2.E15.m1.5.5.1.1.3.3.2.2.2.2.cmml">α</mi><mo stretchy="false" id="S2.E15.m1.5.5.1.1.3.3.2.2.2.1" xref="S2.E15.m1.5.5.1.1.3.3.2.2.2.1.cmml">~</mo></mover><mrow id="S2.E15.m1.4.4.2.4" xref="S2.E15.m1.4.4.2.3.cmml"><mi id="S2.E15.m1.3.3.1.1" xref="S2.E15.m1.3.3.1.1.cmml">s</mi><mo id="S2.E15.m1.4.4.2.4.1" xref="S2.E15.m1.4.4.2.3.cmml">,</mo><mi id="S2.E15.m1.4.4.2.2" xref="S2.E15.m1.4.4.2.2.cmml">j</mi></mrow></msub><mo id="S2.E15.m1.5.5.1.1.3.3.2.1" xref="S2.E15.m1.5.5.1.1.3.3.2.1.cmml">⋅</mo><msub id="S2.E15.m1.5.5.1.1.3.3.2.3" xref="S2.E15.m1.5.5.1.1.3.3.2.3.cmml"><mi id="S2.E15.m1.5.5.1.1.3.3.2.3.2" xref="S2.E15.m1.5.5.1.1.3.3.2.3.2.cmml">𝒐</mi><mi id="S2.E15.m1.5.5.1.1.3.3.2.3.3" xref="S2.E15.m1.5.5.1.1.3.3.2.3.3.cmml">j</mi></msub></mrow></mrow></mrow></mrow><mo id="S2.E15.m1.5.5.1.2" xref="S2.E15.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E15.m1.5b"><apply id="S2.E15.m1.5.5.1.1.cmml" xref="S2.E15.m1.5.5.1"><eq id="S2.E15.m1.5.5.1.1.1.cmml" xref="S2.E15.m1.5.5.1.1.1"></eq><apply id="S2.E15.m1.5.5.1.1.2.cmml" xref="S2.E15.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="S2.E15.m1.5.5.1.1.2.1.cmml" xref="S2.E15.m1.5.5.1.1.2">subscript</csymbol><apply id="S2.E15.m1.5.5.1.1.2.2.cmml" xref="S2.E15.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="S2.E15.m1.5.5.1.1.2.2.1.cmml" xref="S2.E15.m1.5.5.1.1.2">superscript</csymbol><ci id="S2.E15.m1.5.5.1.1.2.2.2.cmml" xref="S2.E15.m1.5.5.1.1.2.2.2">𝒚</ci><ci id="S2.E15.m1.1.1.1.1.cmml" xref="S2.E15.m1.1.1.1.1">𝑙</ci></apply><ci id="S2.E15.m1.5.5.1.1.2.3.cmml" xref="S2.E15.m1.5.5.1.1.2.3">𝑠</ci></apply><apply id="S2.E15.m1.5.5.1.1.3.cmml" xref="S2.E15.m1.5.5.1.1.3"><plus id="S2.E15.m1.5.5.1.1.3.1.cmml" xref="S2.E15.m1.5.5.1.1.3.1"></plus><apply id="S2.E15.m1.5.5.1.1.3.2.cmml" xref="S2.E15.m1.5.5.1.1.3.2"><csymbol cd="ambiguous" id="S2.E15.m1.5.5.1.1.3.2.1.cmml" xref="S2.E15.m1.5.5.1.1.3.2">subscript</csymbol><apply id="S2.E15.m1.5.5.1.1.3.2.2.cmml" xref="S2.E15.m1.5.5.1.1.3.2"><csymbol cd="ambiguous" id="S2.E15.m1.5.5.1.1.3.2.2.1.cmml" xref="S2.E15.m1.5.5.1.1.3.2">superscript</csymbol><ci id="S2.E15.m1.5.5.1.1.3.2.2.2.cmml" xref="S2.E15.m1.5.5.1.1.3.2.2.2">𝒚</ci><apply id="S2.E15.m1.2.2.1.1.1.cmml" xref="S2.E15.m1.2.2.1.1"><minus id="S2.E15.m1.2.2.1.1.1.1.cmml" xref="S2.E15.m1.2.2.1.1.1.1"></minus><ci id="S2.E15.m1.2.2.1.1.1.2.cmml" xref="S2.E15.m1.2.2.1.1.1.2">𝑙</ci><cn type="integer" id="S2.E15.m1.2.2.1.1.1.3.cmml" xref="S2.E15.m1.2.2.1.1.1.3">1</cn></apply></apply><ci id="S2.E15.m1.5.5.1.1.3.2.3.cmml" xref="S2.E15.m1.5.5.1.1.3.2.3">𝑠</ci></apply><apply id="S2.E15.m1.5.5.1.1.3.3.cmml" xref="S2.E15.m1.5.5.1.1.3.3"><apply id="S2.E15.m1.5.5.1.1.3.3.1.cmml" xref="S2.E15.m1.5.5.1.1.3.3.1"><csymbol cd="ambiguous" id="S2.E15.m1.5.5.1.1.3.3.1.1.cmml" xref="S2.E15.m1.5.5.1.1.3.3.1">superscript</csymbol><apply id="S2.E15.m1.5.5.1.1.3.3.1.2.cmml" xref="S2.E15.m1.5.5.1.1.3.3.1"><csymbol cd="ambiguous" id="S2.E15.m1.5.5.1.1.3.3.1.2.1.cmml" xref="S2.E15.m1.5.5.1.1.3.3.1">subscript</csymbol><sum id="S2.E15.m1.5.5.1.1.3.3.1.2.2.cmml" xref="S2.E15.m1.5.5.1.1.3.3.1.2.2"></sum><apply id="S2.E15.m1.5.5.1.1.3.3.1.2.3.cmml" xref="S2.E15.m1.5.5.1.1.3.3.1.2.3"><eq id="S2.E15.m1.5.5.1.1.3.3.1.2.3.1.cmml" xref="S2.E15.m1.5.5.1.1.3.3.1.2.3.1"></eq><ci id="S2.E15.m1.5.5.1.1.3.3.1.2.3.2.cmml" xref="S2.E15.m1.5.5.1.1.3.3.1.2.3.2">𝑗</ci><cn type="integer" id="S2.E15.m1.5.5.1.1.3.3.1.2.3.3.cmml" xref="S2.E15.m1.5.5.1.1.3.3.1.2.3.3">1</cn></apply></apply><ci id="S2.E15.m1.5.5.1.1.3.3.1.3.cmml" xref="S2.E15.m1.5.5.1.1.3.3.1.3">𝑆</ci></apply><apply id="S2.E15.m1.5.5.1.1.3.3.2.cmml" xref="S2.E15.m1.5.5.1.1.3.3.2"><ci id="S2.E15.m1.5.5.1.1.3.3.2.1.cmml" xref="S2.E15.m1.5.5.1.1.3.3.2.1">⋅</ci><apply id="S2.E15.m1.5.5.1.1.3.3.2.2.cmml" xref="S2.E15.m1.5.5.1.1.3.3.2.2"><csymbol cd="ambiguous" id="S2.E15.m1.5.5.1.1.3.3.2.2.1.cmml" xref="S2.E15.m1.5.5.1.1.3.3.2.2">subscript</csymbol><apply id="S2.E15.m1.5.5.1.1.3.3.2.2.2.cmml" xref="S2.E15.m1.5.5.1.1.3.3.2.2.2"><ci id="S2.E15.m1.5.5.1.1.3.3.2.2.2.1.cmml" xref="S2.E15.m1.5.5.1.1.3.3.2.2.2.1">~</ci><ci id="S2.E15.m1.5.5.1.1.3.3.2.2.2.2.cmml" xref="S2.E15.m1.5.5.1.1.3.3.2.2.2.2">𝛼</ci></apply><list id="S2.E15.m1.4.4.2.3.cmml" xref="S2.E15.m1.4.4.2.4"><ci id="S2.E15.m1.3.3.1.1.cmml" xref="S2.E15.m1.3.3.1.1">𝑠</ci><ci id="S2.E15.m1.4.4.2.2.cmml" xref="S2.E15.m1.4.4.2.2">𝑗</ci></list></apply><apply id="S2.E15.m1.5.5.1.1.3.3.2.3.cmml" xref="S2.E15.m1.5.5.1.1.3.3.2.3"><csymbol cd="ambiguous" id="S2.E15.m1.5.5.1.1.3.3.2.3.1.cmml" xref="S2.E15.m1.5.5.1.1.3.3.2.3">subscript</csymbol><ci id="S2.E15.m1.5.5.1.1.3.3.2.3.2.cmml" xref="S2.E15.m1.5.5.1.1.3.3.2.3.2">𝒐</ci><ci id="S2.E15.m1.5.5.1.1.3.3.2.3.3.cmml" xref="S2.E15.m1.5.5.1.1.3.3.2.3.3">𝑗</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E15.m1.5c">\displaystyle\bm{y}^{(l)}_{s}=\bm{y}^{(l-1)}_{s}+\sum_{j=1}^{S}\tilde{\alpha}_%
{s,j}\cdot\bm{o}_{j},</annotation><annotation encoding="application/x-llamapun" id="S2.E15.m1.5d">bold_italic_y start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT = bold_italic_y start_POSTSUPERSCRIPT ( italic_l - 1 ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT + ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_S end_POSTSUPERSCRIPT over~ start_ARG italic_α end_ARG start_POSTSUBSCRIPT italic_s , italic_j end_POSTSUBSCRIPT ⋅ bold_italic_o start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(15)</span></td>
</tr></tbody>
</table>
<p id="S2.SS1.p4.5" class="ltx_p">where <math id="S2.SS1.p4.3.m1.2" class="ltx_Math" alttext="\tilde{\alpha}_{s,j}" display="inline"><semantics id="S2.SS1.p4.3.m1.2a"><msub id="S2.SS1.p4.3.m1.2.3" xref="S2.SS1.p4.3.m1.2.3.cmml"><mover accent="true" id="S2.SS1.p4.3.m1.2.3.2" xref="S2.SS1.p4.3.m1.2.3.2.cmml"><mi id="S2.SS1.p4.3.m1.2.3.2.2" xref="S2.SS1.p4.3.m1.2.3.2.2.cmml">α</mi><mo stretchy="false" id="S2.SS1.p4.3.m1.2.3.2.1" xref="S2.SS1.p4.3.m1.2.3.2.1.cmml">~</mo></mover><mrow id="S2.SS1.p4.3.m1.2.2.2.4" xref="S2.SS1.p4.3.m1.2.2.2.3.cmml"><mi id="S2.SS1.p4.3.m1.1.1.1.1" xref="S2.SS1.p4.3.m1.1.1.1.1.cmml">s</mi><mo id="S2.SS1.p4.3.m1.2.2.2.4.1" xref="S2.SS1.p4.3.m1.2.2.2.3.cmml">,</mo><mi id="S2.SS1.p4.3.m1.2.2.2.2" xref="S2.SS1.p4.3.m1.2.2.2.2.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.3.m1.2b"><apply id="S2.SS1.p4.3.m1.2.3.cmml" xref="S2.SS1.p4.3.m1.2.3"><csymbol cd="ambiguous" id="S2.SS1.p4.3.m1.2.3.1.cmml" xref="S2.SS1.p4.3.m1.2.3">subscript</csymbol><apply id="S2.SS1.p4.3.m1.2.3.2.cmml" xref="S2.SS1.p4.3.m1.2.3.2"><ci id="S2.SS1.p4.3.m1.2.3.2.1.cmml" xref="S2.SS1.p4.3.m1.2.3.2.1">~</ci><ci id="S2.SS1.p4.3.m1.2.3.2.2.cmml" xref="S2.SS1.p4.3.m1.2.3.2.2">𝛼</ci></apply><list id="S2.SS1.p4.3.m1.2.2.2.3.cmml" xref="S2.SS1.p4.3.m1.2.2.2.4"><ci id="S2.SS1.p4.3.m1.1.1.1.1.cmml" xref="S2.SS1.p4.3.m1.1.1.1.1">𝑠</ci><ci id="S2.SS1.p4.3.m1.2.2.2.2.cmml" xref="S2.SS1.p4.3.m1.2.2.2.2">𝑗</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.3.m1.2c">\tilde{\alpha}_{s,j}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p4.3.m1.2d">over~ start_ARG italic_α end_ARG start_POSTSUBSCRIPT italic_s , italic_j end_POSTSUBSCRIPT</annotation></semantics></math> denotes the normalized quantum self-attention coefficient between the <math id="S2.SS1.p4.4.m2.1" class="ltx_Math" alttext="s" display="inline"><semantics id="S2.SS1.p4.4.m2.1a"><mi id="S2.SS1.p4.4.m2.1.1" xref="S2.SS1.p4.4.m2.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.4.m2.1b"><ci id="S2.SS1.p4.4.m2.1.1.cmml" xref="S2.SS1.p4.4.m2.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.4.m2.1c">s</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p4.4.m2.1d">italic_s</annotation></semantics></math>-th and the <math id="S2.SS1.p4.5.m3.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S2.SS1.p4.5.m3.1a"><mi id="S2.SS1.p4.5.m3.1.1" xref="S2.SS1.p4.5.m3.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.5.m3.1b"><ci id="S2.SS1.p4.5.m3.1.1.cmml" xref="S2.SS1.p4.5.m3.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.5.m3.1c">j</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p4.5.m3.1d">italic_j</annotation></semantics></math>-th input vectors and is calculated by the corresponding query and key parts:</p>
<table id="S1.EGx7" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S2.E16"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E16.m1.11" class="ltx_Math" alttext="\displaystyle\tilde{\alpha}_{s,j}=\frac{\alpha_{s,j}}{\sum_{m=1}^{S}\alpha_{s,%
m}}\qquad\text{with}\qquad\alpha_{s,j}:=\text{e}^{-(\langle Z_{q}\rangle_{s}-%
\langle Z_{k}\rangle_{j})^{2}}." display="inline"><semantics id="S2.E16.m1.11a"><mrow id="S2.E16.m1.11.11.1"><mrow id="S2.E16.m1.11.11.1.1.2" xref="S2.E16.m1.11.11.1.1.3.cmml"><mrow id="S2.E16.m1.11.11.1.1.1.1" xref="S2.E16.m1.11.11.1.1.1.1.cmml"><msub id="S2.E16.m1.11.11.1.1.1.1.2" xref="S2.E16.m1.11.11.1.1.1.1.2.cmml"><mover accent="true" id="S2.E16.m1.11.11.1.1.1.1.2.2" xref="S2.E16.m1.11.11.1.1.1.1.2.2.cmml"><mi id="S2.E16.m1.11.11.1.1.1.1.2.2.2" xref="S2.E16.m1.11.11.1.1.1.1.2.2.2.cmml">α</mi><mo stretchy="false" id="S2.E16.m1.11.11.1.1.1.1.2.2.1" xref="S2.E16.m1.11.11.1.1.1.1.2.2.1.cmml">~</mo></mover><mrow id="S2.E16.m1.2.2.2.4" xref="S2.E16.m1.2.2.2.3.cmml"><mi id="S2.E16.m1.1.1.1.1" xref="S2.E16.m1.1.1.1.1.cmml">s</mi><mo id="S2.E16.m1.2.2.2.4.1" xref="S2.E16.m1.2.2.2.3.cmml">,</mo><mi id="S2.E16.m1.2.2.2.2" xref="S2.E16.m1.2.2.2.2.cmml">j</mi></mrow></msub><mo id="S2.E16.m1.11.11.1.1.1.1.1" xref="S2.E16.m1.11.11.1.1.1.1.1.cmml">=</mo><mrow id="S2.E16.m1.11.11.1.1.1.1.3.2" xref="S2.E16.m1.11.11.1.1.1.1.3.1.cmml"><mstyle displaystyle="true" id="S2.E16.m1.6.6" xref="S2.E16.m1.6.6.cmml"><mfrac id="S2.E16.m1.6.6a" xref="S2.E16.m1.6.6.cmml"><msub id="S2.E16.m1.4.4.2" xref="S2.E16.m1.4.4.2.cmml"><mi id="S2.E16.m1.4.4.2.4" xref="S2.E16.m1.4.4.2.4.cmml">α</mi><mrow id="S2.E16.m1.4.4.2.2.2.4" xref="S2.E16.m1.4.4.2.2.2.3.cmml"><mi id="S2.E16.m1.3.3.1.1.1.1" xref="S2.E16.m1.3.3.1.1.1.1.cmml">s</mi><mo id="S2.E16.m1.4.4.2.2.2.4.1" xref="S2.E16.m1.4.4.2.2.2.3.cmml">,</mo><mi id="S2.E16.m1.4.4.2.2.2.2" xref="S2.E16.m1.4.4.2.2.2.2.cmml">j</mi></mrow></msub><mrow id="S2.E16.m1.6.6.4" xref="S2.E16.m1.6.6.4.cmml"><msubsup id="S2.E16.m1.6.6.4.3" xref="S2.E16.m1.6.6.4.3.cmml"><mo largeop="true" symmetric="true" id="S2.E16.m1.6.6.4.3.2.2" xref="S2.E16.m1.6.6.4.3.2.2.cmml">∑</mo><mrow id="S2.E16.m1.6.6.4.3.2.3" xref="S2.E16.m1.6.6.4.3.2.3.cmml"><mi id="S2.E16.m1.6.6.4.3.2.3.2" xref="S2.E16.m1.6.6.4.3.2.3.2.cmml">m</mi><mo id="S2.E16.m1.6.6.4.3.2.3.1" xref="S2.E16.m1.6.6.4.3.2.3.1.cmml">=</mo><mn id="S2.E16.m1.6.6.4.3.2.3.3" xref="S2.E16.m1.6.6.4.3.2.3.3.cmml">1</mn></mrow><mi id="S2.E16.m1.6.6.4.3.3" xref="S2.E16.m1.6.6.4.3.3.cmml">S</mi></msubsup><msub id="S2.E16.m1.6.6.4.4" xref="S2.E16.m1.6.6.4.4.cmml"><mi id="S2.E16.m1.6.6.4.4.2" xref="S2.E16.m1.6.6.4.4.2.cmml">α</mi><mrow id="S2.E16.m1.6.6.4.2.2.4" xref="S2.E16.m1.6.6.4.2.2.3.cmml"><mi id="S2.E16.m1.5.5.3.1.1.1" xref="S2.E16.m1.5.5.3.1.1.1.cmml">s</mi><mo id="S2.E16.m1.6.6.4.2.2.4.1" xref="S2.E16.m1.6.6.4.2.2.3.cmml">,</mo><mi id="S2.E16.m1.6.6.4.2.2.2" xref="S2.E16.m1.6.6.4.2.2.2.cmml">m</mi></mrow></msub></mrow></mfrac></mstyle><mo mathvariant="italic" separator="true" id="S2.E16.m1.11.11.1.1.1.1.3.2.1" xref="S2.E16.m1.11.11.1.1.1.1.3.1.cmml">  </mo><mtext id="S2.E16.m1.10.10" xref="S2.E16.m1.10.10a.cmml">with</mtext></mrow></mrow><mo mathvariant="italic" separator="true" id="S2.E16.m1.11.11.1.1.2.3" xref="S2.E16.m1.11.11.1.1.3a.cmml">  </mo><mrow id="S2.E16.m1.11.11.1.1.2.2" xref="S2.E16.m1.11.11.1.1.2.2.cmml"><msub id="S2.E16.m1.11.11.1.1.2.2.2" xref="S2.E16.m1.11.11.1.1.2.2.2.cmml"><mi id="S2.E16.m1.11.11.1.1.2.2.2.2" xref="S2.E16.m1.11.11.1.1.2.2.2.2.cmml">α</mi><mrow id="S2.E16.m1.8.8.2.4" xref="S2.E16.m1.8.8.2.3.cmml"><mi id="S2.E16.m1.7.7.1.1" xref="S2.E16.m1.7.7.1.1.cmml">s</mi><mo id="S2.E16.m1.8.8.2.4.1" xref="S2.E16.m1.8.8.2.3.cmml">,</mo><mi id="S2.E16.m1.8.8.2.2" xref="S2.E16.m1.8.8.2.2.cmml">j</mi></mrow></msub><mo id="S2.E16.m1.11.11.1.1.2.2.1" xref="S2.E16.m1.11.11.1.1.2.2.1.cmml">:=</mo><msup id="S2.E16.m1.11.11.1.1.2.2.3" xref="S2.E16.m1.11.11.1.1.2.2.3.cmml"><mtext id="S2.E16.m1.11.11.1.1.2.2.3.2" xref="S2.E16.m1.11.11.1.1.2.2.3.2a.cmml">e</mtext><mrow id="S2.E16.m1.9.9.1" xref="S2.E16.m1.9.9.1.cmml"><mo id="S2.E16.m1.9.9.1.2" xref="S2.E16.m1.9.9.1.2.cmml">-</mo><msup id="S2.E16.m1.9.9.1.1" xref="S2.E16.m1.9.9.1.1.cmml"><mrow id="S2.E16.m1.9.9.1.1.1.1" xref="S2.E16.m1.9.9.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E16.m1.9.9.1.1.1.1.2" xref="S2.E16.m1.9.9.1.1.1.1.1.cmml">(</mo><mrow id="S2.E16.m1.9.9.1.1.1.1.1" xref="S2.E16.m1.9.9.1.1.1.1.1.cmml"><msub id="S2.E16.m1.9.9.1.1.1.1.1.1" xref="S2.E16.m1.9.9.1.1.1.1.1.1.cmml"><mrow id="S2.E16.m1.9.9.1.1.1.1.1.1.1.1" xref="S2.E16.m1.9.9.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.E16.m1.9.9.1.1.1.1.1.1.1.1.2" xref="S2.E16.m1.9.9.1.1.1.1.1.1.1.2.1.cmml">⟨</mo><msub id="S2.E16.m1.9.9.1.1.1.1.1.1.1.1.1" xref="S2.E16.m1.9.9.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E16.m1.9.9.1.1.1.1.1.1.1.1.1.2" xref="S2.E16.m1.9.9.1.1.1.1.1.1.1.1.1.2.cmml">Z</mi><mi id="S2.E16.m1.9.9.1.1.1.1.1.1.1.1.1.3" xref="S2.E16.m1.9.9.1.1.1.1.1.1.1.1.1.3.cmml">q</mi></msub><mo stretchy="false" id="S2.E16.m1.9.9.1.1.1.1.1.1.1.1.3" xref="S2.E16.m1.9.9.1.1.1.1.1.1.1.2.1.cmml">⟩</mo></mrow><mi id="S2.E16.m1.9.9.1.1.1.1.1.1.3" xref="S2.E16.m1.9.9.1.1.1.1.1.1.3.cmml">s</mi></msub><mo id="S2.E16.m1.9.9.1.1.1.1.1.3" xref="S2.E16.m1.9.9.1.1.1.1.1.3.cmml">-</mo><msub id="S2.E16.m1.9.9.1.1.1.1.1.2" xref="S2.E16.m1.9.9.1.1.1.1.1.2.cmml"><mrow id="S2.E16.m1.9.9.1.1.1.1.1.2.1.1" xref="S2.E16.m1.9.9.1.1.1.1.1.2.1.2.cmml"><mo stretchy="false" id="S2.E16.m1.9.9.1.1.1.1.1.2.1.1.2" xref="S2.E16.m1.9.9.1.1.1.1.1.2.1.2.1.cmml">⟨</mo><msub id="S2.E16.m1.9.9.1.1.1.1.1.2.1.1.1" xref="S2.E16.m1.9.9.1.1.1.1.1.2.1.1.1.cmml"><mi id="S2.E16.m1.9.9.1.1.1.1.1.2.1.1.1.2" xref="S2.E16.m1.9.9.1.1.1.1.1.2.1.1.1.2.cmml">Z</mi><mi id="S2.E16.m1.9.9.1.1.1.1.1.2.1.1.1.3" xref="S2.E16.m1.9.9.1.1.1.1.1.2.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="S2.E16.m1.9.9.1.1.1.1.1.2.1.1.3" xref="S2.E16.m1.9.9.1.1.1.1.1.2.1.2.1.cmml">⟩</mo></mrow><mi id="S2.E16.m1.9.9.1.1.1.1.1.2.3" xref="S2.E16.m1.9.9.1.1.1.1.1.2.3.cmml">j</mi></msub></mrow><mo stretchy="false" id="S2.E16.m1.9.9.1.1.1.1.3" xref="S2.E16.m1.9.9.1.1.1.1.1.cmml">)</mo></mrow><mn id="S2.E16.m1.9.9.1.1.3" xref="S2.E16.m1.9.9.1.1.3.cmml">2</mn></msup></mrow></msup></mrow></mrow><mo id="S2.E16.m1.11.11.1.2">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E16.m1.11b"><apply id="S2.E16.m1.11.11.1.1.3.cmml" xref="S2.E16.m1.11.11.1.1.2"><csymbol cd="ambiguous" id="S2.E16.m1.11.11.1.1.3a.cmml" xref="S2.E16.m1.11.11.1.1.2.3">formulae-sequence</csymbol><apply id="S2.E16.m1.11.11.1.1.1.1.cmml" xref="S2.E16.m1.11.11.1.1.1.1"><eq id="S2.E16.m1.11.11.1.1.1.1.1.cmml" xref="S2.E16.m1.11.11.1.1.1.1.1"></eq><apply id="S2.E16.m1.11.11.1.1.1.1.2.cmml" xref="S2.E16.m1.11.11.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E16.m1.11.11.1.1.1.1.2.1.cmml" xref="S2.E16.m1.11.11.1.1.1.1.2">subscript</csymbol><apply id="S2.E16.m1.11.11.1.1.1.1.2.2.cmml" xref="S2.E16.m1.11.11.1.1.1.1.2.2"><ci id="S2.E16.m1.11.11.1.1.1.1.2.2.1.cmml" xref="S2.E16.m1.11.11.1.1.1.1.2.2.1">~</ci><ci id="S2.E16.m1.11.11.1.1.1.1.2.2.2.cmml" xref="S2.E16.m1.11.11.1.1.1.1.2.2.2">𝛼</ci></apply><list id="S2.E16.m1.2.2.2.3.cmml" xref="S2.E16.m1.2.2.2.4"><ci id="S2.E16.m1.1.1.1.1.cmml" xref="S2.E16.m1.1.1.1.1">𝑠</ci><ci id="S2.E16.m1.2.2.2.2.cmml" xref="S2.E16.m1.2.2.2.2">𝑗</ci></list></apply><list id="S2.E16.m1.11.11.1.1.1.1.3.1.cmml" xref="S2.E16.m1.11.11.1.1.1.1.3.2"><apply id="S2.E16.m1.6.6.cmml" xref="S2.E16.m1.6.6"><divide id="S2.E16.m1.6.6.5.cmml" xref="S2.E16.m1.6.6"></divide><apply id="S2.E16.m1.4.4.2.cmml" xref="S2.E16.m1.4.4.2"><csymbol cd="ambiguous" id="S2.E16.m1.4.4.2.3.cmml" xref="S2.E16.m1.4.4.2">subscript</csymbol><ci id="S2.E16.m1.4.4.2.4.cmml" xref="S2.E16.m1.4.4.2.4">𝛼</ci><list id="S2.E16.m1.4.4.2.2.2.3.cmml" xref="S2.E16.m1.4.4.2.2.2.4"><ci id="S2.E16.m1.3.3.1.1.1.1.cmml" xref="S2.E16.m1.3.3.1.1.1.1">𝑠</ci><ci id="S2.E16.m1.4.4.2.2.2.2.cmml" xref="S2.E16.m1.4.4.2.2.2.2">𝑗</ci></list></apply><apply id="S2.E16.m1.6.6.4.cmml" xref="S2.E16.m1.6.6.4"><apply id="S2.E16.m1.6.6.4.3.cmml" xref="S2.E16.m1.6.6.4.3"><csymbol cd="ambiguous" id="S2.E16.m1.6.6.4.3.1.cmml" xref="S2.E16.m1.6.6.4.3">superscript</csymbol><apply id="S2.E16.m1.6.6.4.3.2.cmml" xref="S2.E16.m1.6.6.4.3"><csymbol cd="ambiguous" id="S2.E16.m1.6.6.4.3.2.1.cmml" xref="S2.E16.m1.6.6.4.3">subscript</csymbol><sum id="S2.E16.m1.6.6.4.3.2.2.cmml" xref="S2.E16.m1.6.6.4.3.2.2"></sum><apply id="S2.E16.m1.6.6.4.3.2.3.cmml" xref="S2.E16.m1.6.6.4.3.2.3"><eq id="S2.E16.m1.6.6.4.3.2.3.1.cmml" xref="S2.E16.m1.6.6.4.3.2.3.1"></eq><ci id="S2.E16.m1.6.6.4.3.2.3.2.cmml" xref="S2.E16.m1.6.6.4.3.2.3.2">𝑚</ci><cn type="integer" id="S2.E16.m1.6.6.4.3.2.3.3.cmml" xref="S2.E16.m1.6.6.4.3.2.3.3">1</cn></apply></apply><ci id="S2.E16.m1.6.6.4.3.3.cmml" xref="S2.E16.m1.6.6.4.3.3">𝑆</ci></apply><apply id="S2.E16.m1.6.6.4.4.cmml" xref="S2.E16.m1.6.6.4.4"><csymbol cd="ambiguous" id="S2.E16.m1.6.6.4.4.1.cmml" xref="S2.E16.m1.6.6.4.4">subscript</csymbol><ci id="S2.E16.m1.6.6.4.4.2.cmml" xref="S2.E16.m1.6.6.4.4.2">𝛼</ci><list id="S2.E16.m1.6.6.4.2.2.3.cmml" xref="S2.E16.m1.6.6.4.2.2.4"><ci id="S2.E16.m1.5.5.3.1.1.1.cmml" xref="S2.E16.m1.5.5.3.1.1.1">𝑠</ci><ci id="S2.E16.m1.6.6.4.2.2.2.cmml" xref="S2.E16.m1.6.6.4.2.2.2">𝑚</ci></list></apply></apply></apply><ci id="S2.E16.m1.10.10a.cmml" xref="S2.E16.m1.10.10"><mtext id="S2.E16.m1.10.10.cmml" xref="S2.E16.m1.10.10">with</mtext></ci></list></apply><apply id="S2.E16.m1.11.11.1.1.2.2.cmml" xref="S2.E16.m1.11.11.1.1.2.2"><csymbol cd="latexml" id="S2.E16.m1.11.11.1.1.2.2.1.cmml" xref="S2.E16.m1.11.11.1.1.2.2.1">assign</csymbol><apply id="S2.E16.m1.11.11.1.1.2.2.2.cmml" xref="S2.E16.m1.11.11.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.E16.m1.11.11.1.1.2.2.2.1.cmml" xref="S2.E16.m1.11.11.1.1.2.2.2">subscript</csymbol><ci id="S2.E16.m1.11.11.1.1.2.2.2.2.cmml" xref="S2.E16.m1.11.11.1.1.2.2.2.2">𝛼</ci><list id="S2.E16.m1.8.8.2.3.cmml" xref="S2.E16.m1.8.8.2.4"><ci id="S2.E16.m1.7.7.1.1.cmml" xref="S2.E16.m1.7.7.1.1">𝑠</ci><ci id="S2.E16.m1.8.8.2.2.cmml" xref="S2.E16.m1.8.8.2.2">𝑗</ci></list></apply><apply id="S2.E16.m1.11.11.1.1.2.2.3.cmml" xref="S2.E16.m1.11.11.1.1.2.2.3"><csymbol cd="ambiguous" id="S2.E16.m1.11.11.1.1.2.2.3.1.cmml" xref="S2.E16.m1.11.11.1.1.2.2.3">superscript</csymbol><ci id="S2.E16.m1.11.11.1.1.2.2.3.2a.cmml" xref="S2.E16.m1.11.11.1.1.2.2.3.2"><mtext id="S2.E16.m1.11.11.1.1.2.2.3.2.cmml" xref="S2.E16.m1.11.11.1.1.2.2.3.2">e</mtext></ci><apply id="S2.E16.m1.9.9.1.cmml" xref="S2.E16.m1.9.9.1"><minus id="S2.E16.m1.9.9.1.2.cmml" xref="S2.E16.m1.9.9.1.2"></minus><apply id="S2.E16.m1.9.9.1.1.cmml" xref="S2.E16.m1.9.9.1.1"><csymbol cd="ambiguous" id="S2.E16.m1.9.9.1.1.2.cmml" xref="S2.E16.m1.9.9.1.1">superscript</csymbol><apply id="S2.E16.m1.9.9.1.1.1.1.1.cmml" xref="S2.E16.m1.9.9.1.1.1.1"><minus id="S2.E16.m1.9.9.1.1.1.1.1.3.cmml" xref="S2.E16.m1.9.9.1.1.1.1.1.3"></minus><apply id="S2.E16.m1.9.9.1.1.1.1.1.1.cmml" xref="S2.E16.m1.9.9.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E16.m1.9.9.1.1.1.1.1.1.2.cmml" xref="S2.E16.m1.9.9.1.1.1.1.1.1">subscript</csymbol><apply id="S2.E16.m1.9.9.1.1.1.1.1.1.1.2.cmml" xref="S2.E16.m1.9.9.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E16.m1.9.9.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E16.m1.9.9.1.1.1.1.1.1.1.1.2">delimited-⟨⟩</csymbol><apply id="S2.E16.m1.9.9.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E16.m1.9.9.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E16.m1.9.9.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E16.m1.9.9.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E16.m1.9.9.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E16.m1.9.9.1.1.1.1.1.1.1.1.1.2">𝑍</ci><ci id="S2.E16.m1.9.9.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E16.m1.9.9.1.1.1.1.1.1.1.1.1.3">𝑞</ci></apply></apply><ci id="S2.E16.m1.9.9.1.1.1.1.1.1.3.cmml" xref="S2.E16.m1.9.9.1.1.1.1.1.1.3">𝑠</ci></apply><apply id="S2.E16.m1.9.9.1.1.1.1.1.2.cmml" xref="S2.E16.m1.9.9.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E16.m1.9.9.1.1.1.1.1.2.2.cmml" xref="S2.E16.m1.9.9.1.1.1.1.1.2">subscript</csymbol><apply id="S2.E16.m1.9.9.1.1.1.1.1.2.1.2.cmml" xref="S2.E16.m1.9.9.1.1.1.1.1.2.1.1"><csymbol cd="latexml" id="S2.E16.m1.9.9.1.1.1.1.1.2.1.2.1.cmml" xref="S2.E16.m1.9.9.1.1.1.1.1.2.1.1.2">delimited-⟨⟩</csymbol><apply id="S2.E16.m1.9.9.1.1.1.1.1.2.1.1.1.cmml" xref="S2.E16.m1.9.9.1.1.1.1.1.2.1.1.1"><csymbol cd="ambiguous" id="S2.E16.m1.9.9.1.1.1.1.1.2.1.1.1.1.cmml" xref="S2.E16.m1.9.9.1.1.1.1.1.2.1.1.1">subscript</csymbol><ci id="S2.E16.m1.9.9.1.1.1.1.1.2.1.1.1.2.cmml" xref="S2.E16.m1.9.9.1.1.1.1.1.2.1.1.1.2">𝑍</ci><ci id="S2.E16.m1.9.9.1.1.1.1.1.2.1.1.1.3.cmml" xref="S2.E16.m1.9.9.1.1.1.1.1.2.1.1.1.3">𝑘</ci></apply></apply><ci id="S2.E16.m1.9.9.1.1.1.1.1.2.3.cmml" xref="S2.E16.m1.9.9.1.1.1.1.1.2.3">𝑗</ci></apply></apply><cn type="integer" id="S2.E16.m1.9.9.1.1.3.cmml" xref="S2.E16.m1.9.9.1.1.3">2</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E16.m1.11c">\displaystyle\tilde{\alpha}_{s,j}=\frac{\alpha_{s,j}}{\sum_{m=1}^{S}\alpha_{s,%
m}}\qquad\text{with}\qquad\alpha_{s,j}:=\text{e}^{-(\langle Z_{q}\rangle_{s}-%
\langle Z_{k}\rangle_{j})^{2}}.</annotation><annotation encoding="application/x-llamapun" id="S2.E16.m1.11d">over~ start_ARG italic_α end_ARG start_POSTSUBSCRIPT italic_s , italic_j end_POSTSUBSCRIPT = divide start_ARG italic_α start_POSTSUBSCRIPT italic_s , italic_j end_POSTSUBSCRIPT end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_m = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_S end_POSTSUPERSCRIPT italic_α start_POSTSUBSCRIPT italic_s , italic_m end_POSTSUBSCRIPT end_ARG with italic_α start_POSTSUBSCRIPT italic_s , italic_j end_POSTSUBSCRIPT := e start_POSTSUPERSCRIPT - ( ⟨ italic_Z start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT ⟩ start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT - ⟨ italic_Z start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ⟩ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(16)</span></td>
</tr></tbody>
</table>
<p id="S2.SS1.p4.6" class="ltx_p">Here in Eq. (<a href="#S2.E15" title="(15) ‣ 2.1 Quantum Self-Attention Layer ‣ 2 Method ‣ Quantum Self-Attention Neural Networks for Text Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">15</span></a>), we adopt a residual scheme when computing the output, which is analogous to <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib36" title="" class="ltx_ref">36</a>]</cite>.</p>
</div>
<section id="S2.SS1.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.1.1 </span>Gaussian Projected Quantum Self-Attention</h4>

<div id="S2.SS1.SSS1.p1" class="ltx_para">
<p id="S2.SS1.SSS1.p1.13" class="ltx_p">When designing a quantum version of self-attention, a natural and direct extension of the inner-product self-attention to consider is <math id="S2.SS1.SSS1.p1.1.m1.3" class="ltx_Math" alttext="{\alpha}_{s,j}:=|\bra{\psi_{s}}U_{q}^{\dagger}U_{k}\ket{\psi_{j}}|^{2}" display="inline"><semantics id="S2.SS1.SSS1.p1.1.m1.3a"><mrow id="S2.SS1.SSS1.p1.1.m1.3.3" xref="S2.SS1.SSS1.p1.1.m1.3.3.cmml"><msub id="S2.SS1.SSS1.p1.1.m1.3.3.3" xref="S2.SS1.SSS1.p1.1.m1.3.3.3.cmml"><mi id="S2.SS1.SSS1.p1.1.m1.3.3.3.2" xref="S2.SS1.SSS1.p1.1.m1.3.3.3.2.cmml">α</mi><mrow id="S2.SS1.SSS1.p1.1.m1.2.2.2.4" xref="S2.SS1.SSS1.p1.1.m1.2.2.2.3.cmml"><mi id="S2.SS1.SSS1.p1.1.m1.1.1.1.1" xref="S2.SS1.SSS1.p1.1.m1.1.1.1.1.cmml">s</mi><mo id="S2.SS1.SSS1.p1.1.m1.2.2.2.4.1" xref="S2.SS1.SSS1.p1.1.m1.2.2.2.3.cmml">,</mo><mi id="S2.SS1.SSS1.p1.1.m1.2.2.2.2" xref="S2.SS1.SSS1.p1.1.m1.2.2.2.2.cmml">j</mi></mrow></msub><mo id="S2.SS1.SSS1.p1.1.m1.3.3.2" xref="S2.SS1.SSS1.p1.1.m1.3.3.2.cmml">:=</mo><msup id="S2.SS1.SSS1.p1.1.m1.3.3.1" xref="S2.SS1.SSS1.p1.1.m1.3.3.1.cmml"><mrow id="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1" xref="S2.SS1.SSS1.p1.1.m1.3.3.1.1.2.cmml"><mo fence="true" stretchy="false" id="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.2" xref="S2.SS1.SSS1.p1.1.m1.3.3.1.1.2.1.cmml">|</mo><mrow id="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1" xref="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.cmml"><merror class="ltx_ERROR undefined undefined" id="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.2" xref="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.2b.cmml"><mtext id="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.2a" xref="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.2b.cmml">\bra</mtext></merror><mo id="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.1" xref="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.1.cmml">⁢</mo><msub id="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.3" xref="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.3.cmml"><mi id="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.3.2" xref="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.3.2.cmml">ψ</mi><mi id="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.3.3" xref="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.3.3.cmml">s</mi></msub><mo id="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.1a" xref="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.1.cmml">⁢</mo><msubsup id="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.4" xref="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.4.cmml"><mi id="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.4.2.2" xref="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.4.2.2.cmml">U</mi><mi id="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.4.2.3" xref="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.4.2.3.cmml">q</mi><mo id="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.4.3" xref="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.4.3.cmml">†</mo></msubsup><mo id="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.1b" xref="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.1.cmml">⁢</mo><msub id="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.5" xref="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.5.cmml"><mi id="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.5.2" xref="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.5.2.cmml">U</mi><mi id="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.5.3" xref="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.5.3.cmml">k</mi></msub><mo id="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.1c" xref="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.1.cmml">⁢</mo><merror class="ltx_ERROR undefined undefined" id="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.6" xref="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.6b.cmml"><mtext id="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.6a" xref="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.6b.cmml">\ket</mtext></merror><mo id="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.1d" xref="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.1.cmml">⁢</mo><msub id="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.7" xref="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.7.cmml"><mi id="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.7.2" xref="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.7.2.cmml">ψ</mi><mi id="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.7.3" xref="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.7.3.cmml">j</mi></msub></mrow><mo fence="true" stretchy="false" id="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.3" xref="S2.SS1.SSS1.p1.1.m1.3.3.1.1.2.1.cmml">|</mo></mrow><mn id="S2.SS1.SSS1.p1.1.m1.3.3.1.3" xref="S2.SS1.SSS1.p1.1.m1.3.3.1.3.cmml">2</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS1.p1.1.m1.3b"><apply id="S2.SS1.SSS1.p1.1.m1.3.3.cmml" xref="S2.SS1.SSS1.p1.1.m1.3.3"><csymbol cd="latexml" id="S2.SS1.SSS1.p1.1.m1.3.3.2.cmml" xref="S2.SS1.SSS1.p1.1.m1.3.3.2">assign</csymbol><apply id="S2.SS1.SSS1.p1.1.m1.3.3.3.cmml" xref="S2.SS1.SSS1.p1.1.m1.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p1.1.m1.3.3.3.1.cmml" xref="S2.SS1.SSS1.p1.1.m1.3.3.3">subscript</csymbol><ci id="S2.SS1.SSS1.p1.1.m1.3.3.3.2.cmml" xref="S2.SS1.SSS1.p1.1.m1.3.3.3.2">𝛼</ci><list id="S2.SS1.SSS1.p1.1.m1.2.2.2.3.cmml" xref="S2.SS1.SSS1.p1.1.m1.2.2.2.4"><ci id="S2.SS1.SSS1.p1.1.m1.1.1.1.1.cmml" xref="S2.SS1.SSS1.p1.1.m1.1.1.1.1">𝑠</ci><ci id="S2.SS1.SSS1.p1.1.m1.2.2.2.2.cmml" xref="S2.SS1.SSS1.p1.1.m1.2.2.2.2">𝑗</ci></list></apply><apply id="S2.SS1.SSS1.p1.1.m1.3.3.1.cmml" xref="S2.SS1.SSS1.p1.1.m1.3.3.1"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p1.1.m1.3.3.1.2.cmml" xref="S2.SS1.SSS1.p1.1.m1.3.3.1">superscript</csymbol><apply id="S2.SS1.SSS1.p1.1.m1.3.3.1.1.2.cmml" xref="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1"><abs id="S2.SS1.SSS1.p1.1.m1.3.3.1.1.2.1.cmml" xref="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.2"></abs><apply id="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.cmml" xref="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1"><times id="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.1.cmml" xref="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.1"></times><ci id="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.2b.cmml" xref="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.2"><merror class="ltx_ERROR undefined undefined" id="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.2.cmml" xref="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.2"><mtext id="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.2a.cmml" xref="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.2">\bra</mtext></merror></ci><apply id="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.3.cmml" xref="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.3.1.cmml" xref="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.3">subscript</csymbol><ci id="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.3.2.cmml" xref="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.3.2">𝜓</ci><ci id="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.3.3.cmml" xref="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.3.3">𝑠</ci></apply><apply id="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.4.cmml" xref="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.4.1.cmml" xref="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.4">superscript</csymbol><apply id="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.4.2.cmml" xref="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.4.2.1.cmml" xref="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.4">subscript</csymbol><ci id="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.4.2.2.cmml" xref="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.4.2.2">𝑈</ci><ci id="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.4.2.3.cmml" xref="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.4.2.3">𝑞</ci></apply><ci id="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.4.3.cmml" xref="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.4.3">†</ci></apply><apply id="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.5.cmml" xref="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.5"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.5.1.cmml" xref="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.5">subscript</csymbol><ci id="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.5.2.cmml" xref="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.5.2">𝑈</ci><ci id="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.5.3.cmml" xref="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.5.3">𝑘</ci></apply><ci id="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.6b.cmml" xref="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.6"><merror class="ltx_ERROR undefined undefined" id="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.6.cmml" xref="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.6"><mtext id="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.6a.cmml" xref="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.6">\ket</mtext></merror></ci><apply id="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.7.cmml" xref="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.7"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.7.1.cmml" xref="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.7">subscript</csymbol><ci id="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.7.2.cmml" xref="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.7.2">𝜓</ci><ci id="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.7.3.cmml" xref="S2.SS1.SSS1.p1.1.m1.3.3.1.1.1.1.7.3">𝑗</ci></apply></apply></apply><cn type="integer" id="S2.SS1.SSS1.p1.1.m1.3.3.1.3.cmml" xref="S2.SS1.SSS1.p1.1.m1.3.3.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS1.p1.1.m1.3c">{\alpha}_{s,j}:=|\bra{\psi_{s}}U_{q}^{\dagger}U_{k}\ket{\psi_{j}}|^{2}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS1.p1.1.m1.3d">italic_α start_POSTSUBSCRIPT italic_s , italic_j end_POSTSUBSCRIPT := | italic_ψ start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT italic_U start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT start_POSTSUPERSCRIPT † end_POSTSUPERSCRIPT italic_U start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT italic_ψ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT | start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math>.
However, due to the unitary nature of quantum circuits, <math id="S2.SS1.SSS1.p1.2.m2.1" class="ltx_Math" alttext="\bra{\psi_{s}}U_{q}^{\dagger}U_{k}" display="inline"><semantics id="S2.SS1.SSS1.p1.2.m2.1a"><mrow id="S2.SS1.SSS1.p1.2.m2.1.1" xref="S2.SS1.SSS1.p1.2.m2.1.1.cmml"><merror class="ltx_ERROR undefined undefined" id="S2.SS1.SSS1.p1.2.m2.1.1.2" xref="S2.SS1.SSS1.p1.2.m2.1.1.2b.cmml"><mtext id="S2.SS1.SSS1.p1.2.m2.1.1.2a" xref="S2.SS1.SSS1.p1.2.m2.1.1.2b.cmml">\bra</mtext></merror><mo id="S2.SS1.SSS1.p1.2.m2.1.1.1" xref="S2.SS1.SSS1.p1.2.m2.1.1.1.cmml">⁢</mo><msub id="S2.SS1.SSS1.p1.2.m2.1.1.3" xref="S2.SS1.SSS1.p1.2.m2.1.1.3.cmml"><mi id="S2.SS1.SSS1.p1.2.m2.1.1.3.2" xref="S2.SS1.SSS1.p1.2.m2.1.1.3.2.cmml">ψ</mi><mi id="S2.SS1.SSS1.p1.2.m2.1.1.3.3" xref="S2.SS1.SSS1.p1.2.m2.1.1.3.3.cmml">s</mi></msub><mo id="S2.SS1.SSS1.p1.2.m2.1.1.1a" xref="S2.SS1.SSS1.p1.2.m2.1.1.1.cmml">⁢</mo><msubsup id="S2.SS1.SSS1.p1.2.m2.1.1.4" xref="S2.SS1.SSS1.p1.2.m2.1.1.4.cmml"><mi id="S2.SS1.SSS1.p1.2.m2.1.1.4.2.2" xref="S2.SS1.SSS1.p1.2.m2.1.1.4.2.2.cmml">U</mi><mi id="S2.SS1.SSS1.p1.2.m2.1.1.4.2.3" xref="S2.SS1.SSS1.p1.2.m2.1.1.4.2.3.cmml">q</mi><mo id="S2.SS1.SSS1.p1.2.m2.1.1.4.3" xref="S2.SS1.SSS1.p1.2.m2.1.1.4.3.cmml">†</mo></msubsup><mo id="S2.SS1.SSS1.p1.2.m2.1.1.1b" xref="S2.SS1.SSS1.p1.2.m2.1.1.1.cmml">⁢</mo><msub id="S2.SS1.SSS1.p1.2.m2.1.1.5" xref="S2.SS1.SSS1.p1.2.m2.1.1.5.cmml"><mi id="S2.SS1.SSS1.p1.2.m2.1.1.5.2" xref="S2.SS1.SSS1.p1.2.m2.1.1.5.2.cmml">U</mi><mi id="S2.SS1.SSS1.p1.2.m2.1.1.5.3" xref="S2.SS1.SSS1.p1.2.m2.1.1.5.3.cmml">k</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS1.p1.2.m2.1b"><apply id="S2.SS1.SSS1.p1.2.m2.1.1.cmml" xref="S2.SS1.SSS1.p1.2.m2.1.1"><times id="S2.SS1.SSS1.p1.2.m2.1.1.1.cmml" xref="S2.SS1.SSS1.p1.2.m2.1.1.1"></times><ci id="S2.SS1.SSS1.p1.2.m2.1.1.2b.cmml" xref="S2.SS1.SSS1.p1.2.m2.1.1.2"><merror class="ltx_ERROR undefined undefined" id="S2.SS1.SSS1.p1.2.m2.1.1.2.cmml" xref="S2.SS1.SSS1.p1.2.m2.1.1.2"><mtext id="S2.SS1.SSS1.p1.2.m2.1.1.2a.cmml" xref="S2.SS1.SSS1.p1.2.m2.1.1.2">\bra</mtext></merror></ci><apply id="S2.SS1.SSS1.p1.2.m2.1.1.3.cmml" xref="S2.SS1.SSS1.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p1.2.m2.1.1.3.1.cmml" xref="S2.SS1.SSS1.p1.2.m2.1.1.3">subscript</csymbol><ci id="S2.SS1.SSS1.p1.2.m2.1.1.3.2.cmml" xref="S2.SS1.SSS1.p1.2.m2.1.1.3.2">𝜓</ci><ci id="S2.SS1.SSS1.p1.2.m2.1.1.3.3.cmml" xref="S2.SS1.SSS1.p1.2.m2.1.1.3.3">𝑠</ci></apply><apply id="S2.SS1.SSS1.p1.2.m2.1.1.4.cmml" xref="S2.SS1.SSS1.p1.2.m2.1.1.4"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p1.2.m2.1.1.4.1.cmml" xref="S2.SS1.SSS1.p1.2.m2.1.1.4">superscript</csymbol><apply id="S2.SS1.SSS1.p1.2.m2.1.1.4.2.cmml" xref="S2.SS1.SSS1.p1.2.m2.1.1.4"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p1.2.m2.1.1.4.2.1.cmml" xref="S2.SS1.SSS1.p1.2.m2.1.1.4">subscript</csymbol><ci id="S2.SS1.SSS1.p1.2.m2.1.1.4.2.2.cmml" xref="S2.SS1.SSS1.p1.2.m2.1.1.4.2.2">𝑈</ci><ci id="S2.SS1.SSS1.p1.2.m2.1.1.4.2.3.cmml" xref="S2.SS1.SSS1.p1.2.m2.1.1.4.2.3">𝑞</ci></apply><ci id="S2.SS1.SSS1.p1.2.m2.1.1.4.3.cmml" xref="S2.SS1.SSS1.p1.2.m2.1.1.4.3">†</ci></apply><apply id="S2.SS1.SSS1.p1.2.m2.1.1.5.cmml" xref="S2.SS1.SSS1.p1.2.m2.1.1.5"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p1.2.m2.1.1.5.1.cmml" xref="S2.SS1.SSS1.p1.2.m2.1.1.5">subscript</csymbol><ci id="S2.SS1.SSS1.p1.2.m2.1.1.5.2.cmml" xref="S2.SS1.SSS1.p1.2.m2.1.1.5.2">𝑈</ci><ci id="S2.SS1.SSS1.p1.2.m2.1.1.5.3.cmml" xref="S2.SS1.SSS1.p1.2.m2.1.1.5.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS1.p1.2.m2.1c">\bra{\psi_{s}}U_{q}^{\dagger}U_{k}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS1.p1.2.m2.1d">italic_ψ start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT italic_U start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT start_POSTSUPERSCRIPT † end_POSTSUPERSCRIPT italic_U start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> can be regarded as rotating <math id="S2.SS1.SSS1.p1.3.m3.1" class="ltx_Math" alttext="\ket{\psi_{s}}" display="inline"><semantics id="S2.SS1.SSS1.p1.3.m3.1a"><mrow id="S2.SS1.SSS1.p1.3.m3.1.1" xref="S2.SS1.SSS1.p1.3.m3.1.1.cmml"><merror class="ltx_ERROR undefined undefined" id="S2.SS1.SSS1.p1.3.m3.1.1.2" xref="S2.SS1.SSS1.p1.3.m3.1.1.2b.cmml"><mtext id="S2.SS1.SSS1.p1.3.m3.1.1.2a" xref="S2.SS1.SSS1.p1.3.m3.1.1.2b.cmml">\ket</mtext></merror><mo id="S2.SS1.SSS1.p1.3.m3.1.1.1" xref="S2.SS1.SSS1.p1.3.m3.1.1.1.cmml">⁢</mo><msub id="S2.SS1.SSS1.p1.3.m3.1.1.3" xref="S2.SS1.SSS1.p1.3.m3.1.1.3.cmml"><mi id="S2.SS1.SSS1.p1.3.m3.1.1.3.2" xref="S2.SS1.SSS1.p1.3.m3.1.1.3.2.cmml">ψ</mi><mi id="S2.SS1.SSS1.p1.3.m3.1.1.3.3" xref="S2.SS1.SSS1.p1.3.m3.1.1.3.3.cmml">s</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS1.p1.3.m3.1b"><apply id="S2.SS1.SSS1.p1.3.m3.1.1.cmml" xref="S2.SS1.SSS1.p1.3.m3.1.1"><times id="S2.SS1.SSS1.p1.3.m3.1.1.1.cmml" xref="S2.SS1.SSS1.p1.3.m3.1.1.1"></times><ci id="S2.SS1.SSS1.p1.3.m3.1.1.2b.cmml" xref="S2.SS1.SSS1.p1.3.m3.1.1.2"><merror class="ltx_ERROR undefined undefined" id="S2.SS1.SSS1.p1.3.m3.1.1.2.cmml" xref="S2.SS1.SSS1.p1.3.m3.1.1.2"><mtext id="S2.SS1.SSS1.p1.3.m3.1.1.2a.cmml" xref="S2.SS1.SSS1.p1.3.m3.1.1.2">\ket</mtext></merror></ci><apply id="S2.SS1.SSS1.p1.3.m3.1.1.3.cmml" xref="S2.SS1.SSS1.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p1.3.m3.1.1.3.1.cmml" xref="S2.SS1.SSS1.p1.3.m3.1.1.3">subscript</csymbol><ci id="S2.SS1.SSS1.p1.3.m3.1.1.3.2.cmml" xref="S2.SS1.SSS1.p1.3.m3.1.1.3.2">𝜓</ci><ci id="S2.SS1.SSS1.p1.3.m3.1.1.3.3.cmml" xref="S2.SS1.SSS1.p1.3.m3.1.1.3.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS1.p1.3.m3.1c">\ket{\psi_{s}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS1.p1.3.m3.1d">italic_ψ start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> by an angle, which makes it difficult for <math id="S2.SS1.SSS1.p1.4.m4.1" class="ltx_Math" alttext="\ket{\psi_{s}}" display="inline"><semantics id="S2.SS1.SSS1.p1.4.m4.1a"><mrow id="S2.SS1.SSS1.p1.4.m4.1.1" xref="S2.SS1.SSS1.p1.4.m4.1.1.cmml"><merror class="ltx_ERROR undefined undefined" id="S2.SS1.SSS1.p1.4.m4.1.1.2" xref="S2.SS1.SSS1.p1.4.m4.1.1.2b.cmml"><mtext id="S2.SS1.SSS1.p1.4.m4.1.1.2a" xref="S2.SS1.SSS1.p1.4.m4.1.1.2b.cmml">\ket</mtext></merror><mo id="S2.SS1.SSS1.p1.4.m4.1.1.1" xref="S2.SS1.SSS1.p1.4.m4.1.1.1.cmml">⁢</mo><msub id="S2.SS1.SSS1.p1.4.m4.1.1.3" xref="S2.SS1.SSS1.p1.4.m4.1.1.3.cmml"><mi id="S2.SS1.SSS1.p1.4.m4.1.1.3.2" xref="S2.SS1.SSS1.p1.4.m4.1.1.3.2.cmml">ψ</mi><mi id="S2.SS1.SSS1.p1.4.m4.1.1.3.3" xref="S2.SS1.SSS1.p1.4.m4.1.1.3.3.cmml">s</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS1.p1.4.m4.1b"><apply id="S2.SS1.SSS1.p1.4.m4.1.1.cmml" xref="S2.SS1.SSS1.p1.4.m4.1.1"><times id="S2.SS1.SSS1.p1.4.m4.1.1.1.cmml" xref="S2.SS1.SSS1.p1.4.m4.1.1.1"></times><ci id="S2.SS1.SSS1.p1.4.m4.1.1.2b.cmml" xref="S2.SS1.SSS1.p1.4.m4.1.1.2"><merror class="ltx_ERROR undefined undefined" id="S2.SS1.SSS1.p1.4.m4.1.1.2.cmml" xref="S2.SS1.SSS1.p1.4.m4.1.1.2"><mtext id="S2.SS1.SSS1.p1.4.m4.1.1.2a.cmml" xref="S2.SS1.SSS1.p1.4.m4.1.1.2">\ket</mtext></merror></ci><apply id="S2.SS1.SSS1.p1.4.m4.1.1.3.cmml" xref="S2.SS1.SSS1.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p1.4.m4.1.1.3.1.cmml" xref="S2.SS1.SSS1.p1.4.m4.1.1.3">subscript</csymbol><ci id="S2.SS1.SSS1.p1.4.m4.1.1.3.2.cmml" xref="S2.SS1.SSS1.p1.4.m4.1.1.3.2">𝜓</ci><ci id="S2.SS1.SSS1.p1.4.m4.1.1.3.3.cmml" xref="S2.SS1.SSS1.p1.4.m4.1.1.3.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS1.p1.4.m4.1c">\ket{\psi_{s}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS1.p1.4.m4.1d">italic_ψ start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> to simultaneously correlate those <math id="S2.SS1.SSS1.p1.5.m5.1" class="ltx_Math" alttext="\ket{\psi_{j}}" display="inline"><semantics id="S2.SS1.SSS1.p1.5.m5.1a"><mrow id="S2.SS1.SSS1.p1.5.m5.1.1" xref="S2.SS1.SSS1.p1.5.m5.1.1.cmml"><merror class="ltx_ERROR undefined undefined" id="S2.SS1.SSS1.p1.5.m5.1.1.2" xref="S2.SS1.SSS1.p1.5.m5.1.1.2b.cmml"><mtext id="S2.SS1.SSS1.p1.5.m5.1.1.2a" xref="S2.SS1.SSS1.p1.5.m5.1.1.2b.cmml">\ket</mtext></merror><mo id="S2.SS1.SSS1.p1.5.m5.1.1.1" xref="S2.SS1.SSS1.p1.5.m5.1.1.1.cmml">⁢</mo><msub id="S2.SS1.SSS1.p1.5.m5.1.1.3" xref="S2.SS1.SSS1.p1.5.m5.1.1.3.cmml"><mi id="S2.SS1.SSS1.p1.5.m5.1.1.3.2" xref="S2.SS1.SSS1.p1.5.m5.1.1.3.2.cmml">ψ</mi><mi id="S2.SS1.SSS1.p1.5.m5.1.1.3.3" xref="S2.SS1.SSS1.p1.5.m5.1.1.3.3.cmml">j</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS1.p1.5.m5.1b"><apply id="S2.SS1.SSS1.p1.5.m5.1.1.cmml" xref="S2.SS1.SSS1.p1.5.m5.1.1"><times id="S2.SS1.SSS1.p1.5.m5.1.1.1.cmml" xref="S2.SS1.SSS1.p1.5.m5.1.1.1"></times><ci id="S2.SS1.SSS1.p1.5.m5.1.1.2b.cmml" xref="S2.SS1.SSS1.p1.5.m5.1.1.2"><merror class="ltx_ERROR undefined undefined" id="S2.SS1.SSS1.p1.5.m5.1.1.2.cmml" xref="S2.SS1.SSS1.p1.5.m5.1.1.2"><mtext id="S2.SS1.SSS1.p1.5.m5.1.1.2a.cmml" xref="S2.SS1.SSS1.p1.5.m5.1.1.2">\ket</mtext></merror></ci><apply id="S2.SS1.SSS1.p1.5.m5.1.1.3.cmml" xref="S2.SS1.SSS1.p1.5.m5.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p1.5.m5.1.1.3.1.cmml" xref="S2.SS1.SSS1.p1.5.m5.1.1.3">subscript</csymbol><ci id="S2.SS1.SSS1.p1.5.m5.1.1.3.2.cmml" xref="S2.SS1.SSS1.p1.5.m5.1.1.3.2">𝜓</ci><ci id="S2.SS1.SSS1.p1.5.m5.1.1.3.3.cmml" xref="S2.SS1.SSS1.p1.5.m5.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS1.p1.5.m5.1c">\ket{\psi_{j}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS1.p1.5.m5.1d">italic_ψ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> that are far away. In a word, this direct extension is not suitable or reasonable for working as the quantum self-attention.
Instead, the particular quantum self-attention proposed in Eq. (<a href="#S2.E16" title="(16) ‣ 2.1 Quantum Self-Attention Layer ‣ 2 Method ‣ Quantum Self-Attention Neural Networks for Text Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">16</span></a>), which we call <span id="S2.SS1.SSS1.p1.13.1" class="ltx_text ltx_font_italic">Gaussian projected quantum self-attention</span> (GPQSA), could overcome the above drawback. In GPQSA, the states <math id="S2.SS1.SSS1.p1.6.m6.1" class="ltx_Math" alttext="U_{q}\ket{\psi_{s}}" display="inline"><semantics id="S2.SS1.SSS1.p1.6.m6.1a"><mrow id="S2.SS1.SSS1.p1.6.m6.1.1" xref="S2.SS1.SSS1.p1.6.m6.1.1.cmml"><msub id="S2.SS1.SSS1.p1.6.m6.1.1.2" xref="S2.SS1.SSS1.p1.6.m6.1.1.2.cmml"><mi id="S2.SS1.SSS1.p1.6.m6.1.1.2.2" xref="S2.SS1.SSS1.p1.6.m6.1.1.2.2.cmml">U</mi><mi id="S2.SS1.SSS1.p1.6.m6.1.1.2.3" xref="S2.SS1.SSS1.p1.6.m6.1.1.2.3.cmml">q</mi></msub><mo id="S2.SS1.SSS1.p1.6.m6.1.1.1" xref="S2.SS1.SSS1.p1.6.m6.1.1.1.cmml">⁢</mo><merror class="ltx_ERROR undefined undefined" id="S2.SS1.SSS1.p1.6.m6.1.1.3" xref="S2.SS1.SSS1.p1.6.m6.1.1.3b.cmml"><mtext id="S2.SS1.SSS1.p1.6.m6.1.1.3a" xref="S2.SS1.SSS1.p1.6.m6.1.1.3b.cmml">\ket</mtext></merror><mo id="S2.SS1.SSS1.p1.6.m6.1.1.1a" xref="S2.SS1.SSS1.p1.6.m6.1.1.1.cmml">⁢</mo><msub id="S2.SS1.SSS1.p1.6.m6.1.1.4" xref="S2.SS1.SSS1.p1.6.m6.1.1.4.cmml"><mi id="S2.SS1.SSS1.p1.6.m6.1.1.4.2" xref="S2.SS1.SSS1.p1.6.m6.1.1.4.2.cmml">ψ</mi><mi id="S2.SS1.SSS1.p1.6.m6.1.1.4.3" xref="S2.SS1.SSS1.p1.6.m6.1.1.4.3.cmml">s</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS1.p1.6.m6.1b"><apply id="S2.SS1.SSS1.p1.6.m6.1.1.cmml" xref="S2.SS1.SSS1.p1.6.m6.1.1"><times id="S2.SS1.SSS1.p1.6.m6.1.1.1.cmml" xref="S2.SS1.SSS1.p1.6.m6.1.1.1"></times><apply id="S2.SS1.SSS1.p1.6.m6.1.1.2.cmml" xref="S2.SS1.SSS1.p1.6.m6.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p1.6.m6.1.1.2.1.cmml" xref="S2.SS1.SSS1.p1.6.m6.1.1.2">subscript</csymbol><ci id="S2.SS1.SSS1.p1.6.m6.1.1.2.2.cmml" xref="S2.SS1.SSS1.p1.6.m6.1.1.2.2">𝑈</ci><ci id="S2.SS1.SSS1.p1.6.m6.1.1.2.3.cmml" xref="S2.SS1.SSS1.p1.6.m6.1.1.2.3">𝑞</ci></apply><ci id="S2.SS1.SSS1.p1.6.m6.1.1.3b.cmml" xref="S2.SS1.SSS1.p1.6.m6.1.1.3"><merror class="ltx_ERROR undefined undefined" id="S2.SS1.SSS1.p1.6.m6.1.1.3.cmml" xref="S2.SS1.SSS1.p1.6.m6.1.1.3"><mtext id="S2.SS1.SSS1.p1.6.m6.1.1.3a.cmml" xref="S2.SS1.SSS1.p1.6.m6.1.1.3">\ket</mtext></merror></ci><apply id="S2.SS1.SSS1.p1.6.m6.1.1.4.cmml" xref="S2.SS1.SSS1.p1.6.m6.1.1.4"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p1.6.m6.1.1.4.1.cmml" xref="S2.SS1.SSS1.p1.6.m6.1.1.4">subscript</csymbol><ci id="S2.SS1.SSS1.p1.6.m6.1.1.4.2.cmml" xref="S2.SS1.SSS1.p1.6.m6.1.1.4.2">𝜓</ci><ci id="S2.SS1.SSS1.p1.6.m6.1.1.4.3.cmml" xref="S2.SS1.SSS1.p1.6.m6.1.1.4.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS1.p1.6.m6.1c">U_{q}\ket{\psi_{s}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS1.p1.6.m6.1d">italic_U start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT italic_ψ start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> (and <math id="S2.SS1.SSS1.p1.7.m7.1" class="ltx_Math" alttext="U_{k}\ket{\psi_{j}}" display="inline"><semantics id="S2.SS1.SSS1.p1.7.m7.1a"><mrow id="S2.SS1.SSS1.p1.7.m7.1.1" xref="S2.SS1.SSS1.p1.7.m7.1.1.cmml"><msub id="S2.SS1.SSS1.p1.7.m7.1.1.2" xref="S2.SS1.SSS1.p1.7.m7.1.1.2.cmml"><mi id="S2.SS1.SSS1.p1.7.m7.1.1.2.2" xref="S2.SS1.SSS1.p1.7.m7.1.1.2.2.cmml">U</mi><mi id="S2.SS1.SSS1.p1.7.m7.1.1.2.3" xref="S2.SS1.SSS1.p1.7.m7.1.1.2.3.cmml">k</mi></msub><mo id="S2.SS1.SSS1.p1.7.m7.1.1.1" xref="S2.SS1.SSS1.p1.7.m7.1.1.1.cmml">⁢</mo><merror class="ltx_ERROR undefined undefined" id="S2.SS1.SSS1.p1.7.m7.1.1.3" xref="S2.SS1.SSS1.p1.7.m7.1.1.3b.cmml"><mtext id="S2.SS1.SSS1.p1.7.m7.1.1.3a" xref="S2.SS1.SSS1.p1.7.m7.1.1.3b.cmml">\ket</mtext></merror><mo id="S2.SS1.SSS1.p1.7.m7.1.1.1a" xref="S2.SS1.SSS1.p1.7.m7.1.1.1.cmml">⁢</mo><msub id="S2.SS1.SSS1.p1.7.m7.1.1.4" xref="S2.SS1.SSS1.p1.7.m7.1.1.4.cmml"><mi id="S2.SS1.SSS1.p1.7.m7.1.1.4.2" xref="S2.SS1.SSS1.p1.7.m7.1.1.4.2.cmml">ψ</mi><mi id="S2.SS1.SSS1.p1.7.m7.1.1.4.3" xref="S2.SS1.SSS1.p1.7.m7.1.1.4.3.cmml">j</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS1.p1.7.m7.1b"><apply id="S2.SS1.SSS1.p1.7.m7.1.1.cmml" xref="S2.SS1.SSS1.p1.7.m7.1.1"><times id="S2.SS1.SSS1.p1.7.m7.1.1.1.cmml" xref="S2.SS1.SSS1.p1.7.m7.1.1.1"></times><apply id="S2.SS1.SSS1.p1.7.m7.1.1.2.cmml" xref="S2.SS1.SSS1.p1.7.m7.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p1.7.m7.1.1.2.1.cmml" xref="S2.SS1.SSS1.p1.7.m7.1.1.2">subscript</csymbol><ci id="S2.SS1.SSS1.p1.7.m7.1.1.2.2.cmml" xref="S2.SS1.SSS1.p1.7.m7.1.1.2.2">𝑈</ci><ci id="S2.SS1.SSS1.p1.7.m7.1.1.2.3.cmml" xref="S2.SS1.SSS1.p1.7.m7.1.1.2.3">𝑘</ci></apply><ci id="S2.SS1.SSS1.p1.7.m7.1.1.3b.cmml" xref="S2.SS1.SSS1.p1.7.m7.1.1.3"><merror class="ltx_ERROR undefined undefined" id="S2.SS1.SSS1.p1.7.m7.1.1.3.cmml" xref="S2.SS1.SSS1.p1.7.m7.1.1.3"><mtext id="S2.SS1.SSS1.p1.7.m7.1.1.3a.cmml" xref="S2.SS1.SSS1.p1.7.m7.1.1.3">\ket</mtext></merror></ci><apply id="S2.SS1.SSS1.p1.7.m7.1.1.4.cmml" xref="S2.SS1.SSS1.p1.7.m7.1.1.4"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p1.7.m7.1.1.4.1.cmml" xref="S2.SS1.SSS1.p1.7.m7.1.1.4">subscript</csymbol><ci id="S2.SS1.SSS1.p1.7.m7.1.1.4.2.cmml" xref="S2.SS1.SSS1.p1.7.m7.1.1.4.2">𝜓</ci><ci id="S2.SS1.SSS1.p1.7.m7.1.1.4.3.cmml" xref="S2.SS1.SSS1.p1.7.m7.1.1.4.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS1.p1.7.m7.1c">U_{k}\ket{\psi_{j}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS1.p1.7.m7.1d">italic_U start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT italic_ψ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>) in large quantum Hilbert space are projected to classical representations <math id="S2.SS1.SSS1.p1.8.m8.1" class="ltx_Math" alttext="\langle Z_{q}\rangle_{s}" display="inline"><semantics id="S2.SS1.SSS1.p1.8.m8.1a"><msub id="S2.SS1.SSS1.p1.8.m8.1.1" xref="S2.SS1.SSS1.p1.8.m8.1.1.cmml"><mrow id="S2.SS1.SSS1.p1.8.m8.1.1.1.1" xref="S2.SS1.SSS1.p1.8.m8.1.1.1.2.cmml"><mo stretchy="false" id="S2.SS1.SSS1.p1.8.m8.1.1.1.1.2" xref="S2.SS1.SSS1.p1.8.m8.1.1.1.2.1.cmml">⟨</mo><msub id="S2.SS1.SSS1.p1.8.m8.1.1.1.1.1" xref="S2.SS1.SSS1.p1.8.m8.1.1.1.1.1.cmml"><mi id="S2.SS1.SSS1.p1.8.m8.1.1.1.1.1.2" xref="S2.SS1.SSS1.p1.8.m8.1.1.1.1.1.2.cmml">Z</mi><mi id="S2.SS1.SSS1.p1.8.m8.1.1.1.1.1.3" xref="S2.SS1.SSS1.p1.8.m8.1.1.1.1.1.3.cmml">q</mi></msub><mo stretchy="false" id="S2.SS1.SSS1.p1.8.m8.1.1.1.1.3" xref="S2.SS1.SSS1.p1.8.m8.1.1.1.2.1.cmml">⟩</mo></mrow><mi id="S2.SS1.SSS1.p1.8.m8.1.1.3" xref="S2.SS1.SSS1.p1.8.m8.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS1.p1.8.m8.1b"><apply id="S2.SS1.SSS1.p1.8.m8.1.1.cmml" xref="S2.SS1.SSS1.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p1.8.m8.1.1.2.cmml" xref="S2.SS1.SSS1.p1.8.m8.1.1">subscript</csymbol><apply id="S2.SS1.SSS1.p1.8.m8.1.1.1.2.cmml" xref="S2.SS1.SSS1.p1.8.m8.1.1.1.1"><csymbol cd="latexml" id="S2.SS1.SSS1.p1.8.m8.1.1.1.2.1.cmml" xref="S2.SS1.SSS1.p1.8.m8.1.1.1.1.2">delimited-⟨⟩</csymbol><apply id="S2.SS1.SSS1.p1.8.m8.1.1.1.1.1.cmml" xref="S2.SS1.SSS1.p1.8.m8.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p1.8.m8.1.1.1.1.1.1.cmml" xref="S2.SS1.SSS1.p1.8.m8.1.1.1.1.1">subscript</csymbol><ci id="S2.SS1.SSS1.p1.8.m8.1.1.1.1.1.2.cmml" xref="S2.SS1.SSS1.p1.8.m8.1.1.1.1.1.2">𝑍</ci><ci id="S2.SS1.SSS1.p1.8.m8.1.1.1.1.1.3.cmml" xref="S2.SS1.SSS1.p1.8.m8.1.1.1.1.1.3">𝑞</ci></apply></apply><ci id="S2.SS1.SSS1.p1.8.m8.1.1.3.cmml" xref="S2.SS1.SSS1.p1.8.m8.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS1.p1.8.m8.1c">\langle Z_{q}\rangle_{s}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS1.p1.8.m8.1d">⟨ italic_Z start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT ⟩ start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> (and <math id="S2.SS1.SSS1.p1.9.m9.1" class="ltx_Math" alttext="\langle Z_{k}\rangle_{j}" display="inline"><semantics id="S2.SS1.SSS1.p1.9.m9.1a"><msub id="S2.SS1.SSS1.p1.9.m9.1.1" xref="S2.SS1.SSS1.p1.9.m9.1.1.cmml"><mrow id="S2.SS1.SSS1.p1.9.m9.1.1.1.1" xref="S2.SS1.SSS1.p1.9.m9.1.1.1.2.cmml"><mo stretchy="false" id="S2.SS1.SSS1.p1.9.m9.1.1.1.1.2" xref="S2.SS1.SSS1.p1.9.m9.1.1.1.2.1.cmml">⟨</mo><msub id="S2.SS1.SSS1.p1.9.m9.1.1.1.1.1" xref="S2.SS1.SSS1.p1.9.m9.1.1.1.1.1.cmml"><mi id="S2.SS1.SSS1.p1.9.m9.1.1.1.1.1.2" xref="S2.SS1.SSS1.p1.9.m9.1.1.1.1.1.2.cmml">Z</mi><mi id="S2.SS1.SSS1.p1.9.m9.1.1.1.1.1.3" xref="S2.SS1.SSS1.p1.9.m9.1.1.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="S2.SS1.SSS1.p1.9.m9.1.1.1.1.3" xref="S2.SS1.SSS1.p1.9.m9.1.1.1.2.1.cmml">⟩</mo></mrow><mi id="S2.SS1.SSS1.p1.9.m9.1.1.3" xref="S2.SS1.SSS1.p1.9.m9.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS1.p1.9.m9.1b"><apply id="S2.SS1.SSS1.p1.9.m9.1.1.cmml" xref="S2.SS1.SSS1.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p1.9.m9.1.1.2.cmml" xref="S2.SS1.SSS1.p1.9.m9.1.1">subscript</csymbol><apply id="S2.SS1.SSS1.p1.9.m9.1.1.1.2.cmml" xref="S2.SS1.SSS1.p1.9.m9.1.1.1.1"><csymbol cd="latexml" id="S2.SS1.SSS1.p1.9.m9.1.1.1.2.1.cmml" xref="S2.SS1.SSS1.p1.9.m9.1.1.1.1.2">delimited-⟨⟩</csymbol><apply id="S2.SS1.SSS1.p1.9.m9.1.1.1.1.1.cmml" xref="S2.SS1.SSS1.p1.9.m9.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p1.9.m9.1.1.1.1.1.1.cmml" xref="S2.SS1.SSS1.p1.9.m9.1.1.1.1.1">subscript</csymbol><ci id="S2.SS1.SSS1.p1.9.m9.1.1.1.1.1.2.cmml" xref="S2.SS1.SSS1.p1.9.m9.1.1.1.1.1.2">𝑍</ci><ci id="S2.SS1.SSS1.p1.9.m9.1.1.1.1.1.3.cmml" xref="S2.SS1.SSS1.p1.9.m9.1.1.1.1.1.3">𝑘</ci></apply></apply><ci id="S2.SS1.SSS1.p1.9.m9.1.1.3.cmml" xref="S2.SS1.SSS1.p1.9.m9.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS1.p1.9.m9.1c">\langle Z_{k}\rangle_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS1.p1.9.m9.1d">⟨ italic_Z start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ⟩ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>) in one-dimensional<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>Multi-dimension is also possible by choosing multiple measurement results, like the value part.</span></span></span>
classical space via quantum measurements, and a Gaussian function is applied to these classical representations.
As <math id="S2.SS1.SSS1.p1.10.m10.1" class="ltx_Math" alttext="U_{q}" display="inline"><semantics id="S2.SS1.SSS1.p1.10.m10.1a"><msub id="S2.SS1.SSS1.p1.10.m10.1.1" xref="S2.SS1.SSS1.p1.10.m10.1.1.cmml"><mi id="S2.SS1.SSS1.p1.10.m10.1.1.2" xref="S2.SS1.SSS1.p1.10.m10.1.1.2.cmml">U</mi><mi id="S2.SS1.SSS1.p1.10.m10.1.1.3" xref="S2.SS1.SSS1.p1.10.m10.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS1.p1.10.m10.1b"><apply id="S2.SS1.SSS1.p1.10.m10.1.1.cmml" xref="S2.SS1.SSS1.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p1.10.m10.1.1.1.cmml" xref="S2.SS1.SSS1.p1.10.m10.1.1">subscript</csymbol><ci id="S2.SS1.SSS1.p1.10.m10.1.1.2.cmml" xref="S2.SS1.SSS1.p1.10.m10.1.1.2">𝑈</ci><ci id="S2.SS1.SSS1.p1.10.m10.1.1.3.cmml" xref="S2.SS1.SSS1.p1.10.m10.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS1.p1.10.m10.1c">U_{q}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS1.p1.10.m10.1d">italic_U start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math> and <math id="S2.SS1.SSS1.p1.11.m11.1" class="ltx_Math" alttext="U_{k}" display="inline"><semantics id="S2.SS1.SSS1.p1.11.m11.1a"><msub id="S2.SS1.SSS1.p1.11.m11.1.1" xref="S2.SS1.SSS1.p1.11.m11.1.1.cmml"><mi id="S2.SS1.SSS1.p1.11.m11.1.1.2" xref="S2.SS1.SSS1.p1.11.m11.1.1.2.cmml">U</mi><mi id="S2.SS1.SSS1.p1.11.m11.1.1.3" xref="S2.SS1.SSS1.p1.11.m11.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS1.p1.11.m11.1b"><apply id="S2.SS1.SSS1.p1.11.m11.1.1.cmml" xref="S2.SS1.SSS1.p1.11.m11.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p1.11.m11.1.1.1.cmml" xref="S2.SS1.SSS1.p1.11.m11.1.1">subscript</csymbol><ci id="S2.SS1.SSS1.p1.11.m11.1.1.2.cmml" xref="S2.SS1.SSS1.p1.11.m11.1.1.2">𝑈</ci><ci id="S2.SS1.SSS1.p1.11.m11.1.1.3.cmml" xref="S2.SS1.SSS1.p1.11.m11.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS1.p1.11.m11.1c">U_{k}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS1.p1.11.m11.1d">italic_U start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> are separated, it’s pretty easier to correlate <math id="S2.SS1.SSS1.p1.12.m12.1" class="ltx_Math" alttext="\ket{\psi_{s}}" display="inline"><semantics id="S2.SS1.SSS1.p1.12.m12.1a"><mrow id="S2.SS1.SSS1.p1.12.m12.1.1" xref="S2.SS1.SSS1.p1.12.m12.1.1.cmml"><merror class="ltx_ERROR undefined undefined" id="S2.SS1.SSS1.p1.12.m12.1.1.2" xref="S2.SS1.SSS1.p1.12.m12.1.1.2b.cmml"><mtext id="S2.SS1.SSS1.p1.12.m12.1.1.2a" xref="S2.SS1.SSS1.p1.12.m12.1.1.2b.cmml">\ket</mtext></merror><mo id="S2.SS1.SSS1.p1.12.m12.1.1.1" xref="S2.SS1.SSS1.p1.12.m12.1.1.1.cmml">⁢</mo><msub id="S2.SS1.SSS1.p1.12.m12.1.1.3" xref="S2.SS1.SSS1.p1.12.m12.1.1.3.cmml"><mi id="S2.SS1.SSS1.p1.12.m12.1.1.3.2" xref="S2.SS1.SSS1.p1.12.m12.1.1.3.2.cmml">ψ</mi><mi id="S2.SS1.SSS1.p1.12.m12.1.1.3.3" xref="S2.SS1.SSS1.p1.12.m12.1.1.3.3.cmml">s</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS1.p1.12.m12.1b"><apply id="S2.SS1.SSS1.p1.12.m12.1.1.cmml" xref="S2.SS1.SSS1.p1.12.m12.1.1"><times id="S2.SS1.SSS1.p1.12.m12.1.1.1.cmml" xref="S2.SS1.SSS1.p1.12.m12.1.1.1"></times><ci id="S2.SS1.SSS1.p1.12.m12.1.1.2b.cmml" xref="S2.SS1.SSS1.p1.12.m12.1.1.2"><merror class="ltx_ERROR undefined undefined" id="S2.SS1.SSS1.p1.12.m12.1.1.2.cmml" xref="S2.SS1.SSS1.p1.12.m12.1.1.2"><mtext id="S2.SS1.SSS1.p1.12.m12.1.1.2a.cmml" xref="S2.SS1.SSS1.p1.12.m12.1.1.2">\ket</mtext></merror></ci><apply id="S2.SS1.SSS1.p1.12.m12.1.1.3.cmml" xref="S2.SS1.SSS1.p1.12.m12.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p1.12.m12.1.1.3.1.cmml" xref="S2.SS1.SSS1.p1.12.m12.1.1.3">subscript</csymbol><ci id="S2.SS1.SSS1.p1.12.m12.1.1.3.2.cmml" xref="S2.SS1.SSS1.p1.12.m12.1.1.3.2">𝜓</ci><ci id="S2.SS1.SSS1.p1.12.m12.1.1.3.3.cmml" xref="S2.SS1.SSS1.p1.12.m12.1.1.3.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS1.p1.12.m12.1c">\ket{\psi_{s}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS1.p1.12.m12.1d">italic_ψ start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> to any <math id="S2.SS1.SSS1.p1.13.m13.1" class="ltx_Math" alttext="\ket{\psi_{j}}" display="inline"><semantics id="S2.SS1.SSS1.p1.13.m13.1a"><mrow id="S2.SS1.SSS1.p1.13.m13.1.1" xref="S2.SS1.SSS1.p1.13.m13.1.1.cmml"><merror class="ltx_ERROR undefined undefined" id="S2.SS1.SSS1.p1.13.m13.1.1.2" xref="S2.SS1.SSS1.p1.13.m13.1.1.2b.cmml"><mtext id="S2.SS1.SSS1.p1.13.m13.1.1.2a" xref="S2.SS1.SSS1.p1.13.m13.1.1.2b.cmml">\ket</mtext></merror><mo id="S2.SS1.SSS1.p1.13.m13.1.1.1" xref="S2.SS1.SSS1.p1.13.m13.1.1.1.cmml">⁢</mo><msub id="S2.SS1.SSS1.p1.13.m13.1.1.3" xref="S2.SS1.SSS1.p1.13.m13.1.1.3.cmml"><mi id="S2.SS1.SSS1.p1.13.m13.1.1.3.2" xref="S2.SS1.SSS1.p1.13.m13.1.1.3.2.cmml">ψ</mi><mi id="S2.SS1.SSS1.p1.13.m13.1.1.3.3" xref="S2.SS1.SSS1.p1.13.m13.1.1.3.3.cmml">j</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS1.p1.13.m13.1b"><apply id="S2.SS1.SSS1.p1.13.m13.1.1.cmml" xref="S2.SS1.SSS1.p1.13.m13.1.1"><times id="S2.SS1.SSS1.p1.13.m13.1.1.1.cmml" xref="S2.SS1.SSS1.p1.13.m13.1.1.1"></times><ci id="S2.SS1.SSS1.p1.13.m13.1.1.2b.cmml" xref="S2.SS1.SSS1.p1.13.m13.1.1.2"><merror class="ltx_ERROR undefined undefined" id="S2.SS1.SSS1.p1.13.m13.1.1.2.cmml" xref="S2.SS1.SSS1.p1.13.m13.1.1.2"><mtext id="S2.SS1.SSS1.p1.13.m13.1.1.2a.cmml" xref="S2.SS1.SSS1.p1.13.m13.1.1.2">\ket</mtext></merror></ci><apply id="S2.SS1.SSS1.p1.13.m13.1.1.3.cmml" xref="S2.SS1.SSS1.p1.13.m13.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p1.13.m13.1.1.3.1.cmml" xref="S2.SS1.SSS1.p1.13.m13.1.1.3">subscript</csymbol><ci id="S2.SS1.SSS1.p1.13.m13.1.1.3.2.cmml" xref="S2.SS1.SSS1.p1.13.m13.1.1.3.2">𝜓</ci><ci id="S2.SS1.SSS1.p1.13.m13.1.1.3.3.cmml" xref="S2.SS1.SSS1.p1.13.m13.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS1.p1.13.m13.1c">\ket{\psi_{j}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS1.p1.13.m13.1d">italic_ψ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>, making GPQSA more suitable to serve as a quantum self-attention.
Here, we utilize the Gaussian function <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib42" title="" class="ltx_ref">42</a>]</cite> mainly because it contains infinite-dimensional feature space and is well-studied in classical machine learning.
Numerical experiments also verify our choice of Gaussian function.
We also note that other choices of building the quantum self-attention are also worth a future study.</p>
</div>
<div id="S2.SS1.SSS1.p2" class="ltx_para">
<p id="S2.SS1.SSS1.p2.1" class="ltx_p"><span id="S2.SS1.SSS1.p2.1.1" class="ltx_text ltx_font_bold">Remark.</span> During the preparation of this manuscript as well as after submitting our work to a peer-review conference in Sep 2021, we became aware that Ref. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib43" title="" class="ltx_ref">43</a>]</cite> also made initial attempts to employ the attention mechanism in QNNs. In that work, the authors mentioned a possible quantum extension towards a quantum Transformer where the straightforward inner-product self-attention is adopted. As discussed above, the inner-product self-attention may not be reasonable for dealing with quantum data. In this work, we present that GPQSA is more suitable for the quantum version of self-attention and show the validity of our method via numerical experiments on several public data sets.</p>
</div>
<figure id="S2.F2" class="ltx_figure">
<table id="S2.Ex2" class="ltx_equation ltx_centering ltx_eqn_table">

<tr class="ltx_equation ltx_centering ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.Ex2.m1.24" class="ltx_Math" alttext="\Qcircuit@C=1.5em@R=0.5em{&amp;\gate{R_{x}(\theta_{0,1})}\gate{R_{y}(\theta_{0,5})%
}\ctrl{+1}\qw\qw\targ\gate{R_{y}(\theta_{1,1})}\qw\\
\gate{R_{x}(\theta_{0,2})}\gate{R_{y}(\theta_{0,6})}\targ\ctrl{+1}\qw\qw\gate{%
R_{y}(\theta_{1,2})}\qw\\
\gate{R_{x}(\theta_{0,3})}\gate{R_{y}(\theta_{0,7})}\qw\targ\ctrl{+1}\qw\gate{%
R_{y}(\theta_{1,3})}\qw\\
\gate{R_{x}(\theta_{0,4})}\gate{R_{y}(\theta_{0,8})}\qw\qw\targ\ctrl{-3}\gate{%
R_{y}(\theta_{1,4})}\qw\gategroup{1}{4}{4}{8}{1.0em}{--}\\
\ \ \ \ \times D}" display="block"><semantics id="S2.Ex2.m1.24a"><mrow id="S2.Ex2.m1.24b"><merror class="ltx_ERROR undefined undefined" id="S2.Ex2.m1.24.25" xref="S2.Ex2.m1.24.25b.cmml"><mtext id="S2.Ex2.m1.24.25a" xref="S2.Ex2.m1.24.25b.cmml">\Qcircuit</mtext></merror><mi mathvariant="normal" id="S2.Ex2.m1.24.26" xref="S2.Ex2.m1.24.26.cmml">@</mi><mi id="S2.Ex2.m1.24.27" xref="S2.Ex2.m1.24.27.cmml">C</mi><mo id="S2.Ex2.m1.24.28" xref="S2.Ex2.m1.24.28.cmml">=</mo><mn id="S2.Ex2.m1.24.29" xref="S2.Ex2.m1.24.29.cmml">1.5</mn><mi id="S2.Ex2.m1.24.30" xref="S2.Ex2.m1.24.30.cmml">e</mi><mi id="S2.Ex2.m1.24.31" xref="S2.Ex2.m1.24.31.cmml">m</mi><mi mathvariant="normal" id="S2.Ex2.m1.24.32" xref="S2.Ex2.m1.24.32.cmml">@</mi><mi id="S2.Ex2.m1.24.33" xref="S2.Ex2.m1.24.33.cmml">R</mi><mo id="S2.Ex2.m1.24.34" xref="S2.Ex2.m1.24.34.cmml">=</mo><mn id="S2.Ex2.m1.24.35" xref="S2.Ex2.m1.24.35.cmml">0.5</mn><mi id="S2.Ex2.m1.24.36" xref="S2.Ex2.m1.24.36.cmml">e</mi><mi id="S2.Ex2.m1.24.37" xref="S2.Ex2.m1.24.37.cmml">m</mi><mi mathvariant="normal" id="S2.Ex2.m1.24.38" xref="S2.Ex2.m1.24.38.cmml">&amp;</mi><merror class="ltx_ERROR undefined undefined" id="S2.Ex2.m1.24.39" xref="S2.Ex2.m1.24.39b.cmml"><mtext id="S2.Ex2.m1.24.39a" xref="S2.Ex2.m1.24.39b.cmml">\gate</mtext></merror><msub id="S2.Ex2.m1.24.40" xref="S2.Ex2.m1.24.40.cmml"><mi id="S2.Ex2.m1.24.40.2" xref="S2.Ex2.m1.24.40.2.cmml">R</mi><mi id="S2.Ex2.m1.24.40.3" xref="S2.Ex2.m1.24.40.3.cmml">x</mi></msub><mrow id="S2.Ex2.m1.24.41" xref="S2.Ex2.m1.24.41.cmml"><mo stretchy="false" id="S2.Ex2.m1.24.41.1" xref="S2.Ex2.m1.24.41.1.cmml">(</mo><msub id="S2.Ex2.m1.24.41.2" xref="S2.Ex2.m1.24.41.2.cmml"><mi id="S2.Ex2.m1.24.41.2.2" xref="S2.Ex2.m1.24.41.2.2.cmml">θ</mi><mrow id="S2.Ex2.m1.2.2.2.4" xref="S2.Ex2.m1.2.2.2.3.cmml"><mn id="S2.Ex2.m1.1.1.1.1" xref="S2.Ex2.m1.1.1.1.1.cmml">0</mn><mo id="S2.Ex2.m1.2.2.2.4.1" xref="S2.Ex2.m1.2.2.2.3.cmml">,</mo><mn id="S2.Ex2.m1.2.2.2.2" xref="S2.Ex2.m1.2.2.2.2.cmml">1</mn></mrow></msub><mo stretchy="false" id="S2.Ex2.m1.24.41.3" xref="S2.Ex2.m1.24.41.3.cmml">)</mo></mrow><merror class="ltx_ERROR undefined undefined" id="S2.Ex2.m1.24.42" xref="S2.Ex2.m1.24.42b.cmml"><mtext id="S2.Ex2.m1.24.42a" xref="S2.Ex2.m1.24.42b.cmml">\gate</mtext></merror><msub id="S2.Ex2.m1.24.43" xref="S2.Ex2.m1.24.43.cmml"><mi id="S2.Ex2.m1.24.43.2" xref="S2.Ex2.m1.24.43.2.cmml">R</mi><mi id="S2.Ex2.m1.24.43.3" xref="S2.Ex2.m1.24.43.3.cmml">y</mi></msub><mrow id="S2.Ex2.m1.24.44" xref="S2.Ex2.m1.24.44.cmml"><mo stretchy="false" id="S2.Ex2.m1.24.44.1" xref="S2.Ex2.m1.24.44.1.cmml">(</mo><msub id="S2.Ex2.m1.24.44.2" xref="S2.Ex2.m1.24.44.2.cmml"><mi id="S2.Ex2.m1.24.44.2.2" xref="S2.Ex2.m1.24.44.2.2.cmml">θ</mi><mrow id="S2.Ex2.m1.4.4.2.4" xref="S2.Ex2.m1.4.4.2.3.cmml"><mn id="S2.Ex2.m1.3.3.1.1" xref="S2.Ex2.m1.3.3.1.1.cmml">0</mn><mo id="S2.Ex2.m1.4.4.2.4.1" xref="S2.Ex2.m1.4.4.2.3.cmml">,</mo><mn id="S2.Ex2.m1.4.4.2.2" xref="S2.Ex2.m1.4.4.2.2.cmml">5</mn></mrow></msub><mo stretchy="false" id="S2.Ex2.m1.24.44.3" xref="S2.Ex2.m1.24.44.3.cmml">)</mo></mrow><merror class="ltx_ERROR undefined undefined" id="S2.Ex2.m1.24.45" xref="S2.Ex2.m1.24.45b.cmml"><mtext id="S2.Ex2.m1.24.45a" xref="S2.Ex2.m1.24.45b.cmml">\ctrl</mtext></merror><mo id="S2.Ex2.m1.24.46" xref="S2.Ex2.m1.24.46.cmml">+</mo><mn id="S2.Ex2.m1.24.47" xref="S2.Ex2.m1.24.47.cmml">1</mn><merror class="ltx_ERROR undefined undefined" id="S2.Ex2.m1.24.48" xref="S2.Ex2.m1.24.48b.cmml"><mtext id="S2.Ex2.m1.24.48a" xref="S2.Ex2.m1.24.48b.cmml">\qw</mtext></merror><merror class="ltx_ERROR undefined undefined" id="S2.Ex2.m1.24.49" xref="S2.Ex2.m1.24.49b.cmml"><mtext id="S2.Ex2.m1.24.49a" xref="S2.Ex2.m1.24.49b.cmml">\qw</mtext></merror><merror class="ltx_ERROR undefined undefined" id="S2.Ex2.m1.24.50" xref="S2.Ex2.m1.24.50b.cmml"><mtext id="S2.Ex2.m1.24.50a" xref="S2.Ex2.m1.24.50b.cmml">\targ</mtext></merror><merror class="ltx_ERROR undefined undefined" id="S2.Ex2.m1.24.51" xref="S2.Ex2.m1.24.51b.cmml"><mtext id="S2.Ex2.m1.24.51a" xref="S2.Ex2.m1.24.51b.cmml">\gate</mtext></merror><msub id="S2.Ex2.m1.24.52" xref="S2.Ex2.m1.24.52.cmml"><mi id="S2.Ex2.m1.24.52.2" xref="S2.Ex2.m1.24.52.2.cmml">R</mi><mi id="S2.Ex2.m1.24.52.3" xref="S2.Ex2.m1.24.52.3.cmml">y</mi></msub><mrow id="S2.Ex2.m1.24.53" xref="S2.Ex2.m1.24.53.cmml"><mo stretchy="false" id="S2.Ex2.m1.24.53.1" xref="S2.Ex2.m1.24.53.1.cmml">(</mo><msub id="S2.Ex2.m1.24.53.2" xref="S2.Ex2.m1.24.53.2.cmml"><mi id="S2.Ex2.m1.24.53.2.2" xref="S2.Ex2.m1.24.53.2.2.cmml">θ</mi><mrow id="S2.Ex2.m1.6.6.2.4" xref="S2.Ex2.m1.6.6.2.3.cmml"><mn id="S2.Ex2.m1.5.5.1.1" xref="S2.Ex2.m1.5.5.1.1.cmml">1</mn><mo id="S2.Ex2.m1.6.6.2.4.1" xref="S2.Ex2.m1.6.6.2.3.cmml">,</mo><mn id="S2.Ex2.m1.6.6.2.2" xref="S2.Ex2.m1.6.6.2.2.cmml">1</mn></mrow></msub><mo stretchy="false" id="S2.Ex2.m1.24.53.3" xref="S2.Ex2.m1.24.53.3.cmml">)</mo></mrow><merror class="ltx_ERROR undefined undefined" id="S2.Ex2.m1.24.54" xref="S2.Ex2.m1.24.54b.cmml"><mtext id="S2.Ex2.m1.24.54a" xref="S2.Ex2.m1.24.54b.cmml">\qw</mtext></merror><merror class="ltx_ERROR undefined undefined" id="S2.Ex2.m1.24.55" xref="S2.Ex2.m1.24.55b.cmml"><mtext id="S2.Ex2.m1.24.55a" xref="S2.Ex2.m1.24.55b.cmml">\gate</mtext></merror><msub id="S2.Ex2.m1.24.56" xref="S2.Ex2.m1.24.56.cmml"><mi id="S2.Ex2.m1.24.56.2" xref="S2.Ex2.m1.24.56.2.cmml">R</mi><mi id="S2.Ex2.m1.24.56.3" xref="S2.Ex2.m1.24.56.3.cmml">x</mi></msub><mrow id="S2.Ex2.m1.24.57" xref="S2.Ex2.m1.24.57.cmml"><mo stretchy="false" id="S2.Ex2.m1.24.57.1" xref="S2.Ex2.m1.24.57.1.cmml">(</mo><msub id="S2.Ex2.m1.24.57.2" xref="S2.Ex2.m1.24.57.2.cmml"><mi id="S2.Ex2.m1.24.57.2.2" xref="S2.Ex2.m1.24.57.2.2.cmml">θ</mi><mrow id="S2.Ex2.m1.8.8.2.4" xref="S2.Ex2.m1.8.8.2.3.cmml"><mn id="S2.Ex2.m1.7.7.1.1" xref="S2.Ex2.m1.7.7.1.1.cmml">0</mn><mo id="S2.Ex2.m1.8.8.2.4.1" xref="S2.Ex2.m1.8.8.2.3.cmml">,</mo><mn id="S2.Ex2.m1.8.8.2.2" xref="S2.Ex2.m1.8.8.2.2.cmml">2</mn></mrow></msub><mo stretchy="false" id="S2.Ex2.m1.24.57.3" xref="S2.Ex2.m1.24.57.3.cmml">)</mo></mrow><merror class="ltx_ERROR undefined undefined" id="S2.Ex2.m1.24.58" xref="S2.Ex2.m1.24.58b.cmml"><mtext id="S2.Ex2.m1.24.58a" xref="S2.Ex2.m1.24.58b.cmml">\gate</mtext></merror><msub id="S2.Ex2.m1.24.59" xref="S2.Ex2.m1.24.59.cmml"><mi id="S2.Ex2.m1.24.59.2" xref="S2.Ex2.m1.24.59.2.cmml">R</mi><mi id="S2.Ex2.m1.24.59.3" xref="S2.Ex2.m1.24.59.3.cmml">y</mi></msub><mrow id="S2.Ex2.m1.24.60" xref="S2.Ex2.m1.24.60.cmml"><mo stretchy="false" id="S2.Ex2.m1.24.60.1" xref="S2.Ex2.m1.24.60.1.cmml">(</mo><msub id="S2.Ex2.m1.24.60.2" xref="S2.Ex2.m1.24.60.2.cmml"><mi id="S2.Ex2.m1.24.60.2.2" xref="S2.Ex2.m1.24.60.2.2.cmml">θ</mi><mrow id="S2.Ex2.m1.10.10.2.4" xref="S2.Ex2.m1.10.10.2.3.cmml"><mn id="S2.Ex2.m1.9.9.1.1" xref="S2.Ex2.m1.9.9.1.1.cmml">0</mn><mo id="S2.Ex2.m1.10.10.2.4.1" xref="S2.Ex2.m1.10.10.2.3.cmml">,</mo><mn id="S2.Ex2.m1.10.10.2.2" xref="S2.Ex2.m1.10.10.2.2.cmml">6</mn></mrow></msub><mo stretchy="false" id="S2.Ex2.m1.24.60.3" xref="S2.Ex2.m1.24.60.3.cmml">)</mo></mrow><merror class="ltx_ERROR undefined undefined" id="S2.Ex2.m1.24.61" xref="S2.Ex2.m1.24.61b.cmml"><mtext id="S2.Ex2.m1.24.61a" xref="S2.Ex2.m1.24.61b.cmml">\targ</mtext></merror><merror class="ltx_ERROR undefined undefined" id="S2.Ex2.m1.24.62" xref="S2.Ex2.m1.24.62b.cmml"><mtext id="S2.Ex2.m1.24.62a" xref="S2.Ex2.m1.24.62b.cmml">\ctrl</mtext></merror><mo id="S2.Ex2.m1.24.63" xref="S2.Ex2.m1.24.63.cmml">+</mo><mn id="S2.Ex2.m1.24.64" xref="S2.Ex2.m1.24.64.cmml">1</mn><merror class="ltx_ERROR undefined undefined" id="S2.Ex2.m1.24.65" xref="S2.Ex2.m1.24.65b.cmml"><mtext id="S2.Ex2.m1.24.65a" xref="S2.Ex2.m1.24.65b.cmml">\qw</mtext></merror><merror class="ltx_ERROR undefined undefined" id="S2.Ex2.m1.24.66" xref="S2.Ex2.m1.24.66b.cmml"><mtext id="S2.Ex2.m1.24.66a" xref="S2.Ex2.m1.24.66b.cmml">\qw</mtext></merror><merror class="ltx_ERROR undefined undefined" id="S2.Ex2.m1.24.67" xref="S2.Ex2.m1.24.67b.cmml"><mtext id="S2.Ex2.m1.24.67a" xref="S2.Ex2.m1.24.67b.cmml">\gate</mtext></merror><msub id="S2.Ex2.m1.24.68" xref="S2.Ex2.m1.24.68.cmml"><mi id="S2.Ex2.m1.24.68.2" xref="S2.Ex2.m1.24.68.2.cmml">R</mi><mi id="S2.Ex2.m1.24.68.3" xref="S2.Ex2.m1.24.68.3.cmml">y</mi></msub><mrow id="S2.Ex2.m1.24.69" xref="S2.Ex2.m1.24.69.cmml"><mo stretchy="false" id="S2.Ex2.m1.24.69.1" xref="S2.Ex2.m1.24.69.1.cmml">(</mo><msub id="S2.Ex2.m1.24.69.2" xref="S2.Ex2.m1.24.69.2.cmml"><mi id="S2.Ex2.m1.24.69.2.2" xref="S2.Ex2.m1.24.69.2.2.cmml">θ</mi><mrow id="S2.Ex2.m1.12.12.2.4" xref="S2.Ex2.m1.12.12.2.3.cmml"><mn id="S2.Ex2.m1.11.11.1.1" xref="S2.Ex2.m1.11.11.1.1.cmml">1</mn><mo id="S2.Ex2.m1.12.12.2.4.1" xref="S2.Ex2.m1.12.12.2.3.cmml">,</mo><mn id="S2.Ex2.m1.12.12.2.2" xref="S2.Ex2.m1.12.12.2.2.cmml">2</mn></mrow></msub><mo stretchy="false" id="S2.Ex2.m1.24.69.3" xref="S2.Ex2.m1.24.69.3.cmml">)</mo></mrow><merror class="ltx_ERROR undefined undefined" id="S2.Ex2.m1.24.70" xref="S2.Ex2.m1.24.70b.cmml"><mtext id="S2.Ex2.m1.24.70a" xref="S2.Ex2.m1.24.70b.cmml">\qw</mtext></merror><merror class="ltx_ERROR undefined undefined" id="S2.Ex2.m1.24.71" xref="S2.Ex2.m1.24.71b.cmml"><mtext id="S2.Ex2.m1.24.71a" xref="S2.Ex2.m1.24.71b.cmml">\gate</mtext></merror><msub id="S2.Ex2.m1.24.72" xref="S2.Ex2.m1.24.72.cmml"><mi id="S2.Ex2.m1.24.72.2" xref="S2.Ex2.m1.24.72.2.cmml">R</mi><mi id="S2.Ex2.m1.24.72.3" xref="S2.Ex2.m1.24.72.3.cmml">x</mi></msub><mrow id="S2.Ex2.m1.24.73" xref="S2.Ex2.m1.24.73.cmml"><mo stretchy="false" id="S2.Ex2.m1.24.73.1" xref="S2.Ex2.m1.24.73.1.cmml">(</mo><msub id="S2.Ex2.m1.24.73.2" xref="S2.Ex2.m1.24.73.2.cmml"><mi id="S2.Ex2.m1.24.73.2.2" xref="S2.Ex2.m1.24.73.2.2.cmml">θ</mi><mrow id="S2.Ex2.m1.14.14.2.4" xref="S2.Ex2.m1.14.14.2.3.cmml"><mn id="S2.Ex2.m1.13.13.1.1" xref="S2.Ex2.m1.13.13.1.1.cmml">0</mn><mo id="S2.Ex2.m1.14.14.2.4.1" xref="S2.Ex2.m1.14.14.2.3.cmml">,</mo><mn id="S2.Ex2.m1.14.14.2.2" xref="S2.Ex2.m1.14.14.2.2.cmml">3</mn></mrow></msub><mo stretchy="false" id="S2.Ex2.m1.24.73.3" xref="S2.Ex2.m1.24.73.3.cmml">)</mo></mrow><merror class="ltx_ERROR undefined undefined" id="S2.Ex2.m1.24.74" xref="S2.Ex2.m1.24.74b.cmml"><mtext id="S2.Ex2.m1.24.74a" xref="S2.Ex2.m1.24.74b.cmml">\gate</mtext></merror><msub id="S2.Ex2.m1.24.75" xref="S2.Ex2.m1.24.75.cmml"><mi id="S2.Ex2.m1.24.75.2" xref="S2.Ex2.m1.24.75.2.cmml">R</mi><mi id="S2.Ex2.m1.24.75.3" xref="S2.Ex2.m1.24.75.3.cmml">y</mi></msub><mrow id="S2.Ex2.m1.24.76" xref="S2.Ex2.m1.24.76.cmml"><mo stretchy="false" id="S2.Ex2.m1.24.76.1" xref="S2.Ex2.m1.24.76.1.cmml">(</mo><msub id="S2.Ex2.m1.24.76.2" xref="S2.Ex2.m1.24.76.2.cmml"><mi id="S2.Ex2.m1.24.76.2.2" xref="S2.Ex2.m1.24.76.2.2.cmml">θ</mi><mrow id="S2.Ex2.m1.16.16.2.4" xref="S2.Ex2.m1.16.16.2.3.cmml"><mn id="S2.Ex2.m1.15.15.1.1" xref="S2.Ex2.m1.15.15.1.1.cmml">0</mn><mo id="S2.Ex2.m1.16.16.2.4.1" xref="S2.Ex2.m1.16.16.2.3.cmml">,</mo><mn id="S2.Ex2.m1.16.16.2.2" xref="S2.Ex2.m1.16.16.2.2.cmml">7</mn></mrow></msub><mo stretchy="false" id="S2.Ex2.m1.24.76.3" xref="S2.Ex2.m1.24.76.3.cmml">)</mo></mrow><merror class="ltx_ERROR undefined undefined" id="S2.Ex2.m1.24.77" xref="S2.Ex2.m1.24.77b.cmml"><mtext id="S2.Ex2.m1.24.77a" xref="S2.Ex2.m1.24.77b.cmml">\qw</mtext></merror><merror class="ltx_ERROR undefined undefined" id="S2.Ex2.m1.24.78" xref="S2.Ex2.m1.24.78b.cmml"><mtext id="S2.Ex2.m1.24.78a" xref="S2.Ex2.m1.24.78b.cmml">\targ</mtext></merror><merror class="ltx_ERROR undefined undefined" id="S2.Ex2.m1.24.79" xref="S2.Ex2.m1.24.79b.cmml"><mtext id="S2.Ex2.m1.24.79a" xref="S2.Ex2.m1.24.79b.cmml">\ctrl</mtext></merror><mo id="S2.Ex2.m1.24.80" xref="S2.Ex2.m1.24.80.cmml">+</mo><mn id="S2.Ex2.m1.24.81" xref="S2.Ex2.m1.24.81.cmml">1</mn><merror class="ltx_ERROR undefined undefined" id="S2.Ex2.m1.24.82" xref="S2.Ex2.m1.24.82b.cmml"><mtext id="S2.Ex2.m1.24.82a" xref="S2.Ex2.m1.24.82b.cmml">\qw</mtext></merror><merror class="ltx_ERROR undefined undefined" id="S2.Ex2.m1.24.83" xref="S2.Ex2.m1.24.83b.cmml"><mtext id="S2.Ex2.m1.24.83a" xref="S2.Ex2.m1.24.83b.cmml">\gate</mtext></merror><msub id="S2.Ex2.m1.24.84" xref="S2.Ex2.m1.24.84.cmml"><mi id="S2.Ex2.m1.24.84.2" xref="S2.Ex2.m1.24.84.2.cmml">R</mi><mi id="S2.Ex2.m1.24.84.3" xref="S2.Ex2.m1.24.84.3.cmml">y</mi></msub><mrow id="S2.Ex2.m1.24.85" xref="S2.Ex2.m1.24.85.cmml"><mo stretchy="false" id="S2.Ex2.m1.24.85.1" xref="S2.Ex2.m1.24.85.1.cmml">(</mo><msub id="S2.Ex2.m1.24.85.2" xref="S2.Ex2.m1.24.85.2.cmml"><mi id="S2.Ex2.m1.24.85.2.2" xref="S2.Ex2.m1.24.85.2.2.cmml">θ</mi><mrow id="S2.Ex2.m1.18.18.2.4" xref="S2.Ex2.m1.18.18.2.3.cmml"><mn id="S2.Ex2.m1.17.17.1.1" xref="S2.Ex2.m1.17.17.1.1.cmml">1</mn><mo id="S2.Ex2.m1.18.18.2.4.1" xref="S2.Ex2.m1.18.18.2.3.cmml">,</mo><mn id="S2.Ex2.m1.18.18.2.2" xref="S2.Ex2.m1.18.18.2.2.cmml">3</mn></mrow></msub><mo stretchy="false" id="S2.Ex2.m1.24.85.3" xref="S2.Ex2.m1.24.85.3.cmml">)</mo></mrow><merror class="ltx_ERROR undefined undefined" id="S2.Ex2.m1.24.86" xref="S2.Ex2.m1.24.86b.cmml"><mtext id="S2.Ex2.m1.24.86a" xref="S2.Ex2.m1.24.86b.cmml">\qw</mtext></merror><merror class="ltx_ERROR undefined undefined" id="S2.Ex2.m1.24.87" xref="S2.Ex2.m1.24.87b.cmml"><mtext id="S2.Ex2.m1.24.87a" xref="S2.Ex2.m1.24.87b.cmml">\gate</mtext></merror><msub id="S2.Ex2.m1.24.88" xref="S2.Ex2.m1.24.88.cmml"><mi id="S2.Ex2.m1.24.88.2" xref="S2.Ex2.m1.24.88.2.cmml">R</mi><mi id="S2.Ex2.m1.24.88.3" xref="S2.Ex2.m1.24.88.3.cmml">x</mi></msub><mrow id="S2.Ex2.m1.24.89" xref="S2.Ex2.m1.24.89.cmml"><mo stretchy="false" id="S2.Ex2.m1.24.89.1" xref="S2.Ex2.m1.24.89.1.cmml">(</mo><msub id="S2.Ex2.m1.24.89.2" xref="S2.Ex2.m1.24.89.2.cmml"><mi id="S2.Ex2.m1.24.89.2.2" xref="S2.Ex2.m1.24.89.2.2.cmml">θ</mi><mrow id="S2.Ex2.m1.20.20.2.4" xref="S2.Ex2.m1.20.20.2.3.cmml"><mn id="S2.Ex2.m1.19.19.1.1" xref="S2.Ex2.m1.19.19.1.1.cmml">0</mn><mo id="S2.Ex2.m1.20.20.2.4.1" xref="S2.Ex2.m1.20.20.2.3.cmml">,</mo><mn id="S2.Ex2.m1.20.20.2.2" xref="S2.Ex2.m1.20.20.2.2.cmml">4</mn></mrow></msub><mo stretchy="false" id="S2.Ex2.m1.24.89.3" xref="S2.Ex2.m1.24.89.3.cmml">)</mo></mrow><merror class="ltx_ERROR undefined undefined" id="S2.Ex2.m1.24.90" xref="S2.Ex2.m1.24.90b.cmml"><mtext id="S2.Ex2.m1.24.90a" xref="S2.Ex2.m1.24.90b.cmml">\gate</mtext></merror><msub id="S2.Ex2.m1.24.91" xref="S2.Ex2.m1.24.91.cmml"><mi id="S2.Ex2.m1.24.91.2" xref="S2.Ex2.m1.24.91.2.cmml">R</mi><mi id="S2.Ex2.m1.24.91.3" xref="S2.Ex2.m1.24.91.3.cmml">y</mi></msub><mrow id="S2.Ex2.m1.24.92" xref="S2.Ex2.m1.24.92.cmml"><mo stretchy="false" id="S2.Ex2.m1.24.92.1" xref="S2.Ex2.m1.24.92.1.cmml">(</mo><msub id="S2.Ex2.m1.24.92.2" xref="S2.Ex2.m1.24.92.2.cmml"><mi id="S2.Ex2.m1.24.92.2.2" xref="S2.Ex2.m1.24.92.2.2.cmml">θ</mi><mrow id="S2.Ex2.m1.22.22.2.4" xref="S2.Ex2.m1.22.22.2.3.cmml"><mn id="S2.Ex2.m1.21.21.1.1" xref="S2.Ex2.m1.21.21.1.1.cmml">0</mn><mo id="S2.Ex2.m1.22.22.2.4.1" xref="S2.Ex2.m1.22.22.2.3.cmml">,</mo><mn id="S2.Ex2.m1.22.22.2.2" xref="S2.Ex2.m1.22.22.2.2.cmml">8</mn></mrow></msub><mo stretchy="false" id="S2.Ex2.m1.24.92.3" xref="S2.Ex2.m1.24.92.3.cmml">)</mo></mrow><merror class="ltx_ERROR undefined undefined" id="S2.Ex2.m1.24.93" xref="S2.Ex2.m1.24.93b.cmml"><mtext id="S2.Ex2.m1.24.93a" xref="S2.Ex2.m1.24.93b.cmml">\qw</mtext></merror><merror class="ltx_ERROR undefined undefined" id="S2.Ex2.m1.24.94" xref="S2.Ex2.m1.24.94b.cmml"><mtext id="S2.Ex2.m1.24.94a" xref="S2.Ex2.m1.24.94b.cmml">\qw</mtext></merror><merror class="ltx_ERROR undefined undefined" id="S2.Ex2.m1.24.95" xref="S2.Ex2.m1.24.95b.cmml"><mtext id="S2.Ex2.m1.24.95a" xref="S2.Ex2.m1.24.95b.cmml">\targ</mtext></merror><merror class="ltx_ERROR undefined undefined" id="S2.Ex2.m1.24.96" xref="S2.Ex2.m1.24.96b.cmml"><mtext id="S2.Ex2.m1.24.96a" xref="S2.Ex2.m1.24.96b.cmml">\ctrl</mtext></merror><mo id="S2.Ex2.m1.24.97" xref="S2.Ex2.m1.24.97.cmml">-</mo><mn id="S2.Ex2.m1.24.98" xref="S2.Ex2.m1.24.98.cmml">3</mn><merror class="ltx_ERROR undefined undefined" id="S2.Ex2.m1.24.99" xref="S2.Ex2.m1.24.99b.cmml"><mtext id="S2.Ex2.m1.24.99a" xref="S2.Ex2.m1.24.99b.cmml">\gate</mtext></merror><msub id="S2.Ex2.m1.24.100" xref="S2.Ex2.m1.24.100.cmml"><mi id="S2.Ex2.m1.24.100.2" xref="S2.Ex2.m1.24.100.2.cmml">R</mi><mi id="S2.Ex2.m1.24.100.3" xref="S2.Ex2.m1.24.100.3.cmml">y</mi></msub><mrow id="S2.Ex2.m1.24.101" xref="S2.Ex2.m1.24.101.cmml"><mo stretchy="false" id="S2.Ex2.m1.24.101.1" xref="S2.Ex2.m1.24.101.1.cmml">(</mo><msub id="S2.Ex2.m1.24.101.2" xref="S2.Ex2.m1.24.101.2.cmml"><mi id="S2.Ex2.m1.24.101.2.2" xref="S2.Ex2.m1.24.101.2.2.cmml">θ</mi><mrow id="S2.Ex2.m1.24.24.2.4" xref="S2.Ex2.m1.24.24.2.3.cmml"><mn id="S2.Ex2.m1.23.23.1.1" xref="S2.Ex2.m1.23.23.1.1.cmml">1</mn><mo id="S2.Ex2.m1.24.24.2.4.1" xref="S2.Ex2.m1.24.24.2.3.cmml">,</mo><mn id="S2.Ex2.m1.24.24.2.2" xref="S2.Ex2.m1.24.24.2.2.cmml">4</mn></mrow></msub><mo stretchy="false" id="S2.Ex2.m1.24.101.3" xref="S2.Ex2.m1.24.101.3.cmml">)</mo></mrow><merror class="ltx_ERROR undefined undefined" id="S2.Ex2.m1.24.102" xref="S2.Ex2.m1.24.102b.cmml"><mtext id="S2.Ex2.m1.24.102a" xref="S2.Ex2.m1.24.102b.cmml">\qw</mtext></merror><merror class="ltx_ERROR undefined undefined" id="S2.Ex2.m1.24.103" xref="S2.Ex2.m1.24.103b.cmml"><mtext id="S2.Ex2.m1.24.103a" xref="S2.Ex2.m1.24.103b.cmml">\gategroup</mtext></merror><mn id="S2.Ex2.m1.24.104" xref="S2.Ex2.m1.24.104.cmml">14481.0</mn><mi id="S2.Ex2.m1.24.105" xref="S2.Ex2.m1.24.105.cmml">e</mi><mi id="S2.Ex2.m1.24.106" xref="S2.Ex2.m1.24.106.cmml">m</mi><mo id="S2.Ex2.m1.24.107" xref="S2.Ex2.m1.24.107.cmml">-</mo><mo id="S2.Ex2.m1.24.108" xref="S2.Ex2.m1.24.108.cmml">-</mo><mo mathvariant="italic" separator="true" id="S2.Ex2.m1.24.109" xref="S2.Ex2.m1.24.109.cmml">  </mo><mo id="S2.Ex2.m1.24.110" xref="S2.Ex2.m1.24.110.cmml">×</mo><mi id="S2.Ex2.m1.24.111" xref="S2.Ex2.m1.24.111.cmml">D</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex2.m1.24c"><cerror id="S2.Ex2.m1.24d"><csymbol cd="ambiguous" id="S2.Ex2.m1.24e">fragments</csymbol><ci id="S2.Ex2.m1.24.25b.cmml" xref="S2.Ex2.m1.24.25"><merror class="ltx_ERROR undefined undefined" id="S2.Ex2.m1.24.25.cmml" xref="S2.Ex2.m1.24.25"><mtext id="S2.Ex2.m1.24.25a.cmml" xref="S2.Ex2.m1.24.25">\Qcircuit</mtext></merror></ci><csymbol cd="unknown" id="S2.Ex2.m1.24.26.cmml" xref="S2.Ex2.m1.24.26">@</csymbol><csymbol cd="unknown" id="S2.Ex2.m1.24.27.cmml" xref="S2.Ex2.m1.24.27">C</csymbol><eq id="S2.Ex2.m1.24.28.cmml" xref="S2.Ex2.m1.24.28"></eq><cn type="float" id="S2.Ex2.m1.24.29.cmml" xref="S2.Ex2.m1.24.29">1.5</cn><csymbol cd="unknown" id="S2.Ex2.m1.24.30.cmml" xref="S2.Ex2.m1.24.30">e</csymbol><csymbol cd="unknown" id="S2.Ex2.m1.24.31.cmml" xref="S2.Ex2.m1.24.31">m</csymbol><csymbol cd="unknown" id="S2.Ex2.m1.24.32.cmml" xref="S2.Ex2.m1.24.32">@</csymbol><csymbol cd="unknown" id="S2.Ex2.m1.24.33.cmml" xref="S2.Ex2.m1.24.33">R</csymbol><eq id="S2.Ex2.m1.24.34.cmml" xref="S2.Ex2.m1.24.34"></eq><cn type="float" id="S2.Ex2.m1.24.35.cmml" xref="S2.Ex2.m1.24.35">0.5</cn><csymbol cd="unknown" id="S2.Ex2.m1.24.36.cmml" xref="S2.Ex2.m1.24.36">e</csymbol><csymbol cd="unknown" id="S2.Ex2.m1.24.37.cmml" xref="S2.Ex2.m1.24.37">m</csymbol><csymbol cd="unknown" id="S2.Ex2.m1.24.38.cmml" xref="S2.Ex2.m1.24.38">&amp;</csymbol><ci id="S2.Ex2.m1.24.39b.cmml" xref="S2.Ex2.m1.24.39"><merror class="ltx_ERROR undefined undefined" id="S2.Ex2.m1.24.39.cmml" xref="S2.Ex2.m1.24.39"><mtext id="S2.Ex2.m1.24.39a.cmml" xref="S2.Ex2.m1.24.39">\gate</mtext></merror></ci><apply id="S2.Ex2.m1.24.40.cmml" xref="S2.Ex2.m1.24.40"><csymbol cd="ambiguous" id="S2.Ex2.m1.24.40.1.cmml" xref="S2.Ex2.m1.24.40">subscript</csymbol><ci id="S2.Ex2.m1.24.40.2.cmml" xref="S2.Ex2.m1.24.40.2">𝑅</ci><ci id="S2.Ex2.m1.24.40.3.cmml" xref="S2.Ex2.m1.24.40.3">𝑥</ci></apply><cerror id="S2.Ex2.m1.24.41.cmml" xref="S2.Ex2.m1.24.41"><csymbol cd="ambiguous" id="S2.Ex2.m1.24.41a.cmml" xref="S2.Ex2.m1.24.41">fragments</csymbol><ci id="S2.Ex2.m1.24.41.1.cmml" xref="S2.Ex2.m1.24.41.1">(</ci><apply id="S2.Ex2.m1.24.41.2.cmml" xref="S2.Ex2.m1.24.41.2"><csymbol cd="ambiguous" id="S2.Ex2.m1.24.41.2.1.cmml" xref="S2.Ex2.m1.24.41.2">subscript</csymbol><ci id="S2.Ex2.m1.24.41.2.2.cmml" xref="S2.Ex2.m1.24.41.2.2">𝜃</ci><list id="S2.Ex2.m1.2.2.2.3.cmml" xref="S2.Ex2.m1.2.2.2.4"><cn type="integer" id="S2.Ex2.m1.1.1.1.1.cmml" xref="S2.Ex2.m1.1.1.1.1">0</cn><cn type="integer" id="S2.Ex2.m1.2.2.2.2.cmml" xref="S2.Ex2.m1.2.2.2.2">1</cn></list></apply><ci id="S2.Ex2.m1.24.41.3.cmml" xref="S2.Ex2.m1.24.41.3">)</ci></cerror><ci id="S2.Ex2.m1.24.42b.cmml" xref="S2.Ex2.m1.24.42"><merror class="ltx_ERROR undefined undefined" id="S2.Ex2.m1.24.42.cmml" xref="S2.Ex2.m1.24.42"><mtext id="S2.Ex2.m1.24.42a.cmml" xref="S2.Ex2.m1.24.42">\gate</mtext></merror></ci><apply id="S2.Ex2.m1.24.43.cmml" xref="S2.Ex2.m1.24.43"><csymbol cd="ambiguous" id="S2.Ex2.m1.24.43.1.cmml" xref="S2.Ex2.m1.24.43">subscript</csymbol><ci id="S2.Ex2.m1.24.43.2.cmml" xref="S2.Ex2.m1.24.43.2">𝑅</ci><ci id="S2.Ex2.m1.24.43.3.cmml" xref="S2.Ex2.m1.24.43.3">𝑦</ci></apply><cerror id="S2.Ex2.m1.24.44.cmml" xref="S2.Ex2.m1.24.44"><csymbol cd="ambiguous" id="S2.Ex2.m1.24.44a.cmml" xref="S2.Ex2.m1.24.44">fragments</csymbol><ci id="S2.Ex2.m1.24.44.1.cmml" xref="S2.Ex2.m1.24.44.1">(</ci><apply id="S2.Ex2.m1.24.44.2.cmml" xref="S2.Ex2.m1.24.44.2"><csymbol cd="ambiguous" id="S2.Ex2.m1.24.44.2.1.cmml" xref="S2.Ex2.m1.24.44.2">subscript</csymbol><ci id="S2.Ex2.m1.24.44.2.2.cmml" xref="S2.Ex2.m1.24.44.2.2">𝜃</ci><list id="S2.Ex2.m1.4.4.2.3.cmml" xref="S2.Ex2.m1.4.4.2.4"><cn type="integer" id="S2.Ex2.m1.3.3.1.1.cmml" xref="S2.Ex2.m1.3.3.1.1">0</cn><cn type="integer" id="S2.Ex2.m1.4.4.2.2.cmml" xref="S2.Ex2.m1.4.4.2.2">5</cn></list></apply><ci id="S2.Ex2.m1.24.44.3.cmml" xref="S2.Ex2.m1.24.44.3">)</ci></cerror><ci id="S2.Ex2.m1.24.45b.cmml" xref="S2.Ex2.m1.24.45"><merror class="ltx_ERROR undefined undefined" id="S2.Ex2.m1.24.45.cmml" xref="S2.Ex2.m1.24.45"><mtext id="S2.Ex2.m1.24.45a.cmml" xref="S2.Ex2.m1.24.45">\ctrl</mtext></merror></ci><plus id="S2.Ex2.m1.24.46.cmml" xref="S2.Ex2.m1.24.46"></plus><cn type="integer" id="S2.Ex2.m1.24.47.cmml" xref="S2.Ex2.m1.24.47">1</cn><ci id="S2.Ex2.m1.24.48b.cmml" xref="S2.Ex2.m1.24.48"><merror class="ltx_ERROR undefined undefined" id="S2.Ex2.m1.24.48.cmml" xref="S2.Ex2.m1.24.48"><mtext id="S2.Ex2.m1.24.48a.cmml" xref="S2.Ex2.m1.24.48">\qw</mtext></merror></ci><ci id="S2.Ex2.m1.24.49b.cmml" xref="S2.Ex2.m1.24.49"><merror class="ltx_ERROR undefined undefined" id="S2.Ex2.m1.24.49.cmml" xref="S2.Ex2.m1.24.49"><mtext id="S2.Ex2.m1.24.49a.cmml" xref="S2.Ex2.m1.24.49">\qw</mtext></merror></ci><ci id="S2.Ex2.m1.24.50b.cmml" xref="S2.Ex2.m1.24.50"><merror class="ltx_ERROR undefined undefined" id="S2.Ex2.m1.24.50.cmml" xref="S2.Ex2.m1.24.50"><mtext id="S2.Ex2.m1.24.50a.cmml" xref="S2.Ex2.m1.24.50">\targ</mtext></merror></ci><ci id="S2.Ex2.m1.24.51b.cmml" xref="S2.Ex2.m1.24.51"><merror class="ltx_ERROR undefined undefined" id="S2.Ex2.m1.24.51.cmml" xref="S2.Ex2.m1.24.51"><mtext id="S2.Ex2.m1.24.51a.cmml" xref="S2.Ex2.m1.24.51">\gate</mtext></merror></ci><apply id="S2.Ex2.m1.24.52.cmml" xref="S2.Ex2.m1.24.52"><csymbol cd="ambiguous" id="S2.Ex2.m1.24.52.1.cmml" xref="S2.Ex2.m1.24.52">subscript</csymbol><ci id="S2.Ex2.m1.24.52.2.cmml" xref="S2.Ex2.m1.24.52.2">𝑅</ci><ci id="S2.Ex2.m1.24.52.3.cmml" xref="S2.Ex2.m1.24.52.3">𝑦</ci></apply><cerror id="S2.Ex2.m1.24.53.cmml" xref="S2.Ex2.m1.24.53"><csymbol cd="ambiguous" id="S2.Ex2.m1.24.53a.cmml" xref="S2.Ex2.m1.24.53">fragments</csymbol><ci id="S2.Ex2.m1.24.53.1.cmml" xref="S2.Ex2.m1.24.53.1">(</ci><apply id="S2.Ex2.m1.24.53.2.cmml" xref="S2.Ex2.m1.24.53.2"><csymbol cd="ambiguous" id="S2.Ex2.m1.24.53.2.1.cmml" xref="S2.Ex2.m1.24.53.2">subscript</csymbol><ci id="S2.Ex2.m1.24.53.2.2.cmml" xref="S2.Ex2.m1.24.53.2.2">𝜃</ci><list id="S2.Ex2.m1.6.6.2.3.cmml" xref="S2.Ex2.m1.6.6.2.4"><cn type="integer" id="S2.Ex2.m1.5.5.1.1.cmml" xref="S2.Ex2.m1.5.5.1.1">1</cn><cn type="integer" id="S2.Ex2.m1.6.6.2.2.cmml" xref="S2.Ex2.m1.6.6.2.2">1</cn></list></apply><ci id="S2.Ex2.m1.24.53.3.cmml" xref="S2.Ex2.m1.24.53.3">)</ci></cerror><ci id="S2.Ex2.m1.24.54b.cmml" xref="S2.Ex2.m1.24.54"><merror class="ltx_ERROR undefined undefined" id="S2.Ex2.m1.24.54.cmml" xref="S2.Ex2.m1.24.54"><mtext id="S2.Ex2.m1.24.54a.cmml" xref="S2.Ex2.m1.24.54">\qw</mtext></merror></ci><ci id="S2.Ex2.m1.24.55b.cmml" xref="S2.Ex2.m1.24.55"><merror class="ltx_ERROR undefined undefined" id="S2.Ex2.m1.24.55.cmml" xref="S2.Ex2.m1.24.55"><mtext id="S2.Ex2.m1.24.55a.cmml" xref="S2.Ex2.m1.24.55">\gate</mtext></merror></ci><apply id="S2.Ex2.m1.24.56.cmml" xref="S2.Ex2.m1.24.56"><csymbol cd="ambiguous" id="S2.Ex2.m1.24.56.1.cmml" xref="S2.Ex2.m1.24.56">subscript</csymbol><ci id="S2.Ex2.m1.24.56.2.cmml" xref="S2.Ex2.m1.24.56.2">𝑅</ci><ci id="S2.Ex2.m1.24.56.3.cmml" xref="S2.Ex2.m1.24.56.3">𝑥</ci></apply><cerror id="S2.Ex2.m1.24.57.cmml" xref="S2.Ex2.m1.24.57"><csymbol cd="ambiguous" id="S2.Ex2.m1.24.57a.cmml" xref="S2.Ex2.m1.24.57">fragments</csymbol><ci id="S2.Ex2.m1.24.57.1.cmml" xref="S2.Ex2.m1.24.57.1">(</ci><apply id="S2.Ex2.m1.24.57.2.cmml" xref="S2.Ex2.m1.24.57.2"><csymbol cd="ambiguous" id="S2.Ex2.m1.24.57.2.1.cmml" xref="S2.Ex2.m1.24.57.2">subscript</csymbol><ci id="S2.Ex2.m1.24.57.2.2.cmml" xref="S2.Ex2.m1.24.57.2.2">𝜃</ci><list id="S2.Ex2.m1.8.8.2.3.cmml" xref="S2.Ex2.m1.8.8.2.4"><cn type="integer" id="S2.Ex2.m1.7.7.1.1.cmml" xref="S2.Ex2.m1.7.7.1.1">0</cn><cn type="integer" id="S2.Ex2.m1.8.8.2.2.cmml" xref="S2.Ex2.m1.8.8.2.2">2</cn></list></apply><ci id="S2.Ex2.m1.24.57.3.cmml" xref="S2.Ex2.m1.24.57.3">)</ci></cerror><ci id="S2.Ex2.m1.24.58b.cmml" xref="S2.Ex2.m1.24.58"><merror class="ltx_ERROR undefined undefined" id="S2.Ex2.m1.24.58.cmml" xref="S2.Ex2.m1.24.58"><mtext id="S2.Ex2.m1.24.58a.cmml" xref="S2.Ex2.m1.24.58">\gate</mtext></merror></ci><apply id="S2.Ex2.m1.24.59.cmml" xref="S2.Ex2.m1.24.59"><csymbol cd="ambiguous" id="S2.Ex2.m1.24.59.1.cmml" xref="S2.Ex2.m1.24.59">subscript</csymbol><ci id="S2.Ex2.m1.24.59.2.cmml" xref="S2.Ex2.m1.24.59.2">𝑅</ci><ci id="S2.Ex2.m1.24.59.3.cmml" xref="S2.Ex2.m1.24.59.3">𝑦</ci></apply><cerror id="S2.Ex2.m1.24.60.cmml" xref="S2.Ex2.m1.24.60"><csymbol cd="ambiguous" id="S2.Ex2.m1.24.60a.cmml" xref="S2.Ex2.m1.24.60">fragments</csymbol><ci id="S2.Ex2.m1.24.60.1.cmml" xref="S2.Ex2.m1.24.60.1">(</ci><apply id="S2.Ex2.m1.24.60.2.cmml" xref="S2.Ex2.m1.24.60.2"><csymbol cd="ambiguous" id="S2.Ex2.m1.24.60.2.1.cmml" xref="S2.Ex2.m1.24.60.2">subscript</csymbol><ci id="S2.Ex2.m1.24.60.2.2.cmml" xref="S2.Ex2.m1.24.60.2.2">𝜃</ci><list id="S2.Ex2.m1.10.10.2.3.cmml" xref="S2.Ex2.m1.10.10.2.4"><cn type="integer" id="S2.Ex2.m1.9.9.1.1.cmml" xref="S2.Ex2.m1.9.9.1.1">0</cn><cn type="integer" id="S2.Ex2.m1.10.10.2.2.cmml" xref="S2.Ex2.m1.10.10.2.2">6</cn></list></apply><ci id="S2.Ex2.m1.24.60.3.cmml" xref="S2.Ex2.m1.24.60.3">)</ci></cerror><ci id="S2.Ex2.m1.24.61b.cmml" xref="S2.Ex2.m1.24.61"><merror class="ltx_ERROR undefined undefined" id="S2.Ex2.m1.24.61.cmml" xref="S2.Ex2.m1.24.61"><mtext id="S2.Ex2.m1.24.61a.cmml" xref="S2.Ex2.m1.24.61">\targ</mtext></merror></ci><ci id="S2.Ex2.m1.24.62b.cmml" xref="S2.Ex2.m1.24.62"><merror class="ltx_ERROR undefined undefined" id="S2.Ex2.m1.24.62.cmml" xref="S2.Ex2.m1.24.62"><mtext id="S2.Ex2.m1.24.62a.cmml" xref="S2.Ex2.m1.24.62">\ctrl</mtext></merror></ci><plus id="S2.Ex2.m1.24.63.cmml" xref="S2.Ex2.m1.24.63"></plus><cn type="integer" id="S2.Ex2.m1.24.64.cmml" xref="S2.Ex2.m1.24.64">1</cn><ci id="S2.Ex2.m1.24.65b.cmml" xref="S2.Ex2.m1.24.65"><merror class="ltx_ERROR undefined undefined" id="S2.Ex2.m1.24.65.cmml" xref="S2.Ex2.m1.24.65"><mtext id="S2.Ex2.m1.24.65a.cmml" xref="S2.Ex2.m1.24.65">\qw</mtext></merror></ci><ci id="S2.Ex2.m1.24.66b.cmml" xref="S2.Ex2.m1.24.66"><merror class="ltx_ERROR undefined undefined" id="S2.Ex2.m1.24.66.cmml" xref="S2.Ex2.m1.24.66"><mtext id="S2.Ex2.m1.24.66a.cmml" xref="S2.Ex2.m1.24.66">\qw</mtext></merror></ci><ci id="S2.Ex2.m1.24.67b.cmml" xref="S2.Ex2.m1.24.67"><merror class="ltx_ERROR undefined undefined" id="S2.Ex2.m1.24.67.cmml" xref="S2.Ex2.m1.24.67"><mtext id="S2.Ex2.m1.24.67a.cmml" xref="S2.Ex2.m1.24.67">\gate</mtext></merror></ci><apply id="S2.Ex2.m1.24.68.cmml" xref="S2.Ex2.m1.24.68"><csymbol cd="ambiguous" id="S2.Ex2.m1.24.68.1.cmml" xref="S2.Ex2.m1.24.68">subscript</csymbol><ci id="S2.Ex2.m1.24.68.2.cmml" xref="S2.Ex2.m1.24.68.2">𝑅</ci><ci id="S2.Ex2.m1.24.68.3.cmml" xref="S2.Ex2.m1.24.68.3">𝑦</ci></apply><cerror id="S2.Ex2.m1.24.69.cmml" xref="S2.Ex2.m1.24.69"><csymbol cd="ambiguous" id="S2.Ex2.m1.24.69a.cmml" xref="S2.Ex2.m1.24.69">fragments</csymbol><ci id="S2.Ex2.m1.24.69.1.cmml" xref="S2.Ex2.m1.24.69.1">(</ci><apply id="S2.Ex2.m1.24.69.2.cmml" xref="S2.Ex2.m1.24.69.2"><csymbol cd="ambiguous" id="S2.Ex2.m1.24.69.2.1.cmml" xref="S2.Ex2.m1.24.69.2">subscript</csymbol><ci id="S2.Ex2.m1.24.69.2.2.cmml" xref="S2.Ex2.m1.24.69.2.2">𝜃</ci><list id="S2.Ex2.m1.12.12.2.3.cmml" xref="S2.Ex2.m1.12.12.2.4"><cn type="integer" id="S2.Ex2.m1.11.11.1.1.cmml" xref="S2.Ex2.m1.11.11.1.1">1</cn><cn type="integer" id="S2.Ex2.m1.12.12.2.2.cmml" xref="S2.Ex2.m1.12.12.2.2">2</cn></list></apply><ci id="S2.Ex2.m1.24.69.3.cmml" xref="S2.Ex2.m1.24.69.3">)</ci></cerror><ci id="S2.Ex2.m1.24.70b.cmml" xref="S2.Ex2.m1.24.70"><merror class="ltx_ERROR undefined undefined" id="S2.Ex2.m1.24.70.cmml" xref="S2.Ex2.m1.24.70"><mtext id="S2.Ex2.m1.24.70a.cmml" xref="S2.Ex2.m1.24.70">\qw</mtext></merror></ci><ci id="S2.Ex2.m1.24.71b.cmml" xref="S2.Ex2.m1.24.71"><merror class="ltx_ERROR undefined undefined" id="S2.Ex2.m1.24.71.cmml" xref="S2.Ex2.m1.24.71"><mtext id="S2.Ex2.m1.24.71a.cmml" xref="S2.Ex2.m1.24.71">\gate</mtext></merror></ci><apply id="S2.Ex2.m1.24.72.cmml" xref="S2.Ex2.m1.24.72"><csymbol cd="ambiguous" id="S2.Ex2.m1.24.72.1.cmml" xref="S2.Ex2.m1.24.72">subscript</csymbol><ci id="S2.Ex2.m1.24.72.2.cmml" xref="S2.Ex2.m1.24.72.2">𝑅</ci><ci id="S2.Ex2.m1.24.72.3.cmml" xref="S2.Ex2.m1.24.72.3">𝑥</ci></apply><cerror id="S2.Ex2.m1.24.73.cmml" xref="S2.Ex2.m1.24.73"><csymbol cd="ambiguous" id="S2.Ex2.m1.24.73a.cmml" xref="S2.Ex2.m1.24.73">fragments</csymbol><ci id="S2.Ex2.m1.24.73.1.cmml" xref="S2.Ex2.m1.24.73.1">(</ci><apply id="S2.Ex2.m1.24.73.2.cmml" xref="S2.Ex2.m1.24.73.2"><csymbol cd="ambiguous" id="S2.Ex2.m1.24.73.2.1.cmml" xref="S2.Ex2.m1.24.73.2">subscript</csymbol><ci id="S2.Ex2.m1.24.73.2.2.cmml" xref="S2.Ex2.m1.24.73.2.2">𝜃</ci><list id="S2.Ex2.m1.14.14.2.3.cmml" xref="S2.Ex2.m1.14.14.2.4"><cn type="integer" id="S2.Ex2.m1.13.13.1.1.cmml" xref="S2.Ex2.m1.13.13.1.1">0</cn><cn type="integer" id="S2.Ex2.m1.14.14.2.2.cmml" xref="S2.Ex2.m1.14.14.2.2">3</cn></list></apply><ci id="S2.Ex2.m1.24.73.3.cmml" xref="S2.Ex2.m1.24.73.3">)</ci></cerror><ci id="S2.Ex2.m1.24.74b.cmml" xref="S2.Ex2.m1.24.74"><merror class="ltx_ERROR undefined undefined" id="S2.Ex2.m1.24.74.cmml" xref="S2.Ex2.m1.24.74"><mtext id="S2.Ex2.m1.24.74a.cmml" xref="S2.Ex2.m1.24.74">\gate</mtext></merror></ci><apply id="S2.Ex2.m1.24.75.cmml" xref="S2.Ex2.m1.24.75"><csymbol cd="ambiguous" id="S2.Ex2.m1.24.75.1.cmml" xref="S2.Ex2.m1.24.75">subscript</csymbol><ci id="S2.Ex2.m1.24.75.2.cmml" xref="S2.Ex2.m1.24.75.2">𝑅</ci><ci id="S2.Ex2.m1.24.75.3.cmml" xref="S2.Ex2.m1.24.75.3">𝑦</ci></apply><cerror id="S2.Ex2.m1.24.76.cmml" xref="S2.Ex2.m1.24.76"><csymbol cd="ambiguous" id="S2.Ex2.m1.24.76a.cmml" xref="S2.Ex2.m1.24.76">fragments</csymbol><ci id="S2.Ex2.m1.24.76.1.cmml" xref="S2.Ex2.m1.24.76.1">(</ci><apply id="S2.Ex2.m1.24.76.2.cmml" xref="S2.Ex2.m1.24.76.2"><csymbol cd="ambiguous" id="S2.Ex2.m1.24.76.2.1.cmml" xref="S2.Ex2.m1.24.76.2">subscript</csymbol><ci id="S2.Ex2.m1.24.76.2.2.cmml" xref="S2.Ex2.m1.24.76.2.2">𝜃</ci><list id="S2.Ex2.m1.16.16.2.3.cmml" xref="S2.Ex2.m1.16.16.2.4"><cn type="integer" id="S2.Ex2.m1.15.15.1.1.cmml" xref="S2.Ex2.m1.15.15.1.1">0</cn><cn type="integer" id="S2.Ex2.m1.16.16.2.2.cmml" xref="S2.Ex2.m1.16.16.2.2">7</cn></list></apply><ci id="S2.Ex2.m1.24.76.3.cmml" xref="S2.Ex2.m1.24.76.3">)</ci></cerror><ci id="S2.Ex2.m1.24.77b.cmml" xref="S2.Ex2.m1.24.77"><merror class="ltx_ERROR undefined undefined" id="S2.Ex2.m1.24.77.cmml" xref="S2.Ex2.m1.24.77"><mtext id="S2.Ex2.m1.24.77a.cmml" xref="S2.Ex2.m1.24.77">\qw</mtext></merror></ci><ci id="S2.Ex2.m1.24.78b.cmml" xref="S2.Ex2.m1.24.78"><merror class="ltx_ERROR undefined undefined" id="S2.Ex2.m1.24.78.cmml" xref="S2.Ex2.m1.24.78"><mtext id="S2.Ex2.m1.24.78a.cmml" xref="S2.Ex2.m1.24.78">\targ</mtext></merror></ci><ci id="S2.Ex2.m1.24.79b.cmml" xref="S2.Ex2.m1.24.79"><merror class="ltx_ERROR undefined undefined" id="S2.Ex2.m1.24.79.cmml" xref="S2.Ex2.m1.24.79"><mtext id="S2.Ex2.m1.24.79a.cmml" xref="S2.Ex2.m1.24.79">\ctrl</mtext></merror></ci><plus id="S2.Ex2.m1.24.80.cmml" xref="S2.Ex2.m1.24.80"></plus><cn type="integer" id="S2.Ex2.m1.24.81.cmml" xref="S2.Ex2.m1.24.81">1</cn><ci id="S2.Ex2.m1.24.82b.cmml" xref="S2.Ex2.m1.24.82"><merror class="ltx_ERROR undefined undefined" id="S2.Ex2.m1.24.82.cmml" xref="S2.Ex2.m1.24.82"><mtext id="S2.Ex2.m1.24.82a.cmml" xref="S2.Ex2.m1.24.82">\qw</mtext></merror></ci><ci id="S2.Ex2.m1.24.83b.cmml" xref="S2.Ex2.m1.24.83"><merror class="ltx_ERROR undefined undefined" id="S2.Ex2.m1.24.83.cmml" xref="S2.Ex2.m1.24.83"><mtext id="S2.Ex2.m1.24.83a.cmml" xref="S2.Ex2.m1.24.83">\gate</mtext></merror></ci><apply id="S2.Ex2.m1.24.84.cmml" xref="S2.Ex2.m1.24.84"><csymbol cd="ambiguous" id="S2.Ex2.m1.24.84.1.cmml" xref="S2.Ex2.m1.24.84">subscript</csymbol><ci id="S2.Ex2.m1.24.84.2.cmml" xref="S2.Ex2.m1.24.84.2">𝑅</ci><ci id="S2.Ex2.m1.24.84.3.cmml" xref="S2.Ex2.m1.24.84.3">𝑦</ci></apply><cerror id="S2.Ex2.m1.24.85.cmml" xref="S2.Ex2.m1.24.85"><csymbol cd="ambiguous" id="S2.Ex2.m1.24.85a.cmml" xref="S2.Ex2.m1.24.85">fragments</csymbol><ci id="S2.Ex2.m1.24.85.1.cmml" xref="S2.Ex2.m1.24.85.1">(</ci><apply id="S2.Ex2.m1.24.85.2.cmml" xref="S2.Ex2.m1.24.85.2"><csymbol cd="ambiguous" id="S2.Ex2.m1.24.85.2.1.cmml" xref="S2.Ex2.m1.24.85.2">subscript</csymbol><ci id="S2.Ex2.m1.24.85.2.2.cmml" xref="S2.Ex2.m1.24.85.2.2">𝜃</ci><list id="S2.Ex2.m1.18.18.2.3.cmml" xref="S2.Ex2.m1.18.18.2.4"><cn type="integer" id="S2.Ex2.m1.17.17.1.1.cmml" xref="S2.Ex2.m1.17.17.1.1">1</cn><cn type="integer" id="S2.Ex2.m1.18.18.2.2.cmml" xref="S2.Ex2.m1.18.18.2.2">3</cn></list></apply><ci id="S2.Ex2.m1.24.85.3.cmml" xref="S2.Ex2.m1.24.85.3">)</ci></cerror><ci id="S2.Ex2.m1.24.86b.cmml" xref="S2.Ex2.m1.24.86"><merror class="ltx_ERROR undefined undefined" id="S2.Ex2.m1.24.86.cmml" xref="S2.Ex2.m1.24.86"><mtext id="S2.Ex2.m1.24.86a.cmml" xref="S2.Ex2.m1.24.86">\qw</mtext></merror></ci><ci id="S2.Ex2.m1.24.87b.cmml" xref="S2.Ex2.m1.24.87"><merror class="ltx_ERROR undefined undefined" id="S2.Ex2.m1.24.87.cmml" xref="S2.Ex2.m1.24.87"><mtext id="S2.Ex2.m1.24.87a.cmml" xref="S2.Ex2.m1.24.87">\gate</mtext></merror></ci><apply id="S2.Ex2.m1.24.88.cmml" xref="S2.Ex2.m1.24.88"><csymbol cd="ambiguous" id="S2.Ex2.m1.24.88.1.cmml" xref="S2.Ex2.m1.24.88">subscript</csymbol><ci id="S2.Ex2.m1.24.88.2.cmml" xref="S2.Ex2.m1.24.88.2">𝑅</ci><ci id="S2.Ex2.m1.24.88.3.cmml" xref="S2.Ex2.m1.24.88.3">𝑥</ci></apply><cerror id="S2.Ex2.m1.24.89.cmml" xref="S2.Ex2.m1.24.89"><csymbol cd="ambiguous" id="S2.Ex2.m1.24.89a.cmml" xref="S2.Ex2.m1.24.89">fragments</csymbol><ci id="S2.Ex2.m1.24.89.1.cmml" xref="S2.Ex2.m1.24.89.1">(</ci><apply id="S2.Ex2.m1.24.89.2.cmml" xref="S2.Ex2.m1.24.89.2"><csymbol cd="ambiguous" id="S2.Ex2.m1.24.89.2.1.cmml" xref="S2.Ex2.m1.24.89.2">subscript</csymbol><ci id="S2.Ex2.m1.24.89.2.2.cmml" xref="S2.Ex2.m1.24.89.2.2">𝜃</ci><list id="S2.Ex2.m1.20.20.2.3.cmml" xref="S2.Ex2.m1.20.20.2.4"><cn type="integer" id="S2.Ex2.m1.19.19.1.1.cmml" xref="S2.Ex2.m1.19.19.1.1">0</cn><cn type="integer" id="S2.Ex2.m1.20.20.2.2.cmml" xref="S2.Ex2.m1.20.20.2.2">4</cn></list></apply><ci id="S2.Ex2.m1.24.89.3.cmml" xref="S2.Ex2.m1.24.89.3">)</ci></cerror><ci id="S2.Ex2.m1.24.90b.cmml" xref="S2.Ex2.m1.24.90"><merror class="ltx_ERROR undefined undefined" id="S2.Ex2.m1.24.90.cmml" xref="S2.Ex2.m1.24.90"><mtext id="S2.Ex2.m1.24.90a.cmml" xref="S2.Ex2.m1.24.90">\gate</mtext></merror></ci><apply id="S2.Ex2.m1.24.91.cmml" xref="S2.Ex2.m1.24.91"><csymbol cd="ambiguous" id="S2.Ex2.m1.24.91.1.cmml" xref="S2.Ex2.m1.24.91">subscript</csymbol><ci id="S2.Ex2.m1.24.91.2.cmml" xref="S2.Ex2.m1.24.91.2">𝑅</ci><ci id="S2.Ex2.m1.24.91.3.cmml" xref="S2.Ex2.m1.24.91.3">𝑦</ci></apply><cerror id="S2.Ex2.m1.24.92.cmml" xref="S2.Ex2.m1.24.92"><csymbol cd="ambiguous" id="S2.Ex2.m1.24.92a.cmml" xref="S2.Ex2.m1.24.92">fragments</csymbol><ci id="S2.Ex2.m1.24.92.1.cmml" xref="S2.Ex2.m1.24.92.1">(</ci><apply id="S2.Ex2.m1.24.92.2.cmml" xref="S2.Ex2.m1.24.92.2"><csymbol cd="ambiguous" id="S2.Ex2.m1.24.92.2.1.cmml" xref="S2.Ex2.m1.24.92.2">subscript</csymbol><ci id="S2.Ex2.m1.24.92.2.2.cmml" xref="S2.Ex2.m1.24.92.2.2">𝜃</ci><list id="S2.Ex2.m1.22.22.2.3.cmml" xref="S2.Ex2.m1.22.22.2.4"><cn type="integer" id="S2.Ex2.m1.21.21.1.1.cmml" xref="S2.Ex2.m1.21.21.1.1">0</cn><cn type="integer" id="S2.Ex2.m1.22.22.2.2.cmml" xref="S2.Ex2.m1.22.22.2.2">8</cn></list></apply><ci id="S2.Ex2.m1.24.92.3.cmml" xref="S2.Ex2.m1.24.92.3">)</ci></cerror><ci id="S2.Ex2.m1.24.93b.cmml" xref="S2.Ex2.m1.24.93"><merror class="ltx_ERROR undefined undefined" id="S2.Ex2.m1.24.93.cmml" xref="S2.Ex2.m1.24.93"><mtext id="S2.Ex2.m1.24.93a.cmml" xref="S2.Ex2.m1.24.93">\qw</mtext></merror></ci><ci id="S2.Ex2.m1.24.94b.cmml" xref="S2.Ex2.m1.24.94"><merror class="ltx_ERROR undefined undefined" id="S2.Ex2.m1.24.94.cmml" xref="S2.Ex2.m1.24.94"><mtext id="S2.Ex2.m1.24.94a.cmml" xref="S2.Ex2.m1.24.94">\qw</mtext></merror></ci><ci id="S2.Ex2.m1.24.95b.cmml" xref="S2.Ex2.m1.24.95"><merror class="ltx_ERROR undefined undefined" id="S2.Ex2.m1.24.95.cmml" xref="S2.Ex2.m1.24.95"><mtext id="S2.Ex2.m1.24.95a.cmml" xref="S2.Ex2.m1.24.95">\targ</mtext></merror></ci><ci id="S2.Ex2.m1.24.96b.cmml" xref="S2.Ex2.m1.24.96"><merror class="ltx_ERROR undefined undefined" id="S2.Ex2.m1.24.96.cmml" xref="S2.Ex2.m1.24.96"><mtext id="S2.Ex2.m1.24.96a.cmml" xref="S2.Ex2.m1.24.96">\ctrl</mtext></merror></ci><minus id="S2.Ex2.m1.24.97.cmml" xref="S2.Ex2.m1.24.97"></minus><cn type="integer" id="S2.Ex2.m1.24.98.cmml" xref="S2.Ex2.m1.24.98">3</cn><ci id="S2.Ex2.m1.24.99b.cmml" xref="S2.Ex2.m1.24.99"><merror class="ltx_ERROR undefined undefined" id="S2.Ex2.m1.24.99.cmml" xref="S2.Ex2.m1.24.99"><mtext id="S2.Ex2.m1.24.99a.cmml" xref="S2.Ex2.m1.24.99">\gate</mtext></merror></ci><apply id="S2.Ex2.m1.24.100.cmml" xref="S2.Ex2.m1.24.100"><csymbol cd="ambiguous" id="S2.Ex2.m1.24.100.1.cmml" xref="S2.Ex2.m1.24.100">subscript</csymbol><ci id="S2.Ex2.m1.24.100.2.cmml" xref="S2.Ex2.m1.24.100.2">𝑅</ci><ci id="S2.Ex2.m1.24.100.3.cmml" xref="S2.Ex2.m1.24.100.3">𝑦</ci></apply><cerror id="S2.Ex2.m1.24.101.cmml" xref="S2.Ex2.m1.24.101"><csymbol cd="ambiguous" id="S2.Ex2.m1.24.101a.cmml" xref="S2.Ex2.m1.24.101">fragments</csymbol><ci id="S2.Ex2.m1.24.101.1.cmml" xref="S2.Ex2.m1.24.101.1">(</ci><apply id="S2.Ex2.m1.24.101.2.cmml" xref="S2.Ex2.m1.24.101.2"><csymbol cd="ambiguous" id="S2.Ex2.m1.24.101.2.1.cmml" xref="S2.Ex2.m1.24.101.2">subscript</csymbol><ci id="S2.Ex2.m1.24.101.2.2.cmml" xref="S2.Ex2.m1.24.101.2.2">𝜃</ci><list id="S2.Ex2.m1.24.24.2.3.cmml" xref="S2.Ex2.m1.24.24.2.4"><cn type="integer" id="S2.Ex2.m1.23.23.1.1.cmml" xref="S2.Ex2.m1.23.23.1.1">1</cn><cn type="integer" id="S2.Ex2.m1.24.24.2.2.cmml" xref="S2.Ex2.m1.24.24.2.2">4</cn></list></apply><ci id="S2.Ex2.m1.24.101.3.cmml" xref="S2.Ex2.m1.24.101.3">)</ci></cerror><ci id="S2.Ex2.m1.24.102b.cmml" xref="S2.Ex2.m1.24.102"><merror class="ltx_ERROR undefined undefined" id="S2.Ex2.m1.24.102.cmml" xref="S2.Ex2.m1.24.102"><mtext id="S2.Ex2.m1.24.102a.cmml" xref="S2.Ex2.m1.24.102">\qw</mtext></merror></ci><ci id="S2.Ex2.m1.24.103b.cmml" xref="S2.Ex2.m1.24.103"><merror class="ltx_ERROR undefined undefined" id="S2.Ex2.m1.24.103.cmml" xref="S2.Ex2.m1.24.103"><mtext id="S2.Ex2.m1.24.103a.cmml" xref="S2.Ex2.m1.24.103">\gategroup</mtext></merror></ci><cn type="float" id="S2.Ex2.m1.24.104.cmml" xref="S2.Ex2.m1.24.104">14481.0</cn><csymbol cd="unknown" id="S2.Ex2.m1.24.105.cmml" xref="S2.Ex2.m1.24.105">e</csymbol><csymbol cd="unknown" id="S2.Ex2.m1.24.106.cmml" xref="S2.Ex2.m1.24.106">m</csymbol><minus id="S2.Ex2.m1.24.107.cmml" xref="S2.Ex2.m1.24.107"></minus><minus id="S2.Ex2.m1.24.108.cmml" xref="S2.Ex2.m1.24.108"></minus><ci id="S2.Ex2.m1.24.109.cmml" xref="S2.Ex2.m1.24.109">italic-  </ci><times id="S2.Ex2.m1.24.110.cmml" xref="S2.Ex2.m1.24.110"></times><csymbol cd="unknown" id="S2.Ex2.m1.24.111.cmml" xref="S2.Ex2.m1.24.111">D</csymbol></cerror></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex2.m1.24f">\Qcircuit@C=1.5em@R=0.5em{&amp;\gate{R_{x}(\theta_{0,1})}\gate{R_{y}(\theta_{0,5})%
}\ctrl{+1}\qw\qw\targ\gate{R_{y}(\theta_{1,1})}\qw\\
\gate{R_{x}(\theta_{0,2})}\gate{R_{y}(\theta_{0,6})}\targ\ctrl{+1}\qw\qw\gate{%
R_{y}(\theta_{1,2})}\qw\\
\gate{R_{x}(\theta_{0,3})}\gate{R_{y}(\theta_{0,7})}\qw\targ\ctrl{+1}\qw\gate{%
R_{y}(\theta_{1,3})}\qw\\
\gate{R_{x}(\theta_{0,4})}\gate{R_{y}(\theta_{0,8})}\qw\qw\targ\ctrl{-3}\gate{%
R_{y}(\theta_{1,4})}\qw\gategroup{1}{4}{4}{8}{1.0em}{--}\\
\ \ \ \ \times D}</annotation><annotation encoding="application/x-llamapun" id="S2.Ex2.m1.24g">@ italic_C = 1.5 italic_e italic_m @ italic_R = 0.5 italic_e italic_m &amp; italic_R start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT ( italic_θ start_POSTSUBSCRIPT 0 , 1 end_POSTSUBSCRIPT ) italic_R start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT ( italic_θ start_POSTSUBSCRIPT 0 , 5 end_POSTSUBSCRIPT ) + 1 italic_R start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT ( italic_θ start_POSTSUBSCRIPT 1 , 1 end_POSTSUBSCRIPT ) italic_R start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT ( italic_θ start_POSTSUBSCRIPT 0 , 2 end_POSTSUBSCRIPT ) italic_R start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT ( italic_θ start_POSTSUBSCRIPT 0 , 6 end_POSTSUBSCRIPT ) + 1 italic_R start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT ( italic_θ start_POSTSUBSCRIPT 1 , 2 end_POSTSUBSCRIPT ) italic_R start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT ( italic_θ start_POSTSUBSCRIPT 0 , 3 end_POSTSUBSCRIPT ) italic_R start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT ( italic_θ start_POSTSUBSCRIPT 0 , 7 end_POSTSUBSCRIPT ) + 1 italic_R start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT ( italic_θ start_POSTSUBSCRIPT 1 , 3 end_POSTSUBSCRIPT ) italic_R start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT ( italic_θ start_POSTSUBSCRIPT 0 , 4 end_POSTSUBSCRIPT ) italic_R start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT ( italic_θ start_POSTSUBSCRIPT 0 , 8 end_POSTSUBSCRIPT ) - 3 italic_R start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT ( italic_θ start_POSTSUBSCRIPT 1 , 4 end_POSTSUBSCRIPT ) 14481.0 italic_e italic_m - - × italic_D</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>The ansatz used in QSANN. The first two columns denote the <math id="S2.F2.5.m1.1" class="ltx_Math" alttext="R_{x}" display="inline"><semantics id="S2.F2.5.m1.1b"><msub id="S2.F2.5.m1.1.1" xref="S2.F2.5.m1.1.1.cmml"><mi id="S2.F2.5.m1.1.1.2" xref="S2.F2.5.m1.1.1.2.cmml">R</mi><mi id="S2.F2.5.m1.1.1.3" xref="S2.F2.5.m1.1.1.3.cmml">x</mi></msub><annotation-xml encoding="MathML-Content" id="S2.F2.5.m1.1c"><apply id="S2.F2.5.m1.1.1.cmml" xref="S2.F2.5.m1.1.1"><csymbol cd="ambiguous" id="S2.F2.5.m1.1.1.1.cmml" xref="S2.F2.5.m1.1.1">subscript</csymbol><ci id="S2.F2.5.m1.1.1.2.cmml" xref="S2.F2.5.m1.1.1.2">𝑅</ci><ci id="S2.F2.5.m1.1.1.3.cmml" xref="S2.F2.5.m1.1.1.3">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.5.m1.1d">R_{x}</annotation><annotation encoding="application/x-llamapun" id="S2.F2.5.m1.1e">italic_R start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT</annotation></semantics></math>-<math id="S2.F2.6.m2.1" class="ltx_Math" alttext="R_{y}" display="inline"><semantics id="S2.F2.6.m2.1b"><msub id="S2.F2.6.m2.1.1" xref="S2.F2.6.m2.1.1.cmml"><mi id="S2.F2.6.m2.1.1.2" xref="S2.F2.6.m2.1.1.2.cmml">R</mi><mi id="S2.F2.6.m2.1.1.3" xref="S2.F2.6.m2.1.1.3.cmml">y</mi></msub><annotation-xml encoding="MathML-Content" id="S2.F2.6.m2.1c"><apply id="S2.F2.6.m2.1.1.cmml" xref="S2.F2.6.m2.1.1"><csymbol cd="ambiguous" id="S2.F2.6.m2.1.1.1.cmml" xref="S2.F2.6.m2.1.1">subscript</csymbol><ci id="S2.F2.6.m2.1.1.2.cmml" xref="S2.F2.6.m2.1.1.2">𝑅</ci><ci id="S2.F2.6.m2.1.1.3.cmml" xref="S2.F2.6.m2.1.1.3">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.6.m2.1d">R_{y}</annotation><annotation encoding="application/x-llamapun" id="S2.F2.6.m2.1e">italic_R start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT</annotation></semantics></math> rotations on each single-qubit subspace, then followed by repeated CNOT gates and single-qubit <math id="S2.F2.7.m3.1" class="ltx_Math" alttext="R_{y}" display="inline"><semantics id="S2.F2.7.m3.1b"><msub id="S2.F2.7.m3.1.1" xref="S2.F2.7.m3.1.1.cmml"><mi id="S2.F2.7.m3.1.1.2" xref="S2.F2.7.m3.1.1.2.cmml">R</mi><mi id="S2.F2.7.m3.1.1.3" xref="S2.F2.7.m3.1.1.3.cmml">y</mi></msub><annotation-xml encoding="MathML-Content" id="S2.F2.7.m3.1c"><apply id="S2.F2.7.m3.1.1.cmml" xref="S2.F2.7.m3.1.1"><csymbol cd="ambiguous" id="S2.F2.7.m3.1.1.1.cmml" xref="S2.F2.7.m3.1.1">subscript</csymbol><ci id="S2.F2.7.m3.1.1.2.cmml" xref="S2.F2.7.m3.1.1.2">𝑅</ci><ci id="S2.F2.7.m3.1.1.3.cmml" xref="S2.F2.7.m3.1.1.3">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.7.m3.1d">R_{y}</annotation><annotation encoding="application/x-llamapun" id="S2.F2.7.m3.1e">italic_R start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT</annotation></semantics></math> rotations. The block circuit in the dashed box is repeated <math id="S2.F2.8.m4.1" class="ltx_Math" alttext="D" display="inline"><semantics id="S2.F2.8.m4.1b"><mi id="S2.F2.8.m4.1.1" xref="S2.F2.8.m4.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S2.F2.8.m4.1c"><ci id="S2.F2.8.m4.1.1.cmml" xref="S2.F2.8.m4.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.8.m4.1d">D</annotation><annotation encoding="application/x-llamapun" id="S2.F2.8.m4.1e">italic_D</annotation></semantics></math> times to enhance the expressive power of the ansatz.</figcaption>
</figure>
</section>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Ansatz Selection</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.1" class="ltx_p">In QSAL, we employ multiple ansatzes for the various components, i.e., data encoding, query, key and value. Hence, we give a brief review about it here.</p>
</div>
<div id="S2.SS2.p2" class="ltx_para">
<p id="S2.SS2.p2.8" class="ltx_p">In general, an ansatz, a.k.a. parameterized quantum circuit <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>, has the form
<math id="S2.SS2.p2.1.m1.2" class="ltx_Math" alttext="U({\bm{\theta}})=\prod_{j}U_{j}(\theta_{j})V_{j}," display="inline"><semantics id="S2.SS2.p2.1.m1.2a"><mrow id="S2.SS2.p2.1.m1.2.2.1" xref="S2.SS2.p2.1.m1.2.2.1.1.cmml"><mrow id="S2.SS2.p2.1.m1.2.2.1.1" xref="S2.SS2.p2.1.m1.2.2.1.1.cmml"><mrow id="S2.SS2.p2.1.m1.2.2.1.1.3" xref="S2.SS2.p2.1.m1.2.2.1.1.3.cmml"><mi id="S2.SS2.p2.1.m1.2.2.1.1.3.2" xref="S2.SS2.p2.1.m1.2.2.1.1.3.2.cmml">U</mi><mo id="S2.SS2.p2.1.m1.2.2.1.1.3.1" xref="S2.SS2.p2.1.m1.2.2.1.1.3.1.cmml">⁢</mo><mrow id="S2.SS2.p2.1.m1.2.2.1.1.3.3.2" xref="S2.SS2.p2.1.m1.2.2.1.1.3.cmml"><mo stretchy="false" id="S2.SS2.p2.1.m1.2.2.1.1.3.3.2.1" xref="S2.SS2.p2.1.m1.2.2.1.1.3.cmml">(</mo><mi id="S2.SS2.p2.1.m1.1.1" xref="S2.SS2.p2.1.m1.1.1.cmml">𝜽</mi><mo stretchy="false" id="S2.SS2.p2.1.m1.2.2.1.1.3.3.2.2" xref="S2.SS2.p2.1.m1.2.2.1.1.3.cmml">)</mo></mrow></mrow><mo id="S2.SS2.p2.1.m1.2.2.1.1.2" xref="S2.SS2.p2.1.m1.2.2.1.1.2.cmml">=</mo><mrow id="S2.SS2.p2.1.m1.2.2.1.1.1" xref="S2.SS2.p2.1.m1.2.2.1.1.1.cmml"><msub id="S2.SS2.p2.1.m1.2.2.1.1.1.2" xref="S2.SS2.p2.1.m1.2.2.1.1.1.2.cmml"><mo largeop="true" symmetric="true" id="S2.SS2.p2.1.m1.2.2.1.1.1.2.2" xref="S2.SS2.p2.1.m1.2.2.1.1.1.2.2.cmml">∏</mo><mi id="S2.SS2.p2.1.m1.2.2.1.1.1.2.3" xref="S2.SS2.p2.1.m1.2.2.1.1.1.2.3.cmml">j</mi></msub><mrow id="S2.SS2.p2.1.m1.2.2.1.1.1.1" xref="S2.SS2.p2.1.m1.2.2.1.1.1.1.cmml"><msub id="S2.SS2.p2.1.m1.2.2.1.1.1.1.3" xref="S2.SS2.p2.1.m1.2.2.1.1.1.1.3.cmml"><mi id="S2.SS2.p2.1.m1.2.2.1.1.1.1.3.2" xref="S2.SS2.p2.1.m1.2.2.1.1.1.1.3.2.cmml">U</mi><mi id="S2.SS2.p2.1.m1.2.2.1.1.1.1.3.3" xref="S2.SS2.p2.1.m1.2.2.1.1.1.1.3.3.cmml">j</mi></msub><mo id="S2.SS2.p2.1.m1.2.2.1.1.1.1.2" xref="S2.SS2.p2.1.m1.2.2.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.SS2.p2.1.m1.2.2.1.1.1.1.1.1" xref="S2.SS2.p2.1.m1.2.2.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS2.p2.1.m1.2.2.1.1.1.1.1.1.2" xref="S2.SS2.p2.1.m1.2.2.1.1.1.1.1.1.1.cmml">(</mo><msub id="S2.SS2.p2.1.m1.2.2.1.1.1.1.1.1.1" xref="S2.SS2.p2.1.m1.2.2.1.1.1.1.1.1.1.cmml"><mi id="S2.SS2.p2.1.m1.2.2.1.1.1.1.1.1.1.2" xref="S2.SS2.p2.1.m1.2.2.1.1.1.1.1.1.1.2.cmml">θ</mi><mi id="S2.SS2.p2.1.m1.2.2.1.1.1.1.1.1.1.3" xref="S2.SS2.p2.1.m1.2.2.1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo stretchy="false" id="S2.SS2.p2.1.m1.2.2.1.1.1.1.1.1.3" xref="S2.SS2.p2.1.m1.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.SS2.p2.1.m1.2.2.1.1.1.1.2a" xref="S2.SS2.p2.1.m1.2.2.1.1.1.1.2.cmml">⁢</mo><msub id="S2.SS2.p2.1.m1.2.2.1.1.1.1.4" xref="S2.SS2.p2.1.m1.2.2.1.1.1.1.4.cmml"><mi id="S2.SS2.p2.1.m1.2.2.1.1.1.1.4.2" xref="S2.SS2.p2.1.m1.2.2.1.1.1.1.4.2.cmml">V</mi><mi id="S2.SS2.p2.1.m1.2.2.1.1.1.1.4.3" xref="S2.SS2.p2.1.m1.2.2.1.1.1.1.4.3.cmml">j</mi></msub></mrow></mrow></mrow><mo id="S2.SS2.p2.1.m1.2.2.1.2" xref="S2.SS2.p2.1.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.1.m1.2b"><apply id="S2.SS2.p2.1.m1.2.2.1.1.cmml" xref="S2.SS2.p2.1.m1.2.2.1"><eq id="S2.SS2.p2.1.m1.2.2.1.1.2.cmml" xref="S2.SS2.p2.1.m1.2.2.1.1.2"></eq><apply id="S2.SS2.p2.1.m1.2.2.1.1.3.cmml" xref="S2.SS2.p2.1.m1.2.2.1.1.3"><times id="S2.SS2.p2.1.m1.2.2.1.1.3.1.cmml" xref="S2.SS2.p2.1.m1.2.2.1.1.3.1"></times><ci id="S2.SS2.p2.1.m1.2.2.1.1.3.2.cmml" xref="S2.SS2.p2.1.m1.2.2.1.1.3.2">𝑈</ci><ci id="S2.SS2.p2.1.m1.1.1.cmml" xref="S2.SS2.p2.1.m1.1.1">𝜽</ci></apply><apply id="S2.SS2.p2.1.m1.2.2.1.1.1.cmml" xref="S2.SS2.p2.1.m1.2.2.1.1.1"><apply id="S2.SS2.p2.1.m1.2.2.1.1.1.2.cmml" xref="S2.SS2.p2.1.m1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p2.1.m1.2.2.1.1.1.2.1.cmml" xref="S2.SS2.p2.1.m1.2.2.1.1.1.2">subscript</csymbol><csymbol cd="latexml" id="S2.SS2.p2.1.m1.2.2.1.1.1.2.2.cmml" xref="S2.SS2.p2.1.m1.2.2.1.1.1.2.2">product</csymbol><ci id="S2.SS2.p2.1.m1.2.2.1.1.1.2.3.cmml" xref="S2.SS2.p2.1.m1.2.2.1.1.1.2.3">𝑗</ci></apply><apply id="S2.SS2.p2.1.m1.2.2.1.1.1.1.cmml" xref="S2.SS2.p2.1.m1.2.2.1.1.1.1"><times id="S2.SS2.p2.1.m1.2.2.1.1.1.1.2.cmml" xref="S2.SS2.p2.1.m1.2.2.1.1.1.1.2"></times><apply id="S2.SS2.p2.1.m1.2.2.1.1.1.1.3.cmml" xref="S2.SS2.p2.1.m1.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p2.1.m1.2.2.1.1.1.1.3.1.cmml" xref="S2.SS2.p2.1.m1.2.2.1.1.1.1.3">subscript</csymbol><ci id="S2.SS2.p2.1.m1.2.2.1.1.1.1.3.2.cmml" xref="S2.SS2.p2.1.m1.2.2.1.1.1.1.3.2">𝑈</ci><ci id="S2.SS2.p2.1.m1.2.2.1.1.1.1.3.3.cmml" xref="S2.SS2.p2.1.m1.2.2.1.1.1.1.3.3">𝑗</ci></apply><apply id="S2.SS2.p2.1.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p2.1.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.1.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p2.1.m1.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS2.p2.1.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S2.SS2.p2.1.m1.2.2.1.1.1.1.1.1.1.2">𝜃</ci><ci id="S2.SS2.p2.1.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S2.SS2.p2.1.m1.2.2.1.1.1.1.1.1.1.3">𝑗</ci></apply><apply id="S2.SS2.p2.1.m1.2.2.1.1.1.1.4.cmml" xref="S2.SS2.p2.1.m1.2.2.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.SS2.p2.1.m1.2.2.1.1.1.1.4.1.cmml" xref="S2.SS2.p2.1.m1.2.2.1.1.1.1.4">subscript</csymbol><ci id="S2.SS2.p2.1.m1.2.2.1.1.1.1.4.2.cmml" xref="S2.SS2.p2.1.m1.2.2.1.1.1.1.4.2">𝑉</ci><ci id="S2.SS2.p2.1.m1.2.2.1.1.1.1.4.3.cmml" xref="S2.SS2.p2.1.m1.2.2.1.1.1.1.4.3">𝑗</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.1.m1.2c">U({\bm{\theta}})=\prod_{j}U_{j}(\theta_{j})V_{j},</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.1.m1.2d">italic_U ( bold_italic_θ ) = ∏ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT italic_U start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ( italic_θ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) italic_V start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ,</annotation></semantics></math>
where <math id="S2.SS2.p2.2.m2.3" class="ltx_Math" alttext="U_{j}(\theta_{j})=\exp(-i\theta_{j}P_{j}/2)" display="inline"><semantics id="S2.SS2.p2.2.m2.3a"><mrow id="S2.SS2.p2.2.m2.3.3" xref="S2.SS2.p2.2.m2.3.3.cmml"><mrow id="S2.SS2.p2.2.m2.2.2.1" xref="S2.SS2.p2.2.m2.2.2.1.cmml"><msub id="S2.SS2.p2.2.m2.2.2.1.3" xref="S2.SS2.p2.2.m2.2.2.1.3.cmml"><mi id="S2.SS2.p2.2.m2.2.2.1.3.2" xref="S2.SS2.p2.2.m2.2.2.1.3.2.cmml">U</mi><mi id="S2.SS2.p2.2.m2.2.2.1.3.3" xref="S2.SS2.p2.2.m2.2.2.1.3.3.cmml">j</mi></msub><mo id="S2.SS2.p2.2.m2.2.2.1.2" xref="S2.SS2.p2.2.m2.2.2.1.2.cmml">⁢</mo><mrow id="S2.SS2.p2.2.m2.2.2.1.1.1" xref="S2.SS2.p2.2.m2.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS2.p2.2.m2.2.2.1.1.1.2" xref="S2.SS2.p2.2.m2.2.2.1.1.1.1.cmml">(</mo><msub id="S2.SS2.p2.2.m2.2.2.1.1.1.1" xref="S2.SS2.p2.2.m2.2.2.1.1.1.1.cmml"><mi id="S2.SS2.p2.2.m2.2.2.1.1.1.1.2" xref="S2.SS2.p2.2.m2.2.2.1.1.1.1.2.cmml">θ</mi><mi id="S2.SS2.p2.2.m2.2.2.1.1.1.1.3" xref="S2.SS2.p2.2.m2.2.2.1.1.1.1.3.cmml">j</mi></msub><mo stretchy="false" id="S2.SS2.p2.2.m2.2.2.1.1.1.3" xref="S2.SS2.p2.2.m2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.SS2.p2.2.m2.3.3.3" xref="S2.SS2.p2.2.m2.3.3.3.cmml">=</mo><mrow id="S2.SS2.p2.2.m2.3.3.2.1" xref="S2.SS2.p2.2.m2.3.3.2.2.cmml"><mi id="S2.SS2.p2.2.m2.1.1" xref="S2.SS2.p2.2.m2.1.1.cmml">exp</mi><mo id="S2.SS2.p2.2.m2.3.3.2.1a" xref="S2.SS2.p2.2.m2.3.3.2.2.cmml">⁡</mo><mrow id="S2.SS2.p2.2.m2.3.3.2.1.1" xref="S2.SS2.p2.2.m2.3.3.2.2.cmml"><mo stretchy="false" id="S2.SS2.p2.2.m2.3.3.2.1.1.2" xref="S2.SS2.p2.2.m2.3.3.2.2.cmml">(</mo><mrow id="S2.SS2.p2.2.m2.3.3.2.1.1.1" xref="S2.SS2.p2.2.m2.3.3.2.1.1.1.cmml"><mo id="S2.SS2.p2.2.m2.3.3.2.1.1.1.1" xref="S2.SS2.p2.2.m2.3.3.2.1.1.1.1.cmml">-</mo><mrow id="S2.SS2.p2.2.m2.3.3.2.1.1.1.2" xref="S2.SS2.p2.2.m2.3.3.2.1.1.1.2.cmml"><mrow id="S2.SS2.p2.2.m2.3.3.2.1.1.1.2.2" xref="S2.SS2.p2.2.m2.3.3.2.1.1.1.2.2.cmml"><mi id="S2.SS2.p2.2.m2.3.3.2.1.1.1.2.2.2" xref="S2.SS2.p2.2.m2.3.3.2.1.1.1.2.2.2.cmml">i</mi><mo id="S2.SS2.p2.2.m2.3.3.2.1.1.1.2.2.1" xref="S2.SS2.p2.2.m2.3.3.2.1.1.1.2.2.1.cmml">⁢</mo><msub id="S2.SS2.p2.2.m2.3.3.2.1.1.1.2.2.3" xref="S2.SS2.p2.2.m2.3.3.2.1.1.1.2.2.3.cmml"><mi id="S2.SS2.p2.2.m2.3.3.2.1.1.1.2.2.3.2" xref="S2.SS2.p2.2.m2.3.3.2.1.1.1.2.2.3.2.cmml">θ</mi><mi id="S2.SS2.p2.2.m2.3.3.2.1.1.1.2.2.3.3" xref="S2.SS2.p2.2.m2.3.3.2.1.1.1.2.2.3.3.cmml">j</mi></msub><mo id="S2.SS2.p2.2.m2.3.3.2.1.1.1.2.2.1a" xref="S2.SS2.p2.2.m2.3.3.2.1.1.1.2.2.1.cmml">⁢</mo><msub id="S2.SS2.p2.2.m2.3.3.2.1.1.1.2.2.4" xref="S2.SS2.p2.2.m2.3.3.2.1.1.1.2.2.4.cmml"><mi id="S2.SS2.p2.2.m2.3.3.2.1.1.1.2.2.4.2" xref="S2.SS2.p2.2.m2.3.3.2.1.1.1.2.2.4.2.cmml">P</mi><mi id="S2.SS2.p2.2.m2.3.3.2.1.1.1.2.2.4.3" xref="S2.SS2.p2.2.m2.3.3.2.1.1.1.2.2.4.3.cmml">j</mi></msub></mrow><mo id="S2.SS2.p2.2.m2.3.3.2.1.1.1.2.1" xref="S2.SS2.p2.2.m2.3.3.2.1.1.1.2.1.cmml">/</mo><mn id="S2.SS2.p2.2.m2.3.3.2.1.1.1.2.3" xref="S2.SS2.p2.2.m2.3.3.2.1.1.1.2.3.cmml">2</mn></mrow></mrow><mo stretchy="false" id="S2.SS2.p2.2.m2.3.3.2.1.1.3" xref="S2.SS2.p2.2.m2.3.3.2.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.2.m2.3b"><apply id="S2.SS2.p2.2.m2.3.3.cmml" xref="S2.SS2.p2.2.m2.3.3"><eq id="S2.SS2.p2.2.m2.3.3.3.cmml" xref="S2.SS2.p2.2.m2.3.3.3"></eq><apply id="S2.SS2.p2.2.m2.2.2.1.cmml" xref="S2.SS2.p2.2.m2.2.2.1"><times id="S2.SS2.p2.2.m2.2.2.1.2.cmml" xref="S2.SS2.p2.2.m2.2.2.1.2"></times><apply id="S2.SS2.p2.2.m2.2.2.1.3.cmml" xref="S2.SS2.p2.2.m2.2.2.1.3"><csymbol cd="ambiguous" id="S2.SS2.p2.2.m2.2.2.1.3.1.cmml" xref="S2.SS2.p2.2.m2.2.2.1.3">subscript</csymbol><ci id="S2.SS2.p2.2.m2.2.2.1.3.2.cmml" xref="S2.SS2.p2.2.m2.2.2.1.3.2">𝑈</ci><ci id="S2.SS2.p2.2.m2.2.2.1.3.3.cmml" xref="S2.SS2.p2.2.m2.2.2.1.3.3">𝑗</ci></apply><apply id="S2.SS2.p2.2.m2.2.2.1.1.1.1.cmml" xref="S2.SS2.p2.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.2.m2.2.2.1.1.1.1.1.cmml" xref="S2.SS2.p2.2.m2.2.2.1.1.1">subscript</csymbol><ci id="S2.SS2.p2.2.m2.2.2.1.1.1.1.2.cmml" xref="S2.SS2.p2.2.m2.2.2.1.1.1.1.2">𝜃</ci><ci id="S2.SS2.p2.2.m2.2.2.1.1.1.1.3.cmml" xref="S2.SS2.p2.2.m2.2.2.1.1.1.1.3">𝑗</ci></apply></apply><apply id="S2.SS2.p2.2.m2.3.3.2.2.cmml" xref="S2.SS2.p2.2.m2.3.3.2.1"><exp id="S2.SS2.p2.2.m2.1.1.cmml" xref="S2.SS2.p2.2.m2.1.1"></exp><apply id="S2.SS2.p2.2.m2.3.3.2.1.1.1.cmml" xref="S2.SS2.p2.2.m2.3.3.2.1.1.1"><minus id="S2.SS2.p2.2.m2.3.3.2.1.1.1.1.cmml" xref="S2.SS2.p2.2.m2.3.3.2.1.1.1.1"></minus><apply id="S2.SS2.p2.2.m2.3.3.2.1.1.1.2.cmml" xref="S2.SS2.p2.2.m2.3.3.2.1.1.1.2"><divide id="S2.SS2.p2.2.m2.3.3.2.1.1.1.2.1.cmml" xref="S2.SS2.p2.2.m2.3.3.2.1.1.1.2.1"></divide><apply id="S2.SS2.p2.2.m2.3.3.2.1.1.1.2.2.cmml" xref="S2.SS2.p2.2.m2.3.3.2.1.1.1.2.2"><times id="S2.SS2.p2.2.m2.3.3.2.1.1.1.2.2.1.cmml" xref="S2.SS2.p2.2.m2.3.3.2.1.1.1.2.2.1"></times><ci id="S2.SS2.p2.2.m2.3.3.2.1.1.1.2.2.2.cmml" xref="S2.SS2.p2.2.m2.3.3.2.1.1.1.2.2.2">𝑖</ci><apply id="S2.SS2.p2.2.m2.3.3.2.1.1.1.2.2.3.cmml" xref="S2.SS2.p2.2.m2.3.3.2.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S2.SS2.p2.2.m2.3.3.2.1.1.1.2.2.3.1.cmml" xref="S2.SS2.p2.2.m2.3.3.2.1.1.1.2.2.3">subscript</csymbol><ci id="S2.SS2.p2.2.m2.3.3.2.1.1.1.2.2.3.2.cmml" xref="S2.SS2.p2.2.m2.3.3.2.1.1.1.2.2.3.2">𝜃</ci><ci id="S2.SS2.p2.2.m2.3.3.2.1.1.1.2.2.3.3.cmml" xref="S2.SS2.p2.2.m2.3.3.2.1.1.1.2.2.3.3">𝑗</ci></apply><apply id="S2.SS2.p2.2.m2.3.3.2.1.1.1.2.2.4.cmml" xref="S2.SS2.p2.2.m2.3.3.2.1.1.1.2.2.4"><csymbol cd="ambiguous" id="S2.SS2.p2.2.m2.3.3.2.1.1.1.2.2.4.1.cmml" xref="S2.SS2.p2.2.m2.3.3.2.1.1.1.2.2.4">subscript</csymbol><ci id="S2.SS2.p2.2.m2.3.3.2.1.1.1.2.2.4.2.cmml" xref="S2.SS2.p2.2.m2.3.3.2.1.1.1.2.2.4.2">𝑃</ci><ci id="S2.SS2.p2.2.m2.3.3.2.1.1.1.2.2.4.3.cmml" xref="S2.SS2.p2.2.m2.3.3.2.1.1.1.2.2.4.3">𝑗</ci></apply></apply><cn type="integer" id="S2.SS2.p2.2.m2.3.3.2.1.1.1.2.3.cmml" xref="S2.SS2.p2.2.m2.3.3.2.1.1.1.2.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.2.m2.3c">U_{j}(\theta_{j})=\exp(-i\theta_{j}P_{j}/2)</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.2.m2.3d">italic_U start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ( italic_θ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) = roman_exp ( - italic_i italic_θ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT italic_P start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT / 2 )</annotation></semantics></math> and <math id="S2.SS2.p2.3.m3.1" class="ltx_Math" alttext="V_{j}" display="inline"><semantics id="S2.SS2.p2.3.m3.1a"><msub id="S2.SS2.p2.3.m3.1.1" xref="S2.SS2.p2.3.m3.1.1.cmml"><mi id="S2.SS2.p2.3.m3.1.1.2" xref="S2.SS2.p2.3.m3.1.1.2.cmml">V</mi><mi id="S2.SS2.p2.3.m3.1.1.3" xref="S2.SS2.p2.3.m3.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.3.m3.1b"><apply id="S2.SS2.p2.3.m3.1.1.cmml" xref="S2.SS2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.3.m3.1.1.1.cmml" xref="S2.SS2.p2.3.m3.1.1">subscript</csymbol><ci id="S2.SS2.p2.3.m3.1.1.2.cmml" xref="S2.SS2.p2.3.m3.1.1.2">𝑉</ci><ci id="S2.SS2.p2.3.m3.1.1.3.cmml" xref="S2.SS2.p2.3.m3.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.3.m3.1c">V_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.3.m3.1d">italic_V start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> denotes a fixed operator such as Identity, CNOT and so on. Here, <math id="S2.SS2.p2.4.m4.1" class="ltx_Math" alttext="P_{j}" display="inline"><semantics id="S2.SS2.p2.4.m4.1a"><msub id="S2.SS2.p2.4.m4.1.1" xref="S2.SS2.p2.4.m4.1.1.cmml"><mi id="S2.SS2.p2.4.m4.1.1.2" xref="S2.SS2.p2.4.m4.1.1.2.cmml">P</mi><mi id="S2.SS2.p2.4.m4.1.1.3" xref="S2.SS2.p2.4.m4.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.4.m4.1b"><apply id="S2.SS2.p2.4.m4.1.1.cmml" xref="S2.SS2.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.4.m4.1.1.1.cmml" xref="S2.SS2.p2.4.m4.1.1">subscript</csymbol><ci id="S2.SS2.p2.4.m4.1.1.2.cmml" xref="S2.SS2.p2.4.m4.1.1.2">𝑃</ci><ci id="S2.SS2.p2.4.m4.1.1.3.cmml" xref="S2.SS2.p2.4.m4.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.4.m4.1c">P_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.4.m4.1d">italic_P start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> denotes a Pauli operator. Due to the numerous choices of the form of <math id="S2.SS2.p2.5.m5.1" class="ltx_Math" alttext="V_{j}" display="inline"><semantics id="S2.SS2.p2.5.m5.1a"><msub id="S2.SS2.p2.5.m5.1.1" xref="S2.SS2.p2.5.m5.1.1.cmml"><mi id="S2.SS2.p2.5.m5.1.1.2" xref="S2.SS2.p2.5.m5.1.1.2.cmml">V</mi><mi id="S2.SS2.p2.5.m5.1.1.3" xref="S2.SS2.p2.5.m5.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.5.m5.1b"><apply id="S2.SS2.p2.5.m5.1.1.cmml" xref="S2.SS2.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.5.m5.1.1.1.cmml" xref="S2.SS2.p2.5.m5.1.1">subscript</csymbol><ci id="S2.SS2.p2.5.m5.1.1.2.cmml" xref="S2.SS2.p2.5.m5.1.1.2">𝑉</ci><ci id="S2.SS2.p2.5.m5.1.1.3.cmml" xref="S2.SS2.p2.5.m5.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.5.m5.1c">V_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.5.m5.1d">italic_V start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>, various kinds of ansatzes can be used. In this paper, we use the strongly entangled ansatz <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite> shown in Fig. <a href="#S2.F2" title="Figure 2 ‣ 2.1.1 Gaussian Projected Quantum Self-Attention ‣ 2.1 Quantum Self-Attention Layer ‣ 2 Method ‣ Quantum Self-Attention Neural Networks for Text Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> in QSAL. This circuit has <math id="S2.SS2.p2.6.m6.1" class="ltx_Math" alttext="n(D+2)" display="inline"><semantics id="S2.SS2.p2.6.m6.1a"><mrow id="S2.SS2.p2.6.m6.1.1" xref="S2.SS2.p2.6.m6.1.1.cmml"><mi id="S2.SS2.p2.6.m6.1.1.3" xref="S2.SS2.p2.6.m6.1.1.3.cmml">n</mi><mo id="S2.SS2.p2.6.m6.1.1.2" xref="S2.SS2.p2.6.m6.1.1.2.cmml">⁢</mo><mrow id="S2.SS2.p2.6.m6.1.1.1.1" xref="S2.SS2.p2.6.m6.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS2.p2.6.m6.1.1.1.1.2" xref="S2.SS2.p2.6.m6.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS2.p2.6.m6.1.1.1.1.1" xref="S2.SS2.p2.6.m6.1.1.1.1.1.cmml"><mi id="S2.SS2.p2.6.m6.1.1.1.1.1.2" xref="S2.SS2.p2.6.m6.1.1.1.1.1.2.cmml">D</mi><mo id="S2.SS2.p2.6.m6.1.1.1.1.1.1" xref="S2.SS2.p2.6.m6.1.1.1.1.1.1.cmml">+</mo><mn id="S2.SS2.p2.6.m6.1.1.1.1.1.3" xref="S2.SS2.p2.6.m6.1.1.1.1.1.3.cmml">2</mn></mrow><mo stretchy="false" id="S2.SS2.p2.6.m6.1.1.1.1.3" xref="S2.SS2.p2.6.m6.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.6.m6.1b"><apply id="S2.SS2.p2.6.m6.1.1.cmml" xref="S2.SS2.p2.6.m6.1.1"><times id="S2.SS2.p2.6.m6.1.1.2.cmml" xref="S2.SS2.p2.6.m6.1.1.2"></times><ci id="S2.SS2.p2.6.m6.1.1.3.cmml" xref="S2.SS2.p2.6.m6.1.1.3">𝑛</ci><apply id="S2.SS2.p2.6.m6.1.1.1.1.1.cmml" xref="S2.SS2.p2.6.m6.1.1.1.1"><plus id="S2.SS2.p2.6.m6.1.1.1.1.1.1.cmml" xref="S2.SS2.p2.6.m6.1.1.1.1.1.1"></plus><ci id="S2.SS2.p2.6.m6.1.1.1.1.1.2.cmml" xref="S2.SS2.p2.6.m6.1.1.1.1.1.2">𝐷</ci><cn type="integer" id="S2.SS2.p2.6.m6.1.1.1.1.1.3.cmml" xref="S2.SS2.p2.6.m6.1.1.1.1.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.6.m6.1c">n(D+2)</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.6.m6.1d">italic_n ( italic_D + 2 )</annotation></semantics></math> parameters in total for <math id="S2.SS2.p2.7.m7.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S2.SS2.p2.7.m7.1a"><mi id="S2.SS2.p2.7.m7.1.1" xref="S2.SS2.p2.7.m7.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.7.m7.1b"><ci id="S2.SS2.p2.7.m7.1.1.cmml" xref="S2.SS2.p2.7.m7.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.7.m7.1c">n</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.7.m7.1d">italic_n</annotation></semantics></math> qubits and <math id="S2.SS2.p2.8.m8.1" class="ltx_Math" alttext="D" display="inline"><semantics id="S2.SS2.p2.8.m8.1a"><mi id="S2.SS2.p2.8.m8.1.1" xref="S2.SS2.p2.8.m8.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.8.m8.1b"><ci id="S2.SS2.p2.8.m8.1.1.cmml" xref="S2.SS2.p2.8.m8.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.8.m8.1c">D</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.8.m8.1d">italic_D</annotation></semantics></math> repeated layers.</p>
</div>
<figure id="S2.F3" class="ltx_figure"><img src="/html/2205.05625/assets/graph/QSANN.png" id="S2.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="521" height="155" alt="Sketch of QSANN, where a sequence of classical vectors ">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Sketch of QSANN, where a sequence of classical vectors <math id="S2.F3.4.m1.1" class="ltx_Math" alttext="\{\bm{x}_{s}\}" display="inline"><semantics id="S2.F3.4.m1.1b"><mrow id="S2.F3.4.m1.1.1.1" xref="S2.F3.4.m1.1.1.2.cmml"><mo stretchy="false" id="S2.F3.4.m1.1.1.1.2" xref="S2.F3.4.m1.1.1.2.cmml">{</mo><msub id="S2.F3.4.m1.1.1.1.1" xref="S2.F3.4.m1.1.1.1.1.cmml"><mi id="S2.F3.4.m1.1.1.1.1.2" xref="S2.F3.4.m1.1.1.1.1.2.cmml">𝒙</mi><mi id="S2.F3.4.m1.1.1.1.1.3" xref="S2.F3.4.m1.1.1.1.1.3.cmml">s</mi></msub><mo stretchy="false" id="S2.F3.4.m1.1.1.1.3" xref="S2.F3.4.m1.1.1.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.F3.4.m1.1c"><set id="S2.F3.4.m1.1.1.2.cmml" xref="S2.F3.4.m1.1.1.1"><apply id="S2.F3.4.m1.1.1.1.1.cmml" xref="S2.F3.4.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.F3.4.m1.1.1.1.1.1.cmml" xref="S2.F3.4.m1.1.1.1.1">subscript</csymbol><ci id="S2.F3.4.m1.1.1.1.1.2.cmml" xref="S2.F3.4.m1.1.1.1.1.2">𝒙</ci><ci id="S2.F3.4.m1.1.1.1.1.3.cmml" xref="S2.F3.4.m1.1.1.1.1.3">𝑠</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S2.F3.4.m1.1d">\{\bm{x}_{s}\}</annotation><annotation encoding="application/x-llamapun" id="S2.F3.4.m1.1e">{ bold_italic_x start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT }</annotation></semantics></math> firstly goes through <math id="S2.F3.5.m2.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S2.F3.5.m2.1b"><mi id="S2.F3.5.m2.1.1" xref="S2.F3.5.m2.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S2.F3.5.m2.1c"><ci id="S2.F3.5.m2.1.1.cmml" xref="S2.F3.5.m2.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F3.5.m2.1d">L</annotation><annotation encoding="application/x-llamapun" id="S2.F3.5.m2.1e">italic_L</annotation></semantics></math> QSALs to obtain the corresponding sequence of feature vectors <math id="S2.F3.6.m3.2" class="ltx_Math" alttext="\{\bm{y}_{s}^{(L)}\}" display="inline"><semantics id="S2.F3.6.m3.2b"><mrow id="S2.F3.6.m3.2.2.1" xref="S2.F3.6.m3.2.2.2.cmml"><mo stretchy="false" id="S2.F3.6.m3.2.2.1.2" xref="S2.F3.6.m3.2.2.2.cmml">{</mo><msubsup id="S2.F3.6.m3.2.2.1.1" xref="S2.F3.6.m3.2.2.1.1.cmml"><mi id="S2.F3.6.m3.2.2.1.1.2.2" xref="S2.F3.6.m3.2.2.1.1.2.2.cmml">𝒚</mi><mi id="S2.F3.6.m3.2.2.1.1.2.3" xref="S2.F3.6.m3.2.2.1.1.2.3.cmml">s</mi><mrow id="S2.F3.6.m3.1.1.1.3" xref="S2.F3.6.m3.2.2.1.1.cmml"><mo stretchy="false" id="S2.F3.6.m3.1.1.1.3.1" xref="S2.F3.6.m3.2.2.1.1.cmml">(</mo><mi id="S2.F3.6.m3.1.1.1.1" xref="S2.F3.6.m3.1.1.1.1.cmml">L</mi><mo stretchy="false" id="S2.F3.6.m3.1.1.1.3.2" xref="S2.F3.6.m3.2.2.1.1.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="S2.F3.6.m3.2.2.1.3" xref="S2.F3.6.m3.2.2.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.F3.6.m3.2c"><set id="S2.F3.6.m3.2.2.2.cmml" xref="S2.F3.6.m3.2.2.1"><apply id="S2.F3.6.m3.2.2.1.1.cmml" xref="S2.F3.6.m3.2.2.1.1"><csymbol cd="ambiguous" id="S2.F3.6.m3.2.2.1.1.1.cmml" xref="S2.F3.6.m3.2.2.1.1">superscript</csymbol><apply id="S2.F3.6.m3.2.2.1.1.2.cmml" xref="S2.F3.6.m3.2.2.1.1"><csymbol cd="ambiguous" id="S2.F3.6.m3.2.2.1.1.2.1.cmml" xref="S2.F3.6.m3.2.2.1.1">subscript</csymbol><ci id="S2.F3.6.m3.2.2.1.1.2.2.cmml" xref="S2.F3.6.m3.2.2.1.1.2.2">𝒚</ci><ci id="S2.F3.6.m3.2.2.1.1.2.3.cmml" xref="S2.F3.6.m3.2.2.1.1.2.3">𝑠</ci></apply><ci id="S2.F3.6.m3.1.1.1.1.cmml" xref="S2.F3.6.m3.1.1.1.1">𝐿</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S2.F3.6.m3.2d">\{\bm{y}_{s}^{(L)}\}</annotation><annotation encoding="application/x-llamapun" id="S2.F3.6.m3.2e">{ bold_italic_y start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_L ) end_POSTSUPERSCRIPT }</annotation></semantics></math>, then through the average operation, and finally through the fully-connected layer for the binary prediction task.</figcaption>
</figure>
</section>
<section id="S2.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3 </span>Loss Function</h3>

<div id="S2.SS3.p1" class="ltx_para">
<p id="S2.SS3.p1.14" class="ltx_p">Consider the data set <math id="S2.SS3.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{D}" display="inline"><semantics id="S2.SS3.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS3.p1.1.m1.1.1" xref="S2.SS3.p1.1.m1.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.1.m1.1b"><ci id="S2.SS3.p1.1.m1.1.1.cmml" xref="S2.SS3.p1.1.m1.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.1.m1.1c">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p1.1.m1.1d">caligraphic_D</annotation></semantics></math> <math id="S2.SS3.p1.2.m2.1" class="ltx_Math" alttext=":=" display="inline"><semantics id="S2.SS3.p1.2.m2.1a"><mo id="S2.SS3.p1.2.m2.1.1" xref="S2.SS3.p1.2.m2.1.1.cmml">:=</mo><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.2.m2.1b"><csymbol cd="latexml" id="S2.SS3.p1.2.m2.1.1.cmml" xref="S2.SS3.p1.2.m2.1.1">assign</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.2.m2.1c">:=</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p1.2.m2.1d">:=</annotation></semantics></math> <math id="S2.SS3.p1.3.m3.1" class="ltx_Math" alttext="\{(\prescript{(m)}{}{\bm{x}_{1}}" display="inline"><semantics id="S2.SS3.p1.3.m3.1a"><mrow id="S2.SS3.p1.3.m3.1b"><mo stretchy="false" id="S2.SS3.p1.3.m3.1.2" xref="S2.SS3.p1.3.m3.1.2.cmml">{</mo><mrow id="S2.SS3.p1.3.m3.1.3" xref="S2.SS3.p1.3.m3.1.3.cmml"><mo stretchy="false" id="S2.SS3.p1.3.m3.1.3.1" xref="S2.SS3.p1.3.m3.1.3.1.cmml">(</mo><mmultiscripts id="S2.SS3.p1.3.m3.1.3.2" xref="S2.SS3.p1.3.m3.1.3.2.cmml"><mi id="S2.SS3.p1.3.m3.1.3.2.2.2" xref="S2.SS3.p1.3.m3.1.3.2.2.2.cmml">𝒙</mi><mn id="S2.SS3.p1.3.m3.1.3.2.2.3" xref="S2.SS3.p1.3.m3.1.3.2.2.3.cmml">1</mn><none id="S2.SS3.p1.3.m3.1.3.2a" xref="S2.SS3.p1.3.m3.1.3.2.cmml"></none><mprescripts id="S2.SS3.p1.3.m3.1.3.2b" xref="S2.SS3.p1.3.m3.1.3.2.cmml"></mprescripts><none id="S2.SS3.p1.3.m3.1.3.2c" xref="S2.SS3.p1.3.m3.1.3.2.cmml"></none><mrow id="S2.SS3.p1.3.m3.1.1.1.3" xref="S2.SS3.p1.3.m3.1.3.2.cmml"><mo stretchy="false" id="S2.SS3.p1.3.m3.1.1.1.3.1" xref="S2.SS3.p1.3.m3.1.3.2.cmml">(</mo><mi id="S2.SS3.p1.3.m3.1.1.1.1" xref="S2.SS3.p1.3.m3.1.1.1.1.cmml">m</mi><mo stretchy="false" id="S2.SS3.p1.3.m3.1.1.1.3.2" xref="S2.SS3.p1.3.m3.1.3.2.cmml">)</mo></mrow></mmultiscripts></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.3.m3.1c"><cerror id="S2.SS3.p1.3.m3.1d"><csymbol cd="ambiguous" id="S2.SS3.p1.3.m3.1e">fragments</csymbol><ci id="S2.SS3.p1.3.m3.1.2.cmml" xref="S2.SS3.p1.3.m3.1.2">{</ci><cerror id="S2.SS3.p1.3.m3.1.3.cmml" xref="S2.SS3.p1.3.m3.1.3"><csymbol cd="ambiguous" id="S2.SS3.p1.3.m3.1.3a.cmml" xref="S2.SS3.p1.3.m3.1.3">fragments</csymbol><ci id="S2.SS3.p1.3.m3.1.3.1.cmml" xref="S2.SS3.p1.3.m3.1.3.1">(</ci><apply id="S2.SS3.p1.3.m3.1.3.2.cmml" xref="S2.SS3.p1.3.m3.1.3.2"><csymbol cd="ambiguous" id="S2.SS3.p1.3.m3.1.3.2.1.cmml" xref="S2.SS3.p1.3.m3.1.3.2">superscript</csymbol><apply id="S2.SS3.p1.3.m3.1.3.2.2.cmml" xref="S2.SS3.p1.3.m3.1.3.2"><csymbol cd="ambiguous" id="S2.SS3.p1.3.m3.1.3.2.2.1.cmml" xref="S2.SS3.p1.3.m3.1.3.2">subscript</csymbol><ci id="S2.SS3.p1.3.m3.1.3.2.2.2.cmml" xref="S2.SS3.p1.3.m3.1.3.2.2.2">𝒙</ci><cn type="integer" id="S2.SS3.p1.3.m3.1.3.2.2.3.cmml" xref="S2.SS3.p1.3.m3.1.3.2.2.3">1</cn></apply><ci id="S2.SS3.p1.3.m3.1.1.1.1.cmml" xref="S2.SS3.p1.3.m3.1.1.1.1">𝑚</ci></apply></cerror></cerror></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.3.m3.1f">\{(\prescript{(m)}{}{\bm{x}_{1}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p1.3.m3.1g">{ ( start_FLOATSUPERSCRIPT ( italic_m ) end_FLOATSUPERSCRIPT bold_italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>, <math id="S2.SS3.p1.4.m4.1" class="ltx_Math" alttext="\prescript{(m)}{}{\bm{x}_{2}}" display="inline"><semantics id="S2.SS3.p1.4.m4.1a"><mmultiscripts id="S2.SS3.p1.4.m4.1.2" xref="S2.SS3.p1.4.m4.1.2.cmml"><mi id="S2.SS3.p1.4.m4.1.2.2.2" xref="S2.SS3.p1.4.m4.1.2.2.2.cmml">𝒙</mi><mn id="S2.SS3.p1.4.m4.1.2.2.3" xref="S2.SS3.p1.4.m4.1.2.2.3.cmml">2</mn><none id="S2.SS3.p1.4.m4.1.2a" xref="S2.SS3.p1.4.m4.1.2.cmml"></none><mprescripts id="S2.SS3.p1.4.m4.1.2b" xref="S2.SS3.p1.4.m4.1.2.cmml"></mprescripts><none id="S2.SS3.p1.4.m4.1.2c" xref="S2.SS3.p1.4.m4.1.2.cmml"></none><mrow id="S2.SS3.p1.4.m4.1.1.1.3" xref="S2.SS3.p1.4.m4.1.2.cmml"><mo stretchy="false" id="S2.SS3.p1.4.m4.1.1.1.3.1" xref="S2.SS3.p1.4.m4.1.2.cmml">(</mo><mi id="S2.SS3.p1.4.m4.1.1.1.1" xref="S2.SS3.p1.4.m4.1.1.1.1.cmml">m</mi><mo stretchy="false" id="S2.SS3.p1.4.m4.1.1.1.3.2" xref="S2.SS3.p1.4.m4.1.2.cmml">)</mo></mrow></mmultiscripts><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.4.m4.1b"><apply id="S2.SS3.p1.4.m4.1.2.cmml" xref="S2.SS3.p1.4.m4.1.2"><csymbol cd="ambiguous" id="S2.SS3.p1.4.m4.1.2.1.cmml" xref="S2.SS3.p1.4.m4.1.2">superscript</csymbol><apply id="S2.SS3.p1.4.m4.1.2.2.cmml" xref="S2.SS3.p1.4.m4.1.2"><csymbol cd="ambiguous" id="S2.SS3.p1.4.m4.1.2.2.1.cmml" xref="S2.SS3.p1.4.m4.1.2">subscript</csymbol><ci id="S2.SS3.p1.4.m4.1.2.2.2.cmml" xref="S2.SS3.p1.4.m4.1.2.2.2">𝒙</ci><cn type="integer" id="S2.SS3.p1.4.m4.1.2.2.3.cmml" xref="S2.SS3.p1.4.m4.1.2.2.3">2</cn></apply><ci id="S2.SS3.p1.4.m4.1.1.1.1.cmml" xref="S2.SS3.p1.4.m4.1.1.1.1">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.4.m4.1c">\prescript{(m)}{}{\bm{x}_{2}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p1.4.m4.1d">start_FLOATSUPERSCRIPT ( italic_m ) end_FLOATSUPERSCRIPT bold_italic_x start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>, <math id="S2.SS3.p1.5.m5.1" class="ltx_Math" alttext="\ldots" display="inline"><semantics id="S2.SS3.p1.5.m5.1a"><mi mathvariant="normal" id="S2.SS3.p1.5.m5.1.1" xref="S2.SS3.p1.5.m5.1.1.cmml">…</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.5.m5.1b"><ci id="S2.SS3.p1.5.m5.1.1.cmml" xref="S2.SS3.p1.5.m5.1.1">…</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.5.m5.1c">\ldots</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p1.5.m5.1d">…</annotation></semantics></math>, <math id="S2.SS3.p1.6.m6.1" class="ltx_Math" alttext="\prescript{(m)}{}{\bm{x}_{S_{m}}})" display="inline"><semantics id="S2.SS3.p1.6.m6.1a"><mrow id="S2.SS3.p1.6.m6.1b"><mmultiscripts id="S2.SS3.p1.6.m6.1.2" xref="S2.SS3.p1.6.m6.1.2.cmml"><mi id="S2.SS3.p1.6.m6.1.2.2.2" xref="S2.SS3.p1.6.m6.1.2.2.2.cmml">𝒙</mi><msub id="S2.SS3.p1.6.m6.1.2.2.3" xref="S2.SS3.p1.6.m6.1.2.2.3.cmml"><mi id="S2.SS3.p1.6.m6.1.2.2.3.2" xref="S2.SS3.p1.6.m6.1.2.2.3.2.cmml">S</mi><mi id="S2.SS3.p1.6.m6.1.2.2.3.3" xref="S2.SS3.p1.6.m6.1.2.2.3.3.cmml">m</mi></msub><none id="S2.SS3.p1.6.m6.1.2a" xref="S2.SS3.p1.6.m6.1.2.cmml"></none><mprescripts id="S2.SS3.p1.6.m6.1.2b" xref="S2.SS3.p1.6.m6.1.2.cmml"></mprescripts><none id="S2.SS3.p1.6.m6.1.2c" xref="S2.SS3.p1.6.m6.1.2.cmml"></none><mrow id="S2.SS3.p1.6.m6.1.1.1.3" xref="S2.SS3.p1.6.m6.1.2.cmml"><mo stretchy="false" id="S2.SS3.p1.6.m6.1.1.1.3.1" xref="S2.SS3.p1.6.m6.1.2.cmml">(</mo><mi id="S2.SS3.p1.6.m6.1.1.1.1" xref="S2.SS3.p1.6.m6.1.1.1.1.cmml">m</mi><mo stretchy="false" id="S2.SS3.p1.6.m6.1.1.1.3.2" xref="S2.SS3.p1.6.m6.1.2.cmml">)</mo></mrow></mmultiscripts><mo stretchy="false" id="S2.SS3.p1.6.m6.1.3" xref="S2.SS3.p1.6.m6.1.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.6.m6.1c"><cerror id="S2.SS3.p1.6.m6.1d"><csymbol cd="ambiguous" id="S2.SS3.p1.6.m6.1e">fragments</csymbol><apply id="S2.SS3.p1.6.m6.1.2.cmml" xref="S2.SS3.p1.6.m6.1.2"><csymbol cd="ambiguous" id="S2.SS3.p1.6.m6.1.2.1.cmml" xref="S2.SS3.p1.6.m6.1.2">superscript</csymbol><apply id="S2.SS3.p1.6.m6.1.2.2.cmml" xref="S2.SS3.p1.6.m6.1.2"><csymbol cd="ambiguous" id="S2.SS3.p1.6.m6.1.2.2.1.cmml" xref="S2.SS3.p1.6.m6.1.2">subscript</csymbol><ci id="S2.SS3.p1.6.m6.1.2.2.2.cmml" xref="S2.SS3.p1.6.m6.1.2.2.2">𝒙</ci><apply id="S2.SS3.p1.6.m6.1.2.2.3.cmml" xref="S2.SS3.p1.6.m6.1.2.2.3"><csymbol cd="ambiguous" id="S2.SS3.p1.6.m6.1.2.2.3.1.cmml" xref="S2.SS3.p1.6.m6.1.2.2.3">subscript</csymbol><ci id="S2.SS3.p1.6.m6.1.2.2.3.2.cmml" xref="S2.SS3.p1.6.m6.1.2.2.3.2">𝑆</ci><ci id="S2.SS3.p1.6.m6.1.2.2.3.3.cmml" xref="S2.SS3.p1.6.m6.1.2.2.3.3">𝑚</ci></apply></apply><ci id="S2.SS3.p1.6.m6.1.1.1.1.cmml" xref="S2.SS3.p1.6.m6.1.1.1.1">𝑚</ci></apply><ci id="S2.SS3.p1.6.m6.1.3.cmml" xref="S2.SS3.p1.6.m6.1.3">)</ci></cerror></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.6.m6.1f">\prescript{(m)}{}{\bm{x}_{S_{m}}})</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p1.6.m6.1g">start_FLOATSUPERSCRIPT ( italic_m ) end_FLOATSUPERSCRIPT bold_italic_x start_POSTSUBSCRIPT italic_S start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT end_POSTSUBSCRIPT )</annotation></semantics></math>, <math id="S2.SS3.p1.7.m7.1" class="ltx_Math" alttext="\prescript{(m)}{}{y}\}_{m=1}^{N_{s}}" display="inline"><semantics id="S2.SS3.p1.7.m7.1a"><mrow id="S2.SS3.p1.7.m7.1b"><mmultiscripts id="S2.SS3.p1.7.m7.1.2" xref="S2.SS3.p1.7.m7.1.2.cmml"><mi id="S2.SS3.p1.7.m7.1.2.2" xref="S2.SS3.p1.7.m7.1.2.2.cmml">y</mi><mprescripts id="S2.SS3.p1.7.m7.1.2a" xref="S2.SS3.p1.7.m7.1.2.cmml"></mprescripts><none id="S2.SS3.p1.7.m7.1.2b" xref="S2.SS3.p1.7.m7.1.2.cmml"></none><mrow id="S2.SS3.p1.7.m7.1.1.1.3" xref="S2.SS3.p1.7.m7.1.2.cmml"><mo stretchy="false" id="S2.SS3.p1.7.m7.1.1.1.3.1" xref="S2.SS3.p1.7.m7.1.2.cmml">(</mo><mi id="S2.SS3.p1.7.m7.1.1.1.1" xref="S2.SS3.p1.7.m7.1.1.1.1.cmml">m</mi><mo stretchy="false" id="S2.SS3.p1.7.m7.1.1.1.3.2" xref="S2.SS3.p1.7.m7.1.2.cmml">)</mo></mrow></mmultiscripts><mo stretchy="false" id="S2.SS3.p1.7.m7.1.3" xref="S2.SS3.p1.7.m7.1.3.cmml">}</mo><msub id="S2.SS3.p1.7.m7.1.4" xref="S2.SS3.p1.7.m7.1.4.cmml"><mi id="S2.SS3.p1.7.m7.1.4a" xref="S2.SS3.p1.7.m7.1.4.cmml"></mi><mrow id="S2.SS3.p1.7.m7.1.4.1" xref="S2.SS3.p1.7.m7.1.4.1.cmml"><mi id="S2.SS3.p1.7.m7.1.4.1.2" xref="S2.SS3.p1.7.m7.1.4.1.2.cmml">m</mi><mo id="S2.SS3.p1.7.m7.1.4.1.1" xref="S2.SS3.p1.7.m7.1.4.1.1.cmml">=</mo><mn id="S2.SS3.p1.7.m7.1.4.1.3" xref="S2.SS3.p1.7.m7.1.4.1.3.cmml">1</mn></mrow></msub><msup id="S2.SS3.p1.7.m7.1.5" xref="S2.SS3.p1.7.m7.1.5.cmml"><mi id="S2.SS3.p1.7.m7.1.5a" xref="S2.SS3.p1.7.m7.1.5.cmml"></mi><msub id="S2.SS3.p1.7.m7.1.5.1" xref="S2.SS3.p1.7.m7.1.5.1.cmml"><mi id="S2.SS3.p1.7.m7.1.5.1.2" xref="S2.SS3.p1.7.m7.1.5.1.2.cmml">N</mi><mi id="S2.SS3.p1.7.m7.1.5.1.3" xref="S2.SS3.p1.7.m7.1.5.1.3.cmml">s</mi></msub></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.7.m7.1c"><cerror id="S2.SS3.p1.7.m7.1d"><csymbol cd="ambiguous" id="S2.SS3.p1.7.m7.1e">fragments</csymbol><apply id="S2.SS3.p1.7.m7.1.2.cmml" xref="S2.SS3.p1.7.m7.1.2"><csymbol cd="ambiguous" id="S2.SS3.p1.7.m7.1.2.1.cmml" xref="S2.SS3.p1.7.m7.1.2">superscript</csymbol><ci id="S2.SS3.p1.7.m7.1.2.2.cmml" xref="S2.SS3.p1.7.m7.1.2.2">𝑦</ci><ci id="S2.SS3.p1.7.m7.1.1.1.1.cmml" xref="S2.SS3.p1.7.m7.1.1.1.1">𝑚</ci></apply><ci id="S2.SS3.p1.7.m7.1.3.cmml" xref="S2.SS3.p1.7.m7.1.3">}</ci><apply id="S2.SS3.p1.7.m7.1.4.cmml" xref="S2.SS3.p1.7.m7.1.4"><apply id="S2.SS3.p1.7.m7.1.4.1.cmml" xref="S2.SS3.p1.7.m7.1.4.1"><eq id="S2.SS3.p1.7.m7.1.4.1.1.cmml" xref="S2.SS3.p1.7.m7.1.4.1.1"></eq><ci id="S2.SS3.p1.7.m7.1.4.1.2.cmml" xref="S2.SS3.p1.7.m7.1.4.1.2">𝑚</ci><cn type="integer" id="S2.SS3.p1.7.m7.1.4.1.3.cmml" xref="S2.SS3.p1.7.m7.1.4.1.3">1</cn></apply></apply><apply id="S2.SS3.p1.7.m7.1.5.cmml" xref="S2.SS3.p1.7.m7.1.5"><apply id="S2.SS3.p1.7.m7.1.5.1.cmml" xref="S2.SS3.p1.7.m7.1.5.1"><csymbol cd="ambiguous" id="S2.SS3.p1.7.m7.1.5.1.1.cmml" xref="S2.SS3.p1.7.m7.1.5.1">subscript</csymbol><ci id="S2.SS3.p1.7.m7.1.5.1.2.cmml" xref="S2.SS3.p1.7.m7.1.5.1.2">𝑁</ci><ci id="S2.SS3.p1.7.m7.1.5.1.3.cmml" xref="S2.SS3.p1.7.m7.1.5.1.3">𝑠</ci></apply></apply></cerror></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.7.m7.1f">\prescript{(m)}{}{y}\}_{m=1}^{N_{s}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p1.7.m7.1g">start_FLOATSUPERSCRIPT ( italic_m ) end_FLOATSUPERSCRIPT italic_y } start_POSTSUBSCRIPT italic_m = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>, where
there are in total <math id="S2.SS3.p1.8.m8.1" class="ltx_Math" alttext="N_{s}" display="inline"><semantics id="S2.SS3.p1.8.m8.1a"><msub id="S2.SS3.p1.8.m8.1.1" xref="S2.SS3.p1.8.m8.1.1.cmml"><mi id="S2.SS3.p1.8.m8.1.1.2" xref="S2.SS3.p1.8.m8.1.1.2.cmml">N</mi><mi id="S2.SS3.p1.8.m8.1.1.3" xref="S2.SS3.p1.8.m8.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.8.m8.1b"><apply id="S2.SS3.p1.8.m8.1.1.cmml" xref="S2.SS3.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S2.SS3.p1.8.m8.1.1.1.cmml" xref="S2.SS3.p1.8.m8.1.1">subscript</csymbol><ci id="S2.SS3.p1.8.m8.1.1.2.cmml" xref="S2.SS3.p1.8.m8.1.1.2">𝑁</ci><ci id="S2.SS3.p1.8.m8.1.1.3.cmml" xref="S2.SS3.p1.8.m8.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.8.m8.1c">N_{s}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p1.8.m8.1d">italic_N start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> sequences or samples and each has <math id="S2.SS3.p1.9.m9.1" class="ltx_Math" alttext="S_{m}" display="inline"><semantics id="S2.SS3.p1.9.m9.1a"><msub id="S2.SS3.p1.9.m9.1.1" xref="S2.SS3.p1.9.m9.1.1.cmml"><mi id="S2.SS3.p1.9.m9.1.1.2" xref="S2.SS3.p1.9.m9.1.1.2.cmml">S</mi><mi id="S2.SS3.p1.9.m9.1.1.3" xref="S2.SS3.p1.9.m9.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.9.m9.1b"><apply id="S2.SS3.p1.9.m9.1.1.cmml" xref="S2.SS3.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S2.SS3.p1.9.m9.1.1.1.cmml" xref="S2.SS3.p1.9.m9.1.1">subscript</csymbol><ci id="S2.SS3.p1.9.m9.1.1.2.cmml" xref="S2.SS3.p1.9.m9.1.1.2">𝑆</ci><ci id="S2.SS3.p1.9.m9.1.1.3.cmml" xref="S2.SS3.p1.9.m9.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.9.m9.1c">S_{m}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p1.9.m9.1d">italic_S start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT</annotation></semantics></math> words with a label <math id="S2.SS3.p1.10.m10.1" class="ltx_Math" alttext="\prescript{(m)}{}{y}" display="inline"><semantics id="S2.SS3.p1.10.m10.1a"><mmultiscripts id="S2.SS3.p1.10.m10.1.2" xref="S2.SS3.p1.10.m10.1.2.cmml"><mi id="S2.SS3.p1.10.m10.1.2.2" xref="S2.SS3.p1.10.m10.1.2.2.cmml">y</mi><mprescripts id="S2.SS3.p1.10.m10.1.2a" xref="S2.SS3.p1.10.m10.1.2.cmml"></mprescripts><none id="S2.SS3.p1.10.m10.1.2b" xref="S2.SS3.p1.10.m10.1.2.cmml"></none><mrow id="S2.SS3.p1.10.m10.1.1.1.3" xref="S2.SS3.p1.10.m10.1.2.cmml"><mo stretchy="false" id="S2.SS3.p1.10.m10.1.1.1.3.1" xref="S2.SS3.p1.10.m10.1.2.cmml">(</mo><mi id="S2.SS3.p1.10.m10.1.1.1.1" xref="S2.SS3.p1.10.m10.1.1.1.1.cmml">m</mi><mo stretchy="false" id="S2.SS3.p1.10.m10.1.1.1.3.2" xref="S2.SS3.p1.10.m10.1.2.cmml">)</mo></mrow></mmultiscripts><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.10.m10.1b"><apply id="S2.SS3.p1.10.m10.1.2.cmml" xref="S2.SS3.p1.10.m10.1.2"><csymbol cd="ambiguous" id="S2.SS3.p1.10.m10.1.2.1.cmml" xref="S2.SS3.p1.10.m10.1.2">superscript</csymbol><ci id="S2.SS3.p1.10.m10.1.2.2.cmml" xref="S2.SS3.p1.10.m10.1.2.2">𝑦</ci><ci id="S2.SS3.p1.10.m10.1.1.1.1.cmml" xref="S2.SS3.p1.10.m10.1.1.1.1">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.10.m10.1c">\prescript{(m)}{}{y}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p1.10.m10.1d">start_FLOATSUPERSCRIPT ( italic_m ) end_FLOATSUPERSCRIPT italic_y</annotation></semantics></math> <math id="S2.SS3.p1.11.m11.2" class="ltx_Math" alttext="\in\left\{0,1\right\}" display="inline"><semantics id="S2.SS3.p1.11.m11.2a"><mrow id="S2.SS3.p1.11.m11.2.3" xref="S2.SS3.p1.11.m11.2.3.cmml"><mi id="S2.SS3.p1.11.m11.2.3.2" xref="S2.SS3.p1.11.m11.2.3.2.cmml"></mi><mo id="S2.SS3.p1.11.m11.2.3.1" xref="S2.SS3.p1.11.m11.2.3.1.cmml">∈</mo><mrow id="S2.SS3.p1.11.m11.2.3.3.2" xref="S2.SS3.p1.11.m11.2.3.3.1.cmml"><mo id="S2.SS3.p1.11.m11.2.3.3.2.1" xref="S2.SS3.p1.11.m11.2.3.3.1.cmml">{</mo><mn id="S2.SS3.p1.11.m11.1.1" xref="S2.SS3.p1.11.m11.1.1.cmml">0</mn><mo id="S2.SS3.p1.11.m11.2.3.3.2.2" xref="S2.SS3.p1.11.m11.2.3.3.1.cmml">,</mo><mn id="S2.SS3.p1.11.m11.2.2" xref="S2.SS3.p1.11.m11.2.2.cmml">1</mn><mo id="S2.SS3.p1.11.m11.2.3.3.2.3" xref="S2.SS3.p1.11.m11.2.3.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.11.m11.2b"><apply id="S2.SS3.p1.11.m11.2.3.cmml" xref="S2.SS3.p1.11.m11.2.3"><in id="S2.SS3.p1.11.m11.2.3.1.cmml" xref="S2.SS3.p1.11.m11.2.3.1"></in><csymbol cd="latexml" id="S2.SS3.p1.11.m11.2.3.2.cmml" xref="S2.SS3.p1.11.m11.2.3.2">absent</csymbol><set id="S2.SS3.p1.11.m11.2.3.3.1.cmml" xref="S2.SS3.p1.11.m11.2.3.3.2"><cn type="integer" id="S2.SS3.p1.11.m11.1.1.cmml" xref="S2.SS3.p1.11.m11.1.1">0</cn><cn type="integer" id="S2.SS3.p1.11.m11.2.2.cmml" xref="S2.SS3.p1.11.m11.2.2">1</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.11.m11.2c">\in\left\{0,1\right\}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p1.11.m11.2d">∈ { 0 , 1 }</annotation></semantics></math>.
Here, we assume each word is embedded as a <math id="S2.SS3.p1.12.m12.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S2.SS3.p1.12.m12.1a"><mi id="S2.SS3.p1.12.m12.1.1" xref="S2.SS3.p1.12.m12.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.12.m12.1b"><ci id="S2.SS3.p1.12.m12.1.1.cmml" xref="S2.SS3.p1.12.m12.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.12.m12.1c">d</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p1.12.m12.1d">italic_d</annotation></semantics></math>-dimensional vector, i.e., <math id="S2.SS3.p1.13.m13.1" class="ltx_Math" alttext="\prescript{(m)}{}{\bm{x}_{s}}\in\mathbb{R}^{d}" display="inline"><semantics id="S2.SS3.p1.13.m13.1a"><mrow id="S2.SS3.p1.13.m13.1.2" xref="S2.SS3.p1.13.m13.1.2.cmml"><mmultiscripts id="S2.SS3.p1.13.m13.1.2.2" xref="S2.SS3.p1.13.m13.1.2.2.cmml"><mi id="S2.SS3.p1.13.m13.1.2.2.2.2" xref="S2.SS3.p1.13.m13.1.2.2.2.2.cmml">𝒙</mi><mi id="S2.SS3.p1.13.m13.1.2.2.2.3" xref="S2.SS3.p1.13.m13.1.2.2.2.3.cmml">s</mi><none id="S2.SS3.p1.13.m13.1.2.2a" xref="S2.SS3.p1.13.m13.1.2.2.cmml"></none><mprescripts id="S2.SS3.p1.13.m13.1.2.2b" xref="S2.SS3.p1.13.m13.1.2.2.cmml"></mprescripts><none id="S2.SS3.p1.13.m13.1.2.2c" xref="S2.SS3.p1.13.m13.1.2.2.cmml"></none><mrow id="S2.SS3.p1.13.m13.1.1.1.3" xref="S2.SS3.p1.13.m13.1.2.2.cmml"><mo stretchy="false" id="S2.SS3.p1.13.m13.1.1.1.3.1" xref="S2.SS3.p1.13.m13.1.2.2.cmml">(</mo><mi id="S2.SS3.p1.13.m13.1.1.1.1" xref="S2.SS3.p1.13.m13.1.1.1.1.cmml">m</mi><mo stretchy="false" id="S2.SS3.p1.13.m13.1.1.1.3.2" xref="S2.SS3.p1.13.m13.1.2.2.cmml">)</mo></mrow></mmultiscripts><mo id="S2.SS3.p1.13.m13.1.2.1" xref="S2.SS3.p1.13.m13.1.2.1.cmml">∈</mo><msup id="S2.SS3.p1.13.m13.1.2.3" xref="S2.SS3.p1.13.m13.1.2.3.cmml"><mi id="S2.SS3.p1.13.m13.1.2.3.2" xref="S2.SS3.p1.13.m13.1.2.3.2.cmml">ℝ</mi><mi id="S2.SS3.p1.13.m13.1.2.3.3" xref="S2.SS3.p1.13.m13.1.2.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.13.m13.1b"><apply id="S2.SS3.p1.13.m13.1.2.cmml" xref="S2.SS3.p1.13.m13.1.2"><in id="S2.SS3.p1.13.m13.1.2.1.cmml" xref="S2.SS3.p1.13.m13.1.2.1"></in><apply id="S2.SS3.p1.13.m13.1.2.2.cmml" xref="S2.SS3.p1.13.m13.1.2.2"><csymbol cd="ambiguous" id="S2.SS3.p1.13.m13.1.2.2.1.cmml" xref="S2.SS3.p1.13.m13.1.2.2">superscript</csymbol><apply id="S2.SS3.p1.13.m13.1.2.2.2.cmml" xref="S2.SS3.p1.13.m13.1.2.2"><csymbol cd="ambiguous" id="S2.SS3.p1.13.m13.1.2.2.2.1.cmml" xref="S2.SS3.p1.13.m13.1.2.2">subscript</csymbol><ci id="S2.SS3.p1.13.m13.1.2.2.2.2.cmml" xref="S2.SS3.p1.13.m13.1.2.2.2.2">𝒙</ci><ci id="S2.SS3.p1.13.m13.1.2.2.2.3.cmml" xref="S2.SS3.p1.13.m13.1.2.2.2.3">𝑠</ci></apply><ci id="S2.SS3.p1.13.m13.1.1.1.1.cmml" xref="S2.SS3.p1.13.m13.1.1.1.1">𝑚</ci></apply><apply id="S2.SS3.p1.13.m13.1.2.3.cmml" xref="S2.SS3.p1.13.m13.1.2.3"><csymbol cd="ambiguous" id="S2.SS3.p1.13.m13.1.2.3.1.cmml" xref="S2.SS3.p1.13.m13.1.2.3">superscript</csymbol><ci id="S2.SS3.p1.13.m13.1.2.3.2.cmml" xref="S2.SS3.p1.13.m13.1.2.3.2">ℝ</ci><ci id="S2.SS3.p1.13.m13.1.2.3.3.cmml" xref="S2.SS3.p1.13.m13.1.2.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.13.m13.1c">\prescript{(m)}{}{\bm{x}_{s}}\in\mathbb{R}^{d}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p1.13.m13.1d">start_FLOATSUPERSCRIPT ( italic_m ) end_FLOATSUPERSCRIPT bold_italic_x start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>.
The whole procedure of QSANN is depicted in Fig. <a href="#S2.F3" title="Figure 3 ‣ 2.2 Ansatz Selection ‣ 2 Method ‣ Quantum Self-Attention Neural Networks for Text Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, which mainly consists of <math id="S2.SS3.p1.14.m14.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S2.SS3.p1.14.m14.1a"><mi id="S2.SS3.p1.14.m14.1.1" xref="S2.SS3.p1.14.m14.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.14.m14.1b"><ci id="S2.SS3.p1.14.m14.1.1.cmml" xref="S2.SS3.p1.14.m14.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.14.m14.1c">L</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p1.14.m14.1d">italic_L</annotation></semantics></math> QSALs to extract hidden features and one fully-connected layer to complete the binary prediction task.
Here, the mean squared error <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib44" title="" class="ltx_ref">44</a>]</cite> is employed as the loss function:</p>
</div>
<div id="S2.SS3.p2" class="ltx_para">
<table id="S1.EGx8" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S2.E17"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E17.m1.7" class="ltx_Math" alttext="\displaystyle\mathcal{L}\left(\bm{\Theta},\bm{w},b;\mathcal{D}\right)=\frac{1}%
{2N_{s}}\sum_{m=1}^{N_{s}}\left(\prescript{(m)}{}{\hat{y}}-\prescript{(m)}{}{y%
}\right)^{2}+\text{RegTerm}," display="inline"><semantics id="S2.E17.m1.7a"><mrow id="S2.E17.m1.7.7.1" xref="S2.E17.m1.7.7.1.1.cmml"><mrow id="S2.E17.m1.7.7.1.1" xref="S2.E17.m1.7.7.1.1.cmml"><mrow id="S2.E17.m1.7.7.1.1.3" xref="S2.E17.m1.7.7.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E17.m1.7.7.1.1.3.2" xref="S2.E17.m1.7.7.1.1.3.2.cmml">ℒ</mi><mo id="S2.E17.m1.7.7.1.1.3.1" xref="S2.E17.m1.7.7.1.1.3.1.cmml">⁢</mo><mrow id="S2.E17.m1.7.7.1.1.3.3.2" xref="S2.E17.m1.7.7.1.1.3.3.1.cmml"><mo id="S2.E17.m1.7.7.1.1.3.3.2.1" xref="S2.E17.m1.7.7.1.1.3.3.1.cmml">(</mo><mi id="S2.E17.m1.3.3" xref="S2.E17.m1.3.3.cmml">𝚯</mi><mo id="S2.E17.m1.7.7.1.1.3.3.2.2" xref="S2.E17.m1.7.7.1.1.3.3.1.cmml">,</mo><mi id="S2.E17.m1.4.4" xref="S2.E17.m1.4.4.cmml">𝒘</mi><mo id="S2.E17.m1.7.7.1.1.3.3.2.3" xref="S2.E17.m1.7.7.1.1.3.3.1.cmml">,</mo><mi id="S2.E17.m1.5.5" xref="S2.E17.m1.5.5.cmml">b</mi><mo id="S2.E17.m1.7.7.1.1.3.3.2.4" xref="S2.E17.m1.7.7.1.1.3.3.1.cmml">;</mo><mi class="ltx_font_mathcaligraphic" id="S2.E17.m1.6.6" xref="S2.E17.m1.6.6.cmml">𝒟</mi><mo id="S2.E17.m1.7.7.1.1.3.3.2.5" xref="S2.E17.m1.7.7.1.1.3.3.1.cmml">)</mo></mrow></mrow><mo id="S2.E17.m1.7.7.1.1.2" xref="S2.E17.m1.7.7.1.1.2.cmml">=</mo><mrow id="S2.E17.m1.7.7.1.1.1" xref="S2.E17.m1.7.7.1.1.1.cmml"><mrow id="S2.E17.m1.7.7.1.1.1.1" xref="S2.E17.m1.7.7.1.1.1.1.cmml"><mstyle displaystyle="true" id="S2.E17.m1.7.7.1.1.1.1.3" xref="S2.E17.m1.7.7.1.1.1.1.3.cmml"><mfrac id="S2.E17.m1.7.7.1.1.1.1.3a" xref="S2.E17.m1.7.7.1.1.1.1.3.cmml"><mn id="S2.E17.m1.7.7.1.1.1.1.3.2" xref="S2.E17.m1.7.7.1.1.1.1.3.2.cmml">1</mn><mrow id="S2.E17.m1.7.7.1.1.1.1.3.3" xref="S2.E17.m1.7.7.1.1.1.1.3.3.cmml"><mn id="S2.E17.m1.7.7.1.1.1.1.3.3.2" xref="S2.E17.m1.7.7.1.1.1.1.3.3.2.cmml">2</mn><mo id="S2.E17.m1.7.7.1.1.1.1.3.3.1" xref="S2.E17.m1.7.7.1.1.1.1.3.3.1.cmml">⁢</mo><msub id="S2.E17.m1.7.7.1.1.1.1.3.3.3" xref="S2.E17.m1.7.7.1.1.1.1.3.3.3.cmml"><mi id="S2.E17.m1.7.7.1.1.1.1.3.3.3.2" xref="S2.E17.m1.7.7.1.1.1.1.3.3.3.2.cmml">N</mi><mi id="S2.E17.m1.7.7.1.1.1.1.3.3.3.3" xref="S2.E17.m1.7.7.1.1.1.1.3.3.3.3.cmml">s</mi></msub></mrow></mfrac></mstyle><mo id="S2.E17.m1.7.7.1.1.1.1.2" xref="S2.E17.m1.7.7.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E17.m1.7.7.1.1.1.1.1" xref="S2.E17.m1.7.7.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S2.E17.m1.7.7.1.1.1.1.1.2" xref="S2.E17.m1.7.7.1.1.1.1.1.2.cmml"><munderover id="S2.E17.m1.7.7.1.1.1.1.1.2a" xref="S2.E17.m1.7.7.1.1.1.1.1.2.cmml"><mo largeop="true" movablelimits="false" symmetric="true" id="S2.E17.m1.7.7.1.1.1.1.1.2.2.2" xref="S2.E17.m1.7.7.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S2.E17.m1.7.7.1.1.1.1.1.2.2.3" xref="S2.E17.m1.7.7.1.1.1.1.1.2.2.3.cmml"><mi id="S2.E17.m1.7.7.1.1.1.1.1.2.2.3.2" xref="S2.E17.m1.7.7.1.1.1.1.1.2.2.3.2.cmml">m</mi><mo id="S2.E17.m1.7.7.1.1.1.1.1.2.2.3.1" xref="S2.E17.m1.7.7.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S2.E17.m1.7.7.1.1.1.1.1.2.2.3.3" xref="S2.E17.m1.7.7.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><msub id="S2.E17.m1.7.7.1.1.1.1.1.2.3" xref="S2.E17.m1.7.7.1.1.1.1.1.2.3.cmml"><mi id="S2.E17.m1.7.7.1.1.1.1.1.2.3.2" xref="S2.E17.m1.7.7.1.1.1.1.1.2.3.2.cmml">N</mi><mi id="S2.E17.m1.7.7.1.1.1.1.1.2.3.3" xref="S2.E17.m1.7.7.1.1.1.1.1.2.3.3.cmml">s</mi></msub></munderover></mstyle><msup id="S2.E17.m1.7.7.1.1.1.1.1.1" xref="S2.E17.m1.7.7.1.1.1.1.1.1.cmml"><mrow id="S2.E17.m1.7.7.1.1.1.1.1.1.1.1" xref="S2.E17.m1.7.7.1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E17.m1.7.7.1.1.1.1.1.1.1.1.2" xref="S2.E17.m1.7.7.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E17.m1.7.7.1.1.1.1.1.1.1.1.1" xref="S2.E17.m1.7.7.1.1.1.1.1.1.1.1.1.cmml"><mmultiscripts id="S2.E17.m1.7.7.1.1.1.1.1.1.1.1.1.2" xref="S2.E17.m1.7.7.1.1.1.1.1.1.1.1.1.2.cmml"><mover accent="true" id="S2.E17.m1.7.7.1.1.1.1.1.1.1.1.1.2.2" xref="S2.E17.m1.7.7.1.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S2.E17.m1.7.7.1.1.1.1.1.1.1.1.1.2.2.2" xref="S2.E17.m1.7.7.1.1.1.1.1.1.1.1.1.2.2.2.cmml">y</mi><mo stretchy="false" id="S2.E17.m1.7.7.1.1.1.1.1.1.1.1.1.2.2.1" xref="S2.E17.m1.7.7.1.1.1.1.1.1.1.1.1.2.2.1.cmml">^</mo></mover><mprescripts id="S2.E17.m1.7.7.1.1.1.1.1.1.1.1.1.2a" xref="S2.E17.m1.7.7.1.1.1.1.1.1.1.1.1.2.cmml"></mprescripts><none id="S2.E17.m1.7.7.1.1.1.1.1.1.1.1.1.2b" xref="S2.E17.m1.7.7.1.1.1.1.1.1.1.1.1.2.cmml"></none><mrow id="S2.E17.m1.1.1.1.3" xref="S2.E17.m1.7.7.1.1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.E17.m1.1.1.1.3.1" xref="S2.E17.m1.7.7.1.1.1.1.1.1.1.1.1.2.cmml">(</mo><mi id="S2.E17.m1.1.1.1.1" xref="S2.E17.m1.1.1.1.1.cmml">m</mi><mo stretchy="false" id="S2.E17.m1.1.1.1.3.2" xref="S2.E17.m1.7.7.1.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mmultiscripts><mo id="S2.E17.m1.7.7.1.1.1.1.1.1.1.1.1.1" xref="S2.E17.m1.7.7.1.1.1.1.1.1.1.1.1.1.cmml">-</mo><mmultiscripts id="S2.E17.m1.7.7.1.1.1.1.1.1.1.1.1.3" xref="S2.E17.m1.7.7.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E17.m1.7.7.1.1.1.1.1.1.1.1.1.3.2" xref="S2.E17.m1.7.7.1.1.1.1.1.1.1.1.1.3.2.cmml">y</mi><mprescripts id="S2.E17.m1.7.7.1.1.1.1.1.1.1.1.1.3a" xref="S2.E17.m1.7.7.1.1.1.1.1.1.1.1.1.3.cmml"></mprescripts><none id="S2.E17.m1.7.7.1.1.1.1.1.1.1.1.1.3b" xref="S2.E17.m1.7.7.1.1.1.1.1.1.1.1.1.3.cmml"></none><mrow id="S2.E17.m1.2.2.1.3" xref="S2.E17.m1.7.7.1.1.1.1.1.1.1.1.1.3.cmml"><mo stretchy="false" id="S2.E17.m1.2.2.1.3.1" xref="S2.E17.m1.7.7.1.1.1.1.1.1.1.1.1.3.cmml">(</mo><mi id="S2.E17.m1.2.2.1.1" xref="S2.E17.m1.2.2.1.1.cmml">m</mi><mo stretchy="false" id="S2.E17.m1.2.2.1.3.2" xref="S2.E17.m1.7.7.1.1.1.1.1.1.1.1.1.3.cmml">)</mo></mrow></mmultiscripts></mrow><mo id="S2.E17.m1.7.7.1.1.1.1.1.1.1.1.3" xref="S2.E17.m1.7.7.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="S2.E17.m1.7.7.1.1.1.1.1.1.3" xref="S2.E17.m1.7.7.1.1.1.1.1.1.3.cmml">2</mn></msup></mrow></mrow><mo id="S2.E17.m1.7.7.1.1.1.2" xref="S2.E17.m1.7.7.1.1.1.2.cmml">+</mo><mtext id="S2.E17.m1.7.7.1.1.1.3" xref="S2.E17.m1.7.7.1.1.1.3a.cmml">RegTerm</mtext></mrow></mrow><mo id="S2.E17.m1.7.7.1.2" xref="S2.E17.m1.7.7.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E17.m1.7b"><apply id="S2.E17.m1.7.7.1.1.cmml" xref="S2.E17.m1.7.7.1"><eq id="S2.E17.m1.7.7.1.1.2.cmml" xref="S2.E17.m1.7.7.1.1.2"></eq><apply id="S2.E17.m1.7.7.1.1.3.cmml" xref="S2.E17.m1.7.7.1.1.3"><times id="S2.E17.m1.7.7.1.1.3.1.cmml" xref="S2.E17.m1.7.7.1.1.3.1"></times><ci id="S2.E17.m1.7.7.1.1.3.2.cmml" xref="S2.E17.m1.7.7.1.1.3.2">ℒ</ci><vector id="S2.E17.m1.7.7.1.1.3.3.1.cmml" xref="S2.E17.m1.7.7.1.1.3.3.2"><ci id="S2.E17.m1.3.3.cmml" xref="S2.E17.m1.3.3">𝚯</ci><ci id="S2.E17.m1.4.4.cmml" xref="S2.E17.m1.4.4">𝒘</ci><ci id="S2.E17.m1.5.5.cmml" xref="S2.E17.m1.5.5">𝑏</ci><ci id="S2.E17.m1.6.6.cmml" xref="S2.E17.m1.6.6">𝒟</ci></vector></apply><apply id="S2.E17.m1.7.7.1.1.1.cmml" xref="S2.E17.m1.7.7.1.1.1"><plus id="S2.E17.m1.7.7.1.1.1.2.cmml" xref="S2.E17.m1.7.7.1.1.1.2"></plus><apply id="S2.E17.m1.7.7.1.1.1.1.cmml" xref="S2.E17.m1.7.7.1.1.1.1"><times id="S2.E17.m1.7.7.1.1.1.1.2.cmml" xref="S2.E17.m1.7.7.1.1.1.1.2"></times><apply id="S2.E17.m1.7.7.1.1.1.1.3.cmml" xref="S2.E17.m1.7.7.1.1.1.1.3"><divide id="S2.E17.m1.7.7.1.1.1.1.3.1.cmml" xref="S2.E17.m1.7.7.1.1.1.1.3"></divide><cn type="integer" id="S2.E17.m1.7.7.1.1.1.1.3.2.cmml" xref="S2.E17.m1.7.7.1.1.1.1.3.2">1</cn><apply id="S2.E17.m1.7.7.1.1.1.1.3.3.cmml" xref="S2.E17.m1.7.7.1.1.1.1.3.3"><times id="S2.E17.m1.7.7.1.1.1.1.3.3.1.cmml" xref="S2.E17.m1.7.7.1.1.1.1.3.3.1"></times><cn type="integer" id="S2.E17.m1.7.7.1.1.1.1.3.3.2.cmml" xref="S2.E17.m1.7.7.1.1.1.1.3.3.2">2</cn><apply id="S2.E17.m1.7.7.1.1.1.1.3.3.3.cmml" xref="S2.E17.m1.7.7.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.E17.m1.7.7.1.1.1.1.3.3.3.1.cmml" xref="S2.E17.m1.7.7.1.1.1.1.3.3.3">subscript</csymbol><ci id="S2.E17.m1.7.7.1.1.1.1.3.3.3.2.cmml" xref="S2.E17.m1.7.7.1.1.1.1.3.3.3.2">𝑁</ci><ci id="S2.E17.m1.7.7.1.1.1.1.3.3.3.3.cmml" xref="S2.E17.m1.7.7.1.1.1.1.3.3.3.3">𝑠</ci></apply></apply></apply><apply id="S2.E17.m1.7.7.1.1.1.1.1.cmml" xref="S2.E17.m1.7.7.1.1.1.1.1"><apply id="S2.E17.m1.7.7.1.1.1.1.1.2.cmml" xref="S2.E17.m1.7.7.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E17.m1.7.7.1.1.1.1.1.2.1.cmml" xref="S2.E17.m1.7.7.1.1.1.1.1.2">superscript</csymbol><apply id="S2.E17.m1.7.7.1.1.1.1.1.2.2.cmml" xref="S2.E17.m1.7.7.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E17.m1.7.7.1.1.1.1.1.2.2.1.cmml" xref="S2.E17.m1.7.7.1.1.1.1.1.2">subscript</csymbol><sum id="S2.E17.m1.7.7.1.1.1.1.1.2.2.2.cmml" xref="S2.E17.m1.7.7.1.1.1.1.1.2.2.2"></sum><apply id="S2.E17.m1.7.7.1.1.1.1.1.2.2.3.cmml" xref="S2.E17.m1.7.7.1.1.1.1.1.2.2.3"><eq id="S2.E17.m1.7.7.1.1.1.1.1.2.2.3.1.cmml" xref="S2.E17.m1.7.7.1.1.1.1.1.2.2.3.1"></eq><ci id="S2.E17.m1.7.7.1.1.1.1.1.2.2.3.2.cmml" xref="S2.E17.m1.7.7.1.1.1.1.1.2.2.3.2">𝑚</ci><cn type="integer" id="S2.E17.m1.7.7.1.1.1.1.1.2.2.3.3.cmml" xref="S2.E17.m1.7.7.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><apply id="S2.E17.m1.7.7.1.1.1.1.1.2.3.cmml" xref="S2.E17.m1.7.7.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S2.E17.m1.7.7.1.1.1.1.1.2.3.1.cmml" xref="S2.E17.m1.7.7.1.1.1.1.1.2.3">subscript</csymbol><ci id="S2.E17.m1.7.7.1.1.1.1.1.2.3.2.cmml" xref="S2.E17.m1.7.7.1.1.1.1.1.2.3.2">𝑁</ci><ci id="S2.E17.m1.7.7.1.1.1.1.1.2.3.3.cmml" xref="S2.E17.m1.7.7.1.1.1.1.1.2.3.3">𝑠</ci></apply></apply><apply id="S2.E17.m1.7.7.1.1.1.1.1.1.cmml" xref="S2.E17.m1.7.7.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E17.m1.7.7.1.1.1.1.1.1.2.cmml" xref="S2.E17.m1.7.7.1.1.1.1.1.1">superscript</csymbol><apply id="S2.E17.m1.7.7.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E17.m1.7.7.1.1.1.1.1.1.1.1"><minus id="S2.E17.m1.7.7.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E17.m1.7.7.1.1.1.1.1.1.1.1.1.1"></minus><apply id="S2.E17.m1.7.7.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E17.m1.7.7.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E17.m1.7.7.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E17.m1.7.7.1.1.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S2.E17.m1.7.7.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E17.m1.7.7.1.1.1.1.1.1.1.1.1.2.2"><ci id="S2.E17.m1.7.7.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S2.E17.m1.7.7.1.1.1.1.1.1.1.1.1.2.2.1">^</ci><ci id="S2.E17.m1.7.7.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S2.E17.m1.7.7.1.1.1.1.1.1.1.1.1.2.2.2">𝑦</ci></apply><ci id="S2.E17.m1.1.1.1.1.cmml" xref="S2.E17.m1.1.1.1.1">𝑚</ci></apply><apply id="S2.E17.m1.7.7.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E17.m1.7.7.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E17.m1.7.7.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E17.m1.7.7.1.1.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S2.E17.m1.7.7.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E17.m1.7.7.1.1.1.1.1.1.1.1.1.3.2">𝑦</ci><ci id="S2.E17.m1.2.2.1.1.cmml" xref="S2.E17.m1.2.2.1.1">𝑚</ci></apply></apply><cn type="integer" id="S2.E17.m1.7.7.1.1.1.1.1.1.3.cmml" xref="S2.E17.m1.7.7.1.1.1.1.1.1.3">2</cn></apply></apply></apply><ci id="S2.E17.m1.7.7.1.1.1.3a.cmml" xref="S2.E17.m1.7.7.1.1.1.3"><mtext id="S2.E17.m1.7.7.1.1.1.3.cmml" xref="S2.E17.m1.7.7.1.1.1.3">RegTerm</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E17.m1.7c">\displaystyle\mathcal{L}\left(\bm{\Theta},\bm{w},b;\mathcal{D}\right)=\frac{1}%
{2N_{s}}\sum_{m=1}^{N_{s}}\left(\prescript{(m)}{}{\hat{y}}-\prescript{(m)}{}{y%
}\right)^{2}+\text{RegTerm},</annotation><annotation encoding="application/x-llamapun" id="S2.E17.m1.7d">caligraphic_L ( bold_Θ , bold_italic_w , italic_b ; caligraphic_D ) = divide start_ARG 1 end_ARG start_ARG 2 italic_N start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT end_ARG ∑ start_POSTSUBSCRIPT italic_m = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT end_POSTSUPERSCRIPT ( start_FLOATSUPERSCRIPT ( italic_m ) end_FLOATSUPERSCRIPT over^ start_ARG italic_y end_ARG - start_FLOATSUPERSCRIPT ( italic_m ) end_FLOATSUPERSCRIPT italic_y ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + RegTerm ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(17)</span></td>
</tr></tbody>
</table>
<p id="S2.SS3.p2.6" class="ltx_p">where the predicted value <math id="S2.SS3.p2.1.m1.1" class="ltx_Math" alttext="\prescript{(m)}{}{\hat{y}}" display="inline"><semantics id="S2.SS3.p2.1.m1.1a"><mmultiscripts id="S2.SS3.p2.1.m1.1.2" xref="S2.SS3.p2.1.m1.1.2.cmml"><mover accent="true" id="S2.SS3.p2.1.m1.1.2.2" xref="S2.SS3.p2.1.m1.1.2.2.cmml"><mi id="S2.SS3.p2.1.m1.1.2.2.2" xref="S2.SS3.p2.1.m1.1.2.2.2.cmml">y</mi><mo stretchy="false" id="S2.SS3.p2.1.m1.1.2.2.1" xref="S2.SS3.p2.1.m1.1.2.2.1.cmml">^</mo></mover><mprescripts id="S2.SS3.p2.1.m1.1.2a" xref="S2.SS3.p2.1.m1.1.2.cmml"></mprescripts><none id="S2.SS3.p2.1.m1.1.2b" xref="S2.SS3.p2.1.m1.1.2.cmml"></none><mrow id="S2.SS3.p2.1.m1.1.1.1.3" xref="S2.SS3.p2.1.m1.1.2.cmml"><mo stretchy="false" id="S2.SS3.p2.1.m1.1.1.1.3.1" xref="S2.SS3.p2.1.m1.1.2.cmml">(</mo><mi id="S2.SS3.p2.1.m1.1.1.1.1" xref="S2.SS3.p2.1.m1.1.1.1.1.cmml">m</mi><mo stretchy="false" id="S2.SS3.p2.1.m1.1.1.1.3.2" xref="S2.SS3.p2.1.m1.1.2.cmml">)</mo></mrow></mmultiscripts><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.1.m1.1b"><apply id="S2.SS3.p2.1.m1.1.2.cmml" xref="S2.SS3.p2.1.m1.1.2"><csymbol cd="ambiguous" id="S2.SS3.p2.1.m1.1.2.1.cmml" xref="S2.SS3.p2.1.m1.1.2">superscript</csymbol><apply id="S2.SS3.p2.1.m1.1.2.2.cmml" xref="S2.SS3.p2.1.m1.1.2.2"><ci id="S2.SS3.p2.1.m1.1.2.2.1.cmml" xref="S2.SS3.p2.1.m1.1.2.2.1">^</ci><ci id="S2.SS3.p2.1.m1.1.2.2.2.cmml" xref="S2.SS3.p2.1.m1.1.2.2.2">𝑦</ci></apply><ci id="S2.SS3.p2.1.m1.1.1.1.1.cmml" xref="S2.SS3.p2.1.m1.1.1.1.1">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.1.m1.1c">\prescript{(m)}{}{\hat{y}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.1.m1.1d">start_FLOATSUPERSCRIPT ( italic_m ) end_FLOATSUPERSCRIPT over^ start_ARG italic_y end_ARG</annotation></semantics></math> is defined as
<math id="S2.SS3.p2.2.m2.4" class="ltx_Math" alttext="\prescript{(m)}{}{\hat{y}}:=\sigma\left(\bm{w}^{\top}\cdot\frac{1}{S_{m}}\sum_%
{s=1}^{S_{m}}\prescript{(m)}{}{\bm{y}}^{(L)}_{s}+b\right)" display="inline"><semantics id="S2.SS3.p2.2.m2.4a"><mrow id="S2.SS3.p2.2.m2.4.4" xref="S2.SS3.p2.2.m2.4.4.cmml"><mmultiscripts id="S2.SS3.p2.2.m2.4.4.3" xref="S2.SS3.p2.2.m2.4.4.3.cmml"><mover accent="true" id="S2.SS3.p2.2.m2.4.4.3.2" xref="S2.SS3.p2.2.m2.4.4.3.2.cmml"><mi id="S2.SS3.p2.2.m2.4.4.3.2.2" xref="S2.SS3.p2.2.m2.4.4.3.2.2.cmml">y</mi><mo stretchy="false" id="S2.SS3.p2.2.m2.4.4.3.2.1" xref="S2.SS3.p2.2.m2.4.4.3.2.1.cmml">^</mo></mover><mprescripts id="S2.SS3.p2.2.m2.4.4.3a" xref="S2.SS3.p2.2.m2.4.4.3.cmml"></mprescripts><none id="S2.SS3.p2.2.m2.4.4.3b" xref="S2.SS3.p2.2.m2.4.4.3.cmml"></none><mrow id="S2.SS3.p2.2.m2.1.1.1.3" xref="S2.SS3.p2.2.m2.4.4.3.cmml"><mo stretchy="false" id="S2.SS3.p2.2.m2.1.1.1.3.1" xref="S2.SS3.p2.2.m2.4.4.3.cmml">(</mo><mi id="S2.SS3.p2.2.m2.1.1.1.1" xref="S2.SS3.p2.2.m2.1.1.1.1.cmml">m</mi><mo stretchy="false" id="S2.SS3.p2.2.m2.1.1.1.3.2" xref="S2.SS3.p2.2.m2.4.4.3.cmml">)</mo></mrow></mmultiscripts><mo id="S2.SS3.p2.2.m2.4.4.2" xref="S2.SS3.p2.2.m2.4.4.2.cmml">:=</mo><mrow id="S2.SS3.p2.2.m2.4.4.1" xref="S2.SS3.p2.2.m2.4.4.1.cmml"><mi id="S2.SS3.p2.2.m2.4.4.1.3" xref="S2.SS3.p2.2.m2.4.4.1.3.cmml">σ</mi><mo id="S2.SS3.p2.2.m2.4.4.1.2" xref="S2.SS3.p2.2.m2.4.4.1.2.cmml">⁢</mo><mrow id="S2.SS3.p2.2.m2.4.4.1.1.1" xref="S2.SS3.p2.2.m2.4.4.1.1.1.1.cmml"><mo id="S2.SS3.p2.2.m2.4.4.1.1.1.2" xref="S2.SS3.p2.2.m2.4.4.1.1.1.1.cmml">(</mo><mrow id="S2.SS3.p2.2.m2.4.4.1.1.1.1" xref="S2.SS3.p2.2.m2.4.4.1.1.1.1.cmml"><mrow id="S2.SS3.p2.2.m2.4.4.1.1.1.1.2" xref="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.cmml"><mrow id="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.2" xref="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.2.cmml"><msup id="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.2.2" xref="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.2.2.cmml"><mi id="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.2.2.2" xref="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.2.2.2.cmml">𝒘</mi><mo id="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.2.2.3" xref="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.2.2.3.cmml">⊤</mo></msup><mo id="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.2.1" xref="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.2.1.cmml">⋅</mo><mfrac id="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.2.3" xref="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.2.3.cmml"><mn id="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.2.3.2" xref="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.2.3.2.cmml">1</mn><msub id="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.2.3.3" xref="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.2.3.3.cmml"><mi id="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.2.3.3.2" xref="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.2.3.3.2.cmml">S</mi><mi id="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.2.3.3.3" xref="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.2.3.3.3.cmml">m</mi></msub></mfrac></mrow><mo id="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.1" xref="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.1.cmml">⁢</mo><mrow id="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.3" xref="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.3.cmml"><msubsup id="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.3.1" xref="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.3.1.cmml"><mo largeop="true" symmetric="true" id="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.3.1.2.2" xref="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.3.1.2.2.cmml">∑</mo><mrow id="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.3.1.2.3" xref="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.3.1.2.3.cmml"><mi id="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.3.1.2.3.2" xref="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.3.1.2.3.2.cmml">s</mi><mo id="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.3.1.2.3.1" xref="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.3.1.2.3.1.cmml">=</mo><mn id="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.3.1.2.3.3" xref="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.3.1.2.3.3.cmml">1</mn></mrow><msub id="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.3.1.3" xref="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.3.1.3.cmml"><mi id="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.3.1.3.2" xref="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.3.1.3.2.cmml">S</mi><mi id="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.3.1.3.3" xref="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.3.1.3.3.cmml">m</mi></msub></msubsup><mmultiscripts id="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.3.2" xref="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.3.2.cmml"><mi id="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.3.2.2.2.2" xref="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.3.2.2.2.2.cmml">𝒚</mi><mi id="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.3.2.2.3" xref="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.3.2.2.3.cmml">s</mi><mrow id="S2.SS3.p2.2.m2.3.3.1.3" xref="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.3.2.cmml"><mo stretchy="false" id="S2.SS3.p2.2.m2.3.3.1.3.1" xref="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.3.2.cmml">(</mo><mi id="S2.SS3.p2.2.m2.3.3.1.1" xref="S2.SS3.p2.2.m2.3.3.1.1.cmml">L</mi><mo stretchy="false" id="S2.SS3.p2.2.m2.3.3.1.3.2" xref="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.3.2.cmml">)</mo></mrow><mprescripts id="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.3.2a" xref="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.3.2.cmml"></mprescripts><none id="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.3.2b" xref="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.3.2.cmml"></none><mrow id="S2.SS3.p2.2.m2.2.2.1.3" xref="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.3.2.cmml"><mo stretchy="false" id="S2.SS3.p2.2.m2.2.2.1.3.1" xref="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.3.2.cmml">(</mo><mi id="S2.SS3.p2.2.m2.2.2.1.1" xref="S2.SS3.p2.2.m2.2.2.1.1.cmml">m</mi><mo stretchy="false" id="S2.SS3.p2.2.m2.2.2.1.3.2" xref="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.3.2.cmml">)</mo></mrow></mmultiscripts></mrow></mrow><mo id="S2.SS3.p2.2.m2.4.4.1.1.1.1.1" xref="S2.SS3.p2.2.m2.4.4.1.1.1.1.1.cmml">+</mo><mi id="S2.SS3.p2.2.m2.4.4.1.1.1.1.3" xref="S2.SS3.p2.2.m2.4.4.1.1.1.1.3.cmml">b</mi></mrow><mo id="S2.SS3.p2.2.m2.4.4.1.1.1.3" xref="S2.SS3.p2.2.m2.4.4.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.2.m2.4b"><apply id="S2.SS3.p2.2.m2.4.4.cmml" xref="S2.SS3.p2.2.m2.4.4"><csymbol cd="latexml" id="S2.SS3.p2.2.m2.4.4.2.cmml" xref="S2.SS3.p2.2.m2.4.4.2">assign</csymbol><apply id="S2.SS3.p2.2.m2.4.4.3.cmml" xref="S2.SS3.p2.2.m2.4.4.3"><csymbol cd="ambiguous" id="S2.SS3.p2.2.m2.4.4.3.1.cmml" xref="S2.SS3.p2.2.m2.4.4.3">superscript</csymbol><apply id="S2.SS3.p2.2.m2.4.4.3.2.cmml" xref="S2.SS3.p2.2.m2.4.4.3.2"><ci id="S2.SS3.p2.2.m2.4.4.3.2.1.cmml" xref="S2.SS3.p2.2.m2.4.4.3.2.1">^</ci><ci id="S2.SS3.p2.2.m2.4.4.3.2.2.cmml" xref="S2.SS3.p2.2.m2.4.4.3.2.2">𝑦</ci></apply><ci id="S2.SS3.p2.2.m2.1.1.1.1.cmml" xref="S2.SS3.p2.2.m2.1.1.1.1">𝑚</ci></apply><apply id="S2.SS3.p2.2.m2.4.4.1.cmml" xref="S2.SS3.p2.2.m2.4.4.1"><times id="S2.SS3.p2.2.m2.4.4.1.2.cmml" xref="S2.SS3.p2.2.m2.4.4.1.2"></times><ci id="S2.SS3.p2.2.m2.4.4.1.3.cmml" xref="S2.SS3.p2.2.m2.4.4.1.3">𝜎</ci><apply id="S2.SS3.p2.2.m2.4.4.1.1.1.1.cmml" xref="S2.SS3.p2.2.m2.4.4.1.1.1"><plus id="S2.SS3.p2.2.m2.4.4.1.1.1.1.1.cmml" xref="S2.SS3.p2.2.m2.4.4.1.1.1.1.1"></plus><apply id="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.cmml" xref="S2.SS3.p2.2.m2.4.4.1.1.1.1.2"><times id="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.1.cmml" xref="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.1"></times><apply id="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.2.cmml" xref="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.2"><ci id="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.2.1.cmml" xref="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.2.1">⋅</ci><apply id="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.2.2.cmml" xref="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.2.2.1.cmml" xref="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.2.2">superscript</csymbol><ci id="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.2.2.2.cmml" xref="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.2.2.2">𝒘</ci><csymbol cd="latexml" id="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.2.2.3.cmml" xref="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.2.2.3">top</csymbol></apply><apply id="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.2.3.cmml" xref="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.2.3"><divide id="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.2.3.1.cmml" xref="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.2.3"></divide><cn type="integer" id="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.2.3.2.cmml" xref="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.2.3.2">1</cn><apply id="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.2.3.3.cmml" xref="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.2.3.3"><csymbol cd="ambiguous" id="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.2.3.3.1.cmml" xref="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.2.3.3">subscript</csymbol><ci id="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.2.3.3.2.cmml" xref="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.2.3.3.2">𝑆</ci><ci id="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.2.3.3.3.cmml" xref="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.2.3.3.3">𝑚</ci></apply></apply></apply><apply id="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.3.cmml" xref="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.3"><apply id="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.3.1.cmml" xref="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.3.1"><csymbol cd="ambiguous" id="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.3.1.1.cmml" xref="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.3.1">superscript</csymbol><apply id="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.3.1.2.cmml" xref="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.3.1"><csymbol cd="ambiguous" id="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.3.1.2.1.cmml" xref="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.3.1">subscript</csymbol><sum id="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.3.1.2.2.cmml" xref="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.3.1.2.2"></sum><apply id="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.3.1.2.3.cmml" xref="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.3.1.2.3"><eq id="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.3.1.2.3.1.cmml" xref="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.3.1.2.3.1"></eq><ci id="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.3.1.2.3.2.cmml" xref="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.3.1.2.3.2">𝑠</ci><cn type="integer" id="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.3.1.2.3.3.cmml" xref="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.3.1.2.3.3">1</cn></apply></apply><apply id="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.3.1.3.cmml" xref="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.3.1.3"><csymbol cd="ambiguous" id="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.3.1.3.1.cmml" xref="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.3.1.3">subscript</csymbol><ci id="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.3.1.3.2.cmml" xref="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.3.1.3.2">𝑆</ci><ci id="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.3.1.3.3.cmml" xref="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.3.1.3.3">𝑚</ci></apply></apply><apply id="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.3.2.cmml" xref="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.3.2"><csymbol cd="ambiguous" id="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.3.2.1.cmml" xref="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.3.2">superscript</csymbol><apply id="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.3.2.2.cmml" xref="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.3.2"><csymbol cd="ambiguous" id="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.3.2.2.1.cmml" xref="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.3.2">subscript</csymbol><apply id="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.3.2.2.2.cmml" xref="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.3.2"><csymbol cd="ambiguous" id="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.3.2.2.2.1.cmml" xref="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.3.2">superscript</csymbol><ci id="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.3.2.2.2.2.cmml" xref="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.3.2.2.2.2">𝒚</ci><ci id="S2.SS3.p2.2.m2.3.3.1.1.cmml" xref="S2.SS3.p2.2.m2.3.3.1.1">𝐿</ci></apply><ci id="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.3.2.2.3.cmml" xref="S2.SS3.p2.2.m2.4.4.1.1.1.1.2.3.2.2.3">𝑠</ci></apply><ci id="S2.SS3.p2.2.m2.2.2.1.1.cmml" xref="S2.SS3.p2.2.m2.2.2.1.1">𝑚</ci></apply></apply></apply><ci id="S2.SS3.p2.2.m2.4.4.1.1.1.1.3.cmml" xref="S2.SS3.p2.2.m2.4.4.1.1.1.1.3">𝑏</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.2.m2.4c">\prescript{(m)}{}{\hat{y}}:=\sigma\left(\bm{w}^{\top}\cdot\frac{1}{S_{m}}\sum_%
{s=1}^{S_{m}}\prescript{(m)}{}{\bm{y}}^{(L)}_{s}+b\right)</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.2.m2.4d">start_FLOATSUPERSCRIPT ( italic_m ) end_FLOATSUPERSCRIPT over^ start_ARG italic_y end_ARG := italic_σ ( bold_italic_w start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT ⋅ divide start_ARG 1 end_ARG start_ARG italic_S start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT end_ARG ∑ start_POSTSUBSCRIPT italic_s = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_S start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT end_POSTSUPERSCRIPT start_FLOATSUPERSCRIPT ( italic_m ) end_FLOATSUPERSCRIPT bold_italic_y start_POSTSUPERSCRIPT ( italic_L ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT + italic_b )</annotation></semantics></math>
with <math id="S2.SS3.p2.3.m3.1" class="ltx_Math" alttext="\bm{w}\in\mathbb{R}^{d}" display="inline"><semantics id="S2.SS3.p2.3.m3.1a"><mrow id="S2.SS3.p2.3.m3.1.1" xref="S2.SS3.p2.3.m3.1.1.cmml"><mi id="S2.SS3.p2.3.m3.1.1.2" xref="S2.SS3.p2.3.m3.1.1.2.cmml">𝒘</mi><mo id="S2.SS3.p2.3.m3.1.1.1" xref="S2.SS3.p2.3.m3.1.1.1.cmml">∈</mo><msup id="S2.SS3.p2.3.m3.1.1.3" xref="S2.SS3.p2.3.m3.1.1.3.cmml"><mi id="S2.SS3.p2.3.m3.1.1.3.2" xref="S2.SS3.p2.3.m3.1.1.3.2.cmml">ℝ</mi><mi id="S2.SS3.p2.3.m3.1.1.3.3" xref="S2.SS3.p2.3.m3.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.3.m3.1b"><apply id="S2.SS3.p2.3.m3.1.1.cmml" xref="S2.SS3.p2.3.m3.1.1"><in id="S2.SS3.p2.3.m3.1.1.1.cmml" xref="S2.SS3.p2.3.m3.1.1.1"></in><ci id="S2.SS3.p2.3.m3.1.1.2.cmml" xref="S2.SS3.p2.3.m3.1.1.2">𝒘</ci><apply id="S2.SS3.p2.3.m3.1.1.3.cmml" xref="S2.SS3.p2.3.m3.1.1.3"><csymbol cd="ambiguous" id="S2.SS3.p2.3.m3.1.1.3.1.cmml" xref="S2.SS3.p2.3.m3.1.1.3">superscript</csymbol><ci id="S2.SS3.p2.3.m3.1.1.3.2.cmml" xref="S2.SS3.p2.3.m3.1.1.3.2">ℝ</ci><ci id="S2.SS3.p2.3.m3.1.1.3.3.cmml" xref="S2.SS3.p2.3.m3.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.3.m3.1c">\bm{w}\in\mathbb{R}^{d}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.3.m3.1d">bold_italic_w ∈ blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> and <math id="S2.SS3.p2.4.m4.1" class="ltx_Math" alttext="b\in\mathbb{R}" display="inline"><semantics id="S2.SS3.p2.4.m4.1a"><mrow id="S2.SS3.p2.4.m4.1.1" xref="S2.SS3.p2.4.m4.1.1.cmml"><mi id="S2.SS3.p2.4.m4.1.1.2" xref="S2.SS3.p2.4.m4.1.1.2.cmml">b</mi><mo id="S2.SS3.p2.4.m4.1.1.1" xref="S2.SS3.p2.4.m4.1.1.1.cmml">∈</mo><mi id="S2.SS3.p2.4.m4.1.1.3" xref="S2.SS3.p2.4.m4.1.1.3.cmml">ℝ</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.4.m4.1b"><apply id="S2.SS3.p2.4.m4.1.1.cmml" xref="S2.SS3.p2.4.m4.1.1"><in id="S2.SS3.p2.4.m4.1.1.1.cmml" xref="S2.SS3.p2.4.m4.1.1.1"></in><ci id="S2.SS3.p2.4.m4.1.1.2.cmml" xref="S2.SS3.p2.4.m4.1.1.2">𝑏</ci><ci id="S2.SS3.p2.4.m4.1.1.3.cmml" xref="S2.SS3.p2.4.m4.1.1.3">ℝ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.4.m4.1c">b\in\mathbb{R}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.4.m4.1d">italic_b ∈ blackboard_R</annotation></semantics></math> denoting the weights and bias of the final fully-connected layer, <math id="S2.SS3.p2.5.m5.1" class="ltx_Math" alttext="\bm{\Theta}" display="inline"><semantics id="S2.SS3.p2.5.m5.1a"><mi id="S2.SS3.p2.5.m5.1.1" xref="S2.SS3.p2.5.m5.1.1.cmml">𝚯</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.5.m5.1b"><ci id="S2.SS3.p2.5.m5.1.1.cmml" xref="S2.SS3.p2.5.m5.1.1">𝚯</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.5.m5.1c">\bm{\Theta}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.5.m5.1d">bold_Θ</annotation></semantics></math> denoting all parameters in the ansatz, <math id="S2.SS3.p2.6.m6.1" class="ltx_Math" alttext="\sigma" display="inline"><semantics id="S2.SS3.p2.6.m6.1a"><mi id="S2.SS3.p2.6.m6.1.1" xref="S2.SS3.p2.6.m6.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.6.m6.1b"><ci id="S2.SS3.p2.6.m6.1.1.cmml" xref="S2.SS3.p2.6.m6.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.6.m6.1c">\sigma</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.6.m6.1d">italic_σ</annotation></semantics></math> denoting the sigmoid activation function and ‘RegTerm’ being the regularization term to avoid overfitting in the training process.</p>
</div>
<div id="S2.SS3.p3" class="ltx_para">
<p id="S2.SS3.p3.5" class="ltx_p">Combining Eqs. (<a href="#S2.E11" title="(11) ‣ 2.1 Quantum Self-Attention Layer ‣ 2 Method ‣ Quantum Self-Attention Neural Networks for Text Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">11</span></a>)
- (<a href="#S2.E16" title="(16) ‣ 2.1 Quantum Self-Attention Layer ‣ 2 Method ‣ Quantum Self-Attention Neural Networks for Text Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">16</span></a>), we know each output of QSAL is dependent on all its inputs, i.e.,
</p>
<table id="S1.EGx9" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S2.Ex3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.Ex3.m1.2" class="ltx_Math" alttext="\displaystyle\prescript{(m)}{}{\bm{y}}^{(l)}_{s}:=" display="inline"><semantics id="S2.Ex3.m1.2a"><mrow id="S2.Ex3.m1.2.3" xref="S2.Ex3.m1.2.3.cmml"><mmultiscripts id="S2.Ex3.m1.2.3.2" xref="S2.Ex3.m1.2.3.2.cmml"><mi id="S2.Ex3.m1.2.3.2.2.2.2" xref="S2.Ex3.m1.2.3.2.2.2.2.cmml">𝒚</mi><mi id="S2.Ex3.m1.2.3.2.2.3" xref="S2.Ex3.m1.2.3.2.2.3.cmml">s</mi><mrow id="S2.Ex3.m1.2.2.1.3" xref="S2.Ex3.m1.2.3.2.cmml"><mo stretchy="false" id="S2.Ex3.m1.2.2.1.3.1" xref="S2.Ex3.m1.2.3.2.cmml">(</mo><mi id="S2.Ex3.m1.2.2.1.1" xref="S2.Ex3.m1.2.2.1.1.cmml">l</mi><mo stretchy="false" id="S2.Ex3.m1.2.2.1.3.2" xref="S2.Ex3.m1.2.3.2.cmml">)</mo></mrow><mprescripts id="S2.Ex3.m1.2.3.2a" xref="S2.Ex3.m1.2.3.2.cmml"></mprescripts><none id="S2.Ex3.m1.2.3.2b" xref="S2.Ex3.m1.2.3.2.cmml"></none><mrow id="S2.Ex3.m1.1.1.1.3" xref="S2.Ex3.m1.2.3.2.cmml"><mo stretchy="false" id="S2.Ex3.m1.1.1.1.3.1" xref="S2.Ex3.m1.2.3.2.cmml">(</mo><mi id="S2.Ex3.m1.1.1.1.1" xref="S2.Ex3.m1.1.1.1.1.cmml">m</mi><mo stretchy="false" id="S2.Ex3.m1.1.1.1.3.2" xref="S2.Ex3.m1.2.3.2.cmml">)</mo></mrow></mmultiscripts><mo id="S2.Ex3.m1.2.3.1" xref="S2.Ex3.m1.2.3.1.cmml">:=</mo><mi id="S2.Ex3.m1.2.3.3" xref="S2.Ex3.m1.2.3.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex3.m1.2b"><apply id="S2.Ex3.m1.2.3.cmml" xref="S2.Ex3.m1.2.3"><csymbol cd="latexml" id="S2.Ex3.m1.2.3.1.cmml" xref="S2.Ex3.m1.2.3.1">assign</csymbol><apply id="S2.Ex3.m1.2.3.2.cmml" xref="S2.Ex3.m1.2.3.2"><csymbol cd="ambiguous" id="S2.Ex3.m1.2.3.2.1.cmml" xref="S2.Ex3.m1.2.3.2">superscript</csymbol><apply id="S2.Ex3.m1.2.3.2.2.cmml" xref="S2.Ex3.m1.2.3.2"><csymbol cd="ambiguous" id="S2.Ex3.m1.2.3.2.2.1.cmml" xref="S2.Ex3.m1.2.3.2">subscript</csymbol><apply id="S2.Ex3.m1.2.3.2.2.2.cmml" xref="S2.Ex3.m1.2.3.2"><csymbol cd="ambiguous" id="S2.Ex3.m1.2.3.2.2.2.1.cmml" xref="S2.Ex3.m1.2.3.2">superscript</csymbol><ci id="S2.Ex3.m1.2.3.2.2.2.2.cmml" xref="S2.Ex3.m1.2.3.2.2.2.2">𝒚</ci><ci id="S2.Ex3.m1.2.2.1.1.cmml" xref="S2.Ex3.m1.2.2.1.1">𝑙</ci></apply><ci id="S2.Ex3.m1.2.3.2.2.3.cmml" xref="S2.Ex3.m1.2.3.2.2.3">𝑠</ci></apply><ci id="S2.Ex3.m1.1.1.1.1.cmml" xref="S2.Ex3.m1.1.1.1.1">𝑚</ci></apply><csymbol cd="latexml" id="S2.Ex3.m1.2.3.3.cmml" xref="S2.Ex3.m1.2.3.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex3.m1.2c">\displaystyle\prescript{(m)}{}{\bm{y}}^{(l)}_{s}:=</annotation><annotation encoding="application/x-llamapun" id="S2.Ex3.m1.2d">start_FLOATSUPERSCRIPT ( italic_m ) end_FLOATSUPERSCRIPT bold_italic_y start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT :=</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.Ex3.m2.11" class="ltx_Math" alttext="\displaystyle\prescript{(m)}{}{\bm{y}}^{(l)}_{s}\left(\bm{\theta}^{(l)}_{q},%
\bm{\theta}^{(l)}_{k},\bm{\theta}^{(l)}_{v};\{\prescript{(m)}{}{\bm{y}}^{(l-1)%
}_{i}\}_{i=1}^{S_{m}}\right)" display="inline"><semantics id="S2.Ex3.m2.11a"><mrow id="S2.Ex3.m2.11.11" xref="S2.Ex3.m2.11.11.cmml"><mmultiscripts id="S2.Ex3.m2.11.11.6" xref="S2.Ex3.m2.11.11.6.cmml"><mi id="S2.Ex3.m2.11.11.6.2.2.2" xref="S2.Ex3.m2.11.11.6.2.2.2.cmml">𝒚</mi><mi id="S2.Ex3.m2.11.11.6.2.3" xref="S2.Ex3.m2.11.11.6.2.3.cmml">s</mi><mrow id="S2.Ex3.m2.2.2.1.3" xref="S2.Ex3.m2.11.11.6.cmml"><mo stretchy="false" id="S2.Ex3.m2.2.2.1.3.1" xref="S2.Ex3.m2.11.11.6.cmml">(</mo><mi id="S2.Ex3.m2.2.2.1.1" xref="S2.Ex3.m2.2.2.1.1.cmml">l</mi><mo stretchy="false" id="S2.Ex3.m2.2.2.1.3.2" xref="S2.Ex3.m2.11.11.6.cmml">)</mo></mrow><mprescripts id="S2.Ex3.m2.11.11.6a" xref="S2.Ex3.m2.11.11.6.cmml"></mprescripts><none id="S2.Ex3.m2.11.11.6b" xref="S2.Ex3.m2.11.11.6.cmml"></none><mrow id="S2.Ex3.m2.1.1.1.3" xref="S2.Ex3.m2.11.11.6.cmml"><mo stretchy="false" id="S2.Ex3.m2.1.1.1.3.1" xref="S2.Ex3.m2.11.11.6.cmml">(</mo><mi id="S2.Ex3.m2.1.1.1.1" xref="S2.Ex3.m2.1.1.1.1.cmml">m</mi><mo stretchy="false" id="S2.Ex3.m2.1.1.1.3.2" xref="S2.Ex3.m2.11.11.6.cmml">)</mo></mrow></mmultiscripts><mo id="S2.Ex3.m2.11.11.5" xref="S2.Ex3.m2.11.11.5.cmml">⁢</mo><mrow id="S2.Ex3.m2.11.11.4.4" xref="S2.Ex3.m2.11.11.4.5.cmml"><mo id="S2.Ex3.m2.11.11.4.4.5" xref="S2.Ex3.m2.11.11.4.5.cmml">(</mo><msubsup id="S2.Ex3.m2.8.8.1.1.1" xref="S2.Ex3.m2.8.8.1.1.1.cmml"><mi id="S2.Ex3.m2.8.8.1.1.1.2.2" xref="S2.Ex3.m2.8.8.1.1.1.2.2.cmml">𝜽</mi><mi id="S2.Ex3.m2.8.8.1.1.1.3" xref="S2.Ex3.m2.8.8.1.1.1.3.cmml">q</mi><mrow id="S2.Ex3.m2.3.3.1.3" xref="S2.Ex3.m2.8.8.1.1.1.cmml"><mo stretchy="false" id="S2.Ex3.m2.3.3.1.3.1" xref="S2.Ex3.m2.8.8.1.1.1.cmml">(</mo><mi id="S2.Ex3.m2.3.3.1.1" xref="S2.Ex3.m2.3.3.1.1.cmml">l</mi><mo stretchy="false" id="S2.Ex3.m2.3.3.1.3.2" xref="S2.Ex3.m2.8.8.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S2.Ex3.m2.11.11.4.4.6" xref="S2.Ex3.m2.11.11.4.5.cmml">,</mo><msubsup id="S2.Ex3.m2.9.9.2.2.2" xref="S2.Ex3.m2.9.9.2.2.2.cmml"><mi id="S2.Ex3.m2.9.9.2.2.2.2.2" xref="S2.Ex3.m2.9.9.2.2.2.2.2.cmml">𝜽</mi><mi id="S2.Ex3.m2.9.9.2.2.2.3" xref="S2.Ex3.m2.9.9.2.2.2.3.cmml">k</mi><mrow id="S2.Ex3.m2.4.4.1.3" xref="S2.Ex3.m2.9.9.2.2.2.cmml"><mo stretchy="false" id="S2.Ex3.m2.4.4.1.3.1" xref="S2.Ex3.m2.9.9.2.2.2.cmml">(</mo><mi id="S2.Ex3.m2.4.4.1.1" xref="S2.Ex3.m2.4.4.1.1.cmml">l</mi><mo stretchy="false" id="S2.Ex3.m2.4.4.1.3.2" xref="S2.Ex3.m2.9.9.2.2.2.cmml">)</mo></mrow></msubsup><mo id="S2.Ex3.m2.11.11.4.4.7" xref="S2.Ex3.m2.11.11.4.5.cmml">,</mo><msubsup id="S2.Ex3.m2.10.10.3.3.3" xref="S2.Ex3.m2.10.10.3.3.3.cmml"><mi id="S2.Ex3.m2.10.10.3.3.3.2.2" xref="S2.Ex3.m2.10.10.3.3.3.2.2.cmml">𝜽</mi><mi id="S2.Ex3.m2.10.10.3.3.3.3" xref="S2.Ex3.m2.10.10.3.3.3.3.cmml">v</mi><mrow id="S2.Ex3.m2.5.5.1.3" xref="S2.Ex3.m2.10.10.3.3.3.cmml"><mo stretchy="false" id="S2.Ex3.m2.5.5.1.3.1" xref="S2.Ex3.m2.10.10.3.3.3.cmml">(</mo><mi id="S2.Ex3.m2.5.5.1.1" xref="S2.Ex3.m2.5.5.1.1.cmml">l</mi><mo stretchy="false" id="S2.Ex3.m2.5.5.1.3.2" xref="S2.Ex3.m2.10.10.3.3.3.cmml">)</mo></mrow></msubsup><mo id="S2.Ex3.m2.11.11.4.4.8" xref="S2.Ex3.m2.11.11.4.5.cmml">;</mo><msubsup id="S2.Ex3.m2.11.11.4.4.4" xref="S2.Ex3.m2.11.11.4.4.4.cmml"><mrow id="S2.Ex3.m2.11.11.4.4.4.1.1.1" xref="S2.Ex3.m2.11.11.4.4.4.1.1.2.cmml"><mo stretchy="false" id="S2.Ex3.m2.11.11.4.4.4.1.1.1.2" xref="S2.Ex3.m2.11.11.4.4.4.1.1.2.cmml">{</mo><mmultiscripts id="S2.Ex3.m2.11.11.4.4.4.1.1.1.1" xref="S2.Ex3.m2.11.11.4.4.4.1.1.1.1.cmml"><mi id="S2.Ex3.m2.11.11.4.4.4.1.1.1.1.2.2.2" xref="S2.Ex3.m2.11.11.4.4.4.1.1.1.1.2.2.2.cmml">𝒚</mi><mi id="S2.Ex3.m2.11.11.4.4.4.1.1.1.1.2.3" xref="S2.Ex3.m2.11.11.4.4.4.1.1.1.1.2.3.cmml">i</mi><mrow id="S2.Ex3.m2.7.7.1.1" xref="S2.Ex3.m2.7.7.1.1.1.cmml"><mo stretchy="false" id="S2.Ex3.m2.7.7.1.1.2" xref="S2.Ex3.m2.7.7.1.1.1.cmml">(</mo><mrow id="S2.Ex3.m2.7.7.1.1.1" xref="S2.Ex3.m2.7.7.1.1.1.cmml"><mi id="S2.Ex3.m2.7.7.1.1.1.2" xref="S2.Ex3.m2.7.7.1.1.1.2.cmml">l</mi><mo id="S2.Ex3.m2.7.7.1.1.1.1" xref="S2.Ex3.m2.7.7.1.1.1.1.cmml">-</mo><mn id="S2.Ex3.m2.7.7.1.1.1.3" xref="S2.Ex3.m2.7.7.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S2.Ex3.m2.7.7.1.1.3" xref="S2.Ex3.m2.7.7.1.1.1.cmml">)</mo></mrow><mprescripts id="S2.Ex3.m2.11.11.4.4.4.1.1.1.1a" xref="S2.Ex3.m2.11.11.4.4.4.1.1.1.1.cmml"></mprescripts><none id="S2.Ex3.m2.11.11.4.4.4.1.1.1.1b" xref="S2.Ex3.m2.11.11.4.4.4.1.1.1.1.cmml"></none><mrow id="S2.Ex3.m2.6.6.1.3" xref="S2.Ex3.m2.11.11.4.4.4.1.1.1.1.cmml"><mo stretchy="false" id="S2.Ex3.m2.6.6.1.3.1" xref="S2.Ex3.m2.11.11.4.4.4.1.1.1.1.cmml">(</mo><mi id="S2.Ex3.m2.6.6.1.1" xref="S2.Ex3.m2.6.6.1.1.cmml">m</mi><mo stretchy="false" id="S2.Ex3.m2.6.6.1.3.2" xref="S2.Ex3.m2.11.11.4.4.4.1.1.1.1.cmml">)</mo></mrow></mmultiscripts><mo stretchy="false" id="S2.Ex3.m2.11.11.4.4.4.1.1.1.3" xref="S2.Ex3.m2.11.11.4.4.4.1.1.2.cmml">}</mo></mrow><mrow id="S2.Ex3.m2.11.11.4.4.4.1.3" xref="S2.Ex3.m2.11.11.4.4.4.1.3.cmml"><mi id="S2.Ex3.m2.11.11.4.4.4.1.3.2" xref="S2.Ex3.m2.11.11.4.4.4.1.3.2.cmml">i</mi><mo id="S2.Ex3.m2.11.11.4.4.4.1.3.1" xref="S2.Ex3.m2.11.11.4.4.4.1.3.1.cmml">=</mo><mn id="S2.Ex3.m2.11.11.4.4.4.1.3.3" xref="S2.Ex3.m2.11.11.4.4.4.1.3.3.cmml">1</mn></mrow><msub id="S2.Ex3.m2.11.11.4.4.4.3" xref="S2.Ex3.m2.11.11.4.4.4.3.cmml"><mi id="S2.Ex3.m2.11.11.4.4.4.3.2" xref="S2.Ex3.m2.11.11.4.4.4.3.2.cmml">S</mi><mi id="S2.Ex3.m2.11.11.4.4.4.3.3" xref="S2.Ex3.m2.11.11.4.4.4.3.3.cmml">m</mi></msub></msubsup><mo id="S2.Ex3.m2.11.11.4.4.9" xref="S2.Ex3.m2.11.11.4.5.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex3.m2.11b"><apply id="S2.Ex3.m2.11.11.cmml" xref="S2.Ex3.m2.11.11"><times id="S2.Ex3.m2.11.11.5.cmml" xref="S2.Ex3.m2.11.11.5"></times><apply id="S2.Ex3.m2.11.11.6.cmml" xref="S2.Ex3.m2.11.11.6"><csymbol cd="ambiguous" id="S2.Ex3.m2.11.11.6.1.cmml" xref="S2.Ex3.m2.11.11.6">superscript</csymbol><apply id="S2.Ex3.m2.11.11.6.2.cmml" xref="S2.Ex3.m2.11.11.6"><csymbol cd="ambiguous" id="S2.Ex3.m2.11.11.6.2.1.cmml" xref="S2.Ex3.m2.11.11.6">subscript</csymbol><apply id="S2.Ex3.m2.11.11.6.2.2.cmml" xref="S2.Ex3.m2.11.11.6"><csymbol cd="ambiguous" id="S2.Ex3.m2.11.11.6.2.2.1.cmml" xref="S2.Ex3.m2.11.11.6">superscript</csymbol><ci id="S2.Ex3.m2.11.11.6.2.2.2.cmml" xref="S2.Ex3.m2.11.11.6.2.2.2">𝒚</ci><ci id="S2.Ex3.m2.2.2.1.1.cmml" xref="S2.Ex3.m2.2.2.1.1">𝑙</ci></apply><ci id="S2.Ex3.m2.11.11.6.2.3.cmml" xref="S2.Ex3.m2.11.11.6.2.3">𝑠</ci></apply><ci id="S2.Ex3.m2.1.1.1.1.cmml" xref="S2.Ex3.m2.1.1.1.1">𝑚</ci></apply><vector id="S2.Ex3.m2.11.11.4.5.cmml" xref="S2.Ex3.m2.11.11.4.4"><apply id="S2.Ex3.m2.8.8.1.1.1.cmml" xref="S2.Ex3.m2.8.8.1.1.1"><csymbol cd="ambiguous" id="S2.Ex3.m2.8.8.1.1.1.1.cmml" xref="S2.Ex3.m2.8.8.1.1.1">subscript</csymbol><apply id="S2.Ex3.m2.8.8.1.1.1.2.cmml" xref="S2.Ex3.m2.8.8.1.1.1"><csymbol cd="ambiguous" id="S2.Ex3.m2.8.8.1.1.1.2.1.cmml" xref="S2.Ex3.m2.8.8.1.1.1">superscript</csymbol><ci id="S2.Ex3.m2.8.8.1.1.1.2.2.cmml" xref="S2.Ex3.m2.8.8.1.1.1.2.2">𝜽</ci><ci id="S2.Ex3.m2.3.3.1.1.cmml" xref="S2.Ex3.m2.3.3.1.1">𝑙</ci></apply><ci id="S2.Ex3.m2.8.8.1.1.1.3.cmml" xref="S2.Ex3.m2.8.8.1.1.1.3">𝑞</ci></apply><apply id="S2.Ex3.m2.9.9.2.2.2.cmml" xref="S2.Ex3.m2.9.9.2.2.2"><csymbol cd="ambiguous" id="S2.Ex3.m2.9.9.2.2.2.1.cmml" xref="S2.Ex3.m2.9.9.2.2.2">subscript</csymbol><apply id="S2.Ex3.m2.9.9.2.2.2.2.cmml" xref="S2.Ex3.m2.9.9.2.2.2"><csymbol cd="ambiguous" id="S2.Ex3.m2.9.9.2.2.2.2.1.cmml" xref="S2.Ex3.m2.9.9.2.2.2">superscript</csymbol><ci id="S2.Ex3.m2.9.9.2.2.2.2.2.cmml" xref="S2.Ex3.m2.9.9.2.2.2.2.2">𝜽</ci><ci id="S2.Ex3.m2.4.4.1.1.cmml" xref="S2.Ex3.m2.4.4.1.1">𝑙</ci></apply><ci id="S2.Ex3.m2.9.9.2.2.2.3.cmml" xref="S2.Ex3.m2.9.9.2.2.2.3">𝑘</ci></apply><apply id="S2.Ex3.m2.10.10.3.3.3.cmml" xref="S2.Ex3.m2.10.10.3.3.3"><csymbol cd="ambiguous" id="S2.Ex3.m2.10.10.3.3.3.1.cmml" xref="S2.Ex3.m2.10.10.3.3.3">subscript</csymbol><apply id="S2.Ex3.m2.10.10.3.3.3.2.cmml" xref="S2.Ex3.m2.10.10.3.3.3"><csymbol cd="ambiguous" id="S2.Ex3.m2.10.10.3.3.3.2.1.cmml" xref="S2.Ex3.m2.10.10.3.3.3">superscript</csymbol><ci id="S2.Ex3.m2.10.10.3.3.3.2.2.cmml" xref="S2.Ex3.m2.10.10.3.3.3.2.2">𝜽</ci><ci id="S2.Ex3.m2.5.5.1.1.cmml" xref="S2.Ex3.m2.5.5.1.1">𝑙</ci></apply><ci id="S2.Ex3.m2.10.10.3.3.3.3.cmml" xref="S2.Ex3.m2.10.10.3.3.3.3">𝑣</ci></apply><apply id="S2.Ex3.m2.11.11.4.4.4.cmml" xref="S2.Ex3.m2.11.11.4.4.4"><csymbol cd="ambiguous" id="S2.Ex3.m2.11.11.4.4.4.2.cmml" xref="S2.Ex3.m2.11.11.4.4.4">superscript</csymbol><apply id="S2.Ex3.m2.11.11.4.4.4.1.cmml" xref="S2.Ex3.m2.11.11.4.4.4"><csymbol cd="ambiguous" id="S2.Ex3.m2.11.11.4.4.4.1.2.cmml" xref="S2.Ex3.m2.11.11.4.4.4">subscript</csymbol><set id="S2.Ex3.m2.11.11.4.4.4.1.1.2.cmml" xref="S2.Ex3.m2.11.11.4.4.4.1.1.1"><apply id="S2.Ex3.m2.11.11.4.4.4.1.1.1.1.cmml" xref="S2.Ex3.m2.11.11.4.4.4.1.1.1.1"><csymbol cd="ambiguous" id="S2.Ex3.m2.11.11.4.4.4.1.1.1.1.1.cmml" xref="S2.Ex3.m2.11.11.4.4.4.1.1.1.1">superscript</csymbol><apply id="S2.Ex3.m2.11.11.4.4.4.1.1.1.1.2.cmml" xref="S2.Ex3.m2.11.11.4.4.4.1.1.1.1"><csymbol cd="ambiguous" id="S2.Ex3.m2.11.11.4.4.4.1.1.1.1.2.1.cmml" xref="S2.Ex3.m2.11.11.4.4.4.1.1.1.1">subscript</csymbol><apply id="S2.Ex3.m2.11.11.4.4.4.1.1.1.1.2.2.cmml" xref="S2.Ex3.m2.11.11.4.4.4.1.1.1.1"><csymbol cd="ambiguous" id="S2.Ex3.m2.11.11.4.4.4.1.1.1.1.2.2.1.cmml" xref="S2.Ex3.m2.11.11.4.4.4.1.1.1.1">superscript</csymbol><ci id="S2.Ex3.m2.11.11.4.4.4.1.1.1.1.2.2.2.cmml" xref="S2.Ex3.m2.11.11.4.4.4.1.1.1.1.2.2.2">𝒚</ci><apply id="S2.Ex3.m2.7.7.1.1.1.cmml" xref="S2.Ex3.m2.7.7.1.1"><minus id="S2.Ex3.m2.7.7.1.1.1.1.cmml" xref="S2.Ex3.m2.7.7.1.1.1.1"></minus><ci id="S2.Ex3.m2.7.7.1.1.1.2.cmml" xref="S2.Ex3.m2.7.7.1.1.1.2">𝑙</ci><cn type="integer" id="S2.Ex3.m2.7.7.1.1.1.3.cmml" xref="S2.Ex3.m2.7.7.1.1.1.3">1</cn></apply></apply><ci id="S2.Ex3.m2.11.11.4.4.4.1.1.1.1.2.3.cmml" xref="S2.Ex3.m2.11.11.4.4.4.1.1.1.1.2.3">𝑖</ci></apply><ci id="S2.Ex3.m2.6.6.1.1.cmml" xref="S2.Ex3.m2.6.6.1.1">𝑚</ci></apply></set><apply id="S2.Ex3.m2.11.11.4.4.4.1.3.cmml" xref="S2.Ex3.m2.11.11.4.4.4.1.3"><eq id="S2.Ex3.m2.11.11.4.4.4.1.3.1.cmml" xref="S2.Ex3.m2.11.11.4.4.4.1.3.1"></eq><ci id="S2.Ex3.m2.11.11.4.4.4.1.3.2.cmml" xref="S2.Ex3.m2.11.11.4.4.4.1.3.2">𝑖</ci><cn type="integer" id="S2.Ex3.m2.11.11.4.4.4.1.3.3.cmml" xref="S2.Ex3.m2.11.11.4.4.4.1.3.3">1</cn></apply></apply><apply id="S2.Ex3.m2.11.11.4.4.4.3.cmml" xref="S2.Ex3.m2.11.11.4.4.4.3"><csymbol cd="ambiguous" id="S2.Ex3.m2.11.11.4.4.4.3.1.cmml" xref="S2.Ex3.m2.11.11.4.4.4.3">subscript</csymbol><ci id="S2.Ex3.m2.11.11.4.4.4.3.2.cmml" xref="S2.Ex3.m2.11.11.4.4.4.3.2">𝑆</ci><ci id="S2.Ex3.m2.11.11.4.4.4.3.3.cmml" xref="S2.Ex3.m2.11.11.4.4.4.3.3">𝑚</ci></apply></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex3.m2.11c">\displaystyle\prescript{(m)}{}{\bm{y}}^{(l)}_{s}\left(\bm{\theta}^{(l)}_{q},%
\bm{\theta}^{(l)}_{k},\bm{\theta}^{(l)}_{v};\{\prescript{(m)}{}{\bm{y}}^{(l-1)%
}_{i}\}_{i=1}^{S_{m}}\right)</annotation><annotation encoding="application/x-llamapun" id="S2.Ex3.m2.11d">start_FLOATSUPERSCRIPT ( italic_m ) end_FLOATSUPERSCRIPT bold_italic_y start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ( bold_italic_θ start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT , bold_italic_θ start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT , bold_italic_θ start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT ; { start_FLOATSUPERSCRIPT ( italic_m ) end_FLOATSUPERSCRIPT bold_italic_y start_POSTSUPERSCRIPT ( italic_l - 1 ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_S start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT end_POSTSUPERSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S2.E18"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E18.m1.1" class="ltx_Math" alttext="\displaystyle=" display="inline"><semantics id="S2.E18.m1.1a"><mo id="S2.E18.m1.1.1" xref="S2.E18.m1.1.1.cmml">=</mo><annotation-xml encoding="MathML-Content" id="S2.E18.m1.1b"><eq id="S2.E18.m1.1.1.cmml" xref="S2.E18.m1.1.1"></eq></annotation-xml><annotation encoding="application/x-tex" id="S2.E18.m1.1c">\displaystyle=</annotation><annotation encoding="application/x-llamapun" id="S2.E18.m1.1d">=</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E18.m2.14" class="ltx_Math" alttext="\displaystyle\prescript{(m)}{}{\bm{y}}^{(l-1)}_{s}+\sum_{j=1}^{S_{m}}\tilde{%
\alpha}_{s,j}^{(l)}\left(\bm{\theta}^{(l)}_{q},\bm{\theta}^{(l)}_{k};\{%
\prescript{(m)}{}{\bm{y}}^{(l-1)}_{i}\}_{i=1}^{S_{m}}\right)\cdot\bm{o}_{j}^{(%
l)}\left(\bm{\theta}^{(l)}_{v};\prescript{(m)}{}{\bm{y}}^{(l-1)}_{j}\right)," display="inline"><semantics id="S2.E18.m2.14a"><mrow id="S2.E18.m2.14.14.1" xref="S2.E18.m2.14.14.1.1.cmml"><mrow id="S2.E18.m2.14.14.1.1" xref="S2.E18.m2.14.14.1.1.cmml"><mmultiscripts id="S2.E18.m2.14.14.1.1.7" xref="S2.E18.m2.14.14.1.1.7.cmml"><mi id="S2.E18.m2.14.14.1.1.7.2.2.2" xref="S2.E18.m2.14.14.1.1.7.2.2.2.cmml">𝒚</mi><mi id="S2.E18.m2.14.14.1.1.7.2.3" xref="S2.E18.m2.14.14.1.1.7.2.3.cmml">s</mi><mrow id="S2.E18.m2.2.2.1.1" xref="S2.E18.m2.2.2.1.1.1.cmml"><mo stretchy="false" id="S2.E18.m2.2.2.1.1.2" xref="S2.E18.m2.2.2.1.1.1.cmml">(</mo><mrow id="S2.E18.m2.2.2.1.1.1" xref="S2.E18.m2.2.2.1.1.1.cmml"><mi id="S2.E18.m2.2.2.1.1.1.2" xref="S2.E18.m2.2.2.1.1.1.2.cmml">l</mi><mo id="S2.E18.m2.2.2.1.1.1.1" xref="S2.E18.m2.2.2.1.1.1.1.cmml">-</mo><mn id="S2.E18.m2.2.2.1.1.1.3" xref="S2.E18.m2.2.2.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S2.E18.m2.2.2.1.1.3" xref="S2.E18.m2.2.2.1.1.1.cmml">)</mo></mrow><mprescripts id="S2.E18.m2.14.14.1.1.7a" xref="S2.E18.m2.14.14.1.1.7.cmml"></mprescripts><none id="S2.E18.m2.14.14.1.1.7b" xref="S2.E18.m2.14.14.1.1.7.cmml"></none><mrow id="S2.E18.m2.1.1.1.3" xref="S2.E18.m2.14.14.1.1.7.cmml"><mo stretchy="false" id="S2.E18.m2.1.1.1.3.1" xref="S2.E18.m2.14.14.1.1.7.cmml">(</mo><mi id="S2.E18.m2.1.1.1.1" xref="S2.E18.m2.1.1.1.1.cmml">m</mi><mo stretchy="false" id="S2.E18.m2.1.1.1.3.2" xref="S2.E18.m2.14.14.1.1.7.cmml">)</mo></mrow></mmultiscripts><mo id="S2.E18.m2.14.14.1.1.6" xref="S2.E18.m2.14.14.1.1.6.cmml">+</mo><mrow id="S2.E18.m2.14.14.1.1.5" xref="S2.E18.m2.14.14.1.1.5.cmml"><mstyle displaystyle="true" id="S2.E18.m2.14.14.1.1.5.6" xref="S2.E18.m2.14.14.1.1.5.6.cmml"><munderover id="S2.E18.m2.14.14.1.1.5.6a" xref="S2.E18.m2.14.14.1.1.5.6.cmml"><mo largeop="true" movablelimits="false" symmetric="true" id="S2.E18.m2.14.14.1.1.5.6.2.2" xref="S2.E18.m2.14.14.1.1.5.6.2.2.cmml">∑</mo><mrow id="S2.E18.m2.14.14.1.1.5.6.2.3" xref="S2.E18.m2.14.14.1.1.5.6.2.3.cmml"><mi id="S2.E18.m2.14.14.1.1.5.6.2.3.2" xref="S2.E18.m2.14.14.1.1.5.6.2.3.2.cmml">j</mi><mo id="S2.E18.m2.14.14.1.1.5.6.2.3.1" xref="S2.E18.m2.14.14.1.1.5.6.2.3.1.cmml">=</mo><mn id="S2.E18.m2.14.14.1.1.5.6.2.3.3" xref="S2.E18.m2.14.14.1.1.5.6.2.3.3.cmml">1</mn></mrow><msub id="S2.E18.m2.14.14.1.1.5.6.3" xref="S2.E18.m2.14.14.1.1.5.6.3.cmml"><mi id="S2.E18.m2.14.14.1.1.5.6.3.2" xref="S2.E18.m2.14.14.1.1.5.6.3.2.cmml">S</mi><mi id="S2.E18.m2.14.14.1.1.5.6.3.3" xref="S2.E18.m2.14.14.1.1.5.6.3.3.cmml">m</mi></msub></munderover></mstyle><mrow id="S2.E18.m2.14.14.1.1.5.5" xref="S2.E18.m2.14.14.1.1.5.5.cmml"><mrow id="S2.E18.m2.14.14.1.1.3.3.3" xref="S2.E18.m2.14.14.1.1.3.3.3.cmml"><mrow id="S2.E18.m2.14.14.1.1.3.3.3.3" xref="S2.E18.m2.14.14.1.1.3.3.3.3.cmml"><msubsup id="S2.E18.m2.14.14.1.1.3.3.3.3.5" xref="S2.E18.m2.14.14.1.1.3.3.3.3.5.cmml"><mover accent="true" id="S2.E18.m2.14.14.1.1.3.3.3.3.5.2.2" xref="S2.E18.m2.14.14.1.1.3.3.3.3.5.2.2.cmml"><mi id="S2.E18.m2.14.14.1.1.3.3.3.3.5.2.2.2" xref="S2.E18.m2.14.14.1.1.3.3.3.3.5.2.2.2.cmml">α</mi><mo stretchy="false" id="S2.E18.m2.14.14.1.1.3.3.3.3.5.2.2.1" xref="S2.E18.m2.14.14.1.1.3.3.3.3.5.2.2.1.cmml">~</mo></mover><mrow id="S2.E18.m2.4.4.2.4" xref="S2.E18.m2.4.4.2.3.cmml"><mi id="S2.E18.m2.3.3.1.1" xref="S2.E18.m2.3.3.1.1.cmml">s</mi><mo id="S2.E18.m2.4.4.2.4.1" xref="S2.E18.m2.4.4.2.3.cmml">,</mo><mi id="S2.E18.m2.4.4.2.2" xref="S2.E18.m2.4.4.2.2.cmml">j</mi></mrow><mrow id="S2.E18.m2.5.5.1.3" xref="S2.E18.m2.14.14.1.1.3.3.3.3.5.cmml"><mo stretchy="false" id="S2.E18.m2.5.5.1.3.1" xref="S2.E18.m2.14.14.1.1.3.3.3.3.5.cmml">(</mo><mi id="S2.E18.m2.5.5.1.1" xref="S2.E18.m2.5.5.1.1.cmml">l</mi><mo stretchy="false" id="S2.E18.m2.5.5.1.3.2" xref="S2.E18.m2.14.14.1.1.3.3.3.3.5.cmml">)</mo></mrow></msubsup><mo id="S2.E18.m2.14.14.1.1.3.3.3.3.4" xref="S2.E18.m2.14.14.1.1.3.3.3.3.4.cmml">⁢</mo><mrow id="S2.E18.m2.14.14.1.1.3.3.3.3.3.3" xref="S2.E18.m2.14.14.1.1.3.3.3.3.3.4.cmml"><mo id="S2.E18.m2.14.14.1.1.3.3.3.3.3.3.4" xref="S2.E18.m2.14.14.1.1.3.3.3.3.3.4.cmml">(</mo><msubsup id="S2.E18.m2.14.14.1.1.1.1.1.1.1.1.1" xref="S2.E18.m2.14.14.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E18.m2.14.14.1.1.1.1.1.1.1.1.1.2.2" xref="S2.E18.m2.14.14.1.1.1.1.1.1.1.1.1.2.2.cmml">𝜽</mi><mi id="S2.E18.m2.14.14.1.1.1.1.1.1.1.1.1.3" xref="S2.E18.m2.14.14.1.1.1.1.1.1.1.1.1.3.cmml">q</mi><mrow id="S2.E18.m2.6.6.1.3" xref="S2.E18.m2.14.14.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E18.m2.6.6.1.3.1" xref="S2.E18.m2.14.14.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S2.E18.m2.6.6.1.1" xref="S2.E18.m2.6.6.1.1.cmml">l</mi><mo stretchy="false" id="S2.E18.m2.6.6.1.3.2" xref="S2.E18.m2.14.14.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S2.E18.m2.14.14.1.1.3.3.3.3.3.3.5" xref="S2.E18.m2.14.14.1.1.3.3.3.3.3.4.cmml">,</mo><msubsup id="S2.E18.m2.14.14.1.1.2.2.2.2.2.2.2" xref="S2.E18.m2.14.14.1.1.2.2.2.2.2.2.2.cmml"><mi id="S2.E18.m2.14.14.1.1.2.2.2.2.2.2.2.2.2" xref="S2.E18.m2.14.14.1.1.2.2.2.2.2.2.2.2.2.cmml">𝜽</mi><mi id="S2.E18.m2.14.14.1.1.2.2.2.2.2.2.2.3" xref="S2.E18.m2.14.14.1.1.2.2.2.2.2.2.2.3.cmml">k</mi><mrow id="S2.E18.m2.7.7.1.3" xref="S2.E18.m2.14.14.1.1.2.2.2.2.2.2.2.cmml"><mo stretchy="false" id="S2.E18.m2.7.7.1.3.1" xref="S2.E18.m2.14.14.1.1.2.2.2.2.2.2.2.cmml">(</mo><mi id="S2.E18.m2.7.7.1.1" xref="S2.E18.m2.7.7.1.1.cmml">l</mi><mo stretchy="false" id="S2.E18.m2.7.7.1.3.2" xref="S2.E18.m2.14.14.1.1.2.2.2.2.2.2.2.cmml">)</mo></mrow></msubsup><mo id="S2.E18.m2.14.14.1.1.3.3.3.3.3.3.6" xref="S2.E18.m2.14.14.1.1.3.3.3.3.3.4.cmml">;</mo><msubsup id="S2.E18.m2.14.14.1.1.3.3.3.3.3.3.3" xref="S2.E18.m2.14.14.1.1.3.3.3.3.3.3.3.cmml"><mrow id="S2.E18.m2.14.14.1.1.3.3.3.3.3.3.3.1.1.1" xref="S2.E18.m2.14.14.1.1.3.3.3.3.3.3.3.1.1.2.cmml"><mo stretchy="false" id="S2.E18.m2.14.14.1.1.3.3.3.3.3.3.3.1.1.1.2" xref="S2.E18.m2.14.14.1.1.3.3.3.3.3.3.3.1.1.2.cmml">{</mo><mmultiscripts id="S2.E18.m2.14.14.1.1.3.3.3.3.3.3.3.1.1.1.1" xref="S2.E18.m2.14.14.1.1.3.3.3.3.3.3.3.1.1.1.1.cmml"><mi id="S2.E18.m2.14.14.1.1.3.3.3.3.3.3.3.1.1.1.1.2.2.2" xref="S2.E18.m2.14.14.1.1.3.3.3.3.3.3.3.1.1.1.1.2.2.2.cmml">𝒚</mi><mi id="S2.E18.m2.14.14.1.1.3.3.3.3.3.3.3.1.1.1.1.2.3" xref="S2.E18.m2.14.14.1.1.3.3.3.3.3.3.3.1.1.1.1.2.3.cmml">i</mi><mrow id="S2.E18.m2.9.9.1.1" xref="S2.E18.m2.9.9.1.1.1.cmml"><mo stretchy="false" id="S2.E18.m2.9.9.1.1.2" xref="S2.E18.m2.9.9.1.1.1.cmml">(</mo><mrow id="S2.E18.m2.9.9.1.1.1" xref="S2.E18.m2.9.9.1.1.1.cmml"><mi id="S2.E18.m2.9.9.1.1.1.2" xref="S2.E18.m2.9.9.1.1.1.2.cmml">l</mi><mo id="S2.E18.m2.9.9.1.1.1.1" xref="S2.E18.m2.9.9.1.1.1.1.cmml">-</mo><mn id="S2.E18.m2.9.9.1.1.1.3" xref="S2.E18.m2.9.9.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S2.E18.m2.9.9.1.1.3" xref="S2.E18.m2.9.9.1.1.1.cmml">)</mo></mrow><mprescripts id="S2.E18.m2.14.14.1.1.3.3.3.3.3.3.3.1.1.1.1a" xref="S2.E18.m2.14.14.1.1.3.3.3.3.3.3.3.1.1.1.1.cmml"></mprescripts><none id="S2.E18.m2.14.14.1.1.3.3.3.3.3.3.3.1.1.1.1b" xref="S2.E18.m2.14.14.1.1.3.3.3.3.3.3.3.1.1.1.1.cmml"></none><mrow id="S2.E18.m2.8.8.1.3" xref="S2.E18.m2.14.14.1.1.3.3.3.3.3.3.3.1.1.1.1.cmml"><mo stretchy="false" id="S2.E18.m2.8.8.1.3.1" xref="S2.E18.m2.14.14.1.1.3.3.3.3.3.3.3.1.1.1.1.cmml">(</mo><mi id="S2.E18.m2.8.8.1.1" xref="S2.E18.m2.8.8.1.1.cmml">m</mi><mo stretchy="false" id="S2.E18.m2.8.8.1.3.2" xref="S2.E18.m2.14.14.1.1.3.3.3.3.3.3.3.1.1.1.1.cmml">)</mo></mrow></mmultiscripts><mo stretchy="false" id="S2.E18.m2.14.14.1.1.3.3.3.3.3.3.3.1.1.1.3" xref="S2.E18.m2.14.14.1.1.3.3.3.3.3.3.3.1.1.2.cmml">}</mo></mrow><mrow id="S2.E18.m2.14.14.1.1.3.3.3.3.3.3.3.1.3" xref="S2.E18.m2.14.14.1.1.3.3.3.3.3.3.3.1.3.cmml"><mi id="S2.E18.m2.14.14.1.1.3.3.3.3.3.3.3.1.3.2" xref="S2.E18.m2.14.14.1.1.3.3.3.3.3.3.3.1.3.2.cmml">i</mi><mo id="S2.E18.m2.14.14.1.1.3.3.3.3.3.3.3.1.3.1" xref="S2.E18.m2.14.14.1.1.3.3.3.3.3.3.3.1.3.1.cmml">=</mo><mn id="S2.E18.m2.14.14.1.1.3.3.3.3.3.3.3.1.3.3" xref="S2.E18.m2.14.14.1.1.3.3.3.3.3.3.3.1.3.3.cmml">1</mn></mrow><msub id="S2.E18.m2.14.14.1.1.3.3.3.3.3.3.3.3" xref="S2.E18.m2.14.14.1.1.3.3.3.3.3.3.3.3.cmml"><mi id="S2.E18.m2.14.14.1.1.3.3.3.3.3.3.3.3.2" xref="S2.E18.m2.14.14.1.1.3.3.3.3.3.3.3.3.2.cmml">S</mi><mi id="S2.E18.m2.14.14.1.1.3.3.3.3.3.3.3.3.3" xref="S2.E18.m2.14.14.1.1.3.3.3.3.3.3.3.3.3.cmml">m</mi></msub></msubsup><mo id="S2.E18.m2.14.14.1.1.3.3.3.3.3.3.7" xref="S2.E18.m2.14.14.1.1.3.3.3.3.3.4.cmml">)</mo></mrow></mrow><mo id="S2.E18.m2.14.14.1.1.3.3.3.4" xref="S2.E18.m2.14.14.1.1.3.3.3.4.cmml">⋅</mo><msubsup id="S2.E18.m2.14.14.1.1.3.3.3.5" xref="S2.E18.m2.14.14.1.1.3.3.3.5.cmml"><mi id="S2.E18.m2.14.14.1.1.3.3.3.5.2.2" xref="S2.E18.m2.14.14.1.1.3.3.3.5.2.2.cmml">𝒐</mi><mi id="S2.E18.m2.14.14.1.1.3.3.3.5.2.3" xref="S2.E18.m2.14.14.1.1.3.3.3.5.2.3.cmml">j</mi><mrow id="S2.E18.m2.10.10.1.3" xref="S2.E18.m2.14.14.1.1.3.3.3.5.cmml"><mo stretchy="false" id="S2.E18.m2.10.10.1.3.1" xref="S2.E18.m2.14.14.1.1.3.3.3.5.cmml">(</mo><mi id="S2.E18.m2.10.10.1.1" xref="S2.E18.m2.10.10.1.1.cmml">l</mi><mo stretchy="false" id="S2.E18.m2.10.10.1.3.2" xref="S2.E18.m2.14.14.1.1.3.3.3.5.cmml">)</mo></mrow></msubsup></mrow><mo id="S2.E18.m2.14.14.1.1.5.5.6" xref="S2.E18.m2.14.14.1.1.5.5.6.cmml">⁢</mo><mrow id="S2.E18.m2.14.14.1.1.5.5.5.2" xref="S2.E18.m2.14.14.1.1.5.5.5.3.cmml"><mo id="S2.E18.m2.14.14.1.1.5.5.5.2.3" xref="S2.E18.m2.14.14.1.1.5.5.5.3.cmml">(</mo><msubsup id="S2.E18.m2.14.14.1.1.4.4.4.1.1" xref="S2.E18.m2.14.14.1.1.4.4.4.1.1.cmml"><mi id="S2.E18.m2.14.14.1.1.4.4.4.1.1.2.2" xref="S2.E18.m2.14.14.1.1.4.4.4.1.1.2.2.cmml">𝜽</mi><mi id="S2.E18.m2.14.14.1.1.4.4.4.1.1.3" xref="S2.E18.m2.14.14.1.1.4.4.4.1.1.3.cmml">v</mi><mrow id="S2.E18.m2.11.11.1.3" xref="S2.E18.m2.14.14.1.1.4.4.4.1.1.cmml"><mo stretchy="false" id="S2.E18.m2.11.11.1.3.1" xref="S2.E18.m2.14.14.1.1.4.4.4.1.1.cmml">(</mo><mi id="S2.E18.m2.11.11.1.1" xref="S2.E18.m2.11.11.1.1.cmml">l</mi><mo stretchy="false" id="S2.E18.m2.11.11.1.3.2" xref="S2.E18.m2.14.14.1.1.4.4.4.1.1.cmml">)</mo></mrow></msubsup><mo id="S2.E18.m2.14.14.1.1.5.5.5.2.4" xref="S2.E18.m2.14.14.1.1.5.5.5.3.cmml">;</mo><mmultiscripts id="S2.E18.m2.14.14.1.1.5.5.5.2.2" xref="S2.E18.m2.14.14.1.1.5.5.5.2.2.cmml"><mi id="S2.E18.m2.14.14.1.1.5.5.5.2.2.2.2.2" xref="S2.E18.m2.14.14.1.1.5.5.5.2.2.2.2.2.cmml">𝒚</mi><mi id="S2.E18.m2.14.14.1.1.5.5.5.2.2.2.3" xref="S2.E18.m2.14.14.1.1.5.5.5.2.2.2.3.cmml">j</mi><mrow id="S2.E18.m2.13.13.1.1" xref="S2.E18.m2.13.13.1.1.1.cmml"><mo stretchy="false" id="S2.E18.m2.13.13.1.1.2" xref="S2.E18.m2.13.13.1.1.1.cmml">(</mo><mrow id="S2.E18.m2.13.13.1.1.1" xref="S2.E18.m2.13.13.1.1.1.cmml"><mi id="S2.E18.m2.13.13.1.1.1.2" xref="S2.E18.m2.13.13.1.1.1.2.cmml">l</mi><mo id="S2.E18.m2.13.13.1.1.1.1" xref="S2.E18.m2.13.13.1.1.1.1.cmml">-</mo><mn id="S2.E18.m2.13.13.1.1.1.3" xref="S2.E18.m2.13.13.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S2.E18.m2.13.13.1.1.3" xref="S2.E18.m2.13.13.1.1.1.cmml">)</mo></mrow><mprescripts id="S2.E18.m2.14.14.1.1.5.5.5.2.2a" xref="S2.E18.m2.14.14.1.1.5.5.5.2.2.cmml"></mprescripts><none id="S2.E18.m2.14.14.1.1.5.5.5.2.2b" xref="S2.E18.m2.14.14.1.1.5.5.5.2.2.cmml"></none><mrow id="S2.E18.m2.12.12.1.3" xref="S2.E18.m2.14.14.1.1.5.5.5.2.2.cmml"><mo stretchy="false" id="S2.E18.m2.12.12.1.3.1" xref="S2.E18.m2.14.14.1.1.5.5.5.2.2.cmml">(</mo><mi id="S2.E18.m2.12.12.1.1" xref="S2.E18.m2.12.12.1.1.cmml">m</mi><mo stretchy="false" id="S2.E18.m2.12.12.1.3.2" xref="S2.E18.m2.14.14.1.1.5.5.5.2.2.cmml">)</mo></mrow></mmultiscripts><mo id="S2.E18.m2.14.14.1.1.5.5.5.2.5" xref="S2.E18.m2.14.14.1.1.5.5.5.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S2.E18.m2.14.14.1.2" xref="S2.E18.m2.14.14.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E18.m2.14b"><apply id="S2.E18.m2.14.14.1.1.cmml" xref="S2.E18.m2.14.14.1"><plus id="S2.E18.m2.14.14.1.1.6.cmml" xref="S2.E18.m2.14.14.1.1.6"></plus><apply id="S2.E18.m2.14.14.1.1.7.cmml" xref="S2.E18.m2.14.14.1.1.7"><csymbol cd="ambiguous" id="S2.E18.m2.14.14.1.1.7.1.cmml" xref="S2.E18.m2.14.14.1.1.7">superscript</csymbol><apply id="S2.E18.m2.14.14.1.1.7.2.cmml" xref="S2.E18.m2.14.14.1.1.7"><csymbol cd="ambiguous" id="S2.E18.m2.14.14.1.1.7.2.1.cmml" xref="S2.E18.m2.14.14.1.1.7">subscript</csymbol><apply id="S2.E18.m2.14.14.1.1.7.2.2.cmml" xref="S2.E18.m2.14.14.1.1.7"><csymbol cd="ambiguous" id="S2.E18.m2.14.14.1.1.7.2.2.1.cmml" xref="S2.E18.m2.14.14.1.1.7">superscript</csymbol><ci id="S2.E18.m2.14.14.1.1.7.2.2.2.cmml" xref="S2.E18.m2.14.14.1.1.7.2.2.2">𝒚</ci><apply id="S2.E18.m2.2.2.1.1.1.cmml" xref="S2.E18.m2.2.2.1.1"><minus id="S2.E18.m2.2.2.1.1.1.1.cmml" xref="S2.E18.m2.2.2.1.1.1.1"></minus><ci id="S2.E18.m2.2.2.1.1.1.2.cmml" xref="S2.E18.m2.2.2.1.1.1.2">𝑙</ci><cn type="integer" id="S2.E18.m2.2.2.1.1.1.3.cmml" xref="S2.E18.m2.2.2.1.1.1.3">1</cn></apply></apply><ci id="S2.E18.m2.14.14.1.1.7.2.3.cmml" xref="S2.E18.m2.14.14.1.1.7.2.3">𝑠</ci></apply><ci id="S2.E18.m2.1.1.1.1.cmml" xref="S2.E18.m2.1.1.1.1">𝑚</ci></apply><apply id="S2.E18.m2.14.14.1.1.5.cmml" xref="S2.E18.m2.14.14.1.1.5"><apply id="S2.E18.m2.14.14.1.1.5.6.cmml" xref="S2.E18.m2.14.14.1.1.5.6"><csymbol cd="ambiguous" id="S2.E18.m2.14.14.1.1.5.6.1.cmml" xref="S2.E18.m2.14.14.1.1.5.6">superscript</csymbol><apply id="S2.E18.m2.14.14.1.1.5.6.2.cmml" xref="S2.E18.m2.14.14.1.1.5.6"><csymbol cd="ambiguous" id="S2.E18.m2.14.14.1.1.5.6.2.1.cmml" xref="S2.E18.m2.14.14.1.1.5.6">subscript</csymbol><sum id="S2.E18.m2.14.14.1.1.5.6.2.2.cmml" xref="S2.E18.m2.14.14.1.1.5.6.2.2"></sum><apply id="S2.E18.m2.14.14.1.1.5.6.2.3.cmml" xref="S2.E18.m2.14.14.1.1.5.6.2.3"><eq id="S2.E18.m2.14.14.1.1.5.6.2.3.1.cmml" xref="S2.E18.m2.14.14.1.1.5.6.2.3.1"></eq><ci id="S2.E18.m2.14.14.1.1.5.6.2.3.2.cmml" xref="S2.E18.m2.14.14.1.1.5.6.2.3.2">𝑗</ci><cn type="integer" id="S2.E18.m2.14.14.1.1.5.6.2.3.3.cmml" xref="S2.E18.m2.14.14.1.1.5.6.2.3.3">1</cn></apply></apply><apply id="S2.E18.m2.14.14.1.1.5.6.3.cmml" xref="S2.E18.m2.14.14.1.1.5.6.3"><csymbol cd="ambiguous" id="S2.E18.m2.14.14.1.1.5.6.3.1.cmml" xref="S2.E18.m2.14.14.1.1.5.6.3">subscript</csymbol><ci id="S2.E18.m2.14.14.1.1.5.6.3.2.cmml" xref="S2.E18.m2.14.14.1.1.5.6.3.2">𝑆</ci><ci id="S2.E18.m2.14.14.1.1.5.6.3.3.cmml" xref="S2.E18.m2.14.14.1.1.5.6.3.3">𝑚</ci></apply></apply><apply id="S2.E18.m2.14.14.1.1.5.5.cmml" xref="S2.E18.m2.14.14.1.1.5.5"><times id="S2.E18.m2.14.14.1.1.5.5.6.cmml" xref="S2.E18.m2.14.14.1.1.5.5.6"></times><apply id="S2.E18.m2.14.14.1.1.3.3.3.cmml" xref="S2.E18.m2.14.14.1.1.3.3.3"><ci id="S2.E18.m2.14.14.1.1.3.3.3.4.cmml" xref="S2.E18.m2.14.14.1.1.3.3.3.4">⋅</ci><apply id="S2.E18.m2.14.14.1.1.3.3.3.3.cmml" xref="S2.E18.m2.14.14.1.1.3.3.3.3"><times id="S2.E18.m2.14.14.1.1.3.3.3.3.4.cmml" xref="S2.E18.m2.14.14.1.1.3.3.3.3.4"></times><apply id="S2.E18.m2.14.14.1.1.3.3.3.3.5.cmml" xref="S2.E18.m2.14.14.1.1.3.3.3.3.5"><csymbol cd="ambiguous" id="S2.E18.m2.14.14.1.1.3.3.3.3.5.1.cmml" xref="S2.E18.m2.14.14.1.1.3.3.3.3.5">superscript</csymbol><apply id="S2.E18.m2.14.14.1.1.3.3.3.3.5.2.cmml" xref="S2.E18.m2.14.14.1.1.3.3.3.3.5"><csymbol cd="ambiguous" id="S2.E18.m2.14.14.1.1.3.3.3.3.5.2.1.cmml" xref="S2.E18.m2.14.14.1.1.3.3.3.3.5">subscript</csymbol><apply id="S2.E18.m2.14.14.1.1.3.3.3.3.5.2.2.cmml" xref="S2.E18.m2.14.14.1.1.3.3.3.3.5.2.2"><ci id="S2.E18.m2.14.14.1.1.3.3.3.3.5.2.2.1.cmml" xref="S2.E18.m2.14.14.1.1.3.3.3.3.5.2.2.1">~</ci><ci id="S2.E18.m2.14.14.1.1.3.3.3.3.5.2.2.2.cmml" xref="S2.E18.m2.14.14.1.1.3.3.3.3.5.2.2.2">𝛼</ci></apply><list id="S2.E18.m2.4.4.2.3.cmml" xref="S2.E18.m2.4.4.2.4"><ci id="S2.E18.m2.3.3.1.1.cmml" xref="S2.E18.m2.3.3.1.1">𝑠</ci><ci id="S2.E18.m2.4.4.2.2.cmml" xref="S2.E18.m2.4.4.2.2">𝑗</ci></list></apply><ci id="S2.E18.m2.5.5.1.1.cmml" xref="S2.E18.m2.5.5.1.1">𝑙</ci></apply><vector id="S2.E18.m2.14.14.1.1.3.3.3.3.3.4.cmml" xref="S2.E18.m2.14.14.1.1.3.3.3.3.3.3"><apply id="S2.E18.m2.14.14.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E18.m2.14.14.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E18.m2.14.14.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E18.m2.14.14.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S2.E18.m2.14.14.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E18.m2.14.14.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E18.m2.14.14.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E18.m2.14.14.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S2.E18.m2.14.14.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E18.m2.14.14.1.1.1.1.1.1.1.1.1.2.2">𝜽</ci><ci id="S2.E18.m2.6.6.1.1.cmml" xref="S2.E18.m2.6.6.1.1">𝑙</ci></apply><ci id="S2.E18.m2.14.14.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E18.m2.14.14.1.1.1.1.1.1.1.1.1.3">𝑞</ci></apply><apply id="S2.E18.m2.14.14.1.1.2.2.2.2.2.2.2.cmml" xref="S2.E18.m2.14.14.1.1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E18.m2.14.14.1.1.2.2.2.2.2.2.2.1.cmml" xref="S2.E18.m2.14.14.1.1.2.2.2.2.2.2.2">subscript</csymbol><apply id="S2.E18.m2.14.14.1.1.2.2.2.2.2.2.2.2.cmml" xref="S2.E18.m2.14.14.1.1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E18.m2.14.14.1.1.2.2.2.2.2.2.2.2.1.cmml" xref="S2.E18.m2.14.14.1.1.2.2.2.2.2.2.2">superscript</csymbol><ci id="S2.E18.m2.14.14.1.1.2.2.2.2.2.2.2.2.2.cmml" xref="S2.E18.m2.14.14.1.1.2.2.2.2.2.2.2.2.2">𝜽</ci><ci id="S2.E18.m2.7.7.1.1.cmml" xref="S2.E18.m2.7.7.1.1">𝑙</ci></apply><ci id="S2.E18.m2.14.14.1.1.2.2.2.2.2.2.2.3.cmml" xref="S2.E18.m2.14.14.1.1.2.2.2.2.2.2.2.3">𝑘</ci></apply><apply id="S2.E18.m2.14.14.1.1.3.3.3.3.3.3.3.cmml" xref="S2.E18.m2.14.14.1.1.3.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S2.E18.m2.14.14.1.1.3.3.3.3.3.3.3.2.cmml" xref="S2.E18.m2.14.14.1.1.3.3.3.3.3.3.3">superscript</csymbol><apply id="S2.E18.m2.14.14.1.1.3.3.3.3.3.3.3.1.cmml" xref="S2.E18.m2.14.14.1.1.3.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S2.E18.m2.14.14.1.1.3.3.3.3.3.3.3.1.2.cmml" xref="S2.E18.m2.14.14.1.1.3.3.3.3.3.3.3">subscript</csymbol><set id="S2.E18.m2.14.14.1.1.3.3.3.3.3.3.3.1.1.2.cmml" xref="S2.E18.m2.14.14.1.1.3.3.3.3.3.3.3.1.1.1"><apply id="S2.E18.m2.14.14.1.1.3.3.3.3.3.3.3.1.1.1.1.cmml" xref="S2.E18.m2.14.14.1.1.3.3.3.3.3.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S2.E18.m2.14.14.1.1.3.3.3.3.3.3.3.1.1.1.1.1.cmml" xref="S2.E18.m2.14.14.1.1.3.3.3.3.3.3.3.1.1.1.1">superscript</csymbol><apply id="S2.E18.m2.14.14.1.1.3.3.3.3.3.3.3.1.1.1.1.2.cmml" xref="S2.E18.m2.14.14.1.1.3.3.3.3.3.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S2.E18.m2.14.14.1.1.3.3.3.3.3.3.3.1.1.1.1.2.1.cmml" xref="S2.E18.m2.14.14.1.1.3.3.3.3.3.3.3.1.1.1.1">subscript</csymbol><apply id="S2.E18.m2.14.14.1.1.3.3.3.3.3.3.3.1.1.1.1.2.2.cmml" xref="S2.E18.m2.14.14.1.1.3.3.3.3.3.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S2.E18.m2.14.14.1.1.3.3.3.3.3.3.3.1.1.1.1.2.2.1.cmml" xref="S2.E18.m2.14.14.1.1.3.3.3.3.3.3.3.1.1.1.1">superscript</csymbol><ci id="S2.E18.m2.14.14.1.1.3.3.3.3.3.3.3.1.1.1.1.2.2.2.cmml" xref="S2.E18.m2.14.14.1.1.3.3.3.3.3.3.3.1.1.1.1.2.2.2">𝒚</ci><apply id="S2.E18.m2.9.9.1.1.1.cmml" xref="S2.E18.m2.9.9.1.1"><minus id="S2.E18.m2.9.9.1.1.1.1.cmml" xref="S2.E18.m2.9.9.1.1.1.1"></minus><ci id="S2.E18.m2.9.9.1.1.1.2.cmml" xref="S2.E18.m2.9.9.1.1.1.2">𝑙</ci><cn type="integer" id="S2.E18.m2.9.9.1.1.1.3.cmml" xref="S2.E18.m2.9.9.1.1.1.3">1</cn></apply></apply><ci id="S2.E18.m2.14.14.1.1.3.3.3.3.3.3.3.1.1.1.1.2.3.cmml" xref="S2.E18.m2.14.14.1.1.3.3.3.3.3.3.3.1.1.1.1.2.3">𝑖</ci></apply><ci id="S2.E18.m2.8.8.1.1.cmml" xref="S2.E18.m2.8.8.1.1">𝑚</ci></apply></set><apply id="S2.E18.m2.14.14.1.1.3.3.3.3.3.3.3.1.3.cmml" xref="S2.E18.m2.14.14.1.1.3.3.3.3.3.3.3.1.3"><eq id="S2.E18.m2.14.14.1.1.3.3.3.3.3.3.3.1.3.1.cmml" xref="S2.E18.m2.14.14.1.1.3.3.3.3.3.3.3.1.3.1"></eq><ci id="S2.E18.m2.14.14.1.1.3.3.3.3.3.3.3.1.3.2.cmml" xref="S2.E18.m2.14.14.1.1.3.3.3.3.3.3.3.1.3.2">𝑖</ci><cn type="integer" id="S2.E18.m2.14.14.1.1.3.3.3.3.3.3.3.1.3.3.cmml" xref="S2.E18.m2.14.14.1.1.3.3.3.3.3.3.3.1.3.3">1</cn></apply></apply><apply id="S2.E18.m2.14.14.1.1.3.3.3.3.3.3.3.3.cmml" xref="S2.E18.m2.14.14.1.1.3.3.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S2.E18.m2.14.14.1.1.3.3.3.3.3.3.3.3.1.cmml" xref="S2.E18.m2.14.14.1.1.3.3.3.3.3.3.3.3">subscript</csymbol><ci id="S2.E18.m2.14.14.1.1.3.3.3.3.3.3.3.3.2.cmml" xref="S2.E18.m2.14.14.1.1.3.3.3.3.3.3.3.3.2">𝑆</ci><ci id="S2.E18.m2.14.14.1.1.3.3.3.3.3.3.3.3.3.cmml" xref="S2.E18.m2.14.14.1.1.3.3.3.3.3.3.3.3.3">𝑚</ci></apply></apply></vector></apply><apply id="S2.E18.m2.14.14.1.1.3.3.3.5.cmml" xref="S2.E18.m2.14.14.1.1.3.3.3.5"><csymbol cd="ambiguous" id="S2.E18.m2.14.14.1.1.3.3.3.5.1.cmml" xref="S2.E18.m2.14.14.1.1.3.3.3.5">superscript</csymbol><apply id="S2.E18.m2.14.14.1.1.3.3.3.5.2.cmml" xref="S2.E18.m2.14.14.1.1.3.3.3.5"><csymbol cd="ambiguous" id="S2.E18.m2.14.14.1.1.3.3.3.5.2.1.cmml" xref="S2.E18.m2.14.14.1.1.3.3.3.5">subscript</csymbol><ci id="S2.E18.m2.14.14.1.1.3.3.3.5.2.2.cmml" xref="S2.E18.m2.14.14.1.1.3.3.3.5.2.2">𝒐</ci><ci id="S2.E18.m2.14.14.1.1.3.3.3.5.2.3.cmml" xref="S2.E18.m2.14.14.1.1.3.3.3.5.2.3">𝑗</ci></apply><ci id="S2.E18.m2.10.10.1.1.cmml" xref="S2.E18.m2.10.10.1.1">𝑙</ci></apply></apply><list id="S2.E18.m2.14.14.1.1.5.5.5.3.cmml" xref="S2.E18.m2.14.14.1.1.5.5.5.2"><apply id="S2.E18.m2.14.14.1.1.4.4.4.1.1.cmml" xref="S2.E18.m2.14.14.1.1.4.4.4.1.1"><csymbol cd="ambiguous" id="S2.E18.m2.14.14.1.1.4.4.4.1.1.1.cmml" xref="S2.E18.m2.14.14.1.1.4.4.4.1.1">subscript</csymbol><apply id="S2.E18.m2.14.14.1.1.4.4.4.1.1.2.cmml" xref="S2.E18.m2.14.14.1.1.4.4.4.1.1"><csymbol cd="ambiguous" id="S2.E18.m2.14.14.1.1.4.4.4.1.1.2.1.cmml" xref="S2.E18.m2.14.14.1.1.4.4.4.1.1">superscript</csymbol><ci id="S2.E18.m2.14.14.1.1.4.4.4.1.1.2.2.cmml" xref="S2.E18.m2.14.14.1.1.4.4.4.1.1.2.2">𝜽</ci><ci id="S2.E18.m2.11.11.1.1.cmml" xref="S2.E18.m2.11.11.1.1">𝑙</ci></apply><ci id="S2.E18.m2.14.14.1.1.4.4.4.1.1.3.cmml" xref="S2.E18.m2.14.14.1.1.4.4.4.1.1.3">𝑣</ci></apply><apply id="S2.E18.m2.14.14.1.1.5.5.5.2.2.cmml" xref="S2.E18.m2.14.14.1.1.5.5.5.2.2"><csymbol cd="ambiguous" id="S2.E18.m2.14.14.1.1.5.5.5.2.2.1.cmml" xref="S2.E18.m2.14.14.1.1.5.5.5.2.2">superscript</csymbol><apply id="S2.E18.m2.14.14.1.1.5.5.5.2.2.2.cmml" xref="S2.E18.m2.14.14.1.1.5.5.5.2.2"><csymbol cd="ambiguous" id="S2.E18.m2.14.14.1.1.5.5.5.2.2.2.1.cmml" xref="S2.E18.m2.14.14.1.1.5.5.5.2.2">subscript</csymbol><apply id="S2.E18.m2.14.14.1.1.5.5.5.2.2.2.2.cmml" xref="S2.E18.m2.14.14.1.1.5.5.5.2.2"><csymbol cd="ambiguous" id="S2.E18.m2.14.14.1.1.5.5.5.2.2.2.2.1.cmml" xref="S2.E18.m2.14.14.1.1.5.5.5.2.2">superscript</csymbol><ci id="S2.E18.m2.14.14.1.1.5.5.5.2.2.2.2.2.cmml" xref="S2.E18.m2.14.14.1.1.5.5.5.2.2.2.2.2">𝒚</ci><apply id="S2.E18.m2.13.13.1.1.1.cmml" xref="S2.E18.m2.13.13.1.1"><minus id="S2.E18.m2.13.13.1.1.1.1.cmml" xref="S2.E18.m2.13.13.1.1.1.1"></minus><ci id="S2.E18.m2.13.13.1.1.1.2.cmml" xref="S2.E18.m2.13.13.1.1.1.2">𝑙</ci><cn type="integer" id="S2.E18.m2.13.13.1.1.1.3.cmml" xref="S2.E18.m2.13.13.1.1.1.3">1</cn></apply></apply><ci id="S2.E18.m2.14.14.1.1.5.5.5.2.2.2.3.cmml" xref="S2.E18.m2.14.14.1.1.5.5.5.2.2.2.3">𝑗</ci></apply><ci id="S2.E18.m2.12.12.1.1.cmml" xref="S2.E18.m2.12.12.1.1">𝑚</ci></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E18.m2.14c">\displaystyle\prescript{(m)}{}{\bm{y}}^{(l-1)}_{s}+\sum_{j=1}^{S_{m}}\tilde{%
\alpha}_{s,j}^{(l)}\left(\bm{\theta}^{(l)}_{q},\bm{\theta}^{(l)}_{k};\{%
\prescript{(m)}{}{\bm{y}}^{(l-1)}_{i}\}_{i=1}^{S_{m}}\right)\cdot\bm{o}_{j}^{(%
l)}\left(\bm{\theta}^{(l)}_{v};\prescript{(m)}{}{\bm{y}}^{(l-1)}_{j}\right),</annotation><annotation encoding="application/x-llamapun" id="S2.E18.m2.14d">start_FLOATSUPERSCRIPT ( italic_m ) end_FLOATSUPERSCRIPT bold_italic_y start_POSTSUPERSCRIPT ( italic_l - 1 ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT + ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_S start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT end_POSTSUPERSCRIPT over~ start_ARG italic_α end_ARG start_POSTSUBSCRIPT italic_s , italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT ( bold_italic_θ start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT , bold_italic_θ start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ; { start_FLOATSUPERSCRIPT ( italic_m ) end_FLOATSUPERSCRIPT bold_italic_y start_POSTSUPERSCRIPT ( italic_l - 1 ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_S start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT end_POSTSUPERSCRIPT ) ⋅ bold_italic_o start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT ( bold_italic_θ start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT ; start_FLOATSUPERSCRIPT ( italic_m ) end_FLOATSUPERSCRIPT bold_italic_y start_POSTSUPERSCRIPT ( italic_l - 1 ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(18)</span></td>
</tr></tbody>
</table>
<p id="S2.SS3.p3.3" class="ltx_p">where <math id="S2.SS3.p3.1.m1.3" class="ltx_Math" alttext="\prescript{(m)}{}{\bm{y}}^{(0)}_{s}=\prescript{(m)}{}{\bm{x}}_{s}" display="inline"><semantics id="S2.SS3.p3.1.m1.3a"><mrow id="S2.SS3.p3.1.m1.3.4" xref="S2.SS3.p3.1.m1.3.4.cmml"><mmultiscripts id="S2.SS3.p3.1.m1.3.4.2" xref="S2.SS3.p3.1.m1.3.4.2.cmml"><mi id="S2.SS3.p3.1.m1.3.4.2.2.2.2" xref="S2.SS3.p3.1.m1.3.4.2.2.2.2.cmml">𝒚</mi><mi id="S2.SS3.p3.1.m1.3.4.2.2.3" xref="S2.SS3.p3.1.m1.3.4.2.2.3.cmml">s</mi><mrow id="S2.SS3.p3.1.m1.2.2.1.3" xref="S2.SS3.p3.1.m1.3.4.2.cmml"><mo stretchy="false" id="S2.SS3.p3.1.m1.2.2.1.3.1" xref="S2.SS3.p3.1.m1.3.4.2.cmml">(</mo><mn id="S2.SS3.p3.1.m1.2.2.1.1" xref="S2.SS3.p3.1.m1.2.2.1.1.cmml">0</mn><mo stretchy="false" id="S2.SS3.p3.1.m1.2.2.1.3.2" xref="S2.SS3.p3.1.m1.3.4.2.cmml">)</mo></mrow><mprescripts id="S2.SS3.p3.1.m1.3.4.2a" xref="S2.SS3.p3.1.m1.3.4.2.cmml"></mprescripts><none id="S2.SS3.p3.1.m1.3.4.2b" xref="S2.SS3.p3.1.m1.3.4.2.cmml"></none><mrow id="S2.SS3.p3.1.m1.1.1.1.3" xref="S2.SS3.p3.1.m1.3.4.2.cmml"><mo stretchy="false" id="S2.SS3.p3.1.m1.1.1.1.3.1" xref="S2.SS3.p3.1.m1.3.4.2.cmml">(</mo><mi id="S2.SS3.p3.1.m1.1.1.1.1" xref="S2.SS3.p3.1.m1.1.1.1.1.cmml">m</mi><mo stretchy="false" id="S2.SS3.p3.1.m1.1.1.1.3.2" xref="S2.SS3.p3.1.m1.3.4.2.cmml">)</mo></mrow></mmultiscripts><mo id="S2.SS3.p3.1.m1.3.4.1" xref="S2.SS3.p3.1.m1.3.4.1.cmml">=</mo><mmultiscripts id="S2.SS3.p3.1.m1.3.4.3" xref="S2.SS3.p3.1.m1.3.4.3.cmml"><mi id="S2.SS3.p3.1.m1.3.4.3.2.2" xref="S2.SS3.p3.1.m1.3.4.3.2.2.cmml">𝒙</mi><mi id="S2.SS3.p3.1.m1.3.4.3.2.3" xref="S2.SS3.p3.1.m1.3.4.3.2.3.cmml">s</mi><none id="S2.SS3.p3.1.m1.3.4.3a" xref="S2.SS3.p3.1.m1.3.4.3.cmml"></none><mprescripts id="S2.SS3.p3.1.m1.3.4.3b" xref="S2.SS3.p3.1.m1.3.4.3.cmml"></mprescripts><none id="S2.SS3.p3.1.m1.3.4.3c" xref="S2.SS3.p3.1.m1.3.4.3.cmml"></none><mrow id="S2.SS3.p3.1.m1.3.3.1.3" xref="S2.SS3.p3.1.m1.3.4.3.cmml"><mo stretchy="false" id="S2.SS3.p3.1.m1.3.3.1.3.1" xref="S2.SS3.p3.1.m1.3.4.3.cmml">(</mo><mi id="S2.SS3.p3.1.m1.3.3.1.1" xref="S2.SS3.p3.1.m1.3.3.1.1.cmml">m</mi><mo stretchy="false" id="S2.SS3.p3.1.m1.3.3.1.3.2" xref="S2.SS3.p3.1.m1.3.4.3.cmml">)</mo></mrow></mmultiscripts></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.1.m1.3b"><apply id="S2.SS3.p3.1.m1.3.4.cmml" xref="S2.SS3.p3.1.m1.3.4"><eq id="S2.SS3.p3.1.m1.3.4.1.cmml" xref="S2.SS3.p3.1.m1.3.4.1"></eq><apply id="S2.SS3.p3.1.m1.3.4.2.cmml" xref="S2.SS3.p3.1.m1.3.4.2"><csymbol cd="ambiguous" id="S2.SS3.p3.1.m1.3.4.2.1.cmml" xref="S2.SS3.p3.1.m1.3.4.2">superscript</csymbol><apply id="S2.SS3.p3.1.m1.3.4.2.2.cmml" xref="S2.SS3.p3.1.m1.3.4.2"><csymbol cd="ambiguous" id="S2.SS3.p3.1.m1.3.4.2.2.1.cmml" xref="S2.SS3.p3.1.m1.3.4.2">subscript</csymbol><apply id="S2.SS3.p3.1.m1.3.4.2.2.2.cmml" xref="S2.SS3.p3.1.m1.3.4.2"><csymbol cd="ambiguous" id="S2.SS3.p3.1.m1.3.4.2.2.2.1.cmml" xref="S2.SS3.p3.1.m1.3.4.2">superscript</csymbol><ci id="S2.SS3.p3.1.m1.3.4.2.2.2.2.cmml" xref="S2.SS3.p3.1.m1.3.4.2.2.2.2">𝒚</ci><cn type="integer" id="S2.SS3.p3.1.m1.2.2.1.1.cmml" xref="S2.SS3.p3.1.m1.2.2.1.1">0</cn></apply><ci id="S2.SS3.p3.1.m1.3.4.2.2.3.cmml" xref="S2.SS3.p3.1.m1.3.4.2.2.3">𝑠</ci></apply><ci id="S2.SS3.p3.1.m1.1.1.1.1.cmml" xref="S2.SS3.p3.1.m1.1.1.1.1">𝑚</ci></apply><apply id="S2.SS3.p3.1.m1.3.4.3.cmml" xref="S2.SS3.p3.1.m1.3.4.3"><csymbol cd="ambiguous" id="S2.SS3.p3.1.m1.3.4.3.1.cmml" xref="S2.SS3.p3.1.m1.3.4.3">superscript</csymbol><apply id="S2.SS3.p3.1.m1.3.4.3.2.cmml" xref="S2.SS3.p3.1.m1.3.4.3"><csymbol cd="ambiguous" id="S2.SS3.p3.1.m1.3.4.3.2.1.cmml" xref="S2.SS3.p3.1.m1.3.4.3">subscript</csymbol><ci id="S2.SS3.p3.1.m1.3.4.3.2.2.cmml" xref="S2.SS3.p3.1.m1.3.4.3.2.2">𝒙</ci><ci id="S2.SS3.p3.1.m1.3.4.3.2.3.cmml" xref="S2.SS3.p3.1.m1.3.4.3.2.3">𝑠</ci></apply><ci id="S2.SS3.p3.1.m1.3.3.1.1.cmml" xref="S2.SS3.p3.1.m1.3.3.1.1">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.1.m1.3c">\prescript{(m)}{}{\bm{y}}^{(0)}_{s}=\prescript{(m)}{}{\bm{x}}_{s}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.1.m1.3d">start_FLOATSUPERSCRIPT ( italic_m ) end_FLOATSUPERSCRIPT bold_italic_y start_POSTSUPERSCRIPT ( 0 ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT = start_FLOATSUPERSCRIPT ( italic_m ) end_FLOATSUPERSCRIPT bold_italic_x start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> and <math id="S2.SS3.p3.2.m2.1" class="ltx_Math" alttext="1\leq s\leq S_{m}" display="inline"><semantics id="S2.SS3.p3.2.m2.1a"><mrow id="S2.SS3.p3.2.m2.1.1" xref="S2.SS3.p3.2.m2.1.1.cmml"><mn id="S2.SS3.p3.2.m2.1.1.2" xref="S2.SS3.p3.2.m2.1.1.2.cmml">1</mn><mo id="S2.SS3.p3.2.m2.1.1.3" xref="S2.SS3.p3.2.m2.1.1.3.cmml">≤</mo><mi id="S2.SS3.p3.2.m2.1.1.4" xref="S2.SS3.p3.2.m2.1.1.4.cmml">s</mi><mo id="S2.SS3.p3.2.m2.1.1.5" xref="S2.SS3.p3.2.m2.1.1.5.cmml">≤</mo><msub id="S2.SS3.p3.2.m2.1.1.6" xref="S2.SS3.p3.2.m2.1.1.6.cmml"><mi id="S2.SS3.p3.2.m2.1.1.6.2" xref="S2.SS3.p3.2.m2.1.1.6.2.cmml">S</mi><mi id="S2.SS3.p3.2.m2.1.1.6.3" xref="S2.SS3.p3.2.m2.1.1.6.3.cmml">m</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.2.m2.1b"><apply id="S2.SS3.p3.2.m2.1.1.cmml" xref="S2.SS3.p3.2.m2.1.1"><and id="S2.SS3.p3.2.m2.1.1a.cmml" xref="S2.SS3.p3.2.m2.1.1"></and><apply id="S2.SS3.p3.2.m2.1.1b.cmml" xref="S2.SS3.p3.2.m2.1.1"><leq id="S2.SS3.p3.2.m2.1.1.3.cmml" xref="S2.SS3.p3.2.m2.1.1.3"></leq><cn type="integer" id="S2.SS3.p3.2.m2.1.1.2.cmml" xref="S2.SS3.p3.2.m2.1.1.2">1</cn><ci id="S2.SS3.p3.2.m2.1.1.4.cmml" xref="S2.SS3.p3.2.m2.1.1.4">𝑠</ci></apply><apply id="S2.SS3.p3.2.m2.1.1c.cmml" xref="S2.SS3.p3.2.m2.1.1"><leq id="S2.SS3.p3.2.m2.1.1.5.cmml" xref="S2.SS3.p3.2.m2.1.1.5"></leq><share href="#S2.SS3.p3.2.m2.1.1.4.cmml" id="S2.SS3.p3.2.m2.1.1d.cmml" xref="S2.SS3.p3.2.m2.1.1"></share><apply id="S2.SS3.p3.2.m2.1.1.6.cmml" xref="S2.SS3.p3.2.m2.1.1.6"><csymbol cd="ambiguous" id="S2.SS3.p3.2.m2.1.1.6.1.cmml" xref="S2.SS3.p3.2.m2.1.1.6">subscript</csymbol><ci id="S2.SS3.p3.2.m2.1.1.6.2.cmml" xref="S2.SS3.p3.2.m2.1.1.6.2">𝑆</ci><ci id="S2.SS3.p3.2.m2.1.1.6.3.cmml" xref="S2.SS3.p3.2.m2.1.1.6.3">𝑚</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.2.m2.1c">1\leq s\leq S_{m}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.2.m2.1d">1 ≤ italic_s ≤ italic_S start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT</annotation></semantics></math>, <math id="S2.SS3.p3.3.m3.1" class="ltx_Math" alttext="1\leq l\leq L" display="inline"><semantics id="S2.SS3.p3.3.m3.1a"><mrow id="S2.SS3.p3.3.m3.1.1" xref="S2.SS3.p3.3.m3.1.1.cmml"><mn id="S2.SS3.p3.3.m3.1.1.2" xref="S2.SS3.p3.3.m3.1.1.2.cmml">1</mn><mo id="S2.SS3.p3.3.m3.1.1.3" xref="S2.SS3.p3.3.m3.1.1.3.cmml">≤</mo><mi id="S2.SS3.p3.3.m3.1.1.4" xref="S2.SS3.p3.3.m3.1.1.4.cmml">l</mi><mo id="S2.SS3.p3.3.m3.1.1.5" xref="S2.SS3.p3.3.m3.1.1.5.cmml">≤</mo><mi id="S2.SS3.p3.3.m3.1.1.6" xref="S2.SS3.p3.3.m3.1.1.6.cmml">L</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.3.m3.1b"><apply id="S2.SS3.p3.3.m3.1.1.cmml" xref="S2.SS3.p3.3.m3.1.1"><and id="S2.SS3.p3.3.m3.1.1a.cmml" xref="S2.SS3.p3.3.m3.1.1"></and><apply id="S2.SS3.p3.3.m3.1.1b.cmml" xref="S2.SS3.p3.3.m3.1.1"><leq id="S2.SS3.p3.3.m3.1.1.3.cmml" xref="S2.SS3.p3.3.m3.1.1.3"></leq><cn type="integer" id="S2.SS3.p3.3.m3.1.1.2.cmml" xref="S2.SS3.p3.3.m3.1.1.2">1</cn><ci id="S2.SS3.p3.3.m3.1.1.4.cmml" xref="S2.SS3.p3.3.m3.1.1.4">𝑙</ci></apply><apply id="S2.SS3.p3.3.m3.1.1c.cmml" xref="S2.SS3.p3.3.m3.1.1"><leq id="S2.SS3.p3.3.m3.1.1.5.cmml" xref="S2.SS3.p3.3.m3.1.1.5"></leq><share href="#S2.SS3.p3.3.m3.1.1.4.cmml" id="S2.SS3.p3.3.m3.1.1d.cmml" xref="S2.SS3.p3.3.m3.1.1"></share><ci id="S2.SS3.p3.3.m3.1.1.6.cmml" xref="S2.SS3.p3.3.m3.1.1.6">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.3.m3.1c">1\leq l\leq L</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.3.m3.1d">1 ≤ italic_l ≤ italic_L</annotation></semantics></math>. Here, the regularization term is defined as
</p>
<table id="S1.EGx10" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S2.E19"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E19.m1.3" class="ltx_Math" alttext="\displaystyle\text{RegTerm}:=\frac{\lambda}{2d}\|\bm{w}\|^{2}+\frac{\gamma}{2d%
}\sum_{s=1}^{S_{m}}\|\prescript{(m)}{}{\bm{x}}_{s}\|^{2}," display="inline"><semantics id="S2.E19.m1.3a"><mrow id="S2.E19.m1.3.3.1" xref="S2.E19.m1.3.3.1.1.cmml"><mrow id="S2.E19.m1.3.3.1.1" xref="S2.E19.m1.3.3.1.1.cmml"><mtext id="S2.E19.m1.3.3.1.1.3" xref="S2.E19.m1.3.3.1.1.3a.cmml">RegTerm</mtext><mo id="S2.E19.m1.3.3.1.1.2" xref="S2.E19.m1.3.3.1.1.2.cmml">:=</mo><mrow id="S2.E19.m1.3.3.1.1.1" xref="S2.E19.m1.3.3.1.1.1.cmml"><mrow id="S2.E19.m1.3.3.1.1.1.3" xref="S2.E19.m1.3.3.1.1.1.3.cmml"><mstyle displaystyle="true" id="S2.E19.m1.3.3.1.1.1.3.2" xref="S2.E19.m1.3.3.1.1.1.3.2.cmml"><mfrac id="S2.E19.m1.3.3.1.1.1.3.2a" xref="S2.E19.m1.3.3.1.1.1.3.2.cmml"><mi id="S2.E19.m1.3.3.1.1.1.3.2.2" xref="S2.E19.m1.3.3.1.1.1.3.2.2.cmml">λ</mi><mrow id="S2.E19.m1.3.3.1.1.1.3.2.3" xref="S2.E19.m1.3.3.1.1.1.3.2.3.cmml"><mn id="S2.E19.m1.3.3.1.1.1.3.2.3.2" xref="S2.E19.m1.3.3.1.1.1.3.2.3.2.cmml">2</mn><mo id="S2.E19.m1.3.3.1.1.1.3.2.3.1" xref="S2.E19.m1.3.3.1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S2.E19.m1.3.3.1.1.1.3.2.3.3" xref="S2.E19.m1.3.3.1.1.1.3.2.3.3.cmml">d</mi></mrow></mfrac></mstyle><mo id="S2.E19.m1.3.3.1.1.1.3.1" xref="S2.E19.m1.3.3.1.1.1.3.1.cmml">⁢</mo><msup id="S2.E19.m1.3.3.1.1.1.3.3" xref="S2.E19.m1.3.3.1.1.1.3.3.cmml"><mrow id="S2.E19.m1.3.3.1.1.1.3.3.2.2" xref="S2.E19.m1.3.3.1.1.1.3.3.2.1.cmml"><mo fence="true" id="S2.E19.m1.3.3.1.1.1.3.3.2.2.1" xref="S2.E19.m1.3.3.1.1.1.3.3.2.1.1.cmml">‖</mo><mi id="S2.E19.m1.2.2" xref="S2.E19.m1.2.2.cmml">𝒘</mi><mo fence="true" id="S2.E19.m1.3.3.1.1.1.3.3.2.2.2" xref="S2.E19.m1.3.3.1.1.1.3.3.2.1.1.cmml">‖</mo></mrow><mn id="S2.E19.m1.3.3.1.1.1.3.3.3" xref="S2.E19.m1.3.3.1.1.1.3.3.3.cmml">2</mn></msup></mrow><mo id="S2.E19.m1.3.3.1.1.1.2" xref="S2.E19.m1.3.3.1.1.1.2.cmml">+</mo><mrow id="S2.E19.m1.3.3.1.1.1.1" xref="S2.E19.m1.3.3.1.1.1.1.cmml"><mstyle displaystyle="true" id="S2.E19.m1.3.3.1.1.1.1.3" xref="S2.E19.m1.3.3.1.1.1.1.3.cmml"><mfrac id="S2.E19.m1.3.3.1.1.1.1.3a" xref="S2.E19.m1.3.3.1.1.1.1.3.cmml"><mi id="S2.E19.m1.3.3.1.1.1.1.3.2" xref="S2.E19.m1.3.3.1.1.1.1.3.2.cmml">γ</mi><mrow id="S2.E19.m1.3.3.1.1.1.1.3.3" xref="S2.E19.m1.3.3.1.1.1.1.3.3.cmml"><mn id="S2.E19.m1.3.3.1.1.1.1.3.3.2" xref="S2.E19.m1.3.3.1.1.1.1.3.3.2.cmml">2</mn><mo id="S2.E19.m1.3.3.1.1.1.1.3.3.1" xref="S2.E19.m1.3.3.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.E19.m1.3.3.1.1.1.1.3.3.3" xref="S2.E19.m1.3.3.1.1.1.1.3.3.3.cmml">d</mi></mrow></mfrac></mstyle><mo id="S2.E19.m1.3.3.1.1.1.1.2" xref="S2.E19.m1.3.3.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E19.m1.3.3.1.1.1.1.1" xref="S2.E19.m1.3.3.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S2.E19.m1.3.3.1.1.1.1.1.2" xref="S2.E19.m1.3.3.1.1.1.1.1.2.cmml"><munderover id="S2.E19.m1.3.3.1.1.1.1.1.2a" xref="S2.E19.m1.3.3.1.1.1.1.1.2.cmml"><mo largeop="true" movablelimits="false" symmetric="true" id="S2.E19.m1.3.3.1.1.1.1.1.2.2.2" xref="S2.E19.m1.3.3.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S2.E19.m1.3.3.1.1.1.1.1.2.2.3" xref="S2.E19.m1.3.3.1.1.1.1.1.2.2.3.cmml"><mi id="S2.E19.m1.3.3.1.1.1.1.1.2.2.3.2" xref="S2.E19.m1.3.3.1.1.1.1.1.2.2.3.2.cmml">s</mi><mo id="S2.E19.m1.3.3.1.1.1.1.1.2.2.3.1" xref="S2.E19.m1.3.3.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S2.E19.m1.3.3.1.1.1.1.1.2.2.3.3" xref="S2.E19.m1.3.3.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><msub id="S2.E19.m1.3.3.1.1.1.1.1.2.3" xref="S2.E19.m1.3.3.1.1.1.1.1.2.3.cmml"><mi id="S2.E19.m1.3.3.1.1.1.1.1.2.3.2" xref="S2.E19.m1.3.3.1.1.1.1.1.2.3.2.cmml">S</mi><mi id="S2.E19.m1.3.3.1.1.1.1.1.2.3.3" xref="S2.E19.m1.3.3.1.1.1.1.1.2.3.3.cmml">m</mi></msub></munderover></mstyle><msup id="S2.E19.m1.3.3.1.1.1.1.1.1" xref="S2.E19.m1.3.3.1.1.1.1.1.1.cmml"><mrow id="S2.E19.m1.3.3.1.1.1.1.1.1.1.1" xref="S2.E19.m1.3.3.1.1.1.1.1.1.1.2.cmml"><mo fence="true" id="S2.E19.m1.3.3.1.1.1.1.1.1.1.1.2" xref="S2.E19.m1.3.3.1.1.1.1.1.1.1.2.1.cmml">‖</mo><mmultiscripts id="S2.E19.m1.3.3.1.1.1.1.1.1.1.1.1" xref="S2.E19.m1.3.3.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E19.m1.3.3.1.1.1.1.1.1.1.1.1.2.2" xref="S2.E19.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.cmml">𝒙</mi><mi id="S2.E19.m1.3.3.1.1.1.1.1.1.1.1.1.2.3" xref="S2.E19.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.cmml">s</mi><none id="S2.E19.m1.3.3.1.1.1.1.1.1.1.1.1a" xref="S2.E19.m1.3.3.1.1.1.1.1.1.1.1.1.cmml"></none><mprescripts id="S2.E19.m1.3.3.1.1.1.1.1.1.1.1.1b" xref="S2.E19.m1.3.3.1.1.1.1.1.1.1.1.1.cmml"></mprescripts><none id="S2.E19.m1.3.3.1.1.1.1.1.1.1.1.1c" xref="S2.E19.m1.3.3.1.1.1.1.1.1.1.1.1.cmml"></none><mrow id="S2.E19.m1.1.1.1.3" xref="S2.E19.m1.3.3.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E19.m1.1.1.1.3.1" xref="S2.E19.m1.3.3.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S2.E19.m1.1.1.1.1" xref="S2.E19.m1.1.1.1.1.cmml">m</mi><mo stretchy="false" id="S2.E19.m1.1.1.1.3.2" xref="S2.E19.m1.3.3.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mmultiscripts><mo fence="true" id="S2.E19.m1.3.3.1.1.1.1.1.1.1.1.3" xref="S2.E19.m1.3.3.1.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S2.E19.m1.3.3.1.1.1.1.1.1.3" xref="S2.E19.m1.3.3.1.1.1.1.1.1.3.cmml">2</mn></msup></mrow></mrow></mrow></mrow><mo id="S2.E19.m1.3.3.1.2" xref="S2.E19.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E19.m1.3b"><apply id="S2.E19.m1.3.3.1.1.cmml" xref="S2.E19.m1.3.3.1"><csymbol cd="latexml" id="S2.E19.m1.3.3.1.1.2.cmml" xref="S2.E19.m1.3.3.1.1.2">assign</csymbol><ci id="S2.E19.m1.3.3.1.1.3a.cmml" xref="S2.E19.m1.3.3.1.1.3"><mtext id="S2.E19.m1.3.3.1.1.3.cmml" xref="S2.E19.m1.3.3.1.1.3">RegTerm</mtext></ci><apply id="S2.E19.m1.3.3.1.1.1.cmml" xref="S2.E19.m1.3.3.1.1.1"><plus id="S2.E19.m1.3.3.1.1.1.2.cmml" xref="S2.E19.m1.3.3.1.1.1.2"></plus><apply id="S2.E19.m1.3.3.1.1.1.3.cmml" xref="S2.E19.m1.3.3.1.1.1.3"><times id="S2.E19.m1.3.3.1.1.1.3.1.cmml" xref="S2.E19.m1.3.3.1.1.1.3.1"></times><apply id="S2.E19.m1.3.3.1.1.1.3.2.cmml" xref="S2.E19.m1.3.3.1.1.1.3.2"><divide id="S2.E19.m1.3.3.1.1.1.3.2.1.cmml" xref="S2.E19.m1.3.3.1.1.1.3.2"></divide><ci id="S2.E19.m1.3.3.1.1.1.3.2.2.cmml" xref="S2.E19.m1.3.3.1.1.1.3.2.2">𝜆</ci><apply id="S2.E19.m1.3.3.1.1.1.3.2.3.cmml" xref="S2.E19.m1.3.3.1.1.1.3.2.3"><times id="S2.E19.m1.3.3.1.1.1.3.2.3.1.cmml" xref="S2.E19.m1.3.3.1.1.1.3.2.3.1"></times><cn type="integer" id="S2.E19.m1.3.3.1.1.1.3.2.3.2.cmml" xref="S2.E19.m1.3.3.1.1.1.3.2.3.2">2</cn><ci id="S2.E19.m1.3.3.1.1.1.3.2.3.3.cmml" xref="S2.E19.m1.3.3.1.1.1.3.2.3.3">𝑑</ci></apply></apply><apply id="S2.E19.m1.3.3.1.1.1.3.3.cmml" xref="S2.E19.m1.3.3.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E19.m1.3.3.1.1.1.3.3.1.cmml" xref="S2.E19.m1.3.3.1.1.1.3.3">superscript</csymbol><apply id="S2.E19.m1.3.3.1.1.1.3.3.2.1.cmml" xref="S2.E19.m1.3.3.1.1.1.3.3.2.2"><csymbol cd="latexml" id="S2.E19.m1.3.3.1.1.1.3.3.2.1.1.cmml" xref="S2.E19.m1.3.3.1.1.1.3.3.2.2.1">norm</csymbol><ci id="S2.E19.m1.2.2.cmml" xref="S2.E19.m1.2.2">𝒘</ci></apply><cn type="integer" id="S2.E19.m1.3.3.1.1.1.3.3.3.cmml" xref="S2.E19.m1.3.3.1.1.1.3.3.3">2</cn></apply></apply><apply id="S2.E19.m1.3.3.1.1.1.1.cmml" xref="S2.E19.m1.3.3.1.1.1.1"><times id="S2.E19.m1.3.3.1.1.1.1.2.cmml" xref="S2.E19.m1.3.3.1.1.1.1.2"></times><apply id="S2.E19.m1.3.3.1.1.1.1.3.cmml" xref="S2.E19.m1.3.3.1.1.1.1.3"><divide id="S2.E19.m1.3.3.1.1.1.1.3.1.cmml" xref="S2.E19.m1.3.3.1.1.1.1.3"></divide><ci id="S2.E19.m1.3.3.1.1.1.1.3.2.cmml" xref="S2.E19.m1.3.3.1.1.1.1.3.2">𝛾</ci><apply id="S2.E19.m1.3.3.1.1.1.1.3.3.cmml" xref="S2.E19.m1.3.3.1.1.1.1.3.3"><times id="S2.E19.m1.3.3.1.1.1.1.3.3.1.cmml" xref="S2.E19.m1.3.3.1.1.1.1.3.3.1"></times><cn type="integer" id="S2.E19.m1.3.3.1.1.1.1.3.3.2.cmml" xref="S2.E19.m1.3.3.1.1.1.1.3.3.2">2</cn><ci id="S2.E19.m1.3.3.1.1.1.1.3.3.3.cmml" xref="S2.E19.m1.3.3.1.1.1.1.3.3.3">𝑑</ci></apply></apply><apply id="S2.E19.m1.3.3.1.1.1.1.1.cmml" xref="S2.E19.m1.3.3.1.1.1.1.1"><apply id="S2.E19.m1.3.3.1.1.1.1.1.2.cmml" xref="S2.E19.m1.3.3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E19.m1.3.3.1.1.1.1.1.2.1.cmml" xref="S2.E19.m1.3.3.1.1.1.1.1.2">superscript</csymbol><apply id="S2.E19.m1.3.3.1.1.1.1.1.2.2.cmml" xref="S2.E19.m1.3.3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E19.m1.3.3.1.1.1.1.1.2.2.1.cmml" xref="S2.E19.m1.3.3.1.1.1.1.1.2">subscript</csymbol><sum id="S2.E19.m1.3.3.1.1.1.1.1.2.2.2.cmml" xref="S2.E19.m1.3.3.1.1.1.1.1.2.2.2"></sum><apply id="S2.E19.m1.3.3.1.1.1.1.1.2.2.3.cmml" xref="S2.E19.m1.3.3.1.1.1.1.1.2.2.3"><eq id="S2.E19.m1.3.3.1.1.1.1.1.2.2.3.1.cmml" xref="S2.E19.m1.3.3.1.1.1.1.1.2.2.3.1"></eq><ci id="S2.E19.m1.3.3.1.1.1.1.1.2.2.3.2.cmml" xref="S2.E19.m1.3.3.1.1.1.1.1.2.2.3.2">𝑠</ci><cn type="integer" id="S2.E19.m1.3.3.1.1.1.1.1.2.2.3.3.cmml" xref="S2.E19.m1.3.3.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><apply id="S2.E19.m1.3.3.1.1.1.1.1.2.3.cmml" xref="S2.E19.m1.3.3.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S2.E19.m1.3.3.1.1.1.1.1.2.3.1.cmml" xref="S2.E19.m1.3.3.1.1.1.1.1.2.3">subscript</csymbol><ci id="S2.E19.m1.3.3.1.1.1.1.1.2.3.2.cmml" xref="S2.E19.m1.3.3.1.1.1.1.1.2.3.2">𝑆</ci><ci id="S2.E19.m1.3.3.1.1.1.1.1.2.3.3.cmml" xref="S2.E19.m1.3.3.1.1.1.1.1.2.3.3">𝑚</ci></apply></apply><apply id="S2.E19.m1.3.3.1.1.1.1.1.1.cmml" xref="S2.E19.m1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E19.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S2.E19.m1.3.3.1.1.1.1.1.1">superscript</csymbol><apply id="S2.E19.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S2.E19.m1.3.3.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E19.m1.3.3.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E19.m1.3.3.1.1.1.1.1.1.1.1.2">norm</csymbol><apply id="S2.E19.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E19.m1.3.3.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E19.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E19.m1.3.3.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S2.E19.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E19.m1.3.3.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E19.m1.3.3.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E19.m1.3.3.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E19.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E19.m1.3.3.1.1.1.1.1.1.1.1.1.2.2">𝒙</ci><ci id="S2.E19.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E19.m1.3.3.1.1.1.1.1.1.1.1.1.2.3">𝑠</ci></apply><ci id="S2.E19.m1.1.1.1.1.cmml" xref="S2.E19.m1.1.1.1.1">𝑚</ci></apply></apply><cn type="integer" id="S2.E19.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S2.E19.m1.3.3.1.1.1.1.1.1.3">2</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E19.m1.3c">\displaystyle\text{RegTerm}:=\frac{\lambda}{2d}\|\bm{w}\|^{2}+\frac{\gamma}{2d%
}\sum_{s=1}^{S_{m}}\|\prescript{(m)}{}{\bm{x}}_{s}\|^{2},</annotation><annotation encoding="application/x-llamapun" id="S2.E19.m1.3d">RegTerm := divide start_ARG italic_λ end_ARG start_ARG 2 italic_d end_ARG ∥ bold_italic_w ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + divide start_ARG italic_γ end_ARG start_ARG 2 italic_d end_ARG ∑ start_POSTSUBSCRIPT italic_s = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_S start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT end_POSTSUPERSCRIPT ∥ start_FLOATSUPERSCRIPT ( italic_m ) end_FLOATSUPERSCRIPT bold_italic_x start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(19)</span></td>
</tr></tbody>
</table>
<p id="S2.SS3.p3.4" class="ltx_p">where <math id="S2.SS3.p3.4.m1.2" class="ltx_Math" alttext="\lambda,\gamma\geq 0" display="inline"><semantics id="S2.SS3.p3.4.m1.2a"><mrow id="S2.SS3.p3.4.m1.2.3" xref="S2.SS3.p3.4.m1.2.3.cmml"><mrow id="S2.SS3.p3.4.m1.2.3.2.2" xref="S2.SS3.p3.4.m1.2.3.2.1.cmml"><mi id="S2.SS3.p3.4.m1.1.1" xref="S2.SS3.p3.4.m1.1.1.cmml">λ</mi><mo id="S2.SS3.p3.4.m1.2.3.2.2.1" xref="S2.SS3.p3.4.m1.2.3.2.1.cmml">,</mo><mi id="S2.SS3.p3.4.m1.2.2" xref="S2.SS3.p3.4.m1.2.2.cmml">γ</mi></mrow><mo id="S2.SS3.p3.4.m1.2.3.1" xref="S2.SS3.p3.4.m1.2.3.1.cmml">≥</mo><mn id="S2.SS3.p3.4.m1.2.3.3" xref="S2.SS3.p3.4.m1.2.3.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.4.m1.2b"><apply id="S2.SS3.p3.4.m1.2.3.cmml" xref="S2.SS3.p3.4.m1.2.3"><geq id="S2.SS3.p3.4.m1.2.3.1.cmml" xref="S2.SS3.p3.4.m1.2.3.1"></geq><list id="S2.SS3.p3.4.m1.2.3.2.1.cmml" xref="S2.SS3.p3.4.m1.2.3.2.2"><ci id="S2.SS3.p3.4.m1.1.1.cmml" xref="S2.SS3.p3.4.m1.1.1">𝜆</ci><ci id="S2.SS3.p3.4.m1.2.2.cmml" xref="S2.SS3.p3.4.m1.2.2">𝛾</ci></list><cn type="integer" id="S2.SS3.p3.4.m1.2.3.3.cmml" xref="S2.SS3.p3.4.m1.2.3.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.4.m1.2c">\lambda,\gamma\geq 0</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.4.m1.2d">italic_λ , italic_γ ≥ 0</annotation></semantics></math> are two regularization coefficients.</p>
</div>
<div id="S2.SS3.p4" class="ltx_para">
<p id="S2.SS3.p4.1" class="ltx_p">With the loss function defined in Eq. (<a href="#S2.E17" title="(17) ‣ 2.3 Loss Function ‣ 2 Method ‣ Quantum Self-Attention Neural Networks for Text Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">17</span></a>), we can optimize its parameters by (stochastic) gradient-descent <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib45" title="" class="ltx_ref">45</a>]</cite>.
The analytical gradient analysis can be found in the Appendix. Finally, with the above preparation, we could train our QSANN to get the optimal (or sub-optimal) parameters. See Algorithm <a href="#alg1" title="Algorithm 1 ‣ 2.3 Loss Function ‣ 2 Method ‣ Quantum Self-Attention Neural Networks for Text Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>
for details on the training procedure. We remark that if the loss converges during training or the maximum number of iterations is reached, the optimization stops.</p>
</div>
<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.2.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> QSANN training for text classification</figcaption>
<div id="alg1.3" class="ltx_listing ltx_listing">
<div id="alg1.l0" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l0.1.1.1" class="ltx_text" style="font-size:80%;">0:</span></span>  The training data set <math id="alg1.l0.m1.1" class="ltx_Math" alttext="\mathcal{D}" display="inline"><semantics id="alg1.l0.m1.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.l0.m1.1.1" xref="alg1.l0.m1.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="alg1.l0.m1.1b"><ci id="alg1.l0.m1.1.1.cmml" xref="alg1.l0.m1.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m1.1c">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="alg1.l0.m1.1d">caligraphic_D</annotation></semantics></math> <math id="alg1.l0.m2.1" class="ltx_Math" alttext=":=" display="inline"><semantics id="alg1.l0.m2.1a"><mo id="alg1.l0.m2.1.1" xref="alg1.l0.m2.1.1.cmml">:=</mo><annotation-xml encoding="MathML-Content" id="alg1.l0.m2.1b"><csymbol cd="latexml" id="alg1.l0.m2.1.1.cmml" xref="alg1.l0.m2.1.1">assign</csymbol></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m2.1c">:=</annotation><annotation encoding="application/x-llamapun" id="alg1.l0.m2.1d">:=</annotation></semantics></math> <math id="alg1.l0.m3.1" class="ltx_Math" alttext="\{(\prescript{(m)}{}{\bm{x}_{1}}" display="inline"><semantics id="alg1.l0.m3.1a"><mrow id="alg1.l0.m3.1b"><mo stretchy="false" id="alg1.l0.m3.1.2" xref="alg1.l0.m3.1.2.cmml">{</mo><mrow id="alg1.l0.m3.1.3" xref="alg1.l0.m3.1.3.cmml"><mo stretchy="false" id="alg1.l0.m3.1.3.1" xref="alg1.l0.m3.1.3.1.cmml">(</mo><mmultiscripts id="alg1.l0.m3.1.3.2" xref="alg1.l0.m3.1.3.2.cmml"><mi id="alg1.l0.m3.1.3.2.2.2" xref="alg1.l0.m3.1.3.2.2.2.cmml">𝒙</mi><mn id="alg1.l0.m3.1.3.2.2.3" xref="alg1.l0.m3.1.3.2.2.3.cmml">1</mn><none id="alg1.l0.m3.1.3.2a" xref="alg1.l0.m3.1.3.2.cmml"></none><mprescripts id="alg1.l0.m3.1.3.2b" xref="alg1.l0.m3.1.3.2.cmml"></mprescripts><none id="alg1.l0.m3.1.3.2c" xref="alg1.l0.m3.1.3.2.cmml"></none><mrow id="alg1.l0.m3.1.1.1.3" xref="alg1.l0.m3.1.3.2.cmml"><mo stretchy="false" id="alg1.l0.m3.1.1.1.3.1" xref="alg1.l0.m3.1.3.2.cmml">(</mo><mi id="alg1.l0.m3.1.1.1.1" xref="alg1.l0.m3.1.1.1.1.cmml">m</mi><mo stretchy="false" id="alg1.l0.m3.1.1.1.3.2" xref="alg1.l0.m3.1.3.2.cmml">)</mo></mrow></mmultiscripts></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l0.m3.1c"><cerror id="alg1.l0.m3.1d"><csymbol cd="ambiguous" id="alg1.l0.m3.1e">fragments</csymbol><ci id="alg1.l0.m3.1.2.cmml" xref="alg1.l0.m3.1.2">{</ci><cerror id="alg1.l0.m3.1.3.cmml" xref="alg1.l0.m3.1.3"><csymbol cd="ambiguous" id="alg1.l0.m3.1.3a.cmml" xref="alg1.l0.m3.1.3">fragments</csymbol><ci id="alg1.l0.m3.1.3.1.cmml" xref="alg1.l0.m3.1.3.1">(</ci><apply id="alg1.l0.m3.1.3.2.cmml" xref="alg1.l0.m3.1.3.2"><csymbol cd="ambiguous" id="alg1.l0.m3.1.3.2.1.cmml" xref="alg1.l0.m3.1.3.2">superscript</csymbol><apply id="alg1.l0.m3.1.3.2.2.cmml" xref="alg1.l0.m3.1.3.2"><csymbol cd="ambiguous" id="alg1.l0.m3.1.3.2.2.1.cmml" xref="alg1.l0.m3.1.3.2">subscript</csymbol><ci id="alg1.l0.m3.1.3.2.2.2.cmml" xref="alg1.l0.m3.1.3.2.2.2">𝒙</ci><cn type="integer" id="alg1.l0.m3.1.3.2.2.3.cmml" xref="alg1.l0.m3.1.3.2.2.3">1</cn></apply><ci id="alg1.l0.m3.1.1.1.1.cmml" xref="alg1.l0.m3.1.1.1.1">𝑚</ci></apply></cerror></cerror></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m3.1f">\{(\prescript{(m)}{}{\bm{x}_{1}}</annotation><annotation encoding="application/x-llamapun" id="alg1.l0.m3.1g">{ ( start_FLOATSUPERSCRIPT ( italic_m ) end_FLOATSUPERSCRIPT bold_italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>, <math id="alg1.l0.m4.1" class="ltx_Math" alttext="\prescript{(m)}{}{\bm{x}_{2}}" display="inline"><semantics id="alg1.l0.m4.1a"><mmultiscripts id="alg1.l0.m4.1.2" xref="alg1.l0.m4.1.2.cmml"><mi id="alg1.l0.m4.1.2.2.2" xref="alg1.l0.m4.1.2.2.2.cmml">𝒙</mi><mn id="alg1.l0.m4.1.2.2.3" xref="alg1.l0.m4.1.2.2.3.cmml">2</mn><none id="alg1.l0.m4.1.2a" xref="alg1.l0.m4.1.2.cmml"></none><mprescripts id="alg1.l0.m4.1.2b" xref="alg1.l0.m4.1.2.cmml"></mprescripts><none id="alg1.l0.m4.1.2c" xref="alg1.l0.m4.1.2.cmml"></none><mrow id="alg1.l0.m4.1.1.1.3" xref="alg1.l0.m4.1.2.cmml"><mo stretchy="false" id="alg1.l0.m4.1.1.1.3.1" xref="alg1.l0.m4.1.2.cmml">(</mo><mi id="alg1.l0.m4.1.1.1.1" xref="alg1.l0.m4.1.1.1.1.cmml">m</mi><mo stretchy="false" id="alg1.l0.m4.1.1.1.3.2" xref="alg1.l0.m4.1.2.cmml">)</mo></mrow></mmultiscripts><annotation-xml encoding="MathML-Content" id="alg1.l0.m4.1b"><apply id="alg1.l0.m4.1.2.cmml" xref="alg1.l0.m4.1.2"><csymbol cd="ambiguous" id="alg1.l0.m4.1.2.1.cmml" xref="alg1.l0.m4.1.2">superscript</csymbol><apply id="alg1.l0.m4.1.2.2.cmml" xref="alg1.l0.m4.1.2"><csymbol cd="ambiguous" id="alg1.l0.m4.1.2.2.1.cmml" xref="alg1.l0.m4.1.2">subscript</csymbol><ci id="alg1.l0.m4.1.2.2.2.cmml" xref="alg1.l0.m4.1.2.2.2">𝒙</ci><cn type="integer" id="alg1.l0.m4.1.2.2.3.cmml" xref="alg1.l0.m4.1.2.2.3">2</cn></apply><ci id="alg1.l0.m4.1.1.1.1.cmml" xref="alg1.l0.m4.1.1.1.1">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m4.1c">\prescript{(m)}{}{\bm{x}_{2}}</annotation><annotation encoding="application/x-llamapun" id="alg1.l0.m4.1d">start_FLOATSUPERSCRIPT ( italic_m ) end_FLOATSUPERSCRIPT bold_italic_x start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>, <math id="alg1.l0.m5.1" class="ltx_Math" alttext="\ldots" display="inline"><semantics id="alg1.l0.m5.1a"><mi mathvariant="normal" id="alg1.l0.m5.1.1" xref="alg1.l0.m5.1.1.cmml">…</mi><annotation-xml encoding="MathML-Content" id="alg1.l0.m5.1b"><ci id="alg1.l0.m5.1.1.cmml" xref="alg1.l0.m5.1.1">…</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m5.1c">\ldots</annotation><annotation encoding="application/x-llamapun" id="alg1.l0.m5.1d">…</annotation></semantics></math>, <math id="alg1.l0.m6.1" class="ltx_Math" alttext="\prescript{(m)}{}{\bm{x}_{S_{m}}})" display="inline"><semantics id="alg1.l0.m6.1a"><mrow id="alg1.l0.m6.1b"><mmultiscripts id="alg1.l0.m6.1.2" xref="alg1.l0.m6.1.2.cmml"><mi id="alg1.l0.m6.1.2.2.2" xref="alg1.l0.m6.1.2.2.2.cmml">𝒙</mi><msub id="alg1.l0.m6.1.2.2.3" xref="alg1.l0.m6.1.2.2.3.cmml"><mi id="alg1.l0.m6.1.2.2.3.2" xref="alg1.l0.m6.1.2.2.3.2.cmml">S</mi><mi id="alg1.l0.m6.1.2.2.3.3" xref="alg1.l0.m6.1.2.2.3.3.cmml">m</mi></msub><none id="alg1.l0.m6.1.2a" xref="alg1.l0.m6.1.2.cmml"></none><mprescripts id="alg1.l0.m6.1.2b" xref="alg1.l0.m6.1.2.cmml"></mprescripts><none id="alg1.l0.m6.1.2c" xref="alg1.l0.m6.1.2.cmml"></none><mrow id="alg1.l0.m6.1.1.1.3" xref="alg1.l0.m6.1.2.cmml"><mo stretchy="false" id="alg1.l0.m6.1.1.1.3.1" xref="alg1.l0.m6.1.2.cmml">(</mo><mi id="alg1.l0.m6.1.1.1.1" xref="alg1.l0.m6.1.1.1.1.cmml">m</mi><mo stretchy="false" id="alg1.l0.m6.1.1.1.3.2" xref="alg1.l0.m6.1.2.cmml">)</mo></mrow></mmultiscripts><mo stretchy="false" id="alg1.l0.m6.1.3" xref="alg1.l0.m6.1.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.l0.m6.1c"><cerror id="alg1.l0.m6.1d"><csymbol cd="ambiguous" id="alg1.l0.m6.1e">fragments</csymbol><apply id="alg1.l0.m6.1.2.cmml" xref="alg1.l0.m6.1.2"><csymbol cd="ambiguous" id="alg1.l0.m6.1.2.1.cmml" xref="alg1.l0.m6.1.2">superscript</csymbol><apply id="alg1.l0.m6.1.2.2.cmml" xref="alg1.l0.m6.1.2"><csymbol cd="ambiguous" id="alg1.l0.m6.1.2.2.1.cmml" xref="alg1.l0.m6.1.2">subscript</csymbol><ci id="alg1.l0.m6.1.2.2.2.cmml" xref="alg1.l0.m6.1.2.2.2">𝒙</ci><apply id="alg1.l0.m6.1.2.2.3.cmml" xref="alg1.l0.m6.1.2.2.3"><csymbol cd="ambiguous" id="alg1.l0.m6.1.2.2.3.1.cmml" xref="alg1.l0.m6.1.2.2.3">subscript</csymbol><ci id="alg1.l0.m6.1.2.2.3.2.cmml" xref="alg1.l0.m6.1.2.2.3.2">𝑆</ci><ci id="alg1.l0.m6.1.2.2.3.3.cmml" xref="alg1.l0.m6.1.2.2.3.3">𝑚</ci></apply></apply><ci id="alg1.l0.m6.1.1.1.1.cmml" xref="alg1.l0.m6.1.1.1.1">𝑚</ci></apply><ci id="alg1.l0.m6.1.3.cmml" xref="alg1.l0.m6.1.3">)</ci></cerror></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m6.1f">\prescript{(m)}{}{\bm{x}_{S_{m}}})</annotation><annotation encoding="application/x-llamapun" id="alg1.l0.m6.1g">start_FLOATSUPERSCRIPT ( italic_m ) end_FLOATSUPERSCRIPT bold_italic_x start_POSTSUBSCRIPT italic_S start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT end_POSTSUBSCRIPT )</annotation></semantics></math>, <math id="alg1.l0.m7.1" class="ltx_Math" alttext="\prescript{(m)}{}{y}\}_{m=1}^{N_{s}}" display="inline"><semantics id="alg1.l0.m7.1a"><mrow id="alg1.l0.m7.1b"><mmultiscripts id="alg1.l0.m7.1.2" xref="alg1.l0.m7.1.2.cmml"><mi id="alg1.l0.m7.1.2.2" xref="alg1.l0.m7.1.2.2.cmml">y</mi><mprescripts id="alg1.l0.m7.1.2a" xref="alg1.l0.m7.1.2.cmml"></mprescripts><none id="alg1.l0.m7.1.2b" xref="alg1.l0.m7.1.2.cmml"></none><mrow id="alg1.l0.m7.1.1.1.3" xref="alg1.l0.m7.1.2.cmml"><mo stretchy="false" id="alg1.l0.m7.1.1.1.3.1" xref="alg1.l0.m7.1.2.cmml">(</mo><mi id="alg1.l0.m7.1.1.1.1" xref="alg1.l0.m7.1.1.1.1.cmml">m</mi><mo stretchy="false" id="alg1.l0.m7.1.1.1.3.2" xref="alg1.l0.m7.1.2.cmml">)</mo></mrow></mmultiscripts><mo stretchy="false" id="alg1.l0.m7.1.3" xref="alg1.l0.m7.1.3.cmml">}</mo><msub id="alg1.l0.m7.1.4" xref="alg1.l0.m7.1.4.cmml"><mi id="alg1.l0.m7.1.4a" xref="alg1.l0.m7.1.4.cmml"></mi><mrow id="alg1.l0.m7.1.4.1" xref="alg1.l0.m7.1.4.1.cmml"><mi id="alg1.l0.m7.1.4.1.2" xref="alg1.l0.m7.1.4.1.2.cmml">m</mi><mo id="alg1.l0.m7.1.4.1.1" xref="alg1.l0.m7.1.4.1.1.cmml">=</mo><mn id="alg1.l0.m7.1.4.1.3" xref="alg1.l0.m7.1.4.1.3.cmml">1</mn></mrow></msub><msup id="alg1.l0.m7.1.5" xref="alg1.l0.m7.1.5.cmml"><mi id="alg1.l0.m7.1.5a" xref="alg1.l0.m7.1.5.cmml"></mi><msub id="alg1.l0.m7.1.5.1" xref="alg1.l0.m7.1.5.1.cmml"><mi id="alg1.l0.m7.1.5.1.2" xref="alg1.l0.m7.1.5.1.2.cmml">N</mi><mi id="alg1.l0.m7.1.5.1.3" xref="alg1.l0.m7.1.5.1.3.cmml">s</mi></msub></msup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l0.m7.1c"><cerror id="alg1.l0.m7.1d"><csymbol cd="ambiguous" id="alg1.l0.m7.1e">fragments</csymbol><apply id="alg1.l0.m7.1.2.cmml" xref="alg1.l0.m7.1.2"><csymbol cd="ambiguous" id="alg1.l0.m7.1.2.1.cmml" xref="alg1.l0.m7.1.2">superscript</csymbol><ci id="alg1.l0.m7.1.2.2.cmml" xref="alg1.l0.m7.1.2.2">𝑦</ci><ci id="alg1.l0.m7.1.1.1.1.cmml" xref="alg1.l0.m7.1.1.1.1">𝑚</ci></apply><ci id="alg1.l0.m7.1.3.cmml" xref="alg1.l0.m7.1.3">}</ci><apply id="alg1.l0.m7.1.4.cmml" xref="alg1.l0.m7.1.4"><apply id="alg1.l0.m7.1.4.1.cmml" xref="alg1.l0.m7.1.4.1"><eq id="alg1.l0.m7.1.4.1.1.cmml" xref="alg1.l0.m7.1.4.1.1"></eq><ci id="alg1.l0.m7.1.4.1.2.cmml" xref="alg1.l0.m7.1.4.1.2">𝑚</ci><cn type="integer" id="alg1.l0.m7.1.4.1.3.cmml" xref="alg1.l0.m7.1.4.1.3">1</cn></apply></apply><apply id="alg1.l0.m7.1.5.cmml" xref="alg1.l0.m7.1.5"><apply id="alg1.l0.m7.1.5.1.cmml" xref="alg1.l0.m7.1.5.1"><csymbol cd="ambiguous" id="alg1.l0.m7.1.5.1.1.cmml" xref="alg1.l0.m7.1.5.1">subscript</csymbol><ci id="alg1.l0.m7.1.5.1.2.cmml" xref="alg1.l0.m7.1.5.1.2">𝑁</ci><ci id="alg1.l0.m7.1.5.1.3.cmml" xref="alg1.l0.m7.1.5.1.3">𝑠</ci></apply></apply></cerror></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m7.1f">\prescript{(m)}{}{y}\}_{m=1}^{N_{s}}</annotation><annotation encoding="application/x-llamapun" id="alg1.l0.m7.1g">start_FLOATSUPERSCRIPT ( italic_m ) end_FLOATSUPERSCRIPT italic_y } start_POSTSUBSCRIPT italic_m = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>, <math id="alg1.l0.m8.1" class="ltx_Math" alttext="EPOCH" display="inline"><semantics id="alg1.l0.m8.1a"><mrow id="alg1.l0.m8.1.1" xref="alg1.l0.m8.1.1.cmml"><mi id="alg1.l0.m8.1.1.2" xref="alg1.l0.m8.1.1.2.cmml">E</mi><mo id="alg1.l0.m8.1.1.1" xref="alg1.l0.m8.1.1.1.cmml">⁢</mo><mi id="alg1.l0.m8.1.1.3" xref="alg1.l0.m8.1.1.3.cmml">P</mi><mo id="alg1.l0.m8.1.1.1a" xref="alg1.l0.m8.1.1.1.cmml">⁢</mo><mi id="alg1.l0.m8.1.1.4" xref="alg1.l0.m8.1.1.4.cmml">O</mi><mo id="alg1.l0.m8.1.1.1b" xref="alg1.l0.m8.1.1.1.cmml">⁢</mo><mi id="alg1.l0.m8.1.1.5" xref="alg1.l0.m8.1.1.5.cmml">C</mi><mo id="alg1.l0.m8.1.1.1c" xref="alg1.l0.m8.1.1.1.cmml">⁢</mo><mi id="alg1.l0.m8.1.1.6" xref="alg1.l0.m8.1.1.6.cmml">H</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l0.m8.1b"><apply id="alg1.l0.m8.1.1.cmml" xref="alg1.l0.m8.1.1"><times id="alg1.l0.m8.1.1.1.cmml" xref="alg1.l0.m8.1.1.1"></times><ci id="alg1.l0.m8.1.1.2.cmml" xref="alg1.l0.m8.1.1.2">𝐸</ci><ci id="alg1.l0.m8.1.1.3.cmml" xref="alg1.l0.m8.1.1.3">𝑃</ci><ci id="alg1.l0.m8.1.1.4.cmml" xref="alg1.l0.m8.1.1.4">𝑂</ci><ci id="alg1.l0.m8.1.1.5.cmml" xref="alg1.l0.m8.1.1.5">𝐶</ci><ci id="alg1.l0.m8.1.1.6.cmml" xref="alg1.l0.m8.1.1.6">𝐻</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m8.1c">EPOCH</annotation><annotation encoding="application/x-llamapun" id="alg1.l0.m8.1d">italic_E italic_P italic_O italic_C italic_H</annotation></semantics></math>, number of QSALs <math id="alg1.l0.m9.1" class="ltx_Math" alttext="L" display="inline"><semantics id="alg1.l0.m9.1a"><mi id="alg1.l0.m9.1.1" xref="alg1.l0.m9.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="alg1.l0.m9.1b"><ci id="alg1.l0.m9.1.1.cmml" xref="alg1.l0.m9.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m9.1c">L</annotation><annotation encoding="application/x-llamapun" id="alg1.l0.m9.1d">italic_L</annotation></semantics></math> and optimization procedure

</div>
<div id="alg1.l0a" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l0a.1.1.1" class="ltx_text" style="font-size:80%;">0:</span></span>  The final ansatz parameters <math id="alg1.l0a.m1.1" class="ltx_Math" alttext="\Theta^{*}" display="inline"><semantics id="alg1.l0a.m1.1a"><msup id="alg1.l0a.m1.1.1" xref="alg1.l0a.m1.1.1.cmml"><mi mathvariant="normal" id="alg1.l0a.m1.1.1.2" xref="alg1.l0a.m1.1.1.2.cmml">Θ</mi><mo id="alg1.l0a.m1.1.1.3" xref="alg1.l0a.m1.1.1.3.cmml">*</mo></msup><annotation-xml encoding="MathML-Content" id="alg1.l0a.m1.1b"><apply id="alg1.l0a.m1.1.1.cmml" xref="alg1.l0a.m1.1.1"><csymbol cd="ambiguous" id="alg1.l0a.m1.1.1.1.cmml" xref="alg1.l0a.m1.1.1">superscript</csymbol><ci id="alg1.l0a.m1.1.1.2.cmml" xref="alg1.l0a.m1.1.1.2">Θ</ci><times id="alg1.l0a.m1.1.1.3.cmml" xref="alg1.l0a.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0a.m1.1c">\Theta^{*}</annotation><annotation encoding="application/x-llamapun" id="alg1.l0a.m1.1d">roman_Θ start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT</annotation></semantics></math>, weight <math id="alg1.l0a.m2.2" class="ltx_Math" alttext="\bm{w}^{*},b^{*}" display="inline"><semantics id="alg1.l0a.m2.2a"><mrow id="alg1.l0a.m2.2.2.2" xref="alg1.l0a.m2.2.2.3.cmml"><msup id="alg1.l0a.m2.1.1.1.1" xref="alg1.l0a.m2.1.1.1.1.cmml"><mi id="alg1.l0a.m2.1.1.1.1.2" xref="alg1.l0a.m2.1.1.1.1.2.cmml">𝒘</mi><mo id="alg1.l0a.m2.1.1.1.1.3" xref="alg1.l0a.m2.1.1.1.1.3.cmml">*</mo></msup><mo id="alg1.l0a.m2.2.2.2.3" xref="alg1.l0a.m2.2.2.3.cmml">,</mo><msup id="alg1.l0a.m2.2.2.2.2" xref="alg1.l0a.m2.2.2.2.2.cmml"><mi id="alg1.l0a.m2.2.2.2.2.2" xref="alg1.l0a.m2.2.2.2.2.2.cmml">b</mi><mo id="alg1.l0a.m2.2.2.2.2.3" xref="alg1.l0a.m2.2.2.2.2.3.cmml">*</mo></msup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l0a.m2.2b"><list id="alg1.l0a.m2.2.2.3.cmml" xref="alg1.l0a.m2.2.2.2"><apply id="alg1.l0a.m2.1.1.1.1.cmml" xref="alg1.l0a.m2.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l0a.m2.1.1.1.1.1.cmml" xref="alg1.l0a.m2.1.1.1.1">superscript</csymbol><ci id="alg1.l0a.m2.1.1.1.1.2.cmml" xref="alg1.l0a.m2.1.1.1.1.2">𝒘</ci><times id="alg1.l0a.m2.1.1.1.1.3.cmml" xref="alg1.l0a.m2.1.1.1.1.3"></times></apply><apply id="alg1.l0a.m2.2.2.2.2.cmml" xref="alg1.l0a.m2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l0a.m2.2.2.2.2.1.cmml" xref="alg1.l0a.m2.2.2.2.2">superscript</csymbol><ci id="alg1.l0a.m2.2.2.2.2.2.cmml" xref="alg1.l0a.m2.2.2.2.2.2">𝑏</ci><times id="alg1.l0a.m2.2.2.2.2.3.cmml" xref="alg1.l0a.m2.2.2.2.2.3"></times></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0a.m2.2c">\bm{w}^{*},b^{*}</annotation><annotation encoding="application/x-llamapun" id="alg1.l0a.m2.2d">bold_italic_w start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT , italic_b start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT</annotation></semantics></math>

</div>
<div id="alg1.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l1.1.1.1" class="ltx_text" style="font-size:80%;">1:</span></span>  Initialize the ansatz parameters <math id="alg1.l1.m1.1" class="ltx_Math" alttext="\Theta" display="inline"><semantics id="alg1.l1.m1.1a"><mi mathvariant="normal" id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml">Θ</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><ci id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1">Θ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">\Theta</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m1.1d">roman_Θ</annotation></semantics></math>, weight <math id="alg1.l1.m2.1" class="ltx_Math" alttext="\bm{w}" display="inline"><semantics id="alg1.l1.m2.1a"><mi id="alg1.l1.m2.1.1" xref="alg1.l1.m2.1.1.cmml">𝒘</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m2.1b"><ci id="alg1.l1.m2.1.1.cmml" xref="alg1.l1.m2.1.1">𝒘</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m2.1c">\bm{w}</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m2.1d">bold_italic_w</annotation></semantics></math> from Gaussian distribution <math id="alg1.l1.m3.2" class="ltx_Math" alttext="\mathcal{N}(0,0.01)" display="inline"><semantics id="alg1.l1.m3.2a"><mrow id="alg1.l1.m3.2.3" xref="alg1.l1.m3.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l1.m3.2.3.2" xref="alg1.l1.m3.2.3.2.cmml">𝒩</mi><mo id="alg1.l1.m3.2.3.1" xref="alg1.l1.m3.2.3.1.cmml">⁢</mo><mrow id="alg1.l1.m3.2.3.3.2" xref="alg1.l1.m3.2.3.3.1.cmml"><mo stretchy="false" id="alg1.l1.m3.2.3.3.2.1" xref="alg1.l1.m3.2.3.3.1.cmml">(</mo><mn id="alg1.l1.m3.1.1" xref="alg1.l1.m3.1.1.cmml">0</mn><mo id="alg1.l1.m3.2.3.3.2.2" xref="alg1.l1.m3.2.3.3.1.cmml">,</mo><mn id="alg1.l1.m3.2.2" xref="alg1.l1.m3.2.2.cmml">0.01</mn><mo stretchy="false" id="alg1.l1.m3.2.3.3.2.3" xref="alg1.l1.m3.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m3.2b"><apply id="alg1.l1.m3.2.3.cmml" xref="alg1.l1.m3.2.3"><times id="alg1.l1.m3.2.3.1.cmml" xref="alg1.l1.m3.2.3.1"></times><ci id="alg1.l1.m3.2.3.2.cmml" xref="alg1.l1.m3.2.3.2">𝒩</ci><interval closure="open" id="alg1.l1.m3.2.3.3.1.cmml" xref="alg1.l1.m3.2.3.3.2"><cn type="integer" id="alg1.l1.m3.1.1.cmml" xref="alg1.l1.m3.1.1">0</cn><cn type="float" id="alg1.l1.m3.2.2.cmml" xref="alg1.l1.m3.2.2">0.01</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m3.2c">\mathcal{N}(0,0.01)</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m3.2d">caligraphic_N ( 0 , 0.01 )</annotation></semantics></math> and the bias <math id="alg1.l1.m4.1" class="ltx_Math" alttext="b" display="inline"><semantics id="alg1.l1.m4.1a"><mi id="alg1.l1.m4.1.1" xref="alg1.l1.m4.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m4.1b"><ci id="alg1.l1.m4.1.1.cmml" xref="alg1.l1.m4.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m4.1c">b</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m4.1d">italic_b</annotation></semantics></math> to 0.

</div>
<div id="alg1.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l2.1.1.1" class="ltx_text" style="font-size:80%;">2:</span></span>  <span id="alg1.l2.2" class="ltx_text ltx_font_bold">for</span> <math id="alg1.l2.m1.3" class="ltx_Math" alttext="ep=1,\dots,EPOCH" display="inline"><semantics id="alg1.l2.m1.3a"><mrow id="alg1.l2.m1.3.3" xref="alg1.l2.m1.3.3.cmml"><mrow id="alg1.l2.m1.3.3.3" xref="alg1.l2.m1.3.3.3.cmml"><mi id="alg1.l2.m1.3.3.3.2" xref="alg1.l2.m1.3.3.3.2.cmml">e</mi><mo id="alg1.l2.m1.3.3.3.1" xref="alg1.l2.m1.3.3.3.1.cmml">⁢</mo><mi id="alg1.l2.m1.3.3.3.3" xref="alg1.l2.m1.3.3.3.3.cmml">p</mi></mrow><mo id="alg1.l2.m1.3.3.2" xref="alg1.l2.m1.3.3.2.cmml">=</mo><mrow id="alg1.l2.m1.3.3.1.1" xref="alg1.l2.m1.3.3.1.2.cmml"><mn id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml">1</mn><mo id="alg1.l2.m1.3.3.1.1.2" xref="alg1.l2.m1.3.3.1.2.cmml">,</mo><mi mathvariant="normal" id="alg1.l2.m1.2.2" xref="alg1.l2.m1.2.2.cmml">…</mi><mo id="alg1.l2.m1.3.3.1.1.3" xref="alg1.l2.m1.3.3.1.2.cmml">,</mo><mrow id="alg1.l2.m1.3.3.1.1.1" xref="alg1.l2.m1.3.3.1.1.1.cmml"><mi id="alg1.l2.m1.3.3.1.1.1.2" xref="alg1.l2.m1.3.3.1.1.1.2.cmml">E</mi><mo id="alg1.l2.m1.3.3.1.1.1.1" xref="alg1.l2.m1.3.3.1.1.1.1.cmml">⁢</mo><mi id="alg1.l2.m1.3.3.1.1.1.3" xref="alg1.l2.m1.3.3.1.1.1.3.cmml">P</mi><mo id="alg1.l2.m1.3.3.1.1.1.1a" xref="alg1.l2.m1.3.3.1.1.1.1.cmml">⁢</mo><mi id="alg1.l2.m1.3.3.1.1.1.4" xref="alg1.l2.m1.3.3.1.1.1.4.cmml">O</mi><mo id="alg1.l2.m1.3.3.1.1.1.1b" xref="alg1.l2.m1.3.3.1.1.1.1.cmml">⁢</mo><mi id="alg1.l2.m1.3.3.1.1.1.5" xref="alg1.l2.m1.3.3.1.1.1.5.cmml">C</mi><mo id="alg1.l2.m1.3.3.1.1.1.1c" xref="alg1.l2.m1.3.3.1.1.1.1.cmml">⁢</mo><mi id="alg1.l2.m1.3.3.1.1.1.6" xref="alg1.l2.m1.3.3.1.1.1.6.cmml">H</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.3b"><apply id="alg1.l2.m1.3.3.cmml" xref="alg1.l2.m1.3.3"><eq id="alg1.l2.m1.3.3.2.cmml" xref="alg1.l2.m1.3.3.2"></eq><apply id="alg1.l2.m1.3.3.3.cmml" xref="alg1.l2.m1.3.3.3"><times id="alg1.l2.m1.3.3.3.1.cmml" xref="alg1.l2.m1.3.3.3.1"></times><ci id="alg1.l2.m1.3.3.3.2.cmml" xref="alg1.l2.m1.3.3.3.2">𝑒</ci><ci id="alg1.l2.m1.3.3.3.3.cmml" xref="alg1.l2.m1.3.3.3.3">𝑝</ci></apply><list id="alg1.l2.m1.3.3.1.2.cmml" xref="alg1.l2.m1.3.3.1.1"><cn type="integer" id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1">1</cn><ci id="alg1.l2.m1.2.2.cmml" xref="alg1.l2.m1.2.2">…</ci><apply id="alg1.l2.m1.3.3.1.1.1.cmml" xref="alg1.l2.m1.3.3.1.1.1"><times id="alg1.l2.m1.3.3.1.1.1.1.cmml" xref="alg1.l2.m1.3.3.1.1.1.1"></times><ci id="alg1.l2.m1.3.3.1.1.1.2.cmml" xref="alg1.l2.m1.3.3.1.1.1.2">𝐸</ci><ci id="alg1.l2.m1.3.3.1.1.1.3.cmml" xref="alg1.l2.m1.3.3.1.1.1.3">𝑃</ci><ci id="alg1.l2.m1.3.3.1.1.1.4.cmml" xref="alg1.l2.m1.3.3.1.1.1.4">𝑂</ci><ci id="alg1.l2.m1.3.3.1.1.1.5.cmml" xref="alg1.l2.m1.3.3.1.1.1.5">𝐶</ci><ci id="alg1.l2.m1.3.3.1.1.1.6.cmml" xref="alg1.l2.m1.3.3.1.1.1.6">𝐻</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.3c">ep=1,\dots,EPOCH</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m1.3d">italic_e italic_p = 1 , … , italic_E italic_P italic_O italic_C italic_H</annotation></semantics></math> <span id="alg1.l2.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l3.1.1.1" class="ltx_text" style="font-size:80%;">3:</span></span>     <span id="alg1.l3.2" class="ltx_text ltx_font_bold">for</span> <math id="alg1.l3.m1.3" class="ltx_Math" alttext="m=1,\ldots,N_{s}" display="inline"><semantics id="alg1.l3.m1.3a"><mrow id="alg1.l3.m1.3.3" xref="alg1.l3.m1.3.3.cmml"><mi id="alg1.l3.m1.3.3.3" xref="alg1.l3.m1.3.3.3.cmml">m</mi><mo id="alg1.l3.m1.3.3.2" xref="alg1.l3.m1.3.3.2.cmml">=</mo><mrow id="alg1.l3.m1.3.3.1.1" xref="alg1.l3.m1.3.3.1.2.cmml"><mn id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml">1</mn><mo id="alg1.l3.m1.3.3.1.1.2" xref="alg1.l3.m1.3.3.1.2.cmml">,</mo><mi mathvariant="normal" id="alg1.l3.m1.2.2" xref="alg1.l3.m1.2.2.cmml">…</mi><mo id="alg1.l3.m1.3.3.1.1.3" xref="alg1.l3.m1.3.3.1.2.cmml">,</mo><msub id="alg1.l3.m1.3.3.1.1.1" xref="alg1.l3.m1.3.3.1.1.1.cmml"><mi id="alg1.l3.m1.3.3.1.1.1.2" xref="alg1.l3.m1.3.3.1.1.1.2.cmml">N</mi><mi id="alg1.l3.m1.3.3.1.1.1.3" xref="alg1.l3.m1.3.3.1.1.1.3.cmml">s</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.3b"><apply id="alg1.l3.m1.3.3.cmml" xref="alg1.l3.m1.3.3"><eq id="alg1.l3.m1.3.3.2.cmml" xref="alg1.l3.m1.3.3.2"></eq><ci id="alg1.l3.m1.3.3.3.cmml" xref="alg1.l3.m1.3.3.3">𝑚</ci><list id="alg1.l3.m1.3.3.1.2.cmml" xref="alg1.l3.m1.3.3.1.1"><cn type="integer" id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1">1</cn><ci id="alg1.l3.m1.2.2.cmml" xref="alg1.l3.m1.2.2">…</ci><apply id="alg1.l3.m1.3.3.1.1.1.cmml" xref="alg1.l3.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="alg1.l3.m1.3.3.1.1.1.1.cmml" xref="alg1.l3.m1.3.3.1.1.1">subscript</csymbol><ci id="alg1.l3.m1.3.3.1.1.1.2.cmml" xref="alg1.l3.m1.3.3.1.1.1.2">𝑁</ci><ci id="alg1.l3.m1.3.3.1.1.1.3.cmml" xref="alg1.l3.m1.3.3.1.1.1.3">𝑠</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.3c">m=1,\ldots,N_{s}</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m1.3d">italic_m = 1 , … , italic_N start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> <span id="alg1.l3.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l4.1.1.1" class="ltx_text" style="font-size:80%;">4:</span></span>        Apply the encoder ansatz <math id="alg1.l4.m1.1" class="ltx_Math" alttext="U_{enc}" display="inline"><semantics id="alg1.l4.m1.1a"><msub id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml"><mi id="alg1.l4.m1.1.1.2" xref="alg1.l4.m1.1.1.2.cmml">U</mi><mrow id="alg1.l4.m1.1.1.3" xref="alg1.l4.m1.1.1.3.cmml"><mi id="alg1.l4.m1.1.1.3.2" xref="alg1.l4.m1.1.1.3.2.cmml">e</mi><mo id="alg1.l4.m1.1.1.3.1" xref="alg1.l4.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l4.m1.1.1.3.3" xref="alg1.l4.m1.1.1.3.3.cmml">n</mi><mo id="alg1.l4.m1.1.1.3.1a" xref="alg1.l4.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l4.m1.1.1.3.4" xref="alg1.l4.m1.1.1.3.4.cmml">c</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><apply id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1"><csymbol cd="ambiguous" id="alg1.l4.m1.1.1.1.cmml" xref="alg1.l4.m1.1.1">subscript</csymbol><ci id="alg1.l4.m1.1.1.2.cmml" xref="alg1.l4.m1.1.1.2">𝑈</ci><apply id="alg1.l4.m1.1.1.3.cmml" xref="alg1.l4.m1.1.1.3"><times id="alg1.l4.m1.1.1.3.1.cmml" xref="alg1.l4.m1.1.1.3.1"></times><ci id="alg1.l4.m1.1.1.3.2.cmml" xref="alg1.l4.m1.1.1.3.2">𝑒</ci><ci id="alg1.l4.m1.1.1.3.3.cmml" xref="alg1.l4.m1.1.1.3.3">𝑛</ci><ci id="alg1.l4.m1.1.1.3.4.cmml" xref="alg1.l4.m1.1.1.3.4">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">U_{enc}</annotation><annotation encoding="application/x-llamapun" id="alg1.l4.m1.1d">italic_U start_POSTSUBSCRIPT italic_e italic_n italic_c end_POSTSUBSCRIPT</annotation></semantics></math> to each of <math id="alg1.l4.m2.1" class="ltx_Math" alttext="\prescript{(m)}{}{\bm{x}_{s}}" display="inline"><semantics id="alg1.l4.m2.1a"><mmultiscripts id="alg1.l4.m2.1.2" xref="alg1.l4.m2.1.2.cmml"><mi id="alg1.l4.m2.1.2.2.2" xref="alg1.l4.m2.1.2.2.2.cmml">𝒙</mi><mi id="alg1.l4.m2.1.2.2.3" xref="alg1.l4.m2.1.2.2.3.cmml">s</mi><none id="alg1.l4.m2.1.2a" xref="alg1.l4.m2.1.2.cmml"></none><mprescripts id="alg1.l4.m2.1.2b" xref="alg1.l4.m2.1.2.cmml"></mprescripts><none id="alg1.l4.m2.1.2c" xref="alg1.l4.m2.1.2.cmml"></none><mrow id="alg1.l4.m2.1.1.1.3" xref="alg1.l4.m2.1.2.cmml"><mo stretchy="false" id="alg1.l4.m2.1.1.1.3.1" xref="alg1.l4.m2.1.2.cmml">(</mo><mi id="alg1.l4.m2.1.1.1.1" xref="alg1.l4.m2.1.1.1.1.cmml">m</mi><mo stretchy="false" id="alg1.l4.m2.1.1.1.3.2" xref="alg1.l4.m2.1.2.cmml">)</mo></mrow></mmultiscripts><annotation-xml encoding="MathML-Content" id="alg1.l4.m2.1b"><apply id="alg1.l4.m2.1.2.cmml" xref="alg1.l4.m2.1.2"><csymbol cd="ambiguous" id="alg1.l4.m2.1.2.1.cmml" xref="alg1.l4.m2.1.2">superscript</csymbol><apply id="alg1.l4.m2.1.2.2.cmml" xref="alg1.l4.m2.1.2"><csymbol cd="ambiguous" id="alg1.l4.m2.1.2.2.1.cmml" xref="alg1.l4.m2.1.2">subscript</csymbol><ci id="alg1.l4.m2.1.2.2.2.cmml" xref="alg1.l4.m2.1.2.2.2">𝒙</ci><ci id="alg1.l4.m2.1.2.2.3.cmml" xref="alg1.l4.m2.1.2.2.3">𝑠</ci></apply><ci id="alg1.l4.m2.1.1.1.1.cmml" xref="alg1.l4.m2.1.1.1.1">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m2.1c">\prescript{(m)}{}{\bm{x}_{s}}</annotation><annotation encoding="application/x-llamapun" id="alg1.l4.m2.1d">start_FLOATSUPERSCRIPT ( italic_m ) end_FLOATSUPERSCRIPT bold_italic_x start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> to get the corresponding quantum state <math id="alg1.l4.m3.1" class="ltx_Math" alttext="\ket{\psi_{s}}" display="inline"><semantics id="alg1.l4.m3.1a"><mrow id="alg1.l4.m3.1.1" xref="alg1.l4.m3.1.1.cmml"><merror class="ltx_ERROR undefined undefined" id="alg1.l4.m3.1.1.2" xref="alg1.l4.m3.1.1.2b.cmml"><mtext id="alg1.l4.m3.1.1.2a" xref="alg1.l4.m3.1.1.2b.cmml">\ket</mtext></merror><mo id="alg1.l4.m3.1.1.1" xref="alg1.l4.m3.1.1.1.cmml">⁢</mo><msub id="alg1.l4.m3.1.1.3" xref="alg1.l4.m3.1.1.3.cmml"><mi id="alg1.l4.m3.1.1.3.2" xref="alg1.l4.m3.1.1.3.2.cmml">ψ</mi><mi id="alg1.l4.m3.1.1.3.3" xref="alg1.l4.m3.1.1.3.3.cmml">s</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m3.1b"><apply id="alg1.l4.m3.1.1.cmml" xref="alg1.l4.m3.1.1"><times id="alg1.l4.m3.1.1.1.cmml" xref="alg1.l4.m3.1.1.1"></times><ci id="alg1.l4.m3.1.1.2b.cmml" xref="alg1.l4.m3.1.1.2"><merror class="ltx_ERROR undefined undefined" id="alg1.l4.m3.1.1.2.cmml" xref="alg1.l4.m3.1.1.2"><mtext id="alg1.l4.m3.1.1.2a.cmml" xref="alg1.l4.m3.1.1.2">\ket</mtext></merror></ci><apply id="alg1.l4.m3.1.1.3.cmml" xref="alg1.l4.m3.1.1.3"><csymbol cd="ambiguous" id="alg1.l4.m3.1.1.3.1.cmml" xref="alg1.l4.m3.1.1.3">subscript</csymbol><ci id="alg1.l4.m3.1.1.3.2.cmml" xref="alg1.l4.m3.1.1.3.2">𝜓</ci><ci id="alg1.l4.m3.1.1.3.3.cmml" xref="alg1.l4.m3.1.1.3.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m3.1c">\ket{\psi_{s}}</annotation><annotation encoding="application/x-llamapun" id="alg1.l4.m3.1d">italic_ψ start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math>, cf. (<a href="#S2.E11" title="(11) ‣ 2.1 Quantum Self-Attention Layer ‣ 2 Method ‣ Quantum Self-Attention Neural Networks for Text Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">11</span></a>).

</div>
<div id="alg1.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l5.1.1.1" class="ltx_text" style="font-size:80%;">5:</span></span>        Apply <math id="alg1.l5.m1.1" class="ltx_Math" alttext="U_{q}" display="inline"><semantics id="alg1.l5.m1.1a"><msub id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml"><mi id="alg1.l5.m1.1.1.2" xref="alg1.l5.m1.1.1.2.cmml">U</mi><mi id="alg1.l5.m1.1.1.3" xref="alg1.l5.m1.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><apply id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.1.cmml" xref="alg1.l5.m1.1.1">subscript</csymbol><ci id="alg1.l5.m1.1.1.2.cmml" xref="alg1.l5.m1.1.1.2">𝑈</ci><ci id="alg1.l5.m1.1.1.3.cmml" xref="alg1.l5.m1.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">U_{q}</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.m1.1d">italic_U start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math> and <math id="alg1.l5.m2.1" class="ltx_Math" alttext="U_{k}" display="inline"><semantics id="alg1.l5.m2.1a"><msub id="alg1.l5.m2.1.1" xref="alg1.l5.m2.1.1.cmml"><mi id="alg1.l5.m2.1.1.2" xref="alg1.l5.m2.1.1.2.cmml">U</mi><mi id="alg1.l5.m2.1.1.3" xref="alg1.l5.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l5.m2.1b"><apply id="alg1.l5.m2.1.1.cmml" xref="alg1.l5.m2.1.1"><csymbol cd="ambiguous" id="alg1.l5.m2.1.1.1.cmml" xref="alg1.l5.m2.1.1">subscript</csymbol><ci id="alg1.l5.m2.1.1.2.cmml" xref="alg1.l5.m2.1.1.2">𝑈</ci><ci id="alg1.l5.m2.1.1.3.cmml" xref="alg1.l5.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m2.1c">U_{k}</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.m2.1d">italic_U start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> to <math id="alg1.l5.m3.1" class="ltx_Math" alttext="\ket{\psi_{s}}" display="inline"><semantics id="alg1.l5.m3.1a"><mrow id="alg1.l5.m3.1.1" xref="alg1.l5.m3.1.1.cmml"><merror class="ltx_ERROR undefined undefined" id="alg1.l5.m3.1.1.2" xref="alg1.l5.m3.1.1.2b.cmml"><mtext id="alg1.l5.m3.1.1.2a" xref="alg1.l5.m3.1.1.2b.cmml">\ket</mtext></merror><mo id="alg1.l5.m3.1.1.1" xref="alg1.l5.m3.1.1.1.cmml">⁢</mo><msub id="alg1.l5.m3.1.1.3" xref="alg1.l5.m3.1.1.3.cmml"><mi id="alg1.l5.m3.1.1.3.2" xref="alg1.l5.m3.1.1.3.2.cmml">ψ</mi><mi id="alg1.l5.m3.1.1.3.3" xref="alg1.l5.m3.1.1.3.3.cmml">s</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m3.1b"><apply id="alg1.l5.m3.1.1.cmml" xref="alg1.l5.m3.1.1"><times id="alg1.l5.m3.1.1.1.cmml" xref="alg1.l5.m3.1.1.1"></times><ci id="alg1.l5.m3.1.1.2b.cmml" xref="alg1.l5.m3.1.1.2"><merror class="ltx_ERROR undefined undefined" id="alg1.l5.m3.1.1.2.cmml" xref="alg1.l5.m3.1.1.2"><mtext id="alg1.l5.m3.1.1.2a.cmml" xref="alg1.l5.m3.1.1.2">\ket</mtext></merror></ci><apply id="alg1.l5.m3.1.1.3.cmml" xref="alg1.l5.m3.1.1.3"><csymbol cd="ambiguous" id="alg1.l5.m3.1.1.3.1.cmml" xref="alg1.l5.m3.1.1.3">subscript</csymbol><ci id="alg1.l5.m3.1.1.3.2.cmml" xref="alg1.l5.m3.1.1.3.2">𝜓</ci><ci id="alg1.l5.m3.1.1.3.3.cmml" xref="alg1.l5.m3.1.1.3.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m3.1c">\ket{\psi_{s}}</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.m3.1d">italic_ψ start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> and measure the Pauli-Z expectations to get <math id="alg1.l5.m4.2" class="ltx_Math" alttext="\langle Z_{q}\rangle_{s},\langle Z_{k}\rangle_{s}" display="inline"><semantics id="alg1.l5.m4.2a"><mrow id="alg1.l5.m4.2.2.2" xref="alg1.l5.m4.2.2.3.cmml"><msub id="alg1.l5.m4.1.1.1.1" xref="alg1.l5.m4.1.1.1.1.cmml"><mrow id="alg1.l5.m4.1.1.1.1.1.1" xref="alg1.l5.m4.1.1.1.1.1.2.cmml"><mo stretchy="false" id="alg1.l5.m4.1.1.1.1.1.1.2" xref="alg1.l5.m4.1.1.1.1.1.2.1.cmml">⟨</mo><msub id="alg1.l5.m4.1.1.1.1.1.1.1" xref="alg1.l5.m4.1.1.1.1.1.1.1.cmml"><mi id="alg1.l5.m4.1.1.1.1.1.1.1.2" xref="alg1.l5.m4.1.1.1.1.1.1.1.2.cmml">Z</mi><mi id="alg1.l5.m4.1.1.1.1.1.1.1.3" xref="alg1.l5.m4.1.1.1.1.1.1.1.3.cmml">q</mi></msub><mo stretchy="false" id="alg1.l5.m4.1.1.1.1.1.1.3" xref="alg1.l5.m4.1.1.1.1.1.2.1.cmml">⟩</mo></mrow><mi id="alg1.l5.m4.1.1.1.1.3" xref="alg1.l5.m4.1.1.1.1.3.cmml">s</mi></msub><mo id="alg1.l5.m4.2.2.2.3" xref="alg1.l5.m4.2.2.3.cmml">,</mo><msub id="alg1.l5.m4.2.2.2.2" xref="alg1.l5.m4.2.2.2.2.cmml"><mrow id="alg1.l5.m4.2.2.2.2.1.1" xref="alg1.l5.m4.2.2.2.2.1.2.cmml"><mo stretchy="false" id="alg1.l5.m4.2.2.2.2.1.1.2" xref="alg1.l5.m4.2.2.2.2.1.2.1.cmml">⟨</mo><msub id="alg1.l5.m4.2.2.2.2.1.1.1" xref="alg1.l5.m4.2.2.2.2.1.1.1.cmml"><mi id="alg1.l5.m4.2.2.2.2.1.1.1.2" xref="alg1.l5.m4.2.2.2.2.1.1.1.2.cmml">Z</mi><mi id="alg1.l5.m4.2.2.2.2.1.1.1.3" xref="alg1.l5.m4.2.2.2.2.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="alg1.l5.m4.2.2.2.2.1.1.3" xref="alg1.l5.m4.2.2.2.2.1.2.1.cmml">⟩</mo></mrow><mi id="alg1.l5.m4.2.2.2.2.3" xref="alg1.l5.m4.2.2.2.2.3.cmml">s</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m4.2b"><list id="alg1.l5.m4.2.2.3.cmml" xref="alg1.l5.m4.2.2.2"><apply id="alg1.l5.m4.1.1.1.1.cmml" xref="alg1.l5.m4.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l5.m4.1.1.1.1.2.cmml" xref="alg1.l5.m4.1.1.1.1">subscript</csymbol><apply id="alg1.l5.m4.1.1.1.1.1.2.cmml" xref="alg1.l5.m4.1.1.1.1.1.1"><csymbol cd="latexml" id="alg1.l5.m4.1.1.1.1.1.2.1.cmml" xref="alg1.l5.m4.1.1.1.1.1.1.2">delimited-⟨⟩</csymbol><apply id="alg1.l5.m4.1.1.1.1.1.1.1.cmml" xref="alg1.l5.m4.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l5.m4.1.1.1.1.1.1.1.1.cmml" xref="alg1.l5.m4.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l5.m4.1.1.1.1.1.1.1.2.cmml" xref="alg1.l5.m4.1.1.1.1.1.1.1.2">𝑍</ci><ci id="alg1.l5.m4.1.1.1.1.1.1.1.3.cmml" xref="alg1.l5.m4.1.1.1.1.1.1.1.3">𝑞</ci></apply></apply><ci id="alg1.l5.m4.1.1.1.1.3.cmml" xref="alg1.l5.m4.1.1.1.1.3">𝑠</ci></apply><apply id="alg1.l5.m4.2.2.2.2.cmml" xref="alg1.l5.m4.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l5.m4.2.2.2.2.2.cmml" xref="alg1.l5.m4.2.2.2.2">subscript</csymbol><apply id="alg1.l5.m4.2.2.2.2.1.2.cmml" xref="alg1.l5.m4.2.2.2.2.1.1"><csymbol cd="latexml" id="alg1.l5.m4.2.2.2.2.1.2.1.cmml" xref="alg1.l5.m4.2.2.2.2.1.1.2">delimited-⟨⟩</csymbol><apply id="alg1.l5.m4.2.2.2.2.1.1.1.cmml" xref="alg1.l5.m4.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="alg1.l5.m4.2.2.2.2.1.1.1.1.cmml" xref="alg1.l5.m4.2.2.2.2.1.1.1">subscript</csymbol><ci id="alg1.l5.m4.2.2.2.2.1.1.1.2.cmml" xref="alg1.l5.m4.2.2.2.2.1.1.1.2">𝑍</ci><ci id="alg1.l5.m4.2.2.2.2.1.1.1.3.cmml" xref="alg1.l5.m4.2.2.2.2.1.1.1.3">𝑘</ci></apply></apply><ci id="alg1.l5.m4.2.2.2.2.3.cmml" xref="alg1.l5.m4.2.2.2.2.3">𝑠</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m4.2c">\langle Z_{q}\rangle_{s},\langle Z_{k}\rangle_{s}</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.m4.2d">⟨ italic_Z start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT ⟩ start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT , ⟨ italic_Z start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ⟩ start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math>, cf. (<a href="#S2.Ex1" title="2.1 Quantum Self-Attention Layer ‣ 2 Method ‣ Quantum Self-Attention Neural Networks for Text Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2.1</span></a>), and then calculate the quantum self-attention coefficients <math id="alg1.l5.m5.2" class="ltx_Math" alttext="\alpha_{s,j}" display="inline"><semantics id="alg1.l5.m5.2a"><msub id="alg1.l5.m5.2.3" xref="alg1.l5.m5.2.3.cmml"><mi id="alg1.l5.m5.2.3.2" xref="alg1.l5.m5.2.3.2.cmml">α</mi><mrow id="alg1.l5.m5.2.2.2.4" xref="alg1.l5.m5.2.2.2.3.cmml"><mi id="alg1.l5.m5.1.1.1.1" xref="alg1.l5.m5.1.1.1.1.cmml">s</mi><mo id="alg1.l5.m5.2.2.2.4.1" xref="alg1.l5.m5.2.2.2.3.cmml">,</mo><mi id="alg1.l5.m5.2.2.2.2" xref="alg1.l5.m5.2.2.2.2.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l5.m5.2b"><apply id="alg1.l5.m5.2.3.cmml" xref="alg1.l5.m5.2.3"><csymbol cd="ambiguous" id="alg1.l5.m5.2.3.1.cmml" xref="alg1.l5.m5.2.3">subscript</csymbol><ci id="alg1.l5.m5.2.3.2.cmml" xref="alg1.l5.m5.2.3.2">𝛼</ci><list id="alg1.l5.m5.2.2.2.3.cmml" xref="alg1.l5.m5.2.2.2.4"><ci id="alg1.l5.m5.1.1.1.1.cmml" xref="alg1.l5.m5.1.1.1.1">𝑠</ci><ci id="alg1.l5.m5.2.2.2.2.cmml" xref="alg1.l5.m5.2.2.2.2">𝑗</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m5.2c">\alpha_{s,j}</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.m5.2d">italic_α start_POSTSUBSCRIPT italic_s , italic_j end_POSTSUBSCRIPT</annotation></semantics></math>, cf. (<a href="#S2.E16" title="(16) ‣ 2.1 Quantum Self-Attention Layer ‣ 2 Method ‣ Quantum Self-Attention Neural Networks for Text Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">16</span></a>).

</div>
<div id="alg1.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l6.1.1.1" class="ltx_text" style="font-size:80%;">6:</span></span>        Apply <math id="alg1.l6.m1.1" class="ltx_Math" alttext="U_{v}" display="inline"><semantics id="alg1.l6.m1.1a"><msub id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml"><mi id="alg1.l6.m1.1.1.2" xref="alg1.l6.m1.1.1.2.cmml">U</mi><mi id="alg1.l6.m1.1.1.3" xref="alg1.l6.m1.1.1.3.cmml">v</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.1b"><apply id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.cmml" xref="alg1.l6.m1.1.1">subscript</csymbol><ci id="alg1.l6.m1.1.1.2.cmml" xref="alg1.l6.m1.1.1.2">𝑈</ci><ci id="alg1.l6.m1.1.1.3.cmml" xref="alg1.l6.m1.1.1.3">𝑣</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.1c">U_{v}</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.m1.1d">italic_U start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT</annotation></semantics></math> and measure a series of Pauli expectations to get <math id="alg1.l6.m2.1" class="ltx_Math" alttext="\bm{o}_{s}" display="inline"><semantics id="alg1.l6.m2.1a"><msub id="alg1.l6.m2.1.1" xref="alg1.l6.m2.1.1.cmml"><mi id="alg1.l6.m2.1.1.2" xref="alg1.l6.m2.1.1.2.cmml">𝒐</mi><mi id="alg1.l6.m2.1.1.3" xref="alg1.l6.m2.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l6.m2.1b"><apply id="alg1.l6.m2.1.1.cmml" xref="alg1.l6.m2.1.1"><csymbol cd="ambiguous" id="alg1.l6.m2.1.1.1.cmml" xref="alg1.l6.m2.1.1">subscript</csymbol><ci id="alg1.l6.m2.1.1.2.cmml" xref="alg1.l6.m2.1.1.2">𝒐</ci><ci id="alg1.l6.m2.1.1.3.cmml" xref="alg1.l6.m2.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m2.1c">\bm{o}_{s}</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.m2.1d">bold_italic_o start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math>, cf. (<a href="#S2.E14" title="(14) ‣ 2.1 Quantum Self-Attention Layer ‣ 2 Method ‣ Quantum Self-Attention Neural Networks for Text Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">14</span></a>), and then compute the output <math id="alg1.l6.m3.2" class="ltx_Math" alttext="\{\bm{y}_{s}^{(l)}\}" display="inline"><semantics id="alg1.l6.m3.2a"><mrow id="alg1.l6.m3.2.2.1" xref="alg1.l6.m3.2.2.2.cmml"><mo stretchy="false" id="alg1.l6.m3.2.2.1.2" xref="alg1.l6.m3.2.2.2.cmml">{</mo><msubsup id="alg1.l6.m3.2.2.1.1" xref="alg1.l6.m3.2.2.1.1.cmml"><mi id="alg1.l6.m3.2.2.1.1.2.2" xref="alg1.l6.m3.2.2.1.1.2.2.cmml">𝒚</mi><mi id="alg1.l6.m3.2.2.1.1.2.3" xref="alg1.l6.m3.2.2.1.1.2.3.cmml">s</mi><mrow id="alg1.l6.m3.1.1.1.3" xref="alg1.l6.m3.2.2.1.1.cmml"><mo stretchy="false" id="alg1.l6.m3.1.1.1.3.1" xref="alg1.l6.m3.2.2.1.1.cmml">(</mo><mi id="alg1.l6.m3.1.1.1.1" xref="alg1.l6.m3.1.1.1.1.cmml">l</mi><mo stretchy="false" id="alg1.l6.m3.1.1.1.3.2" xref="alg1.l6.m3.2.2.1.1.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="alg1.l6.m3.2.2.1.3" xref="alg1.l6.m3.2.2.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m3.2b"><set id="alg1.l6.m3.2.2.2.cmml" xref="alg1.l6.m3.2.2.1"><apply id="alg1.l6.m3.2.2.1.1.cmml" xref="alg1.l6.m3.2.2.1.1"><csymbol cd="ambiguous" id="alg1.l6.m3.2.2.1.1.1.cmml" xref="alg1.l6.m3.2.2.1.1">superscript</csymbol><apply id="alg1.l6.m3.2.2.1.1.2.cmml" xref="alg1.l6.m3.2.2.1.1"><csymbol cd="ambiguous" id="alg1.l6.m3.2.2.1.1.2.1.cmml" xref="alg1.l6.m3.2.2.1.1">subscript</csymbol><ci id="alg1.l6.m3.2.2.1.1.2.2.cmml" xref="alg1.l6.m3.2.2.1.1.2.2">𝒚</ci><ci id="alg1.l6.m3.2.2.1.1.2.3.cmml" xref="alg1.l6.m3.2.2.1.1.2.3">𝑠</ci></apply><ci id="alg1.l6.m3.1.1.1.1.cmml" xref="alg1.l6.m3.1.1.1.1">𝑙</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m3.2c">\{\bm{y}_{s}^{(l)}\}</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.m3.2d">{ bold_italic_y start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT }</annotation></semantics></math> of the <math id="alg1.l6.m4.1" class="ltx_Math" alttext="l" display="inline"><semantics id="alg1.l6.m4.1a"><mi id="alg1.l6.m4.1.1" xref="alg1.l6.m4.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="alg1.l6.m4.1b"><ci id="alg1.l6.m4.1.1.cmml" xref="alg1.l6.m4.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m4.1c">l</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.m4.1d">italic_l</annotation></semantics></math>-th QSAL, cf. (<a href="#S2.E15" title="(15) ‣ 2.1 Quantum Self-Attention Layer ‣ 2 Method ‣ Quantum Self-Attention Neural Networks for Text Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">15</span></a>).

</div>
<div id="alg1.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l7.1.1.1" class="ltx_text" style="font-size:80%;">7:</span></span>        Repeat 4-6 <math id="alg1.l7.m1.1" class="ltx_Math" alttext="L" display="inline"><semantics id="alg1.l7.m1.1a"><mi id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.1b"><ci id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.1c">L</annotation><annotation encoding="application/x-llamapun" id="alg1.l7.m1.1d">italic_L</annotation></semantics></math> times to get the output <math id="alg1.l7.m2.2" class="ltx_Math" alttext="\{\bm{y}_{s}^{(L)}\}" display="inline"><semantics id="alg1.l7.m2.2a"><mrow id="alg1.l7.m2.2.2.1" xref="alg1.l7.m2.2.2.2.cmml"><mo stretchy="false" id="alg1.l7.m2.2.2.1.2" xref="alg1.l7.m2.2.2.2.cmml">{</mo><msubsup id="alg1.l7.m2.2.2.1.1" xref="alg1.l7.m2.2.2.1.1.cmml"><mi id="alg1.l7.m2.2.2.1.1.2.2" xref="alg1.l7.m2.2.2.1.1.2.2.cmml">𝒚</mi><mi id="alg1.l7.m2.2.2.1.1.2.3" xref="alg1.l7.m2.2.2.1.1.2.3.cmml">s</mi><mrow id="alg1.l7.m2.1.1.1.3" xref="alg1.l7.m2.2.2.1.1.cmml"><mo stretchy="false" id="alg1.l7.m2.1.1.1.3.1" xref="alg1.l7.m2.2.2.1.1.cmml">(</mo><mi id="alg1.l7.m2.1.1.1.1" xref="alg1.l7.m2.1.1.1.1.cmml">L</mi><mo stretchy="false" id="alg1.l7.m2.1.1.1.3.2" xref="alg1.l7.m2.2.2.1.1.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="alg1.l7.m2.2.2.1.3" xref="alg1.l7.m2.2.2.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m2.2b"><set id="alg1.l7.m2.2.2.2.cmml" xref="alg1.l7.m2.2.2.1"><apply id="alg1.l7.m2.2.2.1.1.cmml" xref="alg1.l7.m2.2.2.1.1"><csymbol cd="ambiguous" id="alg1.l7.m2.2.2.1.1.1.cmml" xref="alg1.l7.m2.2.2.1.1">superscript</csymbol><apply id="alg1.l7.m2.2.2.1.1.2.cmml" xref="alg1.l7.m2.2.2.1.1"><csymbol cd="ambiguous" id="alg1.l7.m2.2.2.1.1.2.1.cmml" xref="alg1.l7.m2.2.2.1.1">subscript</csymbol><ci id="alg1.l7.m2.2.2.1.1.2.2.cmml" xref="alg1.l7.m2.2.2.1.1.2.2">𝒚</ci><ci id="alg1.l7.m2.2.2.1.1.2.3.cmml" xref="alg1.l7.m2.2.2.1.1.2.3">𝑠</ci></apply><ci id="alg1.l7.m2.1.1.1.1.cmml" xref="alg1.l7.m2.1.1.1.1">𝐿</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m2.2c">\{\bm{y}_{s}^{(L)}\}</annotation><annotation encoding="application/x-llamapun" id="alg1.l7.m2.2d">{ bold_italic_y start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_L ) end_POSTSUPERSCRIPT }</annotation></semantics></math> of the <math id="alg1.l7.m3.1" class="ltx_Math" alttext="L" display="inline"><semantics id="alg1.l7.m3.1a"><mi id="alg1.l7.m3.1.1" xref="alg1.l7.m3.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="alg1.l7.m3.1b"><ci id="alg1.l7.m3.1.1.cmml" xref="alg1.l7.m3.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m3.1c">L</annotation><annotation encoding="application/x-llamapun" id="alg1.l7.m3.1d">italic_L</annotation></semantics></math>-th QSAL.

</div>
<div id="alg1.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l8.1.1.1" class="ltx_text" style="font-size:80%;">8:</span></span>        Average <math id="alg1.l8.m1.2" class="ltx_Math" alttext="\{\bm{y}_{s}^{(L)}\}" display="inline"><semantics id="alg1.l8.m1.2a"><mrow id="alg1.l8.m1.2.2.1" xref="alg1.l8.m1.2.2.2.cmml"><mo stretchy="false" id="alg1.l8.m1.2.2.1.2" xref="alg1.l8.m1.2.2.2.cmml">{</mo><msubsup id="alg1.l8.m1.2.2.1.1" xref="alg1.l8.m1.2.2.1.1.cmml"><mi id="alg1.l8.m1.2.2.1.1.2.2" xref="alg1.l8.m1.2.2.1.1.2.2.cmml">𝒚</mi><mi id="alg1.l8.m1.2.2.1.1.2.3" xref="alg1.l8.m1.2.2.1.1.2.3.cmml">s</mi><mrow id="alg1.l8.m1.1.1.1.3" xref="alg1.l8.m1.2.2.1.1.cmml"><mo stretchy="false" id="alg1.l8.m1.1.1.1.3.1" xref="alg1.l8.m1.2.2.1.1.cmml">(</mo><mi id="alg1.l8.m1.1.1.1.1" xref="alg1.l8.m1.1.1.1.1.cmml">L</mi><mo stretchy="false" id="alg1.l8.m1.1.1.1.3.2" xref="alg1.l8.m1.2.2.1.1.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="alg1.l8.m1.2.2.1.3" xref="alg1.l8.m1.2.2.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.2b"><set id="alg1.l8.m1.2.2.2.cmml" xref="alg1.l8.m1.2.2.1"><apply id="alg1.l8.m1.2.2.1.1.cmml" xref="alg1.l8.m1.2.2.1.1"><csymbol cd="ambiguous" id="alg1.l8.m1.2.2.1.1.1.cmml" xref="alg1.l8.m1.2.2.1.1">superscript</csymbol><apply id="alg1.l8.m1.2.2.1.1.2.cmml" xref="alg1.l8.m1.2.2.1.1"><csymbol cd="ambiguous" id="alg1.l8.m1.2.2.1.1.2.1.cmml" xref="alg1.l8.m1.2.2.1.1">subscript</csymbol><ci id="alg1.l8.m1.2.2.1.1.2.2.cmml" xref="alg1.l8.m1.2.2.1.1.2.2">𝒚</ci><ci id="alg1.l8.m1.2.2.1.1.2.3.cmml" xref="alg1.l8.m1.2.2.1.1.2.3">𝑠</ci></apply><ci id="alg1.l8.m1.1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1.1">𝐿</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.2c">\{\bm{y}_{s}^{(L)}\}</annotation><annotation encoding="application/x-llamapun" id="alg1.l8.m1.2d">{ bold_italic_y start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_L ) end_POSTSUPERSCRIPT }</annotation></semantics></math> and through a fully-connected layer to obtain the predicted value <math id="alg1.l8.m2.1" class="ltx_Math" alttext="\prescript{(m)}{}{\hat{y}}" display="inline"><semantics id="alg1.l8.m2.1a"><mmultiscripts id="alg1.l8.m2.1.2" xref="alg1.l8.m2.1.2.cmml"><mover accent="true" id="alg1.l8.m2.1.2.2" xref="alg1.l8.m2.1.2.2.cmml"><mi id="alg1.l8.m2.1.2.2.2" xref="alg1.l8.m2.1.2.2.2.cmml">y</mi><mo stretchy="false" id="alg1.l8.m2.1.2.2.1" xref="alg1.l8.m2.1.2.2.1.cmml">^</mo></mover><mprescripts id="alg1.l8.m2.1.2a" xref="alg1.l8.m2.1.2.cmml"></mprescripts><none id="alg1.l8.m2.1.2b" xref="alg1.l8.m2.1.2.cmml"></none><mrow id="alg1.l8.m2.1.1.1.3" xref="alg1.l8.m2.1.2.cmml"><mo stretchy="false" id="alg1.l8.m2.1.1.1.3.1" xref="alg1.l8.m2.1.2.cmml">(</mo><mi id="alg1.l8.m2.1.1.1.1" xref="alg1.l8.m2.1.1.1.1.cmml">m</mi><mo stretchy="false" id="alg1.l8.m2.1.1.1.3.2" xref="alg1.l8.m2.1.2.cmml">)</mo></mrow></mmultiscripts><annotation-xml encoding="MathML-Content" id="alg1.l8.m2.1b"><apply id="alg1.l8.m2.1.2.cmml" xref="alg1.l8.m2.1.2"><csymbol cd="ambiguous" id="alg1.l8.m2.1.2.1.cmml" xref="alg1.l8.m2.1.2">superscript</csymbol><apply id="alg1.l8.m2.1.2.2.cmml" xref="alg1.l8.m2.1.2.2"><ci id="alg1.l8.m2.1.2.2.1.cmml" xref="alg1.l8.m2.1.2.2.1">^</ci><ci id="alg1.l8.m2.1.2.2.2.cmml" xref="alg1.l8.m2.1.2.2.2">𝑦</ci></apply><ci id="alg1.l8.m2.1.1.1.1.cmml" xref="alg1.l8.m2.1.1.1.1">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m2.1c">\prescript{(m)}{}{\hat{y}}</annotation><annotation encoding="application/x-llamapun" id="alg1.l8.m2.1d">start_FLOATSUPERSCRIPT ( italic_m ) end_FLOATSUPERSCRIPT over^ start_ARG italic_y end_ARG</annotation></semantics></math>.

</div>
<div id="alg1.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l9.1.1.1" class="ltx_text" style="font-size:80%;">9:</span></span>        Calculate the mean squared error in (<a href="#S2.E17" title="(17) ‣ 2.3 Loss Function ‣ 2 Method ‣ Quantum Self-Attention Neural Networks for Text Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">17</span></a>) and update the parameters through the optimization procedure.

</div>
<div id="alg1.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l10.1.1.1" class="ltx_text" style="font-size:80%;">10:</span></span>     <span id="alg1.l10.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l10.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l11.1.1.1" class="ltx_text" style="font-size:80%;">11:</span></span>     <span id="alg1.l11.2" class="ltx_text ltx_font_bold">if</span> the stopping condition is met <span id="alg1.l11.3" class="ltx_text ltx_font_bold">then</span>



</div>
<div id="alg1.l12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l12.1.1.1" class="ltx_text" style="font-size:80%;">12:</span></span>        Break.

</div>
<div id="alg1.l13" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l13.1.1.1" class="ltx_text" style="font-size:80%;">13:</span></span>     <span id="alg1.l13.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l13.3" class="ltx_text ltx_font_bold">if</span>
</div>
<div id="alg1.l14" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l14.1.1.1" class="ltx_text" style="font-size:80%;">14:</span></span>  <span id="alg1.l14.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l14.3" class="ltx_text ltx_font_bold">for</span>
</div>
</div>
</figure>
</section>
<section id="S2.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.4 </span>Analysis of QSANN</h3>

<div id="S2.SS4.p1" class="ltx_para">
<p id="S2.SS4.p1.5" class="ltx_p">According to the definition of the Quantum Self-Attention Layer, for a sequence with <math id="S2.SS4.p1.1.m1.1" class="ltx_Math" alttext="S" display="inline"><semantics id="S2.SS4.p1.1.m1.1a"><mi id="S2.SS4.p1.1.m1.1.1" xref="S2.SS4.p1.1.m1.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.p1.1.m1.1b"><ci id="S2.SS4.p1.1.m1.1.1.cmml" xref="S2.SS4.p1.1.m1.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p1.1.m1.1c">S</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p1.1.m1.1d">italic_S</annotation></semantics></math> words, we need <math id="S2.SS4.p1.2.m2.1" class="ltx_Math" alttext="S(d+2)" display="inline"><semantics id="S2.SS4.p1.2.m2.1a"><mrow id="S2.SS4.p1.2.m2.1.1" xref="S2.SS4.p1.2.m2.1.1.cmml"><mi id="S2.SS4.p1.2.m2.1.1.3" xref="S2.SS4.p1.2.m2.1.1.3.cmml">S</mi><mo id="S2.SS4.p1.2.m2.1.1.2" xref="S2.SS4.p1.2.m2.1.1.2.cmml">⁢</mo><mrow id="S2.SS4.p1.2.m2.1.1.1.1" xref="S2.SS4.p1.2.m2.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS4.p1.2.m2.1.1.1.1.2" xref="S2.SS4.p1.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS4.p1.2.m2.1.1.1.1.1" xref="S2.SS4.p1.2.m2.1.1.1.1.1.cmml"><mi id="S2.SS4.p1.2.m2.1.1.1.1.1.2" xref="S2.SS4.p1.2.m2.1.1.1.1.1.2.cmml">d</mi><mo id="S2.SS4.p1.2.m2.1.1.1.1.1.1" xref="S2.SS4.p1.2.m2.1.1.1.1.1.1.cmml">+</mo><mn id="S2.SS4.p1.2.m2.1.1.1.1.1.3" xref="S2.SS4.p1.2.m2.1.1.1.1.1.3.cmml">2</mn></mrow><mo stretchy="false" id="S2.SS4.p1.2.m2.1.1.1.1.3" xref="S2.SS4.p1.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p1.2.m2.1b"><apply id="S2.SS4.p1.2.m2.1.1.cmml" xref="S2.SS4.p1.2.m2.1.1"><times id="S2.SS4.p1.2.m2.1.1.2.cmml" xref="S2.SS4.p1.2.m2.1.1.2"></times><ci id="S2.SS4.p1.2.m2.1.1.3.cmml" xref="S2.SS4.p1.2.m2.1.1.3">𝑆</ci><apply id="S2.SS4.p1.2.m2.1.1.1.1.1.cmml" xref="S2.SS4.p1.2.m2.1.1.1.1"><plus id="S2.SS4.p1.2.m2.1.1.1.1.1.1.cmml" xref="S2.SS4.p1.2.m2.1.1.1.1.1.1"></plus><ci id="S2.SS4.p1.2.m2.1.1.1.1.1.2.cmml" xref="S2.SS4.p1.2.m2.1.1.1.1.1.2">𝑑</ci><cn type="integer" id="S2.SS4.p1.2.m2.1.1.1.1.1.3.cmml" xref="S2.SS4.p1.2.m2.1.1.1.1.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p1.2.m2.1c">S(d+2)</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p1.2.m2.1d">italic_S ( italic_d + 2 )</annotation></semantics></math> Pauli measurements to obtain the <math id="S2.SS4.p1.3.m3.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S2.SS4.p1.3.m3.1a"><mi id="S2.SS4.p1.3.m3.1.1" xref="S2.SS4.p1.3.m3.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.p1.3.m3.1b"><ci id="S2.SS4.p1.3.m3.1.1.cmml" xref="S2.SS4.p1.3.m3.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p1.3.m3.1c">d</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p1.3.m3.1d">italic_d</annotation></semantics></math>-dimensional value vectors as well as the queries and keys for all words from the quantum device. After that, we need to compute <math id="S2.SS4.p1.4.m4.1" class="ltx_Math" alttext="S^{2}" display="inline"><semantics id="S2.SS4.p1.4.m4.1a"><msup id="S2.SS4.p1.4.m4.1.1" xref="S2.SS4.p1.4.m4.1.1.cmml"><mi id="S2.SS4.p1.4.m4.1.1.2" xref="S2.SS4.p1.4.m4.1.1.2.cmml">S</mi><mn id="S2.SS4.p1.4.m4.1.1.3" xref="S2.SS4.p1.4.m4.1.1.3.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="S2.SS4.p1.4.m4.1b"><apply id="S2.SS4.p1.4.m4.1.1.cmml" xref="S2.SS4.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS4.p1.4.m4.1.1.1.cmml" xref="S2.SS4.p1.4.m4.1.1">superscript</csymbol><ci id="S2.SS4.p1.4.m4.1.1.2.cmml" xref="S2.SS4.p1.4.m4.1.1.2">𝑆</ci><cn type="integer" id="S2.SS4.p1.4.m4.1.1.3.cmml" xref="S2.SS4.p1.4.m4.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p1.4.m4.1c">S^{2}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p1.4.m4.1d">italic_S start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math> self-attention coefficients for all <math id="S2.SS4.p1.5.m5.1" class="ltx_Math" alttext="S^{2}" display="inline"><semantics id="S2.SS4.p1.5.m5.1a"><msup id="S2.SS4.p1.5.m5.1.1" xref="S2.SS4.p1.5.m5.1.1.cmml"><mi id="S2.SS4.p1.5.m5.1.1.2" xref="S2.SS4.p1.5.m5.1.1.2.cmml">S</mi><mn id="S2.SS4.p1.5.m5.1.1.3" xref="S2.SS4.p1.5.m5.1.1.3.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="S2.SS4.p1.5.m5.1b"><apply id="S2.SS4.p1.5.m5.1.1.cmml" xref="S2.SS4.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS4.p1.5.m5.1.1.1.cmml" xref="S2.SS4.p1.5.m5.1.1">superscript</csymbol><ci id="S2.SS4.p1.5.m5.1.1.2.cmml" xref="S2.SS4.p1.5.m5.1.1.2">𝑆</ci><cn type="integer" id="S2.SS4.p1.5.m5.1.1.3.cmml" xref="S2.SS4.p1.5.m5.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p1.5.m5.1c">S^{2}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p1.5.m5.1d">italic_S start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math> pairs of words on the classical computer. In general, QSANN takes advantage of quantum devices’ efficiency in processing high-dimensional data while outsourcing some calculations to classical computers. This approach keeps the quantum circuit depth low and thus makes QSANN robust to low-level noise common in near-term quantum devices. This beneficial attribute is further verified by numerical results in the next section, where we test QSANN against noise.</p>
</div>
<div id="S2.SS4.p2" class="ltx_para">
<p id="S2.SS4.p2.1" class="ltx_p">In short, our QSANN first encodes words into a large quantum Hilbert space as the feature space and then projects them back to low-dimensional classical feature space by quantum measurement. Recent works have proved rigorous quantum advantages on some classification tasks by utilizing high-dimensional quantum feature space <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib46" title="" class="ltx_ref">46</a>]</cite> and projected quantum models <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib47" title="" class="ltx_ref">47</a>]</cite>. Thus, we expect that our QSANN might also have the potential advantage of digging out some hidden features that are classically intractable.
In the following section, we carry out numerical simulations of QSANN on several data sets to evaluate its performance on binary text classification tasks.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Numerical Results</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">In order to demonstrate the performance of our proposed QSANN, we have conducted numerical experiments on public data sets, where the quantum part was accomplished via classical simulation. Concretely, we first exhibit the better performance of QSANN by comparing it with i) the
syntactic analysis-based quantum model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite> on two simple tasks, i.e., MC and RP, ii) the <span id="S3.p1.1.1" class="ltx_text ltx_font_italic">classical self-attention neural network</span> (CSANN) and the naive method on three public sentiment analysis data sets, i.e., Yelp, IMDb and Amazon <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib48" title="" class="ltx_ref">48</a>]</cite>.
Then we show the reasonableness of our particular quantum self-attention GPQSA via visualization of self-attention coefficients. Finally, the noisy experiments are performed to show the robustness of QSANN to noisy quantum channels.
All the simulations and optimization loop are implemented via Paddle Quantum<span id="footnote2" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>https://github.com/paddlepaddle/Quantum</span></span></span> on the PaddlePaddle Deep Learning Platform <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib49" title="" class="ltx_ref">49</a>]</cite>.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Data Sets</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.1" class="ltx_p">The two simple synthetic data sets we employed come directly from <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite>, which are named as MC and RP, respectively.
MC contains 17 words and 130 sentences (70 train + 30 development + 30 test) with 3 or 4 words each; RP has 115 words and 105 sentences (74 train + 31 test) with 4 words in each one.
The other three data sets we use are real-world data sets available at <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib50" title="" class="ltx_ref">50</a>]</cite> as the Sentiment Labelled Sentences Data Set.
These data sets consist of reviews of restaurants, movies and products selected from Yelp, IMDb and Amazon, respectively. Each of the three data sets contains 1000 sequences, where half are labeled as ‘0’ (for negative) and the other half as ‘1’ (for positive). And each sequence contains several to dozens of words. We randomly select 80% as training sequences and the rest 20% as test ones.</p>
</div>
<figure id="S3.T1" class="ltx_table">
<table id="S3.T1.6" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="S3.T1.6.6" class="ltx_tr">
<td id="S3.T1.6.6.7" class="ltx_td ltx_align_center ltx_border_tt">Data set</td>
<td id="S3.T1.1.1.1" class="ltx_td ltx_align_center ltx_border_tt"><math id="S3.T1.1.1.1.m1.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S3.T1.1.1.1.m1.1a"><mi id="S3.T1.1.1.1.m1.1.1" xref="S3.T1.1.1.1.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.T1.1.1.1.m1.1b"><ci id="S3.T1.1.1.1.m1.1.1.cmml" xref="S3.T1.1.1.1.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.1.1.1.m1.1c">n</annotation><annotation encoding="application/x-llamapun" id="S3.T1.1.1.1.m1.1d">italic_n</annotation></semantics></math></td>
<td id="S3.T1.2.2.2" class="ltx_td ltx_align_center ltx_border_tt"><math id="S3.T1.2.2.2.m1.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S3.T1.2.2.2.m1.1a"><mi id="S3.T1.2.2.2.m1.1.1" xref="S3.T1.2.2.2.m1.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.T1.2.2.2.m1.1b"><ci id="S3.T1.2.2.2.m1.1.1.cmml" xref="S3.T1.2.2.2.m1.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.2.2.2.m1.1c">d</annotation><annotation encoding="application/x-llamapun" id="S3.T1.2.2.2.m1.1d">italic_d</annotation></semantics></math></td>
<td id="S3.T1.3.3.3" class="ltx_td ltx_align_center ltx_border_tt"><math id="S3.T1.3.3.3.m1.1" class="ltx_Math" alttext="D_{enc}" display="inline"><semantics id="S3.T1.3.3.3.m1.1a"><msub id="S3.T1.3.3.3.m1.1.1" xref="S3.T1.3.3.3.m1.1.1.cmml"><mi id="S3.T1.3.3.3.m1.1.1.2" xref="S3.T1.3.3.3.m1.1.1.2.cmml">D</mi><mrow id="S3.T1.3.3.3.m1.1.1.3" xref="S3.T1.3.3.3.m1.1.1.3.cmml"><mi id="S3.T1.3.3.3.m1.1.1.3.2" xref="S3.T1.3.3.3.m1.1.1.3.2.cmml">e</mi><mo id="S3.T1.3.3.3.m1.1.1.3.1" xref="S3.T1.3.3.3.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.T1.3.3.3.m1.1.1.3.3" xref="S3.T1.3.3.3.m1.1.1.3.3.cmml">n</mi><mo id="S3.T1.3.3.3.m1.1.1.3.1a" xref="S3.T1.3.3.3.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.T1.3.3.3.m1.1.1.3.4" xref="S3.T1.3.3.3.m1.1.1.3.4.cmml">c</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.T1.3.3.3.m1.1b"><apply id="S3.T1.3.3.3.m1.1.1.cmml" xref="S3.T1.3.3.3.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.3.3.3.m1.1.1.1.cmml" xref="S3.T1.3.3.3.m1.1.1">subscript</csymbol><ci id="S3.T1.3.3.3.m1.1.1.2.cmml" xref="S3.T1.3.3.3.m1.1.1.2">𝐷</ci><apply id="S3.T1.3.3.3.m1.1.1.3.cmml" xref="S3.T1.3.3.3.m1.1.1.3"><times id="S3.T1.3.3.3.m1.1.1.3.1.cmml" xref="S3.T1.3.3.3.m1.1.1.3.1"></times><ci id="S3.T1.3.3.3.m1.1.1.3.2.cmml" xref="S3.T1.3.3.3.m1.1.1.3.2">𝑒</ci><ci id="S3.T1.3.3.3.m1.1.1.3.3.cmml" xref="S3.T1.3.3.3.m1.1.1.3.3">𝑛</ci><ci id="S3.T1.3.3.3.m1.1.1.3.4.cmml" xref="S3.T1.3.3.3.m1.1.1.3.4">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.3.3.3.m1.1c">D_{enc}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.3.3.3.m1.1d">italic_D start_POSTSUBSCRIPT italic_e italic_n italic_c end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td id="S3.T1.4.4.4" class="ltx_td ltx_align_center ltx_border_tt"><math id="S3.T1.4.4.4.m1.1" class="ltx_Math" alttext="D_{q/k/v}" display="inline"><semantics id="S3.T1.4.4.4.m1.1a"><msub id="S3.T1.4.4.4.m1.1.1" xref="S3.T1.4.4.4.m1.1.1.cmml"><mi id="S3.T1.4.4.4.m1.1.1.2" xref="S3.T1.4.4.4.m1.1.1.2.cmml">D</mi><mrow id="S3.T1.4.4.4.m1.1.1.3" xref="S3.T1.4.4.4.m1.1.1.3.cmml"><mi id="S3.T1.4.4.4.m1.1.1.3.2" xref="S3.T1.4.4.4.m1.1.1.3.2.cmml">q</mi><mo id="S3.T1.4.4.4.m1.1.1.3.1" xref="S3.T1.4.4.4.m1.1.1.3.1.cmml">/</mo><mi id="S3.T1.4.4.4.m1.1.1.3.3" xref="S3.T1.4.4.4.m1.1.1.3.3.cmml">k</mi><mo id="S3.T1.4.4.4.m1.1.1.3.1a" xref="S3.T1.4.4.4.m1.1.1.3.1.cmml">/</mo><mi id="S3.T1.4.4.4.m1.1.1.3.4" xref="S3.T1.4.4.4.m1.1.1.3.4.cmml">v</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.T1.4.4.4.m1.1b"><apply id="S3.T1.4.4.4.m1.1.1.cmml" xref="S3.T1.4.4.4.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.4.4.4.m1.1.1.1.cmml" xref="S3.T1.4.4.4.m1.1.1">subscript</csymbol><ci id="S3.T1.4.4.4.m1.1.1.2.cmml" xref="S3.T1.4.4.4.m1.1.1.2">𝐷</ci><apply id="S3.T1.4.4.4.m1.1.1.3.cmml" xref="S3.T1.4.4.4.m1.1.1.3"><divide id="S3.T1.4.4.4.m1.1.1.3.1.cmml" xref="S3.T1.4.4.4.m1.1.1.3.1"></divide><ci id="S3.T1.4.4.4.m1.1.1.3.2.cmml" xref="S3.T1.4.4.4.m1.1.1.3.2">𝑞</ci><ci id="S3.T1.4.4.4.m1.1.1.3.3.cmml" xref="S3.T1.4.4.4.m1.1.1.3.3">𝑘</ci><ci id="S3.T1.4.4.4.m1.1.1.3.4.cmml" xref="S3.T1.4.4.4.m1.1.1.3.4">𝑣</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.4.4.4.m1.1c">D_{q/k/v}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.4.4.4.m1.1d">italic_D start_POSTSUBSCRIPT italic_q / italic_k / italic_v end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td id="S3.T1.5.5.5" class="ltx_td ltx_align_center ltx_border_tt"><math id="S3.T1.5.5.5.m1.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S3.T1.5.5.5.m1.1a"><mi id="S3.T1.5.5.5.m1.1.1" xref="S3.T1.5.5.5.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S3.T1.5.5.5.m1.1b"><ci id="S3.T1.5.5.5.m1.1.1.cmml" xref="S3.T1.5.5.5.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.5.5.5.m1.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S3.T1.5.5.5.m1.1d">italic_λ</annotation></semantics></math></td>
<td id="S3.T1.6.6.6" class="ltx_td ltx_align_center ltx_border_tt"><math id="S3.T1.6.6.6.m1.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S3.T1.6.6.6.m1.1a"><mi id="S3.T1.6.6.6.m1.1.1" xref="S3.T1.6.6.6.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S3.T1.6.6.6.m1.1b"><ci id="S3.T1.6.6.6.m1.1.1.cmml" xref="S3.T1.6.6.6.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.6.6.6.m1.1c">\gamma</annotation><annotation encoding="application/x-llamapun" id="S3.T1.6.6.6.m1.1d">italic_γ</annotation></semantics></math></td>
<td id="S3.T1.6.6.8" class="ltx_td ltx_align_center ltx_border_tt">LR</td>
</tr>
<tr id="S3.T1.6.7" class="ltx_tr">
<td id="S3.T1.6.7.1" class="ltx_td ltx_align_center ltx_border_t">MC</td>
<td id="S3.T1.6.7.2" class="ltx_td ltx_align_center ltx_border_t">2</td>
<td id="S3.T1.6.7.3" class="ltx_td ltx_align_center ltx_border_t">6</td>
<td id="S3.T1.6.7.4" class="ltx_td ltx_align_center ltx_border_t">1</td>
<td id="S3.T1.6.7.5" class="ltx_td ltx_align_center ltx_border_t">1</td>
<td id="S3.T1.6.7.6" class="ltx_td ltx_align_center ltx_border_t">0</td>
<td id="S3.T1.6.7.7" class="ltx_td ltx_align_center ltx_border_t">0</td>
<td id="S3.T1.6.7.8" class="ltx_td ltx_align_center ltx_border_t">0.008</td>
</tr>
<tr id="S3.T1.6.8" class="ltx_tr">
<td id="S3.T1.6.8.1" class="ltx_td ltx_align_center ltx_border_t">RP</td>
<td id="S3.T1.6.8.2" class="ltx_td ltx_align_center ltx_border_t">4</td>
<td id="S3.T1.6.8.3" class="ltx_td ltx_align_center ltx_border_t">24</td>
<td id="S3.T1.6.8.4" class="ltx_td ltx_align_center ltx_border_t">4</td>
<td id="S3.T1.6.8.5" class="ltx_td ltx_align_center ltx_border_t">5</td>
<td id="S3.T1.6.8.6" class="ltx_td ltx_align_center ltx_border_t">0.2</td>
<td id="S3.T1.6.8.7" class="ltx_td ltx_align_center ltx_border_t">0.4</td>
<td id="S3.T1.6.8.8" class="ltx_td ltx_align_center ltx_border_t">0.008</td>
</tr>
<tr id="S3.T1.6.9" class="ltx_tr">
<td id="S3.T1.6.9.1" class="ltx_td ltx_align_center ltx_border_t">Yelp</td>
<td id="S3.T1.6.9.2" class="ltx_td ltx_align_center ltx_border_t">4</td>
<td id="S3.T1.6.9.3" class="ltx_td ltx_align_center ltx_border_t">12</td>
<td id="S3.T1.6.9.4" class="ltx_td ltx_align_center ltx_border_t">1</td>
<td id="S3.T1.6.9.5" class="ltx_td ltx_align_center ltx_border_t">1</td>
<td id="S3.T1.6.9.6" class="ltx_td ltx_align_center ltx_border_t">0.2</td>
<td id="S3.T1.6.9.7" class="ltx_td ltx_align_center ltx_border_t">0.2</td>
<td id="S3.T1.6.9.8" class="ltx_td ltx_align_center ltx_border_t">0.008</td>
</tr>
<tr id="S3.T1.6.10" class="ltx_tr">
<td id="S3.T1.6.10.1" class="ltx_td ltx_align_center ltx_border_t">IMDb</td>
<td id="S3.T1.6.10.2" class="ltx_td ltx_align_center ltx_border_t">4</td>
<td id="S3.T1.6.10.3" class="ltx_td ltx_align_center ltx_border_t">12</td>
<td id="S3.T1.6.10.4" class="ltx_td ltx_align_center ltx_border_t">1</td>
<td id="S3.T1.6.10.5" class="ltx_td ltx_align_center ltx_border_t">1</td>
<td id="S3.T1.6.10.6" class="ltx_td ltx_align_center ltx_border_t">0.002</td>
<td id="S3.T1.6.10.7" class="ltx_td ltx_align_center ltx_border_t">0.002</td>
<td id="S3.T1.6.10.8" class="ltx_td ltx_align_center ltx_border_t">0.002</td>
</tr>
<tr id="S3.T1.6.11" class="ltx_tr">
<td id="S3.T1.6.11.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">Amazon</td>
<td id="S3.T1.6.11.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">4</td>
<td id="S3.T1.6.11.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">12</td>
<td id="S3.T1.6.11.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">1</td>
<td id="S3.T1.6.11.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">2</td>
<td id="S3.T1.6.11.6" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">0.2</td>
<td id="S3.T1.6.11.7" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">0.2</td>
<td id="S3.T1.6.11.8" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">0.008</td>
</tr>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Overview of hyper-parameter settings. Here, ‘LR’ denotes learning rate, <math id="S3.T1.9.m1.4" class="ltx_Math" alttext="D_{enc},D_{q},D_{k},D_{v}" display="inline"><semantics id="S3.T1.9.m1.4b"><mrow id="S3.T1.9.m1.4.4.4" xref="S3.T1.9.m1.4.4.5.cmml"><msub id="S3.T1.9.m1.1.1.1.1" xref="S3.T1.9.m1.1.1.1.1.cmml"><mi id="S3.T1.9.m1.1.1.1.1.2" xref="S3.T1.9.m1.1.1.1.1.2.cmml">D</mi><mrow id="S3.T1.9.m1.1.1.1.1.3" xref="S3.T1.9.m1.1.1.1.1.3.cmml"><mi id="S3.T1.9.m1.1.1.1.1.3.2" xref="S3.T1.9.m1.1.1.1.1.3.2.cmml">e</mi><mo id="S3.T1.9.m1.1.1.1.1.3.1" xref="S3.T1.9.m1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S3.T1.9.m1.1.1.1.1.3.3" xref="S3.T1.9.m1.1.1.1.1.3.3.cmml">n</mi><mo id="S3.T1.9.m1.1.1.1.1.3.1b" xref="S3.T1.9.m1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S3.T1.9.m1.1.1.1.1.3.4" xref="S3.T1.9.m1.1.1.1.1.3.4.cmml">c</mi></mrow></msub><mo id="S3.T1.9.m1.4.4.4.5" xref="S3.T1.9.m1.4.4.5.cmml">,</mo><msub id="S3.T1.9.m1.2.2.2.2" xref="S3.T1.9.m1.2.2.2.2.cmml"><mi id="S3.T1.9.m1.2.2.2.2.2" xref="S3.T1.9.m1.2.2.2.2.2.cmml">D</mi><mi id="S3.T1.9.m1.2.2.2.2.3" xref="S3.T1.9.m1.2.2.2.2.3.cmml">q</mi></msub><mo id="S3.T1.9.m1.4.4.4.6" xref="S3.T1.9.m1.4.4.5.cmml">,</mo><msub id="S3.T1.9.m1.3.3.3.3" xref="S3.T1.9.m1.3.3.3.3.cmml"><mi id="S3.T1.9.m1.3.3.3.3.2" xref="S3.T1.9.m1.3.3.3.3.2.cmml">D</mi><mi id="S3.T1.9.m1.3.3.3.3.3" xref="S3.T1.9.m1.3.3.3.3.3.cmml">k</mi></msub><mo id="S3.T1.9.m1.4.4.4.7" xref="S3.T1.9.m1.4.4.5.cmml">,</mo><msub id="S3.T1.9.m1.4.4.4.4" xref="S3.T1.9.m1.4.4.4.4.cmml"><mi id="S3.T1.9.m1.4.4.4.4.2" xref="S3.T1.9.m1.4.4.4.4.2.cmml">D</mi><mi id="S3.T1.9.m1.4.4.4.4.3" xref="S3.T1.9.m1.4.4.4.4.3.cmml">v</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.9.m1.4c"><list id="S3.T1.9.m1.4.4.5.cmml" xref="S3.T1.9.m1.4.4.4"><apply id="S3.T1.9.m1.1.1.1.1.cmml" xref="S3.T1.9.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.T1.9.m1.1.1.1.1.1.cmml" xref="S3.T1.9.m1.1.1.1.1">subscript</csymbol><ci id="S3.T1.9.m1.1.1.1.1.2.cmml" xref="S3.T1.9.m1.1.1.1.1.2">𝐷</ci><apply id="S3.T1.9.m1.1.1.1.1.3.cmml" xref="S3.T1.9.m1.1.1.1.1.3"><times id="S3.T1.9.m1.1.1.1.1.3.1.cmml" xref="S3.T1.9.m1.1.1.1.1.3.1"></times><ci id="S3.T1.9.m1.1.1.1.1.3.2.cmml" xref="S3.T1.9.m1.1.1.1.1.3.2">𝑒</ci><ci id="S3.T1.9.m1.1.1.1.1.3.3.cmml" xref="S3.T1.9.m1.1.1.1.1.3.3">𝑛</ci><ci id="S3.T1.9.m1.1.1.1.1.3.4.cmml" xref="S3.T1.9.m1.1.1.1.1.3.4">𝑐</ci></apply></apply><apply id="S3.T1.9.m1.2.2.2.2.cmml" xref="S3.T1.9.m1.2.2.2.2"><csymbol cd="ambiguous" id="S3.T1.9.m1.2.2.2.2.1.cmml" xref="S3.T1.9.m1.2.2.2.2">subscript</csymbol><ci id="S3.T1.9.m1.2.2.2.2.2.cmml" xref="S3.T1.9.m1.2.2.2.2.2">𝐷</ci><ci id="S3.T1.9.m1.2.2.2.2.3.cmml" xref="S3.T1.9.m1.2.2.2.2.3">𝑞</ci></apply><apply id="S3.T1.9.m1.3.3.3.3.cmml" xref="S3.T1.9.m1.3.3.3.3"><csymbol cd="ambiguous" id="S3.T1.9.m1.3.3.3.3.1.cmml" xref="S3.T1.9.m1.3.3.3.3">subscript</csymbol><ci id="S3.T1.9.m1.3.3.3.3.2.cmml" xref="S3.T1.9.m1.3.3.3.3.2">𝐷</ci><ci id="S3.T1.9.m1.3.3.3.3.3.cmml" xref="S3.T1.9.m1.3.3.3.3.3">𝑘</ci></apply><apply id="S3.T1.9.m1.4.4.4.4.cmml" xref="S3.T1.9.m1.4.4.4.4"><csymbol cd="ambiguous" id="S3.T1.9.m1.4.4.4.4.1.cmml" xref="S3.T1.9.m1.4.4.4.4">subscript</csymbol><ci id="S3.T1.9.m1.4.4.4.4.2.cmml" xref="S3.T1.9.m1.4.4.4.4.2">𝐷</ci><ci id="S3.T1.9.m1.4.4.4.4.3.cmml" xref="S3.T1.9.m1.4.4.4.4.3">𝑣</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.9.m1.4d">D_{enc},D_{q},D_{k},D_{v}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.9.m1.4e">italic_D start_POSTSUBSCRIPT italic_e italic_n italic_c end_POSTSUBSCRIPT , italic_D start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT , italic_D start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT , italic_D start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT</annotation></semantics></math> denote the depths of the corresponding ansatzes and <math id="S3.T1.10.m2.1" class="ltx_Math" alttext="d=n(D_{enc}+2)" display="inline"><semantics id="S3.T1.10.m2.1b"><mrow id="S3.T1.10.m2.1.1" xref="S3.T1.10.m2.1.1.cmml"><mi id="S3.T1.10.m2.1.1.3" xref="S3.T1.10.m2.1.1.3.cmml">d</mi><mo id="S3.T1.10.m2.1.1.2" xref="S3.T1.10.m2.1.1.2.cmml">=</mo><mrow id="S3.T1.10.m2.1.1.1" xref="S3.T1.10.m2.1.1.1.cmml"><mi id="S3.T1.10.m2.1.1.1.3" xref="S3.T1.10.m2.1.1.1.3.cmml">n</mi><mo id="S3.T1.10.m2.1.1.1.2" xref="S3.T1.10.m2.1.1.1.2.cmml">⁢</mo><mrow id="S3.T1.10.m2.1.1.1.1.1" xref="S3.T1.10.m2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.T1.10.m2.1.1.1.1.1.2" xref="S3.T1.10.m2.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.T1.10.m2.1.1.1.1.1.1" xref="S3.T1.10.m2.1.1.1.1.1.1.cmml"><msub id="S3.T1.10.m2.1.1.1.1.1.1.2" xref="S3.T1.10.m2.1.1.1.1.1.1.2.cmml"><mi id="S3.T1.10.m2.1.1.1.1.1.1.2.2" xref="S3.T1.10.m2.1.1.1.1.1.1.2.2.cmml">D</mi><mrow id="S3.T1.10.m2.1.1.1.1.1.1.2.3" xref="S3.T1.10.m2.1.1.1.1.1.1.2.3.cmml"><mi id="S3.T1.10.m2.1.1.1.1.1.1.2.3.2" xref="S3.T1.10.m2.1.1.1.1.1.1.2.3.2.cmml">e</mi><mo id="S3.T1.10.m2.1.1.1.1.1.1.2.3.1" xref="S3.T1.10.m2.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.T1.10.m2.1.1.1.1.1.1.2.3.3" xref="S3.T1.10.m2.1.1.1.1.1.1.2.3.3.cmml">n</mi><mo id="S3.T1.10.m2.1.1.1.1.1.1.2.3.1b" xref="S3.T1.10.m2.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.T1.10.m2.1.1.1.1.1.1.2.3.4" xref="S3.T1.10.m2.1.1.1.1.1.1.2.3.4.cmml">c</mi></mrow></msub><mo id="S3.T1.10.m2.1.1.1.1.1.1.1" xref="S3.T1.10.m2.1.1.1.1.1.1.1.cmml">+</mo><mn id="S3.T1.10.m2.1.1.1.1.1.1.3" xref="S3.T1.10.m2.1.1.1.1.1.1.3.cmml">2</mn></mrow><mo stretchy="false" id="S3.T1.10.m2.1.1.1.1.1.3" xref="S3.T1.10.m2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.10.m2.1c"><apply id="S3.T1.10.m2.1.1.cmml" xref="S3.T1.10.m2.1.1"><eq id="S3.T1.10.m2.1.1.2.cmml" xref="S3.T1.10.m2.1.1.2"></eq><ci id="S3.T1.10.m2.1.1.3.cmml" xref="S3.T1.10.m2.1.1.3">𝑑</ci><apply id="S3.T1.10.m2.1.1.1.cmml" xref="S3.T1.10.m2.1.1.1"><times id="S3.T1.10.m2.1.1.1.2.cmml" xref="S3.T1.10.m2.1.1.1.2"></times><ci id="S3.T1.10.m2.1.1.1.3.cmml" xref="S3.T1.10.m2.1.1.1.3">𝑛</ci><apply id="S3.T1.10.m2.1.1.1.1.1.1.cmml" xref="S3.T1.10.m2.1.1.1.1.1"><plus id="S3.T1.10.m2.1.1.1.1.1.1.1.cmml" xref="S3.T1.10.m2.1.1.1.1.1.1.1"></plus><apply id="S3.T1.10.m2.1.1.1.1.1.1.2.cmml" xref="S3.T1.10.m2.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.T1.10.m2.1.1.1.1.1.1.2.1.cmml" xref="S3.T1.10.m2.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.T1.10.m2.1.1.1.1.1.1.2.2.cmml" xref="S3.T1.10.m2.1.1.1.1.1.1.2.2">𝐷</ci><apply id="S3.T1.10.m2.1.1.1.1.1.1.2.3.cmml" xref="S3.T1.10.m2.1.1.1.1.1.1.2.3"><times id="S3.T1.10.m2.1.1.1.1.1.1.2.3.1.cmml" xref="S3.T1.10.m2.1.1.1.1.1.1.2.3.1"></times><ci id="S3.T1.10.m2.1.1.1.1.1.1.2.3.2.cmml" xref="S3.T1.10.m2.1.1.1.1.1.1.2.3.2">𝑒</ci><ci id="S3.T1.10.m2.1.1.1.1.1.1.2.3.3.cmml" xref="S3.T1.10.m2.1.1.1.1.1.1.2.3.3">𝑛</ci><ci id="S3.T1.10.m2.1.1.1.1.1.1.2.3.4.cmml" xref="S3.T1.10.m2.1.1.1.1.1.1.2.3.4">𝑐</ci></apply></apply><cn type="integer" id="S3.T1.10.m2.1.1.1.1.1.1.3.cmml" xref="S3.T1.10.m2.1.1.1.1.1.1.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.10.m2.1d">d=n(D_{enc}+2)</annotation><annotation encoding="application/x-llamapun" id="S3.T1.10.m2.1e">italic_d = italic_n ( italic_D start_POSTSUBSCRIPT italic_e italic_n italic_c end_POSTSUBSCRIPT + 2 )</annotation></semantics></math>.</figcaption>
</figure>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Experimental Setting</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.1" class="ltx_p">In the experiments, we use a single self-attention layer for both QSANN and CSANN. As a comparison, we also perform the most straightforward method, i.e., averaging directly the embedded vectors of a sequence, followed by a fully-connected layer, which we call the ‘Naive’ method, on the three data sets of reviews.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.17" class="ltx_p">In QSANN, all the encoder, query, key and value ansatzes have the same qubit number and are constructed according to Fig. <a href="#S2.F2" title="Figure 2 ‣ 2.1.1 Gaussian Projected Quantum Self-Attention ‣ 2.1 Quantum Self-Attention Layer ‣ 2 Method ‣ Quantum Self-Attention Neural Networks for Text Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, which are easily imiplementable on the NISQ devices.
Specifically, assuming the <math id="S3.SS2.p2.1.m1.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S3.SS2.p2.1.m1.1a"><mi id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><ci id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">n</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.1.m1.1d">italic_n</annotation></semantics></math>-qubit encoder ansatz has <math id="S3.SS2.p2.2.m2.1" class="ltx_Math" alttext="D_{enc}" display="inline"><semantics id="S3.SS2.p2.2.m2.1a"><msub id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml"><mi id="S3.SS2.p2.2.m2.1.1.2" xref="S3.SS2.p2.2.m2.1.1.2.cmml">D</mi><mrow id="S3.SS2.p2.2.m2.1.1.3" xref="S3.SS2.p2.2.m2.1.1.3.cmml"><mi id="S3.SS2.p2.2.m2.1.1.3.2" xref="S3.SS2.p2.2.m2.1.1.3.2.cmml">e</mi><mo id="S3.SS2.p2.2.m2.1.1.3.1" xref="S3.SS2.p2.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p2.2.m2.1.1.3.3" xref="S3.SS2.p2.2.m2.1.1.3.3.cmml">n</mi><mo id="S3.SS2.p2.2.m2.1.1.3.1a" xref="S3.SS2.p2.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p2.2.m2.1.1.3.4" xref="S3.SS2.p2.2.m2.1.1.3.4.cmml">c</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b"><apply id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.1.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p2.2.m2.1.1.2.cmml" xref="S3.SS2.p2.2.m2.1.1.2">𝐷</ci><apply id="S3.SS2.p2.2.m2.1.1.3.cmml" xref="S3.SS2.p2.2.m2.1.1.3"><times id="S3.SS2.p2.2.m2.1.1.3.1.cmml" xref="S3.SS2.p2.2.m2.1.1.3.1"></times><ci id="S3.SS2.p2.2.m2.1.1.3.2.cmml" xref="S3.SS2.p2.2.m2.1.1.3.2">𝑒</ci><ci id="S3.SS2.p2.2.m2.1.1.3.3.cmml" xref="S3.SS2.p2.2.m2.1.1.3.3">𝑛</ci><ci id="S3.SS2.p2.2.m2.1.1.3.4.cmml" xref="S3.SS2.p2.2.m2.1.1.3.4">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">D_{enc}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.2.m2.1d">italic_D start_POSTSUBSCRIPT italic_e italic_n italic_c end_POSTSUBSCRIPT</annotation></semantics></math> layers with <math id="S3.SS2.p2.3.m3.1" class="ltx_Math" alttext="n(D_{enc}+2)" display="inline"><semantics id="S3.SS2.p2.3.m3.1a"><mrow id="S3.SS2.p2.3.m3.1.1" xref="S3.SS2.p2.3.m3.1.1.cmml"><mi id="S3.SS2.p2.3.m3.1.1.3" xref="S3.SS2.p2.3.m3.1.1.3.cmml">n</mi><mo id="S3.SS2.p2.3.m3.1.1.2" xref="S3.SS2.p2.3.m3.1.1.2.cmml">⁢</mo><mrow id="S3.SS2.p2.3.m3.1.1.1.1" xref="S3.SS2.p2.3.m3.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p2.3.m3.1.1.1.1.2" xref="S3.SS2.p2.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.p2.3.m3.1.1.1.1.1" xref="S3.SS2.p2.3.m3.1.1.1.1.1.cmml"><msub id="S3.SS2.p2.3.m3.1.1.1.1.1.2" xref="S3.SS2.p2.3.m3.1.1.1.1.1.2.cmml"><mi id="S3.SS2.p2.3.m3.1.1.1.1.1.2.2" xref="S3.SS2.p2.3.m3.1.1.1.1.1.2.2.cmml">D</mi><mrow id="S3.SS2.p2.3.m3.1.1.1.1.1.2.3" xref="S3.SS2.p2.3.m3.1.1.1.1.1.2.3.cmml"><mi id="S3.SS2.p2.3.m3.1.1.1.1.1.2.3.2" xref="S3.SS2.p2.3.m3.1.1.1.1.1.2.3.2.cmml">e</mi><mo id="S3.SS2.p2.3.m3.1.1.1.1.1.2.3.1" xref="S3.SS2.p2.3.m3.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p2.3.m3.1.1.1.1.1.2.3.3" xref="S3.SS2.p2.3.m3.1.1.1.1.1.2.3.3.cmml">n</mi><mo id="S3.SS2.p2.3.m3.1.1.1.1.1.2.3.1a" xref="S3.SS2.p2.3.m3.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p2.3.m3.1.1.1.1.1.2.3.4" xref="S3.SS2.p2.3.m3.1.1.1.1.1.2.3.4.cmml">c</mi></mrow></msub><mo id="S3.SS2.p2.3.m3.1.1.1.1.1.1" xref="S3.SS2.p2.3.m3.1.1.1.1.1.1.cmml">+</mo><mn id="S3.SS2.p2.3.m3.1.1.1.1.1.3" xref="S3.SS2.p2.3.m3.1.1.1.1.1.3.cmml">2</mn></mrow><mo stretchy="false" id="S3.SS2.p2.3.m3.1.1.1.1.3" xref="S3.SS2.p2.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m3.1b"><apply id="S3.SS2.p2.3.m3.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1"><times id="S3.SS2.p2.3.m3.1.1.2.cmml" xref="S3.SS2.p2.3.m3.1.1.2"></times><ci id="S3.SS2.p2.3.m3.1.1.3.cmml" xref="S3.SS2.p2.3.m3.1.1.3">𝑛</ci><apply id="S3.SS2.p2.3.m3.1.1.1.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1.1.1"><plus id="S3.SS2.p2.3.m3.1.1.1.1.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1.1.1.1.1"></plus><apply id="S3.SS2.p2.3.m3.1.1.1.1.1.2.cmml" xref="S3.SS2.p2.3.m3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m3.1.1.1.1.1.2.1.cmml" xref="S3.SS2.p2.3.m3.1.1.1.1.1.2">subscript</csymbol><ci id="S3.SS2.p2.3.m3.1.1.1.1.1.2.2.cmml" xref="S3.SS2.p2.3.m3.1.1.1.1.1.2.2">𝐷</ci><apply id="S3.SS2.p2.3.m3.1.1.1.1.1.2.3.cmml" xref="S3.SS2.p2.3.m3.1.1.1.1.1.2.3"><times id="S3.SS2.p2.3.m3.1.1.1.1.1.2.3.1.cmml" xref="S3.SS2.p2.3.m3.1.1.1.1.1.2.3.1"></times><ci id="S3.SS2.p2.3.m3.1.1.1.1.1.2.3.2.cmml" xref="S3.SS2.p2.3.m3.1.1.1.1.1.2.3.2">𝑒</ci><ci id="S3.SS2.p2.3.m3.1.1.1.1.1.2.3.3.cmml" xref="S3.SS2.p2.3.m3.1.1.1.1.1.2.3.3">𝑛</ci><ci id="S3.SS2.p2.3.m3.1.1.1.1.1.2.3.4.cmml" xref="S3.SS2.p2.3.m3.1.1.1.1.1.2.3.4">𝑐</ci></apply></apply><cn type="integer" id="S3.SS2.p2.3.m3.1.1.1.1.1.3.cmml" xref="S3.SS2.p2.3.m3.1.1.1.1.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m3.1c">n(D_{enc}+2)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.3.m3.1d">italic_n ( italic_D start_POSTSUBSCRIPT italic_e italic_n italic_c end_POSTSUBSCRIPT + 2 )</annotation></semantics></math> parameters, we could just set the dimension of the input vectors as <math id="S3.SS2.p2.4.m4.1" class="ltx_Math" alttext="d=n(D_{enc}+2)" display="inline"><semantics id="S3.SS2.p2.4.m4.1a"><mrow id="S3.SS2.p2.4.m4.1.1" xref="S3.SS2.p2.4.m4.1.1.cmml"><mi id="S3.SS2.p2.4.m4.1.1.3" xref="S3.SS2.p2.4.m4.1.1.3.cmml">d</mi><mo id="S3.SS2.p2.4.m4.1.1.2" xref="S3.SS2.p2.4.m4.1.1.2.cmml">=</mo><mrow id="S3.SS2.p2.4.m4.1.1.1" xref="S3.SS2.p2.4.m4.1.1.1.cmml"><mi id="S3.SS2.p2.4.m4.1.1.1.3" xref="S3.SS2.p2.4.m4.1.1.1.3.cmml">n</mi><mo id="S3.SS2.p2.4.m4.1.1.1.2" xref="S3.SS2.p2.4.m4.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS2.p2.4.m4.1.1.1.1.1" xref="S3.SS2.p2.4.m4.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p2.4.m4.1.1.1.1.1.2" xref="S3.SS2.p2.4.m4.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.p2.4.m4.1.1.1.1.1.1" xref="S3.SS2.p2.4.m4.1.1.1.1.1.1.cmml"><msub id="S3.SS2.p2.4.m4.1.1.1.1.1.1.2" xref="S3.SS2.p2.4.m4.1.1.1.1.1.1.2.cmml"><mi id="S3.SS2.p2.4.m4.1.1.1.1.1.1.2.2" xref="S3.SS2.p2.4.m4.1.1.1.1.1.1.2.2.cmml">D</mi><mrow id="S3.SS2.p2.4.m4.1.1.1.1.1.1.2.3" xref="S3.SS2.p2.4.m4.1.1.1.1.1.1.2.3.cmml"><mi id="S3.SS2.p2.4.m4.1.1.1.1.1.1.2.3.2" xref="S3.SS2.p2.4.m4.1.1.1.1.1.1.2.3.2.cmml">e</mi><mo id="S3.SS2.p2.4.m4.1.1.1.1.1.1.2.3.1" xref="S3.SS2.p2.4.m4.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p2.4.m4.1.1.1.1.1.1.2.3.3" xref="S3.SS2.p2.4.m4.1.1.1.1.1.1.2.3.3.cmml">n</mi><mo id="S3.SS2.p2.4.m4.1.1.1.1.1.1.2.3.1a" xref="S3.SS2.p2.4.m4.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p2.4.m4.1.1.1.1.1.1.2.3.4" xref="S3.SS2.p2.4.m4.1.1.1.1.1.1.2.3.4.cmml">c</mi></mrow></msub><mo id="S3.SS2.p2.4.m4.1.1.1.1.1.1.1" xref="S3.SS2.p2.4.m4.1.1.1.1.1.1.1.cmml">+</mo><mn id="S3.SS2.p2.4.m4.1.1.1.1.1.1.3" xref="S3.SS2.p2.4.m4.1.1.1.1.1.1.3.cmml">2</mn></mrow><mo stretchy="false" id="S3.SS2.p2.4.m4.1.1.1.1.1.3" xref="S3.SS2.p2.4.m4.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.4.m4.1b"><apply id="S3.SS2.p2.4.m4.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1"><eq id="S3.SS2.p2.4.m4.1.1.2.cmml" xref="S3.SS2.p2.4.m4.1.1.2"></eq><ci id="S3.SS2.p2.4.m4.1.1.3.cmml" xref="S3.SS2.p2.4.m4.1.1.3">𝑑</ci><apply id="S3.SS2.p2.4.m4.1.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1.1"><times id="S3.SS2.p2.4.m4.1.1.1.2.cmml" xref="S3.SS2.p2.4.m4.1.1.1.2"></times><ci id="S3.SS2.p2.4.m4.1.1.1.3.cmml" xref="S3.SS2.p2.4.m4.1.1.1.3">𝑛</ci><apply id="S3.SS2.p2.4.m4.1.1.1.1.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1.1.1.1"><plus id="S3.SS2.p2.4.m4.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1.1.1.1.1.1"></plus><apply id="S3.SS2.p2.4.m4.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p2.4.m4.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p2.4.m4.1.1.1.1.1.1.2.1.cmml" xref="S3.SS2.p2.4.m4.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.SS2.p2.4.m4.1.1.1.1.1.1.2.2.cmml" xref="S3.SS2.p2.4.m4.1.1.1.1.1.1.2.2">𝐷</ci><apply id="S3.SS2.p2.4.m4.1.1.1.1.1.1.2.3.cmml" xref="S3.SS2.p2.4.m4.1.1.1.1.1.1.2.3"><times id="S3.SS2.p2.4.m4.1.1.1.1.1.1.2.3.1.cmml" xref="S3.SS2.p2.4.m4.1.1.1.1.1.1.2.3.1"></times><ci id="S3.SS2.p2.4.m4.1.1.1.1.1.1.2.3.2.cmml" xref="S3.SS2.p2.4.m4.1.1.1.1.1.1.2.3.2">𝑒</ci><ci id="S3.SS2.p2.4.m4.1.1.1.1.1.1.2.3.3.cmml" xref="S3.SS2.p2.4.m4.1.1.1.1.1.1.2.3.3">𝑛</ci><ci id="S3.SS2.p2.4.m4.1.1.1.1.1.1.2.3.4.cmml" xref="S3.SS2.p2.4.m4.1.1.1.1.1.1.2.3.4">𝑐</ci></apply></apply><cn type="integer" id="S3.SS2.p2.4.m4.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p2.4.m4.1.1.1.1.1.1.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.4.m4.1c">d=n(D_{enc}+2)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.4.m4.1d">italic_d = italic_n ( italic_D start_POSTSUBSCRIPT italic_e italic_n italic_c end_POSTSUBSCRIPT + 2 )</annotation></semantics></math>. The depths of the query, key and value ansatzes are set to the same, and are at most the polynomial size of the qubit number <math id="S3.SS2.p2.5.m5.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S3.SS2.p2.5.m5.1a"><mi id="S3.SS2.p2.5.m5.1.1" xref="S3.SS2.p2.5.m5.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.5.m5.1b"><ci id="S3.SS2.p2.5.m5.1.1.cmml" xref="S3.SS2.p2.5.m5.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.5.m5.1c">n</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.5.m5.1d">italic_n</annotation></semantics></math>.
The actual hyper-parameter settings on different data sets are concluded in Table <a href="#S3.T1" title="Table 1 ‣ 3.1 Data Sets ‣ 3 Numerical Results ‣ Quantum Self-Attention Neural Networks for Text Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.
In addition, we choose <math id="S3.SS2.p2.6.m6.3" class="ltx_Math" alttext="Z_{1},\ldots,Z_{n}" display="inline"><semantics id="S3.SS2.p2.6.m6.3a"><mrow id="S3.SS2.p2.6.m6.3.3.2" xref="S3.SS2.p2.6.m6.3.3.3.cmml"><msub id="S3.SS2.p2.6.m6.2.2.1.1" xref="S3.SS2.p2.6.m6.2.2.1.1.cmml"><mi id="S3.SS2.p2.6.m6.2.2.1.1.2" xref="S3.SS2.p2.6.m6.2.2.1.1.2.cmml">Z</mi><mn id="S3.SS2.p2.6.m6.2.2.1.1.3" xref="S3.SS2.p2.6.m6.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.SS2.p2.6.m6.3.3.2.3" xref="S3.SS2.p2.6.m6.3.3.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.p2.6.m6.1.1" xref="S3.SS2.p2.6.m6.1.1.cmml">…</mi><mo id="S3.SS2.p2.6.m6.3.3.2.4" xref="S3.SS2.p2.6.m6.3.3.3.cmml">,</mo><msub id="S3.SS2.p2.6.m6.3.3.2.2" xref="S3.SS2.p2.6.m6.3.3.2.2.cmml"><mi id="S3.SS2.p2.6.m6.3.3.2.2.2" xref="S3.SS2.p2.6.m6.3.3.2.2.2.cmml">Z</mi><mi id="S3.SS2.p2.6.m6.3.3.2.2.3" xref="S3.SS2.p2.6.m6.3.3.2.2.3.cmml">n</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.6.m6.3b"><list id="S3.SS2.p2.6.m6.3.3.3.cmml" xref="S3.SS2.p2.6.m6.3.3.2"><apply id="S3.SS2.p2.6.m6.2.2.1.1.cmml" xref="S3.SS2.p2.6.m6.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.6.m6.2.2.1.1.1.cmml" xref="S3.SS2.p2.6.m6.2.2.1.1">subscript</csymbol><ci id="S3.SS2.p2.6.m6.2.2.1.1.2.cmml" xref="S3.SS2.p2.6.m6.2.2.1.1.2">𝑍</ci><cn type="integer" id="S3.SS2.p2.6.m6.2.2.1.1.3.cmml" xref="S3.SS2.p2.6.m6.2.2.1.1.3">1</cn></apply><ci id="S3.SS2.p2.6.m6.1.1.cmml" xref="S3.SS2.p2.6.m6.1.1">…</ci><apply id="S3.SS2.p2.6.m6.3.3.2.2.cmml" xref="S3.SS2.p2.6.m6.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS2.p2.6.m6.3.3.2.2.1.cmml" xref="S3.SS2.p2.6.m6.3.3.2.2">subscript</csymbol><ci id="S3.SS2.p2.6.m6.3.3.2.2.2.cmml" xref="S3.SS2.p2.6.m6.3.3.2.2.2">𝑍</ci><ci id="S3.SS2.p2.6.m6.3.3.2.2.3.cmml" xref="S3.SS2.p2.6.m6.3.3.2.2.3">𝑛</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.6.m6.3c">Z_{1},\ldots,Z_{n}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.6.m6.3d">italic_Z start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_Z start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT</annotation></semantics></math>, <math id="S3.SS2.p2.7.m7.3" class="ltx_Math" alttext="X_{1},\ldots,X_{n}" display="inline"><semantics id="S3.SS2.p2.7.m7.3a"><mrow id="S3.SS2.p2.7.m7.3.3.2" xref="S3.SS2.p2.7.m7.3.3.3.cmml"><msub id="S3.SS2.p2.7.m7.2.2.1.1" xref="S3.SS2.p2.7.m7.2.2.1.1.cmml"><mi id="S3.SS2.p2.7.m7.2.2.1.1.2" xref="S3.SS2.p2.7.m7.2.2.1.1.2.cmml">X</mi><mn id="S3.SS2.p2.7.m7.2.2.1.1.3" xref="S3.SS2.p2.7.m7.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.SS2.p2.7.m7.3.3.2.3" xref="S3.SS2.p2.7.m7.3.3.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.p2.7.m7.1.1" xref="S3.SS2.p2.7.m7.1.1.cmml">…</mi><mo id="S3.SS2.p2.7.m7.3.3.2.4" xref="S3.SS2.p2.7.m7.3.3.3.cmml">,</mo><msub id="S3.SS2.p2.7.m7.3.3.2.2" xref="S3.SS2.p2.7.m7.3.3.2.2.cmml"><mi id="S3.SS2.p2.7.m7.3.3.2.2.2" xref="S3.SS2.p2.7.m7.3.3.2.2.2.cmml">X</mi><mi id="S3.SS2.p2.7.m7.3.3.2.2.3" xref="S3.SS2.p2.7.m7.3.3.2.2.3.cmml">n</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.7.m7.3b"><list id="S3.SS2.p2.7.m7.3.3.3.cmml" xref="S3.SS2.p2.7.m7.3.3.2"><apply id="S3.SS2.p2.7.m7.2.2.1.1.cmml" xref="S3.SS2.p2.7.m7.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.7.m7.2.2.1.1.1.cmml" xref="S3.SS2.p2.7.m7.2.2.1.1">subscript</csymbol><ci id="S3.SS2.p2.7.m7.2.2.1.1.2.cmml" xref="S3.SS2.p2.7.m7.2.2.1.1.2">𝑋</ci><cn type="integer" id="S3.SS2.p2.7.m7.2.2.1.1.3.cmml" xref="S3.SS2.p2.7.m7.2.2.1.1.3">1</cn></apply><ci id="S3.SS2.p2.7.m7.1.1.cmml" xref="S3.SS2.p2.7.m7.1.1">…</ci><apply id="S3.SS2.p2.7.m7.3.3.2.2.cmml" xref="S3.SS2.p2.7.m7.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS2.p2.7.m7.3.3.2.2.1.cmml" xref="S3.SS2.p2.7.m7.3.3.2.2">subscript</csymbol><ci id="S3.SS2.p2.7.m7.3.3.2.2.2.cmml" xref="S3.SS2.p2.7.m7.3.3.2.2.2">𝑋</ci><ci id="S3.SS2.p2.7.m7.3.3.2.2.3.cmml" xref="S3.SS2.p2.7.m7.3.3.2.2.3">𝑛</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.7.m7.3c">X_{1},\ldots,X_{n}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.7.m7.3d">italic_X start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_X start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT</annotation></semantics></math>, <math id="S3.SS2.p2.8.m8.3" class="ltx_Math" alttext="Y_{1},\ldots,Y_{n}" display="inline"><semantics id="S3.SS2.p2.8.m8.3a"><mrow id="S3.SS2.p2.8.m8.3.3.2" xref="S3.SS2.p2.8.m8.3.3.3.cmml"><msub id="S3.SS2.p2.8.m8.2.2.1.1" xref="S3.SS2.p2.8.m8.2.2.1.1.cmml"><mi id="S3.SS2.p2.8.m8.2.2.1.1.2" xref="S3.SS2.p2.8.m8.2.2.1.1.2.cmml">Y</mi><mn id="S3.SS2.p2.8.m8.2.2.1.1.3" xref="S3.SS2.p2.8.m8.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.SS2.p2.8.m8.3.3.2.3" xref="S3.SS2.p2.8.m8.3.3.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.p2.8.m8.1.1" xref="S3.SS2.p2.8.m8.1.1.cmml">…</mi><mo id="S3.SS2.p2.8.m8.3.3.2.4" xref="S3.SS2.p2.8.m8.3.3.3.cmml">,</mo><msub id="S3.SS2.p2.8.m8.3.3.2.2" xref="S3.SS2.p2.8.m8.3.3.2.2.cmml"><mi id="S3.SS2.p2.8.m8.3.3.2.2.2" xref="S3.SS2.p2.8.m8.3.3.2.2.2.cmml">Y</mi><mi id="S3.SS2.p2.8.m8.3.3.2.2.3" xref="S3.SS2.p2.8.m8.3.3.2.2.3.cmml">n</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.8.m8.3b"><list id="S3.SS2.p2.8.m8.3.3.3.cmml" xref="S3.SS2.p2.8.m8.3.3.2"><apply id="S3.SS2.p2.8.m8.2.2.1.1.cmml" xref="S3.SS2.p2.8.m8.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.8.m8.2.2.1.1.1.cmml" xref="S3.SS2.p2.8.m8.2.2.1.1">subscript</csymbol><ci id="S3.SS2.p2.8.m8.2.2.1.1.2.cmml" xref="S3.SS2.p2.8.m8.2.2.1.1.2">𝑌</ci><cn type="integer" id="S3.SS2.p2.8.m8.2.2.1.1.3.cmml" xref="S3.SS2.p2.8.m8.2.2.1.1.3">1</cn></apply><ci id="S3.SS2.p2.8.m8.1.1.cmml" xref="S3.SS2.p2.8.m8.1.1">…</ci><apply id="S3.SS2.p2.8.m8.3.3.2.2.cmml" xref="S3.SS2.p2.8.m8.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS2.p2.8.m8.3.3.2.2.1.cmml" xref="S3.SS2.p2.8.m8.3.3.2.2">subscript</csymbol><ci id="S3.SS2.p2.8.m8.3.3.2.2.2.cmml" xref="S3.SS2.p2.8.m8.3.3.2.2.2">𝑌</ci><ci id="S3.SS2.p2.8.m8.3.3.2.2.3.cmml" xref="S3.SS2.p2.8.m8.3.3.2.2.3">𝑛</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.8.m8.3c">Y_{1},\ldots,Y_{n}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.8.m8.3d">italic_Y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_Y start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT</annotation></semantics></math> as the Pauli observables <math id="S3.SS2.p2.9.m9.1" class="ltx_Math" alttext="P_{j}" display="inline"><semantics id="S3.SS2.p2.9.m9.1a"><msub id="S3.SS2.p2.9.m9.1.1" xref="S3.SS2.p2.9.m9.1.1.cmml"><mi id="S3.SS2.p2.9.m9.1.1.2" xref="S3.SS2.p2.9.m9.1.1.2.cmml">P</mi><mi id="S3.SS2.p2.9.m9.1.1.3" xref="S3.SS2.p2.9.m9.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.9.m9.1b"><apply id="S3.SS2.p2.9.m9.1.1.cmml" xref="S3.SS2.p2.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.9.m9.1.1.1.cmml" xref="S3.SS2.p2.9.m9.1.1">subscript</csymbol><ci id="S3.SS2.p2.9.m9.1.1.2.cmml" xref="S3.SS2.p2.9.m9.1.1.2">𝑃</ci><ci id="S3.SS2.p2.9.m9.1.1.3.cmml" xref="S3.SS2.p2.9.m9.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.9.m9.1c">P_{j}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.9.m9.1d">italic_P start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> in Eq. (<a href="#S2.E14" title="(14) ‣ 2.1 Quantum Self-Attention Layer ‣ 2 Method ‣ Quantum Self-Attention Neural Networks for Text Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">14</span></a>). For example, it is just required <math id="S3.SS2.p2.10.m10.1" class="ltx_Math" alttext="3n" display="inline"><semantics id="S3.SS2.p2.10.m10.1a"><mrow id="S3.SS2.p2.10.m10.1.1" xref="S3.SS2.p2.10.m10.1.1.cmml"><mn id="S3.SS2.p2.10.m10.1.1.2" xref="S3.SS2.p2.10.m10.1.1.2.cmml">3</mn><mo id="S3.SS2.p2.10.m10.1.1.1" xref="S3.SS2.p2.10.m10.1.1.1.cmml">⁢</mo><mi id="S3.SS2.p2.10.m10.1.1.3" xref="S3.SS2.p2.10.m10.1.1.3.cmml">n</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.10.m10.1b"><apply id="S3.SS2.p2.10.m10.1.1.cmml" xref="S3.SS2.p2.10.m10.1.1"><times id="S3.SS2.p2.10.m10.1.1.1.cmml" xref="S3.SS2.p2.10.m10.1.1.1"></times><cn type="integer" id="S3.SS2.p2.10.m10.1.1.2.cmml" xref="S3.SS2.p2.10.m10.1.1.2">3</cn><ci id="S3.SS2.p2.10.m10.1.1.3.cmml" xref="S3.SS2.p2.10.m10.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.10.m10.1c">3n</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.10.m10.1d">3 italic_n</annotation></semantics></math> observables when <math id="S3.SS2.p2.11.m11.1" class="ltx_Math" alttext="D_{enc}=1" display="inline"><semantics id="S3.SS2.p2.11.m11.1a"><mrow id="S3.SS2.p2.11.m11.1.1" xref="S3.SS2.p2.11.m11.1.1.cmml"><msub id="S3.SS2.p2.11.m11.1.1.2" xref="S3.SS2.p2.11.m11.1.1.2.cmml"><mi id="S3.SS2.p2.11.m11.1.1.2.2" xref="S3.SS2.p2.11.m11.1.1.2.2.cmml">D</mi><mrow id="S3.SS2.p2.11.m11.1.1.2.3" xref="S3.SS2.p2.11.m11.1.1.2.3.cmml"><mi id="S3.SS2.p2.11.m11.1.1.2.3.2" xref="S3.SS2.p2.11.m11.1.1.2.3.2.cmml">e</mi><mo id="S3.SS2.p2.11.m11.1.1.2.3.1" xref="S3.SS2.p2.11.m11.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p2.11.m11.1.1.2.3.3" xref="S3.SS2.p2.11.m11.1.1.2.3.3.cmml">n</mi><mo id="S3.SS2.p2.11.m11.1.1.2.3.1a" xref="S3.SS2.p2.11.m11.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p2.11.m11.1.1.2.3.4" xref="S3.SS2.p2.11.m11.1.1.2.3.4.cmml">c</mi></mrow></msub><mo id="S3.SS2.p2.11.m11.1.1.1" xref="S3.SS2.p2.11.m11.1.1.1.cmml">=</mo><mn id="S3.SS2.p2.11.m11.1.1.3" xref="S3.SS2.p2.11.m11.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.11.m11.1b"><apply id="S3.SS2.p2.11.m11.1.1.cmml" xref="S3.SS2.p2.11.m11.1.1"><eq id="S3.SS2.p2.11.m11.1.1.1.cmml" xref="S3.SS2.p2.11.m11.1.1.1"></eq><apply id="S3.SS2.p2.11.m11.1.1.2.cmml" xref="S3.SS2.p2.11.m11.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p2.11.m11.1.1.2.1.cmml" xref="S3.SS2.p2.11.m11.1.1.2">subscript</csymbol><ci id="S3.SS2.p2.11.m11.1.1.2.2.cmml" xref="S3.SS2.p2.11.m11.1.1.2.2">𝐷</ci><apply id="S3.SS2.p2.11.m11.1.1.2.3.cmml" xref="S3.SS2.p2.11.m11.1.1.2.3"><times id="S3.SS2.p2.11.m11.1.1.2.3.1.cmml" xref="S3.SS2.p2.11.m11.1.1.2.3.1"></times><ci id="S3.SS2.p2.11.m11.1.1.2.3.2.cmml" xref="S3.SS2.p2.11.m11.1.1.2.3.2">𝑒</ci><ci id="S3.SS2.p2.11.m11.1.1.2.3.3.cmml" xref="S3.SS2.p2.11.m11.1.1.2.3.3">𝑛</ci><ci id="S3.SS2.p2.11.m11.1.1.2.3.4.cmml" xref="S3.SS2.p2.11.m11.1.1.2.3.4">𝑐</ci></apply></apply><cn type="integer" id="S3.SS2.p2.11.m11.1.1.3.cmml" xref="S3.SS2.p2.11.m11.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.11.m11.1c">D_{enc}=1</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.11.m11.1d">italic_D start_POSTSUBSCRIPT italic_e italic_n italic_c end_POSTSUBSCRIPT = 1</annotation></semantics></math>. However, if <math id="S3.SS2.p2.12.m12.1" class="ltx_Math" alttext="D_{enc}&gt;1" display="inline"><semantics id="S3.SS2.p2.12.m12.1a"><mrow id="S3.SS2.p2.12.m12.1.1" xref="S3.SS2.p2.12.m12.1.1.cmml"><msub id="S3.SS2.p2.12.m12.1.1.2" xref="S3.SS2.p2.12.m12.1.1.2.cmml"><mi id="S3.SS2.p2.12.m12.1.1.2.2" xref="S3.SS2.p2.12.m12.1.1.2.2.cmml">D</mi><mrow id="S3.SS2.p2.12.m12.1.1.2.3" xref="S3.SS2.p2.12.m12.1.1.2.3.cmml"><mi id="S3.SS2.p2.12.m12.1.1.2.3.2" xref="S3.SS2.p2.12.m12.1.1.2.3.2.cmml">e</mi><mo id="S3.SS2.p2.12.m12.1.1.2.3.1" xref="S3.SS2.p2.12.m12.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p2.12.m12.1.1.2.3.3" xref="S3.SS2.p2.12.m12.1.1.2.3.3.cmml">n</mi><mo id="S3.SS2.p2.12.m12.1.1.2.3.1a" xref="S3.SS2.p2.12.m12.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p2.12.m12.1.1.2.3.4" xref="S3.SS2.p2.12.m12.1.1.2.3.4.cmml">c</mi></mrow></msub><mo id="S3.SS2.p2.12.m12.1.1.1" xref="S3.SS2.p2.12.m12.1.1.1.cmml">&gt;</mo><mn id="S3.SS2.p2.12.m12.1.1.3" xref="S3.SS2.p2.12.m12.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.12.m12.1b"><apply id="S3.SS2.p2.12.m12.1.1.cmml" xref="S3.SS2.p2.12.m12.1.1"><gt id="S3.SS2.p2.12.m12.1.1.1.cmml" xref="S3.SS2.p2.12.m12.1.1.1"></gt><apply id="S3.SS2.p2.12.m12.1.1.2.cmml" xref="S3.SS2.p2.12.m12.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p2.12.m12.1.1.2.1.cmml" xref="S3.SS2.p2.12.m12.1.1.2">subscript</csymbol><ci id="S3.SS2.p2.12.m12.1.1.2.2.cmml" xref="S3.SS2.p2.12.m12.1.1.2.2">𝐷</ci><apply id="S3.SS2.p2.12.m12.1.1.2.3.cmml" xref="S3.SS2.p2.12.m12.1.1.2.3"><times id="S3.SS2.p2.12.m12.1.1.2.3.1.cmml" xref="S3.SS2.p2.12.m12.1.1.2.3.1"></times><ci id="S3.SS2.p2.12.m12.1.1.2.3.2.cmml" xref="S3.SS2.p2.12.m12.1.1.2.3.2">𝑒</ci><ci id="S3.SS2.p2.12.m12.1.1.2.3.3.cmml" xref="S3.SS2.p2.12.m12.1.1.2.3.3">𝑛</ci><ci id="S3.SS2.p2.12.m12.1.1.2.3.4.cmml" xref="S3.SS2.p2.12.m12.1.1.2.3.4">𝑐</ci></apply></apply><cn type="integer" id="S3.SS2.p2.12.m12.1.1.3.cmml" xref="S3.SS2.p2.12.m12.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.12.m12.1c">D_{enc}&gt;1</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.12.m12.1d">italic_D start_POSTSUBSCRIPT italic_e italic_n italic_c end_POSTSUBSCRIPT &gt; 1</annotation></semantics></math>, we could also choose two-qubit observables <math id="S3.SS2.p2.13.m13.2" class="ltx_Math" alttext="Z_{12},Z_{23}" display="inline"><semantics id="S3.SS2.p2.13.m13.2a"><mrow id="S3.SS2.p2.13.m13.2.2.2" xref="S3.SS2.p2.13.m13.2.2.3.cmml"><msub id="S3.SS2.p2.13.m13.1.1.1.1" xref="S3.SS2.p2.13.m13.1.1.1.1.cmml"><mi id="S3.SS2.p2.13.m13.1.1.1.1.2" xref="S3.SS2.p2.13.m13.1.1.1.1.2.cmml">Z</mi><mn id="S3.SS2.p2.13.m13.1.1.1.1.3" xref="S3.SS2.p2.13.m13.1.1.1.1.3.cmml">12</mn></msub><mo id="S3.SS2.p2.13.m13.2.2.2.3" xref="S3.SS2.p2.13.m13.2.2.3.cmml">,</mo><msub id="S3.SS2.p2.13.m13.2.2.2.2" xref="S3.SS2.p2.13.m13.2.2.2.2.cmml"><mi id="S3.SS2.p2.13.m13.2.2.2.2.2" xref="S3.SS2.p2.13.m13.2.2.2.2.2.cmml">Z</mi><mn id="S3.SS2.p2.13.m13.2.2.2.2.3" xref="S3.SS2.p2.13.m13.2.2.2.2.3.cmml">23</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.13.m13.2b"><list id="S3.SS2.p2.13.m13.2.2.3.cmml" xref="S3.SS2.p2.13.m13.2.2.2"><apply id="S3.SS2.p2.13.m13.1.1.1.1.cmml" xref="S3.SS2.p2.13.m13.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.13.m13.1.1.1.1.1.cmml" xref="S3.SS2.p2.13.m13.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p2.13.m13.1.1.1.1.2.cmml" xref="S3.SS2.p2.13.m13.1.1.1.1.2">𝑍</ci><cn type="integer" id="S3.SS2.p2.13.m13.1.1.1.1.3.cmml" xref="S3.SS2.p2.13.m13.1.1.1.1.3">12</cn></apply><apply id="S3.SS2.p2.13.m13.2.2.2.2.cmml" xref="S3.SS2.p2.13.m13.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p2.13.m13.2.2.2.2.1.cmml" xref="S3.SS2.p2.13.m13.2.2.2.2">subscript</csymbol><ci id="S3.SS2.p2.13.m13.2.2.2.2.2.cmml" xref="S3.SS2.p2.13.m13.2.2.2.2.2">𝑍</ci><cn type="integer" id="S3.SS2.p2.13.m13.2.2.2.2.3.cmml" xref="S3.SS2.p2.13.m13.2.2.2.2.3">23</cn></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.13.m13.2c">Z_{12},Z_{23}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.13.m13.2d">italic_Z start_POSTSUBSCRIPT 12 end_POSTSUBSCRIPT , italic_Z start_POSTSUBSCRIPT 23 end_POSTSUBSCRIPT</annotation></semantics></math> and so on.
All the ansatz parameters <math id="S3.SS2.p2.14.m14.1" class="ltx_Math" alttext="\bm{\Theta}" display="inline"><semantics id="S3.SS2.p2.14.m14.1a"><mi id="S3.SS2.p2.14.m14.1.1" xref="S3.SS2.p2.14.m14.1.1.cmml">𝚯</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.14.m14.1b"><ci id="S3.SS2.p2.14.m14.1.1.cmml" xref="S3.SS2.p2.14.m14.1.1">𝚯</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.14.m14.1c">\bm{\Theta}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.14.m14.1d">bold_Θ</annotation></semantics></math> and weight <math id="S3.SS2.p2.15.m15.1" class="ltx_Math" alttext="\bm{w}" display="inline"><semantics id="S3.SS2.p2.15.m15.1a"><mi id="S3.SS2.p2.15.m15.1.1" xref="S3.SS2.p2.15.m15.1.1.cmml">𝒘</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.15.m15.1b"><ci id="S3.SS2.p2.15.m15.1.1.cmml" xref="S3.SS2.p2.15.m15.1.1">𝒘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.15.m15.1c">\bm{w}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.15.m15.1d">bold_italic_w</annotation></semantics></math> are initialized from a Gaussian distribution with zero mean and 0.01 standard deviation, and the bias <math id="S3.SS2.p2.16.m16.1" class="ltx_Math" alttext="b" display="inline"><semantics id="S3.SS2.p2.16.m16.1a"><mi id="S3.SS2.p2.16.m16.1.1" xref="S3.SS2.p2.16.m16.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.16.m16.1b"><ci id="S3.SS2.p2.16.m16.1.1.cmml" xref="S3.SS2.p2.16.m16.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.16.m16.1c">b</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.16.m16.1d">italic_b</annotation></semantics></math> is initialized to zero.
Here, the ansatz parameters are not initialized uniformly from <math id="S3.SS2.p2.17.m17.2" class="ltx_Math" alttext="[0,2\pi)" display="inline"><semantics id="S3.SS2.p2.17.m17.2a"><mrow id="S3.SS2.p2.17.m17.2.2.1" xref="S3.SS2.p2.17.m17.2.2.2.cmml"><mo stretchy="false" id="S3.SS2.p2.17.m17.2.2.1.2" xref="S3.SS2.p2.17.m17.2.2.2.cmml">[</mo><mn id="S3.SS2.p2.17.m17.1.1" xref="S3.SS2.p2.17.m17.1.1.cmml">0</mn><mo id="S3.SS2.p2.17.m17.2.2.1.3" xref="S3.SS2.p2.17.m17.2.2.2.cmml">,</mo><mrow id="S3.SS2.p2.17.m17.2.2.1.1" xref="S3.SS2.p2.17.m17.2.2.1.1.cmml"><mn id="S3.SS2.p2.17.m17.2.2.1.1.2" xref="S3.SS2.p2.17.m17.2.2.1.1.2.cmml">2</mn><mo id="S3.SS2.p2.17.m17.2.2.1.1.1" xref="S3.SS2.p2.17.m17.2.2.1.1.1.cmml">⁢</mo><mi id="S3.SS2.p2.17.m17.2.2.1.1.3" xref="S3.SS2.p2.17.m17.2.2.1.1.3.cmml">π</mi></mrow><mo stretchy="false" id="S3.SS2.p2.17.m17.2.2.1.4" xref="S3.SS2.p2.17.m17.2.2.2.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.17.m17.2b"><interval closure="closed-open" id="S3.SS2.p2.17.m17.2.2.2.cmml" xref="S3.SS2.p2.17.m17.2.2.1"><cn type="integer" id="S3.SS2.p2.17.m17.1.1.cmml" xref="S3.SS2.p2.17.m17.1.1">0</cn><apply id="S3.SS2.p2.17.m17.2.2.1.1.cmml" xref="S3.SS2.p2.17.m17.2.2.1.1"><times id="S3.SS2.p2.17.m17.2.2.1.1.1.cmml" xref="S3.SS2.p2.17.m17.2.2.1.1.1"></times><cn type="integer" id="S3.SS2.p2.17.m17.2.2.1.1.2.cmml" xref="S3.SS2.p2.17.m17.2.2.1.1.2">2</cn><ci id="S3.SS2.p2.17.m17.2.2.1.1.3.cmml" xref="S3.SS2.p2.17.m17.2.2.1.1.3">𝜋</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.17.m17.2c">[0,2\pi)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.17.m17.2d">[ 0 , 2 italic_π )</annotation></semantics></math> is mainly due to the residual scheme applied in Eq. (<a href="#S2.E15" title="(15) ‣ 2.1 Quantum Self-Attention Layer ‣ 2 Method ‣ Quantum Self-Attention Neural Networks for Text Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">15</span></a>).
During the optimization iteration, we use Adam optimizer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib51" title="" class="ltx_ref">51</a>]</cite>. And we repeat each experiment 9 times with different parameter initializations to collect the average accuracy and the corresponding fluctuations.</p>
</div>
<div id="S3.SS2.p3" class="ltx_para">
<p id="S3.SS2.p3.1" class="ltx_p">In CSANN, we set <math id="S3.SS2.p3.1.m1.1" class="ltx_Math" alttext="d=16" display="inline"><semantics id="S3.SS2.p3.1.m1.1a"><mrow id="S3.SS2.p3.1.m1.1.1" xref="S3.SS2.p3.1.m1.1.1.cmml"><mi id="S3.SS2.p3.1.m1.1.1.2" xref="S3.SS2.p3.1.m1.1.1.2.cmml">d</mi><mo id="S3.SS2.p3.1.m1.1.1.1" xref="S3.SS2.p3.1.m1.1.1.1.cmml">=</mo><mn id="S3.SS2.p3.1.m1.1.1.3" xref="S3.SS2.p3.1.m1.1.1.3.cmml">16</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.1.m1.1b"><apply id="S3.SS2.p3.1.m1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1"><eq id="S3.SS2.p3.1.m1.1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1.1"></eq><ci id="S3.SS2.p3.1.m1.1.1.2.cmml" xref="S3.SS2.p3.1.m1.1.1.2">𝑑</ci><cn type="integer" id="S3.SS2.p3.1.m1.1.1.3.cmml" xref="S3.SS2.p3.1.m1.1.1.3">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.1.m1.1c">d=16</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.1.m1.1d">italic_d = 16</annotation></semantics></math> and the classical query, key and value matrices are also initialized from a Gaussian distribution with zero mean and 0.01 standard deviation. Except these, almost all other parameters are set the same as QSANN. These settings and initializations are the same in the naive method as well.
</p>
</div>
<figure id="S3.T2" class="ltx_table">
<table id="S3.T2.2" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="S3.T2.2.3" class="ltx_tr">
<td id="S3.T2.2.3.1" class="ltx_td ltx_align_center ltx_border_tt" rowspan="2"><span id="S3.T2.2.3.1.1" class="ltx_text">Method</span></td>
<td id="S3.T2.2.3.2" class="ltx_td ltx_align_center ltx_border_tt" colspan="3">MC</td>
<td id="S3.T2.2.3.3" class="ltx_td ltx_align_center ltx_border_tt" colspan="3">RP</td>
</tr>
<tr id="S3.T2.2.4" class="ltx_tr">
<td id="S3.T2.2.4.1" class="ltx_td ltx_align_center ltx_border_t"># Paras</td>
<td id="S3.T2.2.4.2" class="ltx_td ltx_align_center ltx_border_t">TrainAcc(%)</td>
<td id="S3.T2.2.4.3" class="ltx_td ltx_align_center ltx_border_t">TestAcc(%)</td>
<td id="S3.T2.2.4.4" class="ltx_td ltx_align_center ltx_border_t"># Paras</td>
<td id="S3.T2.2.4.5" class="ltx_td ltx_align_center ltx_border_t">TrainAcc(%)</td>
<td id="S3.T2.2.4.6" class="ltx_td ltx_align_center ltx_border_t">TestAcc(%)</td>
</tr>
<tr id="S3.T2.2.5" class="ltx_tr">
<td id="S3.T2.2.5.1" class="ltx_td ltx_align_center ltx_border_t">DisCoCat <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite>
</td>
<td id="S3.T2.2.5.2" class="ltx_td ltx_align_center ltx_border_t">40</td>
<td id="S3.T2.2.5.3" class="ltx_td ltx_align_center ltx_border_t">83.10</td>
<td id="S3.T2.2.5.4" class="ltx_td ltx_align_center ltx_border_t">79.80</td>
<td id="S3.T2.2.5.5" class="ltx_td ltx_align_center ltx_border_t">168</td>
<td id="S3.T2.2.5.6" class="ltx_td ltx_align_center ltx_border_t">90.60</td>
<td id="S3.T2.2.5.7" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.2.5.7.1" class="ltx_text ltx_font_bold">72.30</span></td>
</tr>
<tr id="S3.T2.2.2" class="ltx_tr">
<td id="S3.T2.2.2.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">QSANN</td>
<td id="S3.T2.2.2.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">25</td>
<td id="S3.T2.2.2.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S3.T2.2.2.5.1" class="ltx_text ltx_font_bold">100.00</span></td>
<td id="S3.T2.2.2.6" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S3.T2.2.2.6.1" class="ltx_text ltx_font_bold">100.00</span></td>
<td id="S3.T2.2.2.7" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">109</td>
<td id="S3.T2.1.1.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S3.T2.1.1.1.1" class="ltx_text ltx_font_bold">95.35<math id="S3.T2.1.1.1.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T2.1.1.1.1.m1.1a"><mo mathvariant="normal" id="S3.T2.1.1.1.1.m1.1.1" xref="S3.T2.1.1.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.1.1.1.1.m1.1b"><csymbol cd="latexml" id="S3.T2.1.1.1.1.m1.1.1.cmml" xref="S3.T2.1.1.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.1.1.1.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T2.1.1.1.1.m1.1d">±</annotation></semantics></math>1.95</span></td>
<td id="S3.T2.2.2.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">67.74<math id="S3.T2.2.2.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T2.2.2.2.m1.1a"><mo id="S3.T2.2.2.2.m1.1.1" xref="S3.T2.2.2.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.2.2.2.m1.1b"><csymbol cd="latexml" id="S3.T2.2.2.2.m1.1.1.cmml" xref="S3.T2.2.2.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.2.2.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T2.2.2.2.m1.1d">±</annotation></semantics></math>0.00</td>
</tr>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>Training accuracy and test accuracy of QSANN as well as DisCoCat on MC and RP tasks.</figcaption>
</figure>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Results on MC and RP Tasks</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.1" class="ltx_p">The results on MC and RP tasks are summarized in Table <a href="#S3.T2" title="Table 2 ‣ 3.2 Experimental Setting ‣ 3 Numerical Results ‣ Quantum Self-Attention Neural Networks for Text Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. In the MC task, our method QSANN could easily achieve a 100% test accuracy while requiring only 25 parameters (18 in query-key-value part and 7 in fully-connected part). However, in DisCoCat, the authors use 40 parameters but get a test accuracy lower than 80%. This result strongly demonstrates the powerful ability of QSANN for binary text classification. Here, the parameters in the encoder part are not counted as they could be replaced by fixed representations such as pre-trained word embeddings.
In the RP task, we get a higher training accuracy but a slightly lower test accuracy. However, we observe that both test accuracies are pretty low when compared with the training accuracy. It is mainly because there is a massive bias between the training set and test set, i.e., more than half of the words in the test set have not appeared in the training one. Hence, the test accuracy highly depends on random guessing.</p>
</div>
<figure id="S3.T3" class="ltx_table">
<table id="S3.T3.9" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="S3.T3.9.10" class="ltx_tr">
<td id="S3.T3.9.10.1" class="ltx_td ltx_align_center ltx_border_tt" rowspan="2"><span id="S3.T3.9.10.1.1" class="ltx_text">Method</span></td>
<td id="S3.T3.9.10.2" class="ltx_td ltx_align_center ltx_border_tt" colspan="2">Yelp</td>
<td id="S3.T3.9.10.3" class="ltx_td ltx_align_center ltx_border_tt" colspan="2">IMDb</td>
<td id="S3.T3.9.10.4" class="ltx_td ltx_align_center ltx_border_tt" colspan="2">Amazon</td>
</tr>
<tr id="S3.T3.9.11" class="ltx_tr">
<td id="S3.T3.9.11.1" class="ltx_td ltx_align_center ltx_border_t"># Paras</td>
<td id="S3.T3.9.11.2" class="ltx_td ltx_align_center ltx_border_t">TestAcc (%)</td>
<td id="S3.T3.9.11.3" class="ltx_td ltx_align_center ltx_border_t"># Paras</td>
<td id="S3.T3.9.11.4" class="ltx_td ltx_align_center ltx_border_t">TestAcc (%)</td>
<td id="S3.T3.9.11.5" class="ltx_td ltx_align_center ltx_border_t"># Paras</td>
<td id="S3.T3.9.11.6" class="ltx_td ltx_align_center ltx_border_t">TestAcc (%)</td>
</tr>
<tr id="S3.T3.3.3" class="ltx_tr">
<td id="S3.T3.3.3.4" class="ltx_td ltx_align_center ltx_border_t">Naive</td>
<td id="S3.T3.3.3.5" class="ltx_td ltx_align_center ltx_border_t">17</td>
<td id="S3.T3.1.1.1" class="ltx_td ltx_align_center ltx_border_t">82.78<math id="S3.T3.1.1.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T3.1.1.1.m1.1a"><mo id="S3.T3.1.1.1.m1.1.1" xref="S3.T3.1.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T3.1.1.1.m1.1b"><csymbol cd="latexml" id="S3.T3.1.1.1.m1.1.1.cmml" xref="S3.T3.1.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.1.1.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T3.1.1.1.m1.1d">±</annotation></semantics></math>0.78</td>
<td id="S3.T3.3.3.6" class="ltx_td ltx_align_center ltx_border_t">17</td>
<td id="S3.T3.2.2.2" class="ltx_td ltx_align_center ltx_border_t">79.33<math id="S3.T3.2.2.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T3.2.2.2.m1.1a"><mo id="S3.T3.2.2.2.m1.1.1" xref="S3.T3.2.2.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T3.2.2.2.m1.1b"><csymbol cd="latexml" id="S3.T3.2.2.2.m1.1.1.cmml" xref="S3.T3.2.2.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.2.2.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T3.2.2.2.m1.1d">±</annotation></semantics></math>0.67</td>
<td id="S3.T3.3.3.7" class="ltx_td ltx_align_center ltx_border_t">17</td>
<td id="S3.T3.3.3.3" class="ltx_td ltx_align_center ltx_border_t">80.39<math id="S3.T3.3.3.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T3.3.3.3.m1.1a"><mo id="S3.T3.3.3.3.m1.1.1" xref="S3.T3.3.3.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T3.3.3.3.m1.1b"><csymbol cd="latexml" id="S3.T3.3.3.3.m1.1.1.cmml" xref="S3.T3.3.3.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.3.3.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T3.3.3.3.m1.1d">±</annotation></semantics></math>0.61</td>
</tr>
<tr id="S3.T3.6.6" class="ltx_tr">
<td id="S3.T3.6.6.4" class="ltx_td ltx_align_center ltx_border_t">CSANN</td>
<td id="S3.T3.6.6.5" class="ltx_td ltx_align_center ltx_border_t">785</td>
<td id="S3.T3.4.4.1" class="ltx_td ltx_align_center ltx_border_t">83.11<math id="S3.T3.4.4.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T3.4.4.1.m1.1a"><mo id="S3.T3.4.4.1.m1.1.1" xref="S3.T3.4.4.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T3.4.4.1.m1.1b"><csymbol cd="latexml" id="S3.T3.4.4.1.m1.1.1.cmml" xref="S3.T3.4.4.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.4.4.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T3.4.4.1.m1.1d">±</annotation></semantics></math>0.89</td>
<td id="S3.T3.6.6.6" class="ltx_td ltx_align_center ltx_border_t">785</td>
<td id="S3.T3.5.5.2" class="ltx_td ltx_align_center ltx_border_t">79.67<math id="S3.T3.5.5.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T3.5.5.2.m1.1a"><mo id="S3.T3.5.5.2.m1.1.1" xref="S3.T3.5.5.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T3.5.5.2.m1.1b"><csymbol cd="latexml" id="S3.T3.5.5.2.m1.1.1.cmml" xref="S3.T3.5.5.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.5.5.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T3.5.5.2.m1.1d">±</annotation></semantics></math>0.83</td>
<td id="S3.T3.6.6.7" class="ltx_td ltx_align_center ltx_border_t">785</td>
<td id="S3.T3.6.6.3" class="ltx_td ltx_align_center ltx_border_t">83.22<math id="S3.T3.6.6.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T3.6.6.3.m1.1a"><mo id="S3.T3.6.6.3.m1.1.1" xref="S3.T3.6.6.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T3.6.6.3.m1.1b"><csymbol cd="latexml" id="S3.T3.6.6.3.m1.1.1.cmml" xref="S3.T3.6.6.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.6.6.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T3.6.6.3.m1.1d">±</annotation></semantics></math>1.28</td>
</tr>
<tr id="S3.T3.9.9" class="ltx_tr">
<td id="S3.T3.9.9.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">QSANN</td>
<td id="S3.T3.9.9.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">49</td>
<td id="S3.T3.7.7.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S3.T3.7.7.1.1" class="ltx_text ltx_font_bold">84.79<math id="S3.T3.7.7.1.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T3.7.7.1.1.m1.1a"><mo mathvariant="normal" id="S3.T3.7.7.1.1.m1.1.1" xref="S3.T3.7.7.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T3.7.7.1.1.m1.1b"><csymbol cd="latexml" id="S3.T3.7.7.1.1.m1.1.1.cmml" xref="S3.T3.7.7.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.7.7.1.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T3.7.7.1.1.m1.1d">±</annotation></semantics></math>1.29</span></td>
<td id="S3.T3.9.9.6" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">49</td>
<td id="S3.T3.8.8.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S3.T3.8.8.2.1" class="ltx_text ltx_font_bold">80.28<math id="S3.T3.8.8.2.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T3.8.8.2.1.m1.1a"><mo mathvariant="normal" id="S3.T3.8.8.2.1.m1.1.1" xref="S3.T3.8.8.2.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T3.8.8.2.1.m1.1b"><csymbol cd="latexml" id="S3.T3.8.8.2.1.m1.1.1.cmml" xref="S3.T3.8.8.2.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.8.8.2.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T3.8.8.2.1.m1.1d">±</annotation></semantics></math>1.78</span></td>
<td id="S3.T3.9.9.7" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">61</td>
<td id="S3.T3.9.9.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S3.T3.9.9.3.1" class="ltx_text ltx_font_bold">84.25<math id="S3.T3.9.9.3.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T3.9.9.3.1.m1.1a"><mo mathvariant="normal" id="S3.T3.9.9.3.1.m1.1.1" xref="S3.T3.9.9.3.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T3.9.9.3.1.m1.1b"><csymbol cd="latexml" id="S3.T3.9.9.3.1.m1.1.1.cmml" xref="S3.T3.9.9.3.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.9.9.3.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T3.9.9.3.1.m1.1d">±</annotation></semantics></math>1.75</span></td>
</tr>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>Test accuracy of QSANN compared to CSANN and the naive method on Yelp, IMDb, and Amazon data sets. The highest accuracy in each column is indicated in bold font. On all the three data sets, QSANN achieves the highest accuracies among the three methods while using much fewer parameters than CSANN.</figcaption>
</figure>
</section>
<section id="S3.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4 </span>Results on Yelp, IMDb and Amazon Data Sets</h3>

<div id="S3.SS4.p1" class="ltx_para">
<p id="S3.SS4.p1.1" class="ltx_p">As there are no quantum algorithms for text classification on these three data sets before, we benchmark our QSANN with the classical self-attention neural network (CSANN). The naive method is also listed for comparison.
The results on Yelp, IMDb and Amazon data sets are summarized in Table <a href="#S3.T3" title="Table 3 ‣ 3.3 Results on MC and RP Tasks ‣ 3 Numerical Results ‣ Quantum Self-Attention Neural Networks for Text Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>. We can intuitively see that QSANN outperforms CSANN and the naive method on all three data sets. Specifically, CSANN has 785 parameters (768 in classical query-key-value part and 17 in fully-connected part) on all data sets. In comparison, QSANN has only 49 parameters (36 in query-key-value part and 13 in fully-connected part) on the Yelp and IMDb data sets and 61 parameters (48 in query-key-value part and 13 in fully-connected part) on the Amazon data set, improving the test accuracy by about 1% as well as saving more than 10 times the number of parameters.
Therefore, QSANN could have a potential advantage for text classification.</p>
</div>
<figure id="S3.F4" class="ltx_figure"><img src="/html/2205.05625/assets/graph/QSA_visualize.png" id="S3.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="419" height="257" alt="Heat maps of the averaged quantum self-attention coefficients for some selected test sequences from the Yelp data set, where a deeper color indicates a higher coefficient. Words that are more sentiment-related are generally assigned higher self-attention coefficients by our Gaussian projected quantum self-attention, implying the validity and interpretability of QSANN.">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Heat maps of the averaged quantum self-attention coefficients for some selected test sequences from the Yelp data set, where a deeper color indicates a higher coefficient. Words that are more sentiment-related are generally assigned higher self-attention coefficients by our Gaussian projected quantum self-attention, implying the validity and interpretability of QSANN.</figcaption>
</figure>
</section>
<section id="S3.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.5 </span>Visualization of Self-Attention Coefficient</h3>

<div id="S3.SS5.p1" class="ltx_para">
<p id="S3.SS5.p1.4" class="ltx_p">To intuitively demonstrate the reasonableness of the Gaussian projected quantum self-attention, in Fig. <a href="#S3.F4" title="Figure 4 ‣ 3.4 Results on Yelp, IMDb and Amazon Data Sets ‣ 3 Numerical Results ‣ Quantum Self-Attention Neural Networks for Text Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> we visualize the averaged quantum self-attention coefficients of some selected test sequences from the Yelp data set. Concretely, for a sequence, we calculate <math id="S3.SS5.p1.1.m1.2" class="ltx_Math" alttext="\frac{1}{S}\sum_{s=1}^{S}\tilde{\alpha}_{s,j}" display="inline"><semantics id="S3.SS5.p1.1.m1.2a"><mrow id="S3.SS5.p1.1.m1.2.3" xref="S3.SS5.p1.1.m1.2.3.cmml"><mfrac id="S3.SS5.p1.1.m1.2.3.2" xref="S3.SS5.p1.1.m1.2.3.2.cmml"><mn id="S3.SS5.p1.1.m1.2.3.2.2" xref="S3.SS5.p1.1.m1.2.3.2.2.cmml">1</mn><mi id="S3.SS5.p1.1.m1.2.3.2.3" xref="S3.SS5.p1.1.m1.2.3.2.3.cmml">S</mi></mfrac><mo id="S3.SS5.p1.1.m1.2.3.1" xref="S3.SS5.p1.1.m1.2.3.1.cmml">⁢</mo><mrow id="S3.SS5.p1.1.m1.2.3.3" xref="S3.SS5.p1.1.m1.2.3.3.cmml"><msubsup id="S3.SS5.p1.1.m1.2.3.3.1" xref="S3.SS5.p1.1.m1.2.3.3.1.cmml"><mo largeop="true" symmetric="true" id="S3.SS5.p1.1.m1.2.3.3.1.2.2" xref="S3.SS5.p1.1.m1.2.3.3.1.2.2.cmml">∑</mo><mrow id="S3.SS5.p1.1.m1.2.3.3.1.2.3" xref="S3.SS5.p1.1.m1.2.3.3.1.2.3.cmml"><mi id="S3.SS5.p1.1.m1.2.3.3.1.2.3.2" xref="S3.SS5.p1.1.m1.2.3.3.1.2.3.2.cmml">s</mi><mo id="S3.SS5.p1.1.m1.2.3.3.1.2.3.1" xref="S3.SS5.p1.1.m1.2.3.3.1.2.3.1.cmml">=</mo><mn id="S3.SS5.p1.1.m1.2.3.3.1.2.3.3" xref="S3.SS5.p1.1.m1.2.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.SS5.p1.1.m1.2.3.3.1.3" xref="S3.SS5.p1.1.m1.2.3.3.1.3.cmml">S</mi></msubsup><msub id="S3.SS5.p1.1.m1.2.3.3.2" xref="S3.SS5.p1.1.m1.2.3.3.2.cmml"><mover accent="true" id="S3.SS5.p1.1.m1.2.3.3.2.2" xref="S3.SS5.p1.1.m1.2.3.3.2.2.cmml"><mi id="S3.SS5.p1.1.m1.2.3.3.2.2.2" xref="S3.SS5.p1.1.m1.2.3.3.2.2.2.cmml">α</mi><mo stretchy="false" id="S3.SS5.p1.1.m1.2.3.3.2.2.1" xref="S3.SS5.p1.1.m1.2.3.3.2.2.1.cmml">~</mo></mover><mrow id="S3.SS5.p1.1.m1.2.2.2.4" xref="S3.SS5.p1.1.m1.2.2.2.3.cmml"><mi id="S3.SS5.p1.1.m1.1.1.1.1" xref="S3.SS5.p1.1.m1.1.1.1.1.cmml">s</mi><mo id="S3.SS5.p1.1.m1.2.2.2.4.1" xref="S3.SS5.p1.1.m1.2.2.2.3.cmml">,</mo><mi id="S3.SS5.p1.1.m1.2.2.2.2" xref="S3.SS5.p1.1.m1.2.2.2.2.cmml">j</mi></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.1.m1.2b"><apply id="S3.SS5.p1.1.m1.2.3.cmml" xref="S3.SS5.p1.1.m1.2.3"><times id="S3.SS5.p1.1.m1.2.3.1.cmml" xref="S3.SS5.p1.1.m1.2.3.1"></times><apply id="S3.SS5.p1.1.m1.2.3.2.cmml" xref="S3.SS5.p1.1.m1.2.3.2"><divide id="S3.SS5.p1.1.m1.2.3.2.1.cmml" xref="S3.SS5.p1.1.m1.2.3.2"></divide><cn type="integer" id="S3.SS5.p1.1.m1.2.3.2.2.cmml" xref="S3.SS5.p1.1.m1.2.3.2.2">1</cn><ci id="S3.SS5.p1.1.m1.2.3.2.3.cmml" xref="S3.SS5.p1.1.m1.2.3.2.3">𝑆</ci></apply><apply id="S3.SS5.p1.1.m1.2.3.3.cmml" xref="S3.SS5.p1.1.m1.2.3.3"><apply id="S3.SS5.p1.1.m1.2.3.3.1.cmml" xref="S3.SS5.p1.1.m1.2.3.3.1"><csymbol cd="ambiguous" id="S3.SS5.p1.1.m1.2.3.3.1.1.cmml" xref="S3.SS5.p1.1.m1.2.3.3.1">superscript</csymbol><apply id="S3.SS5.p1.1.m1.2.3.3.1.2.cmml" xref="S3.SS5.p1.1.m1.2.3.3.1"><csymbol cd="ambiguous" id="S3.SS5.p1.1.m1.2.3.3.1.2.1.cmml" xref="S3.SS5.p1.1.m1.2.3.3.1">subscript</csymbol><sum id="S3.SS5.p1.1.m1.2.3.3.1.2.2.cmml" xref="S3.SS5.p1.1.m1.2.3.3.1.2.2"></sum><apply id="S3.SS5.p1.1.m1.2.3.3.1.2.3.cmml" xref="S3.SS5.p1.1.m1.2.3.3.1.2.3"><eq id="S3.SS5.p1.1.m1.2.3.3.1.2.3.1.cmml" xref="S3.SS5.p1.1.m1.2.3.3.1.2.3.1"></eq><ci id="S3.SS5.p1.1.m1.2.3.3.1.2.3.2.cmml" xref="S3.SS5.p1.1.m1.2.3.3.1.2.3.2">𝑠</ci><cn type="integer" id="S3.SS5.p1.1.m1.2.3.3.1.2.3.3.cmml" xref="S3.SS5.p1.1.m1.2.3.3.1.2.3.3">1</cn></apply></apply><ci id="S3.SS5.p1.1.m1.2.3.3.1.3.cmml" xref="S3.SS5.p1.1.m1.2.3.3.1.3">𝑆</ci></apply><apply id="S3.SS5.p1.1.m1.2.3.3.2.cmml" xref="S3.SS5.p1.1.m1.2.3.3.2"><csymbol cd="ambiguous" id="S3.SS5.p1.1.m1.2.3.3.2.1.cmml" xref="S3.SS5.p1.1.m1.2.3.3.2">subscript</csymbol><apply id="S3.SS5.p1.1.m1.2.3.3.2.2.cmml" xref="S3.SS5.p1.1.m1.2.3.3.2.2"><ci id="S3.SS5.p1.1.m1.2.3.3.2.2.1.cmml" xref="S3.SS5.p1.1.m1.2.3.3.2.2.1">~</ci><ci id="S3.SS5.p1.1.m1.2.3.3.2.2.2.cmml" xref="S3.SS5.p1.1.m1.2.3.3.2.2.2">𝛼</ci></apply><list id="S3.SS5.p1.1.m1.2.2.2.3.cmml" xref="S3.SS5.p1.1.m1.2.2.2.4"><ci id="S3.SS5.p1.1.m1.1.1.1.1.cmml" xref="S3.SS5.p1.1.m1.1.1.1.1">𝑠</ci><ci id="S3.SS5.p1.1.m1.2.2.2.2.cmml" xref="S3.SS5.p1.1.m1.2.2.2.2">𝑗</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.1.m1.2c">\frac{1}{S}\sum_{s=1}^{S}\tilde{\alpha}_{s,j}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p1.1.m1.2d">divide start_ARG 1 end_ARG start_ARG italic_S end_ARG ∑ start_POSTSUBSCRIPT italic_s = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_S end_POSTSUPERSCRIPT over~ start_ARG italic_α end_ARG start_POSTSUBSCRIPT italic_s , italic_j end_POSTSUBSCRIPT</annotation></semantics></math> for <math id="S3.SS5.p1.2.m2.3" class="ltx_Math" alttext="j=1,\ldots,S" display="inline"><semantics id="S3.SS5.p1.2.m2.3a"><mrow id="S3.SS5.p1.2.m2.3.4" xref="S3.SS5.p1.2.m2.3.4.cmml"><mi id="S3.SS5.p1.2.m2.3.4.2" xref="S3.SS5.p1.2.m2.3.4.2.cmml">j</mi><mo id="S3.SS5.p1.2.m2.3.4.1" xref="S3.SS5.p1.2.m2.3.4.1.cmml">=</mo><mrow id="S3.SS5.p1.2.m2.3.4.3.2" xref="S3.SS5.p1.2.m2.3.4.3.1.cmml"><mn id="S3.SS5.p1.2.m2.1.1" xref="S3.SS5.p1.2.m2.1.1.cmml">1</mn><mo id="S3.SS5.p1.2.m2.3.4.3.2.1" xref="S3.SS5.p1.2.m2.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="S3.SS5.p1.2.m2.2.2" xref="S3.SS5.p1.2.m2.2.2.cmml">…</mi><mo id="S3.SS5.p1.2.m2.3.4.3.2.2" xref="S3.SS5.p1.2.m2.3.4.3.1.cmml">,</mo><mi id="S3.SS5.p1.2.m2.3.3" xref="S3.SS5.p1.2.m2.3.3.cmml">S</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.2.m2.3b"><apply id="S3.SS5.p1.2.m2.3.4.cmml" xref="S3.SS5.p1.2.m2.3.4"><eq id="S3.SS5.p1.2.m2.3.4.1.cmml" xref="S3.SS5.p1.2.m2.3.4.1"></eq><ci id="S3.SS5.p1.2.m2.3.4.2.cmml" xref="S3.SS5.p1.2.m2.3.4.2">𝑗</ci><list id="S3.SS5.p1.2.m2.3.4.3.1.cmml" xref="S3.SS5.p1.2.m2.3.4.3.2"><cn type="integer" id="S3.SS5.p1.2.m2.1.1.cmml" xref="S3.SS5.p1.2.m2.1.1">1</cn><ci id="S3.SS5.p1.2.m2.2.2.cmml" xref="S3.SS5.p1.2.m2.2.2">…</ci><ci id="S3.SS5.p1.2.m2.3.3.cmml" xref="S3.SS5.p1.2.m2.3.3">𝑆</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.2.m2.3c">j=1,\ldots,S</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p1.2.m2.3d">italic_j = 1 , … , italic_S</annotation></semantics></math> and visualize them via a heat map, where <math id="S3.SS5.p1.3.m3.1" class="ltx_Math" alttext="S" display="inline"><semantics id="S3.SS5.p1.3.m3.1a"><mi id="S3.SS5.p1.3.m3.1.1" xref="S3.SS5.p1.3.m3.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.3.m3.1b"><ci id="S3.SS5.p1.3.m3.1.1.cmml" xref="S3.SS5.p1.3.m3.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.3.m3.1c">S</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p1.3.m3.1d">italic_S</annotation></semantics></math> is the number of words in this sequence and <math id="S3.SS5.p1.4.m4.2" class="ltx_Math" alttext="\tilde{\alpha}_{s,j}" display="inline"><semantics id="S3.SS5.p1.4.m4.2a"><msub id="S3.SS5.p1.4.m4.2.3" xref="S3.SS5.p1.4.m4.2.3.cmml"><mover accent="true" id="S3.SS5.p1.4.m4.2.3.2" xref="S3.SS5.p1.4.m4.2.3.2.cmml"><mi id="S3.SS5.p1.4.m4.2.3.2.2" xref="S3.SS5.p1.4.m4.2.3.2.2.cmml">α</mi><mo stretchy="false" id="S3.SS5.p1.4.m4.2.3.2.1" xref="S3.SS5.p1.4.m4.2.3.2.1.cmml">~</mo></mover><mrow id="S3.SS5.p1.4.m4.2.2.2.4" xref="S3.SS5.p1.4.m4.2.2.2.3.cmml"><mi id="S3.SS5.p1.4.m4.1.1.1.1" xref="S3.SS5.p1.4.m4.1.1.1.1.cmml">s</mi><mo id="S3.SS5.p1.4.m4.2.2.2.4.1" xref="S3.SS5.p1.4.m4.2.2.2.3.cmml">,</mo><mi id="S3.SS5.p1.4.m4.2.2.2.2" xref="S3.SS5.p1.4.m4.2.2.2.2.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.4.m4.2b"><apply id="S3.SS5.p1.4.m4.2.3.cmml" xref="S3.SS5.p1.4.m4.2.3"><csymbol cd="ambiguous" id="S3.SS5.p1.4.m4.2.3.1.cmml" xref="S3.SS5.p1.4.m4.2.3">subscript</csymbol><apply id="S3.SS5.p1.4.m4.2.3.2.cmml" xref="S3.SS5.p1.4.m4.2.3.2"><ci id="S3.SS5.p1.4.m4.2.3.2.1.cmml" xref="S3.SS5.p1.4.m4.2.3.2.1">~</ci><ci id="S3.SS5.p1.4.m4.2.3.2.2.cmml" xref="S3.SS5.p1.4.m4.2.3.2.2">𝛼</ci></apply><list id="S3.SS5.p1.4.m4.2.2.2.3.cmml" xref="S3.SS5.p1.4.m4.2.2.2.4"><ci id="S3.SS5.p1.4.m4.1.1.1.1.cmml" xref="S3.SS5.p1.4.m4.1.1.1.1">𝑠</ci><ci id="S3.SS5.p1.4.m4.2.2.2.2.cmml" xref="S3.SS5.p1.4.m4.2.2.2.2">𝑗</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.4.m4.2c">\tilde{\alpha}_{s,j}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p1.4.m4.2d">over~ start_ARG italic_α end_ARG start_POSTSUBSCRIPT italic_s , italic_j end_POSTSUBSCRIPT</annotation></semantics></math> is the quantum self-attention coefficient. As shown in the figure, words with higher quantum self-attention coefficients are indeed those that determine the emotion of a sequence, implying the power of QSANN for capturing the most relevant words in a sequence on text classification tasks.
</p>
</div>
<figure id="S3.F5" class="ltx_figure">
<div class="ltx_flex_figure">

<div class="ltx_flex_cell 
                  ltx_flex_size_2">
<figure id="S3.F5.1" class="ltx_figure ltx_flex_size_2 ltx_align_center"><img src="/html/2205.05625/assets/graph/depolarizing_channel.png" id="S3.F5.1.g1" class="ltx_graphics ltx_img_landscape" width="269" height="155" alt=" (a) The diagram for adding depolarizing channels in our simulated experiments. The amplitude damping channels are added in the same way. (b) Box plots of test accuracy on Yelp data set with depolarizing and amplitude damping noises.
Each box contains 9 repeated experiments.
The absence of a notable decrease in accuracy implies the noise-resilience attribute of QSANN. ">
</figure>
</div>
<div class="ltx_flex_cell 
                  ltx_flex_size_2">
<figure id="S3.F5.2" class="ltx_figure ltx_flex_size_2 ltx_align_center"><img src="/html/2205.05625/assets/graph/acc_noise_Yelp.png" id="S3.F5.2.g1" class="ltx_graphics ltx_img_landscape" width="269" height="200" alt=" (a) The diagram for adding depolarizing channels in our simulated experiments. The amplitude damping channels are added in the same way. (b) Box plots of test accuracy on Yelp data set with depolarizing and amplitude damping noises.
Each box contains 9 repeated experiments.
The absence of a notable decrease in accuracy implies the noise-resilience attribute of QSANN. ">
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span> (a) The diagram for adding depolarizing channels in our simulated experiments. The amplitude damping channels are added in the same way. (b) Box plots of test accuracy on Yelp data set with depolarizing and amplitude damping noises.
Each box contains 9 repeated experiments.
The absence of a notable decrease in accuracy implies the noise-resilience attribute of QSANN. </figcaption>
</figure>
</section>
<section id="S3.SS6" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.6 </span>Noisy Experimental Results on Yelp Data Set</h3>

<div id="S3.SS6.p1" class="ltx_para">
<p id="S3.SS6.p1.2" class="ltx_p">Due to the limitations of the near-term quantum computers, we add experiments with noisy quantum circuits to demonstrate the robustness of QSANN on the Yelp data set. We consider the representative channels <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib41" title="" class="ltx_ref">41</a>]</cite> such as the depolarizing channel
<math id="S3.SS6.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{E}_{D}(\rho)" display="inline"><semantics id="S3.SS6.p1.1.m1.1a"><mrow id="S3.SS6.p1.1.m1.1.2" xref="S3.SS6.p1.1.m1.1.2.cmml"><msub id="S3.SS6.p1.1.m1.1.2.2" xref="S3.SS6.p1.1.m1.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS6.p1.1.m1.1.2.2.2" xref="S3.SS6.p1.1.m1.1.2.2.2.cmml">ℰ</mi><mi id="S3.SS6.p1.1.m1.1.2.2.3" xref="S3.SS6.p1.1.m1.1.2.2.3.cmml">D</mi></msub><mo id="S3.SS6.p1.1.m1.1.2.1" xref="S3.SS6.p1.1.m1.1.2.1.cmml">⁢</mo><mrow id="S3.SS6.p1.1.m1.1.2.3.2" xref="S3.SS6.p1.1.m1.1.2.cmml"><mo stretchy="false" id="S3.SS6.p1.1.m1.1.2.3.2.1" xref="S3.SS6.p1.1.m1.1.2.cmml">(</mo><mi id="S3.SS6.p1.1.m1.1.1" xref="S3.SS6.p1.1.m1.1.1.cmml">ρ</mi><mo stretchy="false" id="S3.SS6.p1.1.m1.1.2.3.2.2" xref="S3.SS6.p1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS6.p1.1.m1.1b"><apply id="S3.SS6.p1.1.m1.1.2.cmml" xref="S3.SS6.p1.1.m1.1.2"><times id="S3.SS6.p1.1.m1.1.2.1.cmml" xref="S3.SS6.p1.1.m1.1.2.1"></times><apply id="S3.SS6.p1.1.m1.1.2.2.cmml" xref="S3.SS6.p1.1.m1.1.2.2"><csymbol cd="ambiguous" id="S3.SS6.p1.1.m1.1.2.2.1.cmml" xref="S3.SS6.p1.1.m1.1.2.2">subscript</csymbol><ci id="S3.SS6.p1.1.m1.1.2.2.2.cmml" xref="S3.SS6.p1.1.m1.1.2.2.2">ℰ</ci><ci id="S3.SS6.p1.1.m1.1.2.2.3.cmml" xref="S3.SS6.p1.1.m1.1.2.2.3">𝐷</ci></apply><ci id="S3.SS6.p1.1.m1.1.1.cmml" xref="S3.SS6.p1.1.m1.1.1">𝜌</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.p1.1.m1.1c">\mathcal{E}_{D}(\rho)</annotation><annotation encoding="application/x-llamapun" id="S3.SS6.p1.1.m1.1d">caligraphic_E start_POSTSUBSCRIPT italic_D end_POSTSUBSCRIPT ( italic_ρ )</annotation></semantics></math>
and the amplitude damping channel <math id="S3.SS6.p1.2.m2.1" class="ltx_Math" alttext="\mathcal{E}_{AD}(\rho)" display="inline"><semantics id="S3.SS6.p1.2.m2.1a"><mrow id="S3.SS6.p1.2.m2.1.2" xref="S3.SS6.p1.2.m2.1.2.cmml"><msub id="S3.SS6.p1.2.m2.1.2.2" xref="S3.SS6.p1.2.m2.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS6.p1.2.m2.1.2.2.2" xref="S3.SS6.p1.2.m2.1.2.2.2.cmml">ℰ</mi><mrow id="S3.SS6.p1.2.m2.1.2.2.3" xref="S3.SS6.p1.2.m2.1.2.2.3.cmml"><mi id="S3.SS6.p1.2.m2.1.2.2.3.2" xref="S3.SS6.p1.2.m2.1.2.2.3.2.cmml">A</mi><mo id="S3.SS6.p1.2.m2.1.2.2.3.1" xref="S3.SS6.p1.2.m2.1.2.2.3.1.cmml">⁢</mo><mi id="S3.SS6.p1.2.m2.1.2.2.3.3" xref="S3.SS6.p1.2.m2.1.2.2.3.3.cmml">D</mi></mrow></msub><mo id="S3.SS6.p1.2.m2.1.2.1" xref="S3.SS6.p1.2.m2.1.2.1.cmml">⁢</mo><mrow id="S3.SS6.p1.2.m2.1.2.3.2" xref="S3.SS6.p1.2.m2.1.2.cmml"><mo stretchy="false" id="S3.SS6.p1.2.m2.1.2.3.2.1" xref="S3.SS6.p1.2.m2.1.2.cmml">(</mo><mi id="S3.SS6.p1.2.m2.1.1" xref="S3.SS6.p1.2.m2.1.1.cmml">ρ</mi><mo stretchy="false" id="S3.SS6.p1.2.m2.1.2.3.2.2" xref="S3.SS6.p1.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS6.p1.2.m2.1b"><apply id="S3.SS6.p1.2.m2.1.2.cmml" xref="S3.SS6.p1.2.m2.1.2"><times id="S3.SS6.p1.2.m2.1.2.1.cmml" xref="S3.SS6.p1.2.m2.1.2.1"></times><apply id="S3.SS6.p1.2.m2.1.2.2.cmml" xref="S3.SS6.p1.2.m2.1.2.2"><csymbol cd="ambiguous" id="S3.SS6.p1.2.m2.1.2.2.1.cmml" xref="S3.SS6.p1.2.m2.1.2.2">subscript</csymbol><ci id="S3.SS6.p1.2.m2.1.2.2.2.cmml" xref="S3.SS6.p1.2.m2.1.2.2.2">ℰ</ci><apply id="S3.SS6.p1.2.m2.1.2.2.3.cmml" xref="S3.SS6.p1.2.m2.1.2.2.3"><times id="S3.SS6.p1.2.m2.1.2.2.3.1.cmml" xref="S3.SS6.p1.2.m2.1.2.2.3.1"></times><ci id="S3.SS6.p1.2.m2.1.2.2.3.2.cmml" xref="S3.SS6.p1.2.m2.1.2.2.3.2">𝐴</ci><ci id="S3.SS6.p1.2.m2.1.2.2.3.3.cmml" xref="S3.SS6.p1.2.m2.1.2.2.3.3">𝐷</ci></apply></apply><ci id="S3.SS6.p1.2.m2.1.1.cmml" xref="S3.SS6.p1.2.m2.1.1">𝜌</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.p1.2.m2.1c">\mathcal{E}_{AD}(\rho)</annotation><annotation encoding="application/x-llamapun" id="S3.SS6.p1.2.m2.1d">caligraphic_E start_POSTSUBSCRIPT italic_A italic_D end_POSTSUBSCRIPT ( italic_ρ )</annotation></semantics></math>
</p>
<table id="S1.EGx11" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E20"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E20.m1.1" class="ltx_Math" alttext="\displaystyle\mathcal{E}_{D}(\rho)" display="inline"><semantics id="S3.E20.m1.1a"><mrow id="S3.E20.m1.1.2" xref="S3.E20.m1.1.2.cmml"><msub id="S3.E20.m1.1.2.2" xref="S3.E20.m1.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E20.m1.1.2.2.2" xref="S3.E20.m1.1.2.2.2.cmml">ℰ</mi><mi id="S3.E20.m1.1.2.2.3" xref="S3.E20.m1.1.2.2.3.cmml">D</mi></msub><mo id="S3.E20.m1.1.2.1" xref="S3.E20.m1.1.2.1.cmml">⁢</mo><mrow id="S3.E20.m1.1.2.3.2" xref="S3.E20.m1.1.2.cmml"><mo stretchy="false" id="S3.E20.m1.1.2.3.2.1" xref="S3.E20.m1.1.2.cmml">(</mo><mi id="S3.E20.m1.1.1" xref="S3.E20.m1.1.1.cmml">ρ</mi><mo stretchy="false" id="S3.E20.m1.1.2.3.2.2" xref="S3.E20.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E20.m1.1b"><apply id="S3.E20.m1.1.2.cmml" xref="S3.E20.m1.1.2"><times id="S3.E20.m1.1.2.1.cmml" xref="S3.E20.m1.1.2.1"></times><apply id="S3.E20.m1.1.2.2.cmml" xref="S3.E20.m1.1.2.2"><csymbol cd="ambiguous" id="S3.E20.m1.1.2.2.1.cmml" xref="S3.E20.m1.1.2.2">subscript</csymbol><ci id="S3.E20.m1.1.2.2.2.cmml" xref="S3.E20.m1.1.2.2.2">ℰ</ci><ci id="S3.E20.m1.1.2.2.3.cmml" xref="S3.E20.m1.1.2.2.3">𝐷</ci></apply><ci id="S3.E20.m1.1.1.cmml" xref="S3.E20.m1.1.1">𝜌</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E20.m1.1c">\displaystyle\mathcal{E}_{D}(\rho)</annotation><annotation encoding="application/x-llamapun" id="S3.E20.m1.1d">caligraphic_E start_POSTSUBSCRIPT italic_D end_POSTSUBSCRIPT ( italic_ρ )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E20.m2.2" class="ltx_Math" alttext="\displaystyle:=\left(1-p\right)\rho+\frac{p}{3}\left(X\rho X+Y\rho Y+Z\rho Z\right)" display="inline"><semantics id="S3.E20.m2.2a"><mrow id="S3.E20.m2.2.2" xref="S3.E20.m2.2.2.cmml"><mi id="S3.E20.m2.2.2.4" xref="S3.E20.m2.2.2.4.cmml"></mi><mo id="S3.E20.m2.2.2.3" xref="S3.E20.m2.2.2.3.cmml">:=</mo><mrow id="S3.E20.m2.2.2.2" xref="S3.E20.m2.2.2.2.cmml"><mrow id="S3.E20.m2.1.1.1.1" xref="S3.E20.m2.1.1.1.1.cmml"><mrow id="S3.E20.m2.1.1.1.1.1.1" xref="S3.E20.m2.1.1.1.1.1.1.1.cmml"><mo id="S3.E20.m2.1.1.1.1.1.1.2" xref="S3.E20.m2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E20.m2.1.1.1.1.1.1.1" xref="S3.E20.m2.1.1.1.1.1.1.1.cmml"><mn id="S3.E20.m2.1.1.1.1.1.1.1.2" xref="S3.E20.m2.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S3.E20.m2.1.1.1.1.1.1.1.1" xref="S3.E20.m2.1.1.1.1.1.1.1.1.cmml">-</mo><mi id="S3.E20.m2.1.1.1.1.1.1.1.3" xref="S3.E20.m2.1.1.1.1.1.1.1.3.cmml">p</mi></mrow><mo id="S3.E20.m2.1.1.1.1.1.1.3" xref="S3.E20.m2.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.E20.m2.1.1.1.1.2" xref="S3.E20.m2.1.1.1.1.2.cmml">⁢</mo><mi id="S3.E20.m2.1.1.1.1.3" xref="S3.E20.m2.1.1.1.1.3.cmml">ρ</mi></mrow><mo id="S3.E20.m2.2.2.2.3" xref="S3.E20.m2.2.2.2.3.cmml">+</mo><mrow id="S3.E20.m2.2.2.2.2" xref="S3.E20.m2.2.2.2.2.cmml"><mstyle displaystyle="true" id="S3.E20.m2.2.2.2.2.3" xref="S3.E20.m2.2.2.2.2.3.cmml"><mfrac id="S3.E20.m2.2.2.2.2.3a" xref="S3.E20.m2.2.2.2.2.3.cmml"><mi id="S3.E20.m2.2.2.2.2.3.2" xref="S3.E20.m2.2.2.2.2.3.2.cmml">p</mi><mn id="S3.E20.m2.2.2.2.2.3.3" xref="S3.E20.m2.2.2.2.2.3.3.cmml">3</mn></mfrac></mstyle><mo id="S3.E20.m2.2.2.2.2.2" xref="S3.E20.m2.2.2.2.2.2.cmml">⁢</mo><mrow id="S3.E20.m2.2.2.2.2.1.1" xref="S3.E20.m2.2.2.2.2.1.1.1.cmml"><mo id="S3.E20.m2.2.2.2.2.1.1.2" xref="S3.E20.m2.2.2.2.2.1.1.1.cmml">(</mo><mrow id="S3.E20.m2.2.2.2.2.1.1.1" xref="S3.E20.m2.2.2.2.2.1.1.1.cmml"><mrow id="S3.E20.m2.2.2.2.2.1.1.1.2" xref="S3.E20.m2.2.2.2.2.1.1.1.2.cmml"><mi id="S3.E20.m2.2.2.2.2.1.1.1.2.2" xref="S3.E20.m2.2.2.2.2.1.1.1.2.2.cmml">X</mi><mo id="S3.E20.m2.2.2.2.2.1.1.1.2.1" xref="S3.E20.m2.2.2.2.2.1.1.1.2.1.cmml">⁢</mo><mi id="S3.E20.m2.2.2.2.2.1.1.1.2.3" xref="S3.E20.m2.2.2.2.2.1.1.1.2.3.cmml">ρ</mi><mo id="S3.E20.m2.2.2.2.2.1.1.1.2.1a" xref="S3.E20.m2.2.2.2.2.1.1.1.2.1.cmml">⁢</mo><mi id="S3.E20.m2.2.2.2.2.1.1.1.2.4" xref="S3.E20.m2.2.2.2.2.1.1.1.2.4.cmml">X</mi></mrow><mo id="S3.E20.m2.2.2.2.2.1.1.1.1" xref="S3.E20.m2.2.2.2.2.1.1.1.1.cmml">+</mo><mrow id="S3.E20.m2.2.2.2.2.1.1.1.3" xref="S3.E20.m2.2.2.2.2.1.1.1.3.cmml"><mi id="S3.E20.m2.2.2.2.2.1.1.1.3.2" xref="S3.E20.m2.2.2.2.2.1.1.1.3.2.cmml">Y</mi><mo id="S3.E20.m2.2.2.2.2.1.1.1.3.1" xref="S3.E20.m2.2.2.2.2.1.1.1.3.1.cmml">⁢</mo><mi id="S3.E20.m2.2.2.2.2.1.1.1.3.3" xref="S3.E20.m2.2.2.2.2.1.1.1.3.3.cmml">ρ</mi><mo id="S3.E20.m2.2.2.2.2.1.1.1.3.1a" xref="S3.E20.m2.2.2.2.2.1.1.1.3.1.cmml">⁢</mo><mi id="S3.E20.m2.2.2.2.2.1.1.1.3.4" xref="S3.E20.m2.2.2.2.2.1.1.1.3.4.cmml">Y</mi></mrow><mo id="S3.E20.m2.2.2.2.2.1.1.1.1a" xref="S3.E20.m2.2.2.2.2.1.1.1.1.cmml">+</mo><mrow id="S3.E20.m2.2.2.2.2.1.1.1.4" xref="S3.E20.m2.2.2.2.2.1.1.1.4.cmml"><mi id="S3.E20.m2.2.2.2.2.1.1.1.4.2" xref="S3.E20.m2.2.2.2.2.1.1.1.4.2.cmml">Z</mi><mo id="S3.E20.m2.2.2.2.2.1.1.1.4.1" xref="S3.E20.m2.2.2.2.2.1.1.1.4.1.cmml">⁢</mo><mi id="S3.E20.m2.2.2.2.2.1.1.1.4.3" xref="S3.E20.m2.2.2.2.2.1.1.1.4.3.cmml">ρ</mi><mo id="S3.E20.m2.2.2.2.2.1.1.1.4.1a" xref="S3.E20.m2.2.2.2.2.1.1.1.4.1.cmml">⁢</mo><mi id="S3.E20.m2.2.2.2.2.1.1.1.4.4" xref="S3.E20.m2.2.2.2.2.1.1.1.4.4.cmml">Z</mi></mrow></mrow><mo id="S3.E20.m2.2.2.2.2.1.1.3" xref="S3.E20.m2.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E20.m2.2b"><apply id="S3.E20.m2.2.2.cmml" xref="S3.E20.m2.2.2"><csymbol cd="latexml" id="S3.E20.m2.2.2.3.cmml" xref="S3.E20.m2.2.2.3">assign</csymbol><csymbol cd="latexml" id="S3.E20.m2.2.2.4.cmml" xref="S3.E20.m2.2.2.4">absent</csymbol><apply id="S3.E20.m2.2.2.2.cmml" xref="S3.E20.m2.2.2.2"><plus id="S3.E20.m2.2.2.2.3.cmml" xref="S3.E20.m2.2.2.2.3"></plus><apply id="S3.E20.m2.1.1.1.1.cmml" xref="S3.E20.m2.1.1.1.1"><times id="S3.E20.m2.1.1.1.1.2.cmml" xref="S3.E20.m2.1.1.1.1.2"></times><apply id="S3.E20.m2.1.1.1.1.1.1.1.cmml" xref="S3.E20.m2.1.1.1.1.1.1"><minus id="S3.E20.m2.1.1.1.1.1.1.1.1.cmml" xref="S3.E20.m2.1.1.1.1.1.1.1.1"></minus><cn type="integer" id="S3.E20.m2.1.1.1.1.1.1.1.2.cmml" xref="S3.E20.m2.1.1.1.1.1.1.1.2">1</cn><ci id="S3.E20.m2.1.1.1.1.1.1.1.3.cmml" xref="S3.E20.m2.1.1.1.1.1.1.1.3">𝑝</ci></apply><ci id="S3.E20.m2.1.1.1.1.3.cmml" xref="S3.E20.m2.1.1.1.1.3">𝜌</ci></apply><apply id="S3.E20.m2.2.2.2.2.cmml" xref="S3.E20.m2.2.2.2.2"><times id="S3.E20.m2.2.2.2.2.2.cmml" xref="S3.E20.m2.2.2.2.2.2"></times><apply id="S3.E20.m2.2.2.2.2.3.cmml" xref="S3.E20.m2.2.2.2.2.3"><divide id="S3.E20.m2.2.2.2.2.3.1.cmml" xref="S3.E20.m2.2.2.2.2.3"></divide><ci id="S3.E20.m2.2.2.2.2.3.2.cmml" xref="S3.E20.m2.2.2.2.2.3.2">𝑝</ci><cn type="integer" id="S3.E20.m2.2.2.2.2.3.3.cmml" xref="S3.E20.m2.2.2.2.2.3.3">3</cn></apply><apply id="S3.E20.m2.2.2.2.2.1.1.1.cmml" xref="S3.E20.m2.2.2.2.2.1.1"><plus id="S3.E20.m2.2.2.2.2.1.1.1.1.cmml" xref="S3.E20.m2.2.2.2.2.1.1.1.1"></plus><apply id="S3.E20.m2.2.2.2.2.1.1.1.2.cmml" xref="S3.E20.m2.2.2.2.2.1.1.1.2"><times id="S3.E20.m2.2.2.2.2.1.1.1.2.1.cmml" xref="S3.E20.m2.2.2.2.2.1.1.1.2.1"></times><ci id="S3.E20.m2.2.2.2.2.1.1.1.2.2.cmml" xref="S3.E20.m2.2.2.2.2.1.1.1.2.2">𝑋</ci><ci id="S3.E20.m2.2.2.2.2.1.1.1.2.3.cmml" xref="S3.E20.m2.2.2.2.2.1.1.1.2.3">𝜌</ci><ci id="S3.E20.m2.2.2.2.2.1.1.1.2.4.cmml" xref="S3.E20.m2.2.2.2.2.1.1.1.2.4">𝑋</ci></apply><apply id="S3.E20.m2.2.2.2.2.1.1.1.3.cmml" xref="S3.E20.m2.2.2.2.2.1.1.1.3"><times id="S3.E20.m2.2.2.2.2.1.1.1.3.1.cmml" xref="S3.E20.m2.2.2.2.2.1.1.1.3.1"></times><ci id="S3.E20.m2.2.2.2.2.1.1.1.3.2.cmml" xref="S3.E20.m2.2.2.2.2.1.1.1.3.2">𝑌</ci><ci id="S3.E20.m2.2.2.2.2.1.1.1.3.3.cmml" xref="S3.E20.m2.2.2.2.2.1.1.1.3.3">𝜌</ci><ci id="S3.E20.m2.2.2.2.2.1.1.1.3.4.cmml" xref="S3.E20.m2.2.2.2.2.1.1.1.3.4">𝑌</ci></apply><apply id="S3.E20.m2.2.2.2.2.1.1.1.4.cmml" xref="S3.E20.m2.2.2.2.2.1.1.1.4"><times id="S3.E20.m2.2.2.2.2.1.1.1.4.1.cmml" xref="S3.E20.m2.2.2.2.2.1.1.1.4.1"></times><ci id="S3.E20.m2.2.2.2.2.1.1.1.4.2.cmml" xref="S3.E20.m2.2.2.2.2.1.1.1.4.2">𝑍</ci><ci id="S3.E20.m2.2.2.2.2.1.1.1.4.3.cmml" xref="S3.E20.m2.2.2.2.2.1.1.1.4.3">𝜌</ci><ci id="S3.E20.m2.2.2.2.2.1.1.1.4.4.cmml" xref="S3.E20.m2.2.2.2.2.1.1.1.4.4">𝑍</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E20.m2.2c">\displaystyle:=\left(1-p\right)\rho+\frac{p}{3}\left(X\rho X+Y\rho Y+Z\rho Z\right)</annotation><annotation encoding="application/x-llamapun" id="S3.E20.m2.2d">:= ( 1 - italic_p ) italic_ρ + divide start_ARG italic_p end_ARG start_ARG 3 end_ARG ( italic_X italic_ρ italic_X + italic_Y italic_ρ italic_Y + italic_Z italic_ρ italic_Z )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(20)</span></td>
</tr></tbody>
<tbody id="S3.E21"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E21.m1.1" class="ltx_Math" alttext="\displaystyle\mathcal{E}_{AD}(\rho)" display="inline"><semantics id="S3.E21.m1.1a"><mrow id="S3.E21.m1.1.2" xref="S3.E21.m1.1.2.cmml"><msub id="S3.E21.m1.1.2.2" xref="S3.E21.m1.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E21.m1.1.2.2.2" xref="S3.E21.m1.1.2.2.2.cmml">ℰ</mi><mrow id="S3.E21.m1.1.2.2.3" xref="S3.E21.m1.1.2.2.3.cmml"><mi id="S3.E21.m1.1.2.2.3.2" xref="S3.E21.m1.1.2.2.3.2.cmml">A</mi><mo id="S3.E21.m1.1.2.2.3.1" xref="S3.E21.m1.1.2.2.3.1.cmml">⁢</mo><mi id="S3.E21.m1.1.2.2.3.3" xref="S3.E21.m1.1.2.2.3.3.cmml">D</mi></mrow></msub><mo id="S3.E21.m1.1.2.1" xref="S3.E21.m1.1.2.1.cmml">⁢</mo><mrow id="S3.E21.m1.1.2.3.2" xref="S3.E21.m1.1.2.cmml"><mo stretchy="false" id="S3.E21.m1.1.2.3.2.1" xref="S3.E21.m1.1.2.cmml">(</mo><mi id="S3.E21.m1.1.1" xref="S3.E21.m1.1.1.cmml">ρ</mi><mo stretchy="false" id="S3.E21.m1.1.2.3.2.2" xref="S3.E21.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E21.m1.1b"><apply id="S3.E21.m1.1.2.cmml" xref="S3.E21.m1.1.2"><times id="S3.E21.m1.1.2.1.cmml" xref="S3.E21.m1.1.2.1"></times><apply id="S3.E21.m1.1.2.2.cmml" xref="S3.E21.m1.1.2.2"><csymbol cd="ambiguous" id="S3.E21.m1.1.2.2.1.cmml" xref="S3.E21.m1.1.2.2">subscript</csymbol><ci id="S3.E21.m1.1.2.2.2.cmml" xref="S3.E21.m1.1.2.2.2">ℰ</ci><apply id="S3.E21.m1.1.2.2.3.cmml" xref="S3.E21.m1.1.2.2.3"><times id="S3.E21.m1.1.2.2.3.1.cmml" xref="S3.E21.m1.1.2.2.3.1"></times><ci id="S3.E21.m1.1.2.2.3.2.cmml" xref="S3.E21.m1.1.2.2.3.2">𝐴</ci><ci id="S3.E21.m1.1.2.2.3.3.cmml" xref="S3.E21.m1.1.2.2.3.3">𝐷</ci></apply></apply><ci id="S3.E21.m1.1.1.cmml" xref="S3.E21.m1.1.1">𝜌</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E21.m1.1c">\displaystyle\mathcal{E}_{AD}(\rho)</annotation><annotation encoding="application/x-llamapun" id="S3.E21.m1.1d">caligraphic_E start_POSTSUBSCRIPT italic_A italic_D end_POSTSUBSCRIPT ( italic_ρ )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E21.m2.1" class="ltx_Math" alttext="\displaystyle:=E_{0}\rho E_{0}^{\dagger}+E_{1}\rho E_{1}^{\dagger}," display="inline"><semantics id="S3.E21.m2.1a"><mrow id="S3.E21.m2.1.1.1" xref="S3.E21.m2.1.1.1.1.cmml"><mrow id="S3.E21.m2.1.1.1.1" xref="S3.E21.m2.1.1.1.1.cmml"><mi id="S3.E21.m2.1.1.1.1.2" xref="S3.E21.m2.1.1.1.1.2.cmml"></mi><mo id="S3.E21.m2.1.1.1.1.1" xref="S3.E21.m2.1.1.1.1.1.cmml">:=</mo><mrow id="S3.E21.m2.1.1.1.1.3" xref="S3.E21.m2.1.1.1.1.3.cmml"><mrow id="S3.E21.m2.1.1.1.1.3.2" xref="S3.E21.m2.1.1.1.1.3.2.cmml"><msub id="S3.E21.m2.1.1.1.1.3.2.2" xref="S3.E21.m2.1.1.1.1.3.2.2.cmml"><mi id="S3.E21.m2.1.1.1.1.3.2.2.2" xref="S3.E21.m2.1.1.1.1.3.2.2.2.cmml">E</mi><mn id="S3.E21.m2.1.1.1.1.3.2.2.3" xref="S3.E21.m2.1.1.1.1.3.2.2.3.cmml">0</mn></msub><mo id="S3.E21.m2.1.1.1.1.3.2.1" xref="S3.E21.m2.1.1.1.1.3.2.1.cmml">⁢</mo><mi id="S3.E21.m2.1.1.1.1.3.2.3" xref="S3.E21.m2.1.1.1.1.3.2.3.cmml">ρ</mi><mo id="S3.E21.m2.1.1.1.1.3.2.1a" xref="S3.E21.m2.1.1.1.1.3.2.1.cmml">⁢</mo><msubsup id="S3.E21.m2.1.1.1.1.3.2.4" xref="S3.E21.m2.1.1.1.1.3.2.4.cmml"><mi id="S3.E21.m2.1.1.1.1.3.2.4.2.2" xref="S3.E21.m2.1.1.1.1.3.2.4.2.2.cmml">E</mi><mn id="S3.E21.m2.1.1.1.1.3.2.4.2.3" xref="S3.E21.m2.1.1.1.1.3.2.4.2.3.cmml">0</mn><mo id="S3.E21.m2.1.1.1.1.3.2.4.3" xref="S3.E21.m2.1.1.1.1.3.2.4.3.cmml">†</mo></msubsup></mrow><mo id="S3.E21.m2.1.1.1.1.3.1" xref="S3.E21.m2.1.1.1.1.3.1.cmml">+</mo><mrow id="S3.E21.m2.1.1.1.1.3.3" xref="S3.E21.m2.1.1.1.1.3.3.cmml"><msub id="S3.E21.m2.1.1.1.1.3.3.2" xref="S3.E21.m2.1.1.1.1.3.3.2.cmml"><mi id="S3.E21.m2.1.1.1.1.3.3.2.2" xref="S3.E21.m2.1.1.1.1.3.3.2.2.cmml">E</mi><mn id="S3.E21.m2.1.1.1.1.3.3.2.3" xref="S3.E21.m2.1.1.1.1.3.3.2.3.cmml">1</mn></msub><mo id="S3.E21.m2.1.1.1.1.3.3.1" xref="S3.E21.m2.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S3.E21.m2.1.1.1.1.3.3.3" xref="S3.E21.m2.1.1.1.1.3.3.3.cmml">ρ</mi><mo id="S3.E21.m2.1.1.1.1.3.3.1a" xref="S3.E21.m2.1.1.1.1.3.3.1.cmml">⁢</mo><msubsup id="S3.E21.m2.1.1.1.1.3.3.4" xref="S3.E21.m2.1.1.1.1.3.3.4.cmml"><mi id="S3.E21.m2.1.1.1.1.3.3.4.2.2" xref="S3.E21.m2.1.1.1.1.3.3.4.2.2.cmml">E</mi><mn id="S3.E21.m2.1.1.1.1.3.3.4.2.3" xref="S3.E21.m2.1.1.1.1.3.3.4.2.3.cmml">1</mn><mo id="S3.E21.m2.1.1.1.1.3.3.4.3" xref="S3.E21.m2.1.1.1.1.3.3.4.3.cmml">†</mo></msubsup></mrow></mrow></mrow><mo id="S3.E21.m2.1.1.1.2" xref="S3.E21.m2.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E21.m2.1b"><apply id="S3.E21.m2.1.1.1.1.cmml" xref="S3.E21.m2.1.1.1"><csymbol cd="latexml" id="S3.E21.m2.1.1.1.1.1.cmml" xref="S3.E21.m2.1.1.1.1.1">assign</csymbol><csymbol cd="latexml" id="S3.E21.m2.1.1.1.1.2.cmml" xref="S3.E21.m2.1.1.1.1.2">absent</csymbol><apply id="S3.E21.m2.1.1.1.1.3.cmml" xref="S3.E21.m2.1.1.1.1.3"><plus id="S3.E21.m2.1.1.1.1.3.1.cmml" xref="S3.E21.m2.1.1.1.1.3.1"></plus><apply id="S3.E21.m2.1.1.1.1.3.2.cmml" xref="S3.E21.m2.1.1.1.1.3.2"><times id="S3.E21.m2.1.1.1.1.3.2.1.cmml" xref="S3.E21.m2.1.1.1.1.3.2.1"></times><apply id="S3.E21.m2.1.1.1.1.3.2.2.cmml" xref="S3.E21.m2.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E21.m2.1.1.1.1.3.2.2.1.cmml" xref="S3.E21.m2.1.1.1.1.3.2.2">subscript</csymbol><ci id="S3.E21.m2.1.1.1.1.3.2.2.2.cmml" xref="S3.E21.m2.1.1.1.1.3.2.2.2">𝐸</ci><cn type="integer" id="S3.E21.m2.1.1.1.1.3.2.2.3.cmml" xref="S3.E21.m2.1.1.1.1.3.2.2.3">0</cn></apply><ci id="S3.E21.m2.1.1.1.1.3.2.3.cmml" xref="S3.E21.m2.1.1.1.1.3.2.3">𝜌</ci><apply id="S3.E21.m2.1.1.1.1.3.2.4.cmml" xref="S3.E21.m2.1.1.1.1.3.2.4"><csymbol cd="ambiguous" id="S3.E21.m2.1.1.1.1.3.2.4.1.cmml" xref="S3.E21.m2.1.1.1.1.3.2.4">superscript</csymbol><apply id="S3.E21.m2.1.1.1.1.3.2.4.2.cmml" xref="S3.E21.m2.1.1.1.1.3.2.4"><csymbol cd="ambiguous" id="S3.E21.m2.1.1.1.1.3.2.4.2.1.cmml" xref="S3.E21.m2.1.1.1.1.3.2.4">subscript</csymbol><ci id="S3.E21.m2.1.1.1.1.3.2.4.2.2.cmml" xref="S3.E21.m2.1.1.1.1.3.2.4.2.2">𝐸</ci><cn type="integer" id="S3.E21.m2.1.1.1.1.3.2.4.2.3.cmml" xref="S3.E21.m2.1.1.1.1.3.2.4.2.3">0</cn></apply><ci id="S3.E21.m2.1.1.1.1.3.2.4.3.cmml" xref="S3.E21.m2.1.1.1.1.3.2.4.3">†</ci></apply></apply><apply id="S3.E21.m2.1.1.1.1.3.3.cmml" xref="S3.E21.m2.1.1.1.1.3.3"><times id="S3.E21.m2.1.1.1.1.3.3.1.cmml" xref="S3.E21.m2.1.1.1.1.3.3.1"></times><apply id="S3.E21.m2.1.1.1.1.3.3.2.cmml" xref="S3.E21.m2.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.E21.m2.1.1.1.1.3.3.2.1.cmml" xref="S3.E21.m2.1.1.1.1.3.3.2">subscript</csymbol><ci id="S3.E21.m2.1.1.1.1.3.3.2.2.cmml" xref="S3.E21.m2.1.1.1.1.3.3.2.2">𝐸</ci><cn type="integer" id="S3.E21.m2.1.1.1.1.3.3.2.3.cmml" xref="S3.E21.m2.1.1.1.1.3.3.2.3">1</cn></apply><ci id="S3.E21.m2.1.1.1.1.3.3.3.cmml" xref="S3.E21.m2.1.1.1.1.3.3.3">𝜌</ci><apply id="S3.E21.m2.1.1.1.1.3.3.4.cmml" xref="S3.E21.m2.1.1.1.1.3.3.4"><csymbol cd="ambiguous" id="S3.E21.m2.1.1.1.1.3.3.4.1.cmml" xref="S3.E21.m2.1.1.1.1.3.3.4">superscript</csymbol><apply id="S3.E21.m2.1.1.1.1.3.3.4.2.cmml" xref="S3.E21.m2.1.1.1.1.3.3.4"><csymbol cd="ambiguous" id="S3.E21.m2.1.1.1.1.3.3.4.2.1.cmml" xref="S3.E21.m2.1.1.1.1.3.3.4">subscript</csymbol><ci id="S3.E21.m2.1.1.1.1.3.3.4.2.2.cmml" xref="S3.E21.m2.1.1.1.1.3.3.4.2.2">𝐸</ci><cn type="integer" id="S3.E21.m2.1.1.1.1.3.3.4.2.3.cmml" xref="S3.E21.m2.1.1.1.1.3.3.4.2.3">1</cn></apply><ci id="S3.E21.m2.1.1.1.1.3.3.4.3.cmml" xref="S3.E21.m2.1.1.1.1.3.3.4.3">†</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E21.m2.1c">\displaystyle:=E_{0}\rho E_{0}^{\dagger}+E_{1}\rho E_{1}^{\dagger},</annotation><annotation encoding="application/x-llamapun" id="S3.E21.m2.1d">:= italic_E start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT italic_ρ italic_E start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT † end_POSTSUPERSCRIPT + italic_E start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT italic_ρ italic_E start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT † end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(21)</span></td>
</tr></tbody>
</table>
<p id="S3.SS6.p1.7" class="ltx_p">with
<math id="S3.SS6.p1.3.m1.5" class="ltx_Math" alttext="E_{0}=|0\rangle\!\langle 0|+\sqrt{1-p}|1\rangle\!\langle 1|" display="inline"><semantics id="S3.SS6.p1.3.m1.5a"><mrow id="S3.SS6.p1.3.m1.5.5" xref="S3.SS6.p1.3.m1.5.5.cmml"><msub id="S3.SS6.p1.3.m1.5.5.3" xref="S3.SS6.p1.3.m1.5.5.3.cmml"><mi id="S3.SS6.p1.3.m1.5.5.3.2" xref="S3.SS6.p1.3.m1.5.5.3.2.cmml">E</mi><mn id="S3.SS6.p1.3.m1.5.5.3.3" xref="S3.SS6.p1.3.m1.5.5.3.3.cmml">0</mn></msub><mo id="S3.SS6.p1.3.m1.5.5.2" xref="S3.SS6.p1.3.m1.5.5.2.cmml">=</mo><mrow id="S3.SS6.p1.3.m1.5.5.1" xref="S3.SS6.p1.3.m1.5.5.1.cmml"><mrow id="S3.SS6.p1.3.m1.5.5.1.3.2" xref="S3.SS6.p1.3.m1.5.5.1.3.1.cmml"><mo fence="true" stretchy="false" id="S3.SS6.p1.3.m1.5.5.1.3.2.1" xref="S3.SS6.p1.3.m1.5.5.1.3.1.1.cmml">|</mo><mn id="S3.SS6.p1.3.m1.1.1" xref="S3.SS6.p1.3.m1.1.1.cmml">0</mn><mo rspace="0.8pt" stretchy="false" id="S3.SS6.p1.3.m1.5.5.1.3.2.2" xref="S3.SS6.p1.3.m1.5.5.1.3.1.1.cmml">⟩</mo></mrow><mo id="S3.SS6.p1.3.m1.5.5.1.2" xref="S3.SS6.p1.3.m1.5.5.1.2.cmml">⁢</mo><mrow id="S3.SS6.p1.3.m1.5.5.1.1.1" xref="S3.SS6.p1.3.m1.5.5.1.1.2.cmml"><mo stretchy="false" id="S3.SS6.p1.3.m1.5.5.1.1.1.2" xref="S3.SS6.p1.3.m1.5.5.1.1.2.1.cmml">⟨</mo><mn id="S3.SS6.p1.3.m1.4.4" xref="S3.SS6.p1.3.m1.4.4.cmml">0</mn><mo fence="true" stretchy="false" id="S3.SS6.p1.3.m1.5.5.1.1.1.3" xref="S3.SS6.p1.3.m1.5.5.1.1.2.1.cmml">|</mo><mrow id="S3.SS6.p1.3.m1.5.5.1.1.1.1" xref="S3.SS6.p1.3.m1.5.5.1.1.1.1.cmml"><mo id="S3.SS6.p1.3.m1.5.5.1.1.1.1.1" xref="S3.SS6.p1.3.m1.5.5.1.1.1.1.1.cmml">+</mo><msqrt id="S3.SS6.p1.3.m1.5.5.1.1.1.1.2" xref="S3.SS6.p1.3.m1.5.5.1.1.1.1.2.cmml"><mrow id="S3.SS6.p1.3.m1.5.5.1.1.1.1.2.2" xref="S3.SS6.p1.3.m1.5.5.1.1.1.1.2.2.cmml"><mn id="S3.SS6.p1.3.m1.5.5.1.1.1.1.2.2.2" xref="S3.SS6.p1.3.m1.5.5.1.1.1.1.2.2.2.cmml">1</mn><mo id="S3.SS6.p1.3.m1.5.5.1.1.1.1.2.2.1" xref="S3.SS6.p1.3.m1.5.5.1.1.1.1.2.2.1.cmml">-</mo><mi id="S3.SS6.p1.3.m1.5.5.1.1.1.1.2.2.3" xref="S3.SS6.p1.3.m1.5.5.1.1.1.1.2.2.3.cmml">p</mi></mrow></msqrt></mrow><mo fence="true" stretchy="false" id="S3.SS6.p1.3.m1.5.5.1.1.1.4" xref="S3.SS6.p1.3.m1.5.5.1.1.2.1.cmml">|</mo><mn id="S3.SS6.p1.3.m1.2.2" xref="S3.SS6.p1.3.m1.2.2.cmml">1</mn><mo rspace="0.8pt" stretchy="false" id="S3.SS6.p1.3.m1.5.5.1.1.1.5" xref="S3.SS6.p1.3.m1.5.5.1.1.2.1.cmml">⟩</mo></mrow><mo id="S3.SS6.p1.3.m1.5.5.1.2a" xref="S3.SS6.p1.3.m1.5.5.1.2.cmml">⁢</mo><mrow id="S3.SS6.p1.3.m1.5.5.1.4.2" xref="S3.SS6.p1.3.m1.5.5.1.4.1.cmml"><mo stretchy="false" id="S3.SS6.p1.3.m1.5.5.1.4.2.1" xref="S3.SS6.p1.3.m1.5.5.1.4.1.1.cmml">⟨</mo><mn id="S3.SS6.p1.3.m1.3.3" xref="S3.SS6.p1.3.m1.3.3.cmml">1</mn><mo fence="true" stretchy="false" id="S3.SS6.p1.3.m1.5.5.1.4.2.2" xref="S3.SS6.p1.3.m1.5.5.1.4.1.1.cmml">|</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS6.p1.3.m1.5b"><apply id="S3.SS6.p1.3.m1.5.5.cmml" xref="S3.SS6.p1.3.m1.5.5"><eq id="S3.SS6.p1.3.m1.5.5.2.cmml" xref="S3.SS6.p1.3.m1.5.5.2"></eq><apply id="S3.SS6.p1.3.m1.5.5.3.cmml" xref="S3.SS6.p1.3.m1.5.5.3"><csymbol cd="ambiguous" id="S3.SS6.p1.3.m1.5.5.3.1.cmml" xref="S3.SS6.p1.3.m1.5.5.3">subscript</csymbol><ci id="S3.SS6.p1.3.m1.5.5.3.2.cmml" xref="S3.SS6.p1.3.m1.5.5.3.2">𝐸</ci><cn type="integer" id="S3.SS6.p1.3.m1.5.5.3.3.cmml" xref="S3.SS6.p1.3.m1.5.5.3.3">0</cn></apply><apply id="S3.SS6.p1.3.m1.5.5.1.cmml" xref="S3.SS6.p1.3.m1.5.5.1"><times id="S3.SS6.p1.3.m1.5.5.1.2.cmml" xref="S3.SS6.p1.3.m1.5.5.1.2"></times><apply id="S3.SS6.p1.3.m1.5.5.1.3.1.cmml" xref="S3.SS6.p1.3.m1.5.5.1.3.2"><csymbol cd="latexml" id="S3.SS6.p1.3.m1.5.5.1.3.1.1.cmml" xref="S3.SS6.p1.3.m1.5.5.1.3.2.1">ket</csymbol><cn type="integer" id="S3.SS6.p1.3.m1.1.1.cmml" xref="S3.SS6.p1.3.m1.1.1">0</cn></apply><apply id="S3.SS6.p1.3.m1.5.5.1.1.2.cmml" xref="S3.SS6.p1.3.m1.5.5.1.1.1"><csymbol cd="latexml" id="S3.SS6.p1.3.m1.5.5.1.1.2.1.cmml" xref="S3.SS6.p1.3.m1.5.5.1.1.1.2">quantum-operator-product</csymbol><cn type="integer" id="S3.SS6.p1.3.m1.4.4.cmml" xref="S3.SS6.p1.3.m1.4.4">0</cn><apply id="S3.SS6.p1.3.m1.5.5.1.1.1.1.cmml" xref="S3.SS6.p1.3.m1.5.5.1.1.1.1"><plus id="S3.SS6.p1.3.m1.5.5.1.1.1.1.1.cmml" xref="S3.SS6.p1.3.m1.5.5.1.1.1.1.1"></plus><apply id="S3.SS6.p1.3.m1.5.5.1.1.1.1.2.cmml" xref="S3.SS6.p1.3.m1.5.5.1.1.1.1.2"><root id="S3.SS6.p1.3.m1.5.5.1.1.1.1.2a.cmml" xref="S3.SS6.p1.3.m1.5.5.1.1.1.1.2"></root><apply id="S3.SS6.p1.3.m1.5.5.1.1.1.1.2.2.cmml" xref="S3.SS6.p1.3.m1.5.5.1.1.1.1.2.2"><minus id="S3.SS6.p1.3.m1.5.5.1.1.1.1.2.2.1.cmml" xref="S3.SS6.p1.3.m1.5.5.1.1.1.1.2.2.1"></minus><cn type="integer" id="S3.SS6.p1.3.m1.5.5.1.1.1.1.2.2.2.cmml" xref="S3.SS6.p1.3.m1.5.5.1.1.1.1.2.2.2">1</cn><ci id="S3.SS6.p1.3.m1.5.5.1.1.1.1.2.2.3.cmml" xref="S3.SS6.p1.3.m1.5.5.1.1.1.1.2.2.3">𝑝</ci></apply></apply></apply><cn type="integer" id="S3.SS6.p1.3.m1.2.2.cmml" xref="S3.SS6.p1.3.m1.2.2">1</cn></apply><apply id="S3.SS6.p1.3.m1.5.5.1.4.1.cmml" xref="S3.SS6.p1.3.m1.5.5.1.4.2"><csymbol cd="latexml" id="S3.SS6.p1.3.m1.5.5.1.4.1.1.cmml" xref="S3.SS6.p1.3.m1.5.5.1.4.2.1">bra</csymbol><cn type="integer" id="S3.SS6.p1.3.m1.3.3.cmml" xref="S3.SS6.p1.3.m1.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.p1.3.m1.5c">E_{0}=|0\rangle\!\langle 0|+\sqrt{1-p}|1\rangle\!\langle 1|</annotation><annotation encoding="application/x-llamapun" id="S3.SS6.p1.3.m1.5d">italic_E start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT = | 0 ⟩ ⟨ 0 | + square-root start_ARG 1 - italic_p end_ARG | 1 ⟩ ⟨ 1 |</annotation></semantics></math> and <math id="S3.SS6.p1.4.m2.2" class="ltx_Math" alttext="E_{1}=\sqrt{p}|0\rangle\!\langle 1|" display="inline"><semantics id="S3.SS6.p1.4.m2.2a"><mrow id="S3.SS6.p1.4.m2.2.3" xref="S3.SS6.p1.4.m2.2.3.cmml"><msub id="S3.SS6.p1.4.m2.2.3.2" xref="S3.SS6.p1.4.m2.2.3.2.cmml"><mi id="S3.SS6.p1.4.m2.2.3.2.2" xref="S3.SS6.p1.4.m2.2.3.2.2.cmml">E</mi><mn id="S3.SS6.p1.4.m2.2.3.2.3" xref="S3.SS6.p1.4.m2.2.3.2.3.cmml">1</mn></msub><mo id="S3.SS6.p1.4.m2.2.3.1" xref="S3.SS6.p1.4.m2.2.3.1.cmml">=</mo><mrow id="S3.SS6.p1.4.m2.2.3.3" xref="S3.SS6.p1.4.m2.2.3.3.cmml"><msqrt id="S3.SS6.p1.4.m2.2.3.3.2" xref="S3.SS6.p1.4.m2.2.3.3.2.cmml"><mi id="S3.SS6.p1.4.m2.2.3.3.2.2" xref="S3.SS6.p1.4.m2.2.3.3.2.2.cmml">p</mi></msqrt><mo id="S3.SS6.p1.4.m2.2.3.3.1" xref="S3.SS6.p1.4.m2.2.3.3.1.cmml">⁢</mo><mrow id="S3.SS6.p1.4.m2.2.3.3.3.2" xref="S3.SS6.p1.4.m2.2.3.3.3.1.cmml"><mo fence="true" stretchy="false" id="S3.SS6.p1.4.m2.2.3.3.3.2.1" xref="S3.SS6.p1.4.m2.2.3.3.3.1.1.cmml">|</mo><mn id="S3.SS6.p1.4.m2.1.1" xref="S3.SS6.p1.4.m2.1.1.cmml">0</mn><mo rspace="0.8pt" stretchy="false" id="S3.SS6.p1.4.m2.2.3.3.3.2.2" xref="S3.SS6.p1.4.m2.2.3.3.3.1.1.cmml">⟩</mo></mrow><mo id="S3.SS6.p1.4.m2.2.3.3.1a" xref="S3.SS6.p1.4.m2.2.3.3.1.cmml">⁢</mo><mrow id="S3.SS6.p1.4.m2.2.3.3.4.2" xref="S3.SS6.p1.4.m2.2.3.3.4.1.cmml"><mo stretchy="false" id="S3.SS6.p1.4.m2.2.3.3.4.2.1" xref="S3.SS6.p1.4.m2.2.3.3.4.1.1.cmml">⟨</mo><mn id="S3.SS6.p1.4.m2.2.2" xref="S3.SS6.p1.4.m2.2.2.cmml">1</mn><mo fence="true" stretchy="false" id="S3.SS6.p1.4.m2.2.3.3.4.2.2" xref="S3.SS6.p1.4.m2.2.3.3.4.1.1.cmml">|</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS6.p1.4.m2.2b"><apply id="S3.SS6.p1.4.m2.2.3.cmml" xref="S3.SS6.p1.4.m2.2.3"><eq id="S3.SS6.p1.4.m2.2.3.1.cmml" xref="S3.SS6.p1.4.m2.2.3.1"></eq><apply id="S3.SS6.p1.4.m2.2.3.2.cmml" xref="S3.SS6.p1.4.m2.2.3.2"><csymbol cd="ambiguous" id="S3.SS6.p1.4.m2.2.3.2.1.cmml" xref="S3.SS6.p1.4.m2.2.3.2">subscript</csymbol><ci id="S3.SS6.p1.4.m2.2.3.2.2.cmml" xref="S3.SS6.p1.4.m2.2.3.2.2">𝐸</ci><cn type="integer" id="S3.SS6.p1.4.m2.2.3.2.3.cmml" xref="S3.SS6.p1.4.m2.2.3.2.3">1</cn></apply><apply id="S3.SS6.p1.4.m2.2.3.3.cmml" xref="S3.SS6.p1.4.m2.2.3.3"><times id="S3.SS6.p1.4.m2.2.3.3.1.cmml" xref="S3.SS6.p1.4.m2.2.3.3.1"></times><apply id="S3.SS6.p1.4.m2.2.3.3.2.cmml" xref="S3.SS6.p1.4.m2.2.3.3.2"><root id="S3.SS6.p1.4.m2.2.3.3.2a.cmml" xref="S3.SS6.p1.4.m2.2.3.3.2"></root><ci id="S3.SS6.p1.4.m2.2.3.3.2.2.cmml" xref="S3.SS6.p1.4.m2.2.3.3.2.2">𝑝</ci></apply><apply id="S3.SS6.p1.4.m2.2.3.3.3.1.cmml" xref="S3.SS6.p1.4.m2.2.3.3.3.2"><csymbol cd="latexml" id="S3.SS6.p1.4.m2.2.3.3.3.1.1.cmml" xref="S3.SS6.p1.4.m2.2.3.3.3.2.1">ket</csymbol><cn type="integer" id="S3.SS6.p1.4.m2.1.1.cmml" xref="S3.SS6.p1.4.m2.1.1">0</cn></apply><apply id="S3.SS6.p1.4.m2.2.3.3.4.1.cmml" xref="S3.SS6.p1.4.m2.2.3.3.4.2"><csymbol cd="latexml" id="S3.SS6.p1.4.m2.2.3.3.4.1.1.cmml" xref="S3.SS6.p1.4.m2.2.3.3.4.2.1">bra</csymbol><cn type="integer" id="S3.SS6.p1.4.m2.2.2.cmml" xref="S3.SS6.p1.4.m2.2.2">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.p1.4.m2.2c">E_{1}=\sqrt{p}|0\rangle\!\langle 1|</annotation><annotation encoding="application/x-llamapun" id="S3.SS6.p1.4.m2.2d">italic_E start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = square-root start_ARG italic_p end_ARG | 0 ⟩ ⟨ 1 |</annotation></semantics></math> denoting the Kraus operators.
Here, <math id="S3.SS6.p1.5.m3.2" class="ltx_Math" alttext="\rho=|\psi\rangle\!\langle\psi|" display="inline"><semantics id="S3.SS6.p1.5.m3.2a"><mrow id="S3.SS6.p1.5.m3.2.3" xref="S3.SS6.p1.5.m3.2.3.cmml"><mi id="S3.SS6.p1.5.m3.2.3.2" xref="S3.SS6.p1.5.m3.2.3.2.cmml">ρ</mi><mo id="S3.SS6.p1.5.m3.2.3.1" xref="S3.SS6.p1.5.m3.2.3.1.cmml">=</mo><mrow id="S3.SS6.p1.5.m3.2.3.3" xref="S3.SS6.p1.5.m3.2.3.3.cmml"><mrow id="S3.SS6.p1.5.m3.2.3.3.2.2" xref="S3.SS6.p1.5.m3.2.3.3.2.1.cmml"><mo fence="true" stretchy="false" id="S3.SS6.p1.5.m3.2.3.3.2.2.1" xref="S3.SS6.p1.5.m3.2.3.3.2.1.1.cmml">|</mo><mi id="S3.SS6.p1.5.m3.1.1" xref="S3.SS6.p1.5.m3.1.1.cmml">ψ</mi><mo rspace="0.8pt" stretchy="false" id="S3.SS6.p1.5.m3.2.3.3.2.2.2" xref="S3.SS6.p1.5.m3.2.3.3.2.1.1.cmml">⟩</mo></mrow><mo id="S3.SS6.p1.5.m3.2.3.3.1" xref="S3.SS6.p1.5.m3.2.3.3.1.cmml">⁢</mo><mrow id="S3.SS6.p1.5.m3.2.3.3.3.2" xref="S3.SS6.p1.5.m3.2.3.3.3.1.cmml"><mo stretchy="false" id="S3.SS6.p1.5.m3.2.3.3.3.2.1" xref="S3.SS6.p1.5.m3.2.3.3.3.1.1.cmml">⟨</mo><mi id="S3.SS6.p1.5.m3.2.2" xref="S3.SS6.p1.5.m3.2.2.cmml">ψ</mi><mo fence="true" stretchy="false" id="S3.SS6.p1.5.m3.2.3.3.3.2.2" xref="S3.SS6.p1.5.m3.2.3.3.3.1.1.cmml">|</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS6.p1.5.m3.2b"><apply id="S3.SS6.p1.5.m3.2.3.cmml" xref="S3.SS6.p1.5.m3.2.3"><eq id="S3.SS6.p1.5.m3.2.3.1.cmml" xref="S3.SS6.p1.5.m3.2.3.1"></eq><ci id="S3.SS6.p1.5.m3.2.3.2.cmml" xref="S3.SS6.p1.5.m3.2.3.2">𝜌</ci><apply id="S3.SS6.p1.5.m3.2.3.3.cmml" xref="S3.SS6.p1.5.m3.2.3.3"><times id="S3.SS6.p1.5.m3.2.3.3.1.cmml" xref="S3.SS6.p1.5.m3.2.3.3.1"></times><apply id="S3.SS6.p1.5.m3.2.3.3.2.1.cmml" xref="S3.SS6.p1.5.m3.2.3.3.2.2"><csymbol cd="latexml" id="S3.SS6.p1.5.m3.2.3.3.2.1.1.cmml" xref="S3.SS6.p1.5.m3.2.3.3.2.2.1">ket</csymbol><ci id="S3.SS6.p1.5.m3.1.1.cmml" xref="S3.SS6.p1.5.m3.1.1">𝜓</ci></apply><apply id="S3.SS6.p1.5.m3.2.3.3.3.1.cmml" xref="S3.SS6.p1.5.m3.2.3.3.3.2"><csymbol cd="latexml" id="S3.SS6.p1.5.m3.2.3.3.3.1.1.cmml" xref="S3.SS6.p1.5.m3.2.3.3.3.2.1">bra</csymbol><ci id="S3.SS6.p1.5.m3.2.2.cmml" xref="S3.SS6.p1.5.m3.2.2">𝜓</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.p1.5.m3.2c">\rho=|\psi\rangle\!\langle\psi|</annotation><annotation encoding="application/x-llamapun" id="S3.SS6.p1.5.m3.2d">italic_ρ = | italic_ψ ⟩ ⟨ italic_ψ |</annotation></semantics></math> for a pure quantum state <math id="S3.SS6.p1.6.m4.1" class="ltx_Math" alttext="\ket{\psi}" display="inline"><semantics id="S3.SS6.p1.6.m4.1a"><mrow id="S3.SS6.p1.6.m4.1.1" xref="S3.SS6.p1.6.m4.1.1.cmml"><merror class="ltx_ERROR undefined undefined" id="S3.SS6.p1.6.m4.1.1.2" xref="S3.SS6.p1.6.m4.1.1.2b.cmml"><mtext id="S3.SS6.p1.6.m4.1.1.2a" xref="S3.SS6.p1.6.m4.1.1.2b.cmml">\ket</mtext></merror><mo id="S3.SS6.p1.6.m4.1.1.1" xref="S3.SS6.p1.6.m4.1.1.1.cmml">⁢</mo><mi id="S3.SS6.p1.6.m4.1.1.3" xref="S3.SS6.p1.6.m4.1.1.3.cmml">ψ</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS6.p1.6.m4.1b"><apply id="S3.SS6.p1.6.m4.1.1.cmml" xref="S3.SS6.p1.6.m4.1.1"><times id="S3.SS6.p1.6.m4.1.1.1.cmml" xref="S3.SS6.p1.6.m4.1.1.1"></times><ci id="S3.SS6.p1.6.m4.1.1.2b.cmml" xref="S3.SS6.p1.6.m4.1.1.2"><merror class="ltx_ERROR undefined undefined" id="S3.SS6.p1.6.m4.1.1.2.cmml" xref="S3.SS6.p1.6.m4.1.1.2"><mtext id="S3.SS6.p1.6.m4.1.1.2a.cmml" xref="S3.SS6.p1.6.m4.1.1.2">\ket</mtext></merror></ci><ci id="S3.SS6.p1.6.m4.1.1.3.cmml" xref="S3.SS6.p1.6.m4.1.1.3">𝜓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.p1.6.m4.1c">\ket{\psi}</annotation><annotation encoding="application/x-llamapun" id="S3.SS6.p1.6.m4.1d">italic_ψ</annotation></semantics></math> and <math id="S3.SS6.p1.7.m5.1" class="ltx_Math" alttext="p" display="inline"><semantics id="S3.SS6.p1.7.m5.1a"><mi id="S3.SS6.p1.7.m5.1.1" xref="S3.SS6.p1.7.m5.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S3.SS6.p1.7.m5.1b"><ci id="S3.SS6.p1.7.m5.1.1.cmml" xref="S3.SS6.p1.7.m5.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.p1.7.m5.1c">p</annotation><annotation encoding="application/x-llamapun" id="S3.SS6.p1.7.m5.1d">italic_p</annotation></semantics></math> denotes the noise level.
As a regular way to analyze the effect of quantum noises, we add these single-qubit noisy channels in the final circuit layer to represent the whole system’s noise, which is illustrated in Fig. <a href="#S3.F5" title="Figure 5 ‣ 3.5 Visualization of Self-Attention Coefficient ‣ 3 Numerical Results ‣ Quantum Self-Attention Neural Networks for Text Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>.
</p>
</div>
<div id="S3.SS6.p2" class="ltx_para">
<p id="S3.SS6.p2.1" class="ltx_p">We take the noise level <math id="S3.SS6.p2.1.m1.1" class="ltx_Math" alttext="p" display="inline"><semantics id="S3.SS6.p2.1.m1.1a"><mi id="S3.SS6.p2.1.m1.1.1" xref="S3.SS6.p2.1.m1.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S3.SS6.p2.1.m1.1b"><ci id="S3.SS6.p2.1.m1.1.1.cmml" xref="S3.SS6.p2.1.m1.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.p2.1.m1.1c">p</annotation><annotation encoding="application/x-llamapun" id="S3.SS6.p2.1.m1.1d">italic_p</annotation></semantics></math> as 0.01, 0.1, 0.2 for these two noisy channels, respectively, and the box plots of test accuracies are depicted in Fig. <a href="#S3.F5" title="Figure 5 ‣ 3.5 Visualization of Self-Attention Coefficient ‣ 3 Numerical Results ‣ Quantum Self-Attention Neural Networks for Text Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>. From the picture, we see the test accuracy of our QSANN almost does not decrease when the noise level is less than 0.1,
and even when the noise level is up to 0.2, the overall test accuracy has only decreased a little, showing that QSANN is robust to these quantum noises.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Discussions</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">We have proposed a quantum self-attention neural network (QSANN) by introducing the self-attention mechanism to quantum neural networks. Specifically, the adopted Gaussian projected quantum self-attention exploits the exponentially large quantum Hilbert space as the quantum feature space, making QSANN have the potential advantage of mining some hidden correlations between words that are difficult to dig out classically. Numerical results show that QSANN outperforms the best-known QNLP method and a simple classical self-attention neural network for text classification on several public data sets. Moreover, using only shallow quantum circuits and Pauli measurements, QSANN can be easily implemented on near-term quantum devices and is noise-resilient, as implied by simulation results. We believe that this attempt to combine self-attention and quantum neural networks would open up new avenues for QNLP as well as QML. As a future direction, more advanced techniques such as positional encoding and multi-head attention can be employed in quantum neural networks for generative models and other more complicated tasks.</p>
</div>
</section>
<section id="Sx1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Acknowledgements</h2>

<div id="Sx1.p1" class="ltx_para">
<p id="Sx1.p1.1" class="ltx_p">We would like to thank Prof. Sanjiang Li and Prof. Yuan Feng for helpful discussions.
G. L. acknowledges the support from the Baidu-UTS AI Meets Quantum project, the China Scholarship Council (No. 201806070139), and the Australian Research Council project (Grant No: DP180100691). Part of this work was done when X. Z. was a research intern at Baidu Research.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
John Preskill.

</span>
<span class="ltx_bibblock">Quantum computing 40 years later.

</span>
<span class="ltx_bibblock"><span id="bib.bib1.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2106.10522</span>, 2021.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
Aram W Harrow and Ashley Montanaro.

</span>
<span class="ltx_bibblock">Quantum computational supremacy.

</span>
<span class="ltx_bibblock"><span id="bib.bib2.1.1" class="ltx_text ltx_font_italic">Nature</span>, 549(7671):203–209, 2017.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
Andrew M Childs and Wim van Dam.

</span>
<span class="ltx_bibblock">Quantum algorithms for algebraic problems.

</span>
<span class="ltx_bibblock"><span id="bib.bib3.1.1" class="ltx_text ltx_font_italic">Reviews of Modern Physics</span>, 82(1):1–52, jan 2010.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
Ashley Montanaro.

</span>
<span class="ltx_bibblock">Quantum algorithms: an overview.

</span>
<span class="ltx_bibblock"><span id="bib.bib4.1.1" class="ltx_text ltx_font_italic">npj Quantum Information</span>, 2(1):15023, nov 2016.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
Andrew M. Childs, Dmitri Maslov, Yunseong Nam, Neil J. Ross, and Yuan Su.

</span>
<span class="ltx_bibblock">Toward the first quantum simulation with quantum speedup.

</span>
<span class="ltx_bibblock"><span id="bib.bib5.1.1" class="ltx_text ltx_font_italic">Proceedings of the National Academy of Sciences</span>,
115(38):9456–9461, sep 2018.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
Jacob Biamonte, Peter Wittek, Nicola Pancotti, Patrick Rebentrost, Nathan
Wiebe, and Seth Lloyd.

</span>
<span class="ltx_bibblock">Quantum machine learning.

</span>
<span class="ltx_bibblock"><span id="bib.bib6.1.1" class="ltx_text ltx_font_italic">Nature</span>, 549(7671):195–202, Sep 2017.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
Fernando G.S.L. Brandao and Krysta M. Svore.

</span>
<span class="ltx_bibblock">Quantum Speed-Ups for Solving Semidefinite Programs.

</span>
<span class="ltx_bibblock">In <span id="bib.bib7.1.1" class="ltx_text ltx_font_italic">2017 IEEE 58th Annual Symposium on Foundations of Computer
Science (FOCS)</span>, pages 415–426. IEEE, oct 2017.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Feihu Xu, Xiongfeng Ma, Qiang Zhang, Hoi-Kwong Lo, and Jian-Wei Pan.

</span>
<span class="ltx_bibblock">Secure quantum key distribution with realistic devices.

</span>
<span class="ltx_bibblock"><span id="bib.bib8.1.1" class="ltx_text ltx_font_italic">Reviews of Modern Physics</span>, 92(2):25002, 2020.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
Sam McArdle, Suguru Endo, Alán Aspuru-Guzik, Simon C. Benjamin, and Xiao
Yuan.

</span>
<span class="ltx_bibblock">Quantum computational chemistry.

</span>
<span class="ltx_bibblock"><span id="bib.bib9.1.1" class="ltx_text ltx_font_italic">Reviews of Modern Physics</span>, 92(1):015003, mar 2020.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
Yudong Cao, Jonathan Romero, Jonathan P Olson, Matthias Degroote, Peter D.
Johnson, Mária Kieferová, Ian D. Kivlichan, Tim Menke, Borja
Peropadre, Nicolas P D Sawaya, Sukin Sim, Libor Veis, and Alán
Aspuru-Guzik.

</span>
<span class="ltx_bibblock">Quantum Chemistry in the Age of Quantum Computing.

</span>
<span class="ltx_bibblock"><span id="bib.bib10.1.1" class="ltx_text ltx_font_italic">Chemical Reviews</span>, 119(19):10856–10915, oct 2019.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
Patrick Rebentrost, Masoud Mohseni, and Seth Lloyd.

</span>
<span class="ltx_bibblock">Quantum support vector machine for big data classification.

</span>
<span class="ltx_bibblock"><span id="bib.bib11.1.1" class="ltx_text ltx_font_italic">Physical Review Letters</span>, 113(3):130503, Sep 2014.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
Hsin-Yuan Huang, Michael Broughton, Masoud Mohseni, Ryan Babbush, Sergio Boixo,
Hartmut Neven, and Jarrod R. McClean.

</span>
<span class="ltx_bibblock">Power of data in quantum machine learning.

</span>
<span class="ltx_bibblock"><span id="bib.bib12.1.1" class="ltx_text ltx_font_italic">Nature Communications</span>, 12(1):2631, dec 2021.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
Maria Schuld and Francesco Petruccione.

</span>
<span class="ltx_bibblock"><span id="bib.bib13.1.1" class="ltx_text ltx_font_italic">Machine Learning with Quantum Computers</span>.

</span>
<span class="ltx_bibblock">2021.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
John Preskill.

</span>
<span class="ltx_bibblock">Quantum Computing in the NISQ era and beyond.

</span>
<span class="ltx_bibblock"><span id="bib.bib14.1.1" class="ltx_text ltx_font_italic">Quantum</span>, 2:79, Aug 2018.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
Frank Arute, Kunal Arya, Ryan Babbush, Dave Bacon, Joseph C Bardin, Rami
Barends, Rupak Biswas, Sergio Boixo, Fernando GSL Brandao, David A Buell,
et al.

</span>
<span class="ltx_bibblock">Quantum supremacy using a programmable superconducting processor.

</span>
<span class="ltx_bibblock"><span id="bib.bib15.1.1" class="ltx_text ltx_font_italic">Nature</span>, 574(7779):505–510, 2019.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
Han-Sen Zhong, Hui Wang, Yu-Hao Deng, Ming-Cheng Chen, Li-Chao Peng, Yi-Han
Luo, Jian Qin, Dian Wu, Xing Ding, Yi Hu, et al.

</span>
<span class="ltx_bibblock">Quantum computational advantage using photons.

</span>
<span class="ltx_bibblock"><span id="bib.bib16.1.1" class="ltx_text ltx_font_italic">Science</span>, 370(6523):1460–1463, 2020.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
Kishor Bharti, Alba Cervera-Lierta, Thi Ha Kyaw, Tobias Haug, Sumner
Alperin-Lea, Abhinav Anand, Matthias Degroote, Hermanni Heimonen, Jakob S
Kottmann, Tim Menke, et al.

</span>
<span class="ltx_bibblock">Noisy intermediate-scale quantum (nisq) algorithms.

</span>
<span class="ltx_bibblock"><span id="bib.bib17.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2101.08448</span>, 2021.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
M. Cerezo, Andrew Arrasmith, Ryan Babbush, Simon C. Benjamin, Suguru Endo,
Keisuke Fujii, Jarrod R. McClean, Kosuke Mitarai, Xiao Yuan, Lukasz Cincio,
and Patrick J. Coles.

</span>
<span class="ltx_bibblock">Variational quantum algorithms.

</span>
<span class="ltx_bibblock"><span id="bib.bib18.1.1" class="ltx_text ltx_font_italic">Nature Reviews Physics</span>, pages 1–29, aug 2021.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
Suguru Endo, Zhenyu Cai, Simon C Benjamin, and Xiao Yuan.

</span>
<span class="ltx_bibblock">Hybrid Quantum-Classical Algorithms and Quantum Error Mitigation.

</span>
<span class="ltx_bibblock"><span id="bib.bib19.1.1" class="ltx_text ltx_font_italic">Journal of the Physical Society of Japan</span>, 90(3):032001, mar
2021.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
Alberto Peruzzo, Jarrod McClean, Peter Shadbolt, Man-Hong Yung, Xiao-Qi Zhou,
Peter J. Love, Alán Aspuru-Guzik, and Jeremy L. O’Brien.

</span>
<span class="ltx_bibblock">A variational eigenvalue solver on a photonic quantum processor.

</span>
<span class="ltx_bibblock"><span id="bib.bib20.1.1" class="ltx_text ltx_font_italic">Nature Communications</span>, 5(1):4213, dec 2014.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
Edward Farhi, Jeffrey Goldstone, and Sam Gutmann.

</span>
<span class="ltx_bibblock">A Quantum Approximate Optimization Algorithm.

</span>
<span class="ltx_bibblock"><span id="bib.bib21.1.1" class="ltx_text ltx_font_italic">arXiv:1411.4028</span>, pages 1–16, Nov 2014.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
Vojtěch Havlíček, Antonio D. Córcoles, Kristan Temme,
Aram W. Harrow, Abhinav Kandala, Jerry M. Chow, and Jay M. Gambetta.

</span>
<span class="ltx_bibblock">Supervised learning with quantum-enhanced feature spaces.

</span>
<span class="ltx_bibblock"><span id="bib.bib22.1.1" class="ltx_text ltx_font_italic">Nature</span>, 567(7747):209–212, Mar 2019.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
Maria Schuld, Alex Bocharov, Krysta M. Svore, and Nathan Wiebe.

</span>
<span class="ltx_bibblock">Circuit-centric quantum classifiers.

</span>
<span class="ltx_bibblock"><span id="bib.bib23.1.1" class="ltx_text ltx_font_italic">Physical Review A</span>, 101(3):032308, Mar 2020.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
K. Mitarai, M. Negoro, M. Kitagawa, and K. Fujii.

</span>
<span class="ltx_bibblock">Quantum circuit learning.

</span>
<span class="ltx_bibblock"><span id="bib.bib24.1.1" class="ltx_text ltx_font_italic">Physical Review A</span>, 98(3):032309, Sep 2018.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
Marcello Benedetti, Erika Lloyd, Stefan Sack, and Mattia Fiorentini.

</span>
<span class="ltx_bibblock">Parameterized quantum circuits as machine learning models.

</span>
<span class="ltx_bibblock"><span id="bib.bib25.1.1" class="ltx_text ltx_font_italic">Quantum Science and Technology</span>, 4(4):043001, Jun 2019.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
Edward Farhi and Hartmut Neven.

</span>
<span class="ltx_bibblock">Classification with Quantum Neural Networks on Near Term
Processors.

</span>
<span class="ltx_bibblock"><span id="bib.bib26.1.1" class="ltx_text ltx_font_italic">arXiv:1802.06002</span>, pages 1–21, Feb 2018.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
Alessandro Sordoni, Jian-Yun Nie, and Yoshua Bengio.

</span>
<span class="ltx_bibblock">Modeling term dependencies with quantum language models for IR.

</span>
<span class="ltx_bibblock">In <span id="bib.bib27.1.1" class="ltx_text ltx_font_italic">Proceedings of the 36th international ACM SIGIR conference on
Research and development in information retrieval - SIGIR ’13</span>, page 653, New
York, New York, USA, 2013. ACM Press.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
Peng Zhang, Jiabin Niu, Zhan Su, Benyou Wang, Liqun Ma, and Dawei Song.

</span>
<span class="ltx_bibblock">End-to-End Quantum-Like Language Models with Application to Question
Answering.

</span>
<span class="ltx_bibblock"><span id="bib.bib28.1.1" class="ltx_text ltx_font_italic">Proceedings of the AAAI Conference on Artificial Intelligence</span>,
32(1), 2018.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
Yazhou Zhang, Dawei Song, Peng Zhang, Xiang Li, and Panpan Wang.

</span>
<span class="ltx_bibblock">A quantum-inspired sentiment representation model for twitter
sentiment analysis.

</span>
<span class="ltx_bibblock"><span id="bib.bib29.1.1" class="ltx_text ltx_font_italic">Applied Intelligence</span>, 49(8):3093–3108, 2019.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
Ivano Basile and Fabio Tamburini.

</span>
<span class="ltx_bibblock">Towards quantum language models.

</span>
<span class="ltx_bibblock">In <span id="bib.bib30.1.1" class="ltx_text ltx_font_italic">Proceedings of the 2017 Conference on Empirical Methods in
Natural Language Processing</span>, pages 1840–1849, 2017.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
William Zeng and Bob Coecke.

</span>
<span class="ltx_bibblock">Quantum algorithms for compositional natural language processing.

</span>
<span class="ltx_bibblock"><span id="bib.bib31.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1608.01406</span>, 2016.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
Konstantinos Meichanetzidis, Stefano Gogioso, Giovanni De Felice, Nicolò
Chiappori, Alexis Toumi, and Bob Coecke.

</span>
<span class="ltx_bibblock">Quantum natural language processing on near-term quantum computers.

</span>
<span class="ltx_bibblock"><span id="bib.bib32.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2005.04147</span>, 2020.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
Nathan Wiebe, Alex Bocharov, Paul Smolensky, Matthias Troyer, and Krysta M
Svore.

</span>
<span class="ltx_bibblock">Quantum language processing.

</span>
<span class="ltx_bibblock"><span id="bib.bib33.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1902.05162</span>, 2019.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
Samuel Yen-Chi Chen, Shinjae Yoo, and Yao-Lung L Fang.

</span>
<span class="ltx_bibblock">Quantum long short-term memory.

</span>
<span class="ltx_bibblock"><span id="bib.bib34.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2009.01783</span>, 2020.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock">
Jacob Devlin, Ming-Wei Chang, Kenton Lee, and Kristina Toutanova.

</span>
<span class="ltx_bibblock">Bert: Pre-training of deep bidirectional transformers for language
understanding.

</span>
<span class="ltx_bibblock"><span id="bib.bib35.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1810.04805</span>, 2018.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock">
Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones,
Aidan N Gomez, Łukasz Kaiser, and Illia Polosukhin.

</span>
<span class="ltx_bibblock">Attention is all you need.

</span>
<span class="ltx_bibblock">In <span id="bib.bib36.1.1" class="ltx_text ltx_font_italic">Proceedings of the 31st International Conference on Neural
Information Processing Systems</span>, pages 6000–6010, 2017.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock">
Xiangpeng Li, Jingkuan Song, Lianli Gao, Xianglong Liu, Wenbing Huang, Xiangnan
He, and Chuang Gan.

</span>
<span class="ltx_bibblock">Beyond rnns: Positional self-attention with co-attention for video
question answering.

</span>
<span class="ltx_bibblock">In <span id="bib.bib37.1.1" class="ltx_text ltx_font_italic">Proceedings of the AAAI Conference on Artificial
Intelligence</span>, volume 33, pages 8658–8665, 2019.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock">
Qipeng Guo, Xipeng Qiu, Pengfei Liu, Xiangyang Xue, and Zheng Zhang.

</span>
<span class="ltx_bibblock">Multi-scale self-attention for text classification.

</span>
<span class="ltx_bibblock">In <span id="bib.bib38.1.1" class="ltx_text ltx_font_italic">Proceedings of the AAAI Conference on Artificial
Intelligence</span>, volume 34, pages 7847–7854, 2020.

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock">
Peter Cha, Paul Ginsparg, Felix Wu, Juan Carrasquilla, Peter L McMahon, and
Eun-Ah Kim.

</span>
<span class="ltx_bibblock">Attention-based quantum tomography.

</span>
<span class="ltx_bibblock"><span id="bib.bib39.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2006.12469</span>, 2020.

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock">
Robin Lorenz, Anna Pearson, Konstantinos Meichanetzidis, Dimitri Kartsaklis,
and Bob Coecke.

</span>
<span class="ltx_bibblock">Qnlp in practice: Running compositional models of meaning on a
quantum computer.

</span>
<span class="ltx_bibblock"><span id="bib.bib40.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2102.12846</span>, 2021.

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock">
Michael A. Nielsen and Isaac Chuang.

</span>
<span class="ltx_bibblock">Quantum Computation and Quantum Information.

</span>
<span class="ltx_bibblock"><span id="bib.bib41.1.1" class="ltx_text ltx_font_italic">American Journal of Physics</span>, 70(5):558–559, May 2002.

</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[42]</span>
<span class="ltx_bibblock">
Charles A Micchelli, Yuesheng Xu, and Haizhang Zhang.

</span>
<span class="ltx_bibblock">Universal kernels.

</span>
<span class="ltx_bibblock"><span id="bib.bib42.1.1" class="ltx_text ltx_font_italic">Journal of Machine Learning Research</span>, 7(12), 2006.

</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[43]</span>
<span class="ltx_bibblock">
Riccardo Di Sipio, Jia-Hong Huang, Samuel Yen-Chi Chen, Stefano Mangini, and
Marcel Worring.

</span>
<span class="ltx_bibblock">The dawn of quantum natural language processing.

</span>
<span class="ltx_bibblock">In <span id="bib.bib43.1.1" class="ltx_text ltx_font_italic">ICASSP 2022-2022 IEEE International Conference on Acoustics,
Speech and Signal Processing (ICASSP)</span>, pages 8612–8616. IEEE, 2022.

</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[44]</span>
<span class="ltx_bibblock">
Eric R. Ziegel, E. L. Lehmann, and George Casella.

</span>
<span class="ltx_bibblock">Theory of Point Estimation.

</span>
<span class="ltx_bibblock"><span id="bib.bib44.1.1" class="ltx_text ltx_font_italic">Technometrics</span>, 41(3):274, Aug 1999.

</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[45]</span>
<span class="ltx_bibblock">
Léon Bottou.

</span>
<span class="ltx_bibblock">Stochastic Learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib45.1.1" class="ltx_text ltx_font_italic">Lecture Notes in Computer Science (including subseries
Lecture Notes in Artificial Intelligence and Lecture Notes in
Bioinformatics)</span>, volume 3176, pages 146–168. 2004.

</span>
</li>
<li id="bib.bib46" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[46]</span>
<span class="ltx_bibblock">
Yunchao Liu, Srinivasan Arunachalam, and Kristan Temme.

</span>
<span class="ltx_bibblock">A rigorous and robust quantum speed-up in supervised machine
learning.

</span>
<span class="ltx_bibblock"><span id="bib.bib46.1.1" class="ltx_text ltx_font_italic">Nature Physics</span>, pages 1–5, 2021.

</span>
</li>
<li id="bib.bib47" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[47]</span>
<span class="ltx_bibblock">
Hsin-Yuan Huang, Michael Broughton, Masoud Mohseni, Ryan Babbush, Sergio Boixo,
Hartmut Neven, and Jarrod R McClean.

</span>
<span class="ltx_bibblock">Power of data in quantum machine learning.

</span>
<span class="ltx_bibblock"><span id="bib.bib47.1.1" class="ltx_text ltx_font_italic">Nature Communications</span>, 12(1):1–9, 2021.

</span>
</li>
<li id="bib.bib48" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[48]</span>
<span class="ltx_bibblock">
Dimitrios Kotzias, Misha Denil, Nando De Freitas, and Padhraic Smyth.

</span>
<span class="ltx_bibblock">From group to individual labels using deep features.

</span>
<span class="ltx_bibblock">In <span id="bib.bib48.1.1" class="ltx_text ltx_font_italic">Proceedings of the 21th ACM SIGKDD International Conference
on Knowledge Discovery and Data Mining</span>, pages 597–606, 2015.

</span>
</li>
<li id="bib.bib49" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[49]</span>
<span class="ltx_bibblock">
Yanjun Ma, Dianhai Yu, Tian Wu, and Haifeng Wang.

</span>
<span class="ltx_bibblock">PaddlePaddle: An Open-Source Deep Learning Platform from Industrial
Practice.

</span>
<span class="ltx_bibblock"><span id="bib.bib49.1.1" class="ltx_text ltx_font_italic">Frontiers of Data and Domputing</span>, 1(1):105–115, 2019.

</span>
</li>
<li id="bib.bib50" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[50]</span>
<span class="ltx_bibblock">
Dheeru Dua and Casey Graff.

</span>
<span class="ltx_bibblock">UCI machine learning repository, 2017.

</span>
</li>
<li id="bib.bib51" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[51]</span>
<span class="ltx_bibblock">
Diederik P. Kingma and Jimmy Lei Ba.

</span>
<span class="ltx_bibblock">Adam: A method for stochastic optimization.

</span>
<span class="ltx_bibblock"><span id="bib.bib51.1.1" class="ltx_text ltx_font_italic">3rd International Conference on Learning Representations, ICLR
2015 - Conference Track Proceedings</span>, Dec 2015.

</span>
</li>
<li id="bib.bib52" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[52]</span>
<span class="ltx_bibblock">
Ian Goodfellow, Yoshua Bengio, and Aaron Courville.

</span>
<span class="ltx_bibblock"><span id="bib.bib52.1.1" class="ltx_text ltx_font_italic">Deep Learning</span>.

</span>
<span class="ltx_bibblock">MIT Press, 2016.

</span>
<span class="ltx_bibblock"><a target="_blank" href="http://www.deeplearningbook.org" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://www.deeplearningbook.org</a>.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<div id="p1" class="ltx_para ltx_align_center">
<p id="p1.1" class="ltx_p"><span id="p1.1.1" class="ltx_text ltx_font_bold" style="font-size:144%;">Appendix for Quantum Self-Attention Neural Networks</span></p>
<p id="p1.2" class="ltx_p"><span id="p1.2.1" class="ltx_text ltx_font_bold" style="font-size:144%;">for Text Classification</span></p>
</div>
<section id="S1a" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Analytical Gradients</h2>

<div id="S1a.p1" class="ltx_para">
<p id="S1a.p1.5" class="ltx_p">Here, we give the stochastic analytical partial gradients of the loss function with regard to its parameters as follows.
We first consider the parameters in the last quantum self-attention neural network layer, i.e., <math id="S1a.p1.1.m1.6" class="ltx_Math" alttext="\bm{\theta}^{(L)}_{q},\bm{\theta}^{(L)}_{k},\bm{\theta}^{(L)}_{v}" display="inline"><semantics id="S1a.p1.1.m1.6a"><mrow id="S1a.p1.1.m1.6.6.3" xref="S1a.p1.1.m1.6.6.4.cmml"><msubsup id="S1a.p1.1.m1.4.4.1.1" xref="S1a.p1.1.m1.4.4.1.1.cmml"><mi id="S1a.p1.1.m1.4.4.1.1.2.2" xref="S1a.p1.1.m1.4.4.1.1.2.2.cmml">𝜽</mi><mi id="S1a.p1.1.m1.4.4.1.1.3" xref="S1a.p1.1.m1.4.4.1.1.3.cmml">q</mi><mrow id="S1a.p1.1.m1.1.1.1.3" xref="S1a.p1.1.m1.4.4.1.1.cmml"><mo stretchy="false" id="S1a.p1.1.m1.1.1.1.3.1" xref="S1a.p1.1.m1.4.4.1.1.cmml">(</mo><mi id="S1a.p1.1.m1.1.1.1.1" xref="S1a.p1.1.m1.1.1.1.1.cmml">L</mi><mo stretchy="false" id="S1a.p1.1.m1.1.1.1.3.2" xref="S1a.p1.1.m1.4.4.1.1.cmml">)</mo></mrow></msubsup><mo id="S1a.p1.1.m1.6.6.3.4" xref="S1a.p1.1.m1.6.6.4.cmml">,</mo><msubsup id="S1a.p1.1.m1.5.5.2.2" xref="S1a.p1.1.m1.5.5.2.2.cmml"><mi id="S1a.p1.1.m1.5.5.2.2.2.2" xref="S1a.p1.1.m1.5.5.2.2.2.2.cmml">𝜽</mi><mi id="S1a.p1.1.m1.5.5.2.2.3" xref="S1a.p1.1.m1.5.5.2.2.3.cmml">k</mi><mrow id="S1a.p1.1.m1.2.2.1.3" xref="S1a.p1.1.m1.5.5.2.2.cmml"><mo stretchy="false" id="S1a.p1.1.m1.2.2.1.3.1" xref="S1a.p1.1.m1.5.5.2.2.cmml">(</mo><mi id="S1a.p1.1.m1.2.2.1.1" xref="S1a.p1.1.m1.2.2.1.1.cmml">L</mi><mo stretchy="false" id="S1a.p1.1.m1.2.2.1.3.2" xref="S1a.p1.1.m1.5.5.2.2.cmml">)</mo></mrow></msubsup><mo id="S1a.p1.1.m1.6.6.3.5" xref="S1a.p1.1.m1.6.6.4.cmml">,</mo><msubsup id="S1a.p1.1.m1.6.6.3.3" xref="S1a.p1.1.m1.6.6.3.3.cmml"><mi id="S1a.p1.1.m1.6.6.3.3.2.2" xref="S1a.p1.1.m1.6.6.3.3.2.2.cmml">𝜽</mi><mi id="S1a.p1.1.m1.6.6.3.3.3" xref="S1a.p1.1.m1.6.6.3.3.3.cmml">v</mi><mrow id="S1a.p1.1.m1.3.3.1.3" xref="S1a.p1.1.m1.6.6.3.3.cmml"><mo stretchy="false" id="S1a.p1.1.m1.3.3.1.3.1" xref="S1a.p1.1.m1.6.6.3.3.cmml">(</mo><mi id="S1a.p1.1.m1.3.3.1.1" xref="S1a.p1.1.m1.3.3.1.1.cmml">L</mi><mo stretchy="false" id="S1a.p1.1.m1.3.3.1.3.2" xref="S1a.p1.1.m1.6.6.3.3.cmml">)</mo></mrow></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S1a.p1.1.m1.6b"><list id="S1a.p1.1.m1.6.6.4.cmml" xref="S1a.p1.1.m1.6.6.3"><apply id="S1a.p1.1.m1.4.4.1.1.cmml" xref="S1a.p1.1.m1.4.4.1.1"><csymbol cd="ambiguous" id="S1a.p1.1.m1.4.4.1.1.1.cmml" xref="S1a.p1.1.m1.4.4.1.1">subscript</csymbol><apply id="S1a.p1.1.m1.4.4.1.1.2.cmml" xref="S1a.p1.1.m1.4.4.1.1"><csymbol cd="ambiguous" id="S1a.p1.1.m1.4.4.1.1.2.1.cmml" xref="S1a.p1.1.m1.4.4.1.1">superscript</csymbol><ci id="S1a.p1.1.m1.4.4.1.1.2.2.cmml" xref="S1a.p1.1.m1.4.4.1.1.2.2">𝜽</ci><ci id="S1a.p1.1.m1.1.1.1.1.cmml" xref="S1a.p1.1.m1.1.1.1.1">𝐿</ci></apply><ci id="S1a.p1.1.m1.4.4.1.1.3.cmml" xref="S1a.p1.1.m1.4.4.1.1.3">𝑞</ci></apply><apply id="S1a.p1.1.m1.5.5.2.2.cmml" xref="S1a.p1.1.m1.5.5.2.2"><csymbol cd="ambiguous" id="S1a.p1.1.m1.5.5.2.2.1.cmml" xref="S1a.p1.1.m1.5.5.2.2">subscript</csymbol><apply id="S1a.p1.1.m1.5.5.2.2.2.cmml" xref="S1a.p1.1.m1.5.5.2.2"><csymbol cd="ambiguous" id="S1a.p1.1.m1.5.5.2.2.2.1.cmml" xref="S1a.p1.1.m1.5.5.2.2">superscript</csymbol><ci id="S1a.p1.1.m1.5.5.2.2.2.2.cmml" xref="S1a.p1.1.m1.5.5.2.2.2.2">𝜽</ci><ci id="S1a.p1.1.m1.2.2.1.1.cmml" xref="S1a.p1.1.m1.2.2.1.1">𝐿</ci></apply><ci id="S1a.p1.1.m1.5.5.2.2.3.cmml" xref="S1a.p1.1.m1.5.5.2.2.3">𝑘</ci></apply><apply id="S1a.p1.1.m1.6.6.3.3.cmml" xref="S1a.p1.1.m1.6.6.3.3"><csymbol cd="ambiguous" id="S1a.p1.1.m1.6.6.3.3.1.cmml" xref="S1a.p1.1.m1.6.6.3.3">subscript</csymbol><apply id="S1a.p1.1.m1.6.6.3.3.2.cmml" xref="S1a.p1.1.m1.6.6.3.3"><csymbol cd="ambiguous" id="S1a.p1.1.m1.6.6.3.3.2.1.cmml" xref="S1a.p1.1.m1.6.6.3.3">superscript</csymbol><ci id="S1a.p1.1.m1.6.6.3.3.2.2.cmml" xref="S1a.p1.1.m1.6.6.3.3.2.2">𝜽</ci><ci id="S1a.p1.1.m1.3.3.1.1.cmml" xref="S1a.p1.1.m1.3.3.1.1">𝐿</ci></apply><ci id="S1a.p1.1.m1.6.6.3.3.3.cmml" xref="S1a.p1.1.m1.6.6.3.3.3">𝑣</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S1a.p1.1.m1.6c">\bm{\theta}^{(L)}_{q},\bm{\theta}^{(L)}_{k},\bm{\theta}^{(L)}_{v}</annotation><annotation encoding="application/x-llamapun" id="S1a.p1.1.m1.6d">bold_italic_θ start_POSTSUPERSCRIPT ( italic_L ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT , bold_italic_θ start_POSTSUPERSCRIPT ( italic_L ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT , bold_italic_θ start_POSTSUPERSCRIPT ( italic_L ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT</annotation></semantics></math>, and the final fully-connected layer, i.e., <math id="S1a.p1.2.m2.2" class="ltx_Math" alttext="\bm{w},b" display="inline"><semantics id="S1a.p1.2.m2.2a"><mrow id="S1a.p1.2.m2.2.3.2" xref="S1a.p1.2.m2.2.3.1.cmml"><mi id="S1a.p1.2.m2.1.1" xref="S1a.p1.2.m2.1.1.cmml">𝒘</mi><mo id="S1a.p1.2.m2.2.3.2.1" xref="S1a.p1.2.m2.2.3.1.cmml">,</mo><mi id="S1a.p1.2.m2.2.2" xref="S1a.p1.2.m2.2.2.cmml">b</mi></mrow><annotation-xml encoding="MathML-Content" id="S1a.p1.2.m2.2b"><list id="S1a.p1.2.m2.2.3.1.cmml" xref="S1a.p1.2.m2.2.3.2"><ci id="S1a.p1.2.m2.1.1.cmml" xref="S1a.p1.2.m2.1.1">𝒘</ci><ci id="S1a.p1.2.m2.2.2.cmml" xref="S1a.p1.2.m2.2.2">𝑏</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S1a.p1.2.m2.2c">\bm{w},b</annotation><annotation encoding="application/x-llamapun" id="S1a.p1.2.m2.2d">bold_italic_w , italic_b</annotation></semantics></math>, and then the parameters in the front layers could be evaluated in a similar way and be updated through back-propagation algorithm <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib52" title="" class="ltx_ref">52</a>]</cite>. Given the <math id="S1a.p1.3.m3.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S1a.p1.3.m3.1a"><mi id="S1a.p1.3.m3.1.1" xref="S1a.p1.3.m3.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S1a.p1.3.m3.1b"><ci id="S1a.p1.3.m3.1.1.cmml" xref="S1a.p1.3.m3.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S1a.p1.3.m3.1c">m</annotation><annotation encoding="application/x-llamapun" id="S1a.p1.3.m3.1d">italic_m</annotation></semantics></math>-th data sample <math id="S1a.p1.4.m4.3" class="ltx_Math" alttext="\left\{\left(\bm{x}_{1},\bm{x}_{2},\ldots,\bm{x}_{S_{m}}\right),y\right\}" display="inline"><semantics id="S1a.p1.4.m4.3a"><mrow id="S1a.p1.4.m4.3.3.1" xref="S1a.p1.4.m4.3.3.2.cmml"><mo id="S1a.p1.4.m4.3.3.1.2" xref="S1a.p1.4.m4.3.3.2.cmml">{</mo><mrow id="S1a.p1.4.m4.3.3.1.1.3" xref="S1a.p1.4.m4.3.3.1.1.4.cmml"><mo id="S1a.p1.4.m4.3.3.1.1.3.4" xref="S1a.p1.4.m4.3.3.1.1.4.cmml">(</mo><msub id="S1a.p1.4.m4.3.3.1.1.1.1" xref="S1a.p1.4.m4.3.3.1.1.1.1.cmml"><mi id="S1a.p1.4.m4.3.3.1.1.1.1.2" xref="S1a.p1.4.m4.3.3.1.1.1.1.2.cmml">𝒙</mi><mn id="S1a.p1.4.m4.3.3.1.1.1.1.3" xref="S1a.p1.4.m4.3.3.1.1.1.1.3.cmml">1</mn></msub><mo id="S1a.p1.4.m4.3.3.1.1.3.5" xref="S1a.p1.4.m4.3.3.1.1.4.cmml">,</mo><msub id="S1a.p1.4.m4.3.3.1.1.2.2" xref="S1a.p1.4.m4.3.3.1.1.2.2.cmml"><mi id="S1a.p1.4.m4.3.3.1.1.2.2.2" xref="S1a.p1.4.m4.3.3.1.1.2.2.2.cmml">𝒙</mi><mn id="S1a.p1.4.m4.3.3.1.1.2.2.3" xref="S1a.p1.4.m4.3.3.1.1.2.2.3.cmml">2</mn></msub><mo id="S1a.p1.4.m4.3.3.1.1.3.6" xref="S1a.p1.4.m4.3.3.1.1.4.cmml">,</mo><mi mathvariant="normal" id="S1a.p1.4.m4.1.1" xref="S1a.p1.4.m4.1.1.cmml">…</mi><mo id="S1a.p1.4.m4.3.3.1.1.3.7" xref="S1a.p1.4.m4.3.3.1.1.4.cmml">,</mo><msub id="S1a.p1.4.m4.3.3.1.1.3.3" xref="S1a.p1.4.m4.3.3.1.1.3.3.cmml"><mi id="S1a.p1.4.m4.3.3.1.1.3.3.2" xref="S1a.p1.4.m4.3.3.1.1.3.3.2.cmml">𝒙</mi><msub id="S1a.p1.4.m4.3.3.1.1.3.3.3" xref="S1a.p1.4.m4.3.3.1.1.3.3.3.cmml"><mi id="S1a.p1.4.m4.3.3.1.1.3.3.3.2" xref="S1a.p1.4.m4.3.3.1.1.3.3.3.2.cmml">S</mi><mi id="S1a.p1.4.m4.3.3.1.1.3.3.3.3" xref="S1a.p1.4.m4.3.3.1.1.3.3.3.3.cmml">m</mi></msub></msub><mo id="S1a.p1.4.m4.3.3.1.1.3.8" xref="S1a.p1.4.m4.3.3.1.1.4.cmml">)</mo></mrow><mo id="S1a.p1.4.m4.3.3.1.3" xref="S1a.p1.4.m4.3.3.2.cmml">,</mo><mi id="S1a.p1.4.m4.2.2" xref="S1a.p1.4.m4.2.2.cmml">y</mi><mo id="S1a.p1.4.m4.3.3.1.4" xref="S1a.p1.4.m4.3.3.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S1a.p1.4.m4.3b"><set id="S1a.p1.4.m4.3.3.2.cmml" xref="S1a.p1.4.m4.3.3.1"><vector id="S1a.p1.4.m4.3.3.1.1.4.cmml" xref="S1a.p1.4.m4.3.3.1.1.3"><apply id="S1a.p1.4.m4.3.3.1.1.1.1.cmml" xref="S1a.p1.4.m4.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S1a.p1.4.m4.3.3.1.1.1.1.1.cmml" xref="S1a.p1.4.m4.3.3.1.1.1.1">subscript</csymbol><ci id="S1a.p1.4.m4.3.3.1.1.1.1.2.cmml" xref="S1a.p1.4.m4.3.3.1.1.1.1.2">𝒙</ci><cn type="integer" id="S1a.p1.4.m4.3.3.1.1.1.1.3.cmml" xref="S1a.p1.4.m4.3.3.1.1.1.1.3">1</cn></apply><apply id="S1a.p1.4.m4.3.3.1.1.2.2.cmml" xref="S1a.p1.4.m4.3.3.1.1.2.2"><csymbol cd="ambiguous" id="S1a.p1.4.m4.3.3.1.1.2.2.1.cmml" xref="S1a.p1.4.m4.3.3.1.1.2.2">subscript</csymbol><ci id="S1a.p1.4.m4.3.3.1.1.2.2.2.cmml" xref="S1a.p1.4.m4.3.3.1.1.2.2.2">𝒙</ci><cn type="integer" id="S1a.p1.4.m4.3.3.1.1.2.2.3.cmml" xref="S1a.p1.4.m4.3.3.1.1.2.2.3">2</cn></apply><ci id="S1a.p1.4.m4.1.1.cmml" xref="S1a.p1.4.m4.1.1">…</ci><apply id="S1a.p1.4.m4.3.3.1.1.3.3.cmml" xref="S1a.p1.4.m4.3.3.1.1.3.3"><csymbol cd="ambiguous" id="S1a.p1.4.m4.3.3.1.1.3.3.1.cmml" xref="S1a.p1.4.m4.3.3.1.1.3.3">subscript</csymbol><ci id="S1a.p1.4.m4.3.3.1.1.3.3.2.cmml" xref="S1a.p1.4.m4.3.3.1.1.3.3.2">𝒙</ci><apply id="S1a.p1.4.m4.3.3.1.1.3.3.3.cmml" xref="S1a.p1.4.m4.3.3.1.1.3.3.3"><csymbol cd="ambiguous" id="S1a.p1.4.m4.3.3.1.1.3.3.3.1.cmml" xref="S1a.p1.4.m4.3.3.1.1.3.3.3">subscript</csymbol><ci id="S1a.p1.4.m4.3.3.1.1.3.3.3.2.cmml" xref="S1a.p1.4.m4.3.3.1.1.3.3.3.2">𝑆</ci><ci id="S1a.p1.4.m4.3.3.1.1.3.3.3.3.cmml" xref="S1a.p1.4.m4.3.3.1.1.3.3.3.3">𝑚</ci></apply></apply></vector><ci id="S1a.p1.4.m4.2.2.cmml" xref="S1a.p1.4.m4.2.2">𝑦</ci></set></annotation-xml><annotation encoding="application/x-tex" id="S1a.p1.4.m4.3c">\left\{\left(\bm{x}_{1},\bm{x}_{2},\ldots,\bm{x}_{S_{m}}\right),y\right\}</annotation><annotation encoding="application/x-llamapun" id="S1a.p1.4.m4.3d">{ ( bold_italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , bold_italic_x start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , bold_italic_x start_POSTSUBSCRIPT italic_S start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) , italic_y }</annotation></semantics></math> (here, we omit <math id="S1a.p1.5.m5.1" class="ltx_Math" alttext="(m)" display="inline"><semantics id="S1a.p1.5.m5.1a"><mrow id="S1a.p1.5.m5.1.2.2"><mo stretchy="false" id="S1a.p1.5.m5.1.2.2.1">(</mo><mi id="S1a.p1.5.m5.1.1" xref="S1a.p1.5.m5.1.1.cmml">m</mi><mo stretchy="false" id="S1a.p1.5.m5.1.2.2.2">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S1a.p1.5.m5.1b"><ci id="S1a.p1.5.m5.1.1.cmml" xref="S1a.p1.5.m5.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S1a.p1.5.m5.1c">(m)</annotation><annotation encoding="application/x-llamapun" id="S1a.p1.5.m5.1d">( italic_m )</annotation></semantics></math> in the left superscript for writing convenience, the same below), we have</p>
<table id="S1.EGx12" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S1.E1a"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S1.E1a.m1.2" class="ltx_Math" alttext="\displaystyle\frac{\partial\mathcal{L}}{\partial\bm{w}}=\tilde{\sigma}\cdot%
\frac{1}{S_{m}}\sum_{s=1}^{S_{m}}\bm{y}^{(L)}_{s}+\frac{\lambda}{d}\bm{w},%
\qquad\frac{\partial\mathcal{L}}{\partial b}=\tilde{\sigma}," display="inline"><semantics id="S1.E1a.m1.2a"><mrow id="S1.E1a.m1.2.2.1"><mrow id="S1.E1a.m1.2.2.1.1.2" xref="S1.E1a.m1.2.2.1.1.3.cmml"><mrow id="S1.E1a.m1.2.2.1.1.1.1" xref="S1.E1a.m1.2.2.1.1.1.1.cmml"><mstyle displaystyle="true" id="S1.E1a.m1.2.2.1.1.1.1.2" xref="S1.E1a.m1.2.2.1.1.1.1.2.cmml"><mfrac id="S1.E1a.m1.2.2.1.1.1.1.2a" xref="S1.E1a.m1.2.2.1.1.1.1.2.cmml"><mrow id="S1.E1a.m1.2.2.1.1.1.1.2.2" xref="S1.E1a.m1.2.2.1.1.1.1.2.2.cmml"><mo id="S1.E1a.m1.2.2.1.1.1.1.2.2.1" xref="S1.E1a.m1.2.2.1.1.1.1.2.2.1.cmml">∂</mo><mo id="S1.E1a.m1.2.2.1.1.1.1.2.2a" xref="S1.E1a.m1.2.2.1.1.1.1.2.2.cmml">⁡</mo><mi class="ltx_font_mathcaligraphic" id="S1.E1a.m1.2.2.1.1.1.1.2.2.2" xref="S1.E1a.m1.2.2.1.1.1.1.2.2.2.cmml">ℒ</mi></mrow><mrow id="S1.E1a.m1.2.2.1.1.1.1.2.3" xref="S1.E1a.m1.2.2.1.1.1.1.2.3.cmml"><mo id="S1.E1a.m1.2.2.1.1.1.1.2.3.1" xref="S1.E1a.m1.2.2.1.1.1.1.2.3.1.cmml">∂</mo><mo id="S1.E1a.m1.2.2.1.1.1.1.2.3a" xref="S1.E1a.m1.2.2.1.1.1.1.2.3.cmml">⁡</mo><mi id="S1.E1a.m1.2.2.1.1.1.1.2.3.2" xref="S1.E1a.m1.2.2.1.1.1.1.2.3.2.cmml">𝒘</mi></mrow></mfrac></mstyle><mo id="S1.E1a.m1.2.2.1.1.1.1.1" xref="S1.E1a.m1.2.2.1.1.1.1.1.cmml">=</mo><mrow id="S1.E1a.m1.2.2.1.1.1.1.3" xref="S1.E1a.m1.2.2.1.1.1.1.3.cmml"><mrow id="S1.E1a.m1.2.2.1.1.1.1.3.2" xref="S1.E1a.m1.2.2.1.1.1.1.3.2.cmml"><mrow id="S1.E1a.m1.2.2.1.1.1.1.3.2.2" xref="S1.E1a.m1.2.2.1.1.1.1.3.2.2.cmml"><mover accent="true" id="S1.E1a.m1.2.2.1.1.1.1.3.2.2.2" xref="S1.E1a.m1.2.2.1.1.1.1.3.2.2.2.cmml"><mi id="S1.E1a.m1.2.2.1.1.1.1.3.2.2.2.2" xref="S1.E1a.m1.2.2.1.1.1.1.3.2.2.2.2.cmml">σ</mi><mo stretchy="false" id="S1.E1a.m1.2.2.1.1.1.1.3.2.2.2.1" xref="S1.E1a.m1.2.2.1.1.1.1.3.2.2.2.1.cmml">~</mo></mover><mo id="S1.E1a.m1.2.2.1.1.1.1.3.2.2.1" xref="S1.E1a.m1.2.2.1.1.1.1.3.2.2.1.cmml">⋅</mo><mstyle displaystyle="true" id="S1.E1a.m1.2.2.1.1.1.1.3.2.2.3" xref="S1.E1a.m1.2.2.1.1.1.1.3.2.2.3.cmml"><mfrac id="S1.E1a.m1.2.2.1.1.1.1.3.2.2.3a" xref="S1.E1a.m1.2.2.1.1.1.1.3.2.2.3.cmml"><mn id="S1.E1a.m1.2.2.1.1.1.1.3.2.2.3.2" xref="S1.E1a.m1.2.2.1.1.1.1.3.2.2.3.2.cmml">1</mn><msub id="S1.E1a.m1.2.2.1.1.1.1.3.2.2.3.3" xref="S1.E1a.m1.2.2.1.1.1.1.3.2.2.3.3.cmml"><mi id="S1.E1a.m1.2.2.1.1.1.1.3.2.2.3.3.2" xref="S1.E1a.m1.2.2.1.1.1.1.3.2.2.3.3.2.cmml">S</mi><mi id="S1.E1a.m1.2.2.1.1.1.1.3.2.2.3.3.3" xref="S1.E1a.m1.2.2.1.1.1.1.3.2.2.3.3.3.cmml">m</mi></msub></mfrac></mstyle></mrow><mo id="S1.E1a.m1.2.2.1.1.1.1.3.2.1" xref="S1.E1a.m1.2.2.1.1.1.1.3.2.1.cmml">⁢</mo><mrow id="S1.E1a.m1.2.2.1.1.1.1.3.2.3" xref="S1.E1a.m1.2.2.1.1.1.1.3.2.3.cmml"><mstyle displaystyle="true" id="S1.E1a.m1.2.2.1.1.1.1.3.2.3.1" xref="S1.E1a.m1.2.2.1.1.1.1.3.2.3.1.cmml"><munderover id="S1.E1a.m1.2.2.1.1.1.1.3.2.3.1a" xref="S1.E1a.m1.2.2.1.1.1.1.3.2.3.1.cmml"><mo largeop="true" movablelimits="false" symmetric="true" id="S1.E1a.m1.2.2.1.1.1.1.3.2.3.1.2.2" xref="S1.E1a.m1.2.2.1.1.1.1.3.2.3.1.2.2.cmml">∑</mo><mrow id="S1.E1a.m1.2.2.1.1.1.1.3.2.3.1.2.3" xref="S1.E1a.m1.2.2.1.1.1.1.3.2.3.1.2.3.cmml"><mi id="S1.E1a.m1.2.2.1.1.1.1.3.2.3.1.2.3.2" xref="S1.E1a.m1.2.2.1.1.1.1.3.2.3.1.2.3.2.cmml">s</mi><mo id="S1.E1a.m1.2.2.1.1.1.1.3.2.3.1.2.3.1" xref="S1.E1a.m1.2.2.1.1.1.1.3.2.3.1.2.3.1.cmml">=</mo><mn id="S1.E1a.m1.2.2.1.1.1.1.3.2.3.1.2.3.3" xref="S1.E1a.m1.2.2.1.1.1.1.3.2.3.1.2.3.3.cmml">1</mn></mrow><msub id="S1.E1a.m1.2.2.1.1.1.1.3.2.3.1.3" xref="S1.E1a.m1.2.2.1.1.1.1.3.2.3.1.3.cmml"><mi id="S1.E1a.m1.2.2.1.1.1.1.3.2.3.1.3.2" xref="S1.E1a.m1.2.2.1.1.1.1.3.2.3.1.3.2.cmml">S</mi><mi id="S1.E1a.m1.2.2.1.1.1.1.3.2.3.1.3.3" xref="S1.E1a.m1.2.2.1.1.1.1.3.2.3.1.3.3.cmml">m</mi></msub></munderover></mstyle><msubsup id="S1.E1a.m1.2.2.1.1.1.1.3.2.3.2" xref="S1.E1a.m1.2.2.1.1.1.1.3.2.3.2.cmml"><mi id="S1.E1a.m1.2.2.1.1.1.1.3.2.3.2.2.2" xref="S1.E1a.m1.2.2.1.1.1.1.3.2.3.2.2.2.cmml">𝒚</mi><mi id="S1.E1a.m1.2.2.1.1.1.1.3.2.3.2.3" xref="S1.E1a.m1.2.2.1.1.1.1.3.2.3.2.3.cmml">s</mi><mrow id="S1.E1a.m1.1.1.1.3" xref="S1.E1a.m1.2.2.1.1.1.1.3.2.3.2.cmml"><mo stretchy="false" id="S1.E1a.m1.1.1.1.3.1" xref="S1.E1a.m1.2.2.1.1.1.1.3.2.3.2.cmml">(</mo><mi id="S1.E1a.m1.1.1.1.1" xref="S1.E1a.m1.1.1.1.1.cmml">L</mi><mo stretchy="false" id="S1.E1a.m1.1.1.1.3.2" xref="S1.E1a.m1.2.2.1.1.1.1.3.2.3.2.cmml">)</mo></mrow></msubsup></mrow></mrow><mo id="S1.E1a.m1.2.2.1.1.1.1.3.1" xref="S1.E1a.m1.2.2.1.1.1.1.3.1.cmml">+</mo><mrow id="S1.E1a.m1.2.2.1.1.1.1.3.3" xref="S1.E1a.m1.2.2.1.1.1.1.3.3.cmml"><mstyle displaystyle="true" id="S1.E1a.m1.2.2.1.1.1.1.3.3.2" xref="S1.E1a.m1.2.2.1.1.1.1.3.3.2.cmml"><mfrac id="S1.E1a.m1.2.2.1.1.1.1.3.3.2a" xref="S1.E1a.m1.2.2.1.1.1.1.3.3.2.cmml"><mi id="S1.E1a.m1.2.2.1.1.1.1.3.3.2.2" xref="S1.E1a.m1.2.2.1.1.1.1.3.3.2.2.cmml">λ</mi><mi id="S1.E1a.m1.2.2.1.1.1.1.3.3.2.3" xref="S1.E1a.m1.2.2.1.1.1.1.3.3.2.3.cmml">d</mi></mfrac></mstyle><mo id="S1.E1a.m1.2.2.1.1.1.1.3.3.1" xref="S1.E1a.m1.2.2.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S1.E1a.m1.2.2.1.1.1.1.3.3.3" xref="S1.E1a.m1.2.2.1.1.1.1.3.3.3.cmml">𝒘</mi></mrow></mrow></mrow><mo rspace="22.5pt" id="S1.E1a.m1.2.2.1.1.2.3" xref="S1.E1a.m1.2.2.1.1.3a.cmml">,</mo><mrow id="S1.E1a.m1.2.2.1.1.2.2" xref="S1.E1a.m1.2.2.1.1.2.2.cmml"><mstyle displaystyle="true" id="S1.E1a.m1.2.2.1.1.2.2.2" xref="S1.E1a.m1.2.2.1.1.2.2.2.cmml"><mfrac id="S1.E1a.m1.2.2.1.1.2.2.2a" xref="S1.E1a.m1.2.2.1.1.2.2.2.cmml"><mrow id="S1.E1a.m1.2.2.1.1.2.2.2.2" xref="S1.E1a.m1.2.2.1.1.2.2.2.2.cmml"><mo id="S1.E1a.m1.2.2.1.1.2.2.2.2.1" xref="S1.E1a.m1.2.2.1.1.2.2.2.2.1.cmml">∂</mo><mo id="S1.E1a.m1.2.2.1.1.2.2.2.2a" xref="S1.E1a.m1.2.2.1.1.2.2.2.2.cmml">⁡</mo><mi class="ltx_font_mathcaligraphic" id="S1.E1a.m1.2.2.1.1.2.2.2.2.2" xref="S1.E1a.m1.2.2.1.1.2.2.2.2.2.cmml">ℒ</mi></mrow><mrow id="S1.E1a.m1.2.2.1.1.2.2.2.3" xref="S1.E1a.m1.2.2.1.1.2.2.2.3.cmml"><mo id="S1.E1a.m1.2.2.1.1.2.2.2.3.1" xref="S1.E1a.m1.2.2.1.1.2.2.2.3.1.cmml">∂</mo><mo id="S1.E1a.m1.2.2.1.1.2.2.2.3a" xref="S1.E1a.m1.2.2.1.1.2.2.2.3.cmml">⁡</mo><mi id="S1.E1a.m1.2.2.1.1.2.2.2.3.2" xref="S1.E1a.m1.2.2.1.1.2.2.2.3.2.cmml">b</mi></mrow></mfrac></mstyle><mo id="S1.E1a.m1.2.2.1.1.2.2.1" xref="S1.E1a.m1.2.2.1.1.2.2.1.cmml">=</mo><mover accent="true" id="S1.E1a.m1.2.2.1.1.2.2.3" xref="S1.E1a.m1.2.2.1.1.2.2.3.cmml"><mi id="S1.E1a.m1.2.2.1.1.2.2.3.2" xref="S1.E1a.m1.2.2.1.1.2.2.3.2.cmml">σ</mi><mo stretchy="false" id="S1.E1a.m1.2.2.1.1.2.2.3.1" xref="S1.E1a.m1.2.2.1.1.2.2.3.1.cmml">~</mo></mover></mrow></mrow><mo id="S1.E1a.m1.2.2.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S1.E1a.m1.2b"><apply id="S1.E1a.m1.2.2.1.1.3.cmml" xref="S1.E1a.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S1.E1a.m1.2.2.1.1.3a.cmml" xref="S1.E1a.m1.2.2.1.1.2.3">formulae-sequence</csymbol><apply id="S1.E1a.m1.2.2.1.1.1.1.cmml" xref="S1.E1a.m1.2.2.1.1.1.1"><eq id="S1.E1a.m1.2.2.1.1.1.1.1.cmml" xref="S1.E1a.m1.2.2.1.1.1.1.1"></eq><apply id="S1.E1a.m1.2.2.1.1.1.1.2.cmml" xref="S1.E1a.m1.2.2.1.1.1.1.2"><divide id="S1.E1a.m1.2.2.1.1.1.1.2.1.cmml" xref="S1.E1a.m1.2.2.1.1.1.1.2"></divide><apply id="S1.E1a.m1.2.2.1.1.1.1.2.2.cmml" xref="S1.E1a.m1.2.2.1.1.1.1.2.2"><partialdiff id="S1.E1a.m1.2.2.1.1.1.1.2.2.1.cmml" xref="S1.E1a.m1.2.2.1.1.1.1.2.2.1"></partialdiff><ci id="S1.E1a.m1.2.2.1.1.1.1.2.2.2.cmml" xref="S1.E1a.m1.2.2.1.1.1.1.2.2.2">ℒ</ci></apply><apply id="S1.E1a.m1.2.2.1.1.1.1.2.3.cmml" xref="S1.E1a.m1.2.2.1.1.1.1.2.3"><partialdiff id="S1.E1a.m1.2.2.1.1.1.1.2.3.1.cmml" xref="S1.E1a.m1.2.2.1.1.1.1.2.3.1"></partialdiff><ci id="S1.E1a.m1.2.2.1.1.1.1.2.3.2.cmml" xref="S1.E1a.m1.2.2.1.1.1.1.2.3.2">𝒘</ci></apply></apply><apply id="S1.E1a.m1.2.2.1.1.1.1.3.cmml" xref="S1.E1a.m1.2.2.1.1.1.1.3"><plus id="S1.E1a.m1.2.2.1.1.1.1.3.1.cmml" xref="S1.E1a.m1.2.2.1.1.1.1.3.1"></plus><apply id="S1.E1a.m1.2.2.1.1.1.1.3.2.cmml" xref="S1.E1a.m1.2.2.1.1.1.1.3.2"><times id="S1.E1a.m1.2.2.1.1.1.1.3.2.1.cmml" xref="S1.E1a.m1.2.2.1.1.1.1.3.2.1"></times><apply id="S1.E1a.m1.2.2.1.1.1.1.3.2.2.cmml" xref="S1.E1a.m1.2.2.1.1.1.1.3.2.2"><ci id="S1.E1a.m1.2.2.1.1.1.1.3.2.2.1.cmml" xref="S1.E1a.m1.2.2.1.1.1.1.3.2.2.1">⋅</ci><apply id="S1.E1a.m1.2.2.1.1.1.1.3.2.2.2.cmml" xref="S1.E1a.m1.2.2.1.1.1.1.3.2.2.2"><ci id="S1.E1a.m1.2.2.1.1.1.1.3.2.2.2.1.cmml" xref="S1.E1a.m1.2.2.1.1.1.1.3.2.2.2.1">~</ci><ci id="S1.E1a.m1.2.2.1.1.1.1.3.2.2.2.2.cmml" xref="S1.E1a.m1.2.2.1.1.1.1.3.2.2.2.2">𝜎</ci></apply><apply id="S1.E1a.m1.2.2.1.1.1.1.3.2.2.3.cmml" xref="S1.E1a.m1.2.2.1.1.1.1.3.2.2.3"><divide id="S1.E1a.m1.2.2.1.1.1.1.3.2.2.3.1.cmml" xref="S1.E1a.m1.2.2.1.1.1.1.3.2.2.3"></divide><cn type="integer" id="S1.E1a.m1.2.2.1.1.1.1.3.2.2.3.2.cmml" xref="S1.E1a.m1.2.2.1.1.1.1.3.2.2.3.2">1</cn><apply id="S1.E1a.m1.2.2.1.1.1.1.3.2.2.3.3.cmml" xref="S1.E1a.m1.2.2.1.1.1.1.3.2.2.3.3"><csymbol cd="ambiguous" id="S1.E1a.m1.2.2.1.1.1.1.3.2.2.3.3.1.cmml" xref="S1.E1a.m1.2.2.1.1.1.1.3.2.2.3.3">subscript</csymbol><ci id="S1.E1a.m1.2.2.1.1.1.1.3.2.2.3.3.2.cmml" xref="S1.E1a.m1.2.2.1.1.1.1.3.2.2.3.3.2">𝑆</ci><ci id="S1.E1a.m1.2.2.1.1.1.1.3.2.2.3.3.3.cmml" xref="S1.E1a.m1.2.2.1.1.1.1.3.2.2.3.3.3">𝑚</ci></apply></apply></apply><apply id="S1.E1a.m1.2.2.1.1.1.1.3.2.3.cmml" xref="S1.E1a.m1.2.2.1.1.1.1.3.2.3"><apply id="S1.E1a.m1.2.2.1.1.1.1.3.2.3.1.cmml" xref="S1.E1a.m1.2.2.1.1.1.1.3.2.3.1"><csymbol cd="ambiguous" id="S1.E1a.m1.2.2.1.1.1.1.3.2.3.1.1.cmml" xref="S1.E1a.m1.2.2.1.1.1.1.3.2.3.1">superscript</csymbol><apply id="S1.E1a.m1.2.2.1.1.1.1.3.2.3.1.2.cmml" xref="S1.E1a.m1.2.2.1.1.1.1.3.2.3.1"><csymbol cd="ambiguous" id="S1.E1a.m1.2.2.1.1.1.1.3.2.3.1.2.1.cmml" xref="S1.E1a.m1.2.2.1.1.1.1.3.2.3.1">subscript</csymbol><sum id="S1.E1a.m1.2.2.1.1.1.1.3.2.3.1.2.2.cmml" xref="S1.E1a.m1.2.2.1.1.1.1.3.2.3.1.2.2"></sum><apply id="S1.E1a.m1.2.2.1.1.1.1.3.2.3.1.2.3.cmml" xref="S1.E1a.m1.2.2.1.1.1.1.3.2.3.1.2.3"><eq id="S1.E1a.m1.2.2.1.1.1.1.3.2.3.1.2.3.1.cmml" xref="S1.E1a.m1.2.2.1.1.1.1.3.2.3.1.2.3.1"></eq><ci id="S1.E1a.m1.2.2.1.1.1.1.3.2.3.1.2.3.2.cmml" xref="S1.E1a.m1.2.2.1.1.1.1.3.2.3.1.2.3.2">𝑠</ci><cn type="integer" id="S1.E1a.m1.2.2.1.1.1.1.3.2.3.1.2.3.3.cmml" xref="S1.E1a.m1.2.2.1.1.1.1.3.2.3.1.2.3.3">1</cn></apply></apply><apply id="S1.E1a.m1.2.2.1.1.1.1.3.2.3.1.3.cmml" xref="S1.E1a.m1.2.2.1.1.1.1.3.2.3.1.3"><csymbol cd="ambiguous" id="S1.E1a.m1.2.2.1.1.1.1.3.2.3.1.3.1.cmml" xref="S1.E1a.m1.2.2.1.1.1.1.3.2.3.1.3">subscript</csymbol><ci id="S1.E1a.m1.2.2.1.1.1.1.3.2.3.1.3.2.cmml" xref="S1.E1a.m1.2.2.1.1.1.1.3.2.3.1.3.2">𝑆</ci><ci id="S1.E1a.m1.2.2.1.1.1.1.3.2.3.1.3.3.cmml" xref="S1.E1a.m1.2.2.1.1.1.1.3.2.3.1.3.3">𝑚</ci></apply></apply><apply id="S1.E1a.m1.2.2.1.1.1.1.3.2.3.2.cmml" xref="S1.E1a.m1.2.2.1.1.1.1.3.2.3.2"><csymbol cd="ambiguous" id="S1.E1a.m1.2.2.1.1.1.1.3.2.3.2.1.cmml" xref="S1.E1a.m1.2.2.1.1.1.1.3.2.3.2">subscript</csymbol><apply id="S1.E1a.m1.2.2.1.1.1.1.3.2.3.2.2.cmml" xref="S1.E1a.m1.2.2.1.1.1.1.3.2.3.2"><csymbol cd="ambiguous" id="S1.E1a.m1.2.2.1.1.1.1.3.2.3.2.2.1.cmml" xref="S1.E1a.m1.2.2.1.1.1.1.3.2.3.2">superscript</csymbol><ci id="S1.E1a.m1.2.2.1.1.1.1.3.2.3.2.2.2.cmml" xref="S1.E1a.m1.2.2.1.1.1.1.3.2.3.2.2.2">𝒚</ci><ci id="S1.E1a.m1.1.1.1.1.cmml" xref="S1.E1a.m1.1.1.1.1">𝐿</ci></apply><ci id="S1.E1a.m1.2.2.1.1.1.1.3.2.3.2.3.cmml" xref="S1.E1a.m1.2.2.1.1.1.1.3.2.3.2.3">𝑠</ci></apply></apply></apply><apply id="S1.E1a.m1.2.2.1.1.1.1.3.3.cmml" xref="S1.E1a.m1.2.2.1.1.1.1.3.3"><times id="S1.E1a.m1.2.2.1.1.1.1.3.3.1.cmml" xref="S1.E1a.m1.2.2.1.1.1.1.3.3.1"></times><apply id="S1.E1a.m1.2.2.1.1.1.1.3.3.2.cmml" xref="S1.E1a.m1.2.2.1.1.1.1.3.3.2"><divide id="S1.E1a.m1.2.2.1.1.1.1.3.3.2.1.cmml" xref="S1.E1a.m1.2.2.1.1.1.1.3.3.2"></divide><ci id="S1.E1a.m1.2.2.1.1.1.1.3.3.2.2.cmml" xref="S1.E1a.m1.2.2.1.1.1.1.3.3.2.2">𝜆</ci><ci id="S1.E1a.m1.2.2.1.1.1.1.3.3.2.3.cmml" xref="S1.E1a.m1.2.2.1.1.1.1.3.3.2.3">𝑑</ci></apply><ci id="S1.E1a.m1.2.2.1.1.1.1.3.3.3.cmml" xref="S1.E1a.m1.2.2.1.1.1.1.3.3.3">𝒘</ci></apply></apply></apply><apply id="S1.E1a.m1.2.2.1.1.2.2.cmml" xref="S1.E1a.m1.2.2.1.1.2.2"><eq id="S1.E1a.m1.2.2.1.1.2.2.1.cmml" xref="S1.E1a.m1.2.2.1.1.2.2.1"></eq><apply id="S1.E1a.m1.2.2.1.1.2.2.2.cmml" xref="S1.E1a.m1.2.2.1.1.2.2.2"><divide id="S1.E1a.m1.2.2.1.1.2.2.2.1.cmml" xref="S1.E1a.m1.2.2.1.1.2.2.2"></divide><apply id="S1.E1a.m1.2.2.1.1.2.2.2.2.cmml" xref="S1.E1a.m1.2.2.1.1.2.2.2.2"><partialdiff id="S1.E1a.m1.2.2.1.1.2.2.2.2.1.cmml" xref="S1.E1a.m1.2.2.1.1.2.2.2.2.1"></partialdiff><ci id="S1.E1a.m1.2.2.1.1.2.2.2.2.2.cmml" xref="S1.E1a.m1.2.2.1.1.2.2.2.2.2">ℒ</ci></apply><apply id="S1.E1a.m1.2.2.1.1.2.2.2.3.cmml" xref="S1.E1a.m1.2.2.1.1.2.2.2.3"><partialdiff id="S1.E1a.m1.2.2.1.1.2.2.2.3.1.cmml" xref="S1.E1a.m1.2.2.1.1.2.2.2.3.1"></partialdiff><ci id="S1.E1a.m1.2.2.1.1.2.2.2.3.2.cmml" xref="S1.E1a.m1.2.2.1.1.2.2.2.3.2">𝑏</ci></apply></apply><apply id="S1.E1a.m1.2.2.1.1.2.2.3.cmml" xref="S1.E1a.m1.2.2.1.1.2.2.3"><ci id="S1.E1a.m1.2.2.1.1.2.2.3.1.cmml" xref="S1.E1a.m1.2.2.1.1.2.2.3.1">~</ci><ci id="S1.E1a.m1.2.2.1.1.2.2.3.2.cmml" xref="S1.E1a.m1.2.2.1.1.2.2.3.2">𝜎</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.E1a.m1.2c">\displaystyle\frac{\partial\mathcal{L}}{\partial\bm{w}}=\tilde{\sigma}\cdot%
\frac{1}{S_{m}}\sum_{s=1}^{S_{m}}\bm{y}^{(L)}_{s}+\frac{\lambda}{d}\bm{w},%
\qquad\frac{\partial\mathcal{L}}{\partial b}=\tilde{\sigma},</annotation><annotation encoding="application/x-llamapun" id="S1.E1a.m1.2d">divide start_ARG ∂ caligraphic_L end_ARG start_ARG ∂ bold_italic_w end_ARG = over~ start_ARG italic_σ end_ARG ⋅ divide start_ARG 1 end_ARG start_ARG italic_S start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT end_ARG ∑ start_POSTSUBSCRIPT italic_s = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_S start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT end_POSTSUPERSCRIPT bold_italic_y start_POSTSUPERSCRIPT ( italic_L ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT + divide start_ARG italic_λ end_ARG start_ARG italic_d end_ARG bold_italic_w , divide start_ARG ∂ caligraphic_L end_ARG start_ARG ∂ italic_b end_ARG = over~ start_ARG italic_σ end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(S1)</span></td>
</tr></tbody>
<tbody id="S1.E2a"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S1.E2a.m1.2" class="ltx_Math" alttext="\displaystyle\frac{\partial\mathcal{L}}{\partial\bm{y}^{(L)}_{s}}=\tilde{%
\sigma}\cdot\frac{1}{S_{m}}\cdot\bm{w}," display="inline"><semantics id="S1.E2a.m1.2a"><mrow id="S1.E2a.m1.2.2.1" xref="S1.E2a.m1.2.2.1.1.cmml"><mrow id="S1.E2a.m1.2.2.1.1" xref="S1.E2a.m1.2.2.1.1.cmml"><mstyle displaystyle="true" id="S1.E2a.m1.1.1" xref="S1.E2a.m1.1.1.cmml"><mfrac id="S1.E2a.m1.1.1a" xref="S1.E2a.m1.1.1.cmml"><mrow id="S1.E2a.m1.1.1.3" xref="S1.E2a.m1.1.1.3.cmml"><mo id="S1.E2a.m1.1.1.3.1" xref="S1.E2a.m1.1.1.3.1.cmml">∂</mo><mo id="S1.E2a.m1.1.1.3a" xref="S1.E2a.m1.1.1.3.cmml">⁡</mo><mi class="ltx_font_mathcaligraphic" id="S1.E2a.m1.1.1.3.2" xref="S1.E2a.m1.1.1.3.2.cmml">ℒ</mi></mrow><mrow id="S1.E2a.m1.1.1.1" xref="S1.E2a.m1.1.1.1.cmml"><mo id="S1.E2a.m1.1.1.1.2" xref="S1.E2a.m1.1.1.1.2.cmml">∂</mo><mo id="S1.E2a.m1.1.1.1a" xref="S1.E2a.m1.1.1.1.cmml">⁡</mo><msubsup id="S1.E2a.m1.1.1.1.3" xref="S1.E2a.m1.1.1.1.3.cmml"><mi id="S1.E2a.m1.1.1.1.3.2.2" xref="S1.E2a.m1.1.1.1.3.2.2.cmml">𝒚</mi><mi id="S1.E2a.m1.1.1.1.3.3" xref="S1.E2a.m1.1.1.1.3.3.cmml">s</mi><mrow id="S1.E2a.m1.1.1.1.1.1.3" xref="S1.E2a.m1.1.1.1.3.cmml"><mo stretchy="false" id="S1.E2a.m1.1.1.1.1.1.3.1" xref="S1.E2a.m1.1.1.1.3.cmml">(</mo><mi id="S1.E2a.m1.1.1.1.1.1.1" xref="S1.E2a.m1.1.1.1.1.1.1.cmml">L</mi><mo stretchy="false" id="S1.E2a.m1.1.1.1.1.1.3.2" xref="S1.E2a.m1.1.1.1.3.cmml">)</mo></mrow></msubsup></mrow></mfrac></mstyle><mo id="S1.E2a.m1.2.2.1.1.1" xref="S1.E2a.m1.2.2.1.1.1.cmml">=</mo><mrow id="S1.E2a.m1.2.2.1.1.2" xref="S1.E2a.m1.2.2.1.1.2.cmml"><mover accent="true" id="S1.E2a.m1.2.2.1.1.2.2" xref="S1.E2a.m1.2.2.1.1.2.2.cmml"><mi id="S1.E2a.m1.2.2.1.1.2.2.2" xref="S1.E2a.m1.2.2.1.1.2.2.2.cmml">σ</mi><mo stretchy="false" id="S1.E2a.m1.2.2.1.1.2.2.1" xref="S1.E2a.m1.2.2.1.1.2.2.1.cmml">~</mo></mover><mo id="S1.E2a.m1.2.2.1.1.2.1" xref="S1.E2a.m1.2.2.1.1.2.1.cmml">⋅</mo><mstyle displaystyle="true" id="S1.E2a.m1.2.2.1.1.2.3" xref="S1.E2a.m1.2.2.1.1.2.3.cmml"><mfrac id="S1.E2a.m1.2.2.1.1.2.3a" xref="S1.E2a.m1.2.2.1.1.2.3.cmml"><mn id="S1.E2a.m1.2.2.1.1.2.3.2" xref="S1.E2a.m1.2.2.1.1.2.3.2.cmml">1</mn><msub id="S1.E2a.m1.2.2.1.1.2.3.3" xref="S1.E2a.m1.2.2.1.1.2.3.3.cmml"><mi id="S1.E2a.m1.2.2.1.1.2.3.3.2" xref="S1.E2a.m1.2.2.1.1.2.3.3.2.cmml">S</mi><mi id="S1.E2a.m1.2.2.1.1.2.3.3.3" xref="S1.E2a.m1.2.2.1.1.2.3.3.3.cmml">m</mi></msub></mfrac></mstyle><mo id="S1.E2a.m1.2.2.1.1.2.1a" xref="S1.E2a.m1.2.2.1.1.2.1.cmml">⋅</mo><mi id="S1.E2a.m1.2.2.1.1.2.4" xref="S1.E2a.m1.2.2.1.1.2.4.cmml">𝒘</mi></mrow></mrow><mo id="S1.E2a.m1.2.2.1.2" xref="S1.E2a.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S1.E2a.m1.2b"><apply id="S1.E2a.m1.2.2.1.1.cmml" xref="S1.E2a.m1.2.2.1"><eq id="S1.E2a.m1.2.2.1.1.1.cmml" xref="S1.E2a.m1.2.2.1.1.1"></eq><apply id="S1.E2a.m1.1.1.cmml" xref="S1.E2a.m1.1.1"><divide id="S1.E2a.m1.1.1.2.cmml" xref="S1.E2a.m1.1.1"></divide><apply id="S1.E2a.m1.1.1.3.cmml" xref="S1.E2a.m1.1.1.3"><partialdiff id="S1.E2a.m1.1.1.3.1.cmml" xref="S1.E2a.m1.1.1.3.1"></partialdiff><ci id="S1.E2a.m1.1.1.3.2.cmml" xref="S1.E2a.m1.1.1.3.2">ℒ</ci></apply><apply id="S1.E2a.m1.1.1.1.cmml" xref="S1.E2a.m1.1.1.1"><partialdiff id="S1.E2a.m1.1.1.1.2.cmml" xref="S1.E2a.m1.1.1.1.2"></partialdiff><apply id="S1.E2a.m1.1.1.1.3.cmml" xref="S1.E2a.m1.1.1.1.3"><csymbol cd="ambiguous" id="S1.E2a.m1.1.1.1.3.1.cmml" xref="S1.E2a.m1.1.1.1.3">subscript</csymbol><apply id="S1.E2a.m1.1.1.1.3.2.cmml" xref="S1.E2a.m1.1.1.1.3"><csymbol cd="ambiguous" id="S1.E2a.m1.1.1.1.3.2.1.cmml" xref="S1.E2a.m1.1.1.1.3">superscript</csymbol><ci id="S1.E2a.m1.1.1.1.3.2.2.cmml" xref="S1.E2a.m1.1.1.1.3.2.2">𝒚</ci><ci id="S1.E2a.m1.1.1.1.1.1.1.cmml" xref="S1.E2a.m1.1.1.1.1.1.1">𝐿</ci></apply><ci id="S1.E2a.m1.1.1.1.3.3.cmml" xref="S1.E2a.m1.1.1.1.3.3">𝑠</ci></apply></apply></apply><apply id="S1.E2a.m1.2.2.1.1.2.cmml" xref="S1.E2a.m1.2.2.1.1.2"><ci id="S1.E2a.m1.2.2.1.1.2.1.cmml" xref="S1.E2a.m1.2.2.1.1.2.1">⋅</ci><apply id="S1.E2a.m1.2.2.1.1.2.2.cmml" xref="S1.E2a.m1.2.2.1.1.2.2"><ci id="S1.E2a.m1.2.2.1.1.2.2.1.cmml" xref="S1.E2a.m1.2.2.1.1.2.2.1">~</ci><ci id="S1.E2a.m1.2.2.1.1.2.2.2.cmml" xref="S1.E2a.m1.2.2.1.1.2.2.2">𝜎</ci></apply><apply id="S1.E2a.m1.2.2.1.1.2.3.cmml" xref="S1.E2a.m1.2.2.1.1.2.3"><divide id="S1.E2a.m1.2.2.1.1.2.3.1.cmml" xref="S1.E2a.m1.2.2.1.1.2.3"></divide><cn type="integer" id="S1.E2a.m1.2.2.1.1.2.3.2.cmml" xref="S1.E2a.m1.2.2.1.1.2.3.2">1</cn><apply id="S1.E2a.m1.2.2.1.1.2.3.3.cmml" xref="S1.E2a.m1.2.2.1.1.2.3.3"><csymbol cd="ambiguous" id="S1.E2a.m1.2.2.1.1.2.3.3.1.cmml" xref="S1.E2a.m1.2.2.1.1.2.3.3">subscript</csymbol><ci id="S1.E2a.m1.2.2.1.1.2.3.3.2.cmml" xref="S1.E2a.m1.2.2.1.1.2.3.3.2">𝑆</ci><ci id="S1.E2a.m1.2.2.1.1.2.3.3.3.cmml" xref="S1.E2a.m1.2.2.1.1.2.3.3.3">𝑚</ci></apply></apply><ci id="S1.E2a.m1.2.2.1.1.2.4.cmml" xref="S1.E2a.m1.2.2.1.1.2.4">𝒘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.E2a.m1.2c">\displaystyle\frac{\partial\mathcal{L}}{\partial\bm{y}^{(L)}_{s}}=\tilde{%
\sigma}\cdot\frac{1}{S_{m}}\cdot\bm{w},</annotation><annotation encoding="application/x-llamapun" id="S1.E2a.m1.2d">divide start_ARG ∂ caligraphic_L end_ARG start_ARG ∂ bold_italic_y start_POSTSUPERSCRIPT ( italic_L ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT end_ARG = over~ start_ARG italic_σ end_ARG ⋅ divide start_ARG 1 end_ARG start_ARG italic_S start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT end_ARG ⋅ bold_italic_w ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(S2)</span></td>
</tr></tbody>
</table>
<p id="S1a.p1.8" class="ltx_p">where <math id="S1a.p1.6.m1.2" class="ltx_Math" alttext="\tilde{\sigma}=\left(\sigma-y\right)\cdot\sigma\left(1-\sigma\right)" display="inline"><semantics id="S1a.p1.6.m1.2a"><mrow id="S1a.p1.6.m1.2.2" xref="S1a.p1.6.m1.2.2.cmml"><mover accent="true" id="S1a.p1.6.m1.2.2.4" xref="S1a.p1.6.m1.2.2.4.cmml"><mi id="S1a.p1.6.m1.2.2.4.2" xref="S1a.p1.6.m1.2.2.4.2.cmml">σ</mi><mo stretchy="false" id="S1a.p1.6.m1.2.2.4.1" xref="S1a.p1.6.m1.2.2.4.1.cmml">~</mo></mover><mo id="S1a.p1.6.m1.2.2.3" xref="S1a.p1.6.m1.2.2.3.cmml">=</mo><mrow id="S1a.p1.6.m1.2.2.2" xref="S1a.p1.6.m1.2.2.2.cmml"><mrow id="S1a.p1.6.m1.1.1.1.1" xref="S1a.p1.6.m1.1.1.1.1.cmml"><mrow id="S1a.p1.6.m1.1.1.1.1.1.1" xref="S1a.p1.6.m1.1.1.1.1.1.1.1.cmml"><mo id="S1a.p1.6.m1.1.1.1.1.1.1.2" xref="S1a.p1.6.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S1a.p1.6.m1.1.1.1.1.1.1.1" xref="S1a.p1.6.m1.1.1.1.1.1.1.1.cmml"><mi id="S1a.p1.6.m1.1.1.1.1.1.1.1.2" xref="S1a.p1.6.m1.1.1.1.1.1.1.1.2.cmml">σ</mi><mo id="S1a.p1.6.m1.1.1.1.1.1.1.1.1" xref="S1a.p1.6.m1.1.1.1.1.1.1.1.1.cmml">-</mo><mi id="S1a.p1.6.m1.1.1.1.1.1.1.1.3" xref="S1a.p1.6.m1.1.1.1.1.1.1.1.3.cmml">y</mi></mrow><mo id="S1a.p1.6.m1.1.1.1.1.1.1.3" xref="S1a.p1.6.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S1a.p1.6.m1.1.1.1.1.2" xref="S1a.p1.6.m1.1.1.1.1.2.cmml">⋅</mo><mi id="S1a.p1.6.m1.1.1.1.1.3" xref="S1a.p1.6.m1.1.1.1.1.3.cmml">σ</mi></mrow><mo id="S1a.p1.6.m1.2.2.2.3" xref="S1a.p1.6.m1.2.2.2.3.cmml">⁢</mo><mrow id="S1a.p1.6.m1.2.2.2.2.1" xref="S1a.p1.6.m1.2.2.2.2.1.1.cmml"><mo id="S1a.p1.6.m1.2.2.2.2.1.2" xref="S1a.p1.6.m1.2.2.2.2.1.1.cmml">(</mo><mrow id="S1a.p1.6.m1.2.2.2.2.1.1" xref="S1a.p1.6.m1.2.2.2.2.1.1.cmml"><mn id="S1a.p1.6.m1.2.2.2.2.1.1.2" xref="S1a.p1.6.m1.2.2.2.2.1.1.2.cmml">1</mn><mo id="S1a.p1.6.m1.2.2.2.2.1.1.1" xref="S1a.p1.6.m1.2.2.2.2.1.1.1.cmml">-</mo><mi id="S1a.p1.6.m1.2.2.2.2.1.1.3" xref="S1a.p1.6.m1.2.2.2.2.1.1.3.cmml">σ</mi></mrow><mo id="S1a.p1.6.m1.2.2.2.2.1.3" xref="S1a.p1.6.m1.2.2.2.2.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1a.p1.6.m1.2b"><apply id="S1a.p1.6.m1.2.2.cmml" xref="S1a.p1.6.m1.2.2"><eq id="S1a.p1.6.m1.2.2.3.cmml" xref="S1a.p1.6.m1.2.2.3"></eq><apply id="S1a.p1.6.m1.2.2.4.cmml" xref="S1a.p1.6.m1.2.2.4"><ci id="S1a.p1.6.m1.2.2.4.1.cmml" xref="S1a.p1.6.m1.2.2.4.1">~</ci><ci id="S1a.p1.6.m1.2.2.4.2.cmml" xref="S1a.p1.6.m1.2.2.4.2">𝜎</ci></apply><apply id="S1a.p1.6.m1.2.2.2.cmml" xref="S1a.p1.6.m1.2.2.2"><times id="S1a.p1.6.m1.2.2.2.3.cmml" xref="S1a.p1.6.m1.2.2.2.3"></times><apply id="S1a.p1.6.m1.1.1.1.1.cmml" xref="S1a.p1.6.m1.1.1.1.1"><ci id="S1a.p1.6.m1.1.1.1.1.2.cmml" xref="S1a.p1.6.m1.1.1.1.1.2">⋅</ci><apply id="S1a.p1.6.m1.1.1.1.1.1.1.1.cmml" xref="S1a.p1.6.m1.1.1.1.1.1.1"><minus id="S1a.p1.6.m1.1.1.1.1.1.1.1.1.cmml" xref="S1a.p1.6.m1.1.1.1.1.1.1.1.1"></minus><ci id="S1a.p1.6.m1.1.1.1.1.1.1.1.2.cmml" xref="S1a.p1.6.m1.1.1.1.1.1.1.1.2">𝜎</ci><ci id="S1a.p1.6.m1.1.1.1.1.1.1.1.3.cmml" xref="S1a.p1.6.m1.1.1.1.1.1.1.1.3">𝑦</ci></apply><ci id="S1a.p1.6.m1.1.1.1.1.3.cmml" xref="S1a.p1.6.m1.1.1.1.1.3">𝜎</ci></apply><apply id="S1a.p1.6.m1.2.2.2.2.1.1.cmml" xref="S1a.p1.6.m1.2.2.2.2.1"><minus id="S1a.p1.6.m1.2.2.2.2.1.1.1.cmml" xref="S1a.p1.6.m1.2.2.2.2.1.1.1"></minus><cn type="integer" id="S1a.p1.6.m1.2.2.2.2.1.1.2.cmml" xref="S1a.p1.6.m1.2.2.2.2.1.1.2">1</cn><ci id="S1a.p1.6.m1.2.2.2.2.1.1.3.cmml" xref="S1a.p1.6.m1.2.2.2.2.1.1.3">𝜎</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1a.p1.6.m1.2c">\tilde{\sigma}=\left(\sigma-y\right)\cdot\sigma\left(1-\sigma\right)</annotation><annotation encoding="application/x-llamapun" id="S1a.p1.6.m1.2d">over~ start_ARG italic_σ end_ARG = ( italic_σ - italic_y ) ⋅ italic_σ ( 1 - italic_σ )</annotation></semantics></math> and <math id="S1a.p1.7.m2.1" class="ltx_Math" alttext="\sigma" display="inline"><semantics id="S1a.p1.7.m2.1a"><mi id="S1a.p1.7.m2.1.1" xref="S1a.p1.7.m2.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S1a.p1.7.m2.1b"><ci id="S1a.p1.7.m2.1.1.cmml" xref="S1a.p1.7.m2.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S1a.p1.7.m2.1c">\sigma</annotation><annotation encoding="application/x-llamapun" id="S1a.p1.7.m2.1d">italic_σ</annotation></semantics></math> denotes the abbreviation of <math id="S1a.p1.8.m3.2" class="ltx_Math" alttext="\sigma\left(\bm{w}^{\top}\cdot\frac{1}{S_{m}}\sum_{s=1}^{S_{m}}{\bm{y}}^{(L)}_%
{s}+b\right)" display="inline"><semantics id="S1a.p1.8.m3.2a"><mrow id="S1a.p1.8.m3.2.2" xref="S1a.p1.8.m3.2.2.cmml"><mi id="S1a.p1.8.m3.2.2.3" xref="S1a.p1.8.m3.2.2.3.cmml">σ</mi><mo id="S1a.p1.8.m3.2.2.2" xref="S1a.p1.8.m3.2.2.2.cmml">⁢</mo><mrow id="S1a.p1.8.m3.2.2.1.1" xref="S1a.p1.8.m3.2.2.1.1.1.cmml"><mo id="S1a.p1.8.m3.2.2.1.1.2" xref="S1a.p1.8.m3.2.2.1.1.1.cmml">(</mo><mrow id="S1a.p1.8.m3.2.2.1.1.1" xref="S1a.p1.8.m3.2.2.1.1.1.cmml"><mrow id="S1a.p1.8.m3.2.2.1.1.1.2" xref="S1a.p1.8.m3.2.2.1.1.1.2.cmml"><mrow id="S1a.p1.8.m3.2.2.1.1.1.2.2" xref="S1a.p1.8.m3.2.2.1.1.1.2.2.cmml"><msup id="S1a.p1.8.m3.2.2.1.1.1.2.2.2" xref="S1a.p1.8.m3.2.2.1.1.1.2.2.2.cmml"><mi id="S1a.p1.8.m3.2.2.1.1.1.2.2.2.2" xref="S1a.p1.8.m3.2.2.1.1.1.2.2.2.2.cmml">𝒘</mi><mo id="S1a.p1.8.m3.2.2.1.1.1.2.2.2.3" xref="S1a.p1.8.m3.2.2.1.1.1.2.2.2.3.cmml">⊤</mo></msup><mo id="S1a.p1.8.m3.2.2.1.1.1.2.2.1" xref="S1a.p1.8.m3.2.2.1.1.1.2.2.1.cmml">⋅</mo><mfrac id="S1a.p1.8.m3.2.2.1.1.1.2.2.3" xref="S1a.p1.8.m3.2.2.1.1.1.2.2.3.cmml"><mn id="S1a.p1.8.m3.2.2.1.1.1.2.2.3.2" xref="S1a.p1.8.m3.2.2.1.1.1.2.2.3.2.cmml">1</mn><msub id="S1a.p1.8.m3.2.2.1.1.1.2.2.3.3" xref="S1a.p1.8.m3.2.2.1.1.1.2.2.3.3.cmml"><mi id="S1a.p1.8.m3.2.2.1.1.1.2.2.3.3.2" xref="S1a.p1.8.m3.2.2.1.1.1.2.2.3.3.2.cmml">S</mi><mi id="S1a.p1.8.m3.2.2.1.1.1.2.2.3.3.3" xref="S1a.p1.8.m3.2.2.1.1.1.2.2.3.3.3.cmml">m</mi></msub></mfrac></mrow><mo id="S1a.p1.8.m3.2.2.1.1.1.2.1" xref="S1a.p1.8.m3.2.2.1.1.1.2.1.cmml">⁢</mo><mrow id="S1a.p1.8.m3.2.2.1.1.1.2.3" xref="S1a.p1.8.m3.2.2.1.1.1.2.3.cmml"><msubsup id="S1a.p1.8.m3.2.2.1.1.1.2.3.1" xref="S1a.p1.8.m3.2.2.1.1.1.2.3.1.cmml"><mo largeop="true" symmetric="true" id="S1a.p1.8.m3.2.2.1.1.1.2.3.1.2.2" xref="S1a.p1.8.m3.2.2.1.1.1.2.3.1.2.2.cmml">∑</mo><mrow id="S1a.p1.8.m3.2.2.1.1.1.2.3.1.2.3" xref="S1a.p1.8.m3.2.2.1.1.1.2.3.1.2.3.cmml"><mi id="S1a.p1.8.m3.2.2.1.1.1.2.3.1.2.3.2" xref="S1a.p1.8.m3.2.2.1.1.1.2.3.1.2.3.2.cmml">s</mi><mo id="S1a.p1.8.m3.2.2.1.1.1.2.3.1.2.3.1" xref="S1a.p1.8.m3.2.2.1.1.1.2.3.1.2.3.1.cmml">=</mo><mn id="S1a.p1.8.m3.2.2.1.1.1.2.3.1.2.3.3" xref="S1a.p1.8.m3.2.2.1.1.1.2.3.1.2.3.3.cmml">1</mn></mrow><msub id="S1a.p1.8.m3.2.2.1.1.1.2.3.1.3" xref="S1a.p1.8.m3.2.2.1.1.1.2.3.1.3.cmml"><mi id="S1a.p1.8.m3.2.2.1.1.1.2.3.1.3.2" xref="S1a.p1.8.m3.2.2.1.1.1.2.3.1.3.2.cmml">S</mi><mi id="S1a.p1.8.m3.2.2.1.1.1.2.3.1.3.3" xref="S1a.p1.8.m3.2.2.1.1.1.2.3.1.3.3.cmml">m</mi></msub></msubsup><msubsup id="S1a.p1.8.m3.2.2.1.1.1.2.3.2" xref="S1a.p1.8.m3.2.2.1.1.1.2.3.2.cmml"><mi id="S1a.p1.8.m3.2.2.1.1.1.2.3.2.2.2" xref="S1a.p1.8.m3.2.2.1.1.1.2.3.2.2.2.cmml">𝒚</mi><mi id="S1a.p1.8.m3.2.2.1.1.1.2.3.2.3" xref="S1a.p1.8.m3.2.2.1.1.1.2.3.2.3.cmml">s</mi><mrow id="S1a.p1.8.m3.1.1.1.3" xref="S1a.p1.8.m3.2.2.1.1.1.2.3.2.cmml"><mo stretchy="false" id="S1a.p1.8.m3.1.1.1.3.1" xref="S1a.p1.8.m3.2.2.1.1.1.2.3.2.cmml">(</mo><mi id="S1a.p1.8.m3.1.1.1.1" xref="S1a.p1.8.m3.1.1.1.1.cmml">L</mi><mo stretchy="false" id="S1a.p1.8.m3.1.1.1.3.2" xref="S1a.p1.8.m3.2.2.1.1.1.2.3.2.cmml">)</mo></mrow></msubsup></mrow></mrow><mo id="S1a.p1.8.m3.2.2.1.1.1.1" xref="S1a.p1.8.m3.2.2.1.1.1.1.cmml">+</mo><mi id="S1a.p1.8.m3.2.2.1.1.1.3" xref="S1a.p1.8.m3.2.2.1.1.1.3.cmml">b</mi></mrow><mo id="S1a.p1.8.m3.2.2.1.1.3" xref="S1a.p1.8.m3.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1a.p1.8.m3.2b"><apply id="S1a.p1.8.m3.2.2.cmml" xref="S1a.p1.8.m3.2.2"><times id="S1a.p1.8.m3.2.2.2.cmml" xref="S1a.p1.8.m3.2.2.2"></times><ci id="S1a.p1.8.m3.2.2.3.cmml" xref="S1a.p1.8.m3.2.2.3">𝜎</ci><apply id="S1a.p1.8.m3.2.2.1.1.1.cmml" xref="S1a.p1.8.m3.2.2.1.1"><plus id="S1a.p1.8.m3.2.2.1.1.1.1.cmml" xref="S1a.p1.8.m3.2.2.1.1.1.1"></plus><apply id="S1a.p1.8.m3.2.2.1.1.1.2.cmml" xref="S1a.p1.8.m3.2.2.1.1.1.2"><times id="S1a.p1.8.m3.2.2.1.1.1.2.1.cmml" xref="S1a.p1.8.m3.2.2.1.1.1.2.1"></times><apply id="S1a.p1.8.m3.2.2.1.1.1.2.2.cmml" xref="S1a.p1.8.m3.2.2.1.1.1.2.2"><ci id="S1a.p1.8.m3.2.2.1.1.1.2.2.1.cmml" xref="S1a.p1.8.m3.2.2.1.1.1.2.2.1">⋅</ci><apply id="S1a.p1.8.m3.2.2.1.1.1.2.2.2.cmml" xref="S1a.p1.8.m3.2.2.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S1a.p1.8.m3.2.2.1.1.1.2.2.2.1.cmml" xref="S1a.p1.8.m3.2.2.1.1.1.2.2.2">superscript</csymbol><ci id="S1a.p1.8.m3.2.2.1.1.1.2.2.2.2.cmml" xref="S1a.p1.8.m3.2.2.1.1.1.2.2.2.2">𝒘</ci><csymbol cd="latexml" id="S1a.p1.8.m3.2.2.1.1.1.2.2.2.3.cmml" xref="S1a.p1.8.m3.2.2.1.1.1.2.2.2.3">top</csymbol></apply><apply id="S1a.p1.8.m3.2.2.1.1.1.2.2.3.cmml" xref="S1a.p1.8.m3.2.2.1.1.1.2.2.3"><divide id="S1a.p1.8.m3.2.2.1.1.1.2.2.3.1.cmml" xref="S1a.p1.8.m3.2.2.1.1.1.2.2.3"></divide><cn type="integer" id="S1a.p1.8.m3.2.2.1.1.1.2.2.3.2.cmml" xref="S1a.p1.8.m3.2.2.1.1.1.2.2.3.2">1</cn><apply id="S1a.p1.8.m3.2.2.1.1.1.2.2.3.3.cmml" xref="S1a.p1.8.m3.2.2.1.1.1.2.2.3.3"><csymbol cd="ambiguous" id="S1a.p1.8.m3.2.2.1.1.1.2.2.3.3.1.cmml" xref="S1a.p1.8.m3.2.2.1.1.1.2.2.3.3">subscript</csymbol><ci id="S1a.p1.8.m3.2.2.1.1.1.2.2.3.3.2.cmml" xref="S1a.p1.8.m3.2.2.1.1.1.2.2.3.3.2">𝑆</ci><ci id="S1a.p1.8.m3.2.2.1.1.1.2.2.3.3.3.cmml" xref="S1a.p1.8.m3.2.2.1.1.1.2.2.3.3.3">𝑚</ci></apply></apply></apply><apply id="S1a.p1.8.m3.2.2.1.1.1.2.3.cmml" xref="S1a.p1.8.m3.2.2.1.1.1.2.3"><apply id="S1a.p1.8.m3.2.2.1.1.1.2.3.1.cmml" xref="S1a.p1.8.m3.2.2.1.1.1.2.3.1"><csymbol cd="ambiguous" id="S1a.p1.8.m3.2.2.1.1.1.2.3.1.1.cmml" xref="S1a.p1.8.m3.2.2.1.1.1.2.3.1">superscript</csymbol><apply id="S1a.p1.8.m3.2.2.1.1.1.2.3.1.2.cmml" xref="S1a.p1.8.m3.2.2.1.1.1.2.3.1"><csymbol cd="ambiguous" id="S1a.p1.8.m3.2.2.1.1.1.2.3.1.2.1.cmml" xref="S1a.p1.8.m3.2.2.1.1.1.2.3.1">subscript</csymbol><sum id="S1a.p1.8.m3.2.2.1.1.1.2.3.1.2.2.cmml" xref="S1a.p1.8.m3.2.2.1.1.1.2.3.1.2.2"></sum><apply id="S1a.p1.8.m3.2.2.1.1.1.2.3.1.2.3.cmml" xref="S1a.p1.8.m3.2.2.1.1.1.2.3.1.2.3"><eq id="S1a.p1.8.m3.2.2.1.1.1.2.3.1.2.3.1.cmml" xref="S1a.p1.8.m3.2.2.1.1.1.2.3.1.2.3.1"></eq><ci id="S1a.p1.8.m3.2.2.1.1.1.2.3.1.2.3.2.cmml" xref="S1a.p1.8.m3.2.2.1.1.1.2.3.1.2.3.2">𝑠</ci><cn type="integer" id="S1a.p1.8.m3.2.2.1.1.1.2.3.1.2.3.3.cmml" xref="S1a.p1.8.m3.2.2.1.1.1.2.3.1.2.3.3">1</cn></apply></apply><apply id="S1a.p1.8.m3.2.2.1.1.1.2.3.1.3.cmml" xref="S1a.p1.8.m3.2.2.1.1.1.2.3.1.3"><csymbol cd="ambiguous" id="S1a.p1.8.m3.2.2.1.1.1.2.3.1.3.1.cmml" xref="S1a.p1.8.m3.2.2.1.1.1.2.3.1.3">subscript</csymbol><ci id="S1a.p1.8.m3.2.2.1.1.1.2.3.1.3.2.cmml" xref="S1a.p1.8.m3.2.2.1.1.1.2.3.1.3.2">𝑆</ci><ci id="S1a.p1.8.m3.2.2.1.1.1.2.3.1.3.3.cmml" xref="S1a.p1.8.m3.2.2.1.1.1.2.3.1.3.3">𝑚</ci></apply></apply><apply id="S1a.p1.8.m3.2.2.1.1.1.2.3.2.cmml" xref="S1a.p1.8.m3.2.2.1.1.1.2.3.2"><csymbol cd="ambiguous" id="S1a.p1.8.m3.2.2.1.1.1.2.3.2.1.cmml" xref="S1a.p1.8.m3.2.2.1.1.1.2.3.2">subscript</csymbol><apply id="S1a.p1.8.m3.2.2.1.1.1.2.3.2.2.cmml" xref="S1a.p1.8.m3.2.2.1.1.1.2.3.2"><csymbol cd="ambiguous" id="S1a.p1.8.m3.2.2.1.1.1.2.3.2.2.1.cmml" xref="S1a.p1.8.m3.2.2.1.1.1.2.3.2">superscript</csymbol><ci id="S1a.p1.8.m3.2.2.1.1.1.2.3.2.2.2.cmml" xref="S1a.p1.8.m3.2.2.1.1.1.2.3.2.2.2">𝒚</ci><ci id="S1a.p1.8.m3.1.1.1.1.cmml" xref="S1a.p1.8.m3.1.1.1.1">𝐿</ci></apply><ci id="S1a.p1.8.m3.2.2.1.1.1.2.3.2.3.cmml" xref="S1a.p1.8.m3.2.2.1.1.1.2.3.2.3">𝑠</ci></apply></apply></apply><ci id="S1a.p1.8.m3.2.2.1.1.1.3.cmml" xref="S1a.p1.8.m3.2.2.1.1.1.3">𝑏</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1a.p1.8.m3.2c">\sigma\left(\bm{w}^{\top}\cdot\frac{1}{S_{m}}\sum_{s=1}^{S_{m}}{\bm{y}}^{(L)}_%
{s}+b\right)</annotation><annotation encoding="application/x-llamapun" id="S1a.p1.8.m3.2d">italic_σ ( bold_italic_w start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT ⋅ divide start_ARG 1 end_ARG start_ARG italic_S start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT end_ARG ∑ start_POSTSUBSCRIPT italic_s = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_S start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT end_POSTSUPERSCRIPT bold_italic_y start_POSTSUPERSCRIPT ( italic_L ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT + italic_b )</annotation></semantics></math>.
We also have
<span id="S1a.p1.8.1" class="ltx_text" style="font-size:90%;"></span></p>
<table id="S1.EGx13" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S1.E3a"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S1.E3a.m1.1" class="ltx_Math" alttext="\displaystyle\frac{\partial\mathcal{L}}{\partial\bm{\theta}^{(L)}_{v}}" display="inline"><semantics id="S1.E3a.m1.1a"><mstyle displaystyle="true" id="S1.E3a.m1.1.1" xref="S1.E3a.m1.1.1.cmml"><mfrac id="S1.E3a.m1.1.1a" xref="S1.E3a.m1.1.1.cmml"><mrow id="S1.E3a.m1.1.1.3" xref="S1.E3a.m1.1.1.3.cmml"><mo mathsize="90%" stretchy="false" id="S1.E3a.m1.1.1.3.1" xref="S1.E3a.m1.1.1.3.1.cmml">∂</mo><mo id="S1.E3a.m1.1.1.3a" xref="S1.E3a.m1.1.1.3.cmml">⁡</mo><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S1.E3a.m1.1.1.3.2" xref="S1.E3a.m1.1.1.3.2.cmml">ℒ</mi></mrow><mrow id="S1.E3a.m1.1.1.1" xref="S1.E3a.m1.1.1.1.cmml"><mo mathsize="90%" stretchy="false" id="S1.E3a.m1.1.1.1.2" xref="S1.E3a.m1.1.1.1.2.cmml">∂</mo><mo id="S1.E3a.m1.1.1.1a" xref="S1.E3a.m1.1.1.1.cmml">⁡</mo><msubsup id="S1.E3a.m1.1.1.1.3" xref="S1.E3a.m1.1.1.1.3.cmml"><mi mathsize="90%" id="S1.E3a.m1.1.1.1.3.2.2" xref="S1.E3a.m1.1.1.1.3.2.2.cmml">𝜽</mi><mi mathsize="90%" id="S1.E3a.m1.1.1.1.3.3" xref="S1.E3a.m1.1.1.1.3.3.cmml">v</mi><mrow id="S1.E3a.m1.1.1.1.1.1.3" xref="S1.E3a.m1.1.1.1.3.cmml"><mo maxsize="90%" minsize="90%" id="S1.E3a.m1.1.1.1.1.1.3.1" xref="S1.E3a.m1.1.1.1.3.cmml">(</mo><mi mathsize="90%" id="S1.E3a.m1.1.1.1.1.1.1" xref="S1.E3a.m1.1.1.1.1.1.1.cmml">L</mi><mo maxsize="90%" minsize="90%" id="S1.E3a.m1.1.1.1.1.1.3.2" xref="S1.E3a.m1.1.1.1.3.cmml">)</mo></mrow></msubsup></mrow></mfrac></mstyle><annotation-xml encoding="MathML-Content" id="S1.E3a.m1.1b"><apply id="S1.E3a.m1.1.1.cmml" xref="S1.E3a.m1.1.1"><divide id="S1.E3a.m1.1.1.2.cmml" xref="S1.E3a.m1.1.1"></divide><apply id="S1.E3a.m1.1.1.3.cmml" xref="S1.E3a.m1.1.1.3"><partialdiff id="S1.E3a.m1.1.1.3.1.cmml" xref="S1.E3a.m1.1.1.3.1"></partialdiff><ci id="S1.E3a.m1.1.1.3.2.cmml" xref="S1.E3a.m1.1.1.3.2">ℒ</ci></apply><apply id="S1.E3a.m1.1.1.1.cmml" xref="S1.E3a.m1.1.1.1"><partialdiff id="S1.E3a.m1.1.1.1.2.cmml" xref="S1.E3a.m1.1.1.1.2"></partialdiff><apply id="S1.E3a.m1.1.1.1.3.cmml" xref="S1.E3a.m1.1.1.1.3"><csymbol cd="ambiguous" id="S1.E3a.m1.1.1.1.3.1.cmml" xref="S1.E3a.m1.1.1.1.3">subscript</csymbol><apply id="S1.E3a.m1.1.1.1.3.2.cmml" xref="S1.E3a.m1.1.1.1.3"><csymbol cd="ambiguous" id="S1.E3a.m1.1.1.1.3.2.1.cmml" xref="S1.E3a.m1.1.1.1.3">superscript</csymbol><ci id="S1.E3a.m1.1.1.1.3.2.2.cmml" xref="S1.E3a.m1.1.1.1.3.2.2">𝜽</ci><ci id="S1.E3a.m1.1.1.1.1.1.1.cmml" xref="S1.E3a.m1.1.1.1.1.1.1">𝐿</ci></apply><ci id="S1.E3a.m1.1.1.1.3.3.cmml" xref="S1.E3a.m1.1.1.1.3.3">𝑣</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.E3a.m1.1c">\displaystyle\frac{\partial\mathcal{L}}{\partial\bm{\theta}^{(L)}_{v}}</annotation><annotation encoding="application/x-llamapun" id="S1.E3a.m1.1d">divide start_ARG ∂ caligraphic_L end_ARG start_ARG ∂ bold_italic_θ start_POSTSUPERSCRIPT ( italic_L ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT end_ARG</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S1.E3a.m2.6" class="ltx_Math" alttext="\displaystyle=\sum_{s=1}^{S_{m}}\left(\frac{\partial\mathcal{L}}{\partial\bm{y%
}^{(L)}_{s}}\right)^{\top}\sum_{j=1}^{S_{m}}\frac{\partial\bm{y}^{(L)}_{s}}{%
\partial\bm{o}_{j}^{(L)}}\cdot\frac{\partial\bm{o}_{j}^{(L)}}{\partial\bm{%
\theta}^{(L)}_{v}}," display="inline"><semantics id="S1.E3a.m2.6a"><mrow id="S1.E3a.m2.6.6.1" xref="S1.E3a.m2.6.6.1.1.cmml"><mrow id="S1.E3a.m2.6.6.1.1" xref="S1.E3a.m2.6.6.1.1.cmml"><mi id="S1.E3a.m2.6.6.1.1.2" xref="S1.E3a.m2.6.6.1.1.2.cmml"></mi><mo mathsize="90%" stretchy="false" id="S1.E3a.m2.6.6.1.1.1" xref="S1.E3a.m2.6.6.1.1.1.cmml">=</mo><mrow id="S1.E3a.m2.6.6.1.1.3" xref="S1.E3a.m2.6.6.1.1.3.cmml"><mstyle displaystyle="true" id="S1.E3a.m2.6.6.1.1.3.1" xref="S1.E3a.m2.6.6.1.1.3.1.cmml"><munderover id="S1.E3a.m2.6.6.1.1.3.1a" xref="S1.E3a.m2.6.6.1.1.3.1.cmml"><mo largeop="true" mathsize="90%" movablelimits="false" stretchy="false" symmetric="true" id="S1.E3a.m2.6.6.1.1.3.1.2.2" xref="S1.E3a.m2.6.6.1.1.3.1.2.2.cmml">∑</mo><mrow id="S1.E3a.m2.6.6.1.1.3.1.2.3" xref="S1.E3a.m2.6.6.1.1.3.1.2.3.cmml"><mi mathsize="90%" id="S1.E3a.m2.6.6.1.1.3.1.2.3.2" xref="S1.E3a.m2.6.6.1.1.3.1.2.3.2.cmml">s</mi><mo mathsize="90%" stretchy="false" id="S1.E3a.m2.6.6.1.1.3.1.2.3.1" xref="S1.E3a.m2.6.6.1.1.3.1.2.3.1.cmml">=</mo><mn mathsize="90%" id="S1.E3a.m2.6.6.1.1.3.1.2.3.3" xref="S1.E3a.m2.6.6.1.1.3.1.2.3.3.cmml">1</mn></mrow><msub id="S1.E3a.m2.6.6.1.1.3.1.3" xref="S1.E3a.m2.6.6.1.1.3.1.3.cmml"><mi mathsize="90%" id="S1.E3a.m2.6.6.1.1.3.1.3.2" xref="S1.E3a.m2.6.6.1.1.3.1.3.2.cmml">S</mi><mi mathsize="90%" id="S1.E3a.m2.6.6.1.1.3.1.3.3" xref="S1.E3a.m2.6.6.1.1.3.1.3.3.cmml">m</mi></msub></munderover></mstyle><mrow id="S1.E3a.m2.6.6.1.1.3.2" xref="S1.E3a.m2.6.6.1.1.3.2.cmml"><msup id="S1.E3a.m2.6.6.1.1.3.2.2" xref="S1.E3a.m2.6.6.1.1.3.2.2.cmml"><mrow id="S1.E3a.m2.6.6.1.1.3.2.2.2.2" xref="S1.E3a.m2.1.1.cmml"><mo id="S1.E3a.m2.6.6.1.1.3.2.2.2.2.1" xref="S1.E3a.m2.1.1.cmml">(</mo><mstyle displaystyle="true" id="S1.E3a.m2.1.1" xref="S1.E3a.m2.1.1.cmml"><mfrac id="S1.E3a.m2.1.1a" xref="S1.E3a.m2.1.1.cmml"><mrow id="S1.E3a.m2.1.1.3" xref="S1.E3a.m2.1.1.3.cmml"><mo mathsize="90%" stretchy="false" id="S1.E3a.m2.1.1.3.1" xref="S1.E3a.m2.1.1.3.1.cmml">∂</mo><mo id="S1.E3a.m2.1.1.3a" xref="S1.E3a.m2.1.1.3.cmml">⁡</mo><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S1.E3a.m2.1.1.3.2" xref="S1.E3a.m2.1.1.3.2.cmml">ℒ</mi></mrow><mrow id="S1.E3a.m2.1.1.1" xref="S1.E3a.m2.1.1.1.cmml"><mo mathsize="90%" stretchy="false" id="S1.E3a.m2.1.1.1.2" xref="S1.E3a.m2.1.1.1.2.cmml">∂</mo><mo id="S1.E3a.m2.1.1.1a" xref="S1.E3a.m2.1.1.1.cmml">⁡</mo><msubsup id="S1.E3a.m2.1.1.1.3" xref="S1.E3a.m2.1.1.1.3.cmml"><mi mathsize="90%" id="S1.E3a.m2.1.1.1.3.2.2" xref="S1.E3a.m2.1.1.1.3.2.2.cmml">𝒚</mi><mi mathsize="90%" id="S1.E3a.m2.1.1.1.3.3" xref="S1.E3a.m2.1.1.1.3.3.cmml">s</mi><mrow id="S1.E3a.m2.1.1.1.1.1.3" xref="S1.E3a.m2.1.1.1.3.cmml"><mo maxsize="90%" minsize="90%" id="S1.E3a.m2.1.1.1.1.1.3.1" xref="S1.E3a.m2.1.1.1.3.cmml">(</mo><mi mathsize="90%" id="S1.E3a.m2.1.1.1.1.1.1" xref="S1.E3a.m2.1.1.1.1.1.1.cmml">L</mi><mo maxsize="90%" minsize="90%" id="S1.E3a.m2.1.1.1.1.1.3.2" xref="S1.E3a.m2.1.1.1.3.cmml">)</mo></mrow></msubsup></mrow></mfrac></mstyle><mo id="S1.E3a.m2.6.6.1.1.3.2.2.2.2.2" xref="S1.E3a.m2.1.1.cmml">)</mo></mrow><mo mathsize="90%" stretchy="false" id="S1.E3a.m2.6.6.1.1.3.2.2.3" xref="S1.E3a.m2.6.6.1.1.3.2.2.3.cmml">⊤</mo></msup><mo id="S1.E3a.m2.6.6.1.1.3.2.1" xref="S1.E3a.m2.6.6.1.1.3.2.1.cmml">⁢</mo><mrow id="S1.E3a.m2.6.6.1.1.3.2.3" xref="S1.E3a.m2.6.6.1.1.3.2.3.cmml"><mstyle displaystyle="true" id="S1.E3a.m2.6.6.1.1.3.2.3.1" xref="S1.E3a.m2.6.6.1.1.3.2.3.1.cmml"><munderover id="S1.E3a.m2.6.6.1.1.3.2.3.1a" xref="S1.E3a.m2.6.6.1.1.3.2.3.1.cmml"><mo largeop="true" mathsize="90%" movablelimits="false" stretchy="false" symmetric="true" id="S1.E3a.m2.6.6.1.1.3.2.3.1.2.2" xref="S1.E3a.m2.6.6.1.1.3.2.3.1.2.2.cmml">∑</mo><mrow id="S1.E3a.m2.6.6.1.1.3.2.3.1.2.3" xref="S1.E3a.m2.6.6.1.1.3.2.3.1.2.3.cmml"><mi mathsize="90%" id="S1.E3a.m2.6.6.1.1.3.2.3.1.2.3.2" xref="S1.E3a.m2.6.6.1.1.3.2.3.1.2.3.2.cmml">j</mi><mo mathsize="90%" stretchy="false" id="S1.E3a.m2.6.6.1.1.3.2.3.1.2.3.1" xref="S1.E3a.m2.6.6.1.1.3.2.3.1.2.3.1.cmml">=</mo><mn mathsize="90%" id="S1.E3a.m2.6.6.1.1.3.2.3.1.2.3.3" xref="S1.E3a.m2.6.6.1.1.3.2.3.1.2.3.3.cmml">1</mn></mrow><msub id="S1.E3a.m2.6.6.1.1.3.2.3.1.3" xref="S1.E3a.m2.6.6.1.1.3.2.3.1.3.cmml"><mi mathsize="90%" id="S1.E3a.m2.6.6.1.1.3.2.3.1.3.2" xref="S1.E3a.m2.6.6.1.1.3.2.3.1.3.2.cmml">S</mi><mi mathsize="90%" id="S1.E3a.m2.6.6.1.1.3.2.3.1.3.3" xref="S1.E3a.m2.6.6.1.1.3.2.3.1.3.3.cmml">m</mi></msub></munderover></mstyle><mrow id="S1.E3a.m2.6.6.1.1.3.2.3.2" xref="S1.E3a.m2.6.6.1.1.3.2.3.2.cmml"><mstyle displaystyle="true" id="S1.E3a.m2.3.3" xref="S1.E3a.m2.3.3.cmml"><mfrac id="S1.E3a.m2.3.3a" xref="S1.E3a.m2.3.3.cmml"><mrow id="S1.E3a.m2.2.2.1" xref="S1.E3a.m2.2.2.1.cmml"><mo mathsize="90%" stretchy="false" id="S1.E3a.m2.2.2.1.2" xref="S1.E3a.m2.2.2.1.2.cmml">∂</mo><mo id="S1.E3a.m2.2.2.1a" xref="S1.E3a.m2.2.2.1.cmml">⁡</mo><msubsup id="S1.E3a.m2.2.2.1.3" xref="S1.E3a.m2.2.2.1.3.cmml"><mi mathsize="90%" id="S1.E3a.m2.2.2.1.3.2.2" xref="S1.E3a.m2.2.2.1.3.2.2.cmml">𝒚</mi><mi mathsize="90%" id="S1.E3a.m2.2.2.1.3.3" xref="S1.E3a.m2.2.2.1.3.3.cmml">s</mi><mrow id="S1.E3a.m2.2.2.1.1.1.3" xref="S1.E3a.m2.2.2.1.3.cmml"><mo maxsize="90%" minsize="90%" id="S1.E3a.m2.2.2.1.1.1.3.1" xref="S1.E3a.m2.2.2.1.3.cmml">(</mo><mi mathsize="90%" id="S1.E3a.m2.2.2.1.1.1.1" xref="S1.E3a.m2.2.2.1.1.1.1.cmml">L</mi><mo maxsize="90%" minsize="90%" id="S1.E3a.m2.2.2.1.1.1.3.2" xref="S1.E3a.m2.2.2.1.3.cmml">)</mo></mrow></msubsup></mrow><mrow id="S1.E3a.m2.3.3.2" xref="S1.E3a.m2.3.3.2.cmml"><mo mathsize="90%" stretchy="false" id="S1.E3a.m2.3.3.2.2" xref="S1.E3a.m2.3.3.2.2.cmml">∂</mo><mo id="S1.E3a.m2.3.3.2a" xref="S1.E3a.m2.3.3.2.cmml">⁡</mo><msubsup id="S1.E3a.m2.3.3.2.3" xref="S1.E3a.m2.3.3.2.3.cmml"><mi mathsize="90%" id="S1.E3a.m2.3.3.2.3.2.2" xref="S1.E3a.m2.3.3.2.3.2.2.cmml">𝒐</mi><mi mathsize="90%" id="S1.E3a.m2.3.3.2.3.2.3" xref="S1.E3a.m2.3.3.2.3.2.3.cmml">j</mi><mrow id="S1.E3a.m2.3.3.2.1.1.3" xref="S1.E3a.m2.3.3.2.3.cmml"><mo maxsize="90%" minsize="90%" id="S1.E3a.m2.3.3.2.1.1.3.1" xref="S1.E3a.m2.3.3.2.3.cmml">(</mo><mi mathsize="90%" id="S1.E3a.m2.3.3.2.1.1.1" xref="S1.E3a.m2.3.3.2.1.1.1.cmml">L</mi><mo maxsize="90%" minsize="90%" id="S1.E3a.m2.3.3.2.1.1.3.2" xref="S1.E3a.m2.3.3.2.3.cmml">)</mo></mrow></msubsup></mrow></mfrac></mstyle><mo mathsize="90%" stretchy="false" id="S1.E3a.m2.6.6.1.1.3.2.3.2.1" xref="S1.E3a.m2.6.6.1.1.3.2.3.2.1.cmml">⋅</mo><mstyle displaystyle="true" id="S1.E3a.m2.5.5" xref="S1.E3a.m2.5.5.cmml"><mfrac id="S1.E3a.m2.5.5a" xref="S1.E3a.m2.5.5.cmml"><mrow id="S1.E3a.m2.4.4.1" xref="S1.E3a.m2.4.4.1.cmml"><mo mathsize="90%" stretchy="false" id="S1.E3a.m2.4.4.1.2" xref="S1.E3a.m2.4.4.1.2.cmml">∂</mo><mo id="S1.E3a.m2.4.4.1a" xref="S1.E3a.m2.4.4.1.cmml">⁡</mo><msubsup id="S1.E3a.m2.4.4.1.3" xref="S1.E3a.m2.4.4.1.3.cmml"><mi mathsize="90%" id="S1.E3a.m2.4.4.1.3.2.2" xref="S1.E3a.m2.4.4.1.3.2.2.cmml">𝒐</mi><mi mathsize="90%" id="S1.E3a.m2.4.4.1.3.2.3" xref="S1.E3a.m2.4.4.1.3.2.3.cmml">j</mi><mrow id="S1.E3a.m2.4.4.1.1.1.3" xref="S1.E3a.m2.4.4.1.3.cmml"><mo maxsize="90%" minsize="90%" id="S1.E3a.m2.4.4.1.1.1.3.1" xref="S1.E3a.m2.4.4.1.3.cmml">(</mo><mi mathsize="90%" id="S1.E3a.m2.4.4.1.1.1.1" xref="S1.E3a.m2.4.4.1.1.1.1.cmml">L</mi><mo maxsize="90%" minsize="90%" id="S1.E3a.m2.4.4.1.1.1.3.2" xref="S1.E3a.m2.4.4.1.3.cmml">)</mo></mrow></msubsup></mrow><mrow id="S1.E3a.m2.5.5.2" xref="S1.E3a.m2.5.5.2.cmml"><mo mathsize="90%" stretchy="false" id="S1.E3a.m2.5.5.2.2" xref="S1.E3a.m2.5.5.2.2.cmml">∂</mo><mo id="S1.E3a.m2.5.5.2a" xref="S1.E3a.m2.5.5.2.cmml">⁡</mo><msubsup id="S1.E3a.m2.5.5.2.3" xref="S1.E3a.m2.5.5.2.3.cmml"><mi mathsize="90%" id="S1.E3a.m2.5.5.2.3.2.2" xref="S1.E3a.m2.5.5.2.3.2.2.cmml">𝜽</mi><mi mathsize="90%" id="S1.E3a.m2.5.5.2.3.3" xref="S1.E3a.m2.5.5.2.3.3.cmml">v</mi><mrow id="S1.E3a.m2.5.5.2.1.1.3" xref="S1.E3a.m2.5.5.2.3.cmml"><mo maxsize="90%" minsize="90%" id="S1.E3a.m2.5.5.2.1.1.3.1" xref="S1.E3a.m2.5.5.2.3.cmml">(</mo><mi mathsize="90%" id="S1.E3a.m2.5.5.2.1.1.1" xref="S1.E3a.m2.5.5.2.1.1.1.cmml">L</mi><mo maxsize="90%" minsize="90%" id="S1.E3a.m2.5.5.2.1.1.3.2" xref="S1.E3a.m2.5.5.2.3.cmml">)</mo></mrow></msubsup></mrow></mfrac></mstyle></mrow></mrow></mrow></mrow></mrow><mo mathsize="90%" stretchy="false" id="S1.E3a.m2.6.6.1.2" xref="S1.E3a.m2.6.6.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S1.E3a.m2.6b"><apply id="S1.E3a.m2.6.6.1.1.cmml" xref="S1.E3a.m2.6.6.1"><eq id="S1.E3a.m2.6.6.1.1.1.cmml" xref="S1.E3a.m2.6.6.1.1.1"></eq><csymbol cd="latexml" id="S1.E3a.m2.6.6.1.1.2.cmml" xref="S1.E3a.m2.6.6.1.1.2">absent</csymbol><apply id="S1.E3a.m2.6.6.1.1.3.cmml" xref="S1.E3a.m2.6.6.1.1.3"><apply id="S1.E3a.m2.6.6.1.1.3.1.cmml" xref="S1.E3a.m2.6.6.1.1.3.1"><csymbol cd="ambiguous" id="S1.E3a.m2.6.6.1.1.3.1.1.cmml" xref="S1.E3a.m2.6.6.1.1.3.1">superscript</csymbol><apply id="S1.E3a.m2.6.6.1.1.3.1.2.cmml" xref="S1.E3a.m2.6.6.1.1.3.1"><csymbol cd="ambiguous" id="S1.E3a.m2.6.6.1.1.3.1.2.1.cmml" xref="S1.E3a.m2.6.6.1.1.3.1">subscript</csymbol><sum id="S1.E3a.m2.6.6.1.1.3.1.2.2.cmml" xref="S1.E3a.m2.6.6.1.1.3.1.2.2"></sum><apply id="S1.E3a.m2.6.6.1.1.3.1.2.3.cmml" xref="S1.E3a.m2.6.6.1.1.3.1.2.3"><eq id="S1.E3a.m2.6.6.1.1.3.1.2.3.1.cmml" xref="S1.E3a.m2.6.6.1.1.3.1.2.3.1"></eq><ci id="S1.E3a.m2.6.6.1.1.3.1.2.3.2.cmml" xref="S1.E3a.m2.6.6.1.1.3.1.2.3.2">𝑠</ci><cn type="integer" id="S1.E3a.m2.6.6.1.1.3.1.2.3.3.cmml" xref="S1.E3a.m2.6.6.1.1.3.1.2.3.3">1</cn></apply></apply><apply id="S1.E3a.m2.6.6.1.1.3.1.3.cmml" xref="S1.E3a.m2.6.6.1.1.3.1.3"><csymbol cd="ambiguous" id="S1.E3a.m2.6.6.1.1.3.1.3.1.cmml" xref="S1.E3a.m2.6.6.1.1.3.1.3">subscript</csymbol><ci id="S1.E3a.m2.6.6.1.1.3.1.3.2.cmml" xref="S1.E3a.m2.6.6.1.1.3.1.3.2">𝑆</ci><ci id="S1.E3a.m2.6.6.1.1.3.1.3.3.cmml" xref="S1.E3a.m2.6.6.1.1.3.1.3.3">𝑚</ci></apply></apply><apply id="S1.E3a.m2.6.6.1.1.3.2.cmml" xref="S1.E3a.m2.6.6.1.1.3.2"><times id="S1.E3a.m2.6.6.1.1.3.2.1.cmml" xref="S1.E3a.m2.6.6.1.1.3.2.1"></times><apply id="S1.E3a.m2.6.6.1.1.3.2.2.cmml" xref="S1.E3a.m2.6.6.1.1.3.2.2"><csymbol cd="ambiguous" id="S1.E3a.m2.6.6.1.1.3.2.2.1.cmml" xref="S1.E3a.m2.6.6.1.1.3.2.2">superscript</csymbol><apply id="S1.E3a.m2.1.1.cmml" xref="S1.E3a.m2.6.6.1.1.3.2.2.2.2"><divide id="S1.E3a.m2.1.1.2.cmml" xref="S1.E3a.m2.6.6.1.1.3.2.2.2.2"></divide><apply id="S1.E3a.m2.1.1.3.cmml" xref="S1.E3a.m2.1.1.3"><partialdiff id="S1.E3a.m2.1.1.3.1.cmml" xref="S1.E3a.m2.1.1.3.1"></partialdiff><ci id="S1.E3a.m2.1.1.3.2.cmml" xref="S1.E3a.m2.1.1.3.2">ℒ</ci></apply><apply id="S1.E3a.m2.1.1.1.cmml" xref="S1.E3a.m2.1.1.1"><partialdiff id="S1.E3a.m2.1.1.1.2.cmml" xref="S1.E3a.m2.1.1.1.2"></partialdiff><apply id="S1.E3a.m2.1.1.1.3.cmml" xref="S1.E3a.m2.1.1.1.3"><csymbol cd="ambiguous" id="S1.E3a.m2.1.1.1.3.1.cmml" xref="S1.E3a.m2.1.1.1.3">subscript</csymbol><apply id="S1.E3a.m2.1.1.1.3.2.cmml" xref="S1.E3a.m2.1.1.1.3"><csymbol cd="ambiguous" id="S1.E3a.m2.1.1.1.3.2.1.cmml" xref="S1.E3a.m2.1.1.1.3">superscript</csymbol><ci id="S1.E3a.m2.1.1.1.3.2.2.cmml" xref="S1.E3a.m2.1.1.1.3.2.2">𝒚</ci><ci id="S1.E3a.m2.1.1.1.1.1.1.cmml" xref="S1.E3a.m2.1.1.1.1.1.1">𝐿</ci></apply><ci id="S1.E3a.m2.1.1.1.3.3.cmml" xref="S1.E3a.m2.1.1.1.3.3">𝑠</ci></apply></apply></apply><csymbol cd="latexml" id="S1.E3a.m2.6.6.1.1.3.2.2.3.cmml" xref="S1.E3a.m2.6.6.1.1.3.2.2.3">top</csymbol></apply><apply id="S1.E3a.m2.6.6.1.1.3.2.3.cmml" xref="S1.E3a.m2.6.6.1.1.3.2.3"><apply id="S1.E3a.m2.6.6.1.1.3.2.3.1.cmml" xref="S1.E3a.m2.6.6.1.1.3.2.3.1"><csymbol cd="ambiguous" id="S1.E3a.m2.6.6.1.1.3.2.3.1.1.cmml" xref="S1.E3a.m2.6.6.1.1.3.2.3.1">superscript</csymbol><apply id="S1.E3a.m2.6.6.1.1.3.2.3.1.2.cmml" xref="S1.E3a.m2.6.6.1.1.3.2.3.1"><csymbol cd="ambiguous" id="S1.E3a.m2.6.6.1.1.3.2.3.1.2.1.cmml" xref="S1.E3a.m2.6.6.1.1.3.2.3.1">subscript</csymbol><sum id="S1.E3a.m2.6.6.1.1.3.2.3.1.2.2.cmml" xref="S1.E3a.m2.6.6.1.1.3.2.3.1.2.2"></sum><apply id="S1.E3a.m2.6.6.1.1.3.2.3.1.2.3.cmml" xref="S1.E3a.m2.6.6.1.1.3.2.3.1.2.3"><eq id="S1.E3a.m2.6.6.1.1.3.2.3.1.2.3.1.cmml" xref="S1.E3a.m2.6.6.1.1.3.2.3.1.2.3.1"></eq><ci id="S1.E3a.m2.6.6.1.1.3.2.3.1.2.3.2.cmml" xref="S1.E3a.m2.6.6.1.1.3.2.3.1.2.3.2">𝑗</ci><cn type="integer" id="S1.E3a.m2.6.6.1.1.3.2.3.1.2.3.3.cmml" xref="S1.E3a.m2.6.6.1.1.3.2.3.1.2.3.3">1</cn></apply></apply><apply id="S1.E3a.m2.6.6.1.1.3.2.3.1.3.cmml" xref="S1.E3a.m2.6.6.1.1.3.2.3.1.3"><csymbol cd="ambiguous" id="S1.E3a.m2.6.6.1.1.3.2.3.1.3.1.cmml" xref="S1.E3a.m2.6.6.1.1.3.2.3.1.3">subscript</csymbol><ci id="S1.E3a.m2.6.6.1.1.3.2.3.1.3.2.cmml" xref="S1.E3a.m2.6.6.1.1.3.2.3.1.3.2">𝑆</ci><ci id="S1.E3a.m2.6.6.1.1.3.2.3.1.3.3.cmml" xref="S1.E3a.m2.6.6.1.1.3.2.3.1.3.3">𝑚</ci></apply></apply><apply id="S1.E3a.m2.6.6.1.1.3.2.3.2.cmml" xref="S1.E3a.m2.6.6.1.1.3.2.3.2"><ci id="S1.E3a.m2.6.6.1.1.3.2.3.2.1.cmml" xref="S1.E3a.m2.6.6.1.1.3.2.3.2.1">⋅</ci><apply id="S1.E3a.m2.3.3.cmml" xref="S1.E3a.m2.3.3"><divide id="S1.E3a.m2.3.3.3.cmml" xref="S1.E3a.m2.3.3"></divide><apply id="S1.E3a.m2.2.2.1.cmml" xref="S1.E3a.m2.2.2.1"><partialdiff id="S1.E3a.m2.2.2.1.2.cmml" xref="S1.E3a.m2.2.2.1.2"></partialdiff><apply id="S1.E3a.m2.2.2.1.3.cmml" xref="S1.E3a.m2.2.2.1.3"><csymbol cd="ambiguous" id="S1.E3a.m2.2.2.1.3.1.cmml" xref="S1.E3a.m2.2.2.1.3">subscript</csymbol><apply id="S1.E3a.m2.2.2.1.3.2.cmml" xref="S1.E3a.m2.2.2.1.3"><csymbol cd="ambiguous" id="S1.E3a.m2.2.2.1.3.2.1.cmml" xref="S1.E3a.m2.2.2.1.3">superscript</csymbol><ci id="S1.E3a.m2.2.2.1.3.2.2.cmml" xref="S1.E3a.m2.2.2.1.3.2.2">𝒚</ci><ci id="S1.E3a.m2.2.2.1.1.1.1.cmml" xref="S1.E3a.m2.2.2.1.1.1.1">𝐿</ci></apply><ci id="S1.E3a.m2.2.2.1.3.3.cmml" xref="S1.E3a.m2.2.2.1.3.3">𝑠</ci></apply></apply><apply id="S1.E3a.m2.3.3.2.cmml" xref="S1.E3a.m2.3.3.2"><partialdiff id="S1.E3a.m2.3.3.2.2.cmml" xref="S1.E3a.m2.3.3.2.2"></partialdiff><apply id="S1.E3a.m2.3.3.2.3.cmml" xref="S1.E3a.m2.3.3.2.3"><csymbol cd="ambiguous" id="S1.E3a.m2.3.3.2.3.1.cmml" xref="S1.E3a.m2.3.3.2.3">superscript</csymbol><apply id="S1.E3a.m2.3.3.2.3.2.cmml" xref="S1.E3a.m2.3.3.2.3"><csymbol cd="ambiguous" id="S1.E3a.m2.3.3.2.3.2.1.cmml" xref="S1.E3a.m2.3.3.2.3">subscript</csymbol><ci id="S1.E3a.m2.3.3.2.3.2.2.cmml" xref="S1.E3a.m2.3.3.2.3.2.2">𝒐</ci><ci id="S1.E3a.m2.3.3.2.3.2.3.cmml" xref="S1.E3a.m2.3.3.2.3.2.3">𝑗</ci></apply><ci id="S1.E3a.m2.3.3.2.1.1.1.cmml" xref="S1.E3a.m2.3.3.2.1.1.1">𝐿</ci></apply></apply></apply><apply id="S1.E3a.m2.5.5.cmml" xref="S1.E3a.m2.5.5"><divide id="S1.E3a.m2.5.5.3.cmml" xref="S1.E3a.m2.5.5"></divide><apply id="S1.E3a.m2.4.4.1.cmml" xref="S1.E3a.m2.4.4.1"><partialdiff id="S1.E3a.m2.4.4.1.2.cmml" xref="S1.E3a.m2.4.4.1.2"></partialdiff><apply id="S1.E3a.m2.4.4.1.3.cmml" xref="S1.E3a.m2.4.4.1.3"><csymbol cd="ambiguous" id="S1.E3a.m2.4.4.1.3.1.cmml" xref="S1.E3a.m2.4.4.1.3">superscript</csymbol><apply id="S1.E3a.m2.4.4.1.3.2.cmml" xref="S1.E3a.m2.4.4.1.3"><csymbol cd="ambiguous" id="S1.E3a.m2.4.4.1.3.2.1.cmml" xref="S1.E3a.m2.4.4.1.3">subscript</csymbol><ci id="S1.E3a.m2.4.4.1.3.2.2.cmml" xref="S1.E3a.m2.4.4.1.3.2.2">𝒐</ci><ci id="S1.E3a.m2.4.4.1.3.2.3.cmml" xref="S1.E3a.m2.4.4.1.3.2.3">𝑗</ci></apply><ci id="S1.E3a.m2.4.4.1.1.1.1.cmml" xref="S1.E3a.m2.4.4.1.1.1.1">𝐿</ci></apply></apply><apply id="S1.E3a.m2.5.5.2.cmml" xref="S1.E3a.m2.5.5.2"><partialdiff id="S1.E3a.m2.5.5.2.2.cmml" xref="S1.E3a.m2.5.5.2.2"></partialdiff><apply id="S1.E3a.m2.5.5.2.3.cmml" xref="S1.E3a.m2.5.5.2.3"><csymbol cd="ambiguous" id="S1.E3a.m2.5.5.2.3.1.cmml" xref="S1.E3a.m2.5.5.2.3">subscript</csymbol><apply id="S1.E3a.m2.5.5.2.3.2.cmml" xref="S1.E3a.m2.5.5.2.3"><csymbol cd="ambiguous" id="S1.E3a.m2.5.5.2.3.2.1.cmml" xref="S1.E3a.m2.5.5.2.3">superscript</csymbol><ci id="S1.E3a.m2.5.5.2.3.2.2.cmml" xref="S1.E3a.m2.5.5.2.3.2.2">𝜽</ci><ci id="S1.E3a.m2.5.5.2.1.1.1.cmml" xref="S1.E3a.m2.5.5.2.1.1.1">𝐿</ci></apply><ci id="S1.E3a.m2.5.5.2.3.3.cmml" xref="S1.E3a.m2.5.5.2.3.3">𝑣</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.E3a.m2.6c">\displaystyle=\sum_{s=1}^{S_{m}}\left(\frac{\partial\mathcal{L}}{\partial\bm{y%
}^{(L)}_{s}}\right)^{\top}\sum_{j=1}^{S_{m}}\frac{\partial\bm{y}^{(L)}_{s}}{%
\partial\bm{o}_{j}^{(L)}}\cdot\frac{\partial\bm{o}_{j}^{(L)}}{\partial\bm{%
\theta}^{(L)}_{v}},</annotation><annotation encoding="application/x-llamapun" id="S1.E3a.m2.6d">= ∑ start_POSTSUBSCRIPT italic_s = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_S start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT end_POSTSUPERSCRIPT ( divide start_ARG ∂ caligraphic_L end_ARG start_ARG ∂ bold_italic_y start_POSTSUPERSCRIPT ( italic_L ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT end_ARG ) start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_S start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT end_POSTSUPERSCRIPT divide start_ARG ∂ bold_italic_y start_POSTSUPERSCRIPT ( italic_L ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT end_ARG start_ARG ∂ bold_italic_o start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_L ) end_POSTSUPERSCRIPT end_ARG ⋅ divide start_ARG ∂ bold_italic_o start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_L ) end_POSTSUPERSCRIPT end_ARG start_ARG ∂ bold_italic_θ start_POSTSUPERSCRIPT ( italic_L ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(S3)</span></td>
</tr></tbody>
<tbody id="S1.E4a"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S1.E4a.m1.1" class="ltx_Math" alttext="\displaystyle\frac{\partial\mathcal{L}}{\partial\bm{\theta}^{(L)}_{q}}" display="inline"><semantics id="S1.E4a.m1.1a"><mstyle displaystyle="true" id="S1.E4a.m1.1.1" xref="S1.E4a.m1.1.1.cmml"><mfrac id="S1.E4a.m1.1.1a" xref="S1.E4a.m1.1.1.cmml"><mrow id="S1.E4a.m1.1.1.3" xref="S1.E4a.m1.1.1.3.cmml"><mo mathsize="90%" stretchy="false" id="S1.E4a.m1.1.1.3.1" xref="S1.E4a.m1.1.1.3.1.cmml">∂</mo><mo id="S1.E4a.m1.1.1.3a" xref="S1.E4a.m1.1.1.3.cmml">⁡</mo><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S1.E4a.m1.1.1.3.2" xref="S1.E4a.m1.1.1.3.2.cmml">ℒ</mi></mrow><mrow id="S1.E4a.m1.1.1.1" xref="S1.E4a.m1.1.1.1.cmml"><mo mathsize="90%" stretchy="false" id="S1.E4a.m1.1.1.1.2" xref="S1.E4a.m1.1.1.1.2.cmml">∂</mo><mo id="S1.E4a.m1.1.1.1a" xref="S1.E4a.m1.1.1.1.cmml">⁡</mo><msubsup id="S1.E4a.m1.1.1.1.3" xref="S1.E4a.m1.1.1.1.3.cmml"><mi mathsize="90%" id="S1.E4a.m1.1.1.1.3.2.2" xref="S1.E4a.m1.1.1.1.3.2.2.cmml">𝜽</mi><mi mathsize="90%" id="S1.E4a.m1.1.1.1.3.3" xref="S1.E4a.m1.1.1.1.3.3.cmml">q</mi><mrow id="S1.E4a.m1.1.1.1.1.1.3" xref="S1.E4a.m1.1.1.1.3.cmml"><mo maxsize="90%" minsize="90%" id="S1.E4a.m1.1.1.1.1.1.3.1" xref="S1.E4a.m1.1.1.1.3.cmml">(</mo><mi mathsize="90%" id="S1.E4a.m1.1.1.1.1.1.1" xref="S1.E4a.m1.1.1.1.1.1.1.cmml">L</mi><mo maxsize="90%" minsize="90%" id="S1.E4a.m1.1.1.1.1.1.3.2" xref="S1.E4a.m1.1.1.1.3.cmml">)</mo></mrow></msubsup></mrow></mfrac></mstyle><annotation-xml encoding="MathML-Content" id="S1.E4a.m1.1b"><apply id="S1.E4a.m1.1.1.cmml" xref="S1.E4a.m1.1.1"><divide id="S1.E4a.m1.1.1.2.cmml" xref="S1.E4a.m1.1.1"></divide><apply id="S1.E4a.m1.1.1.3.cmml" xref="S1.E4a.m1.1.1.3"><partialdiff id="S1.E4a.m1.1.1.3.1.cmml" xref="S1.E4a.m1.1.1.3.1"></partialdiff><ci id="S1.E4a.m1.1.1.3.2.cmml" xref="S1.E4a.m1.1.1.3.2">ℒ</ci></apply><apply id="S1.E4a.m1.1.1.1.cmml" xref="S1.E4a.m1.1.1.1"><partialdiff id="S1.E4a.m1.1.1.1.2.cmml" xref="S1.E4a.m1.1.1.1.2"></partialdiff><apply id="S1.E4a.m1.1.1.1.3.cmml" xref="S1.E4a.m1.1.1.1.3"><csymbol cd="ambiguous" id="S1.E4a.m1.1.1.1.3.1.cmml" xref="S1.E4a.m1.1.1.1.3">subscript</csymbol><apply id="S1.E4a.m1.1.1.1.3.2.cmml" xref="S1.E4a.m1.1.1.1.3"><csymbol cd="ambiguous" id="S1.E4a.m1.1.1.1.3.2.1.cmml" xref="S1.E4a.m1.1.1.1.3">superscript</csymbol><ci id="S1.E4a.m1.1.1.1.3.2.2.cmml" xref="S1.E4a.m1.1.1.1.3.2.2">𝜽</ci><ci id="S1.E4a.m1.1.1.1.1.1.1.cmml" xref="S1.E4a.m1.1.1.1.1.1.1">𝐿</ci></apply><ci id="S1.E4a.m1.1.1.1.3.3.cmml" xref="S1.E4a.m1.1.1.1.3.3">𝑞</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.E4a.m1.1c">\displaystyle\frac{\partial\mathcal{L}}{\partial\bm{\theta}^{(L)}_{q}}</annotation><annotation encoding="application/x-llamapun" id="S1.E4a.m1.1d">divide start_ARG ∂ caligraphic_L end_ARG start_ARG ∂ bold_italic_θ start_POSTSUPERSCRIPT ( italic_L ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT end_ARG</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S1.E4a.m2.12" class="ltx_Math" alttext="\displaystyle=\sum_{s=1}^{S_{m}}\left(\frac{\partial\mathcal{L}}{\partial\bm{y%
}^{(L)}_{s}}\right)^{\top}\sum_{j=1}^{S_{m}}\frac{\partial\bm{y}^{(L)}_{s}}{%
\partial\alpha_{s,j}^{(L)}}\cdot\frac{\partial\alpha_{s,j}^{(L)}}{\partial%
\langle Z_{q}\rangle_{s}}\cdot\frac{\partial\langle Z_{q}\rangle_{s}}{\partial%
\bm{\theta}^{(L)}_{q}}," display="inline"><semantics id="S1.E4a.m2.12a"><mrow id="S1.E4a.m2.12.12.1" xref="S1.E4a.m2.12.12.1.1.cmml"><mrow id="S1.E4a.m2.12.12.1.1" xref="S1.E4a.m2.12.12.1.1.cmml"><mi id="S1.E4a.m2.12.12.1.1.2" xref="S1.E4a.m2.12.12.1.1.2.cmml"></mi><mo mathsize="90%" stretchy="false" id="S1.E4a.m2.12.12.1.1.1" xref="S1.E4a.m2.12.12.1.1.1.cmml">=</mo><mrow id="S1.E4a.m2.12.12.1.1.3" xref="S1.E4a.m2.12.12.1.1.3.cmml"><mstyle displaystyle="true" id="S1.E4a.m2.12.12.1.1.3.1" xref="S1.E4a.m2.12.12.1.1.3.1.cmml"><munderover id="S1.E4a.m2.12.12.1.1.3.1a" xref="S1.E4a.m2.12.12.1.1.3.1.cmml"><mo largeop="true" mathsize="90%" movablelimits="false" stretchy="false" symmetric="true" id="S1.E4a.m2.12.12.1.1.3.1.2.2" xref="S1.E4a.m2.12.12.1.1.3.1.2.2.cmml">∑</mo><mrow id="S1.E4a.m2.12.12.1.1.3.1.2.3" xref="S1.E4a.m2.12.12.1.1.3.1.2.3.cmml"><mi mathsize="90%" id="S1.E4a.m2.12.12.1.1.3.1.2.3.2" xref="S1.E4a.m2.12.12.1.1.3.1.2.3.2.cmml">s</mi><mo mathsize="90%" stretchy="false" id="S1.E4a.m2.12.12.1.1.3.1.2.3.1" xref="S1.E4a.m2.12.12.1.1.3.1.2.3.1.cmml">=</mo><mn mathsize="90%" id="S1.E4a.m2.12.12.1.1.3.1.2.3.3" xref="S1.E4a.m2.12.12.1.1.3.1.2.3.3.cmml">1</mn></mrow><msub id="S1.E4a.m2.12.12.1.1.3.1.3" xref="S1.E4a.m2.12.12.1.1.3.1.3.cmml"><mi mathsize="90%" id="S1.E4a.m2.12.12.1.1.3.1.3.2" xref="S1.E4a.m2.12.12.1.1.3.1.3.2.cmml">S</mi><mi mathsize="90%" id="S1.E4a.m2.12.12.1.1.3.1.3.3" xref="S1.E4a.m2.12.12.1.1.3.1.3.3.cmml">m</mi></msub></munderover></mstyle><mrow id="S1.E4a.m2.12.12.1.1.3.2" xref="S1.E4a.m2.12.12.1.1.3.2.cmml"><msup id="S1.E4a.m2.12.12.1.1.3.2.2" xref="S1.E4a.m2.12.12.1.1.3.2.2.cmml"><mrow id="S1.E4a.m2.12.12.1.1.3.2.2.2.2" xref="S1.E4a.m2.1.1.cmml"><mo id="S1.E4a.m2.12.12.1.1.3.2.2.2.2.1" xref="S1.E4a.m2.1.1.cmml">(</mo><mstyle displaystyle="true" id="S1.E4a.m2.1.1" xref="S1.E4a.m2.1.1.cmml"><mfrac id="S1.E4a.m2.1.1a" xref="S1.E4a.m2.1.1.cmml"><mrow id="S1.E4a.m2.1.1.3" xref="S1.E4a.m2.1.1.3.cmml"><mo mathsize="90%" stretchy="false" id="S1.E4a.m2.1.1.3.1" xref="S1.E4a.m2.1.1.3.1.cmml">∂</mo><mo id="S1.E4a.m2.1.1.3a" xref="S1.E4a.m2.1.1.3.cmml">⁡</mo><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S1.E4a.m2.1.1.3.2" xref="S1.E4a.m2.1.1.3.2.cmml">ℒ</mi></mrow><mrow id="S1.E4a.m2.1.1.1" xref="S1.E4a.m2.1.1.1.cmml"><mo mathsize="90%" stretchy="false" id="S1.E4a.m2.1.1.1.2" xref="S1.E4a.m2.1.1.1.2.cmml">∂</mo><mo id="S1.E4a.m2.1.1.1a" xref="S1.E4a.m2.1.1.1.cmml">⁡</mo><msubsup id="S1.E4a.m2.1.1.1.3" xref="S1.E4a.m2.1.1.1.3.cmml"><mi mathsize="90%" id="S1.E4a.m2.1.1.1.3.2.2" xref="S1.E4a.m2.1.1.1.3.2.2.cmml">𝒚</mi><mi mathsize="90%" id="S1.E4a.m2.1.1.1.3.3" xref="S1.E4a.m2.1.1.1.3.3.cmml">s</mi><mrow id="S1.E4a.m2.1.1.1.1.1.3" xref="S1.E4a.m2.1.1.1.3.cmml"><mo maxsize="90%" minsize="90%" id="S1.E4a.m2.1.1.1.1.1.3.1" xref="S1.E4a.m2.1.1.1.3.cmml">(</mo><mi mathsize="90%" id="S1.E4a.m2.1.1.1.1.1.1" xref="S1.E4a.m2.1.1.1.1.1.1.cmml">L</mi><mo maxsize="90%" minsize="90%" id="S1.E4a.m2.1.1.1.1.1.3.2" xref="S1.E4a.m2.1.1.1.3.cmml">)</mo></mrow></msubsup></mrow></mfrac></mstyle><mo id="S1.E4a.m2.12.12.1.1.3.2.2.2.2.2" xref="S1.E4a.m2.1.1.cmml">)</mo></mrow><mo mathsize="90%" stretchy="false" id="S1.E4a.m2.12.12.1.1.3.2.2.3" xref="S1.E4a.m2.12.12.1.1.3.2.2.3.cmml">⊤</mo></msup><mo id="S1.E4a.m2.12.12.1.1.3.2.1" xref="S1.E4a.m2.12.12.1.1.3.2.1.cmml">⁢</mo><mrow id="S1.E4a.m2.12.12.1.1.3.2.3" xref="S1.E4a.m2.12.12.1.1.3.2.3.cmml"><mstyle displaystyle="true" id="S1.E4a.m2.12.12.1.1.3.2.3.1" xref="S1.E4a.m2.12.12.1.1.3.2.3.1.cmml"><munderover id="S1.E4a.m2.12.12.1.1.3.2.3.1a" xref="S1.E4a.m2.12.12.1.1.3.2.3.1.cmml"><mo largeop="true" mathsize="90%" movablelimits="false" stretchy="false" symmetric="true" id="S1.E4a.m2.12.12.1.1.3.2.3.1.2.2" xref="S1.E4a.m2.12.12.1.1.3.2.3.1.2.2.cmml">∑</mo><mrow id="S1.E4a.m2.12.12.1.1.3.2.3.1.2.3" xref="S1.E4a.m2.12.12.1.1.3.2.3.1.2.3.cmml"><mi mathsize="90%" id="S1.E4a.m2.12.12.1.1.3.2.3.1.2.3.2" xref="S1.E4a.m2.12.12.1.1.3.2.3.1.2.3.2.cmml">j</mi><mo mathsize="90%" stretchy="false" id="S1.E4a.m2.12.12.1.1.3.2.3.1.2.3.1" xref="S1.E4a.m2.12.12.1.1.3.2.3.1.2.3.1.cmml">=</mo><mn mathsize="90%" id="S1.E4a.m2.12.12.1.1.3.2.3.1.2.3.3" xref="S1.E4a.m2.12.12.1.1.3.2.3.1.2.3.3.cmml">1</mn></mrow><msub id="S1.E4a.m2.12.12.1.1.3.2.3.1.3" xref="S1.E4a.m2.12.12.1.1.3.2.3.1.3.cmml"><mi mathsize="90%" id="S1.E4a.m2.12.12.1.1.3.2.3.1.3.2" xref="S1.E4a.m2.12.12.1.1.3.2.3.1.3.2.cmml">S</mi><mi mathsize="90%" id="S1.E4a.m2.12.12.1.1.3.2.3.1.3.3" xref="S1.E4a.m2.12.12.1.1.3.2.3.1.3.3.cmml">m</mi></msub></munderover></mstyle><mrow id="S1.E4a.m2.12.12.1.1.3.2.3.2" xref="S1.E4a.m2.12.12.1.1.3.2.3.2.cmml"><mstyle displaystyle="true" id="S1.E4a.m2.5.5" xref="S1.E4a.m2.5.5.cmml"><mfrac id="S1.E4a.m2.5.5a" xref="S1.E4a.m2.5.5.cmml"><mrow id="S1.E4a.m2.2.2.1" xref="S1.E4a.m2.2.2.1.cmml"><mo mathsize="90%" stretchy="false" id="S1.E4a.m2.2.2.1.2" xref="S1.E4a.m2.2.2.1.2.cmml">∂</mo><mo id="S1.E4a.m2.2.2.1a" xref="S1.E4a.m2.2.2.1.cmml">⁡</mo><msubsup id="S1.E4a.m2.2.2.1.3" xref="S1.E4a.m2.2.2.1.3.cmml"><mi mathsize="90%" id="S1.E4a.m2.2.2.1.3.2.2" xref="S1.E4a.m2.2.2.1.3.2.2.cmml">𝒚</mi><mi mathsize="90%" id="S1.E4a.m2.2.2.1.3.3" xref="S1.E4a.m2.2.2.1.3.3.cmml">s</mi><mrow id="S1.E4a.m2.2.2.1.1.1.3" xref="S1.E4a.m2.2.2.1.3.cmml"><mo maxsize="90%" minsize="90%" id="S1.E4a.m2.2.2.1.1.1.3.1" xref="S1.E4a.m2.2.2.1.3.cmml">(</mo><mi mathsize="90%" id="S1.E4a.m2.2.2.1.1.1.1" xref="S1.E4a.m2.2.2.1.1.1.1.cmml">L</mi><mo maxsize="90%" minsize="90%" id="S1.E4a.m2.2.2.1.1.1.3.2" xref="S1.E4a.m2.2.2.1.3.cmml">)</mo></mrow></msubsup></mrow><mrow id="S1.E4a.m2.5.5.4" xref="S1.E4a.m2.5.5.4.cmml"><mo mathsize="90%" stretchy="false" id="S1.E4a.m2.5.5.4.4" xref="S1.E4a.m2.5.5.4.4.cmml">∂</mo><mo id="S1.E4a.m2.5.5.4a" xref="S1.E4a.m2.5.5.4.cmml">⁡</mo><msubsup id="S1.E4a.m2.5.5.4.5" xref="S1.E4a.m2.5.5.4.5.cmml"><mi mathsize="90%" id="S1.E4a.m2.5.5.4.5.2.2" xref="S1.E4a.m2.5.5.4.5.2.2.cmml">α</mi><mrow id="S1.E4a.m2.4.4.3.2.2.4" xref="S1.E4a.m2.4.4.3.2.2.3.cmml"><mi mathsize="90%" id="S1.E4a.m2.3.3.2.1.1.1" xref="S1.E4a.m2.3.3.2.1.1.1.cmml">s</mi><mo mathsize="90%" stretchy="false" id="S1.E4a.m2.4.4.3.2.2.4.1" xref="S1.E4a.m2.4.4.3.2.2.3.cmml">,</mo><mi mathsize="90%" id="S1.E4a.m2.4.4.3.2.2.2" xref="S1.E4a.m2.4.4.3.2.2.2.cmml">j</mi></mrow><mrow id="S1.E4a.m2.5.5.4.3.1.3" xref="S1.E4a.m2.5.5.4.5.cmml"><mo maxsize="90%" minsize="90%" id="S1.E4a.m2.5.5.4.3.1.3.1" xref="S1.E4a.m2.5.5.4.5.cmml">(</mo><mi mathsize="90%" id="S1.E4a.m2.5.5.4.3.1.1" xref="S1.E4a.m2.5.5.4.3.1.1.cmml">L</mi><mo maxsize="90%" minsize="90%" id="S1.E4a.m2.5.5.4.3.1.3.2" xref="S1.E4a.m2.5.5.4.5.cmml">)</mo></mrow></msubsup></mrow></mfrac></mstyle><mo mathsize="90%" stretchy="false" id="S1.E4a.m2.12.12.1.1.3.2.3.2.1" xref="S1.E4a.m2.12.12.1.1.3.2.3.2.1.cmml">⋅</mo><mstyle displaystyle="true" id="S1.E4a.m2.9.9" xref="S1.E4a.m2.9.9.cmml"><mfrac id="S1.E4a.m2.9.9a" xref="S1.E4a.m2.9.9.cmml"><mrow id="S1.E4a.m2.8.8.3" xref="S1.E4a.m2.8.8.3.cmml"><mo mathsize="90%" stretchy="false" id="S1.E4a.m2.8.8.3.4" xref="S1.E4a.m2.8.8.3.4.cmml">∂</mo><mo id="S1.E4a.m2.8.8.3a" xref="S1.E4a.m2.8.8.3.cmml">⁡</mo><msubsup id="S1.E4a.m2.8.8.3.5" xref="S1.E4a.m2.8.8.3.5.cmml"><mi mathsize="90%" id="S1.E4a.m2.8.8.3.5.2.2" xref="S1.E4a.m2.8.8.3.5.2.2.cmml">α</mi><mrow id="S1.E4a.m2.7.7.2.2.2.4" xref="S1.E4a.m2.7.7.2.2.2.3.cmml"><mi mathsize="90%" id="S1.E4a.m2.6.6.1.1.1.1" xref="S1.E4a.m2.6.6.1.1.1.1.cmml">s</mi><mo mathsize="90%" stretchy="false" id="S1.E4a.m2.7.7.2.2.2.4.1" xref="S1.E4a.m2.7.7.2.2.2.3.cmml">,</mo><mi mathsize="90%" id="S1.E4a.m2.7.7.2.2.2.2" xref="S1.E4a.m2.7.7.2.2.2.2.cmml">j</mi></mrow><mrow id="S1.E4a.m2.8.8.3.3.1.3" xref="S1.E4a.m2.8.8.3.5.cmml"><mo maxsize="90%" minsize="90%" id="S1.E4a.m2.8.8.3.3.1.3.1" xref="S1.E4a.m2.8.8.3.5.cmml">(</mo><mi mathsize="90%" id="S1.E4a.m2.8.8.3.3.1.1" xref="S1.E4a.m2.8.8.3.3.1.1.cmml">L</mi><mo maxsize="90%" minsize="90%" id="S1.E4a.m2.8.8.3.3.1.3.2" xref="S1.E4a.m2.8.8.3.5.cmml">)</mo></mrow></msubsup></mrow><mrow id="S1.E4a.m2.9.9.4" xref="S1.E4a.m2.9.9.4.cmml"><mo mathsize="90%" stretchy="false" id="S1.E4a.m2.9.9.4.1" xref="S1.E4a.m2.9.9.4.1.cmml">∂</mo><msub id="S1.E4a.m2.9.9.4.2" xref="S1.E4a.m2.9.9.4.2.cmml"><mrow id="S1.E4a.m2.9.9.4.2.2" xref="S1.E4a.m2.9.9.4.2.2.cmml"><mo maxsize="90%" minsize="90%" id="S1.E4a.m2.9.9.4.2.2.1" xref="S1.E4a.m2.9.9.4.2.2.1.cmml">⟨</mo><msub id="S1.E4a.m2.9.9.4.2.2.2" xref="S1.E4a.m2.9.9.4.2.2.2.cmml"><mi mathsize="90%" id="S1.E4a.m2.9.9.4.2.2.2.2" xref="S1.E4a.m2.9.9.4.2.2.2.2.cmml">Z</mi><mi mathsize="90%" id="S1.E4a.m2.9.9.4.2.2.2.3" xref="S1.E4a.m2.9.9.4.2.2.2.3.cmml">q</mi></msub><mo maxsize="90%" minsize="90%" id="S1.E4a.m2.9.9.4.2.2.3" xref="S1.E4a.m2.9.9.4.2.2.3.cmml">⟩</mo></mrow><mi mathsize="90%" id="S1.E4a.m2.9.9.4.2.3" xref="S1.E4a.m2.9.9.4.2.3.cmml">s</mi></msub></mrow></mfrac></mstyle><mo mathsize="90%" stretchy="false" id="S1.E4a.m2.12.12.1.1.3.2.3.2.1a" xref="S1.E4a.m2.12.12.1.1.3.2.3.2.1.cmml">⋅</mo><mstyle displaystyle="true" id="S1.E4a.m2.11.11" xref="S1.E4a.m2.11.11.cmml"><mfrac id="S1.E4a.m2.11.11a" xref="S1.E4a.m2.11.11.cmml"><mrow id="S1.E4a.m2.10.10.1" xref="S1.E4a.m2.10.10.1.cmml"><mo mathsize="90%" stretchy="false" id="S1.E4a.m2.10.10.1.1" xref="S1.E4a.m2.10.10.1.1.cmml">∂</mo><msub id="S1.E4a.m2.10.10.1.2" xref="S1.E4a.m2.10.10.1.2.cmml"><mrow id="S1.E4a.m2.10.10.1.2.2" xref="S1.E4a.m2.10.10.1.2.2.cmml"><mo maxsize="90%" minsize="90%" id="S1.E4a.m2.10.10.1.2.2.1" xref="S1.E4a.m2.10.10.1.2.2.1.cmml">⟨</mo><msub id="S1.E4a.m2.10.10.1.2.2.2" xref="S1.E4a.m2.10.10.1.2.2.2.cmml"><mi mathsize="90%" id="S1.E4a.m2.10.10.1.2.2.2.2" xref="S1.E4a.m2.10.10.1.2.2.2.2.cmml">Z</mi><mi mathsize="90%" id="S1.E4a.m2.10.10.1.2.2.2.3" xref="S1.E4a.m2.10.10.1.2.2.2.3.cmml">q</mi></msub><mo maxsize="90%" minsize="90%" id="S1.E4a.m2.10.10.1.2.2.3" xref="S1.E4a.m2.10.10.1.2.2.3.cmml">⟩</mo></mrow><mi mathsize="90%" id="S1.E4a.m2.10.10.1.2.3" xref="S1.E4a.m2.10.10.1.2.3.cmml">s</mi></msub></mrow><mrow id="S1.E4a.m2.11.11.2" xref="S1.E4a.m2.11.11.2.cmml"><mo mathsize="90%" stretchy="false" id="S1.E4a.m2.11.11.2.2" xref="S1.E4a.m2.11.11.2.2.cmml">∂</mo><mo id="S1.E4a.m2.11.11.2a" xref="S1.E4a.m2.11.11.2.cmml">⁡</mo><msubsup id="S1.E4a.m2.11.11.2.3" xref="S1.E4a.m2.11.11.2.3.cmml"><mi mathsize="90%" id="S1.E4a.m2.11.11.2.3.2.2" xref="S1.E4a.m2.11.11.2.3.2.2.cmml">𝜽</mi><mi mathsize="90%" id="S1.E4a.m2.11.11.2.3.3" xref="S1.E4a.m2.11.11.2.3.3.cmml">q</mi><mrow id="S1.E4a.m2.11.11.2.1.1.3" xref="S1.E4a.m2.11.11.2.3.cmml"><mo maxsize="90%" minsize="90%" id="S1.E4a.m2.11.11.2.1.1.3.1" xref="S1.E4a.m2.11.11.2.3.cmml">(</mo><mi mathsize="90%" id="S1.E4a.m2.11.11.2.1.1.1" xref="S1.E4a.m2.11.11.2.1.1.1.cmml">L</mi><mo maxsize="90%" minsize="90%" id="S1.E4a.m2.11.11.2.1.1.3.2" xref="S1.E4a.m2.11.11.2.3.cmml">)</mo></mrow></msubsup></mrow></mfrac></mstyle></mrow></mrow></mrow></mrow></mrow><mo mathsize="90%" stretchy="false" id="S1.E4a.m2.12.12.1.2" xref="S1.E4a.m2.12.12.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S1.E4a.m2.12b"><apply id="S1.E4a.m2.12.12.1.1.cmml" xref="S1.E4a.m2.12.12.1"><eq id="S1.E4a.m2.12.12.1.1.1.cmml" xref="S1.E4a.m2.12.12.1.1.1"></eq><csymbol cd="latexml" id="S1.E4a.m2.12.12.1.1.2.cmml" xref="S1.E4a.m2.12.12.1.1.2">absent</csymbol><apply id="S1.E4a.m2.12.12.1.1.3.cmml" xref="S1.E4a.m2.12.12.1.1.3"><apply id="S1.E4a.m2.12.12.1.1.3.1.cmml" xref="S1.E4a.m2.12.12.1.1.3.1"><csymbol cd="ambiguous" id="S1.E4a.m2.12.12.1.1.3.1.1.cmml" xref="S1.E4a.m2.12.12.1.1.3.1">superscript</csymbol><apply id="S1.E4a.m2.12.12.1.1.3.1.2.cmml" xref="S1.E4a.m2.12.12.1.1.3.1"><csymbol cd="ambiguous" id="S1.E4a.m2.12.12.1.1.3.1.2.1.cmml" xref="S1.E4a.m2.12.12.1.1.3.1">subscript</csymbol><sum id="S1.E4a.m2.12.12.1.1.3.1.2.2.cmml" xref="S1.E4a.m2.12.12.1.1.3.1.2.2"></sum><apply id="S1.E4a.m2.12.12.1.1.3.1.2.3.cmml" xref="S1.E4a.m2.12.12.1.1.3.1.2.3"><eq id="S1.E4a.m2.12.12.1.1.3.1.2.3.1.cmml" xref="S1.E4a.m2.12.12.1.1.3.1.2.3.1"></eq><ci id="S1.E4a.m2.12.12.1.1.3.1.2.3.2.cmml" xref="S1.E4a.m2.12.12.1.1.3.1.2.3.2">𝑠</ci><cn type="integer" id="S1.E4a.m2.12.12.1.1.3.1.2.3.3.cmml" xref="S1.E4a.m2.12.12.1.1.3.1.2.3.3">1</cn></apply></apply><apply id="S1.E4a.m2.12.12.1.1.3.1.3.cmml" xref="S1.E4a.m2.12.12.1.1.3.1.3"><csymbol cd="ambiguous" id="S1.E4a.m2.12.12.1.1.3.1.3.1.cmml" xref="S1.E4a.m2.12.12.1.1.3.1.3">subscript</csymbol><ci id="S1.E4a.m2.12.12.1.1.3.1.3.2.cmml" xref="S1.E4a.m2.12.12.1.1.3.1.3.2">𝑆</ci><ci id="S1.E4a.m2.12.12.1.1.3.1.3.3.cmml" xref="S1.E4a.m2.12.12.1.1.3.1.3.3">𝑚</ci></apply></apply><apply id="S1.E4a.m2.12.12.1.1.3.2.cmml" xref="S1.E4a.m2.12.12.1.1.3.2"><times id="S1.E4a.m2.12.12.1.1.3.2.1.cmml" xref="S1.E4a.m2.12.12.1.1.3.2.1"></times><apply id="S1.E4a.m2.12.12.1.1.3.2.2.cmml" xref="S1.E4a.m2.12.12.1.1.3.2.2"><csymbol cd="ambiguous" id="S1.E4a.m2.12.12.1.1.3.2.2.1.cmml" xref="S1.E4a.m2.12.12.1.1.3.2.2">superscript</csymbol><apply id="S1.E4a.m2.1.1.cmml" xref="S1.E4a.m2.12.12.1.1.3.2.2.2.2"><divide id="S1.E4a.m2.1.1.2.cmml" xref="S1.E4a.m2.12.12.1.1.3.2.2.2.2"></divide><apply id="S1.E4a.m2.1.1.3.cmml" xref="S1.E4a.m2.1.1.3"><partialdiff id="S1.E4a.m2.1.1.3.1.cmml" xref="S1.E4a.m2.1.1.3.1"></partialdiff><ci id="S1.E4a.m2.1.1.3.2.cmml" xref="S1.E4a.m2.1.1.3.2">ℒ</ci></apply><apply id="S1.E4a.m2.1.1.1.cmml" xref="S1.E4a.m2.1.1.1"><partialdiff id="S1.E4a.m2.1.1.1.2.cmml" xref="S1.E4a.m2.1.1.1.2"></partialdiff><apply id="S1.E4a.m2.1.1.1.3.cmml" xref="S1.E4a.m2.1.1.1.3"><csymbol cd="ambiguous" id="S1.E4a.m2.1.1.1.3.1.cmml" xref="S1.E4a.m2.1.1.1.3">subscript</csymbol><apply id="S1.E4a.m2.1.1.1.3.2.cmml" xref="S1.E4a.m2.1.1.1.3"><csymbol cd="ambiguous" id="S1.E4a.m2.1.1.1.3.2.1.cmml" xref="S1.E4a.m2.1.1.1.3">superscript</csymbol><ci id="S1.E4a.m2.1.1.1.3.2.2.cmml" xref="S1.E4a.m2.1.1.1.3.2.2">𝒚</ci><ci id="S1.E4a.m2.1.1.1.1.1.1.cmml" xref="S1.E4a.m2.1.1.1.1.1.1">𝐿</ci></apply><ci id="S1.E4a.m2.1.1.1.3.3.cmml" xref="S1.E4a.m2.1.1.1.3.3">𝑠</ci></apply></apply></apply><csymbol cd="latexml" id="S1.E4a.m2.12.12.1.1.3.2.2.3.cmml" xref="S1.E4a.m2.12.12.1.1.3.2.2.3">top</csymbol></apply><apply id="S1.E4a.m2.12.12.1.1.3.2.3.cmml" xref="S1.E4a.m2.12.12.1.1.3.2.3"><apply id="S1.E4a.m2.12.12.1.1.3.2.3.1.cmml" xref="S1.E4a.m2.12.12.1.1.3.2.3.1"><csymbol cd="ambiguous" id="S1.E4a.m2.12.12.1.1.3.2.3.1.1.cmml" xref="S1.E4a.m2.12.12.1.1.3.2.3.1">superscript</csymbol><apply id="S1.E4a.m2.12.12.1.1.3.2.3.1.2.cmml" xref="S1.E4a.m2.12.12.1.1.3.2.3.1"><csymbol cd="ambiguous" id="S1.E4a.m2.12.12.1.1.3.2.3.1.2.1.cmml" xref="S1.E4a.m2.12.12.1.1.3.2.3.1">subscript</csymbol><sum id="S1.E4a.m2.12.12.1.1.3.2.3.1.2.2.cmml" xref="S1.E4a.m2.12.12.1.1.3.2.3.1.2.2"></sum><apply id="S1.E4a.m2.12.12.1.1.3.2.3.1.2.3.cmml" xref="S1.E4a.m2.12.12.1.1.3.2.3.1.2.3"><eq id="S1.E4a.m2.12.12.1.1.3.2.3.1.2.3.1.cmml" xref="S1.E4a.m2.12.12.1.1.3.2.3.1.2.3.1"></eq><ci id="S1.E4a.m2.12.12.1.1.3.2.3.1.2.3.2.cmml" xref="S1.E4a.m2.12.12.1.1.3.2.3.1.2.3.2">𝑗</ci><cn type="integer" id="S1.E4a.m2.12.12.1.1.3.2.3.1.2.3.3.cmml" xref="S1.E4a.m2.12.12.1.1.3.2.3.1.2.3.3">1</cn></apply></apply><apply id="S1.E4a.m2.12.12.1.1.3.2.3.1.3.cmml" xref="S1.E4a.m2.12.12.1.1.3.2.3.1.3"><csymbol cd="ambiguous" id="S1.E4a.m2.12.12.1.1.3.2.3.1.3.1.cmml" xref="S1.E4a.m2.12.12.1.1.3.2.3.1.3">subscript</csymbol><ci id="S1.E4a.m2.12.12.1.1.3.2.3.1.3.2.cmml" xref="S1.E4a.m2.12.12.1.1.3.2.3.1.3.2">𝑆</ci><ci id="S1.E4a.m2.12.12.1.1.3.2.3.1.3.3.cmml" xref="S1.E4a.m2.12.12.1.1.3.2.3.1.3.3">𝑚</ci></apply></apply><apply id="S1.E4a.m2.12.12.1.1.3.2.3.2.cmml" xref="S1.E4a.m2.12.12.1.1.3.2.3.2"><ci id="S1.E4a.m2.12.12.1.1.3.2.3.2.1.cmml" xref="S1.E4a.m2.12.12.1.1.3.2.3.2.1">⋅</ci><apply id="S1.E4a.m2.5.5.cmml" xref="S1.E4a.m2.5.5"><divide id="S1.E4a.m2.5.5.5.cmml" xref="S1.E4a.m2.5.5"></divide><apply id="S1.E4a.m2.2.2.1.cmml" xref="S1.E4a.m2.2.2.1"><partialdiff id="S1.E4a.m2.2.2.1.2.cmml" xref="S1.E4a.m2.2.2.1.2"></partialdiff><apply id="S1.E4a.m2.2.2.1.3.cmml" xref="S1.E4a.m2.2.2.1.3"><csymbol cd="ambiguous" id="S1.E4a.m2.2.2.1.3.1.cmml" xref="S1.E4a.m2.2.2.1.3">subscript</csymbol><apply id="S1.E4a.m2.2.2.1.3.2.cmml" xref="S1.E4a.m2.2.2.1.3"><csymbol cd="ambiguous" id="S1.E4a.m2.2.2.1.3.2.1.cmml" xref="S1.E4a.m2.2.2.1.3">superscript</csymbol><ci id="S1.E4a.m2.2.2.1.3.2.2.cmml" xref="S1.E4a.m2.2.2.1.3.2.2">𝒚</ci><ci id="S1.E4a.m2.2.2.1.1.1.1.cmml" xref="S1.E4a.m2.2.2.1.1.1.1">𝐿</ci></apply><ci id="S1.E4a.m2.2.2.1.3.3.cmml" xref="S1.E4a.m2.2.2.1.3.3">𝑠</ci></apply></apply><apply id="S1.E4a.m2.5.5.4.cmml" xref="S1.E4a.m2.5.5.4"><partialdiff id="S1.E4a.m2.5.5.4.4.cmml" xref="S1.E4a.m2.5.5.4.4"></partialdiff><apply id="S1.E4a.m2.5.5.4.5.cmml" xref="S1.E4a.m2.5.5.4.5"><csymbol cd="ambiguous" id="S1.E4a.m2.5.5.4.5.1.cmml" xref="S1.E4a.m2.5.5.4.5">superscript</csymbol><apply id="S1.E4a.m2.5.5.4.5.2.cmml" xref="S1.E4a.m2.5.5.4.5"><csymbol cd="ambiguous" id="S1.E4a.m2.5.5.4.5.2.1.cmml" xref="S1.E4a.m2.5.5.4.5">subscript</csymbol><ci id="S1.E4a.m2.5.5.4.5.2.2.cmml" xref="S1.E4a.m2.5.5.4.5.2.2">𝛼</ci><list id="S1.E4a.m2.4.4.3.2.2.3.cmml" xref="S1.E4a.m2.4.4.3.2.2.4"><ci id="S1.E4a.m2.3.3.2.1.1.1.cmml" xref="S1.E4a.m2.3.3.2.1.1.1">𝑠</ci><ci id="S1.E4a.m2.4.4.3.2.2.2.cmml" xref="S1.E4a.m2.4.4.3.2.2.2">𝑗</ci></list></apply><ci id="S1.E4a.m2.5.5.4.3.1.1.cmml" xref="S1.E4a.m2.5.5.4.3.1.1">𝐿</ci></apply></apply></apply><apply id="S1.E4a.m2.9.9.cmml" xref="S1.E4a.m2.9.9"><divide id="S1.E4a.m2.9.9.5.cmml" xref="S1.E4a.m2.9.9"></divide><apply id="S1.E4a.m2.8.8.3.cmml" xref="S1.E4a.m2.8.8.3"><partialdiff id="S1.E4a.m2.8.8.3.4.cmml" xref="S1.E4a.m2.8.8.3.4"></partialdiff><apply id="S1.E4a.m2.8.8.3.5.cmml" xref="S1.E4a.m2.8.8.3.5"><csymbol cd="ambiguous" id="S1.E4a.m2.8.8.3.5.1.cmml" xref="S1.E4a.m2.8.8.3.5">superscript</csymbol><apply id="S1.E4a.m2.8.8.3.5.2.cmml" xref="S1.E4a.m2.8.8.3.5"><csymbol cd="ambiguous" id="S1.E4a.m2.8.8.3.5.2.1.cmml" xref="S1.E4a.m2.8.8.3.5">subscript</csymbol><ci id="S1.E4a.m2.8.8.3.5.2.2.cmml" xref="S1.E4a.m2.8.8.3.5.2.2">𝛼</ci><list id="S1.E4a.m2.7.7.2.2.2.3.cmml" xref="S1.E4a.m2.7.7.2.2.2.4"><ci id="S1.E4a.m2.6.6.1.1.1.1.cmml" xref="S1.E4a.m2.6.6.1.1.1.1">𝑠</ci><ci id="S1.E4a.m2.7.7.2.2.2.2.cmml" xref="S1.E4a.m2.7.7.2.2.2.2">𝑗</ci></list></apply><ci id="S1.E4a.m2.8.8.3.3.1.1.cmml" xref="S1.E4a.m2.8.8.3.3.1.1">𝐿</ci></apply></apply><cerror id="S1.E4a.m2.9.9.4.cmml" xref="S1.E4a.m2.9.9.4"><csymbol cd="ambiguous" id="S1.E4a.m2.9.9.4a.cmml" xref="S1.E4a.m2.9.9.4">fragments</csymbol><partialdiff id="S1.E4a.m2.9.9.4.1.cmml" xref="S1.E4a.m2.9.9.4.1"></partialdiff><apply id="S1.E4a.m2.9.9.4.2.cmml" xref="S1.E4a.m2.9.9.4.2"><csymbol cd="ambiguous" id="S1.E4a.m2.9.9.4.2.1.cmml" xref="S1.E4a.m2.9.9.4.2">subscript</csymbol><cerror id="S1.E4a.m2.9.9.4.2.2.cmml" xref="S1.E4a.m2.9.9.4.2.2"><csymbol cd="ambiguous" id="S1.E4a.m2.9.9.4.2.2a.cmml" xref="S1.E4a.m2.9.9.4.2.2">fragments</csymbol><ci id="S1.E4a.m2.9.9.4.2.2.1.cmml" xref="S1.E4a.m2.9.9.4.2.2.1">⟨</ci><apply id="S1.E4a.m2.9.9.4.2.2.2.cmml" xref="S1.E4a.m2.9.9.4.2.2.2"><csymbol cd="ambiguous" id="S1.E4a.m2.9.9.4.2.2.2.1.cmml" xref="S1.E4a.m2.9.9.4.2.2.2">subscript</csymbol><ci id="S1.E4a.m2.9.9.4.2.2.2.2.cmml" xref="S1.E4a.m2.9.9.4.2.2.2.2">𝑍</ci><ci id="S1.E4a.m2.9.9.4.2.2.2.3.cmml" xref="S1.E4a.m2.9.9.4.2.2.2.3">𝑞</ci></apply><ci id="S1.E4a.m2.9.9.4.2.2.3.cmml" xref="S1.E4a.m2.9.9.4.2.2.3">⟩</ci></cerror><ci id="S1.E4a.m2.9.9.4.2.3.cmml" xref="S1.E4a.m2.9.9.4.2.3">𝑠</ci></apply></cerror></apply><apply id="S1.E4a.m2.11.11.cmml" xref="S1.E4a.m2.11.11"><divide id="S1.E4a.m2.11.11.3.cmml" xref="S1.E4a.m2.11.11"></divide><cerror id="S1.E4a.m2.10.10.1.cmml" xref="S1.E4a.m2.10.10.1"><csymbol cd="ambiguous" id="S1.E4a.m2.10.10.1a.cmml" xref="S1.E4a.m2.10.10.1">fragments</csymbol><partialdiff id="S1.E4a.m2.10.10.1.1.cmml" xref="S1.E4a.m2.10.10.1.1"></partialdiff><apply id="S1.E4a.m2.10.10.1.2.cmml" xref="S1.E4a.m2.10.10.1.2"><csymbol cd="ambiguous" id="S1.E4a.m2.10.10.1.2.1.cmml" xref="S1.E4a.m2.10.10.1.2">subscript</csymbol><cerror id="S1.E4a.m2.10.10.1.2.2.cmml" xref="S1.E4a.m2.10.10.1.2.2"><csymbol cd="ambiguous" id="S1.E4a.m2.10.10.1.2.2a.cmml" xref="S1.E4a.m2.10.10.1.2.2">fragments</csymbol><ci id="S1.E4a.m2.10.10.1.2.2.1.cmml" xref="S1.E4a.m2.10.10.1.2.2.1">⟨</ci><apply id="S1.E4a.m2.10.10.1.2.2.2.cmml" xref="S1.E4a.m2.10.10.1.2.2.2"><csymbol cd="ambiguous" id="S1.E4a.m2.10.10.1.2.2.2.1.cmml" xref="S1.E4a.m2.10.10.1.2.2.2">subscript</csymbol><ci id="S1.E4a.m2.10.10.1.2.2.2.2.cmml" xref="S1.E4a.m2.10.10.1.2.2.2.2">𝑍</ci><ci id="S1.E4a.m2.10.10.1.2.2.2.3.cmml" xref="S1.E4a.m2.10.10.1.2.2.2.3">𝑞</ci></apply><ci id="S1.E4a.m2.10.10.1.2.2.3.cmml" xref="S1.E4a.m2.10.10.1.2.2.3">⟩</ci></cerror><ci id="S1.E4a.m2.10.10.1.2.3.cmml" xref="S1.E4a.m2.10.10.1.2.3">𝑠</ci></apply></cerror><apply id="S1.E4a.m2.11.11.2.cmml" xref="S1.E4a.m2.11.11.2"><partialdiff id="S1.E4a.m2.11.11.2.2.cmml" xref="S1.E4a.m2.11.11.2.2"></partialdiff><apply id="S1.E4a.m2.11.11.2.3.cmml" xref="S1.E4a.m2.11.11.2.3"><csymbol cd="ambiguous" id="S1.E4a.m2.11.11.2.3.1.cmml" xref="S1.E4a.m2.11.11.2.3">subscript</csymbol><apply id="S1.E4a.m2.11.11.2.3.2.cmml" xref="S1.E4a.m2.11.11.2.3"><csymbol cd="ambiguous" id="S1.E4a.m2.11.11.2.3.2.1.cmml" xref="S1.E4a.m2.11.11.2.3">superscript</csymbol><ci id="S1.E4a.m2.11.11.2.3.2.2.cmml" xref="S1.E4a.m2.11.11.2.3.2.2">𝜽</ci><ci id="S1.E4a.m2.11.11.2.1.1.1.cmml" xref="S1.E4a.m2.11.11.2.1.1.1">𝐿</ci></apply><ci id="S1.E4a.m2.11.11.2.3.3.cmml" xref="S1.E4a.m2.11.11.2.3.3">𝑞</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.E4a.m2.12c">\displaystyle=\sum_{s=1}^{S_{m}}\left(\frac{\partial\mathcal{L}}{\partial\bm{y%
}^{(L)}_{s}}\right)^{\top}\sum_{j=1}^{S_{m}}\frac{\partial\bm{y}^{(L)}_{s}}{%
\partial\alpha_{s,j}^{(L)}}\cdot\frac{\partial\alpha_{s,j}^{(L)}}{\partial%
\langle Z_{q}\rangle_{s}}\cdot\frac{\partial\langle Z_{q}\rangle_{s}}{\partial%
\bm{\theta}^{(L)}_{q}},</annotation><annotation encoding="application/x-llamapun" id="S1.E4a.m2.12d">= ∑ start_POSTSUBSCRIPT italic_s = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_S start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT end_POSTSUPERSCRIPT ( divide start_ARG ∂ caligraphic_L end_ARG start_ARG ∂ bold_italic_y start_POSTSUPERSCRIPT ( italic_L ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT end_ARG ) start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_S start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT end_POSTSUPERSCRIPT divide start_ARG ∂ bold_italic_y start_POSTSUPERSCRIPT ( italic_L ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT end_ARG start_ARG ∂ italic_α start_POSTSUBSCRIPT italic_s , italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_L ) end_POSTSUPERSCRIPT end_ARG ⋅ divide start_ARG ∂ italic_α start_POSTSUBSCRIPT italic_s , italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_L ) end_POSTSUPERSCRIPT end_ARG start_ARG ∂ ⟨ italic_Z start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT ⟩ start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT end_ARG ⋅ divide start_ARG ∂ ⟨ italic_Z start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT ⟩ start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT end_ARG start_ARG ∂ bold_italic_θ start_POSTSUPERSCRIPT ( italic_L ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(S4)</span></td>
</tr></tbody>
<tbody id="S1.E5a"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S1.E5a.m1.1" class="ltx_Math" alttext="\displaystyle\frac{\partial\mathcal{L}}{\partial\bm{\theta}^{(L)}_{k}}" display="inline"><semantics id="S1.E5a.m1.1a"><mstyle displaystyle="true" id="S1.E5a.m1.1.1" xref="S1.E5a.m1.1.1.cmml"><mfrac id="S1.E5a.m1.1.1a" xref="S1.E5a.m1.1.1.cmml"><mrow id="S1.E5a.m1.1.1.3" xref="S1.E5a.m1.1.1.3.cmml"><mo mathsize="90%" stretchy="false" id="S1.E5a.m1.1.1.3.1" xref="S1.E5a.m1.1.1.3.1.cmml">∂</mo><mo id="S1.E5a.m1.1.1.3a" xref="S1.E5a.m1.1.1.3.cmml">⁡</mo><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S1.E5a.m1.1.1.3.2" xref="S1.E5a.m1.1.1.3.2.cmml">ℒ</mi></mrow><mrow id="S1.E5a.m1.1.1.1" xref="S1.E5a.m1.1.1.1.cmml"><mo mathsize="90%" stretchy="false" id="S1.E5a.m1.1.1.1.2" xref="S1.E5a.m1.1.1.1.2.cmml">∂</mo><mo id="S1.E5a.m1.1.1.1a" xref="S1.E5a.m1.1.1.1.cmml">⁡</mo><msubsup id="S1.E5a.m1.1.1.1.3" xref="S1.E5a.m1.1.1.1.3.cmml"><mi mathsize="90%" id="S1.E5a.m1.1.1.1.3.2.2" xref="S1.E5a.m1.1.1.1.3.2.2.cmml">𝜽</mi><mi mathsize="90%" id="S1.E5a.m1.1.1.1.3.3" xref="S1.E5a.m1.1.1.1.3.3.cmml">k</mi><mrow id="S1.E5a.m1.1.1.1.1.1.3" xref="S1.E5a.m1.1.1.1.3.cmml"><mo maxsize="90%" minsize="90%" id="S1.E5a.m1.1.1.1.1.1.3.1" xref="S1.E5a.m1.1.1.1.3.cmml">(</mo><mi mathsize="90%" id="S1.E5a.m1.1.1.1.1.1.1" xref="S1.E5a.m1.1.1.1.1.1.1.cmml">L</mi><mo maxsize="90%" minsize="90%" id="S1.E5a.m1.1.1.1.1.1.3.2" xref="S1.E5a.m1.1.1.1.3.cmml">)</mo></mrow></msubsup></mrow></mfrac></mstyle><annotation-xml encoding="MathML-Content" id="S1.E5a.m1.1b"><apply id="S1.E5a.m1.1.1.cmml" xref="S1.E5a.m1.1.1"><divide id="S1.E5a.m1.1.1.2.cmml" xref="S1.E5a.m1.1.1"></divide><apply id="S1.E5a.m1.1.1.3.cmml" xref="S1.E5a.m1.1.1.3"><partialdiff id="S1.E5a.m1.1.1.3.1.cmml" xref="S1.E5a.m1.1.1.3.1"></partialdiff><ci id="S1.E5a.m1.1.1.3.2.cmml" xref="S1.E5a.m1.1.1.3.2">ℒ</ci></apply><apply id="S1.E5a.m1.1.1.1.cmml" xref="S1.E5a.m1.1.1.1"><partialdiff id="S1.E5a.m1.1.1.1.2.cmml" xref="S1.E5a.m1.1.1.1.2"></partialdiff><apply id="S1.E5a.m1.1.1.1.3.cmml" xref="S1.E5a.m1.1.1.1.3"><csymbol cd="ambiguous" id="S1.E5a.m1.1.1.1.3.1.cmml" xref="S1.E5a.m1.1.1.1.3">subscript</csymbol><apply id="S1.E5a.m1.1.1.1.3.2.cmml" xref="S1.E5a.m1.1.1.1.3"><csymbol cd="ambiguous" id="S1.E5a.m1.1.1.1.3.2.1.cmml" xref="S1.E5a.m1.1.1.1.3">superscript</csymbol><ci id="S1.E5a.m1.1.1.1.3.2.2.cmml" xref="S1.E5a.m1.1.1.1.3.2.2">𝜽</ci><ci id="S1.E5a.m1.1.1.1.1.1.1.cmml" xref="S1.E5a.m1.1.1.1.1.1.1">𝐿</ci></apply><ci id="S1.E5a.m1.1.1.1.3.3.cmml" xref="S1.E5a.m1.1.1.1.3.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.E5a.m1.1c">\displaystyle\frac{\partial\mathcal{L}}{\partial\bm{\theta}^{(L)}_{k}}</annotation><annotation encoding="application/x-llamapun" id="S1.E5a.m1.1d">divide start_ARG ∂ caligraphic_L end_ARG start_ARG ∂ bold_italic_θ start_POSTSUPERSCRIPT ( italic_L ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_ARG</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S1.E5a.m2.12" class="ltx_Math" alttext="\displaystyle=\sum_{s=1}^{S_{m}}\left(\frac{\partial\mathcal{L}}{\partial\bm{y%
}^{(L)}_{s}}\right)^{\top}\sum_{j=1}^{S_{m}}\frac{\partial\bm{y}^{(L)}_{s}}{%
\partial\alpha_{s,j}^{(L)}}\cdot\sum_{i=1}^{S_{m}}\frac{\partial\alpha_{s,j}^{%
(L)}}{\partial\langle Z_{k}\rangle_{i}}\cdot\frac{\partial\langle Z_{k}\rangle%
_{i}}{\partial\bm{\theta}^{(L)}_{k}}," display="inline"><semantics id="S1.E5a.m2.12a"><mrow id="S1.E5a.m2.12.12.1" xref="S1.E5a.m2.12.12.1.1.cmml"><mrow id="S1.E5a.m2.12.12.1.1" xref="S1.E5a.m2.12.12.1.1.cmml"><mi id="S1.E5a.m2.12.12.1.1.2" xref="S1.E5a.m2.12.12.1.1.2.cmml"></mi><mo mathsize="90%" stretchy="false" id="S1.E5a.m2.12.12.1.1.1" xref="S1.E5a.m2.12.12.1.1.1.cmml">=</mo><mrow id="S1.E5a.m2.12.12.1.1.3" xref="S1.E5a.m2.12.12.1.1.3.cmml"><mstyle displaystyle="true" id="S1.E5a.m2.12.12.1.1.3.1" xref="S1.E5a.m2.12.12.1.1.3.1.cmml"><munderover id="S1.E5a.m2.12.12.1.1.3.1a" xref="S1.E5a.m2.12.12.1.1.3.1.cmml"><mo largeop="true" mathsize="90%" movablelimits="false" stretchy="false" symmetric="true" id="S1.E5a.m2.12.12.1.1.3.1.2.2" xref="S1.E5a.m2.12.12.1.1.3.1.2.2.cmml">∑</mo><mrow id="S1.E5a.m2.12.12.1.1.3.1.2.3" xref="S1.E5a.m2.12.12.1.1.3.1.2.3.cmml"><mi mathsize="90%" id="S1.E5a.m2.12.12.1.1.3.1.2.3.2" xref="S1.E5a.m2.12.12.1.1.3.1.2.3.2.cmml">s</mi><mo mathsize="90%" stretchy="false" id="S1.E5a.m2.12.12.1.1.3.1.2.3.1" xref="S1.E5a.m2.12.12.1.1.3.1.2.3.1.cmml">=</mo><mn mathsize="90%" id="S1.E5a.m2.12.12.1.1.3.1.2.3.3" xref="S1.E5a.m2.12.12.1.1.3.1.2.3.3.cmml">1</mn></mrow><msub id="S1.E5a.m2.12.12.1.1.3.1.3" xref="S1.E5a.m2.12.12.1.1.3.1.3.cmml"><mi mathsize="90%" id="S1.E5a.m2.12.12.1.1.3.1.3.2" xref="S1.E5a.m2.12.12.1.1.3.1.3.2.cmml">S</mi><mi mathsize="90%" id="S1.E5a.m2.12.12.1.1.3.1.3.3" xref="S1.E5a.m2.12.12.1.1.3.1.3.3.cmml">m</mi></msub></munderover></mstyle><mrow id="S1.E5a.m2.12.12.1.1.3.2" xref="S1.E5a.m2.12.12.1.1.3.2.cmml"><msup id="S1.E5a.m2.12.12.1.1.3.2.2" xref="S1.E5a.m2.12.12.1.1.3.2.2.cmml"><mrow id="S1.E5a.m2.12.12.1.1.3.2.2.2.2" xref="S1.E5a.m2.1.1.cmml"><mo id="S1.E5a.m2.12.12.1.1.3.2.2.2.2.1" xref="S1.E5a.m2.1.1.cmml">(</mo><mstyle displaystyle="true" id="S1.E5a.m2.1.1" xref="S1.E5a.m2.1.1.cmml"><mfrac id="S1.E5a.m2.1.1a" xref="S1.E5a.m2.1.1.cmml"><mrow id="S1.E5a.m2.1.1.3" xref="S1.E5a.m2.1.1.3.cmml"><mo mathsize="90%" stretchy="false" id="S1.E5a.m2.1.1.3.1" xref="S1.E5a.m2.1.1.3.1.cmml">∂</mo><mo id="S1.E5a.m2.1.1.3a" xref="S1.E5a.m2.1.1.3.cmml">⁡</mo><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S1.E5a.m2.1.1.3.2" xref="S1.E5a.m2.1.1.3.2.cmml">ℒ</mi></mrow><mrow id="S1.E5a.m2.1.1.1" xref="S1.E5a.m2.1.1.1.cmml"><mo mathsize="90%" stretchy="false" id="S1.E5a.m2.1.1.1.2" xref="S1.E5a.m2.1.1.1.2.cmml">∂</mo><mo id="S1.E5a.m2.1.1.1a" xref="S1.E5a.m2.1.1.1.cmml">⁡</mo><msubsup id="S1.E5a.m2.1.1.1.3" xref="S1.E5a.m2.1.1.1.3.cmml"><mi mathsize="90%" id="S1.E5a.m2.1.1.1.3.2.2" xref="S1.E5a.m2.1.1.1.3.2.2.cmml">𝒚</mi><mi mathsize="90%" id="S1.E5a.m2.1.1.1.3.3" xref="S1.E5a.m2.1.1.1.3.3.cmml">s</mi><mrow id="S1.E5a.m2.1.1.1.1.1.3" xref="S1.E5a.m2.1.1.1.3.cmml"><mo maxsize="90%" minsize="90%" id="S1.E5a.m2.1.1.1.1.1.3.1" xref="S1.E5a.m2.1.1.1.3.cmml">(</mo><mi mathsize="90%" id="S1.E5a.m2.1.1.1.1.1.1" xref="S1.E5a.m2.1.1.1.1.1.1.cmml">L</mi><mo maxsize="90%" minsize="90%" id="S1.E5a.m2.1.1.1.1.1.3.2" xref="S1.E5a.m2.1.1.1.3.cmml">)</mo></mrow></msubsup></mrow></mfrac></mstyle><mo id="S1.E5a.m2.12.12.1.1.3.2.2.2.2.2" xref="S1.E5a.m2.1.1.cmml">)</mo></mrow><mo mathsize="90%" stretchy="false" id="S1.E5a.m2.12.12.1.1.3.2.2.3" xref="S1.E5a.m2.12.12.1.1.3.2.2.3.cmml">⊤</mo></msup><mo id="S1.E5a.m2.12.12.1.1.3.2.1" xref="S1.E5a.m2.12.12.1.1.3.2.1.cmml">⁢</mo><mrow id="S1.E5a.m2.12.12.1.1.3.2.3" xref="S1.E5a.m2.12.12.1.1.3.2.3.cmml"><mstyle displaystyle="true" id="S1.E5a.m2.12.12.1.1.3.2.3.1" xref="S1.E5a.m2.12.12.1.1.3.2.3.1.cmml"><munderover id="S1.E5a.m2.12.12.1.1.3.2.3.1a" xref="S1.E5a.m2.12.12.1.1.3.2.3.1.cmml"><mo largeop="true" mathsize="90%" movablelimits="false" stretchy="false" symmetric="true" id="S1.E5a.m2.12.12.1.1.3.2.3.1.2.2" xref="S1.E5a.m2.12.12.1.1.3.2.3.1.2.2.cmml">∑</mo><mrow id="S1.E5a.m2.12.12.1.1.3.2.3.1.2.3" xref="S1.E5a.m2.12.12.1.1.3.2.3.1.2.3.cmml"><mi mathsize="90%" id="S1.E5a.m2.12.12.1.1.3.2.3.1.2.3.2" xref="S1.E5a.m2.12.12.1.1.3.2.3.1.2.3.2.cmml">j</mi><mo mathsize="90%" stretchy="false" id="S1.E5a.m2.12.12.1.1.3.2.3.1.2.3.1" xref="S1.E5a.m2.12.12.1.1.3.2.3.1.2.3.1.cmml">=</mo><mn mathsize="90%" id="S1.E5a.m2.12.12.1.1.3.2.3.1.2.3.3" xref="S1.E5a.m2.12.12.1.1.3.2.3.1.2.3.3.cmml">1</mn></mrow><msub id="S1.E5a.m2.12.12.1.1.3.2.3.1.3" xref="S1.E5a.m2.12.12.1.1.3.2.3.1.3.cmml"><mi mathsize="90%" id="S1.E5a.m2.12.12.1.1.3.2.3.1.3.2" xref="S1.E5a.m2.12.12.1.1.3.2.3.1.3.2.cmml">S</mi><mi mathsize="90%" id="S1.E5a.m2.12.12.1.1.3.2.3.1.3.3" xref="S1.E5a.m2.12.12.1.1.3.2.3.1.3.3.cmml">m</mi></msub></munderover></mstyle><mrow id="S1.E5a.m2.12.12.1.1.3.2.3.2" xref="S1.E5a.m2.12.12.1.1.3.2.3.2.cmml"><mstyle displaystyle="true" id="S1.E5a.m2.5.5" xref="S1.E5a.m2.5.5.cmml"><mfrac id="S1.E5a.m2.5.5a" xref="S1.E5a.m2.5.5.cmml"><mrow id="S1.E5a.m2.2.2.1" xref="S1.E5a.m2.2.2.1.cmml"><mo mathsize="90%" stretchy="false" id="S1.E5a.m2.2.2.1.2" xref="S1.E5a.m2.2.2.1.2.cmml">∂</mo><mo id="S1.E5a.m2.2.2.1a" xref="S1.E5a.m2.2.2.1.cmml">⁡</mo><msubsup id="S1.E5a.m2.2.2.1.3" xref="S1.E5a.m2.2.2.1.3.cmml"><mi mathsize="90%" id="S1.E5a.m2.2.2.1.3.2.2" xref="S1.E5a.m2.2.2.1.3.2.2.cmml">𝒚</mi><mi mathsize="90%" id="S1.E5a.m2.2.2.1.3.3" xref="S1.E5a.m2.2.2.1.3.3.cmml">s</mi><mrow id="S1.E5a.m2.2.2.1.1.1.3" xref="S1.E5a.m2.2.2.1.3.cmml"><mo maxsize="90%" minsize="90%" id="S1.E5a.m2.2.2.1.1.1.3.1" xref="S1.E5a.m2.2.2.1.3.cmml">(</mo><mi mathsize="90%" id="S1.E5a.m2.2.2.1.1.1.1" xref="S1.E5a.m2.2.2.1.1.1.1.cmml">L</mi><mo maxsize="90%" minsize="90%" id="S1.E5a.m2.2.2.1.1.1.3.2" xref="S1.E5a.m2.2.2.1.3.cmml">)</mo></mrow></msubsup></mrow><mrow id="S1.E5a.m2.5.5.4" xref="S1.E5a.m2.5.5.4.cmml"><mo mathsize="90%" stretchy="false" id="S1.E5a.m2.5.5.4.4" xref="S1.E5a.m2.5.5.4.4.cmml">∂</mo><mo id="S1.E5a.m2.5.5.4a" xref="S1.E5a.m2.5.5.4.cmml">⁡</mo><msubsup id="S1.E5a.m2.5.5.4.5" xref="S1.E5a.m2.5.5.4.5.cmml"><mi mathsize="90%" id="S1.E5a.m2.5.5.4.5.2.2" xref="S1.E5a.m2.5.5.4.5.2.2.cmml">α</mi><mrow id="S1.E5a.m2.4.4.3.2.2.4" xref="S1.E5a.m2.4.4.3.2.2.3.cmml"><mi mathsize="90%" id="S1.E5a.m2.3.3.2.1.1.1" xref="S1.E5a.m2.3.3.2.1.1.1.cmml">s</mi><mo mathsize="90%" stretchy="false" id="S1.E5a.m2.4.4.3.2.2.4.1" xref="S1.E5a.m2.4.4.3.2.2.3.cmml">,</mo><mi mathsize="90%" id="S1.E5a.m2.4.4.3.2.2.2" xref="S1.E5a.m2.4.4.3.2.2.2.cmml">j</mi></mrow><mrow id="S1.E5a.m2.5.5.4.3.1.3" xref="S1.E5a.m2.5.5.4.5.cmml"><mo maxsize="90%" minsize="90%" id="S1.E5a.m2.5.5.4.3.1.3.1" xref="S1.E5a.m2.5.5.4.5.cmml">(</mo><mi mathsize="90%" id="S1.E5a.m2.5.5.4.3.1.1" xref="S1.E5a.m2.5.5.4.3.1.1.cmml">L</mi><mo maxsize="90%" minsize="90%" id="S1.E5a.m2.5.5.4.3.1.3.2" xref="S1.E5a.m2.5.5.4.5.cmml">)</mo></mrow></msubsup></mrow></mfrac></mstyle><mo mathsize="90%" stretchy="false" id="S1.E5a.m2.12.12.1.1.3.2.3.2.1" xref="S1.E5a.m2.12.12.1.1.3.2.3.2.1.cmml">⋅</mo><mrow id="S1.E5a.m2.12.12.1.1.3.2.3.2.2" xref="S1.E5a.m2.12.12.1.1.3.2.3.2.2.cmml"><mstyle displaystyle="true" id="S1.E5a.m2.12.12.1.1.3.2.3.2.2.1" xref="S1.E5a.m2.12.12.1.1.3.2.3.2.2.1.cmml"><munderover id="S1.E5a.m2.12.12.1.1.3.2.3.2.2.1a" xref="S1.E5a.m2.12.12.1.1.3.2.3.2.2.1.cmml"><mo largeop="true" mathsize="90%" movablelimits="false" stretchy="false" symmetric="true" id="S1.E5a.m2.12.12.1.1.3.2.3.2.2.1.2.2" xref="S1.E5a.m2.12.12.1.1.3.2.3.2.2.1.2.2.cmml">∑</mo><mrow id="S1.E5a.m2.12.12.1.1.3.2.3.2.2.1.2.3" xref="S1.E5a.m2.12.12.1.1.3.2.3.2.2.1.2.3.cmml"><mi mathsize="90%" id="S1.E5a.m2.12.12.1.1.3.2.3.2.2.1.2.3.2" xref="S1.E5a.m2.12.12.1.1.3.2.3.2.2.1.2.3.2.cmml">i</mi><mo mathsize="90%" stretchy="false" id="S1.E5a.m2.12.12.1.1.3.2.3.2.2.1.2.3.1" xref="S1.E5a.m2.12.12.1.1.3.2.3.2.2.1.2.3.1.cmml">=</mo><mn mathsize="90%" id="S1.E5a.m2.12.12.1.1.3.2.3.2.2.1.2.3.3" xref="S1.E5a.m2.12.12.1.1.3.2.3.2.2.1.2.3.3.cmml">1</mn></mrow><msub id="S1.E5a.m2.12.12.1.1.3.2.3.2.2.1.3" xref="S1.E5a.m2.12.12.1.1.3.2.3.2.2.1.3.cmml"><mi mathsize="90%" id="S1.E5a.m2.12.12.1.1.3.2.3.2.2.1.3.2" xref="S1.E5a.m2.12.12.1.1.3.2.3.2.2.1.3.2.cmml">S</mi><mi mathsize="90%" id="S1.E5a.m2.12.12.1.1.3.2.3.2.2.1.3.3" xref="S1.E5a.m2.12.12.1.1.3.2.3.2.2.1.3.3.cmml">m</mi></msub></munderover></mstyle><mrow id="S1.E5a.m2.12.12.1.1.3.2.3.2.2.2" xref="S1.E5a.m2.12.12.1.1.3.2.3.2.2.2.cmml"><mstyle displaystyle="true" id="S1.E5a.m2.9.9" xref="S1.E5a.m2.9.9.cmml"><mfrac id="S1.E5a.m2.9.9a" xref="S1.E5a.m2.9.9.cmml"><mrow id="S1.E5a.m2.8.8.3" xref="S1.E5a.m2.8.8.3.cmml"><mo mathsize="90%" stretchy="false" id="S1.E5a.m2.8.8.3.4" xref="S1.E5a.m2.8.8.3.4.cmml">∂</mo><mo id="S1.E5a.m2.8.8.3a" xref="S1.E5a.m2.8.8.3.cmml">⁡</mo><msubsup id="S1.E5a.m2.8.8.3.5" xref="S1.E5a.m2.8.8.3.5.cmml"><mi mathsize="90%" id="S1.E5a.m2.8.8.3.5.2.2" xref="S1.E5a.m2.8.8.3.5.2.2.cmml">α</mi><mrow id="S1.E5a.m2.7.7.2.2.2.4" xref="S1.E5a.m2.7.7.2.2.2.3.cmml"><mi mathsize="90%" id="S1.E5a.m2.6.6.1.1.1.1" xref="S1.E5a.m2.6.6.1.1.1.1.cmml">s</mi><mo mathsize="90%" stretchy="false" id="S1.E5a.m2.7.7.2.2.2.4.1" xref="S1.E5a.m2.7.7.2.2.2.3.cmml">,</mo><mi mathsize="90%" id="S1.E5a.m2.7.7.2.2.2.2" xref="S1.E5a.m2.7.7.2.2.2.2.cmml">j</mi></mrow><mrow id="S1.E5a.m2.8.8.3.3.1.3" xref="S1.E5a.m2.8.8.3.5.cmml"><mo maxsize="90%" minsize="90%" id="S1.E5a.m2.8.8.3.3.1.3.1" xref="S1.E5a.m2.8.8.3.5.cmml">(</mo><mi mathsize="90%" id="S1.E5a.m2.8.8.3.3.1.1" xref="S1.E5a.m2.8.8.3.3.1.1.cmml">L</mi><mo maxsize="90%" minsize="90%" id="S1.E5a.m2.8.8.3.3.1.3.2" xref="S1.E5a.m2.8.8.3.5.cmml">)</mo></mrow></msubsup></mrow><mrow id="S1.E5a.m2.9.9.4" xref="S1.E5a.m2.9.9.4.cmml"><mo mathsize="90%" stretchy="false" id="S1.E5a.m2.9.9.4.1" xref="S1.E5a.m2.9.9.4.1.cmml">∂</mo><msub id="S1.E5a.m2.9.9.4.2" xref="S1.E5a.m2.9.9.4.2.cmml"><mrow id="S1.E5a.m2.9.9.4.2.2" xref="S1.E5a.m2.9.9.4.2.2.cmml"><mo maxsize="90%" minsize="90%" id="S1.E5a.m2.9.9.4.2.2.1" xref="S1.E5a.m2.9.9.4.2.2.1.cmml">⟨</mo><msub id="S1.E5a.m2.9.9.4.2.2.2" xref="S1.E5a.m2.9.9.4.2.2.2.cmml"><mi mathsize="90%" id="S1.E5a.m2.9.9.4.2.2.2.2" xref="S1.E5a.m2.9.9.4.2.2.2.2.cmml">Z</mi><mi mathsize="90%" id="S1.E5a.m2.9.9.4.2.2.2.3" xref="S1.E5a.m2.9.9.4.2.2.2.3.cmml">k</mi></msub><mo maxsize="90%" minsize="90%" id="S1.E5a.m2.9.9.4.2.2.3" xref="S1.E5a.m2.9.9.4.2.2.3.cmml">⟩</mo></mrow><mi mathsize="90%" id="S1.E5a.m2.9.9.4.2.3" xref="S1.E5a.m2.9.9.4.2.3.cmml">i</mi></msub></mrow></mfrac></mstyle><mo mathsize="90%" stretchy="false" id="S1.E5a.m2.12.12.1.1.3.2.3.2.2.2.1" xref="S1.E5a.m2.12.12.1.1.3.2.3.2.2.2.1.cmml">⋅</mo><mstyle displaystyle="true" id="S1.E5a.m2.11.11" xref="S1.E5a.m2.11.11.cmml"><mfrac id="S1.E5a.m2.11.11a" xref="S1.E5a.m2.11.11.cmml"><mrow id="S1.E5a.m2.10.10.1" xref="S1.E5a.m2.10.10.1.cmml"><mo mathsize="90%" stretchy="false" id="S1.E5a.m2.10.10.1.1" xref="S1.E5a.m2.10.10.1.1.cmml">∂</mo><msub id="S1.E5a.m2.10.10.1.2" xref="S1.E5a.m2.10.10.1.2.cmml"><mrow id="S1.E5a.m2.10.10.1.2.2" xref="S1.E5a.m2.10.10.1.2.2.cmml"><mo maxsize="90%" minsize="90%" id="S1.E5a.m2.10.10.1.2.2.1" xref="S1.E5a.m2.10.10.1.2.2.1.cmml">⟨</mo><msub id="S1.E5a.m2.10.10.1.2.2.2" xref="S1.E5a.m2.10.10.1.2.2.2.cmml"><mi mathsize="90%" id="S1.E5a.m2.10.10.1.2.2.2.2" xref="S1.E5a.m2.10.10.1.2.2.2.2.cmml">Z</mi><mi mathsize="90%" id="S1.E5a.m2.10.10.1.2.2.2.3" xref="S1.E5a.m2.10.10.1.2.2.2.3.cmml">k</mi></msub><mo maxsize="90%" minsize="90%" id="S1.E5a.m2.10.10.1.2.2.3" xref="S1.E5a.m2.10.10.1.2.2.3.cmml">⟩</mo></mrow><mi mathsize="90%" id="S1.E5a.m2.10.10.1.2.3" xref="S1.E5a.m2.10.10.1.2.3.cmml">i</mi></msub></mrow><mrow id="S1.E5a.m2.11.11.2" xref="S1.E5a.m2.11.11.2.cmml"><mo mathsize="90%" stretchy="false" id="S1.E5a.m2.11.11.2.2" xref="S1.E5a.m2.11.11.2.2.cmml">∂</mo><mo id="S1.E5a.m2.11.11.2a" xref="S1.E5a.m2.11.11.2.cmml">⁡</mo><msubsup id="S1.E5a.m2.11.11.2.3" xref="S1.E5a.m2.11.11.2.3.cmml"><mi mathsize="90%" id="S1.E5a.m2.11.11.2.3.2.2" xref="S1.E5a.m2.11.11.2.3.2.2.cmml">𝜽</mi><mi mathsize="90%" id="S1.E5a.m2.11.11.2.3.3" xref="S1.E5a.m2.11.11.2.3.3.cmml">k</mi><mrow id="S1.E5a.m2.11.11.2.1.1.3" xref="S1.E5a.m2.11.11.2.3.cmml"><mo maxsize="90%" minsize="90%" id="S1.E5a.m2.11.11.2.1.1.3.1" xref="S1.E5a.m2.11.11.2.3.cmml">(</mo><mi mathsize="90%" id="S1.E5a.m2.11.11.2.1.1.1" xref="S1.E5a.m2.11.11.2.1.1.1.cmml">L</mi><mo maxsize="90%" minsize="90%" id="S1.E5a.m2.11.11.2.1.1.3.2" xref="S1.E5a.m2.11.11.2.3.cmml">)</mo></mrow></msubsup></mrow></mfrac></mstyle></mrow></mrow></mrow></mrow></mrow></mrow></mrow><mo mathsize="90%" stretchy="false" id="S1.E5a.m2.12.12.1.2" xref="S1.E5a.m2.12.12.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S1.E5a.m2.12b"><apply id="S1.E5a.m2.12.12.1.1.cmml" xref="S1.E5a.m2.12.12.1"><eq id="S1.E5a.m2.12.12.1.1.1.cmml" xref="S1.E5a.m2.12.12.1.1.1"></eq><csymbol cd="latexml" id="S1.E5a.m2.12.12.1.1.2.cmml" xref="S1.E5a.m2.12.12.1.1.2">absent</csymbol><apply id="S1.E5a.m2.12.12.1.1.3.cmml" xref="S1.E5a.m2.12.12.1.1.3"><apply id="S1.E5a.m2.12.12.1.1.3.1.cmml" xref="S1.E5a.m2.12.12.1.1.3.1"><csymbol cd="ambiguous" id="S1.E5a.m2.12.12.1.1.3.1.1.cmml" xref="S1.E5a.m2.12.12.1.1.3.1">superscript</csymbol><apply id="S1.E5a.m2.12.12.1.1.3.1.2.cmml" xref="S1.E5a.m2.12.12.1.1.3.1"><csymbol cd="ambiguous" id="S1.E5a.m2.12.12.1.1.3.1.2.1.cmml" xref="S1.E5a.m2.12.12.1.1.3.1">subscript</csymbol><sum id="S1.E5a.m2.12.12.1.1.3.1.2.2.cmml" xref="S1.E5a.m2.12.12.1.1.3.1.2.2"></sum><apply id="S1.E5a.m2.12.12.1.1.3.1.2.3.cmml" xref="S1.E5a.m2.12.12.1.1.3.1.2.3"><eq id="S1.E5a.m2.12.12.1.1.3.1.2.3.1.cmml" xref="S1.E5a.m2.12.12.1.1.3.1.2.3.1"></eq><ci id="S1.E5a.m2.12.12.1.1.3.1.2.3.2.cmml" xref="S1.E5a.m2.12.12.1.1.3.1.2.3.2">𝑠</ci><cn type="integer" id="S1.E5a.m2.12.12.1.1.3.1.2.3.3.cmml" xref="S1.E5a.m2.12.12.1.1.3.1.2.3.3">1</cn></apply></apply><apply id="S1.E5a.m2.12.12.1.1.3.1.3.cmml" xref="S1.E5a.m2.12.12.1.1.3.1.3"><csymbol cd="ambiguous" id="S1.E5a.m2.12.12.1.1.3.1.3.1.cmml" xref="S1.E5a.m2.12.12.1.1.3.1.3">subscript</csymbol><ci id="S1.E5a.m2.12.12.1.1.3.1.3.2.cmml" xref="S1.E5a.m2.12.12.1.1.3.1.3.2">𝑆</ci><ci id="S1.E5a.m2.12.12.1.1.3.1.3.3.cmml" xref="S1.E5a.m2.12.12.1.1.3.1.3.3">𝑚</ci></apply></apply><apply id="S1.E5a.m2.12.12.1.1.3.2.cmml" xref="S1.E5a.m2.12.12.1.1.3.2"><times id="S1.E5a.m2.12.12.1.1.3.2.1.cmml" xref="S1.E5a.m2.12.12.1.1.3.2.1"></times><apply id="S1.E5a.m2.12.12.1.1.3.2.2.cmml" xref="S1.E5a.m2.12.12.1.1.3.2.2"><csymbol cd="ambiguous" id="S1.E5a.m2.12.12.1.1.3.2.2.1.cmml" xref="S1.E5a.m2.12.12.1.1.3.2.2">superscript</csymbol><apply id="S1.E5a.m2.1.1.cmml" xref="S1.E5a.m2.12.12.1.1.3.2.2.2.2"><divide id="S1.E5a.m2.1.1.2.cmml" xref="S1.E5a.m2.12.12.1.1.3.2.2.2.2"></divide><apply id="S1.E5a.m2.1.1.3.cmml" xref="S1.E5a.m2.1.1.3"><partialdiff id="S1.E5a.m2.1.1.3.1.cmml" xref="S1.E5a.m2.1.1.3.1"></partialdiff><ci id="S1.E5a.m2.1.1.3.2.cmml" xref="S1.E5a.m2.1.1.3.2">ℒ</ci></apply><apply id="S1.E5a.m2.1.1.1.cmml" xref="S1.E5a.m2.1.1.1"><partialdiff id="S1.E5a.m2.1.1.1.2.cmml" xref="S1.E5a.m2.1.1.1.2"></partialdiff><apply id="S1.E5a.m2.1.1.1.3.cmml" xref="S1.E5a.m2.1.1.1.3"><csymbol cd="ambiguous" id="S1.E5a.m2.1.1.1.3.1.cmml" xref="S1.E5a.m2.1.1.1.3">subscript</csymbol><apply id="S1.E5a.m2.1.1.1.3.2.cmml" xref="S1.E5a.m2.1.1.1.3"><csymbol cd="ambiguous" id="S1.E5a.m2.1.1.1.3.2.1.cmml" xref="S1.E5a.m2.1.1.1.3">superscript</csymbol><ci id="S1.E5a.m2.1.1.1.3.2.2.cmml" xref="S1.E5a.m2.1.1.1.3.2.2">𝒚</ci><ci id="S1.E5a.m2.1.1.1.1.1.1.cmml" xref="S1.E5a.m2.1.1.1.1.1.1">𝐿</ci></apply><ci id="S1.E5a.m2.1.1.1.3.3.cmml" xref="S1.E5a.m2.1.1.1.3.3">𝑠</ci></apply></apply></apply><csymbol cd="latexml" id="S1.E5a.m2.12.12.1.1.3.2.2.3.cmml" xref="S1.E5a.m2.12.12.1.1.3.2.2.3">top</csymbol></apply><apply id="S1.E5a.m2.12.12.1.1.3.2.3.cmml" xref="S1.E5a.m2.12.12.1.1.3.2.3"><apply id="S1.E5a.m2.12.12.1.1.3.2.3.1.cmml" xref="S1.E5a.m2.12.12.1.1.3.2.3.1"><csymbol cd="ambiguous" id="S1.E5a.m2.12.12.1.1.3.2.3.1.1.cmml" xref="S1.E5a.m2.12.12.1.1.3.2.3.1">superscript</csymbol><apply id="S1.E5a.m2.12.12.1.1.3.2.3.1.2.cmml" xref="S1.E5a.m2.12.12.1.1.3.2.3.1"><csymbol cd="ambiguous" id="S1.E5a.m2.12.12.1.1.3.2.3.1.2.1.cmml" xref="S1.E5a.m2.12.12.1.1.3.2.3.1">subscript</csymbol><sum id="S1.E5a.m2.12.12.1.1.3.2.3.1.2.2.cmml" xref="S1.E5a.m2.12.12.1.1.3.2.3.1.2.2"></sum><apply id="S1.E5a.m2.12.12.1.1.3.2.3.1.2.3.cmml" xref="S1.E5a.m2.12.12.1.1.3.2.3.1.2.3"><eq id="S1.E5a.m2.12.12.1.1.3.2.3.1.2.3.1.cmml" xref="S1.E5a.m2.12.12.1.1.3.2.3.1.2.3.1"></eq><ci id="S1.E5a.m2.12.12.1.1.3.2.3.1.2.3.2.cmml" xref="S1.E5a.m2.12.12.1.1.3.2.3.1.2.3.2">𝑗</ci><cn type="integer" id="S1.E5a.m2.12.12.1.1.3.2.3.1.2.3.3.cmml" xref="S1.E5a.m2.12.12.1.1.3.2.3.1.2.3.3">1</cn></apply></apply><apply id="S1.E5a.m2.12.12.1.1.3.2.3.1.3.cmml" xref="S1.E5a.m2.12.12.1.1.3.2.3.1.3"><csymbol cd="ambiguous" id="S1.E5a.m2.12.12.1.1.3.2.3.1.3.1.cmml" xref="S1.E5a.m2.12.12.1.1.3.2.3.1.3">subscript</csymbol><ci id="S1.E5a.m2.12.12.1.1.3.2.3.1.3.2.cmml" xref="S1.E5a.m2.12.12.1.1.3.2.3.1.3.2">𝑆</ci><ci id="S1.E5a.m2.12.12.1.1.3.2.3.1.3.3.cmml" xref="S1.E5a.m2.12.12.1.1.3.2.3.1.3.3">𝑚</ci></apply></apply><apply id="S1.E5a.m2.12.12.1.1.3.2.3.2.cmml" xref="S1.E5a.m2.12.12.1.1.3.2.3.2"><ci id="S1.E5a.m2.12.12.1.1.3.2.3.2.1.cmml" xref="S1.E5a.m2.12.12.1.1.3.2.3.2.1">⋅</ci><apply id="S1.E5a.m2.5.5.cmml" xref="S1.E5a.m2.5.5"><divide id="S1.E5a.m2.5.5.5.cmml" xref="S1.E5a.m2.5.5"></divide><apply id="S1.E5a.m2.2.2.1.cmml" xref="S1.E5a.m2.2.2.1"><partialdiff id="S1.E5a.m2.2.2.1.2.cmml" xref="S1.E5a.m2.2.2.1.2"></partialdiff><apply id="S1.E5a.m2.2.2.1.3.cmml" xref="S1.E5a.m2.2.2.1.3"><csymbol cd="ambiguous" id="S1.E5a.m2.2.2.1.3.1.cmml" xref="S1.E5a.m2.2.2.1.3">subscript</csymbol><apply id="S1.E5a.m2.2.2.1.3.2.cmml" xref="S1.E5a.m2.2.2.1.3"><csymbol cd="ambiguous" id="S1.E5a.m2.2.2.1.3.2.1.cmml" xref="S1.E5a.m2.2.2.1.3">superscript</csymbol><ci id="S1.E5a.m2.2.2.1.3.2.2.cmml" xref="S1.E5a.m2.2.2.1.3.2.2">𝒚</ci><ci id="S1.E5a.m2.2.2.1.1.1.1.cmml" xref="S1.E5a.m2.2.2.1.1.1.1">𝐿</ci></apply><ci id="S1.E5a.m2.2.2.1.3.3.cmml" xref="S1.E5a.m2.2.2.1.3.3">𝑠</ci></apply></apply><apply id="S1.E5a.m2.5.5.4.cmml" xref="S1.E5a.m2.5.5.4"><partialdiff id="S1.E5a.m2.5.5.4.4.cmml" xref="S1.E5a.m2.5.5.4.4"></partialdiff><apply id="S1.E5a.m2.5.5.4.5.cmml" xref="S1.E5a.m2.5.5.4.5"><csymbol cd="ambiguous" id="S1.E5a.m2.5.5.4.5.1.cmml" xref="S1.E5a.m2.5.5.4.5">superscript</csymbol><apply id="S1.E5a.m2.5.5.4.5.2.cmml" xref="S1.E5a.m2.5.5.4.5"><csymbol cd="ambiguous" id="S1.E5a.m2.5.5.4.5.2.1.cmml" xref="S1.E5a.m2.5.5.4.5">subscript</csymbol><ci id="S1.E5a.m2.5.5.4.5.2.2.cmml" xref="S1.E5a.m2.5.5.4.5.2.2">𝛼</ci><list id="S1.E5a.m2.4.4.3.2.2.3.cmml" xref="S1.E5a.m2.4.4.3.2.2.4"><ci id="S1.E5a.m2.3.3.2.1.1.1.cmml" xref="S1.E5a.m2.3.3.2.1.1.1">𝑠</ci><ci id="S1.E5a.m2.4.4.3.2.2.2.cmml" xref="S1.E5a.m2.4.4.3.2.2.2">𝑗</ci></list></apply><ci id="S1.E5a.m2.5.5.4.3.1.1.cmml" xref="S1.E5a.m2.5.5.4.3.1.1">𝐿</ci></apply></apply></apply><apply id="S1.E5a.m2.12.12.1.1.3.2.3.2.2.cmml" xref="S1.E5a.m2.12.12.1.1.3.2.3.2.2"><apply id="S1.E5a.m2.12.12.1.1.3.2.3.2.2.1.cmml" xref="S1.E5a.m2.12.12.1.1.3.2.3.2.2.1"><csymbol cd="ambiguous" id="S1.E5a.m2.12.12.1.1.3.2.3.2.2.1.1.cmml" xref="S1.E5a.m2.12.12.1.1.3.2.3.2.2.1">superscript</csymbol><apply id="S1.E5a.m2.12.12.1.1.3.2.3.2.2.1.2.cmml" xref="S1.E5a.m2.12.12.1.1.3.2.3.2.2.1"><csymbol cd="ambiguous" id="S1.E5a.m2.12.12.1.1.3.2.3.2.2.1.2.1.cmml" xref="S1.E5a.m2.12.12.1.1.3.2.3.2.2.1">subscript</csymbol><sum id="S1.E5a.m2.12.12.1.1.3.2.3.2.2.1.2.2.cmml" xref="S1.E5a.m2.12.12.1.1.3.2.3.2.2.1.2.2"></sum><apply id="S1.E5a.m2.12.12.1.1.3.2.3.2.2.1.2.3.cmml" xref="S1.E5a.m2.12.12.1.1.3.2.3.2.2.1.2.3"><eq id="S1.E5a.m2.12.12.1.1.3.2.3.2.2.1.2.3.1.cmml" xref="S1.E5a.m2.12.12.1.1.3.2.3.2.2.1.2.3.1"></eq><ci id="S1.E5a.m2.12.12.1.1.3.2.3.2.2.1.2.3.2.cmml" xref="S1.E5a.m2.12.12.1.1.3.2.3.2.2.1.2.3.2">𝑖</ci><cn type="integer" id="S1.E5a.m2.12.12.1.1.3.2.3.2.2.1.2.3.3.cmml" xref="S1.E5a.m2.12.12.1.1.3.2.3.2.2.1.2.3.3">1</cn></apply></apply><apply id="S1.E5a.m2.12.12.1.1.3.2.3.2.2.1.3.cmml" xref="S1.E5a.m2.12.12.1.1.3.2.3.2.2.1.3"><csymbol cd="ambiguous" id="S1.E5a.m2.12.12.1.1.3.2.3.2.2.1.3.1.cmml" xref="S1.E5a.m2.12.12.1.1.3.2.3.2.2.1.3">subscript</csymbol><ci id="S1.E5a.m2.12.12.1.1.3.2.3.2.2.1.3.2.cmml" xref="S1.E5a.m2.12.12.1.1.3.2.3.2.2.1.3.2">𝑆</ci><ci id="S1.E5a.m2.12.12.1.1.3.2.3.2.2.1.3.3.cmml" xref="S1.E5a.m2.12.12.1.1.3.2.3.2.2.1.3.3">𝑚</ci></apply></apply><apply id="S1.E5a.m2.12.12.1.1.3.2.3.2.2.2.cmml" xref="S1.E5a.m2.12.12.1.1.3.2.3.2.2.2"><ci id="S1.E5a.m2.12.12.1.1.3.2.3.2.2.2.1.cmml" xref="S1.E5a.m2.12.12.1.1.3.2.3.2.2.2.1">⋅</ci><apply id="S1.E5a.m2.9.9.cmml" xref="S1.E5a.m2.9.9"><divide id="S1.E5a.m2.9.9.5.cmml" xref="S1.E5a.m2.9.9"></divide><apply id="S1.E5a.m2.8.8.3.cmml" xref="S1.E5a.m2.8.8.3"><partialdiff id="S1.E5a.m2.8.8.3.4.cmml" xref="S1.E5a.m2.8.8.3.4"></partialdiff><apply id="S1.E5a.m2.8.8.3.5.cmml" xref="S1.E5a.m2.8.8.3.5"><csymbol cd="ambiguous" id="S1.E5a.m2.8.8.3.5.1.cmml" xref="S1.E5a.m2.8.8.3.5">superscript</csymbol><apply id="S1.E5a.m2.8.8.3.5.2.cmml" xref="S1.E5a.m2.8.8.3.5"><csymbol cd="ambiguous" id="S1.E5a.m2.8.8.3.5.2.1.cmml" xref="S1.E5a.m2.8.8.3.5">subscript</csymbol><ci id="S1.E5a.m2.8.8.3.5.2.2.cmml" xref="S1.E5a.m2.8.8.3.5.2.2">𝛼</ci><list id="S1.E5a.m2.7.7.2.2.2.3.cmml" xref="S1.E5a.m2.7.7.2.2.2.4"><ci id="S1.E5a.m2.6.6.1.1.1.1.cmml" xref="S1.E5a.m2.6.6.1.1.1.1">𝑠</ci><ci id="S1.E5a.m2.7.7.2.2.2.2.cmml" xref="S1.E5a.m2.7.7.2.2.2.2">𝑗</ci></list></apply><ci id="S1.E5a.m2.8.8.3.3.1.1.cmml" xref="S1.E5a.m2.8.8.3.3.1.1">𝐿</ci></apply></apply><cerror id="S1.E5a.m2.9.9.4.cmml" xref="S1.E5a.m2.9.9.4"><csymbol cd="ambiguous" id="S1.E5a.m2.9.9.4a.cmml" xref="S1.E5a.m2.9.9.4">fragments</csymbol><partialdiff id="S1.E5a.m2.9.9.4.1.cmml" xref="S1.E5a.m2.9.9.4.1"></partialdiff><apply id="S1.E5a.m2.9.9.4.2.cmml" xref="S1.E5a.m2.9.9.4.2"><csymbol cd="ambiguous" id="S1.E5a.m2.9.9.4.2.1.cmml" xref="S1.E5a.m2.9.9.4.2">subscript</csymbol><cerror id="S1.E5a.m2.9.9.4.2.2.cmml" xref="S1.E5a.m2.9.9.4.2.2"><csymbol cd="ambiguous" id="S1.E5a.m2.9.9.4.2.2a.cmml" xref="S1.E5a.m2.9.9.4.2.2">fragments</csymbol><ci id="S1.E5a.m2.9.9.4.2.2.1.cmml" xref="S1.E5a.m2.9.9.4.2.2.1">⟨</ci><apply id="S1.E5a.m2.9.9.4.2.2.2.cmml" xref="S1.E5a.m2.9.9.4.2.2.2"><csymbol cd="ambiguous" id="S1.E5a.m2.9.9.4.2.2.2.1.cmml" xref="S1.E5a.m2.9.9.4.2.2.2">subscript</csymbol><ci id="S1.E5a.m2.9.9.4.2.2.2.2.cmml" xref="S1.E5a.m2.9.9.4.2.2.2.2">𝑍</ci><ci id="S1.E5a.m2.9.9.4.2.2.2.3.cmml" xref="S1.E5a.m2.9.9.4.2.2.2.3">𝑘</ci></apply><ci id="S1.E5a.m2.9.9.4.2.2.3.cmml" xref="S1.E5a.m2.9.9.4.2.2.3">⟩</ci></cerror><ci id="S1.E5a.m2.9.9.4.2.3.cmml" xref="S1.E5a.m2.9.9.4.2.3">𝑖</ci></apply></cerror></apply><apply id="S1.E5a.m2.11.11.cmml" xref="S1.E5a.m2.11.11"><divide id="S1.E5a.m2.11.11.3.cmml" xref="S1.E5a.m2.11.11"></divide><cerror id="S1.E5a.m2.10.10.1.cmml" xref="S1.E5a.m2.10.10.1"><csymbol cd="ambiguous" id="S1.E5a.m2.10.10.1a.cmml" xref="S1.E5a.m2.10.10.1">fragments</csymbol><partialdiff id="S1.E5a.m2.10.10.1.1.cmml" xref="S1.E5a.m2.10.10.1.1"></partialdiff><apply id="S1.E5a.m2.10.10.1.2.cmml" xref="S1.E5a.m2.10.10.1.2"><csymbol cd="ambiguous" id="S1.E5a.m2.10.10.1.2.1.cmml" xref="S1.E5a.m2.10.10.1.2">subscript</csymbol><cerror id="S1.E5a.m2.10.10.1.2.2.cmml" xref="S1.E5a.m2.10.10.1.2.2"><csymbol cd="ambiguous" id="S1.E5a.m2.10.10.1.2.2a.cmml" xref="S1.E5a.m2.10.10.1.2.2">fragments</csymbol><ci id="S1.E5a.m2.10.10.1.2.2.1.cmml" xref="S1.E5a.m2.10.10.1.2.2.1">⟨</ci><apply id="S1.E5a.m2.10.10.1.2.2.2.cmml" xref="S1.E5a.m2.10.10.1.2.2.2"><csymbol cd="ambiguous" id="S1.E5a.m2.10.10.1.2.2.2.1.cmml" xref="S1.E5a.m2.10.10.1.2.2.2">subscript</csymbol><ci id="S1.E5a.m2.10.10.1.2.2.2.2.cmml" xref="S1.E5a.m2.10.10.1.2.2.2.2">𝑍</ci><ci id="S1.E5a.m2.10.10.1.2.2.2.3.cmml" xref="S1.E5a.m2.10.10.1.2.2.2.3">𝑘</ci></apply><ci id="S1.E5a.m2.10.10.1.2.2.3.cmml" xref="S1.E5a.m2.10.10.1.2.2.3">⟩</ci></cerror><ci id="S1.E5a.m2.10.10.1.2.3.cmml" xref="S1.E5a.m2.10.10.1.2.3">𝑖</ci></apply></cerror><apply id="S1.E5a.m2.11.11.2.cmml" xref="S1.E5a.m2.11.11.2"><partialdiff id="S1.E5a.m2.11.11.2.2.cmml" xref="S1.E5a.m2.11.11.2.2"></partialdiff><apply id="S1.E5a.m2.11.11.2.3.cmml" xref="S1.E5a.m2.11.11.2.3"><csymbol cd="ambiguous" id="S1.E5a.m2.11.11.2.3.1.cmml" xref="S1.E5a.m2.11.11.2.3">subscript</csymbol><apply id="S1.E5a.m2.11.11.2.3.2.cmml" xref="S1.E5a.m2.11.11.2.3"><csymbol cd="ambiguous" id="S1.E5a.m2.11.11.2.3.2.1.cmml" xref="S1.E5a.m2.11.11.2.3">superscript</csymbol><ci id="S1.E5a.m2.11.11.2.3.2.2.cmml" xref="S1.E5a.m2.11.11.2.3.2.2">𝜽</ci><ci id="S1.E5a.m2.11.11.2.1.1.1.cmml" xref="S1.E5a.m2.11.11.2.1.1.1">𝐿</ci></apply><ci id="S1.E5a.m2.11.11.2.3.3.cmml" xref="S1.E5a.m2.11.11.2.3.3">𝑘</ci></apply></apply></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.E5a.m2.12c">\displaystyle=\sum_{s=1}^{S_{m}}\left(\frac{\partial\mathcal{L}}{\partial\bm{y%
}^{(L)}_{s}}\right)^{\top}\sum_{j=1}^{S_{m}}\frac{\partial\bm{y}^{(L)}_{s}}{%
\partial\alpha_{s,j}^{(L)}}\cdot\sum_{i=1}^{S_{m}}\frac{\partial\alpha_{s,j}^{%
(L)}}{\partial\langle Z_{k}\rangle_{i}}\cdot\frac{\partial\langle Z_{k}\rangle%
_{i}}{\partial\bm{\theta}^{(L)}_{k}},</annotation><annotation encoding="application/x-llamapun" id="S1.E5a.m2.12d">= ∑ start_POSTSUBSCRIPT italic_s = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_S start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT end_POSTSUPERSCRIPT ( divide start_ARG ∂ caligraphic_L end_ARG start_ARG ∂ bold_italic_y start_POSTSUPERSCRIPT ( italic_L ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT end_ARG ) start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_S start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT end_POSTSUPERSCRIPT divide start_ARG ∂ bold_italic_y start_POSTSUPERSCRIPT ( italic_L ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT end_ARG start_ARG ∂ italic_α start_POSTSUBSCRIPT italic_s , italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_L ) end_POSTSUPERSCRIPT end_ARG ⋅ ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_S start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT end_POSTSUPERSCRIPT divide start_ARG ∂ italic_α start_POSTSUBSCRIPT italic_s , italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_L ) end_POSTSUPERSCRIPT end_ARG start_ARG ∂ ⟨ italic_Z start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ⟩ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_ARG ⋅ divide start_ARG ∂ ⟨ italic_Z start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ⟩ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_ARG start_ARG ∂ bold_italic_θ start_POSTSUPERSCRIPT ( italic_L ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(S5)</span></td>
</tr></tbody>
</table>
<p id="S1a.p1.14" class="ltx_p">where <math id="S1a.p1.9.m1.2" class="ltx_Math" alttext="{\partial\bm{y}^{(L)}_{s}}/{\partial\bm{o}_{j}^{(L)}}" display="inline"><semantics id="S1a.p1.9.m1.2a"><mrow id="S1a.p1.9.m1.2.3" xref="S1a.p1.9.m1.2.3.cmml"><mrow id="S1a.p1.9.m1.2.3.2" xref="S1a.p1.9.m1.2.3.2.cmml"><mo id="S1a.p1.9.m1.2.3.2.1" xref="S1a.p1.9.m1.2.3.2.1.cmml">∂</mo><mo id="S1a.p1.9.m1.2.3.2a" xref="S1a.p1.9.m1.2.3.2.cmml">⁡</mo><msubsup id="S1a.p1.9.m1.2.3.2.2" xref="S1a.p1.9.m1.2.3.2.2.cmml"><mi id="S1a.p1.9.m1.2.3.2.2.2.2" xref="S1a.p1.9.m1.2.3.2.2.2.2.cmml">𝒚</mi><mi id="S1a.p1.9.m1.2.3.2.2.3" xref="S1a.p1.9.m1.2.3.2.2.3.cmml">s</mi><mrow id="S1a.p1.9.m1.1.1.1.3" xref="S1a.p1.9.m1.2.3.2.2.cmml"><mo stretchy="false" id="S1a.p1.9.m1.1.1.1.3.1" xref="S1a.p1.9.m1.2.3.2.2.cmml">(</mo><mi id="S1a.p1.9.m1.1.1.1.1" xref="S1a.p1.9.m1.1.1.1.1.cmml">L</mi><mo stretchy="false" id="S1a.p1.9.m1.1.1.1.3.2" xref="S1a.p1.9.m1.2.3.2.2.cmml">)</mo></mrow></msubsup></mrow><mo id="S1a.p1.9.m1.2.3.1" xref="S1a.p1.9.m1.2.3.1.cmml">/</mo><mrow id="S1a.p1.9.m1.2.3.3" xref="S1a.p1.9.m1.2.3.3.cmml"><mo id="S1a.p1.9.m1.2.3.3.1" xref="S1a.p1.9.m1.2.3.3.1.cmml">∂</mo><mo id="S1a.p1.9.m1.2.3.3a" xref="S1a.p1.9.m1.2.3.3.cmml">⁡</mo><msubsup id="S1a.p1.9.m1.2.3.3.2" xref="S1a.p1.9.m1.2.3.3.2.cmml"><mi id="S1a.p1.9.m1.2.3.3.2.2.2" xref="S1a.p1.9.m1.2.3.3.2.2.2.cmml">𝒐</mi><mi id="S1a.p1.9.m1.2.3.3.2.2.3" xref="S1a.p1.9.m1.2.3.3.2.2.3.cmml">j</mi><mrow id="S1a.p1.9.m1.2.2.1.3" xref="S1a.p1.9.m1.2.3.3.2.cmml"><mo stretchy="false" id="S1a.p1.9.m1.2.2.1.3.1" xref="S1a.p1.9.m1.2.3.3.2.cmml">(</mo><mi id="S1a.p1.9.m1.2.2.1.1" xref="S1a.p1.9.m1.2.2.1.1.cmml">L</mi><mo stretchy="false" id="S1a.p1.9.m1.2.2.1.3.2" xref="S1a.p1.9.m1.2.3.3.2.cmml">)</mo></mrow></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1a.p1.9.m1.2b"><apply id="S1a.p1.9.m1.2.3.cmml" xref="S1a.p1.9.m1.2.3"><divide id="S1a.p1.9.m1.2.3.1.cmml" xref="S1a.p1.9.m1.2.3.1"></divide><apply id="S1a.p1.9.m1.2.3.2.cmml" xref="S1a.p1.9.m1.2.3.2"><partialdiff id="S1a.p1.9.m1.2.3.2.1.cmml" xref="S1a.p1.9.m1.2.3.2.1"></partialdiff><apply id="S1a.p1.9.m1.2.3.2.2.cmml" xref="S1a.p1.9.m1.2.3.2.2"><csymbol cd="ambiguous" id="S1a.p1.9.m1.2.3.2.2.1.cmml" xref="S1a.p1.9.m1.2.3.2.2">subscript</csymbol><apply id="S1a.p1.9.m1.2.3.2.2.2.cmml" xref="S1a.p1.9.m1.2.3.2.2"><csymbol cd="ambiguous" id="S1a.p1.9.m1.2.3.2.2.2.1.cmml" xref="S1a.p1.9.m1.2.3.2.2">superscript</csymbol><ci id="S1a.p1.9.m1.2.3.2.2.2.2.cmml" xref="S1a.p1.9.m1.2.3.2.2.2.2">𝒚</ci><ci id="S1a.p1.9.m1.1.1.1.1.cmml" xref="S1a.p1.9.m1.1.1.1.1">𝐿</ci></apply><ci id="S1a.p1.9.m1.2.3.2.2.3.cmml" xref="S1a.p1.9.m1.2.3.2.2.3">𝑠</ci></apply></apply><apply id="S1a.p1.9.m1.2.3.3.cmml" xref="S1a.p1.9.m1.2.3.3"><partialdiff id="S1a.p1.9.m1.2.3.3.1.cmml" xref="S1a.p1.9.m1.2.3.3.1"></partialdiff><apply id="S1a.p1.9.m1.2.3.3.2.cmml" xref="S1a.p1.9.m1.2.3.3.2"><csymbol cd="ambiguous" id="S1a.p1.9.m1.2.3.3.2.1.cmml" xref="S1a.p1.9.m1.2.3.3.2">superscript</csymbol><apply id="S1a.p1.9.m1.2.3.3.2.2.cmml" xref="S1a.p1.9.m1.2.3.3.2"><csymbol cd="ambiguous" id="S1a.p1.9.m1.2.3.3.2.2.1.cmml" xref="S1a.p1.9.m1.2.3.3.2">subscript</csymbol><ci id="S1a.p1.9.m1.2.3.3.2.2.2.cmml" xref="S1a.p1.9.m1.2.3.3.2.2.2">𝒐</ci><ci id="S1a.p1.9.m1.2.3.3.2.2.3.cmml" xref="S1a.p1.9.m1.2.3.3.2.2.3">𝑗</ci></apply><ci id="S1a.p1.9.m1.2.2.1.1.cmml" xref="S1a.p1.9.m1.2.2.1.1">𝐿</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1a.p1.9.m1.2c">{\partial\bm{y}^{(L)}_{s}}/{\partial\bm{o}_{j}^{(L)}}</annotation><annotation encoding="application/x-llamapun" id="S1a.p1.9.m1.2d">∂ bold_italic_y start_POSTSUPERSCRIPT ( italic_L ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT / ∂ bold_italic_o start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_L ) end_POSTSUPERSCRIPT</annotation></semantics></math> <math id="S1a.p1.10.m2.3" class="ltx_Math" alttext="=\alpha_{s,j}^{(L)}" display="inline"><semantics id="S1a.p1.10.m2.3a"><mrow id="S1a.p1.10.m2.3.4" xref="S1a.p1.10.m2.3.4.cmml"><mi id="S1a.p1.10.m2.3.4.2" xref="S1a.p1.10.m2.3.4.2.cmml"></mi><mo id="S1a.p1.10.m2.3.4.1" xref="S1a.p1.10.m2.3.4.1.cmml">=</mo><msubsup id="S1a.p1.10.m2.3.4.3" xref="S1a.p1.10.m2.3.4.3.cmml"><mi id="S1a.p1.10.m2.3.4.3.2.2" xref="S1a.p1.10.m2.3.4.3.2.2.cmml">α</mi><mrow id="S1a.p1.10.m2.2.2.2.4" xref="S1a.p1.10.m2.2.2.2.3.cmml"><mi id="S1a.p1.10.m2.1.1.1.1" xref="S1a.p1.10.m2.1.1.1.1.cmml">s</mi><mo id="S1a.p1.10.m2.2.2.2.4.1" xref="S1a.p1.10.m2.2.2.2.3.cmml">,</mo><mi id="S1a.p1.10.m2.2.2.2.2" xref="S1a.p1.10.m2.2.2.2.2.cmml">j</mi></mrow><mrow id="S1a.p1.10.m2.3.3.1.3" xref="S1a.p1.10.m2.3.4.3.cmml"><mo stretchy="false" id="S1a.p1.10.m2.3.3.1.3.1" xref="S1a.p1.10.m2.3.4.3.cmml">(</mo><mi id="S1a.p1.10.m2.3.3.1.1" xref="S1a.p1.10.m2.3.3.1.1.cmml">L</mi><mo stretchy="false" id="S1a.p1.10.m2.3.3.1.3.2" xref="S1a.p1.10.m2.3.4.3.cmml">)</mo></mrow></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S1a.p1.10.m2.3b"><apply id="S1a.p1.10.m2.3.4.cmml" xref="S1a.p1.10.m2.3.4"><eq id="S1a.p1.10.m2.3.4.1.cmml" xref="S1a.p1.10.m2.3.4.1"></eq><csymbol cd="latexml" id="S1a.p1.10.m2.3.4.2.cmml" xref="S1a.p1.10.m2.3.4.2">absent</csymbol><apply id="S1a.p1.10.m2.3.4.3.cmml" xref="S1a.p1.10.m2.3.4.3"><csymbol cd="ambiguous" id="S1a.p1.10.m2.3.4.3.1.cmml" xref="S1a.p1.10.m2.3.4.3">superscript</csymbol><apply id="S1a.p1.10.m2.3.4.3.2.cmml" xref="S1a.p1.10.m2.3.4.3"><csymbol cd="ambiguous" id="S1a.p1.10.m2.3.4.3.2.1.cmml" xref="S1a.p1.10.m2.3.4.3">subscript</csymbol><ci id="S1a.p1.10.m2.3.4.3.2.2.cmml" xref="S1a.p1.10.m2.3.4.3.2.2">𝛼</ci><list id="S1a.p1.10.m2.2.2.2.3.cmml" xref="S1a.p1.10.m2.2.2.2.4"><ci id="S1a.p1.10.m2.1.1.1.1.cmml" xref="S1a.p1.10.m2.1.1.1.1">𝑠</ci><ci id="S1a.p1.10.m2.2.2.2.2.cmml" xref="S1a.p1.10.m2.2.2.2.2">𝑗</ci></list></apply><ci id="S1a.p1.10.m2.3.3.1.1.cmml" xref="S1a.p1.10.m2.3.3.1.1">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1a.p1.10.m2.3c">=\alpha_{s,j}^{(L)}</annotation><annotation encoding="application/x-llamapun" id="S1a.p1.10.m2.3d">= italic_α start_POSTSUBSCRIPT italic_s , italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_L ) end_POSTSUPERSCRIPT</annotation></semantics></math>, <math id="S1a.p1.11.m3.4" class="ltx_Math" alttext="{\partial\bm{y}^{(L)}_{s}}/{\partial\alpha_{s,j}^{(L)}}" display="inline"><semantics id="S1a.p1.11.m3.4a"><mrow id="S1a.p1.11.m3.4.5" xref="S1a.p1.11.m3.4.5.cmml"><mrow id="S1a.p1.11.m3.4.5.2" xref="S1a.p1.11.m3.4.5.2.cmml"><mo id="S1a.p1.11.m3.4.5.2.1" xref="S1a.p1.11.m3.4.5.2.1.cmml">∂</mo><mo id="S1a.p1.11.m3.4.5.2a" xref="S1a.p1.11.m3.4.5.2.cmml">⁡</mo><msubsup id="S1a.p1.11.m3.4.5.2.2" xref="S1a.p1.11.m3.4.5.2.2.cmml"><mi id="S1a.p1.11.m3.4.5.2.2.2.2" xref="S1a.p1.11.m3.4.5.2.2.2.2.cmml">𝒚</mi><mi id="S1a.p1.11.m3.4.5.2.2.3" xref="S1a.p1.11.m3.4.5.2.2.3.cmml">s</mi><mrow id="S1a.p1.11.m3.1.1.1.3" xref="S1a.p1.11.m3.4.5.2.2.cmml"><mo stretchy="false" id="S1a.p1.11.m3.1.1.1.3.1" xref="S1a.p1.11.m3.4.5.2.2.cmml">(</mo><mi id="S1a.p1.11.m3.1.1.1.1" xref="S1a.p1.11.m3.1.1.1.1.cmml">L</mi><mo stretchy="false" id="S1a.p1.11.m3.1.1.1.3.2" xref="S1a.p1.11.m3.4.5.2.2.cmml">)</mo></mrow></msubsup></mrow><mo id="S1a.p1.11.m3.4.5.1" xref="S1a.p1.11.m3.4.5.1.cmml">/</mo><mrow id="S1a.p1.11.m3.4.5.3" xref="S1a.p1.11.m3.4.5.3.cmml"><mo id="S1a.p1.11.m3.4.5.3.1" xref="S1a.p1.11.m3.4.5.3.1.cmml">∂</mo><mo id="S1a.p1.11.m3.4.5.3a" xref="S1a.p1.11.m3.4.5.3.cmml">⁡</mo><msubsup id="S1a.p1.11.m3.4.5.3.2" xref="S1a.p1.11.m3.4.5.3.2.cmml"><mi id="S1a.p1.11.m3.4.5.3.2.2.2" xref="S1a.p1.11.m3.4.5.3.2.2.2.cmml">α</mi><mrow id="S1a.p1.11.m3.3.3.2.4" xref="S1a.p1.11.m3.3.3.2.3.cmml"><mi id="S1a.p1.11.m3.2.2.1.1" xref="S1a.p1.11.m3.2.2.1.1.cmml">s</mi><mo id="S1a.p1.11.m3.3.3.2.4.1" xref="S1a.p1.11.m3.3.3.2.3.cmml">,</mo><mi id="S1a.p1.11.m3.3.3.2.2" xref="S1a.p1.11.m3.3.3.2.2.cmml">j</mi></mrow><mrow id="S1a.p1.11.m3.4.4.1.3" xref="S1a.p1.11.m3.4.5.3.2.cmml"><mo stretchy="false" id="S1a.p1.11.m3.4.4.1.3.1" xref="S1a.p1.11.m3.4.5.3.2.cmml">(</mo><mi id="S1a.p1.11.m3.4.4.1.1" xref="S1a.p1.11.m3.4.4.1.1.cmml">L</mi><mo stretchy="false" id="S1a.p1.11.m3.4.4.1.3.2" xref="S1a.p1.11.m3.4.5.3.2.cmml">)</mo></mrow></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1a.p1.11.m3.4b"><apply id="S1a.p1.11.m3.4.5.cmml" xref="S1a.p1.11.m3.4.5"><divide id="S1a.p1.11.m3.4.5.1.cmml" xref="S1a.p1.11.m3.4.5.1"></divide><apply id="S1a.p1.11.m3.4.5.2.cmml" xref="S1a.p1.11.m3.4.5.2"><partialdiff id="S1a.p1.11.m3.4.5.2.1.cmml" xref="S1a.p1.11.m3.4.5.2.1"></partialdiff><apply id="S1a.p1.11.m3.4.5.2.2.cmml" xref="S1a.p1.11.m3.4.5.2.2"><csymbol cd="ambiguous" id="S1a.p1.11.m3.4.5.2.2.1.cmml" xref="S1a.p1.11.m3.4.5.2.2">subscript</csymbol><apply id="S1a.p1.11.m3.4.5.2.2.2.cmml" xref="S1a.p1.11.m3.4.5.2.2"><csymbol cd="ambiguous" id="S1a.p1.11.m3.4.5.2.2.2.1.cmml" xref="S1a.p1.11.m3.4.5.2.2">superscript</csymbol><ci id="S1a.p1.11.m3.4.5.2.2.2.2.cmml" xref="S1a.p1.11.m3.4.5.2.2.2.2">𝒚</ci><ci id="S1a.p1.11.m3.1.1.1.1.cmml" xref="S1a.p1.11.m3.1.1.1.1">𝐿</ci></apply><ci id="S1a.p1.11.m3.4.5.2.2.3.cmml" xref="S1a.p1.11.m3.4.5.2.2.3">𝑠</ci></apply></apply><apply id="S1a.p1.11.m3.4.5.3.cmml" xref="S1a.p1.11.m3.4.5.3"><partialdiff id="S1a.p1.11.m3.4.5.3.1.cmml" xref="S1a.p1.11.m3.4.5.3.1"></partialdiff><apply id="S1a.p1.11.m3.4.5.3.2.cmml" xref="S1a.p1.11.m3.4.5.3.2"><csymbol cd="ambiguous" id="S1a.p1.11.m3.4.5.3.2.1.cmml" xref="S1a.p1.11.m3.4.5.3.2">superscript</csymbol><apply id="S1a.p1.11.m3.4.5.3.2.2.cmml" xref="S1a.p1.11.m3.4.5.3.2"><csymbol cd="ambiguous" id="S1a.p1.11.m3.4.5.3.2.2.1.cmml" xref="S1a.p1.11.m3.4.5.3.2">subscript</csymbol><ci id="S1a.p1.11.m3.4.5.3.2.2.2.cmml" xref="S1a.p1.11.m3.4.5.3.2.2.2">𝛼</ci><list id="S1a.p1.11.m3.3.3.2.3.cmml" xref="S1a.p1.11.m3.3.3.2.4"><ci id="S1a.p1.11.m3.2.2.1.1.cmml" xref="S1a.p1.11.m3.2.2.1.1">𝑠</ci><ci id="S1a.p1.11.m3.3.3.2.2.cmml" xref="S1a.p1.11.m3.3.3.2.2">𝑗</ci></list></apply><ci id="S1a.p1.11.m3.4.4.1.1.cmml" xref="S1a.p1.11.m3.4.4.1.1">𝐿</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1a.p1.11.m3.4c">{\partial\bm{y}^{(L)}_{s}}/{\partial\alpha_{s,j}^{(L)}}</annotation><annotation encoding="application/x-llamapun" id="S1a.p1.11.m3.4d">∂ bold_italic_y start_POSTSUPERSCRIPT ( italic_L ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT / ∂ italic_α start_POSTSUBSCRIPT italic_s , italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_L ) end_POSTSUPERSCRIPT</annotation></semantics></math> <math id="S1a.p1.12.m4.1" class="ltx_Math" alttext="=\bm{o}_{j}^{(L)}" display="inline"><semantics id="S1a.p1.12.m4.1a"><mrow id="S1a.p1.12.m4.1.2" xref="S1a.p1.12.m4.1.2.cmml"><mi id="S1a.p1.12.m4.1.2.2" xref="S1a.p1.12.m4.1.2.2.cmml"></mi><mo id="S1a.p1.12.m4.1.2.1" xref="S1a.p1.12.m4.1.2.1.cmml">=</mo><msubsup id="S1a.p1.12.m4.1.2.3" xref="S1a.p1.12.m4.1.2.3.cmml"><mi id="S1a.p1.12.m4.1.2.3.2.2" xref="S1a.p1.12.m4.1.2.3.2.2.cmml">𝒐</mi><mi id="S1a.p1.12.m4.1.2.3.2.3" xref="S1a.p1.12.m4.1.2.3.2.3.cmml">j</mi><mrow id="S1a.p1.12.m4.1.1.1.3" xref="S1a.p1.12.m4.1.2.3.cmml"><mo stretchy="false" id="S1a.p1.12.m4.1.1.1.3.1" xref="S1a.p1.12.m4.1.2.3.cmml">(</mo><mi id="S1a.p1.12.m4.1.1.1.1" xref="S1a.p1.12.m4.1.1.1.1.cmml">L</mi><mo stretchy="false" id="S1a.p1.12.m4.1.1.1.3.2" xref="S1a.p1.12.m4.1.2.3.cmml">)</mo></mrow></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S1a.p1.12.m4.1b"><apply id="S1a.p1.12.m4.1.2.cmml" xref="S1a.p1.12.m4.1.2"><eq id="S1a.p1.12.m4.1.2.1.cmml" xref="S1a.p1.12.m4.1.2.1"></eq><csymbol cd="latexml" id="S1a.p1.12.m4.1.2.2.cmml" xref="S1a.p1.12.m4.1.2.2">absent</csymbol><apply id="S1a.p1.12.m4.1.2.3.cmml" xref="S1a.p1.12.m4.1.2.3"><csymbol cd="ambiguous" id="S1a.p1.12.m4.1.2.3.1.cmml" xref="S1a.p1.12.m4.1.2.3">superscript</csymbol><apply id="S1a.p1.12.m4.1.2.3.2.cmml" xref="S1a.p1.12.m4.1.2.3"><csymbol cd="ambiguous" id="S1a.p1.12.m4.1.2.3.2.1.cmml" xref="S1a.p1.12.m4.1.2.3">subscript</csymbol><ci id="S1a.p1.12.m4.1.2.3.2.2.cmml" xref="S1a.p1.12.m4.1.2.3.2.2">𝒐</ci><ci id="S1a.p1.12.m4.1.2.3.2.3.cmml" xref="S1a.p1.12.m4.1.2.3.2.3">𝑗</ci></apply><ci id="S1a.p1.12.m4.1.1.1.1.cmml" xref="S1a.p1.12.m4.1.1.1.1">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1a.p1.12.m4.1c">=\bm{o}_{j}^{(L)}</annotation><annotation encoding="application/x-llamapun" id="S1a.p1.12.m4.1d">= bold_italic_o start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_L ) end_POSTSUPERSCRIPT</annotation></semantics></math>, <math id="S1a.p1.13.m5.4" class="ltx_Math" alttext="{\partial\alpha_{s,j}^{(L)}}/{\partial\langle Z_{q}\rangle_{s}}=" display="inline"><semantics id="S1a.p1.13.m5.4a"><mrow id="S1a.p1.13.m5.4b"><mo id="S1a.p1.13.m5.4.5" xref="S1a.p1.13.m5.4.5.cmml">∂</mo><msubsup id="S1a.p1.13.m5.4.6" xref="S1a.p1.13.m5.4.6.cmml"><mi id="S1a.p1.13.m5.4.6.2.2" xref="S1a.p1.13.m5.4.6.2.2.cmml">α</mi><mrow id="S1a.p1.13.m5.2.2.2.4" xref="S1a.p1.13.m5.2.2.2.3.cmml"><mi id="S1a.p1.13.m5.1.1.1.1" xref="S1a.p1.13.m5.1.1.1.1.cmml">s</mi><mo id="S1a.p1.13.m5.2.2.2.4.1" xref="S1a.p1.13.m5.2.2.2.3.cmml">,</mo><mi id="S1a.p1.13.m5.2.2.2.2" xref="S1a.p1.13.m5.2.2.2.2.cmml">j</mi></mrow><mrow id="S1a.p1.13.m5.3.3.1.3" xref="S1a.p1.13.m5.4.6.cmml"><mo stretchy="false" id="S1a.p1.13.m5.3.3.1.3.1" xref="S1a.p1.13.m5.4.6.cmml">(</mo><mi id="S1a.p1.13.m5.3.3.1.1" xref="S1a.p1.13.m5.3.3.1.1.cmml">L</mi><mo stretchy="false" id="S1a.p1.13.m5.3.3.1.3.2" xref="S1a.p1.13.m5.4.6.cmml">)</mo></mrow></msubsup><mo id="S1a.p1.13.m5.4.7" xref="S1a.p1.13.m5.4.7.cmml">/</mo><mo id="S1a.p1.13.m5.4.4" xref="S1a.p1.13.m5.4.4.cmml">∂</mo><msub id="S1a.p1.13.m5.4.8" xref="S1a.p1.13.m5.4.8.cmml"><mrow id="S1a.p1.13.m5.4.8.2" xref="S1a.p1.13.m5.4.8.2.cmml"><mo stretchy="false" id="S1a.p1.13.m5.4.8.2.1" xref="S1a.p1.13.m5.4.8.2.1.cmml">⟨</mo><msub id="S1a.p1.13.m5.4.8.2.2" xref="S1a.p1.13.m5.4.8.2.2.cmml"><mi id="S1a.p1.13.m5.4.8.2.2.2" xref="S1a.p1.13.m5.4.8.2.2.2.cmml">Z</mi><mi id="S1a.p1.13.m5.4.8.2.2.3" xref="S1a.p1.13.m5.4.8.2.2.3.cmml">q</mi></msub><mo stretchy="false" id="S1a.p1.13.m5.4.8.2.3" xref="S1a.p1.13.m5.4.8.2.3.cmml">⟩</mo></mrow><mi id="S1a.p1.13.m5.4.8.3" xref="S1a.p1.13.m5.4.8.3.cmml">s</mi></msub><mo id="S1a.p1.13.m5.4.9" xref="S1a.p1.13.m5.4.9.cmml">=</mo></mrow><annotation-xml encoding="MathML-Content" id="S1a.p1.13.m5.4c"><cerror id="S1a.p1.13.m5.4d"><csymbol cd="ambiguous" id="S1a.p1.13.m5.4e">fragments</csymbol><partialdiff id="S1a.p1.13.m5.4.5.cmml" xref="S1a.p1.13.m5.4.5"></partialdiff><apply id="S1a.p1.13.m5.4.6.cmml" xref="S1a.p1.13.m5.4.6"><csymbol cd="ambiguous" id="S1a.p1.13.m5.4.6.1.cmml" xref="S1a.p1.13.m5.4.6">superscript</csymbol><apply id="S1a.p1.13.m5.4.6.2.cmml" xref="S1a.p1.13.m5.4.6"><csymbol cd="ambiguous" id="S1a.p1.13.m5.4.6.2.1.cmml" xref="S1a.p1.13.m5.4.6">subscript</csymbol><ci id="S1a.p1.13.m5.4.6.2.2.cmml" xref="S1a.p1.13.m5.4.6.2.2">𝛼</ci><list id="S1a.p1.13.m5.2.2.2.3.cmml" xref="S1a.p1.13.m5.2.2.2.4"><ci id="S1a.p1.13.m5.1.1.1.1.cmml" xref="S1a.p1.13.m5.1.1.1.1">𝑠</ci><ci id="S1a.p1.13.m5.2.2.2.2.cmml" xref="S1a.p1.13.m5.2.2.2.2">𝑗</ci></list></apply><ci id="S1a.p1.13.m5.3.3.1.1.cmml" xref="S1a.p1.13.m5.3.3.1.1">𝐿</ci></apply><divide id="S1a.p1.13.m5.4.7.cmml" xref="S1a.p1.13.m5.4.7"></divide><partialdiff id="S1a.p1.13.m5.4.4.cmml" xref="S1a.p1.13.m5.4.4"></partialdiff><apply id="S1a.p1.13.m5.4.8.cmml" xref="S1a.p1.13.m5.4.8"><csymbol cd="ambiguous" id="S1a.p1.13.m5.4.8.1.cmml" xref="S1a.p1.13.m5.4.8">subscript</csymbol><cerror id="S1a.p1.13.m5.4.8.2.cmml" xref="S1a.p1.13.m5.4.8.2"><csymbol cd="ambiguous" id="S1a.p1.13.m5.4.8.2a.cmml" xref="S1a.p1.13.m5.4.8.2">fragments</csymbol><ci id="S1a.p1.13.m5.4.8.2.1.cmml" xref="S1a.p1.13.m5.4.8.2.1">⟨</ci><apply id="S1a.p1.13.m5.4.8.2.2.cmml" xref="S1a.p1.13.m5.4.8.2.2"><csymbol cd="ambiguous" id="S1a.p1.13.m5.4.8.2.2.1.cmml" xref="S1a.p1.13.m5.4.8.2.2">subscript</csymbol><ci id="S1a.p1.13.m5.4.8.2.2.2.cmml" xref="S1a.p1.13.m5.4.8.2.2.2">𝑍</ci><ci id="S1a.p1.13.m5.4.8.2.2.3.cmml" xref="S1a.p1.13.m5.4.8.2.2.3">𝑞</ci></apply><ci id="S1a.p1.13.m5.4.8.2.3.cmml" xref="S1a.p1.13.m5.4.8.2.3">⟩</ci></cerror><ci id="S1a.p1.13.m5.4.8.3.cmml" xref="S1a.p1.13.m5.4.8.3">𝑠</ci></apply><eq id="S1a.p1.13.m5.4.9.cmml" xref="S1a.p1.13.m5.4.9"></eq></cerror></annotation-xml><annotation encoding="application/x-tex" id="S1a.p1.13.m5.4f">{\partial\alpha_{s,j}^{(L)}}/{\partial\langle Z_{q}\rangle_{s}}=</annotation><annotation encoding="application/x-llamapun" id="S1a.p1.13.m5.4g">∂ italic_α start_POSTSUBSCRIPT italic_s , italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_L ) end_POSTSUPERSCRIPT / ∂ ⟨ italic_Z start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT ⟩ start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT =</annotation></semantics></math> <math id="S1a.p1.14.m6.4" class="ltx_Math" alttext="-\sum_{i=1}^{S_{m}}{\partial\alpha_{s,j}^{(L)}}/{\partial\langle Z_{k}\rangle_%
{i}}" display="inline"><semantics id="S1a.p1.14.m6.4a"><mrow id="S1a.p1.14.m6.4b"><mo id="S1a.p1.14.m6.4.5" xref="S1a.p1.14.m6.4.5.cmml">-</mo><msubsup id="S1a.p1.14.m6.4.6" xref="S1a.p1.14.m6.4.6.cmml"><mo largeop="true" symmetric="true" id="S1a.p1.14.m6.4.6.2.2" xref="S1a.p1.14.m6.4.6.2.2.cmml">∑</mo><mrow id="S1a.p1.14.m6.4.6.2.3" xref="S1a.p1.14.m6.4.6.2.3.cmml"><mi id="S1a.p1.14.m6.4.6.2.3.2" xref="S1a.p1.14.m6.4.6.2.3.2.cmml">i</mi><mo id="S1a.p1.14.m6.4.6.2.3.1" xref="S1a.p1.14.m6.4.6.2.3.1.cmml">=</mo><mn id="S1a.p1.14.m6.4.6.2.3.3" xref="S1a.p1.14.m6.4.6.2.3.3.cmml">1</mn></mrow><msub id="S1a.p1.14.m6.4.6.3" xref="S1a.p1.14.m6.4.6.3.cmml"><mi id="S1a.p1.14.m6.4.6.3.2" xref="S1a.p1.14.m6.4.6.3.2.cmml">S</mi><mi id="S1a.p1.14.m6.4.6.3.3" xref="S1a.p1.14.m6.4.6.3.3.cmml">m</mi></msub></msubsup><mo id="S1a.p1.14.m6.4.7" xref="S1a.p1.14.m6.4.7.cmml">∂</mo><msubsup id="S1a.p1.14.m6.4.8" xref="S1a.p1.14.m6.4.8.cmml"><mi id="S1a.p1.14.m6.4.8.2.2" xref="S1a.p1.14.m6.4.8.2.2.cmml">α</mi><mrow id="S1a.p1.14.m6.2.2.2.4" xref="S1a.p1.14.m6.2.2.2.3.cmml"><mi id="S1a.p1.14.m6.1.1.1.1" xref="S1a.p1.14.m6.1.1.1.1.cmml">s</mi><mo id="S1a.p1.14.m6.2.2.2.4.1" xref="S1a.p1.14.m6.2.2.2.3.cmml">,</mo><mi id="S1a.p1.14.m6.2.2.2.2" xref="S1a.p1.14.m6.2.2.2.2.cmml">j</mi></mrow><mrow id="S1a.p1.14.m6.3.3.1.3" xref="S1a.p1.14.m6.4.8.cmml"><mo stretchy="false" id="S1a.p1.14.m6.3.3.1.3.1" xref="S1a.p1.14.m6.4.8.cmml">(</mo><mi id="S1a.p1.14.m6.3.3.1.1" xref="S1a.p1.14.m6.3.3.1.1.cmml">L</mi><mo stretchy="false" id="S1a.p1.14.m6.3.3.1.3.2" xref="S1a.p1.14.m6.4.8.cmml">)</mo></mrow></msubsup><mo id="S1a.p1.14.m6.4.9" xref="S1a.p1.14.m6.4.9.cmml">/</mo><mo id="S1a.p1.14.m6.4.4" xref="S1a.p1.14.m6.4.4.cmml">∂</mo><msub id="S1a.p1.14.m6.4.10" xref="S1a.p1.14.m6.4.10.cmml"><mrow id="S1a.p1.14.m6.4.10.2" xref="S1a.p1.14.m6.4.10.2.cmml"><mo stretchy="false" id="S1a.p1.14.m6.4.10.2.1" xref="S1a.p1.14.m6.4.10.2.1.cmml">⟨</mo><msub id="S1a.p1.14.m6.4.10.2.2" xref="S1a.p1.14.m6.4.10.2.2.cmml"><mi id="S1a.p1.14.m6.4.10.2.2.2" xref="S1a.p1.14.m6.4.10.2.2.2.cmml">Z</mi><mi id="S1a.p1.14.m6.4.10.2.2.3" xref="S1a.p1.14.m6.4.10.2.2.3.cmml">k</mi></msub><mo stretchy="false" id="S1a.p1.14.m6.4.10.2.3" xref="S1a.p1.14.m6.4.10.2.3.cmml">⟩</mo></mrow><mi id="S1a.p1.14.m6.4.10.3" xref="S1a.p1.14.m6.4.10.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S1a.p1.14.m6.4c"><cerror id="S1a.p1.14.m6.4d"><csymbol cd="ambiguous" id="S1a.p1.14.m6.4e">fragments</csymbol><minus id="S1a.p1.14.m6.4.5.cmml" xref="S1a.p1.14.m6.4.5"></minus><apply id="S1a.p1.14.m6.4.6.cmml" xref="S1a.p1.14.m6.4.6"><csymbol cd="ambiguous" id="S1a.p1.14.m6.4.6.1.cmml" xref="S1a.p1.14.m6.4.6">superscript</csymbol><apply id="S1a.p1.14.m6.4.6.2.cmml" xref="S1a.p1.14.m6.4.6"><csymbol cd="ambiguous" id="S1a.p1.14.m6.4.6.2.1.cmml" xref="S1a.p1.14.m6.4.6">subscript</csymbol><sum id="S1a.p1.14.m6.4.6.2.2.cmml" xref="S1a.p1.14.m6.4.6.2.2"></sum><apply id="S1a.p1.14.m6.4.6.2.3.cmml" xref="S1a.p1.14.m6.4.6.2.3"><eq id="S1a.p1.14.m6.4.6.2.3.1.cmml" xref="S1a.p1.14.m6.4.6.2.3.1"></eq><ci id="S1a.p1.14.m6.4.6.2.3.2.cmml" xref="S1a.p1.14.m6.4.6.2.3.2">𝑖</ci><cn type="integer" id="S1a.p1.14.m6.4.6.2.3.3.cmml" xref="S1a.p1.14.m6.4.6.2.3.3">1</cn></apply></apply><apply id="S1a.p1.14.m6.4.6.3.cmml" xref="S1a.p1.14.m6.4.6.3"><csymbol cd="ambiguous" id="S1a.p1.14.m6.4.6.3.1.cmml" xref="S1a.p1.14.m6.4.6.3">subscript</csymbol><ci id="S1a.p1.14.m6.4.6.3.2.cmml" xref="S1a.p1.14.m6.4.6.3.2">𝑆</ci><ci id="S1a.p1.14.m6.4.6.3.3.cmml" xref="S1a.p1.14.m6.4.6.3.3">𝑚</ci></apply></apply><partialdiff id="S1a.p1.14.m6.4.7.cmml" xref="S1a.p1.14.m6.4.7"></partialdiff><apply id="S1a.p1.14.m6.4.8.cmml" xref="S1a.p1.14.m6.4.8"><csymbol cd="ambiguous" id="S1a.p1.14.m6.4.8.1.cmml" xref="S1a.p1.14.m6.4.8">superscript</csymbol><apply id="S1a.p1.14.m6.4.8.2.cmml" xref="S1a.p1.14.m6.4.8"><csymbol cd="ambiguous" id="S1a.p1.14.m6.4.8.2.1.cmml" xref="S1a.p1.14.m6.4.8">subscript</csymbol><ci id="S1a.p1.14.m6.4.8.2.2.cmml" xref="S1a.p1.14.m6.4.8.2.2">𝛼</ci><list id="S1a.p1.14.m6.2.2.2.3.cmml" xref="S1a.p1.14.m6.2.2.2.4"><ci id="S1a.p1.14.m6.1.1.1.1.cmml" xref="S1a.p1.14.m6.1.1.1.1">𝑠</ci><ci id="S1a.p1.14.m6.2.2.2.2.cmml" xref="S1a.p1.14.m6.2.2.2.2">𝑗</ci></list></apply><ci id="S1a.p1.14.m6.3.3.1.1.cmml" xref="S1a.p1.14.m6.3.3.1.1">𝐿</ci></apply><divide id="S1a.p1.14.m6.4.9.cmml" xref="S1a.p1.14.m6.4.9"></divide><partialdiff id="S1a.p1.14.m6.4.4.cmml" xref="S1a.p1.14.m6.4.4"></partialdiff><apply id="S1a.p1.14.m6.4.10.cmml" xref="S1a.p1.14.m6.4.10"><csymbol cd="ambiguous" id="S1a.p1.14.m6.4.10.1.cmml" xref="S1a.p1.14.m6.4.10">subscript</csymbol><cerror id="S1a.p1.14.m6.4.10.2.cmml" xref="S1a.p1.14.m6.4.10.2"><csymbol cd="ambiguous" id="S1a.p1.14.m6.4.10.2a.cmml" xref="S1a.p1.14.m6.4.10.2">fragments</csymbol><ci id="S1a.p1.14.m6.4.10.2.1.cmml" xref="S1a.p1.14.m6.4.10.2.1">⟨</ci><apply id="S1a.p1.14.m6.4.10.2.2.cmml" xref="S1a.p1.14.m6.4.10.2.2"><csymbol cd="ambiguous" id="S1a.p1.14.m6.4.10.2.2.1.cmml" xref="S1a.p1.14.m6.4.10.2.2">subscript</csymbol><ci id="S1a.p1.14.m6.4.10.2.2.2.cmml" xref="S1a.p1.14.m6.4.10.2.2.2">𝑍</ci><ci id="S1a.p1.14.m6.4.10.2.2.3.cmml" xref="S1a.p1.14.m6.4.10.2.2.3">𝑘</ci></apply><ci id="S1a.p1.14.m6.4.10.2.3.cmml" xref="S1a.p1.14.m6.4.10.2.3">⟩</ci></cerror><ci id="S1a.p1.14.m6.4.10.3.cmml" xref="S1a.p1.14.m6.4.10.3">𝑖</ci></apply></cerror></annotation-xml><annotation encoding="application/x-tex" id="S1a.p1.14.m6.4f">-\sum_{i=1}^{S_{m}}{\partial\alpha_{s,j}^{(L)}}/{\partial\langle Z_{k}\rangle_%
{i}}</annotation><annotation encoding="application/x-llamapun" id="S1a.p1.14.m6.4g">- ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_S start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT end_POSTSUPERSCRIPT ∂ italic_α start_POSTSUBSCRIPT italic_s , italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_L ) end_POSTSUPERSCRIPT / ∂ ⟨ italic_Z start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ⟩ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and</p>
<table id="S1.EGx14" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S1.Ex4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S1.Ex4.m1.7" class="ltx_Math" alttext="\displaystyle\frac{\partial\alpha_{s,j}^{(L)}}{\partial\langle Z_{k}\rangle_{i%
}}=-\alpha_{s,j}^{(L)}" display="inline"><semantics id="S1.Ex4.m1.7a"><mrow id="S1.Ex4.m1.7.8" xref="S1.Ex4.m1.7.8.cmml"><mstyle displaystyle="true" id="S1.Ex4.m1.4.4" xref="S1.Ex4.m1.4.4.cmml"><mfrac id="S1.Ex4.m1.4.4a" xref="S1.Ex4.m1.4.4.cmml"><mrow id="S1.Ex4.m1.3.3.3" xref="S1.Ex4.m1.3.3.3.cmml"><mo id="S1.Ex4.m1.3.3.3.4" xref="S1.Ex4.m1.3.3.3.4.cmml">∂</mo><mo id="S1.Ex4.m1.3.3.3a" xref="S1.Ex4.m1.3.3.3.cmml">⁡</mo><msubsup id="S1.Ex4.m1.3.3.3.5" xref="S1.Ex4.m1.3.3.3.5.cmml"><mi id="S1.Ex4.m1.3.3.3.5.2.2" xref="S1.Ex4.m1.3.3.3.5.2.2.cmml">α</mi><mrow id="S1.Ex4.m1.2.2.2.2.2.4" xref="S1.Ex4.m1.2.2.2.2.2.3.cmml"><mi id="S1.Ex4.m1.1.1.1.1.1.1" xref="S1.Ex4.m1.1.1.1.1.1.1.cmml">s</mi><mo id="S1.Ex4.m1.2.2.2.2.2.4.1" xref="S1.Ex4.m1.2.2.2.2.2.3.cmml">,</mo><mi id="S1.Ex4.m1.2.2.2.2.2.2" xref="S1.Ex4.m1.2.2.2.2.2.2.cmml">j</mi></mrow><mrow id="S1.Ex4.m1.3.3.3.3.1.3" xref="S1.Ex4.m1.3.3.3.5.cmml"><mo stretchy="false" id="S1.Ex4.m1.3.3.3.3.1.3.1" xref="S1.Ex4.m1.3.3.3.5.cmml">(</mo><mi id="S1.Ex4.m1.3.3.3.3.1.1" xref="S1.Ex4.m1.3.3.3.3.1.1.cmml">L</mi><mo stretchy="false" id="S1.Ex4.m1.3.3.3.3.1.3.2" xref="S1.Ex4.m1.3.3.3.5.cmml">)</mo></mrow></msubsup></mrow><mrow id="S1.Ex4.m1.4.4.4" xref="S1.Ex4.m1.4.4.4.cmml"><mo id="S1.Ex4.m1.4.4.4.1" xref="S1.Ex4.m1.4.4.4.1.cmml">∂</mo><msub id="S1.Ex4.m1.4.4.4.2" xref="S1.Ex4.m1.4.4.4.2.cmml"><mrow id="S1.Ex4.m1.4.4.4.2.2" xref="S1.Ex4.m1.4.4.4.2.2.cmml"><mo stretchy="false" id="S1.Ex4.m1.4.4.4.2.2.1" xref="S1.Ex4.m1.4.4.4.2.2.1.cmml">⟨</mo><msub id="S1.Ex4.m1.4.4.4.2.2.2" xref="S1.Ex4.m1.4.4.4.2.2.2.cmml"><mi id="S1.Ex4.m1.4.4.4.2.2.2.2" xref="S1.Ex4.m1.4.4.4.2.2.2.2.cmml">Z</mi><mi id="S1.Ex4.m1.4.4.4.2.2.2.3" xref="S1.Ex4.m1.4.4.4.2.2.2.3.cmml">k</mi></msub><mo stretchy="false" id="S1.Ex4.m1.4.4.4.2.2.3" xref="S1.Ex4.m1.4.4.4.2.2.3.cmml">⟩</mo></mrow><mi id="S1.Ex4.m1.4.4.4.2.3" xref="S1.Ex4.m1.4.4.4.2.3.cmml">i</mi></msub></mrow></mfrac></mstyle><mo id="S1.Ex4.m1.7.8.1" xref="S1.Ex4.m1.7.8.1.cmml">=</mo><mrow id="S1.Ex4.m1.7.8.2" xref="S1.Ex4.m1.7.8.2.cmml"><mo id="S1.Ex4.m1.7.8.2.1" xref="S1.Ex4.m1.7.8.2.1.cmml">-</mo><msubsup id="S1.Ex4.m1.7.8.2.2" xref="S1.Ex4.m1.7.8.2.2.cmml"><mi id="S1.Ex4.m1.7.8.2.2.2.2" xref="S1.Ex4.m1.7.8.2.2.2.2.cmml">α</mi><mrow id="S1.Ex4.m1.6.6.2.4" xref="S1.Ex4.m1.6.6.2.3.cmml"><mi id="S1.Ex4.m1.5.5.1.1" xref="S1.Ex4.m1.5.5.1.1.cmml">s</mi><mo id="S1.Ex4.m1.6.6.2.4.1" xref="S1.Ex4.m1.6.6.2.3.cmml">,</mo><mi id="S1.Ex4.m1.6.6.2.2" xref="S1.Ex4.m1.6.6.2.2.cmml">j</mi></mrow><mrow id="S1.Ex4.m1.7.7.1.3" xref="S1.Ex4.m1.7.8.2.2.cmml"><mo stretchy="false" id="S1.Ex4.m1.7.7.1.3.1" xref="S1.Ex4.m1.7.8.2.2.cmml">(</mo><mi id="S1.Ex4.m1.7.7.1.1" xref="S1.Ex4.m1.7.7.1.1.cmml">L</mi><mo stretchy="false" id="S1.Ex4.m1.7.7.1.3.2" xref="S1.Ex4.m1.7.8.2.2.cmml">)</mo></mrow></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.Ex4.m1.7b"><apply id="S1.Ex4.m1.7.8.cmml" xref="S1.Ex4.m1.7.8"><eq id="S1.Ex4.m1.7.8.1.cmml" xref="S1.Ex4.m1.7.8.1"></eq><apply id="S1.Ex4.m1.4.4.cmml" xref="S1.Ex4.m1.4.4"><divide id="S1.Ex4.m1.4.4.5.cmml" xref="S1.Ex4.m1.4.4"></divide><apply id="S1.Ex4.m1.3.3.3.cmml" xref="S1.Ex4.m1.3.3.3"><partialdiff id="S1.Ex4.m1.3.3.3.4.cmml" xref="S1.Ex4.m1.3.3.3.4"></partialdiff><apply id="S1.Ex4.m1.3.3.3.5.cmml" xref="S1.Ex4.m1.3.3.3.5"><csymbol cd="ambiguous" id="S1.Ex4.m1.3.3.3.5.1.cmml" xref="S1.Ex4.m1.3.3.3.5">superscript</csymbol><apply id="S1.Ex4.m1.3.3.3.5.2.cmml" xref="S1.Ex4.m1.3.3.3.5"><csymbol cd="ambiguous" id="S1.Ex4.m1.3.3.3.5.2.1.cmml" xref="S1.Ex4.m1.3.3.3.5">subscript</csymbol><ci id="S1.Ex4.m1.3.3.3.5.2.2.cmml" xref="S1.Ex4.m1.3.3.3.5.2.2">𝛼</ci><list id="S1.Ex4.m1.2.2.2.2.2.3.cmml" xref="S1.Ex4.m1.2.2.2.2.2.4"><ci id="S1.Ex4.m1.1.1.1.1.1.1.cmml" xref="S1.Ex4.m1.1.1.1.1.1.1">𝑠</ci><ci id="S1.Ex4.m1.2.2.2.2.2.2.cmml" xref="S1.Ex4.m1.2.2.2.2.2.2">𝑗</ci></list></apply><ci id="S1.Ex4.m1.3.3.3.3.1.1.cmml" xref="S1.Ex4.m1.3.3.3.3.1.1">𝐿</ci></apply></apply><cerror id="S1.Ex4.m1.4.4.4.cmml" xref="S1.Ex4.m1.4.4.4"><csymbol cd="ambiguous" id="S1.Ex4.m1.4.4.4a.cmml" xref="S1.Ex4.m1.4.4.4">fragments</csymbol><partialdiff id="S1.Ex4.m1.4.4.4.1.cmml" xref="S1.Ex4.m1.4.4.4.1"></partialdiff><apply id="S1.Ex4.m1.4.4.4.2.cmml" xref="S1.Ex4.m1.4.4.4.2"><csymbol cd="ambiguous" id="S1.Ex4.m1.4.4.4.2.1.cmml" xref="S1.Ex4.m1.4.4.4.2">subscript</csymbol><cerror id="S1.Ex4.m1.4.4.4.2.2.cmml" xref="S1.Ex4.m1.4.4.4.2.2"><csymbol cd="ambiguous" id="S1.Ex4.m1.4.4.4.2.2a.cmml" xref="S1.Ex4.m1.4.4.4.2.2">fragments</csymbol><ci id="S1.Ex4.m1.4.4.4.2.2.1.cmml" xref="S1.Ex4.m1.4.4.4.2.2.1">⟨</ci><apply id="S1.Ex4.m1.4.4.4.2.2.2.cmml" xref="S1.Ex4.m1.4.4.4.2.2.2"><csymbol cd="ambiguous" id="S1.Ex4.m1.4.4.4.2.2.2.1.cmml" xref="S1.Ex4.m1.4.4.4.2.2.2">subscript</csymbol><ci id="S1.Ex4.m1.4.4.4.2.2.2.2.cmml" xref="S1.Ex4.m1.4.4.4.2.2.2.2">𝑍</ci><ci id="S1.Ex4.m1.4.4.4.2.2.2.3.cmml" xref="S1.Ex4.m1.4.4.4.2.2.2.3">𝑘</ci></apply><ci id="S1.Ex4.m1.4.4.4.2.2.3.cmml" xref="S1.Ex4.m1.4.4.4.2.2.3">⟩</ci></cerror><ci id="S1.Ex4.m1.4.4.4.2.3.cmml" xref="S1.Ex4.m1.4.4.4.2.3">𝑖</ci></apply></cerror></apply><apply id="S1.Ex4.m1.7.8.2.cmml" xref="S1.Ex4.m1.7.8.2"><minus id="S1.Ex4.m1.7.8.2.1.cmml" xref="S1.Ex4.m1.7.8.2.1"></minus><apply id="S1.Ex4.m1.7.8.2.2.cmml" xref="S1.Ex4.m1.7.8.2.2"><csymbol cd="ambiguous" id="S1.Ex4.m1.7.8.2.2.1.cmml" xref="S1.Ex4.m1.7.8.2.2">superscript</csymbol><apply id="S1.Ex4.m1.7.8.2.2.2.cmml" xref="S1.Ex4.m1.7.8.2.2"><csymbol cd="ambiguous" id="S1.Ex4.m1.7.8.2.2.2.1.cmml" xref="S1.Ex4.m1.7.8.2.2">subscript</csymbol><ci id="S1.Ex4.m1.7.8.2.2.2.2.cmml" xref="S1.Ex4.m1.7.8.2.2.2.2">𝛼</ci><list id="S1.Ex4.m1.6.6.2.3.cmml" xref="S1.Ex4.m1.6.6.2.4"><ci id="S1.Ex4.m1.5.5.1.1.cmml" xref="S1.Ex4.m1.5.5.1.1">𝑠</ci><ci id="S1.Ex4.m1.6.6.2.2.cmml" xref="S1.Ex4.m1.6.6.2.2">𝑗</ci></list></apply><ci id="S1.Ex4.m1.7.7.1.1.cmml" xref="S1.Ex4.m1.7.7.1.1">𝐿</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.Ex4.m1.7c">\displaystyle\frac{\partial\alpha_{s,j}^{(L)}}{\partial\langle Z_{k}\rangle_{i%
}}=-\alpha_{s,j}^{(L)}</annotation><annotation encoding="application/x-llamapun" id="S1.Ex4.m1.7d">divide start_ARG ∂ italic_α start_POSTSUBSCRIPT italic_s , italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_L ) end_POSTSUPERSCRIPT end_ARG start_ARG ∂ ⟨ italic_Z start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ⟩ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_ARG = - italic_α start_POSTSUBSCRIPT italic_s , italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_L ) end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S1.Ex4.m2.4" class="ltx_Math" alttext="\displaystyle\left(\alpha_{s,i}^{(L)}-\delta_{ij}\right)\cdot 2\left(\langle Z%
_{q}\rangle_{s}-\langle Z_{k}\rangle_{i}\right)," display="inline"><semantics id="S1.Ex4.m2.4a"><mrow id="S1.Ex4.m2.4.4.1" xref="S1.Ex4.m2.4.4.1.1.cmml"><mrow id="S1.Ex4.m2.4.4.1.1" xref="S1.Ex4.m2.4.4.1.1.cmml"><mrow id="S1.Ex4.m2.4.4.1.1.1" xref="S1.Ex4.m2.4.4.1.1.1.cmml"><mrow id="S1.Ex4.m2.4.4.1.1.1.1.1" xref="S1.Ex4.m2.4.4.1.1.1.1.1.1.cmml"><mo id="S1.Ex4.m2.4.4.1.1.1.1.1.2" xref="S1.Ex4.m2.4.4.1.1.1.1.1.1.cmml">(</mo><mrow id="S1.Ex4.m2.4.4.1.1.1.1.1.1" xref="S1.Ex4.m2.4.4.1.1.1.1.1.1.cmml"><msubsup id="S1.Ex4.m2.4.4.1.1.1.1.1.1.2" xref="S1.Ex4.m2.4.4.1.1.1.1.1.1.2.cmml"><mi id="S1.Ex4.m2.4.4.1.1.1.1.1.1.2.2.2" xref="S1.Ex4.m2.4.4.1.1.1.1.1.1.2.2.2.cmml">α</mi><mrow id="S1.Ex4.m2.2.2.2.4" xref="S1.Ex4.m2.2.2.2.3.cmml"><mi id="S1.Ex4.m2.1.1.1.1" xref="S1.Ex4.m2.1.1.1.1.cmml">s</mi><mo id="S1.Ex4.m2.2.2.2.4.1" xref="S1.Ex4.m2.2.2.2.3.cmml">,</mo><mi id="S1.Ex4.m2.2.2.2.2" xref="S1.Ex4.m2.2.2.2.2.cmml">i</mi></mrow><mrow id="S1.Ex4.m2.3.3.1.3" xref="S1.Ex4.m2.4.4.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S1.Ex4.m2.3.3.1.3.1" xref="S1.Ex4.m2.4.4.1.1.1.1.1.1.2.cmml">(</mo><mi id="S1.Ex4.m2.3.3.1.1" xref="S1.Ex4.m2.3.3.1.1.cmml">L</mi><mo stretchy="false" id="S1.Ex4.m2.3.3.1.3.2" xref="S1.Ex4.m2.4.4.1.1.1.1.1.1.2.cmml">)</mo></mrow></msubsup><mo id="S1.Ex4.m2.4.4.1.1.1.1.1.1.1" xref="S1.Ex4.m2.4.4.1.1.1.1.1.1.1.cmml">-</mo><msub id="S1.Ex4.m2.4.4.1.1.1.1.1.1.3" xref="S1.Ex4.m2.4.4.1.1.1.1.1.1.3.cmml"><mi id="S1.Ex4.m2.4.4.1.1.1.1.1.1.3.2" xref="S1.Ex4.m2.4.4.1.1.1.1.1.1.3.2.cmml">δ</mi><mrow id="S1.Ex4.m2.4.4.1.1.1.1.1.1.3.3" xref="S1.Ex4.m2.4.4.1.1.1.1.1.1.3.3.cmml"><mi id="S1.Ex4.m2.4.4.1.1.1.1.1.1.3.3.2" xref="S1.Ex4.m2.4.4.1.1.1.1.1.1.3.3.2.cmml">i</mi><mo id="S1.Ex4.m2.4.4.1.1.1.1.1.1.3.3.1" xref="S1.Ex4.m2.4.4.1.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S1.Ex4.m2.4.4.1.1.1.1.1.1.3.3.3" xref="S1.Ex4.m2.4.4.1.1.1.1.1.1.3.3.3.cmml">j</mi></mrow></msub></mrow><mo id="S1.Ex4.m2.4.4.1.1.1.1.1.3" xref="S1.Ex4.m2.4.4.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S1.Ex4.m2.4.4.1.1.1.2" xref="S1.Ex4.m2.4.4.1.1.1.2.cmml">⋅</mo><mn id="S1.Ex4.m2.4.4.1.1.1.3" xref="S1.Ex4.m2.4.4.1.1.1.3.cmml">2</mn></mrow><mo id="S1.Ex4.m2.4.4.1.1.3" xref="S1.Ex4.m2.4.4.1.1.3.cmml">⁢</mo><mrow id="S1.Ex4.m2.4.4.1.1.2.1" xref="S1.Ex4.m2.4.4.1.1.2.1.1.cmml"><mo id="S1.Ex4.m2.4.4.1.1.2.1.2" xref="S1.Ex4.m2.4.4.1.1.2.1.1.cmml">(</mo><mrow id="S1.Ex4.m2.4.4.1.1.2.1.1" xref="S1.Ex4.m2.4.4.1.1.2.1.1.cmml"><msub id="S1.Ex4.m2.4.4.1.1.2.1.1.1" xref="S1.Ex4.m2.4.4.1.1.2.1.1.1.cmml"><mrow id="S1.Ex4.m2.4.4.1.1.2.1.1.1.1.1" xref="S1.Ex4.m2.4.4.1.1.2.1.1.1.1.2.cmml"><mo stretchy="false" id="S1.Ex4.m2.4.4.1.1.2.1.1.1.1.1.2" xref="S1.Ex4.m2.4.4.1.1.2.1.1.1.1.2.1.cmml">⟨</mo><msub id="S1.Ex4.m2.4.4.1.1.2.1.1.1.1.1.1" xref="S1.Ex4.m2.4.4.1.1.2.1.1.1.1.1.1.cmml"><mi id="S1.Ex4.m2.4.4.1.1.2.1.1.1.1.1.1.2" xref="S1.Ex4.m2.4.4.1.1.2.1.1.1.1.1.1.2.cmml">Z</mi><mi id="S1.Ex4.m2.4.4.1.1.2.1.1.1.1.1.1.3" xref="S1.Ex4.m2.4.4.1.1.2.1.1.1.1.1.1.3.cmml">q</mi></msub><mo stretchy="false" id="S1.Ex4.m2.4.4.1.1.2.1.1.1.1.1.3" xref="S1.Ex4.m2.4.4.1.1.2.1.1.1.1.2.1.cmml">⟩</mo></mrow><mi id="S1.Ex4.m2.4.4.1.1.2.1.1.1.3" xref="S1.Ex4.m2.4.4.1.1.2.1.1.1.3.cmml">s</mi></msub><mo id="S1.Ex4.m2.4.4.1.1.2.1.1.3" xref="S1.Ex4.m2.4.4.1.1.2.1.1.3.cmml">-</mo><msub id="S1.Ex4.m2.4.4.1.1.2.1.1.2" xref="S1.Ex4.m2.4.4.1.1.2.1.1.2.cmml"><mrow id="S1.Ex4.m2.4.4.1.1.2.1.1.2.1.1" xref="S1.Ex4.m2.4.4.1.1.2.1.1.2.1.2.cmml"><mo stretchy="false" id="S1.Ex4.m2.4.4.1.1.2.1.1.2.1.1.2" xref="S1.Ex4.m2.4.4.1.1.2.1.1.2.1.2.1.cmml">⟨</mo><msub id="S1.Ex4.m2.4.4.1.1.2.1.1.2.1.1.1" xref="S1.Ex4.m2.4.4.1.1.2.1.1.2.1.1.1.cmml"><mi id="S1.Ex4.m2.4.4.1.1.2.1.1.2.1.1.1.2" xref="S1.Ex4.m2.4.4.1.1.2.1.1.2.1.1.1.2.cmml">Z</mi><mi id="S1.Ex4.m2.4.4.1.1.2.1.1.2.1.1.1.3" xref="S1.Ex4.m2.4.4.1.1.2.1.1.2.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="S1.Ex4.m2.4.4.1.1.2.1.1.2.1.1.3" xref="S1.Ex4.m2.4.4.1.1.2.1.1.2.1.2.1.cmml">⟩</mo></mrow><mi id="S1.Ex4.m2.4.4.1.1.2.1.1.2.3" xref="S1.Ex4.m2.4.4.1.1.2.1.1.2.3.cmml">i</mi></msub></mrow><mo id="S1.Ex4.m2.4.4.1.1.2.1.3" xref="S1.Ex4.m2.4.4.1.1.2.1.1.cmml">)</mo></mrow></mrow><mo id="S1.Ex4.m2.4.4.1.2" xref="S1.Ex4.m2.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S1.Ex4.m2.4b"><apply id="S1.Ex4.m2.4.4.1.1.cmml" xref="S1.Ex4.m2.4.4.1"><times id="S1.Ex4.m2.4.4.1.1.3.cmml" xref="S1.Ex4.m2.4.4.1.1.3"></times><apply id="S1.Ex4.m2.4.4.1.1.1.cmml" xref="S1.Ex4.m2.4.4.1.1.1"><ci id="S1.Ex4.m2.4.4.1.1.1.2.cmml" xref="S1.Ex4.m2.4.4.1.1.1.2">⋅</ci><apply id="S1.Ex4.m2.4.4.1.1.1.1.1.1.cmml" xref="S1.Ex4.m2.4.4.1.1.1.1.1"><minus id="S1.Ex4.m2.4.4.1.1.1.1.1.1.1.cmml" xref="S1.Ex4.m2.4.4.1.1.1.1.1.1.1"></minus><apply id="S1.Ex4.m2.4.4.1.1.1.1.1.1.2.cmml" xref="S1.Ex4.m2.4.4.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S1.Ex4.m2.4.4.1.1.1.1.1.1.2.1.cmml" xref="S1.Ex4.m2.4.4.1.1.1.1.1.1.2">superscript</csymbol><apply id="S1.Ex4.m2.4.4.1.1.1.1.1.1.2.2.cmml" xref="S1.Ex4.m2.4.4.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S1.Ex4.m2.4.4.1.1.1.1.1.1.2.2.1.cmml" xref="S1.Ex4.m2.4.4.1.1.1.1.1.1.2">subscript</csymbol><ci id="S1.Ex4.m2.4.4.1.1.1.1.1.1.2.2.2.cmml" xref="S1.Ex4.m2.4.4.1.1.1.1.1.1.2.2.2">𝛼</ci><list id="S1.Ex4.m2.2.2.2.3.cmml" xref="S1.Ex4.m2.2.2.2.4"><ci id="S1.Ex4.m2.1.1.1.1.cmml" xref="S1.Ex4.m2.1.1.1.1">𝑠</ci><ci id="S1.Ex4.m2.2.2.2.2.cmml" xref="S1.Ex4.m2.2.2.2.2">𝑖</ci></list></apply><ci id="S1.Ex4.m2.3.3.1.1.cmml" xref="S1.Ex4.m2.3.3.1.1">𝐿</ci></apply><apply id="S1.Ex4.m2.4.4.1.1.1.1.1.1.3.cmml" xref="S1.Ex4.m2.4.4.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S1.Ex4.m2.4.4.1.1.1.1.1.1.3.1.cmml" xref="S1.Ex4.m2.4.4.1.1.1.1.1.1.3">subscript</csymbol><ci id="S1.Ex4.m2.4.4.1.1.1.1.1.1.3.2.cmml" xref="S1.Ex4.m2.4.4.1.1.1.1.1.1.3.2">𝛿</ci><apply id="S1.Ex4.m2.4.4.1.1.1.1.1.1.3.3.cmml" xref="S1.Ex4.m2.4.4.1.1.1.1.1.1.3.3"><times id="S1.Ex4.m2.4.4.1.1.1.1.1.1.3.3.1.cmml" xref="S1.Ex4.m2.4.4.1.1.1.1.1.1.3.3.1"></times><ci id="S1.Ex4.m2.4.4.1.1.1.1.1.1.3.3.2.cmml" xref="S1.Ex4.m2.4.4.1.1.1.1.1.1.3.3.2">𝑖</ci><ci id="S1.Ex4.m2.4.4.1.1.1.1.1.1.3.3.3.cmml" xref="S1.Ex4.m2.4.4.1.1.1.1.1.1.3.3.3">𝑗</ci></apply></apply></apply><cn type="integer" id="S1.Ex4.m2.4.4.1.1.1.3.cmml" xref="S1.Ex4.m2.4.4.1.1.1.3">2</cn></apply><apply id="S1.Ex4.m2.4.4.1.1.2.1.1.cmml" xref="S1.Ex4.m2.4.4.1.1.2.1"><minus id="S1.Ex4.m2.4.4.1.1.2.1.1.3.cmml" xref="S1.Ex4.m2.4.4.1.1.2.1.1.3"></minus><apply id="S1.Ex4.m2.4.4.1.1.2.1.1.1.cmml" xref="S1.Ex4.m2.4.4.1.1.2.1.1.1"><csymbol cd="ambiguous" id="S1.Ex4.m2.4.4.1.1.2.1.1.1.2.cmml" xref="S1.Ex4.m2.4.4.1.1.2.1.1.1">subscript</csymbol><apply id="S1.Ex4.m2.4.4.1.1.2.1.1.1.1.2.cmml" xref="S1.Ex4.m2.4.4.1.1.2.1.1.1.1.1"><csymbol cd="latexml" id="S1.Ex4.m2.4.4.1.1.2.1.1.1.1.2.1.cmml" xref="S1.Ex4.m2.4.4.1.1.2.1.1.1.1.1.2">delimited-⟨⟩</csymbol><apply id="S1.Ex4.m2.4.4.1.1.2.1.1.1.1.1.1.cmml" xref="S1.Ex4.m2.4.4.1.1.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S1.Ex4.m2.4.4.1.1.2.1.1.1.1.1.1.1.cmml" xref="S1.Ex4.m2.4.4.1.1.2.1.1.1.1.1.1">subscript</csymbol><ci id="S1.Ex4.m2.4.4.1.1.2.1.1.1.1.1.1.2.cmml" xref="S1.Ex4.m2.4.4.1.1.2.1.1.1.1.1.1.2">𝑍</ci><ci id="S1.Ex4.m2.4.4.1.1.2.1.1.1.1.1.1.3.cmml" xref="S1.Ex4.m2.4.4.1.1.2.1.1.1.1.1.1.3">𝑞</ci></apply></apply><ci id="S1.Ex4.m2.4.4.1.1.2.1.1.1.3.cmml" xref="S1.Ex4.m2.4.4.1.1.2.1.1.1.3">𝑠</ci></apply><apply id="S1.Ex4.m2.4.4.1.1.2.1.1.2.cmml" xref="S1.Ex4.m2.4.4.1.1.2.1.1.2"><csymbol cd="ambiguous" id="S1.Ex4.m2.4.4.1.1.2.1.1.2.2.cmml" xref="S1.Ex4.m2.4.4.1.1.2.1.1.2">subscript</csymbol><apply id="S1.Ex4.m2.4.4.1.1.2.1.1.2.1.2.cmml" xref="S1.Ex4.m2.4.4.1.1.2.1.1.2.1.1"><csymbol cd="latexml" id="S1.Ex4.m2.4.4.1.1.2.1.1.2.1.2.1.cmml" xref="S1.Ex4.m2.4.4.1.1.2.1.1.2.1.1.2">delimited-⟨⟩</csymbol><apply id="S1.Ex4.m2.4.4.1.1.2.1.1.2.1.1.1.cmml" xref="S1.Ex4.m2.4.4.1.1.2.1.1.2.1.1.1"><csymbol cd="ambiguous" id="S1.Ex4.m2.4.4.1.1.2.1.1.2.1.1.1.1.cmml" xref="S1.Ex4.m2.4.4.1.1.2.1.1.2.1.1.1">subscript</csymbol><ci id="S1.Ex4.m2.4.4.1.1.2.1.1.2.1.1.1.2.cmml" xref="S1.Ex4.m2.4.4.1.1.2.1.1.2.1.1.1.2">𝑍</ci><ci id="S1.Ex4.m2.4.4.1.1.2.1.1.2.1.1.1.3.cmml" xref="S1.Ex4.m2.4.4.1.1.2.1.1.2.1.1.1.3">𝑘</ci></apply></apply><ci id="S1.Ex4.m2.4.4.1.1.2.1.1.2.3.cmml" xref="S1.Ex4.m2.4.4.1.1.2.1.1.2.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.Ex4.m2.4c">\displaystyle\left(\alpha_{s,i}^{(L)}-\delta_{ij}\right)\cdot 2\left(\langle Z%
_{q}\rangle_{s}-\langle Z_{k}\rangle_{i}\right),</annotation><annotation encoding="application/x-llamapun" id="S1.Ex4.m2.4d">( italic_α start_POSTSUBSCRIPT italic_s , italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_L ) end_POSTSUPERSCRIPT - italic_δ start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT ) ⋅ 2 ( ⟨ italic_Z start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT ⟩ start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT - ⟨ italic_Z start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ⟩ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S1.E6a"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S1.E6a.m1.4" class="ltx_Math" alttext="\displaystyle\delta_{ij}=\begin{cases}1,&amp;i=j\\
0,&amp;\text{otherwise}.\end{cases}" display="inline"><semantics id="S1.E6a.m1.4a"><mrow id="S1.E6a.m1.4.5" xref="S1.E6a.m1.4.5.cmml"><msub id="S1.E6a.m1.4.5.2" xref="S1.E6a.m1.4.5.2.cmml"><mi id="S1.E6a.m1.4.5.2.2" xref="S1.E6a.m1.4.5.2.2.cmml">δ</mi><mrow id="S1.E6a.m1.4.5.2.3" xref="S1.E6a.m1.4.5.2.3.cmml"><mi id="S1.E6a.m1.4.5.2.3.2" xref="S1.E6a.m1.4.5.2.3.2.cmml">i</mi><mo id="S1.E6a.m1.4.5.2.3.1" xref="S1.E6a.m1.4.5.2.3.1.cmml">⁢</mo><mi id="S1.E6a.m1.4.5.2.3.3" xref="S1.E6a.m1.4.5.2.3.3.cmml">j</mi></mrow></msub><mo id="S1.E6a.m1.4.5.1" xref="S1.E6a.m1.4.5.1.cmml">=</mo><mrow id="S1.E6a.m1.4.4a" xref="S1.E6a.m1.4.5.3.1.cmml"><mo id="S1.E6a.m1.4.4a.5" xref="S1.E6a.m1.4.5.3.1.1.cmml">{</mo><mtable columnspacing="5pt" rowspacing="0pt" id="S1.E6a.m1.4.4.4a" xref="S1.E6a.m1.4.5.3.1.cmml"><mtr id="S1.E6a.m1.4.4.4aa" xref="S1.E6a.m1.4.5.3.1.cmml"><mtd columnalign="left" id="S1.E6a.m1.4.4.4ab" xref="S1.E6a.m1.4.5.3.1.cmml"><mrow id="S1.E6a.m1.1.1.1.1.1.1.3" xref="S1.E6a.m1.4.5.3.1.cmml"><mn id="S1.E6a.m1.1.1.1.1.1.1.1" xref="S1.E6a.m1.1.1.1.1.1.1.1.cmml">1</mn><mo id="S1.E6a.m1.1.1.1.1.1.1.3.1" xref="S1.E6a.m1.4.5.3.1.cmml">,</mo></mrow></mtd><mtd columnalign="left" id="S1.E6a.m1.4.4.4ac" xref="S1.E6a.m1.4.5.3.1.cmml"><mrow id="S1.E6a.m1.2.2.2.2.2.1" xref="S1.E6a.m1.2.2.2.2.2.1.cmml"><mi id="S1.E6a.m1.2.2.2.2.2.1.2" xref="S1.E6a.m1.2.2.2.2.2.1.2.cmml">i</mi><mo id="S1.E6a.m1.2.2.2.2.2.1.1" xref="S1.E6a.m1.2.2.2.2.2.1.1.cmml">=</mo><mi id="S1.E6a.m1.2.2.2.2.2.1.3" xref="S1.E6a.m1.2.2.2.2.2.1.3.cmml">j</mi></mrow></mtd></mtr><mtr id="S1.E6a.m1.4.4.4ad" xref="S1.E6a.m1.4.5.3.1.cmml"><mtd columnalign="left" id="S1.E6a.m1.4.4.4ae" xref="S1.E6a.m1.4.5.3.1.cmml"><mrow id="S1.E6a.m1.3.3.3.3.1.1.3" xref="S1.E6a.m1.4.5.3.1.cmml"><mn id="S1.E6a.m1.3.3.3.3.1.1.1" xref="S1.E6a.m1.3.3.3.3.1.1.1.cmml">0</mn><mo id="S1.E6a.m1.3.3.3.3.1.1.3.1" xref="S1.E6a.m1.4.5.3.1.cmml">,</mo></mrow></mtd><mtd columnalign="left" id="S1.E6a.m1.4.4.4af" xref="S1.E6a.m1.4.5.3.1.cmml"><mrow id="S1.E6a.m1.4.4.4.4.2.1.3" xref="S1.E6a.m1.4.4.4.4.2.1.1a.cmml"><mtext id="S1.E6a.m1.4.4.4.4.2.1.1" xref="S1.E6a.m1.4.4.4.4.2.1.1.cmml">otherwise</mtext><mo id="S1.E6a.m1.4.4.4.4.2.1.3.1" xref="S1.E6a.m1.4.4.4.4.2.1.1a.cmml">.</mo></mrow></mtd></mtr></mtable></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.E6a.m1.4b"><apply id="S1.E6a.m1.4.5.cmml" xref="S1.E6a.m1.4.5"><eq id="S1.E6a.m1.4.5.1.cmml" xref="S1.E6a.m1.4.5.1"></eq><apply id="S1.E6a.m1.4.5.2.cmml" xref="S1.E6a.m1.4.5.2"><csymbol cd="ambiguous" id="S1.E6a.m1.4.5.2.1.cmml" xref="S1.E6a.m1.4.5.2">subscript</csymbol><ci id="S1.E6a.m1.4.5.2.2.cmml" xref="S1.E6a.m1.4.5.2.2">𝛿</ci><apply id="S1.E6a.m1.4.5.2.3.cmml" xref="S1.E6a.m1.4.5.2.3"><times id="S1.E6a.m1.4.5.2.3.1.cmml" xref="S1.E6a.m1.4.5.2.3.1"></times><ci id="S1.E6a.m1.4.5.2.3.2.cmml" xref="S1.E6a.m1.4.5.2.3.2">𝑖</ci><ci id="S1.E6a.m1.4.5.2.3.3.cmml" xref="S1.E6a.m1.4.5.2.3.3">𝑗</ci></apply></apply><apply id="S1.E6a.m1.4.5.3.1.cmml" xref="S1.E6a.m1.4.4a"><csymbol cd="latexml" id="S1.E6a.m1.4.5.3.1.1.cmml" xref="S1.E6a.m1.4.4a.5">cases</csymbol><cn type="integer" id="S1.E6a.m1.1.1.1.1.1.1.1.cmml" xref="S1.E6a.m1.1.1.1.1.1.1.1">1</cn><apply id="S1.E6a.m1.2.2.2.2.2.1.cmml" xref="S1.E6a.m1.2.2.2.2.2.1"><eq id="S1.E6a.m1.2.2.2.2.2.1.1.cmml" xref="S1.E6a.m1.2.2.2.2.2.1.1"></eq><ci id="S1.E6a.m1.2.2.2.2.2.1.2.cmml" xref="S1.E6a.m1.2.2.2.2.2.1.2">𝑖</ci><ci id="S1.E6a.m1.2.2.2.2.2.1.3.cmml" xref="S1.E6a.m1.2.2.2.2.2.1.3">𝑗</ci></apply><cn type="integer" id="S1.E6a.m1.3.3.3.3.1.1.1.cmml" xref="S1.E6a.m1.3.3.3.3.1.1.1">0</cn><ci id="S1.E6a.m1.4.4.4.4.2.1.1a.cmml" xref="S1.E6a.m1.4.4.4.4.2.1.3"><mtext id="S1.E6a.m1.4.4.4.4.2.1.1.cmml" xref="S1.E6a.m1.4.4.4.4.2.1.1">otherwise</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.E6a.m1.4c">\displaystyle\delta_{ij}=\begin{cases}1,&amp;i=j\\
0,&amp;\text{otherwise}.\end{cases}</annotation><annotation encoding="application/x-llamapun" id="S1.E6a.m1.4d">italic_δ start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT = { start_ROW start_CELL 1 , end_CELL start_CELL italic_i = italic_j end_CELL end_ROW start_ROW start_CELL 0 , end_CELL start_CELL otherwise . end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(S6)</span></td>
</tr></tbody>
</table>
<p id="S1a.p1.19" class="ltx_p">Furthermore, the last three partial derivatives of Eqs. (<a href="#S1.E3a" title="(S3) ‣ 1 Analytical Gradients ‣ Quantum Self-Attention Neural Networks for Text Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">S3</span></a>), (<a href="#S1.E4a" title="(S4) ‣ 1 Analytical Gradients ‣ Quantum Self-Attention Neural Networks for Text Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">S4</span></a>) and (<a href="#S1.E5a" title="(S5) ‣ 1 Analytical Gradients ‣ Quantum Self-Attention Neural Networks for Text Classification" class="ltx_ref"><span class="ltx_text ltx_ref_tag">S5</span></a>) could be evaluated directly on the quantum computers via the parameter shift rule <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite>. For example,
</p>
<table id="S1.EGx15" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S1.E7a"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S1.E7a.m1.9" class="ltx_Math" alttext="\displaystyle\frac{\partial\langle Z_{q}\rangle_{s}}{\partial\theta^{(L)}_{q,j%
}}=\frac{1}{2}\left(\langle Z_{q}\rangle_{s,+}-\langle Z_{q}\rangle_{s,-}%
\right)," display="inline"><semantics id="S1.E7a.m1.9a"><mrow id="S1.E7a.m1.9.9.1" xref="S1.E7a.m1.9.9.1.1.cmml"><mrow id="S1.E7a.m1.9.9.1.1" xref="S1.E7a.m1.9.9.1.1.cmml"><mstyle displaystyle="true" id="S1.E7a.m1.4.4" xref="S1.E7a.m1.4.4.cmml"><mfrac id="S1.E7a.m1.4.4a" xref="S1.E7a.m1.4.4.cmml"><mrow id="S1.E7a.m1.1.1.1" xref="S1.E7a.m1.1.1.1.cmml"><mo id="S1.E7a.m1.1.1.1.1" xref="S1.E7a.m1.1.1.1.1.cmml">∂</mo><msub id="S1.E7a.m1.1.1.1.2" xref="S1.E7a.m1.1.1.1.2.cmml"><mrow id="S1.E7a.m1.1.1.1.2.2" xref="S1.E7a.m1.1.1.1.2.2.cmml"><mo stretchy="false" id="S1.E7a.m1.1.1.1.2.2.1" xref="S1.E7a.m1.1.1.1.2.2.1.cmml">⟨</mo><msub id="S1.E7a.m1.1.1.1.2.2.2" xref="S1.E7a.m1.1.1.1.2.2.2.cmml"><mi id="S1.E7a.m1.1.1.1.2.2.2.2" xref="S1.E7a.m1.1.1.1.2.2.2.2.cmml">Z</mi><mi id="S1.E7a.m1.1.1.1.2.2.2.3" xref="S1.E7a.m1.1.1.1.2.2.2.3.cmml">q</mi></msub><mo stretchy="false" id="S1.E7a.m1.1.1.1.2.2.3" xref="S1.E7a.m1.1.1.1.2.2.3.cmml">⟩</mo></mrow><mi id="S1.E7a.m1.1.1.1.2.3" xref="S1.E7a.m1.1.1.1.2.3.cmml">s</mi></msub></mrow><mrow id="S1.E7a.m1.4.4.4" xref="S1.E7a.m1.4.4.4.cmml"><mo id="S1.E7a.m1.4.4.4.4" xref="S1.E7a.m1.4.4.4.4.cmml">∂</mo><mo id="S1.E7a.m1.4.4.4a" xref="S1.E7a.m1.4.4.4.cmml">⁡</mo><msubsup id="S1.E7a.m1.4.4.4.5" xref="S1.E7a.m1.4.4.4.5.cmml"><mi id="S1.E7a.m1.4.4.4.5.2.2" xref="S1.E7a.m1.4.4.4.5.2.2.cmml">θ</mi><mrow id="S1.E7a.m1.4.4.4.3.2.4" xref="S1.E7a.m1.4.4.4.3.2.3.cmml"><mi id="S1.E7a.m1.3.3.3.2.1.1" xref="S1.E7a.m1.3.3.3.2.1.1.cmml">q</mi><mo id="S1.E7a.m1.4.4.4.3.2.4.1" xref="S1.E7a.m1.4.4.4.3.2.3.cmml">,</mo><mi id="S1.E7a.m1.4.4.4.3.2.2" xref="S1.E7a.m1.4.4.4.3.2.2.cmml">j</mi></mrow><mrow id="S1.E7a.m1.2.2.2.1.1.3" xref="S1.E7a.m1.4.4.4.5.cmml"><mo stretchy="false" id="S1.E7a.m1.2.2.2.1.1.3.1" xref="S1.E7a.m1.4.4.4.5.cmml">(</mo><mi id="S1.E7a.m1.2.2.2.1.1.1" xref="S1.E7a.m1.2.2.2.1.1.1.cmml">L</mi><mo stretchy="false" id="S1.E7a.m1.2.2.2.1.1.3.2" xref="S1.E7a.m1.4.4.4.5.cmml">)</mo></mrow></msubsup></mrow></mfrac></mstyle><mo id="S1.E7a.m1.9.9.1.1.2" xref="S1.E7a.m1.9.9.1.1.2.cmml">=</mo><mrow id="S1.E7a.m1.9.9.1.1.1" xref="S1.E7a.m1.9.9.1.1.1.cmml"><mstyle displaystyle="true" id="S1.E7a.m1.9.9.1.1.1.3" xref="S1.E7a.m1.9.9.1.1.1.3.cmml"><mfrac id="S1.E7a.m1.9.9.1.1.1.3a" xref="S1.E7a.m1.9.9.1.1.1.3.cmml"><mn id="S1.E7a.m1.9.9.1.1.1.3.2" xref="S1.E7a.m1.9.9.1.1.1.3.2.cmml">1</mn><mn id="S1.E7a.m1.9.9.1.1.1.3.3" xref="S1.E7a.m1.9.9.1.1.1.3.3.cmml">2</mn></mfrac></mstyle><mo id="S1.E7a.m1.9.9.1.1.1.2" xref="S1.E7a.m1.9.9.1.1.1.2.cmml">⁢</mo><mrow id="S1.E7a.m1.9.9.1.1.1.1.1" xref="S1.E7a.m1.9.9.1.1.1.1.1.1.cmml"><mo id="S1.E7a.m1.9.9.1.1.1.1.1.2" xref="S1.E7a.m1.9.9.1.1.1.1.1.1.cmml">(</mo><mrow id="S1.E7a.m1.9.9.1.1.1.1.1.1" xref="S1.E7a.m1.9.9.1.1.1.1.1.1.cmml"><msub id="S1.E7a.m1.9.9.1.1.1.1.1.1.1" xref="S1.E7a.m1.9.9.1.1.1.1.1.1.1.cmml"><mrow id="S1.E7a.m1.9.9.1.1.1.1.1.1.1.1.1" xref="S1.E7a.m1.9.9.1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S1.E7a.m1.9.9.1.1.1.1.1.1.1.1.1.2" xref="S1.E7a.m1.9.9.1.1.1.1.1.1.1.1.2.1.cmml">⟨</mo><msub id="S1.E7a.m1.9.9.1.1.1.1.1.1.1.1.1.1" xref="S1.E7a.m1.9.9.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S1.E7a.m1.9.9.1.1.1.1.1.1.1.1.1.1.2" xref="S1.E7a.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.cmml">Z</mi><mi id="S1.E7a.m1.9.9.1.1.1.1.1.1.1.1.1.1.3" xref="S1.E7a.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.cmml">q</mi></msub><mo stretchy="false" id="S1.E7a.m1.9.9.1.1.1.1.1.1.1.1.1.3" xref="S1.E7a.m1.9.9.1.1.1.1.1.1.1.1.2.1.cmml">⟩</mo></mrow><mrow id="S1.E7a.m1.6.6.2.4" xref="S1.E7a.m1.6.6.2.3.cmml"><mi id="S1.E7a.m1.5.5.1.1" xref="S1.E7a.m1.5.5.1.1.cmml">s</mi><mo id="S1.E7a.m1.6.6.2.4.1" xref="S1.E7a.m1.6.6.2.3.cmml">,</mo><mo id="S1.E7a.m1.6.6.2.2" xref="S1.E7a.m1.6.6.2.2.cmml">+</mo></mrow></msub><mo id="S1.E7a.m1.9.9.1.1.1.1.1.1.3" xref="S1.E7a.m1.9.9.1.1.1.1.1.1.3.cmml">-</mo><msub id="S1.E7a.m1.9.9.1.1.1.1.1.1.2" xref="S1.E7a.m1.9.9.1.1.1.1.1.1.2.cmml"><mrow id="S1.E7a.m1.9.9.1.1.1.1.1.1.2.1.1" xref="S1.E7a.m1.9.9.1.1.1.1.1.1.2.1.2.cmml"><mo stretchy="false" id="S1.E7a.m1.9.9.1.1.1.1.1.1.2.1.1.2" xref="S1.E7a.m1.9.9.1.1.1.1.1.1.2.1.2.1.cmml">⟨</mo><msub id="S1.E7a.m1.9.9.1.1.1.1.1.1.2.1.1.1" xref="S1.E7a.m1.9.9.1.1.1.1.1.1.2.1.1.1.cmml"><mi id="S1.E7a.m1.9.9.1.1.1.1.1.1.2.1.1.1.2" xref="S1.E7a.m1.9.9.1.1.1.1.1.1.2.1.1.1.2.cmml">Z</mi><mi id="S1.E7a.m1.9.9.1.1.1.1.1.1.2.1.1.1.3" xref="S1.E7a.m1.9.9.1.1.1.1.1.1.2.1.1.1.3.cmml">q</mi></msub><mo stretchy="false" id="S1.E7a.m1.9.9.1.1.1.1.1.1.2.1.1.3" xref="S1.E7a.m1.9.9.1.1.1.1.1.1.2.1.2.1.cmml">⟩</mo></mrow><mrow id="S1.E7a.m1.8.8.2.4" xref="S1.E7a.m1.8.8.2.3.cmml"><mi id="S1.E7a.m1.7.7.1.1" xref="S1.E7a.m1.7.7.1.1.cmml">s</mi><mo id="S1.E7a.m1.8.8.2.4.1" xref="S1.E7a.m1.8.8.2.3.cmml">,</mo><mo id="S1.E7a.m1.8.8.2.2" xref="S1.E7a.m1.8.8.2.2.cmml">-</mo></mrow></msub></mrow><mo id="S1.E7a.m1.9.9.1.1.1.1.1.3" xref="S1.E7a.m1.9.9.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S1.E7a.m1.9.9.1.2" xref="S1.E7a.m1.9.9.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S1.E7a.m1.9b"><apply id="S1.E7a.m1.9.9.1.1.cmml" xref="S1.E7a.m1.9.9.1"><eq id="S1.E7a.m1.9.9.1.1.2.cmml" xref="S1.E7a.m1.9.9.1.1.2"></eq><apply id="S1.E7a.m1.4.4.cmml" xref="S1.E7a.m1.4.4"><divide id="S1.E7a.m1.4.4.5.cmml" xref="S1.E7a.m1.4.4"></divide><cerror id="S1.E7a.m1.1.1.1.cmml" xref="S1.E7a.m1.1.1.1"><csymbol cd="ambiguous" id="S1.E7a.m1.1.1.1a.cmml" xref="S1.E7a.m1.1.1.1">fragments</csymbol><partialdiff id="S1.E7a.m1.1.1.1.1.cmml" xref="S1.E7a.m1.1.1.1.1"></partialdiff><apply id="S1.E7a.m1.1.1.1.2.cmml" xref="S1.E7a.m1.1.1.1.2"><csymbol cd="ambiguous" id="S1.E7a.m1.1.1.1.2.1.cmml" xref="S1.E7a.m1.1.1.1.2">subscript</csymbol><cerror id="S1.E7a.m1.1.1.1.2.2.cmml" xref="S1.E7a.m1.1.1.1.2.2"><csymbol cd="ambiguous" id="S1.E7a.m1.1.1.1.2.2a.cmml" xref="S1.E7a.m1.1.1.1.2.2">fragments</csymbol><ci id="S1.E7a.m1.1.1.1.2.2.1.cmml" xref="S1.E7a.m1.1.1.1.2.2.1">⟨</ci><apply id="S1.E7a.m1.1.1.1.2.2.2.cmml" xref="S1.E7a.m1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S1.E7a.m1.1.1.1.2.2.2.1.cmml" xref="S1.E7a.m1.1.1.1.2.2.2">subscript</csymbol><ci id="S1.E7a.m1.1.1.1.2.2.2.2.cmml" xref="S1.E7a.m1.1.1.1.2.2.2.2">𝑍</ci><ci id="S1.E7a.m1.1.1.1.2.2.2.3.cmml" xref="S1.E7a.m1.1.1.1.2.2.2.3">𝑞</ci></apply><ci id="S1.E7a.m1.1.1.1.2.2.3.cmml" xref="S1.E7a.m1.1.1.1.2.2.3">⟩</ci></cerror><ci id="S1.E7a.m1.1.1.1.2.3.cmml" xref="S1.E7a.m1.1.1.1.2.3">𝑠</ci></apply></cerror><apply id="S1.E7a.m1.4.4.4.cmml" xref="S1.E7a.m1.4.4.4"><partialdiff id="S1.E7a.m1.4.4.4.4.cmml" xref="S1.E7a.m1.4.4.4.4"></partialdiff><apply id="S1.E7a.m1.4.4.4.5.cmml" xref="S1.E7a.m1.4.4.4.5"><csymbol cd="ambiguous" id="S1.E7a.m1.4.4.4.5.1.cmml" xref="S1.E7a.m1.4.4.4.5">subscript</csymbol><apply id="S1.E7a.m1.4.4.4.5.2.cmml" xref="S1.E7a.m1.4.4.4.5"><csymbol cd="ambiguous" id="S1.E7a.m1.4.4.4.5.2.1.cmml" xref="S1.E7a.m1.4.4.4.5">superscript</csymbol><ci id="S1.E7a.m1.4.4.4.5.2.2.cmml" xref="S1.E7a.m1.4.4.4.5.2.2">𝜃</ci><ci id="S1.E7a.m1.2.2.2.1.1.1.cmml" xref="S1.E7a.m1.2.2.2.1.1.1">𝐿</ci></apply><list id="S1.E7a.m1.4.4.4.3.2.3.cmml" xref="S1.E7a.m1.4.4.4.3.2.4"><ci id="S1.E7a.m1.3.3.3.2.1.1.cmml" xref="S1.E7a.m1.3.3.3.2.1.1">𝑞</ci><ci id="S1.E7a.m1.4.4.4.3.2.2.cmml" xref="S1.E7a.m1.4.4.4.3.2.2">𝑗</ci></list></apply></apply></apply><apply id="S1.E7a.m1.9.9.1.1.1.cmml" xref="S1.E7a.m1.9.9.1.1.1"><times id="S1.E7a.m1.9.9.1.1.1.2.cmml" xref="S1.E7a.m1.9.9.1.1.1.2"></times><apply id="S1.E7a.m1.9.9.1.1.1.3.cmml" xref="S1.E7a.m1.9.9.1.1.1.3"><divide id="S1.E7a.m1.9.9.1.1.1.3.1.cmml" xref="S1.E7a.m1.9.9.1.1.1.3"></divide><cn type="integer" id="S1.E7a.m1.9.9.1.1.1.3.2.cmml" xref="S1.E7a.m1.9.9.1.1.1.3.2">1</cn><cn type="integer" id="S1.E7a.m1.9.9.1.1.1.3.3.cmml" xref="S1.E7a.m1.9.9.1.1.1.3.3">2</cn></apply><apply id="S1.E7a.m1.9.9.1.1.1.1.1.1.cmml" xref="S1.E7a.m1.9.9.1.1.1.1.1"><minus id="S1.E7a.m1.9.9.1.1.1.1.1.1.3.cmml" xref="S1.E7a.m1.9.9.1.1.1.1.1.1.3"></minus><apply id="S1.E7a.m1.9.9.1.1.1.1.1.1.1.cmml" xref="S1.E7a.m1.9.9.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S1.E7a.m1.9.9.1.1.1.1.1.1.1.2.cmml" xref="S1.E7a.m1.9.9.1.1.1.1.1.1.1">subscript</csymbol><apply id="S1.E7a.m1.9.9.1.1.1.1.1.1.1.1.2.cmml" xref="S1.E7a.m1.9.9.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S1.E7a.m1.9.9.1.1.1.1.1.1.1.1.2.1.cmml" xref="S1.E7a.m1.9.9.1.1.1.1.1.1.1.1.1.2">delimited-⟨⟩</csymbol><apply id="S1.E7a.m1.9.9.1.1.1.1.1.1.1.1.1.1.cmml" xref="S1.E7a.m1.9.9.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S1.E7a.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S1.E7a.m1.9.9.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S1.E7a.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S1.E7a.m1.9.9.1.1.1.1.1.1.1.1.1.1.2">𝑍</ci><ci id="S1.E7a.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S1.E7a.m1.9.9.1.1.1.1.1.1.1.1.1.1.3">𝑞</ci></apply></apply><list id="S1.E7a.m1.6.6.2.3.cmml" xref="S1.E7a.m1.6.6.2.4"><ci id="S1.E7a.m1.5.5.1.1.cmml" xref="S1.E7a.m1.5.5.1.1">𝑠</ci><plus id="S1.E7a.m1.6.6.2.2.cmml" xref="S1.E7a.m1.6.6.2.2"></plus></list></apply><apply id="S1.E7a.m1.9.9.1.1.1.1.1.1.2.cmml" xref="S1.E7a.m1.9.9.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S1.E7a.m1.9.9.1.1.1.1.1.1.2.2.cmml" xref="S1.E7a.m1.9.9.1.1.1.1.1.1.2">subscript</csymbol><apply id="S1.E7a.m1.9.9.1.1.1.1.1.1.2.1.2.cmml" xref="S1.E7a.m1.9.9.1.1.1.1.1.1.2.1.1"><csymbol cd="latexml" id="S1.E7a.m1.9.9.1.1.1.1.1.1.2.1.2.1.cmml" xref="S1.E7a.m1.9.9.1.1.1.1.1.1.2.1.1.2">delimited-⟨⟩</csymbol><apply id="S1.E7a.m1.9.9.1.1.1.1.1.1.2.1.1.1.cmml" xref="S1.E7a.m1.9.9.1.1.1.1.1.1.2.1.1.1"><csymbol cd="ambiguous" id="S1.E7a.m1.9.9.1.1.1.1.1.1.2.1.1.1.1.cmml" xref="S1.E7a.m1.9.9.1.1.1.1.1.1.2.1.1.1">subscript</csymbol><ci id="S1.E7a.m1.9.9.1.1.1.1.1.1.2.1.1.1.2.cmml" xref="S1.E7a.m1.9.9.1.1.1.1.1.1.2.1.1.1.2">𝑍</ci><ci id="S1.E7a.m1.9.9.1.1.1.1.1.1.2.1.1.1.3.cmml" xref="S1.E7a.m1.9.9.1.1.1.1.1.1.2.1.1.1.3">𝑞</ci></apply></apply><list id="S1.E7a.m1.8.8.2.3.cmml" xref="S1.E7a.m1.8.8.2.4"><ci id="S1.E7a.m1.7.7.1.1.cmml" xref="S1.E7a.m1.7.7.1.1">𝑠</ci><minus id="S1.E7a.m1.8.8.2.2.cmml" xref="S1.E7a.m1.8.8.2.2"></minus></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.E7a.m1.9c">\displaystyle\frac{\partial\langle Z_{q}\rangle_{s}}{\partial\theta^{(L)}_{q,j%
}}=\frac{1}{2}\left(\langle Z_{q}\rangle_{s,+}-\langle Z_{q}\rangle_{s,-}%
\right),</annotation><annotation encoding="application/x-llamapun" id="S1.E7a.m1.9d">divide start_ARG ∂ ⟨ italic_Z start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT ⟩ start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT end_ARG start_ARG ∂ italic_θ start_POSTSUPERSCRIPT ( italic_L ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_q , italic_j end_POSTSUBSCRIPT end_ARG = divide start_ARG 1 end_ARG start_ARG 2 end_ARG ( ⟨ italic_Z start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT ⟩ start_POSTSUBSCRIPT italic_s , + end_POSTSUBSCRIPT - ⟨ italic_Z start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT ⟩ start_POSTSUBSCRIPT italic_s , - end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(S7)</span></td>
</tr></tbody>
</table>
<p id="S1a.p1.18" class="ltx_p">where <math id="S1a.p1.15.m1.7" class="ltx_Math" alttext="\langle Z_{q}\rangle_{s,\pm}:=\bra{\psi_{s}}U_{q,\pm}^{\dagger}ZU_{q,\pm}\ket{%
\psi_{s}}" display="inline"><semantics id="S1a.p1.15.m1.7a"><mrow id="S1a.p1.15.m1.7.7" xref="S1a.p1.15.m1.7.7.cmml"><msub id="S1a.p1.15.m1.7.7.1" xref="S1a.p1.15.m1.7.7.1.cmml"><mrow id="S1a.p1.15.m1.7.7.1.1.1" xref="S1a.p1.15.m1.7.7.1.1.2.cmml"><mo stretchy="false" id="S1a.p1.15.m1.7.7.1.1.1.2" xref="S1a.p1.15.m1.7.7.1.1.2.1.cmml">⟨</mo><msub id="S1a.p1.15.m1.7.7.1.1.1.1" xref="S1a.p1.15.m1.7.7.1.1.1.1.cmml"><mi id="S1a.p1.15.m1.7.7.1.1.1.1.2" xref="S1a.p1.15.m1.7.7.1.1.1.1.2.cmml">Z</mi><mi id="S1a.p1.15.m1.7.7.1.1.1.1.3" xref="S1a.p1.15.m1.7.7.1.1.1.1.3.cmml">q</mi></msub><mo stretchy="false" id="S1a.p1.15.m1.7.7.1.1.1.3" xref="S1a.p1.15.m1.7.7.1.1.2.1.cmml">⟩</mo></mrow><mrow id="S1a.p1.15.m1.2.2.2.4" xref="S1a.p1.15.m1.2.2.2.3.cmml"><mi id="S1a.p1.15.m1.1.1.1.1" xref="S1a.p1.15.m1.1.1.1.1.cmml">s</mi><mo id="S1a.p1.15.m1.2.2.2.4.1" xref="S1a.p1.15.m1.2.2.2.3.cmml">,</mo><mo id="S1a.p1.15.m1.2.2.2.2" xref="S1a.p1.15.m1.2.2.2.2.cmml">±</mo></mrow></msub><mo id="S1a.p1.15.m1.7.7.2" xref="S1a.p1.15.m1.7.7.2.cmml">:=</mo><mrow id="S1a.p1.15.m1.7.7.3" xref="S1a.p1.15.m1.7.7.3.cmml"><merror class="ltx_ERROR undefined undefined" id="S1a.p1.15.m1.7.7.3.2" xref="S1a.p1.15.m1.7.7.3.2b.cmml"><mtext id="S1a.p1.15.m1.7.7.3.2a" xref="S1a.p1.15.m1.7.7.3.2b.cmml">\bra</mtext></merror><mo id="S1a.p1.15.m1.7.7.3.1" xref="S1a.p1.15.m1.7.7.3.1.cmml">⁢</mo><msub id="S1a.p1.15.m1.7.7.3.3" xref="S1a.p1.15.m1.7.7.3.3.cmml"><mi id="S1a.p1.15.m1.7.7.3.3.2" xref="S1a.p1.15.m1.7.7.3.3.2.cmml">ψ</mi><mi id="S1a.p1.15.m1.7.7.3.3.3" xref="S1a.p1.15.m1.7.7.3.3.3.cmml">s</mi></msub><mo id="S1a.p1.15.m1.7.7.3.1a" xref="S1a.p1.15.m1.7.7.3.1.cmml">⁢</mo><msubsup id="S1a.p1.15.m1.7.7.3.4" xref="S1a.p1.15.m1.7.7.3.4.cmml"><mi id="S1a.p1.15.m1.7.7.3.4.2.2" xref="S1a.p1.15.m1.7.7.3.4.2.2.cmml">U</mi><mrow id="S1a.p1.15.m1.4.4.2.4" xref="S1a.p1.15.m1.4.4.2.3.cmml"><mi id="S1a.p1.15.m1.3.3.1.1" xref="S1a.p1.15.m1.3.3.1.1.cmml">q</mi><mo id="S1a.p1.15.m1.4.4.2.4.1" xref="S1a.p1.15.m1.4.4.2.3.cmml">,</mo><mo id="S1a.p1.15.m1.4.4.2.2" xref="S1a.p1.15.m1.4.4.2.2.cmml">±</mo></mrow><mo id="S1a.p1.15.m1.7.7.3.4.3" xref="S1a.p1.15.m1.7.7.3.4.3.cmml">†</mo></msubsup><mo id="S1a.p1.15.m1.7.7.3.1b" xref="S1a.p1.15.m1.7.7.3.1.cmml">⁢</mo><mi id="S1a.p1.15.m1.7.7.3.5" xref="S1a.p1.15.m1.7.7.3.5.cmml">Z</mi><mo id="S1a.p1.15.m1.7.7.3.1c" xref="S1a.p1.15.m1.7.7.3.1.cmml">⁢</mo><msub id="S1a.p1.15.m1.7.7.3.6" xref="S1a.p1.15.m1.7.7.3.6.cmml"><mi id="S1a.p1.15.m1.7.7.3.6.2" xref="S1a.p1.15.m1.7.7.3.6.2.cmml">U</mi><mrow id="S1a.p1.15.m1.6.6.2.4" xref="S1a.p1.15.m1.6.6.2.3.cmml"><mi id="S1a.p1.15.m1.5.5.1.1" xref="S1a.p1.15.m1.5.5.1.1.cmml">q</mi><mo id="S1a.p1.15.m1.6.6.2.4.1" xref="S1a.p1.15.m1.6.6.2.3.cmml">,</mo><mo id="S1a.p1.15.m1.6.6.2.2" xref="S1a.p1.15.m1.6.6.2.2.cmml">±</mo></mrow></msub><mo id="S1a.p1.15.m1.7.7.3.1d" xref="S1a.p1.15.m1.7.7.3.1.cmml">⁢</mo><merror class="ltx_ERROR undefined undefined" id="S1a.p1.15.m1.7.7.3.7" xref="S1a.p1.15.m1.7.7.3.7b.cmml"><mtext id="S1a.p1.15.m1.7.7.3.7a" xref="S1a.p1.15.m1.7.7.3.7b.cmml">\ket</mtext></merror><mo id="S1a.p1.15.m1.7.7.3.1e" xref="S1a.p1.15.m1.7.7.3.1.cmml">⁢</mo><msub id="S1a.p1.15.m1.7.7.3.8" xref="S1a.p1.15.m1.7.7.3.8.cmml"><mi id="S1a.p1.15.m1.7.7.3.8.2" xref="S1a.p1.15.m1.7.7.3.8.2.cmml">ψ</mi><mi id="S1a.p1.15.m1.7.7.3.8.3" xref="S1a.p1.15.m1.7.7.3.8.3.cmml">s</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1a.p1.15.m1.7b"><apply id="S1a.p1.15.m1.7.7.cmml" xref="S1a.p1.15.m1.7.7"><csymbol cd="latexml" id="S1a.p1.15.m1.7.7.2.cmml" xref="S1a.p1.15.m1.7.7.2">assign</csymbol><apply id="S1a.p1.15.m1.7.7.1.cmml" xref="S1a.p1.15.m1.7.7.1"><csymbol cd="ambiguous" id="S1a.p1.15.m1.7.7.1.2.cmml" xref="S1a.p1.15.m1.7.7.1">subscript</csymbol><apply id="S1a.p1.15.m1.7.7.1.1.2.cmml" xref="S1a.p1.15.m1.7.7.1.1.1"><csymbol cd="latexml" id="S1a.p1.15.m1.7.7.1.1.2.1.cmml" xref="S1a.p1.15.m1.7.7.1.1.1.2">delimited-⟨⟩</csymbol><apply id="S1a.p1.15.m1.7.7.1.1.1.1.cmml" xref="S1a.p1.15.m1.7.7.1.1.1.1"><csymbol cd="ambiguous" id="S1a.p1.15.m1.7.7.1.1.1.1.1.cmml" xref="S1a.p1.15.m1.7.7.1.1.1.1">subscript</csymbol><ci id="S1a.p1.15.m1.7.7.1.1.1.1.2.cmml" xref="S1a.p1.15.m1.7.7.1.1.1.1.2">𝑍</ci><ci id="S1a.p1.15.m1.7.7.1.1.1.1.3.cmml" xref="S1a.p1.15.m1.7.7.1.1.1.1.3">𝑞</ci></apply></apply><list id="S1a.p1.15.m1.2.2.2.3.cmml" xref="S1a.p1.15.m1.2.2.2.4"><ci id="S1a.p1.15.m1.1.1.1.1.cmml" xref="S1a.p1.15.m1.1.1.1.1">𝑠</ci><csymbol cd="latexml" id="S1a.p1.15.m1.2.2.2.2.cmml" xref="S1a.p1.15.m1.2.2.2.2">plus-or-minus</csymbol></list></apply><apply id="S1a.p1.15.m1.7.7.3.cmml" xref="S1a.p1.15.m1.7.7.3"><times id="S1a.p1.15.m1.7.7.3.1.cmml" xref="S1a.p1.15.m1.7.7.3.1"></times><ci id="S1a.p1.15.m1.7.7.3.2b.cmml" xref="S1a.p1.15.m1.7.7.3.2"><merror class="ltx_ERROR undefined undefined" id="S1a.p1.15.m1.7.7.3.2.cmml" xref="S1a.p1.15.m1.7.7.3.2"><mtext id="S1a.p1.15.m1.7.7.3.2a.cmml" xref="S1a.p1.15.m1.7.7.3.2">\bra</mtext></merror></ci><apply id="S1a.p1.15.m1.7.7.3.3.cmml" xref="S1a.p1.15.m1.7.7.3.3"><csymbol cd="ambiguous" id="S1a.p1.15.m1.7.7.3.3.1.cmml" xref="S1a.p1.15.m1.7.7.3.3">subscript</csymbol><ci id="S1a.p1.15.m1.7.7.3.3.2.cmml" xref="S1a.p1.15.m1.7.7.3.3.2">𝜓</ci><ci id="S1a.p1.15.m1.7.7.3.3.3.cmml" xref="S1a.p1.15.m1.7.7.3.3.3">𝑠</ci></apply><apply id="S1a.p1.15.m1.7.7.3.4.cmml" xref="S1a.p1.15.m1.7.7.3.4"><csymbol cd="ambiguous" id="S1a.p1.15.m1.7.7.3.4.1.cmml" xref="S1a.p1.15.m1.7.7.3.4">superscript</csymbol><apply id="S1a.p1.15.m1.7.7.3.4.2.cmml" xref="S1a.p1.15.m1.7.7.3.4"><csymbol cd="ambiguous" id="S1a.p1.15.m1.7.7.3.4.2.1.cmml" xref="S1a.p1.15.m1.7.7.3.4">subscript</csymbol><ci id="S1a.p1.15.m1.7.7.3.4.2.2.cmml" xref="S1a.p1.15.m1.7.7.3.4.2.2">𝑈</ci><list id="S1a.p1.15.m1.4.4.2.3.cmml" xref="S1a.p1.15.m1.4.4.2.4"><ci id="S1a.p1.15.m1.3.3.1.1.cmml" xref="S1a.p1.15.m1.3.3.1.1">𝑞</ci><csymbol cd="latexml" id="S1a.p1.15.m1.4.4.2.2.cmml" xref="S1a.p1.15.m1.4.4.2.2">plus-or-minus</csymbol></list></apply><ci id="S1a.p1.15.m1.7.7.3.4.3.cmml" xref="S1a.p1.15.m1.7.7.3.4.3">†</ci></apply><ci id="S1a.p1.15.m1.7.7.3.5.cmml" xref="S1a.p1.15.m1.7.7.3.5">𝑍</ci><apply id="S1a.p1.15.m1.7.7.3.6.cmml" xref="S1a.p1.15.m1.7.7.3.6"><csymbol cd="ambiguous" id="S1a.p1.15.m1.7.7.3.6.1.cmml" xref="S1a.p1.15.m1.7.7.3.6">subscript</csymbol><ci id="S1a.p1.15.m1.7.7.3.6.2.cmml" xref="S1a.p1.15.m1.7.7.3.6.2">𝑈</ci><list id="S1a.p1.15.m1.6.6.2.3.cmml" xref="S1a.p1.15.m1.6.6.2.4"><ci id="S1a.p1.15.m1.5.5.1.1.cmml" xref="S1a.p1.15.m1.5.5.1.1">𝑞</ci><csymbol cd="latexml" id="S1a.p1.15.m1.6.6.2.2.cmml" xref="S1a.p1.15.m1.6.6.2.2">plus-or-minus</csymbol></list></apply><ci id="S1a.p1.15.m1.7.7.3.7b.cmml" xref="S1a.p1.15.m1.7.7.3.7"><merror class="ltx_ERROR undefined undefined" id="S1a.p1.15.m1.7.7.3.7.cmml" xref="S1a.p1.15.m1.7.7.3.7"><mtext id="S1a.p1.15.m1.7.7.3.7a.cmml" xref="S1a.p1.15.m1.7.7.3.7">\ket</mtext></merror></ci><apply id="S1a.p1.15.m1.7.7.3.8.cmml" xref="S1a.p1.15.m1.7.7.3.8"><csymbol cd="ambiguous" id="S1a.p1.15.m1.7.7.3.8.1.cmml" xref="S1a.p1.15.m1.7.7.3.8">subscript</csymbol><ci id="S1a.p1.15.m1.7.7.3.8.2.cmml" xref="S1a.p1.15.m1.7.7.3.8.2">𝜓</ci><ci id="S1a.p1.15.m1.7.7.3.8.3.cmml" xref="S1a.p1.15.m1.7.7.3.8.3">𝑠</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1a.p1.15.m1.7c">\langle Z_{q}\rangle_{s,\pm}:=\bra{\psi_{s}}U_{q,\pm}^{\dagger}ZU_{q,\pm}\ket{%
\psi_{s}}</annotation><annotation encoding="application/x-llamapun" id="S1a.p1.15.m1.7d">⟨ italic_Z start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT ⟩ start_POSTSUBSCRIPT italic_s , ± end_POSTSUBSCRIPT := italic_ψ start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT italic_U start_POSTSUBSCRIPT italic_q , ± end_POSTSUBSCRIPT start_POSTSUPERSCRIPT † end_POSTSUPERSCRIPT italic_Z italic_U start_POSTSUBSCRIPT italic_q , ± end_POSTSUBSCRIPT italic_ψ start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> and <math id="S1a.p1.16.m2.2" class="ltx_Math" alttext="U_{q,\pm}" display="inline"><semantics id="S1a.p1.16.m2.2a"><msub id="S1a.p1.16.m2.2.3" xref="S1a.p1.16.m2.2.3.cmml"><mi id="S1a.p1.16.m2.2.3.2" xref="S1a.p1.16.m2.2.3.2.cmml">U</mi><mrow id="S1a.p1.16.m2.2.2.2.4" xref="S1a.p1.16.m2.2.2.2.3.cmml"><mi id="S1a.p1.16.m2.1.1.1.1" xref="S1a.p1.16.m2.1.1.1.1.cmml">q</mi><mo id="S1a.p1.16.m2.2.2.2.4.1" xref="S1a.p1.16.m2.2.2.2.3.cmml">,</mo><mo id="S1a.p1.16.m2.2.2.2.2" xref="S1a.p1.16.m2.2.2.2.2.cmml">±</mo></mrow></msub><annotation-xml encoding="MathML-Content" id="S1a.p1.16.m2.2b"><apply id="S1a.p1.16.m2.2.3.cmml" xref="S1a.p1.16.m2.2.3"><csymbol cd="ambiguous" id="S1a.p1.16.m2.2.3.1.cmml" xref="S1a.p1.16.m2.2.3">subscript</csymbol><ci id="S1a.p1.16.m2.2.3.2.cmml" xref="S1a.p1.16.m2.2.3.2">𝑈</ci><list id="S1a.p1.16.m2.2.2.2.3.cmml" xref="S1a.p1.16.m2.2.2.2.4"><ci id="S1a.p1.16.m2.1.1.1.1.cmml" xref="S1a.p1.16.m2.1.1.1.1">𝑞</ci><csymbol cd="latexml" id="S1a.p1.16.m2.2.2.2.2.cmml" xref="S1a.p1.16.m2.2.2.2.2">plus-or-minus</csymbol></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S1a.p1.16.m2.2c">U_{q,\pm}</annotation><annotation encoding="application/x-llamapun" id="S1a.p1.16.m2.2d">italic_U start_POSTSUBSCRIPT italic_q , ± end_POSTSUBSCRIPT</annotation></semantics></math> <math id="S1a.p1.17.m3.1" class="ltx_Math" alttext=":=" display="inline"><semantics id="S1a.p1.17.m3.1a"><mo id="S1a.p1.17.m3.1.1" xref="S1a.p1.17.m3.1.1.cmml">:=</mo><annotation-xml encoding="MathML-Content" id="S1a.p1.17.m3.1b"><csymbol cd="latexml" id="S1a.p1.17.m3.1.1.cmml" xref="S1a.p1.17.m3.1.1">assign</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S1a.p1.17.m3.1c">:=</annotation><annotation encoding="application/x-llamapun" id="S1a.p1.17.m3.1d">:=</annotation></semantics></math> <math id="S1a.p1.18.m4.8" class="ltx_Math" alttext="U_{q}\left(\bm{\theta}_{q,-j}^{(L)},\theta_{q,j}^{(L)}\pm\frac{\pi}{2}\right)" display="inline"><semantics id="S1a.p1.18.m4.8a"><mrow id="S1a.p1.18.m4.8.8" xref="S1a.p1.18.m4.8.8.cmml"><msub id="S1a.p1.18.m4.8.8.4" xref="S1a.p1.18.m4.8.8.4.cmml"><mi id="S1a.p1.18.m4.8.8.4.2" xref="S1a.p1.18.m4.8.8.4.2.cmml">U</mi><mi id="S1a.p1.18.m4.8.8.4.3" xref="S1a.p1.18.m4.8.8.4.3.cmml">q</mi></msub><mo id="S1a.p1.18.m4.8.8.3" xref="S1a.p1.18.m4.8.8.3.cmml">⁢</mo><mrow id="S1a.p1.18.m4.8.8.2.2" xref="S1a.p1.18.m4.8.8.2.3.cmml"><mo id="S1a.p1.18.m4.8.8.2.2.3" xref="S1a.p1.18.m4.8.8.2.3.cmml">(</mo><msubsup id="S1a.p1.18.m4.7.7.1.1.1" xref="S1a.p1.18.m4.7.7.1.1.1.cmml"><mi id="S1a.p1.18.m4.7.7.1.1.1.2.2" xref="S1a.p1.18.m4.7.7.1.1.1.2.2.cmml">𝜽</mi><mrow id="S1a.p1.18.m4.2.2.2.2" xref="S1a.p1.18.m4.2.2.2.3.cmml"><mi id="S1a.p1.18.m4.1.1.1.1" xref="S1a.p1.18.m4.1.1.1.1.cmml">q</mi><mo id="S1a.p1.18.m4.2.2.2.2.2" xref="S1a.p1.18.m4.2.2.2.3.cmml">,</mo><mrow id="S1a.p1.18.m4.2.2.2.2.1" xref="S1a.p1.18.m4.2.2.2.2.1.cmml"><mo id="S1a.p1.18.m4.2.2.2.2.1.1" xref="S1a.p1.18.m4.2.2.2.2.1.1.cmml">-</mo><mi id="S1a.p1.18.m4.2.2.2.2.1.2" xref="S1a.p1.18.m4.2.2.2.2.1.2.cmml">j</mi></mrow></mrow><mrow id="S1a.p1.18.m4.3.3.1.3" xref="S1a.p1.18.m4.7.7.1.1.1.cmml"><mo stretchy="false" id="S1a.p1.18.m4.3.3.1.3.1" xref="S1a.p1.18.m4.7.7.1.1.1.cmml">(</mo><mi id="S1a.p1.18.m4.3.3.1.1" xref="S1a.p1.18.m4.3.3.1.1.cmml">L</mi><mo stretchy="false" id="S1a.p1.18.m4.3.3.1.3.2" xref="S1a.p1.18.m4.7.7.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S1a.p1.18.m4.8.8.2.2.4" xref="S1a.p1.18.m4.8.8.2.3.cmml">,</mo><mrow id="S1a.p1.18.m4.8.8.2.2.2" xref="S1a.p1.18.m4.8.8.2.2.2.cmml"><msubsup id="S1a.p1.18.m4.8.8.2.2.2.2" xref="S1a.p1.18.m4.8.8.2.2.2.2.cmml"><mi id="S1a.p1.18.m4.8.8.2.2.2.2.2.2" xref="S1a.p1.18.m4.8.8.2.2.2.2.2.2.cmml">θ</mi><mrow id="S1a.p1.18.m4.5.5.2.4" xref="S1a.p1.18.m4.5.5.2.3.cmml"><mi id="S1a.p1.18.m4.4.4.1.1" xref="S1a.p1.18.m4.4.4.1.1.cmml">q</mi><mo id="S1a.p1.18.m4.5.5.2.4.1" xref="S1a.p1.18.m4.5.5.2.3.cmml">,</mo><mi id="S1a.p1.18.m4.5.5.2.2" xref="S1a.p1.18.m4.5.5.2.2.cmml">j</mi></mrow><mrow id="S1a.p1.18.m4.6.6.1.3" xref="S1a.p1.18.m4.8.8.2.2.2.2.cmml"><mo stretchy="false" id="S1a.p1.18.m4.6.6.1.3.1" xref="S1a.p1.18.m4.8.8.2.2.2.2.cmml">(</mo><mi id="S1a.p1.18.m4.6.6.1.1" xref="S1a.p1.18.m4.6.6.1.1.cmml">L</mi><mo stretchy="false" id="S1a.p1.18.m4.6.6.1.3.2" xref="S1a.p1.18.m4.8.8.2.2.2.2.cmml">)</mo></mrow></msubsup><mo id="S1a.p1.18.m4.8.8.2.2.2.1" xref="S1a.p1.18.m4.8.8.2.2.2.1.cmml">±</mo><mfrac id="S1a.p1.18.m4.8.8.2.2.2.3" xref="S1a.p1.18.m4.8.8.2.2.2.3.cmml"><mi id="S1a.p1.18.m4.8.8.2.2.2.3.2" xref="S1a.p1.18.m4.8.8.2.2.2.3.2.cmml">π</mi><mn id="S1a.p1.18.m4.8.8.2.2.2.3.3" xref="S1a.p1.18.m4.8.8.2.2.2.3.3.cmml">2</mn></mfrac></mrow><mo id="S1a.p1.18.m4.8.8.2.2.5" xref="S1a.p1.18.m4.8.8.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1a.p1.18.m4.8b"><apply id="S1a.p1.18.m4.8.8.cmml" xref="S1a.p1.18.m4.8.8"><times id="S1a.p1.18.m4.8.8.3.cmml" xref="S1a.p1.18.m4.8.8.3"></times><apply id="S1a.p1.18.m4.8.8.4.cmml" xref="S1a.p1.18.m4.8.8.4"><csymbol cd="ambiguous" id="S1a.p1.18.m4.8.8.4.1.cmml" xref="S1a.p1.18.m4.8.8.4">subscript</csymbol><ci id="S1a.p1.18.m4.8.8.4.2.cmml" xref="S1a.p1.18.m4.8.8.4.2">𝑈</ci><ci id="S1a.p1.18.m4.8.8.4.3.cmml" xref="S1a.p1.18.m4.8.8.4.3">𝑞</ci></apply><interval closure="open" id="S1a.p1.18.m4.8.8.2.3.cmml" xref="S1a.p1.18.m4.8.8.2.2"><apply id="S1a.p1.18.m4.7.7.1.1.1.cmml" xref="S1a.p1.18.m4.7.7.1.1.1"><csymbol cd="ambiguous" id="S1a.p1.18.m4.7.7.1.1.1.1.cmml" xref="S1a.p1.18.m4.7.7.1.1.1">superscript</csymbol><apply id="S1a.p1.18.m4.7.7.1.1.1.2.cmml" xref="S1a.p1.18.m4.7.7.1.1.1"><csymbol cd="ambiguous" id="S1a.p1.18.m4.7.7.1.1.1.2.1.cmml" xref="S1a.p1.18.m4.7.7.1.1.1">subscript</csymbol><ci id="S1a.p1.18.m4.7.7.1.1.1.2.2.cmml" xref="S1a.p1.18.m4.7.7.1.1.1.2.2">𝜽</ci><list id="S1a.p1.18.m4.2.2.2.3.cmml" xref="S1a.p1.18.m4.2.2.2.2"><ci id="S1a.p1.18.m4.1.1.1.1.cmml" xref="S1a.p1.18.m4.1.1.1.1">𝑞</ci><apply id="S1a.p1.18.m4.2.2.2.2.1.cmml" xref="S1a.p1.18.m4.2.2.2.2.1"><minus id="S1a.p1.18.m4.2.2.2.2.1.1.cmml" xref="S1a.p1.18.m4.2.2.2.2.1.1"></minus><ci id="S1a.p1.18.m4.2.2.2.2.1.2.cmml" xref="S1a.p1.18.m4.2.2.2.2.1.2">𝑗</ci></apply></list></apply><ci id="S1a.p1.18.m4.3.3.1.1.cmml" xref="S1a.p1.18.m4.3.3.1.1">𝐿</ci></apply><apply id="S1a.p1.18.m4.8.8.2.2.2.cmml" xref="S1a.p1.18.m4.8.8.2.2.2"><csymbol cd="latexml" id="S1a.p1.18.m4.8.8.2.2.2.1.cmml" xref="S1a.p1.18.m4.8.8.2.2.2.1">plus-or-minus</csymbol><apply id="S1a.p1.18.m4.8.8.2.2.2.2.cmml" xref="S1a.p1.18.m4.8.8.2.2.2.2"><csymbol cd="ambiguous" id="S1a.p1.18.m4.8.8.2.2.2.2.1.cmml" xref="S1a.p1.18.m4.8.8.2.2.2.2">superscript</csymbol><apply id="S1a.p1.18.m4.8.8.2.2.2.2.2.cmml" xref="S1a.p1.18.m4.8.8.2.2.2.2"><csymbol cd="ambiguous" id="S1a.p1.18.m4.8.8.2.2.2.2.2.1.cmml" xref="S1a.p1.18.m4.8.8.2.2.2.2">subscript</csymbol><ci id="S1a.p1.18.m4.8.8.2.2.2.2.2.2.cmml" xref="S1a.p1.18.m4.8.8.2.2.2.2.2.2">𝜃</ci><list id="S1a.p1.18.m4.5.5.2.3.cmml" xref="S1a.p1.18.m4.5.5.2.4"><ci id="S1a.p1.18.m4.4.4.1.1.cmml" xref="S1a.p1.18.m4.4.4.1.1">𝑞</ci><ci id="S1a.p1.18.m4.5.5.2.2.cmml" xref="S1a.p1.18.m4.5.5.2.2">𝑗</ci></list></apply><ci id="S1a.p1.18.m4.6.6.1.1.cmml" xref="S1a.p1.18.m4.6.6.1.1">𝐿</ci></apply><apply id="S1a.p1.18.m4.8.8.2.2.2.3.cmml" xref="S1a.p1.18.m4.8.8.2.2.2.3"><divide id="S1a.p1.18.m4.8.8.2.2.2.3.1.cmml" xref="S1a.p1.18.m4.8.8.2.2.2.3"></divide><ci id="S1a.p1.18.m4.8.8.2.2.2.3.2.cmml" xref="S1a.p1.18.m4.8.8.2.2.2.3.2">𝜋</ci><cn type="integer" id="S1a.p1.18.m4.8.8.2.2.2.3.3.cmml" xref="S1a.p1.18.m4.8.8.2.2.2.3.3">2</cn></apply></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S1a.p1.18.m4.8c">U_{q}\left(\bm{\theta}_{q,-j}^{(L)},\theta_{q,j}^{(L)}\pm\frac{\pi}{2}\right)</annotation><annotation encoding="application/x-llamapun" id="S1a.p1.18.m4.8d">italic_U start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT ( bold_italic_θ start_POSTSUBSCRIPT italic_q , - italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_L ) end_POSTSUPERSCRIPT , italic_θ start_POSTSUBSCRIPT italic_q , italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_L ) end_POSTSUPERSCRIPT ± divide start_ARG italic_π end_ARG start_ARG 2 end_ARG )</annotation></semantics></math>.</p>
</div>
<div id="S1a.p2" class="ltx_para">
<p id="S1a.p2.1" class="ltx_p">Finally, in order to derive the partial derivatives of the parameters in the front layers, we also need the following:
<span id="S1a.p2.1.1" class="ltx_text" style="font-size:90%;"></span></p>
<table id="S1.EGx16" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S1.Ex5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S1.Ex5.m1.1" class="ltx_Math" alttext="\displaystyle\frac{\partial\mathcal{L}}{\partial\bm{y}^{(L-1)}_{i}}" display="inline"><semantics id="S1.Ex5.m1.1a"><mstyle displaystyle="true" id="S1.Ex5.m1.1.1" xref="S1.Ex5.m1.1.1.cmml"><mfrac id="S1.Ex5.m1.1.1a" xref="S1.Ex5.m1.1.1.cmml"><mrow id="S1.Ex5.m1.1.1.3" xref="S1.Ex5.m1.1.1.3.cmml"><mo mathsize="90%" stretchy="false" id="S1.Ex5.m1.1.1.3.1" xref="S1.Ex5.m1.1.1.3.1.cmml">∂</mo><mo id="S1.Ex5.m1.1.1.3a" xref="S1.Ex5.m1.1.1.3.cmml">⁡</mo><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S1.Ex5.m1.1.1.3.2" xref="S1.Ex5.m1.1.1.3.2.cmml">ℒ</mi></mrow><mrow id="S1.Ex5.m1.1.1.1" xref="S1.Ex5.m1.1.1.1.cmml"><mo mathsize="90%" stretchy="false" id="S1.Ex5.m1.1.1.1.2" xref="S1.Ex5.m1.1.1.1.2.cmml">∂</mo><mo id="S1.Ex5.m1.1.1.1a" xref="S1.Ex5.m1.1.1.1.cmml">⁡</mo><msubsup id="S1.Ex5.m1.1.1.1.3" xref="S1.Ex5.m1.1.1.1.3.cmml"><mi mathsize="90%" id="S1.Ex5.m1.1.1.1.3.2.2" xref="S1.Ex5.m1.1.1.1.3.2.2.cmml">𝒚</mi><mi mathsize="90%" id="S1.Ex5.m1.1.1.1.3.3" xref="S1.Ex5.m1.1.1.1.3.3.cmml">i</mi><mrow id="S1.Ex5.m1.1.1.1.1.1.1" xref="S1.Ex5.m1.1.1.1.1.1.1.1.cmml"><mo maxsize="90%" minsize="90%" id="S1.Ex5.m1.1.1.1.1.1.1.2" xref="S1.Ex5.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S1.Ex5.m1.1.1.1.1.1.1.1" xref="S1.Ex5.m1.1.1.1.1.1.1.1.cmml"><mi mathsize="90%" id="S1.Ex5.m1.1.1.1.1.1.1.1.2" xref="S1.Ex5.m1.1.1.1.1.1.1.1.2.cmml">L</mi><mo mathsize="90%" stretchy="false" id="S1.Ex5.m1.1.1.1.1.1.1.1.1" xref="S1.Ex5.m1.1.1.1.1.1.1.1.1.cmml">-</mo><mn mathsize="90%" id="S1.Ex5.m1.1.1.1.1.1.1.1.3" xref="S1.Ex5.m1.1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo maxsize="90%" minsize="90%" id="S1.Ex5.m1.1.1.1.1.1.1.3" xref="S1.Ex5.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></msubsup></mrow></mfrac></mstyle><annotation-xml encoding="MathML-Content" id="S1.Ex5.m1.1b"><apply id="S1.Ex5.m1.1.1.cmml" xref="S1.Ex5.m1.1.1"><divide id="S1.Ex5.m1.1.1.2.cmml" xref="S1.Ex5.m1.1.1"></divide><apply id="S1.Ex5.m1.1.1.3.cmml" xref="S1.Ex5.m1.1.1.3"><partialdiff id="S1.Ex5.m1.1.1.3.1.cmml" xref="S1.Ex5.m1.1.1.3.1"></partialdiff><ci id="S1.Ex5.m1.1.1.3.2.cmml" xref="S1.Ex5.m1.1.1.3.2">ℒ</ci></apply><apply id="S1.Ex5.m1.1.1.1.cmml" xref="S1.Ex5.m1.1.1.1"><partialdiff id="S1.Ex5.m1.1.1.1.2.cmml" xref="S1.Ex5.m1.1.1.1.2"></partialdiff><apply id="S1.Ex5.m1.1.1.1.3.cmml" xref="S1.Ex5.m1.1.1.1.3"><csymbol cd="ambiguous" id="S1.Ex5.m1.1.1.1.3.1.cmml" xref="S1.Ex5.m1.1.1.1.3">subscript</csymbol><apply id="S1.Ex5.m1.1.1.1.3.2.cmml" xref="S1.Ex5.m1.1.1.1.3"><csymbol cd="ambiguous" id="S1.Ex5.m1.1.1.1.3.2.1.cmml" xref="S1.Ex5.m1.1.1.1.3">superscript</csymbol><ci id="S1.Ex5.m1.1.1.1.3.2.2.cmml" xref="S1.Ex5.m1.1.1.1.3.2.2">𝒚</ci><apply id="S1.Ex5.m1.1.1.1.1.1.1.1.cmml" xref="S1.Ex5.m1.1.1.1.1.1.1"><minus id="S1.Ex5.m1.1.1.1.1.1.1.1.1.cmml" xref="S1.Ex5.m1.1.1.1.1.1.1.1.1"></minus><ci id="S1.Ex5.m1.1.1.1.1.1.1.1.2.cmml" xref="S1.Ex5.m1.1.1.1.1.1.1.1.2">𝐿</ci><cn type="integer" id="S1.Ex5.m1.1.1.1.1.1.1.1.3.cmml" xref="S1.Ex5.m1.1.1.1.1.1.1.1.3">1</cn></apply></apply><ci id="S1.Ex5.m1.1.1.1.3.3.cmml" xref="S1.Ex5.m1.1.1.1.3.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.Ex5.m1.1c">\displaystyle\frac{\partial\mathcal{L}}{\partial\bm{y}^{(L-1)}_{i}}</annotation><annotation encoding="application/x-llamapun" id="S1.Ex5.m1.1d">divide start_ARG ∂ caligraphic_L end_ARG start_ARG ∂ bold_italic_y start_POSTSUPERSCRIPT ( italic_L - 1 ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_ARG</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S1.Ex5.m2.6" class="ltx_Math" alttext="\displaystyle=\frac{\partial\mathcal{L}}{\partial\bm{y}^{(L)}_{i}}+\sum_{s=1}^%
{S_{m}}\left(\frac{\partial\mathcal{L}}{\partial\bm{y}^{(L)}_{s}}\right)^{\top%
}\frac{\partial\bm{y}^{(L)}_{s}}{\partial\bm{o}_{i}^{(L)}}\cdot\frac{\partial%
\bm{o}_{i}^{(L)}}{\partial\bm{y}^{(L-1)}_{i}}" display="inline"><semantics id="S1.Ex5.m2.6a"><mrow id="S1.Ex5.m2.6.7" xref="S1.Ex5.m2.6.7.cmml"><mi id="S1.Ex5.m2.6.7.2" xref="S1.Ex5.m2.6.7.2.cmml"></mi><mo mathsize="90%" stretchy="false" id="S1.Ex5.m2.6.7.1" xref="S1.Ex5.m2.6.7.1.cmml">=</mo><mrow id="S1.Ex5.m2.6.7.3" xref="S1.Ex5.m2.6.7.3.cmml"><mstyle displaystyle="true" id="S1.Ex5.m2.1.1" xref="S1.Ex5.m2.1.1.cmml"><mfrac id="S1.Ex5.m2.1.1a" xref="S1.Ex5.m2.1.1.cmml"><mrow id="S1.Ex5.m2.1.1.3" xref="S1.Ex5.m2.1.1.3.cmml"><mo mathsize="90%" stretchy="false" id="S1.Ex5.m2.1.1.3.1" xref="S1.Ex5.m2.1.1.3.1.cmml">∂</mo><mo id="S1.Ex5.m2.1.1.3a" xref="S1.Ex5.m2.1.1.3.cmml">⁡</mo><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S1.Ex5.m2.1.1.3.2" xref="S1.Ex5.m2.1.1.3.2.cmml">ℒ</mi></mrow><mrow id="S1.Ex5.m2.1.1.1" xref="S1.Ex5.m2.1.1.1.cmml"><mo mathsize="90%" stretchy="false" id="S1.Ex5.m2.1.1.1.2" xref="S1.Ex5.m2.1.1.1.2.cmml">∂</mo><mo id="S1.Ex5.m2.1.1.1a" xref="S1.Ex5.m2.1.1.1.cmml">⁡</mo><msubsup id="S1.Ex5.m2.1.1.1.3" xref="S1.Ex5.m2.1.1.1.3.cmml"><mi mathsize="90%" id="S1.Ex5.m2.1.1.1.3.2.2" xref="S1.Ex5.m2.1.1.1.3.2.2.cmml">𝒚</mi><mi mathsize="90%" id="S1.Ex5.m2.1.1.1.3.3" xref="S1.Ex5.m2.1.1.1.3.3.cmml">i</mi><mrow id="S1.Ex5.m2.1.1.1.1.1.3" xref="S1.Ex5.m2.1.1.1.3.cmml"><mo maxsize="90%" minsize="90%" id="S1.Ex5.m2.1.1.1.1.1.3.1" xref="S1.Ex5.m2.1.1.1.3.cmml">(</mo><mi mathsize="90%" id="S1.Ex5.m2.1.1.1.1.1.1" xref="S1.Ex5.m2.1.1.1.1.1.1.cmml">L</mi><mo maxsize="90%" minsize="90%" id="S1.Ex5.m2.1.1.1.1.1.3.2" xref="S1.Ex5.m2.1.1.1.3.cmml">)</mo></mrow></msubsup></mrow></mfrac></mstyle><mo mathsize="90%" stretchy="false" id="S1.Ex5.m2.6.7.3.1" xref="S1.Ex5.m2.6.7.3.1.cmml">+</mo><mrow id="S1.Ex5.m2.6.7.3.2" xref="S1.Ex5.m2.6.7.3.2.cmml"><mstyle displaystyle="true" id="S1.Ex5.m2.6.7.3.2.1" xref="S1.Ex5.m2.6.7.3.2.1.cmml"><munderover id="S1.Ex5.m2.6.7.3.2.1a" xref="S1.Ex5.m2.6.7.3.2.1.cmml"><mo largeop="true" mathsize="90%" movablelimits="false" stretchy="false" symmetric="true" id="S1.Ex5.m2.6.7.3.2.1.2.2" xref="S1.Ex5.m2.6.7.3.2.1.2.2.cmml">∑</mo><mrow id="S1.Ex5.m2.6.7.3.2.1.2.3" xref="S1.Ex5.m2.6.7.3.2.1.2.3.cmml"><mi mathsize="90%" id="S1.Ex5.m2.6.7.3.2.1.2.3.2" xref="S1.Ex5.m2.6.7.3.2.1.2.3.2.cmml">s</mi><mo mathsize="90%" stretchy="false" id="S1.Ex5.m2.6.7.3.2.1.2.3.1" xref="S1.Ex5.m2.6.7.3.2.1.2.3.1.cmml">=</mo><mn mathsize="90%" id="S1.Ex5.m2.6.7.3.2.1.2.3.3" xref="S1.Ex5.m2.6.7.3.2.1.2.3.3.cmml">1</mn></mrow><msub id="S1.Ex5.m2.6.7.3.2.1.3" xref="S1.Ex5.m2.6.7.3.2.1.3.cmml"><mi mathsize="90%" id="S1.Ex5.m2.6.7.3.2.1.3.2" xref="S1.Ex5.m2.6.7.3.2.1.3.2.cmml">S</mi><mi mathsize="90%" id="S1.Ex5.m2.6.7.3.2.1.3.3" xref="S1.Ex5.m2.6.7.3.2.1.3.3.cmml">m</mi></msub></munderover></mstyle><mrow id="S1.Ex5.m2.6.7.3.2.2" xref="S1.Ex5.m2.6.7.3.2.2.cmml"><mrow id="S1.Ex5.m2.6.7.3.2.2.2" xref="S1.Ex5.m2.6.7.3.2.2.2.cmml"><msup id="S1.Ex5.m2.6.7.3.2.2.2.2" xref="S1.Ex5.m2.6.7.3.2.2.2.2.cmml"><mrow id="S1.Ex5.m2.6.7.3.2.2.2.2.2.2" xref="S1.Ex5.m2.2.2.cmml"><mo id="S1.Ex5.m2.6.7.3.2.2.2.2.2.2.1" xref="S1.Ex5.m2.2.2.cmml">(</mo><mstyle displaystyle="true" id="S1.Ex5.m2.2.2" xref="S1.Ex5.m2.2.2.cmml"><mfrac id="S1.Ex5.m2.2.2a" xref="S1.Ex5.m2.2.2.cmml"><mrow id="S1.Ex5.m2.2.2.3" xref="S1.Ex5.m2.2.2.3.cmml"><mo mathsize="90%" stretchy="false" id="S1.Ex5.m2.2.2.3.1" xref="S1.Ex5.m2.2.2.3.1.cmml">∂</mo><mo id="S1.Ex5.m2.2.2.3a" xref="S1.Ex5.m2.2.2.3.cmml">⁡</mo><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S1.Ex5.m2.2.2.3.2" xref="S1.Ex5.m2.2.2.3.2.cmml">ℒ</mi></mrow><mrow id="S1.Ex5.m2.2.2.1" xref="S1.Ex5.m2.2.2.1.cmml"><mo mathsize="90%" stretchy="false" id="S1.Ex5.m2.2.2.1.2" xref="S1.Ex5.m2.2.2.1.2.cmml">∂</mo><mo id="S1.Ex5.m2.2.2.1a" xref="S1.Ex5.m2.2.2.1.cmml">⁡</mo><msubsup id="S1.Ex5.m2.2.2.1.3" xref="S1.Ex5.m2.2.2.1.3.cmml"><mi mathsize="90%" id="S1.Ex5.m2.2.2.1.3.2.2" xref="S1.Ex5.m2.2.2.1.3.2.2.cmml">𝒚</mi><mi mathsize="90%" id="S1.Ex5.m2.2.2.1.3.3" xref="S1.Ex5.m2.2.2.1.3.3.cmml">s</mi><mrow id="S1.Ex5.m2.2.2.1.1.1.3" xref="S1.Ex5.m2.2.2.1.3.cmml"><mo maxsize="90%" minsize="90%" id="S1.Ex5.m2.2.2.1.1.1.3.1" xref="S1.Ex5.m2.2.2.1.3.cmml">(</mo><mi mathsize="90%" id="S1.Ex5.m2.2.2.1.1.1.1" xref="S1.Ex5.m2.2.2.1.1.1.1.cmml">L</mi><mo maxsize="90%" minsize="90%" id="S1.Ex5.m2.2.2.1.1.1.3.2" xref="S1.Ex5.m2.2.2.1.3.cmml">)</mo></mrow></msubsup></mrow></mfrac></mstyle><mo id="S1.Ex5.m2.6.7.3.2.2.2.2.2.2.2" xref="S1.Ex5.m2.2.2.cmml">)</mo></mrow><mo mathsize="90%" stretchy="false" id="S1.Ex5.m2.6.7.3.2.2.2.2.3" xref="S1.Ex5.m2.6.7.3.2.2.2.2.3.cmml">⊤</mo></msup><mo id="S1.Ex5.m2.6.7.3.2.2.2.1" xref="S1.Ex5.m2.6.7.3.2.2.2.1.cmml">⁢</mo><mstyle displaystyle="true" id="S1.Ex5.m2.4.4" xref="S1.Ex5.m2.4.4.cmml"><mfrac id="S1.Ex5.m2.4.4a" xref="S1.Ex5.m2.4.4.cmml"><mrow id="S1.Ex5.m2.3.3.1" xref="S1.Ex5.m2.3.3.1.cmml"><mo mathsize="90%" stretchy="false" id="S1.Ex5.m2.3.3.1.2" xref="S1.Ex5.m2.3.3.1.2.cmml">∂</mo><mo id="S1.Ex5.m2.3.3.1a" xref="S1.Ex5.m2.3.3.1.cmml">⁡</mo><msubsup id="S1.Ex5.m2.3.3.1.3" xref="S1.Ex5.m2.3.3.1.3.cmml"><mi mathsize="90%" id="S1.Ex5.m2.3.3.1.3.2.2" xref="S1.Ex5.m2.3.3.1.3.2.2.cmml">𝒚</mi><mi mathsize="90%" id="S1.Ex5.m2.3.3.1.3.3" xref="S1.Ex5.m2.3.3.1.3.3.cmml">s</mi><mrow id="S1.Ex5.m2.3.3.1.1.1.3" xref="S1.Ex5.m2.3.3.1.3.cmml"><mo maxsize="90%" minsize="90%" id="S1.Ex5.m2.3.3.1.1.1.3.1" xref="S1.Ex5.m2.3.3.1.3.cmml">(</mo><mi mathsize="90%" id="S1.Ex5.m2.3.3.1.1.1.1" xref="S1.Ex5.m2.3.3.1.1.1.1.cmml">L</mi><mo maxsize="90%" minsize="90%" id="S1.Ex5.m2.3.3.1.1.1.3.2" xref="S1.Ex5.m2.3.3.1.3.cmml">)</mo></mrow></msubsup></mrow><mrow id="S1.Ex5.m2.4.4.2" xref="S1.Ex5.m2.4.4.2.cmml"><mo mathsize="90%" stretchy="false" id="S1.Ex5.m2.4.4.2.2" xref="S1.Ex5.m2.4.4.2.2.cmml">∂</mo><mo id="S1.Ex5.m2.4.4.2a" xref="S1.Ex5.m2.4.4.2.cmml">⁡</mo><msubsup id="S1.Ex5.m2.4.4.2.3" xref="S1.Ex5.m2.4.4.2.3.cmml"><mi mathsize="90%" id="S1.Ex5.m2.4.4.2.3.2.2" xref="S1.Ex5.m2.4.4.2.3.2.2.cmml">𝒐</mi><mi mathsize="90%" id="S1.Ex5.m2.4.4.2.3.2.3" xref="S1.Ex5.m2.4.4.2.3.2.3.cmml">i</mi><mrow id="S1.Ex5.m2.4.4.2.1.1.3" xref="S1.Ex5.m2.4.4.2.3.cmml"><mo maxsize="90%" minsize="90%" id="S1.Ex5.m2.4.4.2.1.1.3.1" xref="S1.Ex5.m2.4.4.2.3.cmml">(</mo><mi mathsize="90%" id="S1.Ex5.m2.4.4.2.1.1.1" xref="S1.Ex5.m2.4.4.2.1.1.1.cmml">L</mi><mo maxsize="90%" minsize="90%" id="S1.Ex5.m2.4.4.2.1.1.3.2" xref="S1.Ex5.m2.4.4.2.3.cmml">)</mo></mrow></msubsup></mrow></mfrac></mstyle></mrow><mo mathsize="90%" stretchy="false" id="S1.Ex5.m2.6.7.3.2.2.1" xref="S1.Ex5.m2.6.7.3.2.2.1.cmml">⋅</mo><mstyle displaystyle="true" id="S1.Ex5.m2.6.6" xref="S1.Ex5.m2.6.6.cmml"><mfrac id="S1.Ex5.m2.6.6a" xref="S1.Ex5.m2.6.6.cmml"><mrow id="S1.Ex5.m2.5.5.1" xref="S1.Ex5.m2.5.5.1.cmml"><mo mathsize="90%" stretchy="false" id="S1.Ex5.m2.5.5.1.2" xref="S1.Ex5.m2.5.5.1.2.cmml">∂</mo><mo id="S1.Ex5.m2.5.5.1a" xref="S1.Ex5.m2.5.5.1.cmml">⁡</mo><msubsup id="S1.Ex5.m2.5.5.1.3" xref="S1.Ex5.m2.5.5.1.3.cmml"><mi mathsize="90%" id="S1.Ex5.m2.5.5.1.3.2.2" xref="S1.Ex5.m2.5.5.1.3.2.2.cmml">𝒐</mi><mi mathsize="90%" id="S1.Ex5.m2.5.5.1.3.2.3" xref="S1.Ex5.m2.5.5.1.3.2.3.cmml">i</mi><mrow id="S1.Ex5.m2.5.5.1.1.1.3" xref="S1.Ex5.m2.5.5.1.3.cmml"><mo maxsize="90%" minsize="90%" id="S1.Ex5.m2.5.5.1.1.1.3.1" xref="S1.Ex5.m2.5.5.1.3.cmml">(</mo><mi mathsize="90%" id="S1.Ex5.m2.5.5.1.1.1.1" xref="S1.Ex5.m2.5.5.1.1.1.1.cmml">L</mi><mo maxsize="90%" minsize="90%" id="S1.Ex5.m2.5.5.1.1.1.3.2" xref="S1.Ex5.m2.5.5.1.3.cmml">)</mo></mrow></msubsup></mrow><mrow id="S1.Ex5.m2.6.6.2" xref="S1.Ex5.m2.6.6.2.cmml"><mo mathsize="90%" stretchy="false" id="S1.Ex5.m2.6.6.2.2" xref="S1.Ex5.m2.6.6.2.2.cmml">∂</mo><mo id="S1.Ex5.m2.6.6.2a" xref="S1.Ex5.m2.6.6.2.cmml">⁡</mo><msubsup id="S1.Ex5.m2.6.6.2.3" xref="S1.Ex5.m2.6.6.2.3.cmml"><mi mathsize="90%" id="S1.Ex5.m2.6.6.2.3.2.2" xref="S1.Ex5.m2.6.6.2.3.2.2.cmml">𝒚</mi><mi mathsize="90%" id="S1.Ex5.m2.6.6.2.3.3" xref="S1.Ex5.m2.6.6.2.3.3.cmml">i</mi><mrow id="S1.Ex5.m2.6.6.2.1.1.1" xref="S1.Ex5.m2.6.6.2.1.1.1.1.cmml"><mo maxsize="90%" minsize="90%" id="S1.Ex5.m2.6.6.2.1.1.1.2" xref="S1.Ex5.m2.6.6.2.1.1.1.1.cmml">(</mo><mrow id="S1.Ex5.m2.6.6.2.1.1.1.1" xref="S1.Ex5.m2.6.6.2.1.1.1.1.cmml"><mi mathsize="90%" id="S1.Ex5.m2.6.6.2.1.1.1.1.2" xref="S1.Ex5.m2.6.6.2.1.1.1.1.2.cmml">L</mi><mo mathsize="90%" stretchy="false" id="S1.Ex5.m2.6.6.2.1.1.1.1.1" xref="S1.Ex5.m2.6.6.2.1.1.1.1.1.cmml">-</mo><mn mathsize="90%" id="S1.Ex5.m2.6.6.2.1.1.1.1.3" xref="S1.Ex5.m2.6.6.2.1.1.1.1.3.cmml">1</mn></mrow><mo maxsize="90%" minsize="90%" id="S1.Ex5.m2.6.6.2.1.1.1.3" xref="S1.Ex5.m2.6.6.2.1.1.1.1.cmml">)</mo></mrow></msubsup></mrow></mfrac></mstyle></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.Ex5.m2.6b"><apply id="S1.Ex5.m2.6.7.cmml" xref="S1.Ex5.m2.6.7"><eq id="S1.Ex5.m2.6.7.1.cmml" xref="S1.Ex5.m2.6.7.1"></eq><csymbol cd="latexml" id="S1.Ex5.m2.6.7.2.cmml" xref="S1.Ex5.m2.6.7.2">absent</csymbol><apply id="S1.Ex5.m2.6.7.3.cmml" xref="S1.Ex5.m2.6.7.3"><plus id="S1.Ex5.m2.6.7.3.1.cmml" xref="S1.Ex5.m2.6.7.3.1"></plus><apply id="S1.Ex5.m2.1.1.cmml" xref="S1.Ex5.m2.1.1"><divide id="S1.Ex5.m2.1.1.2.cmml" xref="S1.Ex5.m2.1.1"></divide><apply id="S1.Ex5.m2.1.1.3.cmml" xref="S1.Ex5.m2.1.1.3"><partialdiff id="S1.Ex5.m2.1.1.3.1.cmml" xref="S1.Ex5.m2.1.1.3.1"></partialdiff><ci id="S1.Ex5.m2.1.1.3.2.cmml" xref="S1.Ex5.m2.1.1.3.2">ℒ</ci></apply><apply id="S1.Ex5.m2.1.1.1.cmml" xref="S1.Ex5.m2.1.1.1"><partialdiff id="S1.Ex5.m2.1.1.1.2.cmml" xref="S1.Ex5.m2.1.1.1.2"></partialdiff><apply id="S1.Ex5.m2.1.1.1.3.cmml" xref="S1.Ex5.m2.1.1.1.3"><csymbol cd="ambiguous" id="S1.Ex5.m2.1.1.1.3.1.cmml" xref="S1.Ex5.m2.1.1.1.3">subscript</csymbol><apply id="S1.Ex5.m2.1.1.1.3.2.cmml" xref="S1.Ex5.m2.1.1.1.3"><csymbol cd="ambiguous" id="S1.Ex5.m2.1.1.1.3.2.1.cmml" xref="S1.Ex5.m2.1.1.1.3">superscript</csymbol><ci id="S1.Ex5.m2.1.1.1.3.2.2.cmml" xref="S1.Ex5.m2.1.1.1.3.2.2">𝒚</ci><ci id="S1.Ex5.m2.1.1.1.1.1.1.cmml" xref="S1.Ex5.m2.1.1.1.1.1.1">𝐿</ci></apply><ci id="S1.Ex5.m2.1.1.1.3.3.cmml" xref="S1.Ex5.m2.1.1.1.3.3">𝑖</ci></apply></apply></apply><apply id="S1.Ex5.m2.6.7.3.2.cmml" xref="S1.Ex5.m2.6.7.3.2"><apply id="S1.Ex5.m2.6.7.3.2.1.cmml" xref="S1.Ex5.m2.6.7.3.2.1"><csymbol cd="ambiguous" id="S1.Ex5.m2.6.7.3.2.1.1.cmml" xref="S1.Ex5.m2.6.7.3.2.1">superscript</csymbol><apply id="S1.Ex5.m2.6.7.3.2.1.2.cmml" xref="S1.Ex5.m2.6.7.3.2.1"><csymbol cd="ambiguous" id="S1.Ex5.m2.6.7.3.2.1.2.1.cmml" xref="S1.Ex5.m2.6.7.3.2.1">subscript</csymbol><sum id="S1.Ex5.m2.6.7.3.2.1.2.2.cmml" xref="S1.Ex5.m2.6.7.3.2.1.2.2"></sum><apply id="S1.Ex5.m2.6.7.3.2.1.2.3.cmml" xref="S1.Ex5.m2.6.7.3.2.1.2.3"><eq id="S1.Ex5.m2.6.7.3.2.1.2.3.1.cmml" xref="S1.Ex5.m2.6.7.3.2.1.2.3.1"></eq><ci id="S1.Ex5.m2.6.7.3.2.1.2.3.2.cmml" xref="S1.Ex5.m2.6.7.3.2.1.2.3.2">𝑠</ci><cn type="integer" id="S1.Ex5.m2.6.7.3.2.1.2.3.3.cmml" xref="S1.Ex5.m2.6.7.3.2.1.2.3.3">1</cn></apply></apply><apply id="S1.Ex5.m2.6.7.3.2.1.3.cmml" xref="S1.Ex5.m2.6.7.3.2.1.3"><csymbol cd="ambiguous" id="S1.Ex5.m2.6.7.3.2.1.3.1.cmml" xref="S1.Ex5.m2.6.7.3.2.1.3">subscript</csymbol><ci id="S1.Ex5.m2.6.7.3.2.1.3.2.cmml" xref="S1.Ex5.m2.6.7.3.2.1.3.2">𝑆</ci><ci id="S1.Ex5.m2.6.7.3.2.1.3.3.cmml" xref="S1.Ex5.m2.6.7.3.2.1.3.3">𝑚</ci></apply></apply><apply id="S1.Ex5.m2.6.7.3.2.2.cmml" xref="S1.Ex5.m2.6.7.3.2.2"><ci id="S1.Ex5.m2.6.7.3.2.2.1.cmml" xref="S1.Ex5.m2.6.7.3.2.2.1">⋅</ci><apply id="S1.Ex5.m2.6.7.3.2.2.2.cmml" xref="S1.Ex5.m2.6.7.3.2.2.2"><times id="S1.Ex5.m2.6.7.3.2.2.2.1.cmml" xref="S1.Ex5.m2.6.7.3.2.2.2.1"></times><apply id="S1.Ex5.m2.6.7.3.2.2.2.2.cmml" xref="S1.Ex5.m2.6.7.3.2.2.2.2"><csymbol cd="ambiguous" id="S1.Ex5.m2.6.7.3.2.2.2.2.1.cmml" xref="S1.Ex5.m2.6.7.3.2.2.2.2">superscript</csymbol><apply id="S1.Ex5.m2.2.2.cmml" xref="S1.Ex5.m2.6.7.3.2.2.2.2.2.2"><divide id="S1.Ex5.m2.2.2.2.cmml" xref="S1.Ex5.m2.6.7.3.2.2.2.2.2.2"></divide><apply id="S1.Ex5.m2.2.2.3.cmml" xref="S1.Ex5.m2.2.2.3"><partialdiff id="S1.Ex5.m2.2.2.3.1.cmml" xref="S1.Ex5.m2.2.2.3.1"></partialdiff><ci id="S1.Ex5.m2.2.2.3.2.cmml" xref="S1.Ex5.m2.2.2.3.2">ℒ</ci></apply><apply id="S1.Ex5.m2.2.2.1.cmml" xref="S1.Ex5.m2.2.2.1"><partialdiff id="S1.Ex5.m2.2.2.1.2.cmml" xref="S1.Ex5.m2.2.2.1.2"></partialdiff><apply id="S1.Ex5.m2.2.2.1.3.cmml" xref="S1.Ex5.m2.2.2.1.3"><csymbol cd="ambiguous" id="S1.Ex5.m2.2.2.1.3.1.cmml" xref="S1.Ex5.m2.2.2.1.3">subscript</csymbol><apply id="S1.Ex5.m2.2.2.1.3.2.cmml" xref="S1.Ex5.m2.2.2.1.3"><csymbol cd="ambiguous" id="S1.Ex5.m2.2.2.1.3.2.1.cmml" xref="S1.Ex5.m2.2.2.1.3">superscript</csymbol><ci id="S1.Ex5.m2.2.2.1.3.2.2.cmml" xref="S1.Ex5.m2.2.2.1.3.2.2">𝒚</ci><ci id="S1.Ex5.m2.2.2.1.1.1.1.cmml" xref="S1.Ex5.m2.2.2.1.1.1.1">𝐿</ci></apply><ci id="S1.Ex5.m2.2.2.1.3.3.cmml" xref="S1.Ex5.m2.2.2.1.3.3">𝑠</ci></apply></apply></apply><csymbol cd="latexml" id="S1.Ex5.m2.6.7.3.2.2.2.2.3.cmml" xref="S1.Ex5.m2.6.7.3.2.2.2.2.3">top</csymbol></apply><apply id="S1.Ex5.m2.4.4.cmml" xref="S1.Ex5.m2.4.4"><divide id="S1.Ex5.m2.4.4.3.cmml" xref="S1.Ex5.m2.4.4"></divide><apply id="S1.Ex5.m2.3.3.1.cmml" xref="S1.Ex5.m2.3.3.1"><partialdiff id="S1.Ex5.m2.3.3.1.2.cmml" xref="S1.Ex5.m2.3.3.1.2"></partialdiff><apply id="S1.Ex5.m2.3.3.1.3.cmml" xref="S1.Ex5.m2.3.3.1.3"><csymbol cd="ambiguous" id="S1.Ex5.m2.3.3.1.3.1.cmml" xref="S1.Ex5.m2.3.3.1.3">subscript</csymbol><apply id="S1.Ex5.m2.3.3.1.3.2.cmml" xref="S1.Ex5.m2.3.3.1.3"><csymbol cd="ambiguous" id="S1.Ex5.m2.3.3.1.3.2.1.cmml" xref="S1.Ex5.m2.3.3.1.3">superscript</csymbol><ci id="S1.Ex5.m2.3.3.1.3.2.2.cmml" xref="S1.Ex5.m2.3.3.1.3.2.2">𝒚</ci><ci id="S1.Ex5.m2.3.3.1.1.1.1.cmml" xref="S1.Ex5.m2.3.3.1.1.1.1">𝐿</ci></apply><ci id="S1.Ex5.m2.3.3.1.3.3.cmml" xref="S1.Ex5.m2.3.3.1.3.3">𝑠</ci></apply></apply><apply id="S1.Ex5.m2.4.4.2.cmml" xref="S1.Ex5.m2.4.4.2"><partialdiff id="S1.Ex5.m2.4.4.2.2.cmml" xref="S1.Ex5.m2.4.4.2.2"></partialdiff><apply id="S1.Ex5.m2.4.4.2.3.cmml" xref="S1.Ex5.m2.4.4.2.3"><csymbol cd="ambiguous" id="S1.Ex5.m2.4.4.2.3.1.cmml" xref="S1.Ex5.m2.4.4.2.3">superscript</csymbol><apply id="S1.Ex5.m2.4.4.2.3.2.cmml" xref="S1.Ex5.m2.4.4.2.3"><csymbol cd="ambiguous" id="S1.Ex5.m2.4.4.2.3.2.1.cmml" xref="S1.Ex5.m2.4.4.2.3">subscript</csymbol><ci id="S1.Ex5.m2.4.4.2.3.2.2.cmml" xref="S1.Ex5.m2.4.4.2.3.2.2">𝒐</ci><ci id="S1.Ex5.m2.4.4.2.3.2.3.cmml" xref="S1.Ex5.m2.4.4.2.3.2.3">𝑖</ci></apply><ci id="S1.Ex5.m2.4.4.2.1.1.1.cmml" xref="S1.Ex5.m2.4.4.2.1.1.1">𝐿</ci></apply></apply></apply></apply><apply id="S1.Ex5.m2.6.6.cmml" xref="S1.Ex5.m2.6.6"><divide id="S1.Ex5.m2.6.6.3.cmml" xref="S1.Ex5.m2.6.6"></divide><apply id="S1.Ex5.m2.5.5.1.cmml" xref="S1.Ex5.m2.5.5.1"><partialdiff id="S1.Ex5.m2.5.5.1.2.cmml" xref="S1.Ex5.m2.5.5.1.2"></partialdiff><apply id="S1.Ex5.m2.5.5.1.3.cmml" xref="S1.Ex5.m2.5.5.1.3"><csymbol cd="ambiguous" id="S1.Ex5.m2.5.5.1.3.1.cmml" xref="S1.Ex5.m2.5.5.1.3">superscript</csymbol><apply id="S1.Ex5.m2.5.5.1.3.2.cmml" xref="S1.Ex5.m2.5.5.1.3"><csymbol cd="ambiguous" id="S1.Ex5.m2.5.5.1.3.2.1.cmml" xref="S1.Ex5.m2.5.5.1.3">subscript</csymbol><ci id="S1.Ex5.m2.5.5.1.3.2.2.cmml" xref="S1.Ex5.m2.5.5.1.3.2.2">𝒐</ci><ci id="S1.Ex5.m2.5.5.1.3.2.3.cmml" xref="S1.Ex5.m2.5.5.1.3.2.3">𝑖</ci></apply><ci id="S1.Ex5.m2.5.5.1.1.1.1.cmml" xref="S1.Ex5.m2.5.5.1.1.1.1">𝐿</ci></apply></apply><apply id="S1.Ex5.m2.6.6.2.cmml" xref="S1.Ex5.m2.6.6.2"><partialdiff id="S1.Ex5.m2.6.6.2.2.cmml" xref="S1.Ex5.m2.6.6.2.2"></partialdiff><apply id="S1.Ex5.m2.6.6.2.3.cmml" xref="S1.Ex5.m2.6.6.2.3"><csymbol cd="ambiguous" id="S1.Ex5.m2.6.6.2.3.1.cmml" xref="S1.Ex5.m2.6.6.2.3">subscript</csymbol><apply id="S1.Ex5.m2.6.6.2.3.2.cmml" xref="S1.Ex5.m2.6.6.2.3"><csymbol cd="ambiguous" id="S1.Ex5.m2.6.6.2.3.2.1.cmml" xref="S1.Ex5.m2.6.6.2.3">superscript</csymbol><ci id="S1.Ex5.m2.6.6.2.3.2.2.cmml" xref="S1.Ex5.m2.6.6.2.3.2.2">𝒚</ci><apply id="S1.Ex5.m2.6.6.2.1.1.1.1.cmml" xref="S1.Ex5.m2.6.6.2.1.1.1"><minus id="S1.Ex5.m2.6.6.2.1.1.1.1.1.cmml" xref="S1.Ex5.m2.6.6.2.1.1.1.1.1"></minus><ci id="S1.Ex5.m2.6.6.2.1.1.1.1.2.cmml" xref="S1.Ex5.m2.6.6.2.1.1.1.1.2">𝐿</ci><cn type="integer" id="S1.Ex5.m2.6.6.2.1.1.1.1.3.cmml" xref="S1.Ex5.m2.6.6.2.1.1.1.1.3">1</cn></apply></apply><ci id="S1.Ex5.m2.6.6.2.3.3.cmml" xref="S1.Ex5.m2.6.6.2.3.3">𝑖</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.Ex5.m2.6c">\displaystyle=\frac{\partial\mathcal{L}}{\partial\bm{y}^{(L)}_{i}}+\sum_{s=1}^%
{S_{m}}\left(\frac{\partial\mathcal{L}}{\partial\bm{y}^{(L)}_{s}}\right)^{\top%
}\frac{\partial\bm{y}^{(L)}_{s}}{\partial\bm{o}_{i}^{(L)}}\cdot\frac{\partial%
\bm{o}_{i}^{(L)}}{\partial\bm{y}^{(L-1)}_{i}}</annotation><annotation encoding="application/x-llamapun" id="S1.Ex5.m2.6d">= divide start_ARG ∂ caligraphic_L end_ARG start_ARG ∂ bold_italic_y start_POSTSUPERSCRIPT ( italic_L ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_ARG + ∑ start_POSTSUBSCRIPT italic_s = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_S start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT end_POSTSUPERSCRIPT ( divide start_ARG ∂ caligraphic_L end_ARG start_ARG ∂ bold_italic_y start_POSTSUPERSCRIPT ( italic_L ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT end_ARG ) start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT divide start_ARG ∂ bold_italic_y start_POSTSUPERSCRIPT ( italic_L ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT end_ARG start_ARG ∂ bold_italic_o start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_L ) end_POSTSUPERSCRIPT end_ARG ⋅ divide start_ARG ∂ bold_italic_o start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_L ) end_POSTSUPERSCRIPT end_ARG start_ARG ∂ bold_italic_y start_POSTSUPERSCRIPT ( italic_L - 1 ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S1.Ex6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S1.Ex6.m1.11" class="ltx_Math" alttext="\displaystyle+\left(\frac{\partial\mathcal{L}}{\partial\bm{y}^{(L)}_{i}}\right%
)^{\top}\sum_{j=1}^{S_{m}}\frac{\partial\bm{y}^{(L)}_{i}}{\partial\alpha_{i,j}%
^{(L)}}\cdot\frac{\partial\alpha_{i,j}^{(L)}}{\partial\langle Z_{q}\rangle_{i}%
}\cdot\frac{\partial\langle Z_{q}\rangle_{i}}{\partial\bm{y}^{(L-1)}_{i}}" display="inline"><semantics id="S1.Ex6.m1.11a"><mrow id="S1.Ex6.m1.11.12" xref="S1.Ex6.m1.11.12.cmml"><mo mathsize="90%" stretchy="false" id="S1.Ex6.m1.11.12.1" xref="S1.Ex6.m1.11.12.1.cmml">+</mo><mrow id="S1.Ex6.m1.11.12.2" xref="S1.Ex6.m1.11.12.2.cmml"><msup id="S1.Ex6.m1.11.12.2.2" xref="S1.Ex6.m1.11.12.2.2.cmml"><mrow id="S1.Ex6.m1.11.12.2.2.2.2" xref="S1.Ex6.m1.1.1.cmml"><mo id="S1.Ex6.m1.11.12.2.2.2.2.1" xref="S1.Ex6.m1.1.1.cmml">(</mo><mstyle displaystyle="true" id="S1.Ex6.m1.1.1" xref="S1.Ex6.m1.1.1.cmml"><mfrac id="S1.Ex6.m1.1.1a" xref="S1.Ex6.m1.1.1.cmml"><mrow id="S1.Ex6.m1.1.1.3" xref="S1.Ex6.m1.1.1.3.cmml"><mo mathsize="90%" stretchy="false" id="S1.Ex6.m1.1.1.3.1" xref="S1.Ex6.m1.1.1.3.1.cmml">∂</mo><mo id="S1.Ex6.m1.1.1.3a" xref="S1.Ex6.m1.1.1.3.cmml">⁡</mo><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S1.Ex6.m1.1.1.3.2" xref="S1.Ex6.m1.1.1.3.2.cmml">ℒ</mi></mrow><mrow id="S1.Ex6.m1.1.1.1" xref="S1.Ex6.m1.1.1.1.cmml"><mo mathsize="90%" stretchy="false" id="S1.Ex6.m1.1.1.1.2" xref="S1.Ex6.m1.1.1.1.2.cmml">∂</mo><mo id="S1.Ex6.m1.1.1.1a" xref="S1.Ex6.m1.1.1.1.cmml">⁡</mo><msubsup id="S1.Ex6.m1.1.1.1.3" xref="S1.Ex6.m1.1.1.1.3.cmml"><mi mathsize="90%" id="S1.Ex6.m1.1.1.1.3.2.2" xref="S1.Ex6.m1.1.1.1.3.2.2.cmml">𝒚</mi><mi mathsize="90%" id="S1.Ex6.m1.1.1.1.3.3" xref="S1.Ex6.m1.1.1.1.3.3.cmml">i</mi><mrow id="S1.Ex6.m1.1.1.1.1.1.3" xref="S1.Ex6.m1.1.1.1.3.cmml"><mo maxsize="90%" minsize="90%" id="S1.Ex6.m1.1.1.1.1.1.3.1" xref="S1.Ex6.m1.1.1.1.3.cmml">(</mo><mi mathsize="90%" id="S1.Ex6.m1.1.1.1.1.1.1" xref="S1.Ex6.m1.1.1.1.1.1.1.cmml">L</mi><mo maxsize="90%" minsize="90%" id="S1.Ex6.m1.1.1.1.1.1.3.2" xref="S1.Ex6.m1.1.1.1.3.cmml">)</mo></mrow></msubsup></mrow></mfrac></mstyle><mo id="S1.Ex6.m1.11.12.2.2.2.2.2" xref="S1.Ex6.m1.1.1.cmml">)</mo></mrow><mo mathsize="90%" stretchy="false" id="S1.Ex6.m1.11.12.2.2.3" xref="S1.Ex6.m1.11.12.2.2.3.cmml">⊤</mo></msup><mo id="S1.Ex6.m1.11.12.2.1" xref="S1.Ex6.m1.11.12.2.1.cmml">⁢</mo><mrow id="S1.Ex6.m1.11.12.2.3" xref="S1.Ex6.m1.11.12.2.3.cmml"><mstyle displaystyle="true" id="S1.Ex6.m1.11.12.2.3.1" xref="S1.Ex6.m1.11.12.2.3.1.cmml"><munderover id="S1.Ex6.m1.11.12.2.3.1a" xref="S1.Ex6.m1.11.12.2.3.1.cmml"><mo largeop="true" mathsize="90%" movablelimits="false" stretchy="false" symmetric="true" id="S1.Ex6.m1.11.12.2.3.1.2.2" xref="S1.Ex6.m1.11.12.2.3.1.2.2.cmml">∑</mo><mrow id="S1.Ex6.m1.11.12.2.3.1.2.3" xref="S1.Ex6.m1.11.12.2.3.1.2.3.cmml"><mi mathsize="90%" id="S1.Ex6.m1.11.12.2.3.1.2.3.2" xref="S1.Ex6.m1.11.12.2.3.1.2.3.2.cmml">j</mi><mo mathsize="90%" stretchy="false" id="S1.Ex6.m1.11.12.2.3.1.2.3.1" xref="S1.Ex6.m1.11.12.2.3.1.2.3.1.cmml">=</mo><mn mathsize="90%" id="S1.Ex6.m1.11.12.2.3.1.2.3.3" xref="S1.Ex6.m1.11.12.2.3.1.2.3.3.cmml">1</mn></mrow><msub id="S1.Ex6.m1.11.12.2.3.1.3" xref="S1.Ex6.m1.11.12.2.3.1.3.cmml"><mi mathsize="90%" id="S1.Ex6.m1.11.12.2.3.1.3.2" xref="S1.Ex6.m1.11.12.2.3.1.3.2.cmml">S</mi><mi mathsize="90%" id="S1.Ex6.m1.11.12.2.3.1.3.3" xref="S1.Ex6.m1.11.12.2.3.1.3.3.cmml">m</mi></msub></munderover></mstyle><mrow id="S1.Ex6.m1.11.12.2.3.2" xref="S1.Ex6.m1.11.12.2.3.2.cmml"><mstyle displaystyle="true" id="S1.Ex6.m1.5.5" xref="S1.Ex6.m1.5.5.cmml"><mfrac id="S1.Ex6.m1.5.5a" xref="S1.Ex6.m1.5.5.cmml"><mrow id="S1.Ex6.m1.2.2.1" xref="S1.Ex6.m1.2.2.1.cmml"><mo mathsize="90%" stretchy="false" id="S1.Ex6.m1.2.2.1.2" xref="S1.Ex6.m1.2.2.1.2.cmml">∂</mo><mo id="S1.Ex6.m1.2.2.1a" xref="S1.Ex6.m1.2.2.1.cmml">⁡</mo><msubsup id="S1.Ex6.m1.2.2.1.3" xref="S1.Ex6.m1.2.2.1.3.cmml"><mi mathsize="90%" id="S1.Ex6.m1.2.2.1.3.2.2" xref="S1.Ex6.m1.2.2.1.3.2.2.cmml">𝒚</mi><mi mathsize="90%" id="S1.Ex6.m1.2.2.1.3.3" xref="S1.Ex6.m1.2.2.1.3.3.cmml">i</mi><mrow id="S1.Ex6.m1.2.2.1.1.1.3" xref="S1.Ex6.m1.2.2.1.3.cmml"><mo maxsize="90%" minsize="90%" id="S1.Ex6.m1.2.2.1.1.1.3.1" xref="S1.Ex6.m1.2.2.1.3.cmml">(</mo><mi mathsize="90%" id="S1.Ex6.m1.2.2.1.1.1.1" xref="S1.Ex6.m1.2.2.1.1.1.1.cmml">L</mi><mo maxsize="90%" minsize="90%" id="S1.Ex6.m1.2.2.1.1.1.3.2" xref="S1.Ex6.m1.2.2.1.3.cmml">)</mo></mrow></msubsup></mrow><mrow id="S1.Ex6.m1.5.5.4" xref="S1.Ex6.m1.5.5.4.cmml"><mo mathsize="90%" stretchy="false" id="S1.Ex6.m1.5.5.4.4" xref="S1.Ex6.m1.5.5.4.4.cmml">∂</mo><mo id="S1.Ex6.m1.5.5.4a" xref="S1.Ex6.m1.5.5.4.cmml">⁡</mo><msubsup id="S1.Ex6.m1.5.5.4.5" xref="S1.Ex6.m1.5.5.4.5.cmml"><mi mathsize="90%" id="S1.Ex6.m1.5.5.4.5.2.2" xref="S1.Ex6.m1.5.5.4.5.2.2.cmml">α</mi><mrow id="S1.Ex6.m1.4.4.3.2.2.4" xref="S1.Ex6.m1.4.4.3.2.2.3.cmml"><mi mathsize="90%" id="S1.Ex6.m1.3.3.2.1.1.1" xref="S1.Ex6.m1.3.3.2.1.1.1.cmml">i</mi><mo mathsize="90%" stretchy="false" id="S1.Ex6.m1.4.4.3.2.2.4.1" xref="S1.Ex6.m1.4.4.3.2.2.3.cmml">,</mo><mi mathsize="90%" id="S1.Ex6.m1.4.4.3.2.2.2" xref="S1.Ex6.m1.4.4.3.2.2.2.cmml">j</mi></mrow><mrow id="S1.Ex6.m1.5.5.4.3.1.3" xref="S1.Ex6.m1.5.5.4.5.cmml"><mo maxsize="90%" minsize="90%" id="S1.Ex6.m1.5.5.4.3.1.3.1" xref="S1.Ex6.m1.5.5.4.5.cmml">(</mo><mi mathsize="90%" id="S1.Ex6.m1.5.5.4.3.1.1" xref="S1.Ex6.m1.5.5.4.3.1.1.cmml">L</mi><mo maxsize="90%" minsize="90%" id="S1.Ex6.m1.5.5.4.3.1.3.2" xref="S1.Ex6.m1.5.5.4.5.cmml">)</mo></mrow></msubsup></mrow></mfrac></mstyle><mo mathsize="90%" stretchy="false" id="S1.Ex6.m1.11.12.2.3.2.1" xref="S1.Ex6.m1.11.12.2.3.2.1.cmml">⋅</mo><mstyle displaystyle="true" id="S1.Ex6.m1.9.9" xref="S1.Ex6.m1.9.9.cmml"><mfrac id="S1.Ex6.m1.9.9a" xref="S1.Ex6.m1.9.9.cmml"><mrow id="S1.Ex6.m1.8.8.3" xref="S1.Ex6.m1.8.8.3.cmml"><mo mathsize="90%" stretchy="false" id="S1.Ex6.m1.8.8.3.4" xref="S1.Ex6.m1.8.8.3.4.cmml">∂</mo><mo id="S1.Ex6.m1.8.8.3a" xref="S1.Ex6.m1.8.8.3.cmml">⁡</mo><msubsup id="S1.Ex6.m1.8.8.3.5" xref="S1.Ex6.m1.8.8.3.5.cmml"><mi mathsize="90%" id="S1.Ex6.m1.8.8.3.5.2.2" xref="S1.Ex6.m1.8.8.3.5.2.2.cmml">α</mi><mrow id="S1.Ex6.m1.7.7.2.2.2.4" xref="S1.Ex6.m1.7.7.2.2.2.3.cmml"><mi mathsize="90%" id="S1.Ex6.m1.6.6.1.1.1.1" xref="S1.Ex6.m1.6.6.1.1.1.1.cmml">i</mi><mo mathsize="90%" stretchy="false" id="S1.Ex6.m1.7.7.2.2.2.4.1" xref="S1.Ex6.m1.7.7.2.2.2.3.cmml">,</mo><mi mathsize="90%" id="S1.Ex6.m1.7.7.2.2.2.2" xref="S1.Ex6.m1.7.7.2.2.2.2.cmml">j</mi></mrow><mrow id="S1.Ex6.m1.8.8.3.3.1.3" xref="S1.Ex6.m1.8.8.3.5.cmml"><mo maxsize="90%" minsize="90%" id="S1.Ex6.m1.8.8.3.3.1.3.1" xref="S1.Ex6.m1.8.8.3.5.cmml">(</mo><mi mathsize="90%" id="S1.Ex6.m1.8.8.3.3.1.1" xref="S1.Ex6.m1.8.8.3.3.1.1.cmml">L</mi><mo maxsize="90%" minsize="90%" id="S1.Ex6.m1.8.8.3.3.1.3.2" xref="S1.Ex6.m1.8.8.3.5.cmml">)</mo></mrow></msubsup></mrow><mrow id="S1.Ex6.m1.9.9.4" xref="S1.Ex6.m1.9.9.4.cmml"><mo mathsize="90%" stretchy="false" id="S1.Ex6.m1.9.9.4.1" xref="S1.Ex6.m1.9.9.4.1.cmml">∂</mo><msub id="S1.Ex6.m1.9.9.4.2" xref="S1.Ex6.m1.9.9.4.2.cmml"><mrow id="S1.Ex6.m1.9.9.4.2.2" xref="S1.Ex6.m1.9.9.4.2.2.cmml"><mo maxsize="90%" minsize="90%" id="S1.Ex6.m1.9.9.4.2.2.1" xref="S1.Ex6.m1.9.9.4.2.2.1.cmml">⟨</mo><msub id="S1.Ex6.m1.9.9.4.2.2.2" xref="S1.Ex6.m1.9.9.4.2.2.2.cmml"><mi mathsize="90%" id="S1.Ex6.m1.9.9.4.2.2.2.2" xref="S1.Ex6.m1.9.9.4.2.2.2.2.cmml">Z</mi><mi mathsize="90%" id="S1.Ex6.m1.9.9.4.2.2.2.3" xref="S1.Ex6.m1.9.9.4.2.2.2.3.cmml">q</mi></msub><mo maxsize="90%" minsize="90%" id="S1.Ex6.m1.9.9.4.2.2.3" xref="S1.Ex6.m1.9.9.4.2.2.3.cmml">⟩</mo></mrow><mi mathsize="90%" id="S1.Ex6.m1.9.9.4.2.3" xref="S1.Ex6.m1.9.9.4.2.3.cmml">i</mi></msub></mrow></mfrac></mstyle><mo mathsize="90%" stretchy="false" id="S1.Ex6.m1.11.12.2.3.2.1a" xref="S1.Ex6.m1.11.12.2.3.2.1.cmml">⋅</mo><mstyle displaystyle="true" id="S1.Ex6.m1.11.11" xref="S1.Ex6.m1.11.11.cmml"><mfrac id="S1.Ex6.m1.11.11a" xref="S1.Ex6.m1.11.11.cmml"><mrow id="S1.Ex6.m1.10.10.1" xref="S1.Ex6.m1.10.10.1.cmml"><mo mathsize="90%" stretchy="false" id="S1.Ex6.m1.10.10.1.1" xref="S1.Ex6.m1.10.10.1.1.cmml">∂</mo><msub id="S1.Ex6.m1.10.10.1.2" xref="S1.Ex6.m1.10.10.1.2.cmml"><mrow id="S1.Ex6.m1.10.10.1.2.2" xref="S1.Ex6.m1.10.10.1.2.2.cmml"><mo maxsize="90%" minsize="90%" id="S1.Ex6.m1.10.10.1.2.2.1" xref="S1.Ex6.m1.10.10.1.2.2.1.cmml">⟨</mo><msub id="S1.Ex6.m1.10.10.1.2.2.2" xref="S1.Ex6.m1.10.10.1.2.2.2.cmml"><mi mathsize="90%" id="S1.Ex6.m1.10.10.1.2.2.2.2" xref="S1.Ex6.m1.10.10.1.2.2.2.2.cmml">Z</mi><mi mathsize="90%" id="S1.Ex6.m1.10.10.1.2.2.2.3" xref="S1.Ex6.m1.10.10.1.2.2.2.3.cmml">q</mi></msub><mo maxsize="90%" minsize="90%" id="S1.Ex6.m1.10.10.1.2.2.3" xref="S1.Ex6.m1.10.10.1.2.2.3.cmml">⟩</mo></mrow><mi mathsize="90%" id="S1.Ex6.m1.10.10.1.2.3" xref="S1.Ex6.m1.10.10.1.2.3.cmml">i</mi></msub></mrow><mrow id="S1.Ex6.m1.11.11.2" xref="S1.Ex6.m1.11.11.2.cmml"><mo mathsize="90%" stretchy="false" id="S1.Ex6.m1.11.11.2.2" xref="S1.Ex6.m1.11.11.2.2.cmml">∂</mo><mo id="S1.Ex6.m1.11.11.2a" xref="S1.Ex6.m1.11.11.2.cmml">⁡</mo><msubsup id="S1.Ex6.m1.11.11.2.3" xref="S1.Ex6.m1.11.11.2.3.cmml"><mi mathsize="90%" id="S1.Ex6.m1.11.11.2.3.2.2" xref="S1.Ex6.m1.11.11.2.3.2.2.cmml">𝒚</mi><mi mathsize="90%" id="S1.Ex6.m1.11.11.2.3.3" xref="S1.Ex6.m1.11.11.2.3.3.cmml">i</mi><mrow id="S1.Ex6.m1.11.11.2.1.1.1" xref="S1.Ex6.m1.11.11.2.1.1.1.1.cmml"><mo maxsize="90%" minsize="90%" id="S1.Ex6.m1.11.11.2.1.1.1.2" xref="S1.Ex6.m1.11.11.2.1.1.1.1.cmml">(</mo><mrow id="S1.Ex6.m1.11.11.2.1.1.1.1" xref="S1.Ex6.m1.11.11.2.1.1.1.1.cmml"><mi mathsize="90%" id="S1.Ex6.m1.11.11.2.1.1.1.1.2" xref="S1.Ex6.m1.11.11.2.1.1.1.1.2.cmml">L</mi><mo mathsize="90%" stretchy="false" id="S1.Ex6.m1.11.11.2.1.1.1.1.1" xref="S1.Ex6.m1.11.11.2.1.1.1.1.1.cmml">-</mo><mn mathsize="90%" id="S1.Ex6.m1.11.11.2.1.1.1.1.3" xref="S1.Ex6.m1.11.11.2.1.1.1.1.3.cmml">1</mn></mrow><mo maxsize="90%" minsize="90%" id="S1.Ex6.m1.11.11.2.1.1.1.3" xref="S1.Ex6.m1.11.11.2.1.1.1.1.cmml">)</mo></mrow></msubsup></mrow></mfrac></mstyle></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.Ex6.m1.11b"><apply id="S1.Ex6.m1.11.12.cmml" xref="S1.Ex6.m1.11.12"><plus id="S1.Ex6.m1.11.12.1.cmml" xref="S1.Ex6.m1.11.12.1"></plus><apply id="S1.Ex6.m1.11.12.2.cmml" xref="S1.Ex6.m1.11.12.2"><times id="S1.Ex6.m1.11.12.2.1.cmml" xref="S1.Ex6.m1.11.12.2.1"></times><apply id="S1.Ex6.m1.11.12.2.2.cmml" xref="S1.Ex6.m1.11.12.2.2"><csymbol cd="ambiguous" id="S1.Ex6.m1.11.12.2.2.1.cmml" xref="S1.Ex6.m1.11.12.2.2">superscript</csymbol><apply id="S1.Ex6.m1.1.1.cmml" xref="S1.Ex6.m1.11.12.2.2.2.2"><divide id="S1.Ex6.m1.1.1.2.cmml" xref="S1.Ex6.m1.11.12.2.2.2.2"></divide><apply id="S1.Ex6.m1.1.1.3.cmml" xref="S1.Ex6.m1.1.1.3"><partialdiff id="S1.Ex6.m1.1.1.3.1.cmml" xref="S1.Ex6.m1.1.1.3.1"></partialdiff><ci id="S1.Ex6.m1.1.1.3.2.cmml" xref="S1.Ex6.m1.1.1.3.2">ℒ</ci></apply><apply id="S1.Ex6.m1.1.1.1.cmml" xref="S1.Ex6.m1.1.1.1"><partialdiff id="S1.Ex6.m1.1.1.1.2.cmml" xref="S1.Ex6.m1.1.1.1.2"></partialdiff><apply id="S1.Ex6.m1.1.1.1.3.cmml" xref="S1.Ex6.m1.1.1.1.3"><csymbol cd="ambiguous" id="S1.Ex6.m1.1.1.1.3.1.cmml" xref="S1.Ex6.m1.1.1.1.3">subscript</csymbol><apply id="S1.Ex6.m1.1.1.1.3.2.cmml" xref="S1.Ex6.m1.1.1.1.3"><csymbol cd="ambiguous" id="S1.Ex6.m1.1.1.1.3.2.1.cmml" xref="S1.Ex6.m1.1.1.1.3">superscript</csymbol><ci id="S1.Ex6.m1.1.1.1.3.2.2.cmml" xref="S1.Ex6.m1.1.1.1.3.2.2">𝒚</ci><ci id="S1.Ex6.m1.1.1.1.1.1.1.cmml" xref="S1.Ex6.m1.1.1.1.1.1.1">𝐿</ci></apply><ci id="S1.Ex6.m1.1.1.1.3.3.cmml" xref="S1.Ex6.m1.1.1.1.3.3">𝑖</ci></apply></apply></apply><csymbol cd="latexml" id="S1.Ex6.m1.11.12.2.2.3.cmml" xref="S1.Ex6.m1.11.12.2.2.3">top</csymbol></apply><apply id="S1.Ex6.m1.11.12.2.3.cmml" xref="S1.Ex6.m1.11.12.2.3"><apply id="S1.Ex6.m1.11.12.2.3.1.cmml" xref="S1.Ex6.m1.11.12.2.3.1"><csymbol cd="ambiguous" id="S1.Ex6.m1.11.12.2.3.1.1.cmml" xref="S1.Ex6.m1.11.12.2.3.1">superscript</csymbol><apply id="S1.Ex6.m1.11.12.2.3.1.2.cmml" xref="S1.Ex6.m1.11.12.2.3.1"><csymbol cd="ambiguous" id="S1.Ex6.m1.11.12.2.3.1.2.1.cmml" xref="S1.Ex6.m1.11.12.2.3.1">subscript</csymbol><sum id="S1.Ex6.m1.11.12.2.3.1.2.2.cmml" xref="S1.Ex6.m1.11.12.2.3.1.2.2"></sum><apply id="S1.Ex6.m1.11.12.2.3.1.2.3.cmml" xref="S1.Ex6.m1.11.12.2.3.1.2.3"><eq id="S1.Ex6.m1.11.12.2.3.1.2.3.1.cmml" xref="S1.Ex6.m1.11.12.2.3.1.2.3.1"></eq><ci id="S1.Ex6.m1.11.12.2.3.1.2.3.2.cmml" xref="S1.Ex6.m1.11.12.2.3.1.2.3.2">𝑗</ci><cn type="integer" id="S1.Ex6.m1.11.12.2.3.1.2.3.3.cmml" xref="S1.Ex6.m1.11.12.2.3.1.2.3.3">1</cn></apply></apply><apply id="S1.Ex6.m1.11.12.2.3.1.3.cmml" xref="S1.Ex6.m1.11.12.2.3.1.3"><csymbol cd="ambiguous" id="S1.Ex6.m1.11.12.2.3.1.3.1.cmml" xref="S1.Ex6.m1.11.12.2.3.1.3">subscript</csymbol><ci id="S1.Ex6.m1.11.12.2.3.1.3.2.cmml" xref="S1.Ex6.m1.11.12.2.3.1.3.2">𝑆</ci><ci id="S1.Ex6.m1.11.12.2.3.1.3.3.cmml" xref="S1.Ex6.m1.11.12.2.3.1.3.3">𝑚</ci></apply></apply><apply id="S1.Ex6.m1.11.12.2.3.2.cmml" xref="S1.Ex6.m1.11.12.2.3.2"><ci id="S1.Ex6.m1.11.12.2.3.2.1.cmml" xref="S1.Ex6.m1.11.12.2.3.2.1">⋅</ci><apply id="S1.Ex6.m1.5.5.cmml" xref="S1.Ex6.m1.5.5"><divide id="S1.Ex6.m1.5.5.5.cmml" xref="S1.Ex6.m1.5.5"></divide><apply id="S1.Ex6.m1.2.2.1.cmml" xref="S1.Ex6.m1.2.2.1"><partialdiff id="S1.Ex6.m1.2.2.1.2.cmml" xref="S1.Ex6.m1.2.2.1.2"></partialdiff><apply id="S1.Ex6.m1.2.2.1.3.cmml" xref="S1.Ex6.m1.2.2.1.3"><csymbol cd="ambiguous" id="S1.Ex6.m1.2.2.1.3.1.cmml" xref="S1.Ex6.m1.2.2.1.3">subscript</csymbol><apply id="S1.Ex6.m1.2.2.1.3.2.cmml" xref="S1.Ex6.m1.2.2.1.3"><csymbol cd="ambiguous" id="S1.Ex6.m1.2.2.1.3.2.1.cmml" xref="S1.Ex6.m1.2.2.1.3">superscript</csymbol><ci id="S1.Ex6.m1.2.2.1.3.2.2.cmml" xref="S1.Ex6.m1.2.2.1.3.2.2">𝒚</ci><ci id="S1.Ex6.m1.2.2.1.1.1.1.cmml" xref="S1.Ex6.m1.2.2.1.1.1.1">𝐿</ci></apply><ci id="S1.Ex6.m1.2.2.1.3.3.cmml" xref="S1.Ex6.m1.2.2.1.3.3">𝑖</ci></apply></apply><apply id="S1.Ex6.m1.5.5.4.cmml" xref="S1.Ex6.m1.5.5.4"><partialdiff id="S1.Ex6.m1.5.5.4.4.cmml" xref="S1.Ex6.m1.5.5.4.4"></partialdiff><apply id="S1.Ex6.m1.5.5.4.5.cmml" xref="S1.Ex6.m1.5.5.4.5"><csymbol cd="ambiguous" id="S1.Ex6.m1.5.5.4.5.1.cmml" xref="S1.Ex6.m1.5.5.4.5">superscript</csymbol><apply id="S1.Ex6.m1.5.5.4.5.2.cmml" xref="S1.Ex6.m1.5.5.4.5"><csymbol cd="ambiguous" id="S1.Ex6.m1.5.5.4.5.2.1.cmml" xref="S1.Ex6.m1.5.5.4.5">subscript</csymbol><ci id="S1.Ex6.m1.5.5.4.5.2.2.cmml" xref="S1.Ex6.m1.5.5.4.5.2.2">𝛼</ci><list id="S1.Ex6.m1.4.4.3.2.2.3.cmml" xref="S1.Ex6.m1.4.4.3.2.2.4"><ci id="S1.Ex6.m1.3.3.2.1.1.1.cmml" xref="S1.Ex6.m1.3.3.2.1.1.1">𝑖</ci><ci id="S1.Ex6.m1.4.4.3.2.2.2.cmml" xref="S1.Ex6.m1.4.4.3.2.2.2">𝑗</ci></list></apply><ci id="S1.Ex6.m1.5.5.4.3.1.1.cmml" xref="S1.Ex6.m1.5.5.4.3.1.1">𝐿</ci></apply></apply></apply><apply id="S1.Ex6.m1.9.9.cmml" xref="S1.Ex6.m1.9.9"><divide id="S1.Ex6.m1.9.9.5.cmml" xref="S1.Ex6.m1.9.9"></divide><apply id="S1.Ex6.m1.8.8.3.cmml" xref="S1.Ex6.m1.8.8.3"><partialdiff id="S1.Ex6.m1.8.8.3.4.cmml" xref="S1.Ex6.m1.8.8.3.4"></partialdiff><apply id="S1.Ex6.m1.8.8.3.5.cmml" xref="S1.Ex6.m1.8.8.3.5"><csymbol cd="ambiguous" id="S1.Ex6.m1.8.8.3.5.1.cmml" xref="S1.Ex6.m1.8.8.3.5">superscript</csymbol><apply id="S1.Ex6.m1.8.8.3.5.2.cmml" xref="S1.Ex6.m1.8.8.3.5"><csymbol cd="ambiguous" id="S1.Ex6.m1.8.8.3.5.2.1.cmml" xref="S1.Ex6.m1.8.8.3.5">subscript</csymbol><ci id="S1.Ex6.m1.8.8.3.5.2.2.cmml" xref="S1.Ex6.m1.8.8.3.5.2.2">𝛼</ci><list id="S1.Ex6.m1.7.7.2.2.2.3.cmml" xref="S1.Ex6.m1.7.7.2.2.2.4"><ci id="S1.Ex6.m1.6.6.1.1.1.1.cmml" xref="S1.Ex6.m1.6.6.1.1.1.1">𝑖</ci><ci id="S1.Ex6.m1.7.7.2.2.2.2.cmml" xref="S1.Ex6.m1.7.7.2.2.2.2">𝑗</ci></list></apply><ci id="S1.Ex6.m1.8.8.3.3.1.1.cmml" xref="S1.Ex6.m1.8.8.3.3.1.1">𝐿</ci></apply></apply><cerror id="S1.Ex6.m1.9.9.4.cmml" xref="S1.Ex6.m1.9.9.4"><csymbol cd="ambiguous" id="S1.Ex6.m1.9.9.4a.cmml" xref="S1.Ex6.m1.9.9.4">fragments</csymbol><partialdiff id="S1.Ex6.m1.9.9.4.1.cmml" xref="S1.Ex6.m1.9.9.4.1"></partialdiff><apply id="S1.Ex6.m1.9.9.4.2.cmml" xref="S1.Ex6.m1.9.9.4.2"><csymbol cd="ambiguous" id="S1.Ex6.m1.9.9.4.2.1.cmml" xref="S1.Ex6.m1.9.9.4.2">subscript</csymbol><cerror id="S1.Ex6.m1.9.9.4.2.2.cmml" xref="S1.Ex6.m1.9.9.4.2.2"><csymbol cd="ambiguous" id="S1.Ex6.m1.9.9.4.2.2a.cmml" xref="S1.Ex6.m1.9.9.4.2.2">fragments</csymbol><ci id="S1.Ex6.m1.9.9.4.2.2.1.cmml" xref="S1.Ex6.m1.9.9.4.2.2.1">⟨</ci><apply id="S1.Ex6.m1.9.9.4.2.2.2.cmml" xref="S1.Ex6.m1.9.9.4.2.2.2"><csymbol cd="ambiguous" id="S1.Ex6.m1.9.9.4.2.2.2.1.cmml" xref="S1.Ex6.m1.9.9.4.2.2.2">subscript</csymbol><ci id="S1.Ex6.m1.9.9.4.2.2.2.2.cmml" xref="S1.Ex6.m1.9.9.4.2.2.2.2">𝑍</ci><ci id="S1.Ex6.m1.9.9.4.2.2.2.3.cmml" xref="S1.Ex6.m1.9.9.4.2.2.2.3">𝑞</ci></apply><ci id="S1.Ex6.m1.9.9.4.2.2.3.cmml" xref="S1.Ex6.m1.9.9.4.2.2.3">⟩</ci></cerror><ci id="S1.Ex6.m1.9.9.4.2.3.cmml" xref="S1.Ex6.m1.9.9.4.2.3">𝑖</ci></apply></cerror></apply><apply id="S1.Ex6.m1.11.11.cmml" xref="S1.Ex6.m1.11.11"><divide id="S1.Ex6.m1.11.11.3.cmml" xref="S1.Ex6.m1.11.11"></divide><cerror id="S1.Ex6.m1.10.10.1.cmml" xref="S1.Ex6.m1.10.10.1"><csymbol cd="ambiguous" id="S1.Ex6.m1.10.10.1a.cmml" xref="S1.Ex6.m1.10.10.1">fragments</csymbol><partialdiff id="S1.Ex6.m1.10.10.1.1.cmml" xref="S1.Ex6.m1.10.10.1.1"></partialdiff><apply id="S1.Ex6.m1.10.10.1.2.cmml" xref="S1.Ex6.m1.10.10.1.2"><csymbol cd="ambiguous" id="S1.Ex6.m1.10.10.1.2.1.cmml" xref="S1.Ex6.m1.10.10.1.2">subscript</csymbol><cerror id="S1.Ex6.m1.10.10.1.2.2.cmml" xref="S1.Ex6.m1.10.10.1.2.2"><csymbol cd="ambiguous" id="S1.Ex6.m1.10.10.1.2.2a.cmml" xref="S1.Ex6.m1.10.10.1.2.2">fragments</csymbol><ci id="S1.Ex6.m1.10.10.1.2.2.1.cmml" xref="S1.Ex6.m1.10.10.1.2.2.1">⟨</ci><apply id="S1.Ex6.m1.10.10.1.2.2.2.cmml" xref="S1.Ex6.m1.10.10.1.2.2.2"><csymbol cd="ambiguous" id="S1.Ex6.m1.10.10.1.2.2.2.1.cmml" xref="S1.Ex6.m1.10.10.1.2.2.2">subscript</csymbol><ci id="S1.Ex6.m1.10.10.1.2.2.2.2.cmml" xref="S1.Ex6.m1.10.10.1.2.2.2.2">𝑍</ci><ci id="S1.Ex6.m1.10.10.1.2.2.2.3.cmml" xref="S1.Ex6.m1.10.10.1.2.2.2.3">𝑞</ci></apply><ci id="S1.Ex6.m1.10.10.1.2.2.3.cmml" xref="S1.Ex6.m1.10.10.1.2.2.3">⟩</ci></cerror><ci id="S1.Ex6.m1.10.10.1.2.3.cmml" xref="S1.Ex6.m1.10.10.1.2.3">𝑖</ci></apply></cerror><apply id="S1.Ex6.m1.11.11.2.cmml" xref="S1.Ex6.m1.11.11.2"><partialdiff id="S1.Ex6.m1.11.11.2.2.cmml" xref="S1.Ex6.m1.11.11.2.2"></partialdiff><apply id="S1.Ex6.m1.11.11.2.3.cmml" xref="S1.Ex6.m1.11.11.2.3"><csymbol cd="ambiguous" id="S1.Ex6.m1.11.11.2.3.1.cmml" xref="S1.Ex6.m1.11.11.2.3">subscript</csymbol><apply id="S1.Ex6.m1.11.11.2.3.2.cmml" xref="S1.Ex6.m1.11.11.2.3"><csymbol cd="ambiguous" id="S1.Ex6.m1.11.11.2.3.2.1.cmml" xref="S1.Ex6.m1.11.11.2.3">superscript</csymbol><ci id="S1.Ex6.m1.11.11.2.3.2.2.cmml" xref="S1.Ex6.m1.11.11.2.3.2.2">𝒚</ci><apply id="S1.Ex6.m1.11.11.2.1.1.1.1.cmml" xref="S1.Ex6.m1.11.11.2.1.1.1"><minus id="S1.Ex6.m1.11.11.2.1.1.1.1.1.cmml" xref="S1.Ex6.m1.11.11.2.1.1.1.1.1"></minus><ci id="S1.Ex6.m1.11.11.2.1.1.1.1.2.cmml" xref="S1.Ex6.m1.11.11.2.1.1.1.1.2">𝐿</ci><cn type="integer" id="S1.Ex6.m1.11.11.2.1.1.1.1.3.cmml" xref="S1.Ex6.m1.11.11.2.1.1.1.1.3">1</cn></apply></apply><ci id="S1.Ex6.m1.11.11.2.3.3.cmml" xref="S1.Ex6.m1.11.11.2.3.3">𝑖</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.Ex6.m1.11c">\displaystyle+\left(\frac{\partial\mathcal{L}}{\partial\bm{y}^{(L)}_{i}}\right%
)^{\top}\sum_{j=1}^{S_{m}}\frac{\partial\bm{y}^{(L)}_{i}}{\partial\alpha_{i,j}%
^{(L)}}\cdot\frac{\partial\alpha_{i,j}^{(L)}}{\partial\langle Z_{q}\rangle_{i}%
}\cdot\frac{\partial\langle Z_{q}\rangle_{i}}{\partial\bm{y}^{(L-1)}_{i}}</annotation><annotation encoding="application/x-llamapun" id="S1.Ex6.m1.11d">+ ( divide start_ARG ∂ caligraphic_L end_ARG start_ARG ∂ bold_italic_y start_POSTSUPERSCRIPT ( italic_L ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_ARG ) start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_S start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT end_POSTSUPERSCRIPT divide start_ARG ∂ bold_italic_y start_POSTSUPERSCRIPT ( italic_L ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_ARG start_ARG ∂ italic_α start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_L ) end_POSTSUPERSCRIPT end_ARG ⋅ divide start_ARG ∂ italic_α start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_L ) end_POSTSUPERSCRIPT end_ARG start_ARG ∂ ⟨ italic_Z start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT ⟩ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_ARG ⋅ divide start_ARG ∂ ⟨ italic_Z start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT ⟩ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_ARG start_ARG ∂ bold_italic_y start_POSTSUPERSCRIPT ( italic_L - 1 ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S1.E8a"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S1.E8a.m1.12" class="ltx_Math" alttext="\displaystyle+\sum_{s=1}^{S_{m}}\left(\frac{\partial\mathcal{L}}{\partial\bm{y%
}^{(L)}_{s}}\right)^{\top}\sum_{j=1}^{S_{m}}\frac{\partial\bm{y}^{(L)}_{s}}{%
\partial\alpha_{s,j}^{(L)}}\cdot\frac{\partial\alpha_{s,j}^{(L)}}{\partial%
\langle Z_{k}\rangle_{i}}\cdot\frac{\partial\langle Z_{k}\rangle_{i}}{\partial%
\bm{y}^{(L-1)}_{i}}," display="inline"><semantics id="S1.E8a.m1.12a"><mrow id="S1.E8a.m1.12.12.1" xref="S1.E8a.m1.12.12.1.1.cmml"><mrow id="S1.E8a.m1.12.12.1.1" xref="S1.E8a.m1.12.12.1.1.cmml"><mo mathsize="90%" stretchy="false" id="S1.E8a.m1.12.12.1.1.1" xref="S1.E8a.m1.12.12.1.1.1.cmml">+</mo><mrow id="S1.E8a.m1.12.12.1.1.2" xref="S1.E8a.m1.12.12.1.1.2.cmml"><mstyle displaystyle="true" id="S1.E8a.m1.12.12.1.1.2.1" xref="S1.E8a.m1.12.12.1.1.2.1.cmml"><munderover id="S1.E8a.m1.12.12.1.1.2.1a" xref="S1.E8a.m1.12.12.1.1.2.1.cmml"><mo largeop="true" mathsize="90%" movablelimits="false" stretchy="false" symmetric="true" id="S1.E8a.m1.12.12.1.1.2.1.2.2" xref="S1.E8a.m1.12.12.1.1.2.1.2.2.cmml">∑</mo><mrow id="S1.E8a.m1.12.12.1.1.2.1.2.3" xref="S1.E8a.m1.12.12.1.1.2.1.2.3.cmml"><mi mathsize="90%" id="S1.E8a.m1.12.12.1.1.2.1.2.3.2" xref="S1.E8a.m1.12.12.1.1.2.1.2.3.2.cmml">s</mi><mo mathsize="90%" stretchy="false" id="S1.E8a.m1.12.12.1.1.2.1.2.3.1" xref="S1.E8a.m1.12.12.1.1.2.1.2.3.1.cmml">=</mo><mn mathsize="90%" id="S1.E8a.m1.12.12.1.1.2.1.2.3.3" xref="S1.E8a.m1.12.12.1.1.2.1.2.3.3.cmml">1</mn></mrow><msub id="S1.E8a.m1.12.12.1.1.2.1.3" xref="S1.E8a.m1.12.12.1.1.2.1.3.cmml"><mi mathsize="90%" id="S1.E8a.m1.12.12.1.1.2.1.3.2" xref="S1.E8a.m1.12.12.1.1.2.1.3.2.cmml">S</mi><mi mathsize="90%" id="S1.E8a.m1.12.12.1.1.2.1.3.3" xref="S1.E8a.m1.12.12.1.1.2.1.3.3.cmml">m</mi></msub></munderover></mstyle><mrow id="S1.E8a.m1.12.12.1.1.2.2" xref="S1.E8a.m1.12.12.1.1.2.2.cmml"><msup id="S1.E8a.m1.12.12.1.1.2.2.2" xref="S1.E8a.m1.12.12.1.1.2.2.2.cmml"><mrow id="S1.E8a.m1.12.12.1.1.2.2.2.2.2" xref="S1.E8a.m1.1.1.cmml"><mo id="S1.E8a.m1.12.12.1.1.2.2.2.2.2.1" xref="S1.E8a.m1.1.1.cmml">(</mo><mstyle displaystyle="true" id="S1.E8a.m1.1.1" xref="S1.E8a.m1.1.1.cmml"><mfrac id="S1.E8a.m1.1.1a" xref="S1.E8a.m1.1.1.cmml"><mrow id="S1.E8a.m1.1.1.3" xref="S1.E8a.m1.1.1.3.cmml"><mo mathsize="90%" stretchy="false" id="S1.E8a.m1.1.1.3.1" xref="S1.E8a.m1.1.1.3.1.cmml">∂</mo><mo id="S1.E8a.m1.1.1.3a" xref="S1.E8a.m1.1.1.3.cmml">⁡</mo><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S1.E8a.m1.1.1.3.2" xref="S1.E8a.m1.1.1.3.2.cmml">ℒ</mi></mrow><mrow id="S1.E8a.m1.1.1.1" xref="S1.E8a.m1.1.1.1.cmml"><mo mathsize="90%" stretchy="false" id="S1.E8a.m1.1.1.1.2" xref="S1.E8a.m1.1.1.1.2.cmml">∂</mo><mo id="S1.E8a.m1.1.1.1a" xref="S1.E8a.m1.1.1.1.cmml">⁡</mo><msubsup id="S1.E8a.m1.1.1.1.3" xref="S1.E8a.m1.1.1.1.3.cmml"><mi mathsize="90%" id="S1.E8a.m1.1.1.1.3.2.2" xref="S1.E8a.m1.1.1.1.3.2.2.cmml">𝒚</mi><mi mathsize="90%" id="S1.E8a.m1.1.1.1.3.3" xref="S1.E8a.m1.1.1.1.3.3.cmml">s</mi><mrow id="S1.E8a.m1.1.1.1.1.1.3" xref="S1.E8a.m1.1.1.1.3.cmml"><mo maxsize="90%" minsize="90%" id="S1.E8a.m1.1.1.1.1.1.3.1" xref="S1.E8a.m1.1.1.1.3.cmml">(</mo><mi mathsize="90%" id="S1.E8a.m1.1.1.1.1.1.1" xref="S1.E8a.m1.1.1.1.1.1.1.cmml">L</mi><mo maxsize="90%" minsize="90%" id="S1.E8a.m1.1.1.1.1.1.3.2" xref="S1.E8a.m1.1.1.1.3.cmml">)</mo></mrow></msubsup></mrow></mfrac></mstyle><mo id="S1.E8a.m1.12.12.1.1.2.2.2.2.2.2" xref="S1.E8a.m1.1.1.cmml">)</mo></mrow><mo mathsize="90%" stretchy="false" id="S1.E8a.m1.12.12.1.1.2.2.2.3" xref="S1.E8a.m1.12.12.1.1.2.2.2.3.cmml">⊤</mo></msup><mo id="S1.E8a.m1.12.12.1.1.2.2.1" xref="S1.E8a.m1.12.12.1.1.2.2.1.cmml">⁢</mo><mrow id="S1.E8a.m1.12.12.1.1.2.2.3" xref="S1.E8a.m1.12.12.1.1.2.2.3.cmml"><mstyle displaystyle="true" id="S1.E8a.m1.12.12.1.1.2.2.3.1" xref="S1.E8a.m1.12.12.1.1.2.2.3.1.cmml"><munderover id="S1.E8a.m1.12.12.1.1.2.2.3.1a" xref="S1.E8a.m1.12.12.1.1.2.2.3.1.cmml"><mo largeop="true" mathsize="90%" movablelimits="false" stretchy="false" symmetric="true" id="S1.E8a.m1.12.12.1.1.2.2.3.1.2.2" xref="S1.E8a.m1.12.12.1.1.2.2.3.1.2.2.cmml">∑</mo><mrow id="S1.E8a.m1.12.12.1.1.2.2.3.1.2.3" xref="S1.E8a.m1.12.12.1.1.2.2.3.1.2.3.cmml"><mi mathsize="90%" id="S1.E8a.m1.12.12.1.1.2.2.3.1.2.3.2" xref="S1.E8a.m1.12.12.1.1.2.2.3.1.2.3.2.cmml">j</mi><mo mathsize="90%" stretchy="false" id="S1.E8a.m1.12.12.1.1.2.2.3.1.2.3.1" xref="S1.E8a.m1.12.12.1.1.2.2.3.1.2.3.1.cmml">=</mo><mn mathsize="90%" id="S1.E8a.m1.12.12.1.1.2.2.3.1.2.3.3" xref="S1.E8a.m1.12.12.1.1.2.2.3.1.2.3.3.cmml">1</mn></mrow><msub id="S1.E8a.m1.12.12.1.1.2.2.3.1.3" xref="S1.E8a.m1.12.12.1.1.2.2.3.1.3.cmml"><mi mathsize="90%" id="S1.E8a.m1.12.12.1.1.2.2.3.1.3.2" xref="S1.E8a.m1.12.12.1.1.2.2.3.1.3.2.cmml">S</mi><mi mathsize="90%" id="S1.E8a.m1.12.12.1.1.2.2.3.1.3.3" xref="S1.E8a.m1.12.12.1.1.2.2.3.1.3.3.cmml">m</mi></msub></munderover></mstyle><mrow id="S1.E8a.m1.12.12.1.1.2.2.3.2" xref="S1.E8a.m1.12.12.1.1.2.2.3.2.cmml"><mstyle displaystyle="true" id="S1.E8a.m1.5.5" xref="S1.E8a.m1.5.5.cmml"><mfrac id="S1.E8a.m1.5.5a" xref="S1.E8a.m1.5.5.cmml"><mrow id="S1.E8a.m1.2.2.1" xref="S1.E8a.m1.2.2.1.cmml"><mo mathsize="90%" stretchy="false" id="S1.E8a.m1.2.2.1.2" xref="S1.E8a.m1.2.2.1.2.cmml">∂</mo><mo id="S1.E8a.m1.2.2.1a" xref="S1.E8a.m1.2.2.1.cmml">⁡</mo><msubsup id="S1.E8a.m1.2.2.1.3" xref="S1.E8a.m1.2.2.1.3.cmml"><mi mathsize="90%" id="S1.E8a.m1.2.2.1.3.2.2" xref="S1.E8a.m1.2.2.1.3.2.2.cmml">𝒚</mi><mi mathsize="90%" id="S1.E8a.m1.2.2.1.3.3" xref="S1.E8a.m1.2.2.1.3.3.cmml">s</mi><mrow id="S1.E8a.m1.2.2.1.1.1.3" xref="S1.E8a.m1.2.2.1.3.cmml"><mo maxsize="90%" minsize="90%" id="S1.E8a.m1.2.2.1.1.1.3.1" xref="S1.E8a.m1.2.2.1.3.cmml">(</mo><mi mathsize="90%" id="S1.E8a.m1.2.2.1.1.1.1" xref="S1.E8a.m1.2.2.1.1.1.1.cmml">L</mi><mo maxsize="90%" minsize="90%" id="S1.E8a.m1.2.2.1.1.1.3.2" xref="S1.E8a.m1.2.2.1.3.cmml">)</mo></mrow></msubsup></mrow><mrow id="S1.E8a.m1.5.5.4" xref="S1.E8a.m1.5.5.4.cmml"><mo mathsize="90%" stretchy="false" id="S1.E8a.m1.5.5.4.4" xref="S1.E8a.m1.5.5.4.4.cmml">∂</mo><mo id="S1.E8a.m1.5.5.4a" xref="S1.E8a.m1.5.5.4.cmml">⁡</mo><msubsup id="S1.E8a.m1.5.5.4.5" xref="S1.E8a.m1.5.5.4.5.cmml"><mi mathsize="90%" id="S1.E8a.m1.5.5.4.5.2.2" xref="S1.E8a.m1.5.5.4.5.2.2.cmml">α</mi><mrow id="S1.E8a.m1.4.4.3.2.2.4" xref="S1.E8a.m1.4.4.3.2.2.3.cmml"><mi mathsize="90%" id="S1.E8a.m1.3.3.2.1.1.1" xref="S1.E8a.m1.3.3.2.1.1.1.cmml">s</mi><mo mathsize="90%" stretchy="false" id="S1.E8a.m1.4.4.3.2.2.4.1" xref="S1.E8a.m1.4.4.3.2.2.3.cmml">,</mo><mi mathsize="90%" id="S1.E8a.m1.4.4.3.2.2.2" xref="S1.E8a.m1.4.4.3.2.2.2.cmml">j</mi></mrow><mrow id="S1.E8a.m1.5.5.4.3.1.3" xref="S1.E8a.m1.5.5.4.5.cmml"><mo maxsize="90%" minsize="90%" id="S1.E8a.m1.5.5.4.3.1.3.1" xref="S1.E8a.m1.5.5.4.5.cmml">(</mo><mi mathsize="90%" id="S1.E8a.m1.5.5.4.3.1.1" xref="S1.E8a.m1.5.5.4.3.1.1.cmml">L</mi><mo maxsize="90%" minsize="90%" id="S1.E8a.m1.5.5.4.3.1.3.2" xref="S1.E8a.m1.5.5.4.5.cmml">)</mo></mrow></msubsup></mrow></mfrac></mstyle><mo mathsize="90%" stretchy="false" id="S1.E8a.m1.12.12.1.1.2.2.3.2.1" xref="S1.E8a.m1.12.12.1.1.2.2.3.2.1.cmml">⋅</mo><mstyle displaystyle="true" id="S1.E8a.m1.9.9" xref="S1.E8a.m1.9.9.cmml"><mfrac id="S1.E8a.m1.9.9a" xref="S1.E8a.m1.9.9.cmml"><mrow id="S1.E8a.m1.8.8.3" xref="S1.E8a.m1.8.8.3.cmml"><mo mathsize="90%" stretchy="false" id="S1.E8a.m1.8.8.3.4" xref="S1.E8a.m1.8.8.3.4.cmml">∂</mo><mo id="S1.E8a.m1.8.8.3a" xref="S1.E8a.m1.8.8.3.cmml">⁡</mo><msubsup id="S1.E8a.m1.8.8.3.5" xref="S1.E8a.m1.8.8.3.5.cmml"><mi mathsize="90%" id="S1.E8a.m1.8.8.3.5.2.2" xref="S1.E8a.m1.8.8.3.5.2.2.cmml">α</mi><mrow id="S1.E8a.m1.7.7.2.2.2.4" xref="S1.E8a.m1.7.7.2.2.2.3.cmml"><mi mathsize="90%" id="S1.E8a.m1.6.6.1.1.1.1" xref="S1.E8a.m1.6.6.1.1.1.1.cmml">s</mi><mo mathsize="90%" stretchy="false" id="S1.E8a.m1.7.7.2.2.2.4.1" xref="S1.E8a.m1.7.7.2.2.2.3.cmml">,</mo><mi mathsize="90%" id="S1.E8a.m1.7.7.2.2.2.2" xref="S1.E8a.m1.7.7.2.2.2.2.cmml">j</mi></mrow><mrow id="S1.E8a.m1.8.8.3.3.1.3" xref="S1.E8a.m1.8.8.3.5.cmml"><mo maxsize="90%" minsize="90%" id="S1.E8a.m1.8.8.3.3.1.3.1" xref="S1.E8a.m1.8.8.3.5.cmml">(</mo><mi mathsize="90%" id="S1.E8a.m1.8.8.3.3.1.1" xref="S1.E8a.m1.8.8.3.3.1.1.cmml">L</mi><mo maxsize="90%" minsize="90%" id="S1.E8a.m1.8.8.3.3.1.3.2" xref="S1.E8a.m1.8.8.3.5.cmml">)</mo></mrow></msubsup></mrow><mrow id="S1.E8a.m1.9.9.4" xref="S1.E8a.m1.9.9.4.cmml"><mo mathsize="90%" stretchy="false" id="S1.E8a.m1.9.9.4.1" xref="S1.E8a.m1.9.9.4.1.cmml">∂</mo><msub id="S1.E8a.m1.9.9.4.2" xref="S1.E8a.m1.9.9.4.2.cmml"><mrow id="S1.E8a.m1.9.9.4.2.2" xref="S1.E8a.m1.9.9.4.2.2.cmml"><mo maxsize="90%" minsize="90%" id="S1.E8a.m1.9.9.4.2.2.1" xref="S1.E8a.m1.9.9.4.2.2.1.cmml">⟨</mo><msub id="S1.E8a.m1.9.9.4.2.2.2" xref="S1.E8a.m1.9.9.4.2.2.2.cmml"><mi mathsize="90%" id="S1.E8a.m1.9.9.4.2.2.2.2" xref="S1.E8a.m1.9.9.4.2.2.2.2.cmml">Z</mi><mi mathsize="90%" id="S1.E8a.m1.9.9.4.2.2.2.3" xref="S1.E8a.m1.9.9.4.2.2.2.3.cmml">k</mi></msub><mo maxsize="90%" minsize="90%" id="S1.E8a.m1.9.9.4.2.2.3" xref="S1.E8a.m1.9.9.4.2.2.3.cmml">⟩</mo></mrow><mi mathsize="90%" id="S1.E8a.m1.9.9.4.2.3" xref="S1.E8a.m1.9.9.4.2.3.cmml">i</mi></msub></mrow></mfrac></mstyle><mo mathsize="90%" stretchy="false" id="S1.E8a.m1.12.12.1.1.2.2.3.2.1a" xref="S1.E8a.m1.12.12.1.1.2.2.3.2.1.cmml">⋅</mo><mstyle displaystyle="true" id="S1.E8a.m1.11.11" xref="S1.E8a.m1.11.11.cmml"><mfrac id="S1.E8a.m1.11.11a" xref="S1.E8a.m1.11.11.cmml"><mrow id="S1.E8a.m1.10.10.1" xref="S1.E8a.m1.10.10.1.cmml"><mo mathsize="90%" stretchy="false" id="S1.E8a.m1.10.10.1.1" xref="S1.E8a.m1.10.10.1.1.cmml">∂</mo><msub id="S1.E8a.m1.10.10.1.2" xref="S1.E8a.m1.10.10.1.2.cmml"><mrow id="S1.E8a.m1.10.10.1.2.2" xref="S1.E8a.m1.10.10.1.2.2.cmml"><mo maxsize="90%" minsize="90%" id="S1.E8a.m1.10.10.1.2.2.1" xref="S1.E8a.m1.10.10.1.2.2.1.cmml">⟨</mo><msub id="S1.E8a.m1.10.10.1.2.2.2" xref="S1.E8a.m1.10.10.1.2.2.2.cmml"><mi mathsize="90%" id="S1.E8a.m1.10.10.1.2.2.2.2" xref="S1.E8a.m1.10.10.1.2.2.2.2.cmml">Z</mi><mi mathsize="90%" id="S1.E8a.m1.10.10.1.2.2.2.3" xref="S1.E8a.m1.10.10.1.2.2.2.3.cmml">k</mi></msub><mo maxsize="90%" minsize="90%" id="S1.E8a.m1.10.10.1.2.2.3" xref="S1.E8a.m1.10.10.1.2.2.3.cmml">⟩</mo></mrow><mi mathsize="90%" id="S1.E8a.m1.10.10.1.2.3" xref="S1.E8a.m1.10.10.1.2.3.cmml">i</mi></msub></mrow><mrow id="S1.E8a.m1.11.11.2" xref="S1.E8a.m1.11.11.2.cmml"><mo mathsize="90%" stretchy="false" id="S1.E8a.m1.11.11.2.2" xref="S1.E8a.m1.11.11.2.2.cmml">∂</mo><mo id="S1.E8a.m1.11.11.2a" xref="S1.E8a.m1.11.11.2.cmml">⁡</mo><msubsup id="S1.E8a.m1.11.11.2.3" xref="S1.E8a.m1.11.11.2.3.cmml"><mi mathsize="90%" id="S1.E8a.m1.11.11.2.3.2.2" xref="S1.E8a.m1.11.11.2.3.2.2.cmml">𝒚</mi><mi mathsize="90%" id="S1.E8a.m1.11.11.2.3.3" xref="S1.E8a.m1.11.11.2.3.3.cmml">i</mi><mrow id="S1.E8a.m1.11.11.2.1.1.1" xref="S1.E8a.m1.11.11.2.1.1.1.1.cmml"><mo maxsize="90%" minsize="90%" id="S1.E8a.m1.11.11.2.1.1.1.2" xref="S1.E8a.m1.11.11.2.1.1.1.1.cmml">(</mo><mrow id="S1.E8a.m1.11.11.2.1.1.1.1" xref="S1.E8a.m1.11.11.2.1.1.1.1.cmml"><mi mathsize="90%" id="S1.E8a.m1.11.11.2.1.1.1.1.2" xref="S1.E8a.m1.11.11.2.1.1.1.1.2.cmml">L</mi><mo mathsize="90%" stretchy="false" id="S1.E8a.m1.11.11.2.1.1.1.1.1" xref="S1.E8a.m1.11.11.2.1.1.1.1.1.cmml">-</mo><mn mathsize="90%" id="S1.E8a.m1.11.11.2.1.1.1.1.3" xref="S1.E8a.m1.11.11.2.1.1.1.1.3.cmml">1</mn></mrow><mo maxsize="90%" minsize="90%" id="S1.E8a.m1.11.11.2.1.1.1.3" xref="S1.E8a.m1.11.11.2.1.1.1.1.cmml">)</mo></mrow></msubsup></mrow></mfrac></mstyle></mrow></mrow></mrow></mrow></mrow><mo mathsize="90%" stretchy="false" id="S1.E8a.m1.12.12.1.2" xref="S1.E8a.m1.12.12.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S1.E8a.m1.12b"><apply id="S1.E8a.m1.12.12.1.1.cmml" xref="S1.E8a.m1.12.12.1"><plus id="S1.E8a.m1.12.12.1.1.1.cmml" xref="S1.E8a.m1.12.12.1.1.1"></plus><apply id="S1.E8a.m1.12.12.1.1.2.cmml" xref="S1.E8a.m1.12.12.1.1.2"><apply id="S1.E8a.m1.12.12.1.1.2.1.cmml" xref="S1.E8a.m1.12.12.1.1.2.1"><csymbol cd="ambiguous" id="S1.E8a.m1.12.12.1.1.2.1.1.cmml" xref="S1.E8a.m1.12.12.1.1.2.1">superscript</csymbol><apply id="S1.E8a.m1.12.12.1.1.2.1.2.cmml" xref="S1.E8a.m1.12.12.1.1.2.1"><csymbol cd="ambiguous" id="S1.E8a.m1.12.12.1.1.2.1.2.1.cmml" xref="S1.E8a.m1.12.12.1.1.2.1">subscript</csymbol><sum id="S1.E8a.m1.12.12.1.1.2.1.2.2.cmml" xref="S1.E8a.m1.12.12.1.1.2.1.2.2"></sum><apply id="S1.E8a.m1.12.12.1.1.2.1.2.3.cmml" xref="S1.E8a.m1.12.12.1.1.2.1.2.3"><eq id="S1.E8a.m1.12.12.1.1.2.1.2.3.1.cmml" xref="S1.E8a.m1.12.12.1.1.2.1.2.3.1"></eq><ci id="S1.E8a.m1.12.12.1.1.2.1.2.3.2.cmml" xref="S1.E8a.m1.12.12.1.1.2.1.2.3.2">𝑠</ci><cn type="integer" id="S1.E8a.m1.12.12.1.1.2.1.2.3.3.cmml" xref="S1.E8a.m1.12.12.1.1.2.1.2.3.3">1</cn></apply></apply><apply id="S1.E8a.m1.12.12.1.1.2.1.3.cmml" xref="S1.E8a.m1.12.12.1.1.2.1.3"><csymbol cd="ambiguous" id="S1.E8a.m1.12.12.1.1.2.1.3.1.cmml" xref="S1.E8a.m1.12.12.1.1.2.1.3">subscript</csymbol><ci id="S1.E8a.m1.12.12.1.1.2.1.3.2.cmml" xref="S1.E8a.m1.12.12.1.1.2.1.3.2">𝑆</ci><ci id="S1.E8a.m1.12.12.1.1.2.1.3.3.cmml" xref="S1.E8a.m1.12.12.1.1.2.1.3.3">𝑚</ci></apply></apply><apply id="S1.E8a.m1.12.12.1.1.2.2.cmml" xref="S1.E8a.m1.12.12.1.1.2.2"><times id="S1.E8a.m1.12.12.1.1.2.2.1.cmml" xref="S1.E8a.m1.12.12.1.1.2.2.1"></times><apply id="S1.E8a.m1.12.12.1.1.2.2.2.cmml" xref="S1.E8a.m1.12.12.1.1.2.2.2"><csymbol cd="ambiguous" id="S1.E8a.m1.12.12.1.1.2.2.2.1.cmml" xref="S1.E8a.m1.12.12.1.1.2.2.2">superscript</csymbol><apply id="S1.E8a.m1.1.1.cmml" xref="S1.E8a.m1.12.12.1.1.2.2.2.2.2"><divide id="S1.E8a.m1.1.1.2.cmml" xref="S1.E8a.m1.12.12.1.1.2.2.2.2.2"></divide><apply id="S1.E8a.m1.1.1.3.cmml" xref="S1.E8a.m1.1.1.3"><partialdiff id="S1.E8a.m1.1.1.3.1.cmml" xref="S1.E8a.m1.1.1.3.1"></partialdiff><ci id="S1.E8a.m1.1.1.3.2.cmml" xref="S1.E8a.m1.1.1.3.2">ℒ</ci></apply><apply id="S1.E8a.m1.1.1.1.cmml" xref="S1.E8a.m1.1.1.1"><partialdiff id="S1.E8a.m1.1.1.1.2.cmml" xref="S1.E8a.m1.1.1.1.2"></partialdiff><apply id="S1.E8a.m1.1.1.1.3.cmml" xref="S1.E8a.m1.1.1.1.3"><csymbol cd="ambiguous" id="S1.E8a.m1.1.1.1.3.1.cmml" xref="S1.E8a.m1.1.1.1.3">subscript</csymbol><apply id="S1.E8a.m1.1.1.1.3.2.cmml" xref="S1.E8a.m1.1.1.1.3"><csymbol cd="ambiguous" id="S1.E8a.m1.1.1.1.3.2.1.cmml" xref="S1.E8a.m1.1.1.1.3">superscript</csymbol><ci id="S1.E8a.m1.1.1.1.3.2.2.cmml" xref="S1.E8a.m1.1.1.1.3.2.2">𝒚</ci><ci id="S1.E8a.m1.1.1.1.1.1.1.cmml" xref="S1.E8a.m1.1.1.1.1.1.1">𝐿</ci></apply><ci id="S1.E8a.m1.1.1.1.3.3.cmml" xref="S1.E8a.m1.1.1.1.3.3">𝑠</ci></apply></apply></apply><csymbol cd="latexml" id="S1.E8a.m1.12.12.1.1.2.2.2.3.cmml" xref="S1.E8a.m1.12.12.1.1.2.2.2.3">top</csymbol></apply><apply id="S1.E8a.m1.12.12.1.1.2.2.3.cmml" xref="S1.E8a.m1.12.12.1.1.2.2.3"><apply id="S1.E8a.m1.12.12.1.1.2.2.3.1.cmml" xref="S1.E8a.m1.12.12.1.1.2.2.3.1"><csymbol cd="ambiguous" id="S1.E8a.m1.12.12.1.1.2.2.3.1.1.cmml" xref="S1.E8a.m1.12.12.1.1.2.2.3.1">superscript</csymbol><apply id="S1.E8a.m1.12.12.1.1.2.2.3.1.2.cmml" xref="S1.E8a.m1.12.12.1.1.2.2.3.1"><csymbol cd="ambiguous" id="S1.E8a.m1.12.12.1.1.2.2.3.1.2.1.cmml" xref="S1.E8a.m1.12.12.1.1.2.2.3.1">subscript</csymbol><sum id="S1.E8a.m1.12.12.1.1.2.2.3.1.2.2.cmml" xref="S1.E8a.m1.12.12.1.1.2.2.3.1.2.2"></sum><apply id="S1.E8a.m1.12.12.1.1.2.2.3.1.2.3.cmml" xref="S1.E8a.m1.12.12.1.1.2.2.3.1.2.3"><eq id="S1.E8a.m1.12.12.1.1.2.2.3.1.2.3.1.cmml" xref="S1.E8a.m1.12.12.1.1.2.2.3.1.2.3.1"></eq><ci id="S1.E8a.m1.12.12.1.1.2.2.3.1.2.3.2.cmml" xref="S1.E8a.m1.12.12.1.1.2.2.3.1.2.3.2">𝑗</ci><cn type="integer" id="S1.E8a.m1.12.12.1.1.2.2.3.1.2.3.3.cmml" xref="S1.E8a.m1.12.12.1.1.2.2.3.1.2.3.3">1</cn></apply></apply><apply id="S1.E8a.m1.12.12.1.1.2.2.3.1.3.cmml" xref="S1.E8a.m1.12.12.1.1.2.2.3.1.3"><csymbol cd="ambiguous" id="S1.E8a.m1.12.12.1.1.2.2.3.1.3.1.cmml" xref="S1.E8a.m1.12.12.1.1.2.2.3.1.3">subscript</csymbol><ci id="S1.E8a.m1.12.12.1.1.2.2.3.1.3.2.cmml" xref="S1.E8a.m1.12.12.1.1.2.2.3.1.3.2">𝑆</ci><ci id="S1.E8a.m1.12.12.1.1.2.2.3.1.3.3.cmml" xref="S1.E8a.m1.12.12.1.1.2.2.3.1.3.3">𝑚</ci></apply></apply><apply id="S1.E8a.m1.12.12.1.1.2.2.3.2.cmml" xref="S1.E8a.m1.12.12.1.1.2.2.3.2"><ci id="S1.E8a.m1.12.12.1.1.2.2.3.2.1.cmml" xref="S1.E8a.m1.12.12.1.1.2.2.3.2.1">⋅</ci><apply id="S1.E8a.m1.5.5.cmml" xref="S1.E8a.m1.5.5"><divide id="S1.E8a.m1.5.5.5.cmml" xref="S1.E8a.m1.5.5"></divide><apply id="S1.E8a.m1.2.2.1.cmml" xref="S1.E8a.m1.2.2.1"><partialdiff id="S1.E8a.m1.2.2.1.2.cmml" xref="S1.E8a.m1.2.2.1.2"></partialdiff><apply id="S1.E8a.m1.2.2.1.3.cmml" xref="S1.E8a.m1.2.2.1.3"><csymbol cd="ambiguous" id="S1.E8a.m1.2.2.1.3.1.cmml" xref="S1.E8a.m1.2.2.1.3">subscript</csymbol><apply id="S1.E8a.m1.2.2.1.3.2.cmml" xref="S1.E8a.m1.2.2.1.3"><csymbol cd="ambiguous" id="S1.E8a.m1.2.2.1.3.2.1.cmml" xref="S1.E8a.m1.2.2.1.3">superscript</csymbol><ci id="S1.E8a.m1.2.2.1.3.2.2.cmml" xref="S1.E8a.m1.2.2.1.3.2.2">𝒚</ci><ci id="S1.E8a.m1.2.2.1.1.1.1.cmml" xref="S1.E8a.m1.2.2.1.1.1.1">𝐿</ci></apply><ci id="S1.E8a.m1.2.2.1.3.3.cmml" xref="S1.E8a.m1.2.2.1.3.3">𝑠</ci></apply></apply><apply id="S1.E8a.m1.5.5.4.cmml" xref="S1.E8a.m1.5.5.4"><partialdiff id="S1.E8a.m1.5.5.4.4.cmml" xref="S1.E8a.m1.5.5.4.4"></partialdiff><apply id="S1.E8a.m1.5.5.4.5.cmml" xref="S1.E8a.m1.5.5.4.5"><csymbol cd="ambiguous" id="S1.E8a.m1.5.5.4.5.1.cmml" xref="S1.E8a.m1.5.5.4.5">superscript</csymbol><apply id="S1.E8a.m1.5.5.4.5.2.cmml" xref="S1.E8a.m1.5.5.4.5"><csymbol cd="ambiguous" id="S1.E8a.m1.5.5.4.5.2.1.cmml" xref="S1.E8a.m1.5.5.4.5">subscript</csymbol><ci id="S1.E8a.m1.5.5.4.5.2.2.cmml" xref="S1.E8a.m1.5.5.4.5.2.2">𝛼</ci><list id="S1.E8a.m1.4.4.3.2.2.3.cmml" xref="S1.E8a.m1.4.4.3.2.2.4"><ci id="S1.E8a.m1.3.3.2.1.1.1.cmml" xref="S1.E8a.m1.3.3.2.1.1.1">𝑠</ci><ci id="S1.E8a.m1.4.4.3.2.2.2.cmml" xref="S1.E8a.m1.4.4.3.2.2.2">𝑗</ci></list></apply><ci id="S1.E8a.m1.5.5.4.3.1.1.cmml" xref="S1.E8a.m1.5.5.4.3.1.1">𝐿</ci></apply></apply></apply><apply id="S1.E8a.m1.9.9.cmml" xref="S1.E8a.m1.9.9"><divide id="S1.E8a.m1.9.9.5.cmml" xref="S1.E8a.m1.9.9"></divide><apply id="S1.E8a.m1.8.8.3.cmml" xref="S1.E8a.m1.8.8.3"><partialdiff id="S1.E8a.m1.8.8.3.4.cmml" xref="S1.E8a.m1.8.8.3.4"></partialdiff><apply id="S1.E8a.m1.8.8.3.5.cmml" xref="S1.E8a.m1.8.8.3.5"><csymbol cd="ambiguous" id="S1.E8a.m1.8.8.3.5.1.cmml" xref="S1.E8a.m1.8.8.3.5">superscript</csymbol><apply id="S1.E8a.m1.8.8.3.5.2.cmml" xref="S1.E8a.m1.8.8.3.5"><csymbol cd="ambiguous" id="S1.E8a.m1.8.8.3.5.2.1.cmml" xref="S1.E8a.m1.8.8.3.5">subscript</csymbol><ci id="S1.E8a.m1.8.8.3.5.2.2.cmml" xref="S1.E8a.m1.8.8.3.5.2.2">𝛼</ci><list id="S1.E8a.m1.7.7.2.2.2.3.cmml" xref="S1.E8a.m1.7.7.2.2.2.4"><ci id="S1.E8a.m1.6.6.1.1.1.1.cmml" xref="S1.E8a.m1.6.6.1.1.1.1">𝑠</ci><ci id="S1.E8a.m1.7.7.2.2.2.2.cmml" xref="S1.E8a.m1.7.7.2.2.2.2">𝑗</ci></list></apply><ci id="S1.E8a.m1.8.8.3.3.1.1.cmml" xref="S1.E8a.m1.8.8.3.3.1.1">𝐿</ci></apply></apply><cerror id="S1.E8a.m1.9.9.4.cmml" xref="S1.E8a.m1.9.9.4"><csymbol cd="ambiguous" id="S1.E8a.m1.9.9.4a.cmml" xref="S1.E8a.m1.9.9.4">fragments</csymbol><partialdiff id="S1.E8a.m1.9.9.4.1.cmml" xref="S1.E8a.m1.9.9.4.1"></partialdiff><apply id="S1.E8a.m1.9.9.4.2.cmml" xref="S1.E8a.m1.9.9.4.2"><csymbol cd="ambiguous" id="S1.E8a.m1.9.9.4.2.1.cmml" xref="S1.E8a.m1.9.9.4.2">subscript</csymbol><cerror id="S1.E8a.m1.9.9.4.2.2.cmml" xref="S1.E8a.m1.9.9.4.2.2"><csymbol cd="ambiguous" id="S1.E8a.m1.9.9.4.2.2a.cmml" xref="S1.E8a.m1.9.9.4.2.2">fragments</csymbol><ci id="S1.E8a.m1.9.9.4.2.2.1.cmml" xref="S1.E8a.m1.9.9.4.2.2.1">⟨</ci><apply id="S1.E8a.m1.9.9.4.2.2.2.cmml" xref="S1.E8a.m1.9.9.4.2.2.2"><csymbol cd="ambiguous" id="S1.E8a.m1.9.9.4.2.2.2.1.cmml" xref="S1.E8a.m1.9.9.4.2.2.2">subscript</csymbol><ci id="S1.E8a.m1.9.9.4.2.2.2.2.cmml" xref="S1.E8a.m1.9.9.4.2.2.2.2">𝑍</ci><ci id="S1.E8a.m1.9.9.4.2.2.2.3.cmml" xref="S1.E8a.m1.9.9.4.2.2.2.3">𝑘</ci></apply><ci id="S1.E8a.m1.9.9.4.2.2.3.cmml" xref="S1.E8a.m1.9.9.4.2.2.3">⟩</ci></cerror><ci id="S1.E8a.m1.9.9.4.2.3.cmml" xref="S1.E8a.m1.9.9.4.2.3">𝑖</ci></apply></cerror></apply><apply id="S1.E8a.m1.11.11.cmml" xref="S1.E8a.m1.11.11"><divide id="S1.E8a.m1.11.11.3.cmml" xref="S1.E8a.m1.11.11"></divide><cerror id="S1.E8a.m1.10.10.1.cmml" xref="S1.E8a.m1.10.10.1"><csymbol cd="ambiguous" id="S1.E8a.m1.10.10.1a.cmml" xref="S1.E8a.m1.10.10.1">fragments</csymbol><partialdiff id="S1.E8a.m1.10.10.1.1.cmml" xref="S1.E8a.m1.10.10.1.1"></partialdiff><apply id="S1.E8a.m1.10.10.1.2.cmml" xref="S1.E8a.m1.10.10.1.2"><csymbol cd="ambiguous" id="S1.E8a.m1.10.10.1.2.1.cmml" xref="S1.E8a.m1.10.10.1.2">subscript</csymbol><cerror id="S1.E8a.m1.10.10.1.2.2.cmml" xref="S1.E8a.m1.10.10.1.2.2"><csymbol cd="ambiguous" id="S1.E8a.m1.10.10.1.2.2a.cmml" xref="S1.E8a.m1.10.10.1.2.2">fragments</csymbol><ci id="S1.E8a.m1.10.10.1.2.2.1.cmml" xref="S1.E8a.m1.10.10.1.2.2.1">⟨</ci><apply id="S1.E8a.m1.10.10.1.2.2.2.cmml" xref="S1.E8a.m1.10.10.1.2.2.2"><csymbol cd="ambiguous" id="S1.E8a.m1.10.10.1.2.2.2.1.cmml" xref="S1.E8a.m1.10.10.1.2.2.2">subscript</csymbol><ci id="S1.E8a.m1.10.10.1.2.2.2.2.cmml" xref="S1.E8a.m1.10.10.1.2.2.2.2">𝑍</ci><ci id="S1.E8a.m1.10.10.1.2.2.2.3.cmml" xref="S1.E8a.m1.10.10.1.2.2.2.3">𝑘</ci></apply><ci id="S1.E8a.m1.10.10.1.2.2.3.cmml" xref="S1.E8a.m1.10.10.1.2.2.3">⟩</ci></cerror><ci id="S1.E8a.m1.10.10.1.2.3.cmml" xref="S1.E8a.m1.10.10.1.2.3">𝑖</ci></apply></cerror><apply id="S1.E8a.m1.11.11.2.cmml" xref="S1.E8a.m1.11.11.2"><partialdiff id="S1.E8a.m1.11.11.2.2.cmml" xref="S1.E8a.m1.11.11.2.2"></partialdiff><apply id="S1.E8a.m1.11.11.2.3.cmml" xref="S1.E8a.m1.11.11.2.3"><csymbol cd="ambiguous" id="S1.E8a.m1.11.11.2.3.1.cmml" xref="S1.E8a.m1.11.11.2.3">subscript</csymbol><apply id="S1.E8a.m1.11.11.2.3.2.cmml" xref="S1.E8a.m1.11.11.2.3"><csymbol cd="ambiguous" id="S1.E8a.m1.11.11.2.3.2.1.cmml" xref="S1.E8a.m1.11.11.2.3">superscript</csymbol><ci id="S1.E8a.m1.11.11.2.3.2.2.cmml" xref="S1.E8a.m1.11.11.2.3.2.2">𝒚</ci><apply id="S1.E8a.m1.11.11.2.1.1.1.1.cmml" xref="S1.E8a.m1.11.11.2.1.1.1"><minus id="S1.E8a.m1.11.11.2.1.1.1.1.1.cmml" xref="S1.E8a.m1.11.11.2.1.1.1.1.1"></minus><ci id="S1.E8a.m1.11.11.2.1.1.1.1.2.cmml" xref="S1.E8a.m1.11.11.2.1.1.1.1.2">𝐿</ci><cn type="integer" id="S1.E8a.m1.11.11.2.1.1.1.1.3.cmml" xref="S1.E8a.m1.11.11.2.1.1.1.1.3">1</cn></apply></apply><ci id="S1.E8a.m1.11.11.2.3.3.cmml" xref="S1.E8a.m1.11.11.2.3.3">𝑖</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.E8a.m1.12c">\displaystyle+\sum_{s=1}^{S_{m}}\left(\frac{\partial\mathcal{L}}{\partial\bm{y%
}^{(L)}_{s}}\right)^{\top}\sum_{j=1}^{S_{m}}\frac{\partial\bm{y}^{(L)}_{s}}{%
\partial\alpha_{s,j}^{(L)}}\cdot\frac{\partial\alpha_{s,j}^{(L)}}{\partial%
\langle Z_{k}\rangle_{i}}\cdot\frac{\partial\langle Z_{k}\rangle_{i}}{\partial%
\bm{y}^{(L-1)}_{i}},</annotation><annotation encoding="application/x-llamapun" id="S1.E8a.m1.12d">+ ∑ start_POSTSUBSCRIPT italic_s = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_S start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT end_POSTSUPERSCRIPT ( divide start_ARG ∂ caligraphic_L end_ARG start_ARG ∂ bold_italic_y start_POSTSUPERSCRIPT ( italic_L ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT end_ARG ) start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_S start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT end_POSTSUPERSCRIPT divide start_ARG ∂ bold_italic_y start_POSTSUPERSCRIPT ( italic_L ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT end_ARG start_ARG ∂ italic_α start_POSTSUBSCRIPT italic_s , italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_L ) end_POSTSUPERSCRIPT end_ARG ⋅ divide start_ARG ∂ italic_α start_POSTSUBSCRIPT italic_s , italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_L ) end_POSTSUPERSCRIPT end_ARG start_ARG ∂ ⟨ italic_Z start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ⟩ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_ARG ⋅ divide start_ARG ∂ ⟨ italic_Z start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ⟩ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_ARG start_ARG ∂ bold_italic_y start_POSTSUPERSCRIPT ( italic_L - 1 ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(S8)</span></td>
</tr></tbody>
</table>
<p id="S1a.p2.2" class="ltx_p">where the four terms denote the residual, value, query and key parts, respectively, and each sub-term can be evaluated similarly to the above analysis.
With the above preparation, we could easily calculate every parameter’s gradient and update these parameters accordingly.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2205.05624" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="56" alt="ar5iv homepage" class="ar5iv_logo" src="/assets/ar5iv_halloween.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2205.05625" class="ar5iv-text-button ar5iv-severity-error">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2205.05625">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2205.05625" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2205.05626" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Wed Jul 13 02:06:12 2022 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span style="font-size:70%;position:relative; bottom:2.2pt;">A</span>T<span style="position:relative; bottom:-0.4ex;">E</span></span><span class="ltx_font_smallcaps">xml</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="[LOGO]"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
