<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>[2205.03773] Mutual Distillation Learning Network for Trajectory-User Linking</title><meta property="og:description" content="Trajectory-User Linking (TUL), which links trajectories to users who generate them, has been a challenging problem due to the sparsity in check-in mobility data. Existing methods ignore the utilization of historical da…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Mutual Distillation Learning Network for Trajectory-User Linking">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Mutual Distillation Learning Network for Trajectory-User Linking">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2205.03773">

<!--Generated on Mon Jun  6 02:51:42 2022 by LaTeXML (version 0.8.6) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="dark";
    var current_theme = localStorage.getItem("halloween_theme");
    if(current_theme){
      if(current_theme == "light"){
        theme = "light";
      } }
    else if(!window.matchMedia) { return false; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("halloween_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("halloween_theme", "dark"); }
      else {
        localStorage.setItem("halloween_theme", "light"); } }
    else {
        localStorage.setItem("halloween_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv.0.7.5.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.1.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Mutual Distillation Learning Network for Trajectory-User Linking</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Wei Chen<math id="id1.1.m1.1" class="ltx_Math" alttext="{}^{1}" display="inline"><semantics id="id1.1.m1.1a"><msup id="id1.1.m1.1.1" xref="id1.1.m1.1.1.cmml"><mi id="id1.1.m1.1.1a" xref="id1.1.m1.1.1.cmml"></mi><mn id="id1.1.m1.1.1.1" xref="id1.1.m1.1.1.1.cmml">1</mn></msup><annotation-xml encoding="MathML-Content" id="id1.1.m1.1b"><apply id="id1.1.m1.1.1.cmml" xref="id1.1.m1.1.1"><cn type="integer" id="id1.1.m1.1.1.1.cmml" xref="id1.1.m1.1.1.1">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id1.1.m1.1c">{}^{1}</annotation><annotation encoding="application/x-llamapun" id="id1.1.m1.1d">start_FLOATSUPERSCRIPT 1 end_FLOATSUPERSCRIPT</annotation></semantics></math>
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Shuzhe Li<math id="id2.1.m1.1" class="ltx_Math" alttext="{}^{1}" display="inline"><semantics id="id2.1.m1.1a"><msup id="id2.1.m1.1.1" xref="id2.1.m1.1.1.cmml"><mi id="id2.1.m1.1.1a" xref="id2.1.m1.1.1.cmml"></mi><mn id="id2.1.m1.1.1.1" xref="id2.1.m1.1.1.1.cmml">1</mn></msup><annotation-xml encoding="MathML-Content" id="id2.1.m1.1b"><apply id="id2.1.m1.1.1.cmml" xref="id2.1.m1.1.1"><cn type="integer" id="id2.1.m1.1.1.1.cmml" xref="id2.1.m1.1.1.1">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id2.1.m1.1c">{}^{1}</annotation><annotation encoding="application/x-llamapun" id="id2.1.m1.1d">start_FLOATSUPERSCRIPT 1 end_FLOATSUPERSCRIPT</annotation></semantics></math>
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Chao Huang<math id="id3.1.m1.1" class="ltx_Math" alttext="{}^{2}" display="inline"><semantics id="id3.1.m1.1a"><msup id="id3.1.m1.1.1" xref="id3.1.m1.1.1.cmml"><mi id="id3.1.m1.1.1a" xref="id3.1.m1.1.1.cmml"></mi><mn id="id3.1.m1.1.1.1" xref="id3.1.m1.1.1.1.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="id3.1.m1.1b"><apply id="id3.1.m1.1.1.cmml" xref="id3.1.m1.1.1"><cn type="integer" id="id3.1.m1.1.1.1.cmml" xref="id3.1.m1.1.1.1">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id3.1.m1.1c">{}^{2}</annotation><annotation encoding="application/x-llamapun" id="id3.1.m1.1d">start_FLOATSUPERSCRIPT 2 end_FLOATSUPERSCRIPT</annotation></semantics></math>
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Yanwei Yu<math id="id4.1.m1.1" class="ltx_Math" alttext="{}^{1}" display="inline"><semantics id="id4.1.m1.1a"><msup id="id4.1.m1.1.1" xref="id4.1.m1.1.1.cmml"><mi id="id4.1.m1.1.1a" xref="id4.1.m1.1.1.cmml"></mi><mn id="id4.1.m1.1.1.1" xref="id4.1.m1.1.1.1.cmml">1</mn></msup><annotation-xml encoding="MathML-Content" id="id4.1.m1.1b"><apply id="id4.1.m1.1.1.cmml" xref="id4.1.m1.1.1"><cn type="integer" id="id4.1.m1.1.1.1.cmml" xref="id4.1.m1.1.1.1">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id4.1.m1.1c">{}^{1}</annotation><annotation encoding="application/x-llamapun" id="id4.1.m1.1d">start_FLOATSUPERSCRIPT 1 end_FLOATSUPERSCRIPT</annotation></semantics></math><span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>Corresponding Author</span></span></span>
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Yongguo Jiang<math id="id5.1.m1.1" class="ltx_Math" alttext="{}^{1}" display="inline"><semantics id="id5.1.m1.1a"><msup id="id5.1.m1.1.1" xref="id5.1.m1.1.1.cmml"><mi id="id5.1.m1.1.1a" xref="id5.1.m1.1.1.cmml"></mi><mn id="id5.1.m1.1.1.1" xref="id5.1.m1.1.1.1.cmml">1</mn></msup><annotation-xml encoding="MathML-Content" id="id5.1.m1.1b"><apply id="id5.1.m1.1.1.cmml" xref="id5.1.m1.1.1"><cn type="integer" id="id5.1.m1.1.1.1.cmml" xref="id5.1.m1.1.1.1">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id5.1.m1.1c">{}^{1}</annotation><annotation encoding="application/x-llamapun" id="id5.1.m1.1d">start_FLOATSUPERSCRIPT 1 end_FLOATSUPERSCRIPT</annotation></semantics></math>
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Junyu Dong<math id="id6.1.m1.1" class="ltx_Math" alttext="{}^{1}" display="inline"><semantics id="id6.1.m1.1a"><msup id="id6.1.m1.1.1" xref="id6.1.m1.1.1.cmml"><mi id="id6.1.m1.1.1a" xref="id6.1.m1.1.1.cmml"></mi><mn id="id6.1.m1.1.1.1" xref="id6.1.m1.1.1.1.cmml">1</mn></msup><annotation-xml encoding="MathML-Content" id="id6.1.m1.1b"><apply id="id6.1.m1.1.1.cmml" xref="id6.1.m1.1.1"><cn type="integer" id="id6.1.m1.1.1.1.cmml" xref="id6.1.m1.1.1.1">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id6.1.m1.1c">{}^{1}</annotation><annotation encoding="application/x-llamapun" id="id6.1.m1.1d">start_FLOATSUPERSCRIPT 1 end_FLOATSUPERSCRIPT</annotation></semantics></math>
<br class="ltx_break"><math id="id7.2.m2.1" class="ltx_Math" alttext="{}^{1}" display="inline"><semantics id="id7.2.m2.1a"><msup id="id7.2.m2.1.1" xref="id7.2.m2.1.1.cmml"><mi id="id7.2.m2.1.1a" xref="id7.2.m2.1.1.cmml"></mi><mn id="id7.2.m2.1.1.1" xref="id7.2.m2.1.1.1.cmml">1</mn></msup><annotation-xml encoding="MathML-Content" id="id7.2.m2.1b"><apply id="id7.2.m2.1.1.cmml" xref="id7.2.m2.1.1"><cn type="integer" id="id7.2.m2.1.1.1.cmml" xref="id7.2.m2.1.1.1">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id7.2.m2.1c">{}^{1}</annotation><annotation encoding="application/x-llamapun" id="id7.2.m2.1d">start_FLOATSUPERSCRIPT 1 end_FLOATSUPERSCRIPT</annotation></semantics></math>College of Computer Science and Technology, Ocean University of China
<br class="ltx_break"><math id="id8.3.m3.1" class="ltx_Math" alttext="{}^{2}" display="inline"><semantics id="id8.3.m3.1a"><msup id="id8.3.m3.1.1" xref="id8.3.m3.1.1.cmml"><mi id="id8.3.m3.1.1a" xref="id8.3.m3.1.1.cmml"></mi><mn id="id8.3.m3.1.1.1" xref="id8.3.m3.1.1.1.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="id8.3.m3.1b"><apply id="id8.3.m3.1.1.cmml" xref="id8.3.m3.1.1"><cn type="integer" id="id8.3.m3.1.1.1.cmml" xref="id8.3.m3.1.1.1">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id8.3.m3.1c">{}^{2}</annotation><annotation encoding="application/x-llamapun" id="id8.3.m3.1d">start_FLOATSUPERSCRIPT 2 end_FLOATSUPERSCRIPT</annotation></semantics></math>Department of Computer Science, The University of Hong Kong
<br class="ltx_break">{weichen, lishuzhe}@stu.ouc.edu.cn,
chaohuang75@gmail.com,
<br class="ltx_break">{yuyanwei, jiangyg, dongjunyu}@ouc.edu.cn
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id9.id1" class="ltx_p">Trajectory-User Linking (TUL), which links trajectories to users who generate them, has been a challenging problem due to the sparsity in check-in mobility data. Existing methods ignore the utilization of historical data or rich contextual features in check-in data, resulting in poor performance for TUL task. In this paper, we propose a novel <span id="id9.id1.1" class="ltx_text ltx_framed_underline">M</span>utu<span id="id9.id1.2" class="ltx_text ltx_framed_underline">a</span>l d<span id="id9.id1.3" class="ltx_text ltx_framed_underline">i</span>stillatio<span id="id9.id1.4" class="ltx_text ltx_framed_underline">n</span> learning network to solve the <span id="id9.id1.5" class="ltx_text ltx_framed_underline">TUL</span> problem for sparse check-in mobility data, named <span id="id9.id1.6" class="ltx_text ltx_font_italic">MainTUL</span>. Specifically, MainTUL is composed of a <span id="id9.id1.7" class="ltx_text ltx_font_italic">Recurrent Neural Network (RNN) trajectory encoder</span> that models sequential patterns of input trajectory and a <span id="id9.id1.8" class="ltx_text ltx_font_italic">temporal-aware Transformer trajectory encoder</span> that captures long-term time dependencies for the corresponding augmented historical trajectories. Then, the knowledge learned on historical trajectories is transferred between the two trajectory encoders to guide the learning of both encoders to achieve <span id="id9.id1.9" class="ltx_text ltx_font_italic">mutual distillation of information</span>. Experimental results on two real-world check-in mobility datasets demonstrate the superiority of MainTUL against state-of-the-art baselines. The source code of our model is available at <a target="_blank" href="https://github.com/Onedean/MainTUL" title="" class="ltx_ref ltx_url">https://github.com/Onedean/MainTUL</a>.</p>
</div>
<span id="id1" class="ltx_ERROR undefined">\useunder</span>
<div id="p1" class="ltx_para">
<p id="p1.1" class="ltx_p"><span id="p1.1.1" class="ltx_text ltx_ulem_uline"></span><span id="p1.1.2" class="ltx_text ltx_framed_underline"></span>











</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">The rapid development of Location-Based Social Network (LBSN) platforms has made it easier for humans to digitize their mobility behaviors by sharing their check-ins, opinions, and comments <cite class="ltx_cite ltx_citemacro_citep">(Lian <span class="ltx_text ltx_font_italic">et al.</span>, <a href="#bib.bib15" title="" class="ltx_ref">2020</a>)</cite>. These mobility behaviors can be used to understand and predict human movement patterns, facilitating intelligent business models and user experience. However, individual mobility is not always predictable due to the missing and sparsity of check-in data <cite class="ltx_cite ltx_citemacro_citep">(Lian <span class="ltx_text ltx_font_italic">et al.</span>, <a href="#bib.bib14" title="" class="ltx_ref">2014</a>)</cite>. Trajectory-user linking (TUL) <cite class="ltx_cite ltx_citemacro_citep">(Gao <span class="ltx_text ltx_font_italic">et al.</span>, <a href="#bib.bib2" title="" class="ltx_ref">2017</a>)</cite> is recently proposed as a task to identify user identities based on personal mobility trajectories. It plays an important role in revealing basic human movement patterns by mining user mobility behaviors.
In addition, TUL could benefit a broad range of applications in business, transportation, epidemic prevention, and public safety, such as location-based services <cite class="ltx_cite ltx_citemacro_citep">(Liu <span class="ltx_text ltx_font_italic">et al.</span>, <a href="#bib.bib18" title="" class="ltx_ref">2019</a>)</cite>, tracking COVID-19 pandemic <cite class="ltx_cite ltx_citemacro_citep">(Hao <span class="ltx_text ltx_font_italic">et al.</span>, <a href="#bib.bib4" title="" class="ltx_ref">2020</a>)</cite>, intelligent transportation <cite class="ltx_cite ltx_citemacro_cite">Dai <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib1" title="" class="ltx_ref">2021</a>)</cite>, and identifying terrorists/criminals for public safety <cite class="ltx_cite ltx_citemacro_citep">(Huang <span class="ltx_text ltx_font_italic">et al.</span>, <a href="#bib.bib7" title="" class="ltx_ref">2018</a>)</cite>.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">In this work, we are interested in linking trajectories to their potential users for check-in mobility data.
TUL can essentially be seen as an extension of traditional trajectory classification tasks. Traditional trajectory measurement methods such as Longest Common Sub-Sequence (LCSS) and Dynamic Time Warping (DTW) can identify the most likely users by measuring the similarity between unknown trajectories and known trajectories.
Recently, a handful of studies <cite class="ltx_cite ltx_citemacro_citep">(Zhou <span class="ltx_text ltx_font_italic">et al.</span>, <a href="#bib.bib33" title="" class="ltx_ref">2018</a>, <a href="#bib.bib34" title="" class="ltx_ref">2021a</a>; Miao <span class="ltx_text ltx_font_italic">et al.</span>, <a href="#bib.bib19" title="" class="ltx_ref">2020</a>)</cite> have been developed for solving the TUL problem through deep trajectory representation learning. However, the existing methods still have three key limitations.
<span id="S1.p2.1.1" class="ltx_text ltx_font_italic">First,</span> all existing approaches still suffer from <span id="S1.p2.1.2" class="ltx_text ltx_font_italic">data sparsity</span>, and perform poorly on sparse check-in mobility datasets.
<span id="S1.p2.1.3" class="ltx_text ltx_font_italic">Second,</span> existing methods only focus on spatial feature and/or temporal feature, and ignore the <span id="S1.p2.1.4" class="ltx_text ltx_font_italic">rich contextual features</span> in check-in data such as POI categories.
<span id="S1.p2.1.5" class="ltx_text ltx_font_italic">Third,</span> most existing methods neglect the <span id="S1.p2.1.6" class="ltx_text ltx_font_italic">utilization of historical data</span>. Due to the inherent sparsity of check-in data, the historical data of same users implies users‘ more complex movement patterns, which may help improve the model performance. Nevertheless, how to effectively utilize the knowledge from historical data remains a significant challenge.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">To address the aforementioned challenges, we propose MainTUL, a <span id="S1.p3.1.1" class="ltx_text ltx_framed_underline">M</span>utu<span id="S1.p3.1.2" class="ltx_text ltx_framed_underline">a</span>l d<span id="S1.p3.1.3" class="ltx_text ltx_framed_underline">i</span>stillatio<span id="S1.p3.1.4" class="ltx_text ltx_framed_underline">n</span> learning network model, to solve the <span id="S1.p3.1.5" class="ltx_text ltx_framed_underline">TUL</span> problem for sparse check-in trajectory data. In MainTUL, we design two different trajectory encoders – an RNN-based encoder to learn spatio-temporal movement patterns of input trajectory, and a temporal-aware transformer encoder to capture long-term time dependencies for the corresponding augmented trajectory. Then, the knowledge learned from the augmented trajectory data is transferred to guide the learning of RNN-based trajectory encoder. Meanwhile, input trajectory and augmented trajectory is exchanged to realize a mutual distillation learning network.
Additionally, we also design a check-in embedding layer to produce multi-semantic check-in representations integrated with POI category and time information, which are then fed into the mutual distillation learning network.
Experimental results on two real-life human mobility datasets show that our model significantly outperforms state-of-the-art baselines (<span id="S1.p3.1.6" class="ltx_text ltx_font_bold">14.95</span>% Acc@1 gain and <span id="S1.p3.1.7" class="ltx_text ltx_font_bold">14.11</span>% Macro-F1 gain on average) in TUL task.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">Our contributions can be summarized as follows:</p>
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">We propose a mutual distillation learning network model, MainTUL, to solve TUL problem for sparse check-in trajectory data. Our MainTUL effectively leverages history data by trajectory augmentation and knowledge distillation to improve model performance.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">We design a temporal-aware transformer trajectory encoder in MainTUL to capture the long-term time dependencies in the augmented trajectories. With the designed trajectory encoders, our model achieves mutual distillation of information.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">We conduct extensive experiments on two real-life check-in mobility datasets. Results show that our model significantly outperforms state-of-the-art baselines by average 14.95% and 14.11% improvements in terms of Acc@1 and Macro-F1.</p>
</div>
</li>
</ul>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p">Trajectory similarity measures have been widely used to explore the similarity of users from their spatiotemporal trajectories. Examples include LCSS <cite class="ltx_cite ltx_citemacro_citep">(Ying <span class="ltx_text ltx_font_italic">et al.</span>, <a href="#bib.bib30" title="" class="ltx_ref">2010</a>)</cite>, DTW <cite class="ltx_cite ltx_citemacro_citep">(Keogh and Pazzani, <a href="#bib.bib12" title="" class="ltx_ref">2000</a>)</cite>, Spatio-Temporal Linear Combine distance <cite class="ltx_cite ltx_citemacro_citep">(Shang <span class="ltx_text ltx_font_italic">et al.</span>, <a href="#bib.bib22" title="" class="ltx_ref">2017</a>)</cite>, and Spatiotemporal Signature <cite class="ltx_cite ltx_citemacro_citep">(Jin <span class="ltx_text ltx_font_italic">et al.</span>, <a href="#bib.bib10" title="" class="ltx_ref">2019</a>)</cite>. <span id="S2.p1.1.1" class="ltx_text ltx_font_italic">However, such measures only consider spatial or spatio-temporal proximities and cannot capture the temporal dependencies in trajectory data. </span></p>
</div>
<div id="S2.p2" class="ltx_para">
<p id="S2.p2.1" class="ltx_p">Recently, a variety of studies that focus on deep representation learning have been proposed for trajectory similarity computation <cite class="ltx_cite ltx_citemacro_citep">(Li <span class="ltx_text ltx_font_italic">et al.</span>, <a href="#bib.bib13" title="" class="ltx_ref">2018</a>; Yao <span class="ltx_text ltx_font_italic">et al.</span>, <a href="#bib.bib28" title="" class="ltx_ref">2019</a>, <a href="#bib.bib29" title="" class="ltx_ref">2020</a>; Zhang <span class="ltx_text ltx_font_italic">et al.</span>, <a href="#bib.bib31" title="" class="ltx_ref">2020</a>; Yang <span class="ltx_text ltx_font_italic">et al.</span>, <a href="#bib.bib27" title="" class="ltx_ref">2021</a>)</cite>. <span id="S2.p2.1.1" class="ltx_text ltx_font_italic">However, these studies focus more on improving the efficiency of trajectory similarity computation.</span> The introduction of TUL problem <cite class="ltx_cite ltx_citemacro_citep">(Gao <span class="ltx_text ltx_font_italic">et al.</span>, <a href="#bib.bib2" title="" class="ltx_ref">2017</a>; Zhou <span class="ltx_text ltx_font_italic">et al.</span>, <a href="#bib.bib33" title="" class="ltx_ref">2018</a>)</cite> has further promoted the progress of deep trajectory representation learning in spatio-temporal data mining. Several methods <cite class="ltx_cite ltx_citemacro_citep">(Miao <span class="ltx_text ltx_font_italic">et al.</span>, <a href="#bib.bib19" title="" class="ltx_ref">2020</a>; Zhou <span class="ltx_text ltx_font_italic">et al.</span>, <a href="#bib.bib35" title="" class="ltx_ref">2021b</a>; Gao <span class="ltx_text ltx_font_italic">et al.</span>, <a href="#bib.bib3" title="" class="ltx_ref">2020</a>)</cite> have been proposed to solve the TUL problem with deep neural networks.
TULVAE <cite class="ltx_cite ltx_citemacro_citep">(Zhou <span class="ltx_text ltx_font_italic">et al.</span>, <a href="#bib.bib33" title="" class="ltx_ref">2018</a>)</cite> incorporates VAE model into TUL problem to learn hierarchical semantics of check-in trajectories in RNN. DeepTUL <cite class="ltx_cite ltx_citemacro_citep">(Miao <span class="ltx_text ltx_font_italic">et al.</span>, <a href="#bib.bib19" title="" class="ltx_ref">2020</a>)</cite> proposes recurrent networks with attention mechanism to model higher-order and multi-periodic mobility patterns by learning from historical data to alleviate the data sparsity problem.
AdattTUL <cite class="ltx_cite ltx_citemacro_citep">(Gao <span class="ltx_text ltx_font_italic">et al.</span>, <a href="#bib.bib3" title="" class="ltx_ref">2020</a>)</cite> and TGAN <cite class="ltx_cite ltx_citemacro_citep">(Zhou <span class="ltx_text ltx_font_italic">et al.</span>, <a href="#bib.bib35" title="" class="ltx_ref">2021b</a>)</cite> introduce Generation Adversarial Network (GAN) to deal with the TUL problem.
Recently, SML-TUL <cite class="ltx_cite ltx_citemacro_citep">(Zhou <span class="ltx_text ltx_font_italic">et al.</span>, <a href="#bib.bib34" title="" class="ltx_ref">2021a</a>)</cite> uses contrastive learning to learn the predictive representations from the user mobility itself constrained by the spatio-temporal factors.
<span id="S2.p2.1.2" class="ltx_text ltx_font_italic">Nevertheless, these methods use RNNs for modeling or prediction, which cannot effectively capture long-term time dependencies, and all methods ignore the effective use of historical data.</span></p>
</div>
<div id="S2.p3" class="ltx_para">
<p id="S2.p3.1" class="ltx_p"><cite class="ltx_cite ltx_citemacro_cite">Hinton <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib5" title="" class="ltx_ref">2015</a>)</cite> first proposed the concept of Knowledge Distillation (KD) in teacher-student architecture, which seeks to provide another pathway to gain knowledge about a task by training a model with a distillation loss in addition to the task loss. <cite class="ltx_cite ltx_citemacro_cite">Ruffy and Chahal (<a href="#bib.bib20" title="" class="ltx_ref">2019</a>)</cite> validate that appropriately tuned classical distillation in combination with a data augmentation training scheme provides orthogonal improvements. Recently, <cite class="ltx_cite ltx_citemacro_cite">Zhao <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib32" title="" class="ltx_ref">2021</a>)</cite> propose a trainable mutual distillation learning model, which improves end-to-end performance more effectively than traditional teacher-student framework. <span id="S2.p3.1.1" class="ltx_text ltx_font_italic">In this work, we are the first attempt to use mutual distillation strategy to effectively utilize knowledge extracted from historical data to improve TUL performance.</span></p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Preliminaries</h2>

<div id="ThmDef1" class="ltx_theorem ltx_theorem_Def">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span id="ThmDef1.1.1.1" class="ltx_text ltx_font_bold">Definition 1</span></span><span id="ThmDef1.2.2" class="ltx_text ltx_font_bold"> </span>(Check-in Record)<span id="ThmDef1.3.3" class="ltx_text ltx_font_bold">.</span>
</h6>
<div id="ThmDef1.p1" class="ltx_para">
<p id="ThmDef1.p1.7" class="ltx_p"><span id="ThmDef1.p1.7.7" class="ltx_text ltx_font_italic">A check-in record is a triple <math id="ThmDef1.p1.1.1.m1.3" class="ltx_Math" alttext="\langle u,t,p\rangle" display="inline"><semantics id="ThmDef1.p1.1.1.m1.3a"><mrow id="ThmDef1.p1.1.1.m1.3.4.2" xref="ThmDef1.p1.1.1.m1.3.4.1.cmml"><mo mathvariant="normal" stretchy="false" id="ThmDef1.p1.1.1.m1.3.4.2.1" xref="ThmDef1.p1.1.1.m1.3.4.1.cmml">⟨</mo><mi id="ThmDef1.p1.1.1.m1.1.1" xref="ThmDef1.p1.1.1.m1.1.1.cmml">u</mi><mo mathvariant="normal" id="ThmDef1.p1.1.1.m1.3.4.2.2" xref="ThmDef1.p1.1.1.m1.3.4.1.cmml">,</mo><mi id="ThmDef1.p1.1.1.m1.2.2" xref="ThmDef1.p1.1.1.m1.2.2.cmml">t</mi><mo mathvariant="normal" id="ThmDef1.p1.1.1.m1.3.4.2.3" xref="ThmDef1.p1.1.1.m1.3.4.1.cmml">,</mo><mi id="ThmDef1.p1.1.1.m1.3.3" xref="ThmDef1.p1.1.1.m1.3.3.cmml">p</mi><mo mathvariant="normal" stretchy="false" id="ThmDef1.p1.1.1.m1.3.4.2.4" xref="ThmDef1.p1.1.1.m1.3.4.1.cmml">⟩</mo></mrow><annotation-xml encoding="MathML-Content" id="ThmDef1.p1.1.1.m1.3b"><list id="ThmDef1.p1.1.1.m1.3.4.1.cmml" xref="ThmDef1.p1.1.1.m1.3.4.2"><ci id="ThmDef1.p1.1.1.m1.1.1.cmml" xref="ThmDef1.p1.1.1.m1.1.1">𝑢</ci><ci id="ThmDef1.p1.1.1.m1.2.2.cmml" xref="ThmDef1.p1.1.1.m1.2.2">𝑡</ci><ci id="ThmDef1.p1.1.1.m1.3.3.cmml" xref="ThmDef1.p1.1.1.m1.3.3">𝑝</ci></list></annotation-xml><annotation encoding="application/x-tex" id="ThmDef1.p1.1.1.m1.3c">\langle u,t,p\rangle</annotation><annotation encoding="application/x-llamapun" id="ThmDef1.p1.1.1.m1.3d">⟨ italic_u , italic_t , italic_p ⟩</annotation></semantics></math> that represents user <math id="ThmDef1.p1.2.2.m2.1" class="ltx_Math" alttext="u" display="inline"><semantics id="ThmDef1.p1.2.2.m2.1a"><mi id="ThmDef1.p1.2.2.m2.1.1" xref="ThmDef1.p1.2.2.m2.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="ThmDef1.p1.2.2.m2.1b"><ci id="ThmDef1.p1.2.2.m2.1.1.cmml" xref="ThmDef1.p1.2.2.m2.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="ThmDef1.p1.2.2.m2.1c">u</annotation><annotation encoding="application/x-llamapun" id="ThmDef1.p1.2.2.m2.1d">italic_u</annotation></semantics></math> visiting POI <math id="ThmDef1.p1.3.3.m3.1" class="ltx_Math" alttext="p" display="inline"><semantics id="ThmDef1.p1.3.3.m3.1a"><mi id="ThmDef1.p1.3.3.m3.1.1" xref="ThmDef1.p1.3.3.m3.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="ThmDef1.p1.3.3.m3.1b"><ci id="ThmDef1.p1.3.3.m3.1.1.cmml" xref="ThmDef1.p1.3.3.m3.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="ThmDef1.p1.3.3.m3.1c">p</annotation><annotation encoding="application/x-llamapun" id="ThmDef1.p1.3.3.m3.1d">italic_p</annotation></semantics></math> at time <math id="ThmDef1.p1.4.4.m4.1" class="ltx_Math" alttext="t" display="inline"><semantics id="ThmDef1.p1.4.4.m4.1a"><mi id="ThmDef1.p1.4.4.m4.1.1" xref="ThmDef1.p1.4.4.m4.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="ThmDef1.p1.4.4.m4.1b"><ci id="ThmDef1.p1.4.4.m4.1.1.cmml" xref="ThmDef1.p1.4.4.m4.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="ThmDef1.p1.4.4.m4.1c">t</annotation><annotation encoding="application/x-llamapun" id="ThmDef1.p1.4.4.m4.1d">italic_t</annotation></semantics></math>, where <math id="ThmDef1.p1.5.5.m5.1" class="ltx_Math" alttext="p" display="inline"><semantics id="ThmDef1.p1.5.5.m5.1a"><mi id="ThmDef1.p1.5.5.m5.1.1" xref="ThmDef1.p1.5.5.m5.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="ThmDef1.p1.5.5.m5.1b"><ci id="ThmDef1.p1.5.5.m5.1.1.cmml" xref="ThmDef1.p1.5.5.m5.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="ThmDef1.p1.5.5.m5.1c">p</annotation><annotation encoding="application/x-llamapun" id="ThmDef1.p1.5.5.m5.1d">italic_p</annotation></semantics></math> denotes a uniquely identified venue in the form of <math id="ThmDef1.p1.6.6.m6.3" class="ltx_Math" alttext="(id,category,\ell)" display="inline"><semantics id="ThmDef1.p1.6.6.m6.3a"><mrow id="ThmDef1.p1.6.6.m6.3.3.2" xref="ThmDef1.p1.6.6.m6.3.3.3.cmml"><mo mathvariant="normal" stretchy="false" id="ThmDef1.p1.6.6.m6.3.3.2.3" xref="ThmDef1.p1.6.6.m6.3.3.3.cmml">(</mo><mrow id="ThmDef1.p1.6.6.m6.2.2.1.1" xref="ThmDef1.p1.6.6.m6.2.2.1.1.cmml"><mi id="ThmDef1.p1.6.6.m6.2.2.1.1.2" xref="ThmDef1.p1.6.6.m6.2.2.1.1.2.cmml">i</mi><mo mathvariant="italic" id="ThmDef1.p1.6.6.m6.2.2.1.1.1" xref="ThmDef1.p1.6.6.m6.2.2.1.1.1.cmml">⁢</mo><mi id="ThmDef1.p1.6.6.m6.2.2.1.1.3" xref="ThmDef1.p1.6.6.m6.2.2.1.1.3.cmml">d</mi></mrow><mo mathvariant="normal" id="ThmDef1.p1.6.6.m6.3.3.2.4" xref="ThmDef1.p1.6.6.m6.3.3.3.cmml">,</mo><mrow id="ThmDef1.p1.6.6.m6.3.3.2.2" xref="ThmDef1.p1.6.6.m6.3.3.2.2.cmml"><mi id="ThmDef1.p1.6.6.m6.3.3.2.2.2" xref="ThmDef1.p1.6.6.m6.3.3.2.2.2.cmml">c</mi><mo mathvariant="italic" id="ThmDef1.p1.6.6.m6.3.3.2.2.1" xref="ThmDef1.p1.6.6.m6.3.3.2.2.1.cmml">⁢</mo><mi id="ThmDef1.p1.6.6.m6.3.3.2.2.3" xref="ThmDef1.p1.6.6.m6.3.3.2.2.3.cmml">a</mi><mo mathvariant="italic" id="ThmDef1.p1.6.6.m6.3.3.2.2.1a" xref="ThmDef1.p1.6.6.m6.3.3.2.2.1.cmml">⁢</mo><mi id="ThmDef1.p1.6.6.m6.3.3.2.2.4" xref="ThmDef1.p1.6.6.m6.3.3.2.2.4.cmml">t</mi><mo mathvariant="italic" id="ThmDef1.p1.6.6.m6.3.3.2.2.1b" xref="ThmDef1.p1.6.6.m6.3.3.2.2.1.cmml">⁢</mo><mi id="ThmDef1.p1.6.6.m6.3.3.2.2.5" xref="ThmDef1.p1.6.6.m6.3.3.2.2.5.cmml">e</mi><mo mathvariant="italic" id="ThmDef1.p1.6.6.m6.3.3.2.2.1c" xref="ThmDef1.p1.6.6.m6.3.3.2.2.1.cmml">⁢</mo><mi id="ThmDef1.p1.6.6.m6.3.3.2.2.6" xref="ThmDef1.p1.6.6.m6.3.3.2.2.6.cmml">g</mi><mo mathvariant="italic" id="ThmDef1.p1.6.6.m6.3.3.2.2.1d" xref="ThmDef1.p1.6.6.m6.3.3.2.2.1.cmml">⁢</mo><mi id="ThmDef1.p1.6.6.m6.3.3.2.2.7" xref="ThmDef1.p1.6.6.m6.3.3.2.2.7.cmml">o</mi><mo mathvariant="italic" id="ThmDef1.p1.6.6.m6.3.3.2.2.1e" xref="ThmDef1.p1.6.6.m6.3.3.2.2.1.cmml">⁢</mo><mi id="ThmDef1.p1.6.6.m6.3.3.2.2.8" xref="ThmDef1.p1.6.6.m6.3.3.2.2.8.cmml">r</mi><mo mathvariant="italic" id="ThmDef1.p1.6.6.m6.3.3.2.2.1f" xref="ThmDef1.p1.6.6.m6.3.3.2.2.1.cmml">⁢</mo><mi id="ThmDef1.p1.6.6.m6.3.3.2.2.9" xref="ThmDef1.p1.6.6.m6.3.3.2.2.9.cmml">y</mi></mrow><mo mathvariant="normal" id="ThmDef1.p1.6.6.m6.3.3.2.5" xref="ThmDef1.p1.6.6.m6.3.3.3.cmml">,</mo><mi mathvariant="normal" id="ThmDef1.p1.6.6.m6.1.1" xref="ThmDef1.p1.6.6.m6.1.1.cmml">ℓ</mi><mo mathvariant="normal" stretchy="false" id="ThmDef1.p1.6.6.m6.3.3.2.6" xref="ThmDef1.p1.6.6.m6.3.3.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="ThmDef1.p1.6.6.m6.3b"><vector id="ThmDef1.p1.6.6.m6.3.3.3.cmml" xref="ThmDef1.p1.6.6.m6.3.3.2"><apply id="ThmDef1.p1.6.6.m6.2.2.1.1.cmml" xref="ThmDef1.p1.6.6.m6.2.2.1.1"><times id="ThmDef1.p1.6.6.m6.2.2.1.1.1.cmml" xref="ThmDef1.p1.6.6.m6.2.2.1.1.1"></times><ci id="ThmDef1.p1.6.6.m6.2.2.1.1.2.cmml" xref="ThmDef1.p1.6.6.m6.2.2.1.1.2">𝑖</ci><ci id="ThmDef1.p1.6.6.m6.2.2.1.1.3.cmml" xref="ThmDef1.p1.6.6.m6.2.2.1.1.3">𝑑</ci></apply><apply id="ThmDef1.p1.6.6.m6.3.3.2.2.cmml" xref="ThmDef1.p1.6.6.m6.3.3.2.2"><times id="ThmDef1.p1.6.6.m6.3.3.2.2.1.cmml" xref="ThmDef1.p1.6.6.m6.3.3.2.2.1"></times><ci id="ThmDef1.p1.6.6.m6.3.3.2.2.2.cmml" xref="ThmDef1.p1.6.6.m6.3.3.2.2.2">𝑐</ci><ci id="ThmDef1.p1.6.6.m6.3.3.2.2.3.cmml" xref="ThmDef1.p1.6.6.m6.3.3.2.2.3">𝑎</ci><ci id="ThmDef1.p1.6.6.m6.3.3.2.2.4.cmml" xref="ThmDef1.p1.6.6.m6.3.3.2.2.4">𝑡</ci><ci id="ThmDef1.p1.6.6.m6.3.3.2.2.5.cmml" xref="ThmDef1.p1.6.6.m6.3.3.2.2.5">𝑒</ci><ci id="ThmDef1.p1.6.6.m6.3.3.2.2.6.cmml" xref="ThmDef1.p1.6.6.m6.3.3.2.2.6">𝑔</ci><ci id="ThmDef1.p1.6.6.m6.3.3.2.2.7.cmml" xref="ThmDef1.p1.6.6.m6.3.3.2.2.7">𝑜</ci><ci id="ThmDef1.p1.6.6.m6.3.3.2.2.8.cmml" xref="ThmDef1.p1.6.6.m6.3.3.2.2.8">𝑟</ci><ci id="ThmDef1.p1.6.6.m6.3.3.2.2.9.cmml" xref="ThmDef1.p1.6.6.m6.3.3.2.2.9">𝑦</ci></apply><ci id="ThmDef1.p1.6.6.m6.1.1.cmml" xref="ThmDef1.p1.6.6.m6.1.1">normal-ℓ</ci></vector></annotation-xml><annotation encoding="application/x-tex" id="ThmDef1.p1.6.6.m6.3c">(id,category,\ell)</annotation><annotation encoding="application/x-llamapun" id="ThmDef1.p1.6.6.m6.3d">( italic_i italic_d , italic_c italic_a italic_t italic_e italic_g italic_o italic_r italic_y , roman_ℓ )</annotation></semantics></math>, <math id="ThmDef1.p1.7.7.m7.1" class="ltx_Math" alttext="\ell" display="inline"><semantics id="ThmDef1.p1.7.7.m7.1a"><mi mathvariant="normal" id="ThmDef1.p1.7.7.m7.1.1" xref="ThmDef1.p1.7.7.m7.1.1.cmml">ℓ</mi><annotation-xml encoding="MathML-Content" id="ThmDef1.p1.7.7.m7.1b"><ci id="ThmDef1.p1.7.7.m7.1.1.cmml" xref="ThmDef1.p1.7.7.m7.1.1">normal-ℓ</ci></annotation-xml><annotation encoding="application/x-tex" id="ThmDef1.p1.7.7.m7.1c">\ell</annotation><annotation encoding="application/x-llamapun" id="ThmDef1.p1.7.7.m7.1d">roman_ℓ</annotation></semantics></math> representing the location of the POI.</span></p>
</div>
</div>
<div id="ThmDef2" class="ltx_theorem ltx_theorem_Def">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span id="ThmDef2.1.1.1" class="ltx_text ltx_font_bold">Definition 2</span></span><span id="ThmDef2.2.2" class="ltx_text ltx_font_bold"> </span>(Trajectory)<span id="ThmDef2.3.3" class="ltx_text ltx_font_bold">.</span>
</h6>
<div id="ThmDef2.p1" class="ltx_para">
<p id="ThmDef2.p1.4" class="ltx_p"><span id="ThmDef2.p1.4.4" class="ltx_text ltx_font_italic">A trajectory is a sequence of check-in records <math id="ThmDef2.p1.1.1.m1.7" class="ltx_Math" alttext="(\langle u,t_{1},p_{1}\rangle,\langle u,t_{2},p_{2}\rangle,\dots,\langle u,t_{%
m},p_{m}\rangle)" display="inline"><semantics id="ThmDef2.p1.1.1.m1.7a"><mrow id="ThmDef2.p1.1.1.m1.7.7.3" xref="ThmDef2.p1.1.1.m1.7.7.4.cmml"><mo mathvariant="normal" stretchy="false" id="ThmDef2.p1.1.1.m1.7.7.3.4" xref="ThmDef2.p1.1.1.m1.7.7.4.cmml">(</mo><mrow id="ThmDef2.p1.1.1.m1.5.5.1.1.2" xref="ThmDef2.p1.1.1.m1.5.5.1.1.3.cmml"><mo mathvariant="normal" stretchy="false" id="ThmDef2.p1.1.1.m1.5.5.1.1.2.3" xref="ThmDef2.p1.1.1.m1.5.5.1.1.3.cmml">⟨</mo><mi id="ThmDef2.p1.1.1.m1.1.1" xref="ThmDef2.p1.1.1.m1.1.1.cmml">u</mi><mo mathvariant="normal" id="ThmDef2.p1.1.1.m1.5.5.1.1.2.4" xref="ThmDef2.p1.1.1.m1.5.5.1.1.3.cmml">,</mo><msub id="ThmDef2.p1.1.1.m1.5.5.1.1.1.1" xref="ThmDef2.p1.1.1.m1.5.5.1.1.1.1.cmml"><mi id="ThmDef2.p1.1.1.m1.5.5.1.1.1.1.2" xref="ThmDef2.p1.1.1.m1.5.5.1.1.1.1.2.cmml">t</mi><mn mathvariant="normal" id="ThmDef2.p1.1.1.m1.5.5.1.1.1.1.3" xref="ThmDef2.p1.1.1.m1.5.5.1.1.1.1.3.cmml">1</mn></msub><mo mathvariant="normal" id="ThmDef2.p1.1.1.m1.5.5.1.1.2.5" xref="ThmDef2.p1.1.1.m1.5.5.1.1.3.cmml">,</mo><msub id="ThmDef2.p1.1.1.m1.5.5.1.1.2.2" xref="ThmDef2.p1.1.1.m1.5.5.1.1.2.2.cmml"><mi id="ThmDef2.p1.1.1.m1.5.5.1.1.2.2.2" xref="ThmDef2.p1.1.1.m1.5.5.1.1.2.2.2.cmml">p</mi><mn mathvariant="normal" id="ThmDef2.p1.1.1.m1.5.5.1.1.2.2.3" xref="ThmDef2.p1.1.1.m1.5.5.1.1.2.2.3.cmml">1</mn></msub><mo mathvariant="normal" stretchy="false" id="ThmDef2.p1.1.1.m1.5.5.1.1.2.6" xref="ThmDef2.p1.1.1.m1.5.5.1.1.3.cmml">⟩</mo></mrow><mo mathvariant="normal" id="ThmDef2.p1.1.1.m1.7.7.3.5" xref="ThmDef2.p1.1.1.m1.7.7.4.cmml">,</mo><mrow id="ThmDef2.p1.1.1.m1.6.6.2.2.2" xref="ThmDef2.p1.1.1.m1.6.6.2.2.3.cmml"><mo mathvariant="normal" stretchy="false" id="ThmDef2.p1.1.1.m1.6.6.2.2.2.3" xref="ThmDef2.p1.1.1.m1.6.6.2.2.3.cmml">⟨</mo><mi id="ThmDef2.p1.1.1.m1.2.2" xref="ThmDef2.p1.1.1.m1.2.2.cmml">u</mi><mo mathvariant="normal" id="ThmDef2.p1.1.1.m1.6.6.2.2.2.4" xref="ThmDef2.p1.1.1.m1.6.6.2.2.3.cmml">,</mo><msub id="ThmDef2.p1.1.1.m1.6.6.2.2.1.1" xref="ThmDef2.p1.1.1.m1.6.6.2.2.1.1.cmml"><mi id="ThmDef2.p1.1.1.m1.6.6.2.2.1.1.2" xref="ThmDef2.p1.1.1.m1.6.6.2.2.1.1.2.cmml">t</mi><mn mathvariant="normal" id="ThmDef2.p1.1.1.m1.6.6.2.2.1.1.3" xref="ThmDef2.p1.1.1.m1.6.6.2.2.1.1.3.cmml">2</mn></msub><mo mathvariant="normal" id="ThmDef2.p1.1.1.m1.6.6.2.2.2.5" xref="ThmDef2.p1.1.1.m1.6.6.2.2.3.cmml">,</mo><msub id="ThmDef2.p1.1.1.m1.6.6.2.2.2.2" xref="ThmDef2.p1.1.1.m1.6.6.2.2.2.2.cmml"><mi id="ThmDef2.p1.1.1.m1.6.6.2.2.2.2.2" xref="ThmDef2.p1.1.1.m1.6.6.2.2.2.2.2.cmml">p</mi><mn mathvariant="normal" id="ThmDef2.p1.1.1.m1.6.6.2.2.2.2.3" xref="ThmDef2.p1.1.1.m1.6.6.2.2.2.2.3.cmml">2</mn></msub><mo mathvariant="normal" stretchy="false" id="ThmDef2.p1.1.1.m1.6.6.2.2.2.6" xref="ThmDef2.p1.1.1.m1.6.6.2.2.3.cmml">⟩</mo></mrow><mo mathvariant="normal" id="ThmDef2.p1.1.1.m1.7.7.3.6" xref="ThmDef2.p1.1.1.m1.7.7.4.cmml">,</mo><mi mathvariant="normal" id="ThmDef2.p1.1.1.m1.4.4" xref="ThmDef2.p1.1.1.m1.4.4.cmml">…</mi><mo mathvariant="normal" id="ThmDef2.p1.1.1.m1.7.7.3.7" xref="ThmDef2.p1.1.1.m1.7.7.4.cmml">,</mo><mrow id="ThmDef2.p1.1.1.m1.7.7.3.3.2" xref="ThmDef2.p1.1.1.m1.7.7.3.3.3.cmml"><mo mathvariant="normal" stretchy="false" id="ThmDef2.p1.1.1.m1.7.7.3.3.2.3" xref="ThmDef2.p1.1.1.m1.7.7.3.3.3.cmml">⟨</mo><mi id="ThmDef2.p1.1.1.m1.3.3" xref="ThmDef2.p1.1.1.m1.3.3.cmml">u</mi><mo mathvariant="normal" id="ThmDef2.p1.1.1.m1.7.7.3.3.2.4" xref="ThmDef2.p1.1.1.m1.7.7.3.3.3.cmml">,</mo><msub id="ThmDef2.p1.1.1.m1.7.7.3.3.1.1" xref="ThmDef2.p1.1.1.m1.7.7.3.3.1.1.cmml"><mi id="ThmDef2.p1.1.1.m1.7.7.3.3.1.1.2" xref="ThmDef2.p1.1.1.m1.7.7.3.3.1.1.2.cmml">t</mi><mi id="ThmDef2.p1.1.1.m1.7.7.3.3.1.1.3" xref="ThmDef2.p1.1.1.m1.7.7.3.3.1.1.3.cmml">m</mi></msub><mo mathvariant="normal" id="ThmDef2.p1.1.1.m1.7.7.3.3.2.5" xref="ThmDef2.p1.1.1.m1.7.7.3.3.3.cmml">,</mo><msub id="ThmDef2.p1.1.1.m1.7.7.3.3.2.2" xref="ThmDef2.p1.1.1.m1.7.7.3.3.2.2.cmml"><mi id="ThmDef2.p1.1.1.m1.7.7.3.3.2.2.2" xref="ThmDef2.p1.1.1.m1.7.7.3.3.2.2.2.cmml">p</mi><mi id="ThmDef2.p1.1.1.m1.7.7.3.3.2.2.3" xref="ThmDef2.p1.1.1.m1.7.7.3.3.2.2.3.cmml">m</mi></msub><mo mathvariant="normal" stretchy="false" id="ThmDef2.p1.1.1.m1.7.7.3.3.2.6" xref="ThmDef2.p1.1.1.m1.7.7.3.3.3.cmml">⟩</mo></mrow><mo mathvariant="normal" stretchy="false" id="ThmDef2.p1.1.1.m1.7.7.3.8" xref="ThmDef2.p1.1.1.m1.7.7.4.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="ThmDef2.p1.1.1.m1.7b"><vector id="ThmDef2.p1.1.1.m1.7.7.4.cmml" xref="ThmDef2.p1.1.1.m1.7.7.3"><list id="ThmDef2.p1.1.1.m1.5.5.1.1.3.cmml" xref="ThmDef2.p1.1.1.m1.5.5.1.1.2"><ci id="ThmDef2.p1.1.1.m1.1.1.cmml" xref="ThmDef2.p1.1.1.m1.1.1">𝑢</ci><apply id="ThmDef2.p1.1.1.m1.5.5.1.1.1.1.cmml" xref="ThmDef2.p1.1.1.m1.5.5.1.1.1.1"><csymbol cd="ambiguous" id="ThmDef2.p1.1.1.m1.5.5.1.1.1.1.1.cmml" xref="ThmDef2.p1.1.1.m1.5.5.1.1.1.1">subscript</csymbol><ci id="ThmDef2.p1.1.1.m1.5.5.1.1.1.1.2.cmml" xref="ThmDef2.p1.1.1.m1.5.5.1.1.1.1.2">𝑡</ci><cn type="integer" id="ThmDef2.p1.1.1.m1.5.5.1.1.1.1.3.cmml" xref="ThmDef2.p1.1.1.m1.5.5.1.1.1.1.3">1</cn></apply><apply id="ThmDef2.p1.1.1.m1.5.5.1.1.2.2.cmml" xref="ThmDef2.p1.1.1.m1.5.5.1.1.2.2"><csymbol cd="ambiguous" id="ThmDef2.p1.1.1.m1.5.5.1.1.2.2.1.cmml" xref="ThmDef2.p1.1.1.m1.5.5.1.1.2.2">subscript</csymbol><ci id="ThmDef2.p1.1.1.m1.5.5.1.1.2.2.2.cmml" xref="ThmDef2.p1.1.1.m1.5.5.1.1.2.2.2">𝑝</ci><cn type="integer" id="ThmDef2.p1.1.1.m1.5.5.1.1.2.2.3.cmml" xref="ThmDef2.p1.1.1.m1.5.5.1.1.2.2.3">1</cn></apply></list><list id="ThmDef2.p1.1.1.m1.6.6.2.2.3.cmml" xref="ThmDef2.p1.1.1.m1.6.6.2.2.2"><ci id="ThmDef2.p1.1.1.m1.2.2.cmml" xref="ThmDef2.p1.1.1.m1.2.2">𝑢</ci><apply id="ThmDef2.p1.1.1.m1.6.6.2.2.1.1.cmml" xref="ThmDef2.p1.1.1.m1.6.6.2.2.1.1"><csymbol cd="ambiguous" id="ThmDef2.p1.1.1.m1.6.6.2.2.1.1.1.cmml" xref="ThmDef2.p1.1.1.m1.6.6.2.2.1.1">subscript</csymbol><ci id="ThmDef2.p1.1.1.m1.6.6.2.2.1.1.2.cmml" xref="ThmDef2.p1.1.1.m1.6.6.2.2.1.1.2">𝑡</ci><cn type="integer" id="ThmDef2.p1.1.1.m1.6.6.2.2.1.1.3.cmml" xref="ThmDef2.p1.1.1.m1.6.6.2.2.1.1.3">2</cn></apply><apply id="ThmDef2.p1.1.1.m1.6.6.2.2.2.2.cmml" xref="ThmDef2.p1.1.1.m1.6.6.2.2.2.2"><csymbol cd="ambiguous" id="ThmDef2.p1.1.1.m1.6.6.2.2.2.2.1.cmml" xref="ThmDef2.p1.1.1.m1.6.6.2.2.2.2">subscript</csymbol><ci id="ThmDef2.p1.1.1.m1.6.6.2.2.2.2.2.cmml" xref="ThmDef2.p1.1.1.m1.6.6.2.2.2.2.2">𝑝</ci><cn type="integer" id="ThmDef2.p1.1.1.m1.6.6.2.2.2.2.3.cmml" xref="ThmDef2.p1.1.1.m1.6.6.2.2.2.2.3">2</cn></apply></list><ci id="ThmDef2.p1.1.1.m1.4.4.cmml" xref="ThmDef2.p1.1.1.m1.4.4">normal-…</ci><list id="ThmDef2.p1.1.1.m1.7.7.3.3.3.cmml" xref="ThmDef2.p1.1.1.m1.7.7.3.3.2"><ci id="ThmDef2.p1.1.1.m1.3.3.cmml" xref="ThmDef2.p1.1.1.m1.3.3">𝑢</ci><apply id="ThmDef2.p1.1.1.m1.7.7.3.3.1.1.cmml" xref="ThmDef2.p1.1.1.m1.7.7.3.3.1.1"><csymbol cd="ambiguous" id="ThmDef2.p1.1.1.m1.7.7.3.3.1.1.1.cmml" xref="ThmDef2.p1.1.1.m1.7.7.3.3.1.1">subscript</csymbol><ci id="ThmDef2.p1.1.1.m1.7.7.3.3.1.1.2.cmml" xref="ThmDef2.p1.1.1.m1.7.7.3.3.1.1.2">𝑡</ci><ci id="ThmDef2.p1.1.1.m1.7.7.3.3.1.1.3.cmml" xref="ThmDef2.p1.1.1.m1.7.7.3.3.1.1.3">𝑚</ci></apply><apply id="ThmDef2.p1.1.1.m1.7.7.3.3.2.2.cmml" xref="ThmDef2.p1.1.1.m1.7.7.3.3.2.2"><csymbol cd="ambiguous" id="ThmDef2.p1.1.1.m1.7.7.3.3.2.2.1.cmml" xref="ThmDef2.p1.1.1.m1.7.7.3.3.2.2">subscript</csymbol><ci id="ThmDef2.p1.1.1.m1.7.7.3.3.2.2.2.cmml" xref="ThmDef2.p1.1.1.m1.7.7.3.3.2.2.2">𝑝</ci><ci id="ThmDef2.p1.1.1.m1.7.7.3.3.2.2.3.cmml" xref="ThmDef2.p1.1.1.m1.7.7.3.3.2.2.3">𝑚</ci></apply></list></vector></annotation-xml><annotation encoding="application/x-tex" id="ThmDef2.p1.1.1.m1.7c">(\langle u,t_{1},p_{1}\rangle,\langle u,t_{2},p_{2}\rangle,\dots,\langle u,t_{%
m},p_{m}\rangle)</annotation><annotation encoding="application/x-llamapun" id="ThmDef2.p1.1.1.m1.7d">( ⟨ italic_u , italic_t start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_p start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ⟩ , ⟨ italic_u , italic_t start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , italic_p start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ⟩ , … , ⟨ italic_u , italic_t start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT , italic_p start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT ⟩ )</annotation></semantics></math> generated by user <math id="ThmDef2.p1.2.2.m2.1" class="ltx_Math" alttext="u" display="inline"><semantics id="ThmDef2.p1.2.2.m2.1a"><mi id="ThmDef2.p1.2.2.m2.1.1" xref="ThmDef2.p1.2.2.m2.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="ThmDef2.p1.2.2.m2.1b"><ci id="ThmDef2.p1.2.2.m2.1.1.cmml" xref="ThmDef2.p1.2.2.m2.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="ThmDef2.p1.2.2.m2.1c">u</annotation><annotation encoding="application/x-llamapun" id="ThmDef2.p1.2.2.m2.1d">italic_u</annotation></semantics></math> in chronological order during a certain time interval <math id="ThmDef2.p1.3.3.m3.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="ThmDef2.p1.3.3.m3.1a"><mi id="ThmDef2.p1.3.3.m3.1.1" xref="ThmDef2.p1.3.3.m3.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="ThmDef2.p1.3.3.m3.1b"><ci id="ThmDef2.p1.3.3.m3.1.1.cmml" xref="ThmDef2.p1.3.3.m3.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="ThmDef2.p1.3.3.m3.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="ThmDef2.p1.3.3.m3.1d">italic_τ</annotation></semantics></math>, which is denoted by <math id="ThmDef2.p1.4.4.m4.1" class="ltx_Math" alttext="Tr_{\tau}^{u}" display="inline"><semantics id="ThmDef2.p1.4.4.m4.1a"><mrow id="ThmDef2.p1.4.4.m4.1.1" xref="ThmDef2.p1.4.4.m4.1.1.cmml"><mi id="ThmDef2.p1.4.4.m4.1.1.2" xref="ThmDef2.p1.4.4.m4.1.1.2.cmml">T</mi><mo mathvariant="italic" id="ThmDef2.p1.4.4.m4.1.1.1" xref="ThmDef2.p1.4.4.m4.1.1.1.cmml">⁢</mo><msubsup id="ThmDef2.p1.4.4.m4.1.1.3" xref="ThmDef2.p1.4.4.m4.1.1.3.cmml"><mi id="ThmDef2.p1.4.4.m4.1.1.3.2.2" xref="ThmDef2.p1.4.4.m4.1.1.3.2.2.cmml">r</mi><mi id="ThmDef2.p1.4.4.m4.1.1.3.2.3" xref="ThmDef2.p1.4.4.m4.1.1.3.2.3.cmml">τ</mi><mi id="ThmDef2.p1.4.4.m4.1.1.3.3" xref="ThmDef2.p1.4.4.m4.1.1.3.3.cmml">u</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="ThmDef2.p1.4.4.m4.1b"><apply id="ThmDef2.p1.4.4.m4.1.1.cmml" xref="ThmDef2.p1.4.4.m4.1.1"><times id="ThmDef2.p1.4.4.m4.1.1.1.cmml" xref="ThmDef2.p1.4.4.m4.1.1.1"></times><ci id="ThmDef2.p1.4.4.m4.1.1.2.cmml" xref="ThmDef2.p1.4.4.m4.1.1.2">𝑇</ci><apply id="ThmDef2.p1.4.4.m4.1.1.3.cmml" xref="ThmDef2.p1.4.4.m4.1.1.3"><csymbol cd="ambiguous" id="ThmDef2.p1.4.4.m4.1.1.3.1.cmml" xref="ThmDef2.p1.4.4.m4.1.1.3">superscript</csymbol><apply id="ThmDef2.p1.4.4.m4.1.1.3.2.cmml" xref="ThmDef2.p1.4.4.m4.1.1.3"><csymbol cd="ambiguous" id="ThmDef2.p1.4.4.m4.1.1.3.2.1.cmml" xref="ThmDef2.p1.4.4.m4.1.1.3">subscript</csymbol><ci id="ThmDef2.p1.4.4.m4.1.1.3.2.2.cmml" xref="ThmDef2.p1.4.4.m4.1.1.3.2.2">𝑟</ci><ci id="ThmDef2.p1.4.4.m4.1.1.3.2.3.cmml" xref="ThmDef2.p1.4.4.m4.1.1.3.2.3">𝜏</ci></apply><ci id="ThmDef2.p1.4.4.m4.1.1.3.3.cmml" xref="ThmDef2.p1.4.4.m4.1.1.3.3">𝑢</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="ThmDef2.p1.4.4.m4.1c">Tr_{\tau}^{u}</annotation><annotation encoding="application/x-llamapun" id="ThmDef2.p1.4.4.m4.1d">italic_T italic_r start_POSTSUBSCRIPT italic_τ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT</annotation></semantics></math>.</span></p>
</div>
</div>
<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">A trajectory is called <span id="S3.p1.1.1" class="ltx_text ltx_font_italic">unlinked</span>, if we do not know the user who generated it. The time interval <math id="S3.p1.1.m1.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="S3.p1.1.m1.1a"><mi id="S3.p1.1.m1.1.1" xref="S3.p1.1.m1.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S3.p1.1.m1.1b"><ci id="S3.p1.1.m1.1.1.cmml" xref="S3.p1.1.m1.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.1.m1.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="S3.p1.1.m1.1d">italic_τ</annotation></semantics></math> in our work is set to 24 hours.
We now state our problem as below:
</p>
</div>
<div id="ThmProx1" class="ltx_theorem ltx_theorem_Pro">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span id="ThmProx1.1.1.1" class="ltx_text ltx_font_bold">Problem</span></span><span id="ThmProx1.2.2" class="ltx_text ltx_font_bold"> </span>(Trajectory-User Linking)<span id="ThmProx1.3.3" class="ltx_text ltx_font_bold">.</span>
</h6>
<div id="ThmProx1.p1" class="ltx_para">
<p id="ThmProx1.p1.3" class="ltx_p"><span id="ThmProx1.p1.3.3" class="ltx_text ltx_font_italic">The task of TUL is to identify anonymous trajectories with the users who generate them.
Let <math id="ThmProx1.p1.1.1.m1.4" class="ltx_Math" alttext="\mathcal{T}=\{Tr_{1},Tr_{2},\dots,Tr_{n}\}" display="inline"><semantics id="ThmProx1.p1.1.1.m1.4a"><mrow id="ThmProx1.p1.1.1.m1.4.4" xref="ThmProx1.p1.1.1.m1.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="ThmProx1.p1.1.1.m1.4.4.5" xref="ThmProx1.p1.1.1.m1.4.4.5.cmml">𝒯</mi><mo mathvariant="normal" id="ThmProx1.p1.1.1.m1.4.4.4" xref="ThmProx1.p1.1.1.m1.4.4.4.cmml">=</mo><mrow id="ThmProx1.p1.1.1.m1.4.4.3.3" xref="ThmProx1.p1.1.1.m1.4.4.3.4.cmml"><mo mathvariant="normal" stretchy="false" id="ThmProx1.p1.1.1.m1.4.4.3.3.4" xref="ThmProx1.p1.1.1.m1.4.4.3.4.cmml">{</mo><mrow id="ThmProx1.p1.1.1.m1.2.2.1.1.1" xref="ThmProx1.p1.1.1.m1.2.2.1.1.1.cmml"><mi id="ThmProx1.p1.1.1.m1.2.2.1.1.1.2" xref="ThmProx1.p1.1.1.m1.2.2.1.1.1.2.cmml">T</mi><mo mathvariant="italic" id="ThmProx1.p1.1.1.m1.2.2.1.1.1.1" xref="ThmProx1.p1.1.1.m1.2.2.1.1.1.1.cmml">⁢</mo><msub id="ThmProx1.p1.1.1.m1.2.2.1.1.1.3" xref="ThmProx1.p1.1.1.m1.2.2.1.1.1.3.cmml"><mi id="ThmProx1.p1.1.1.m1.2.2.1.1.1.3.2" xref="ThmProx1.p1.1.1.m1.2.2.1.1.1.3.2.cmml">r</mi><mn mathvariant="normal" id="ThmProx1.p1.1.1.m1.2.2.1.1.1.3.3" xref="ThmProx1.p1.1.1.m1.2.2.1.1.1.3.3.cmml">1</mn></msub></mrow><mo mathvariant="normal" id="ThmProx1.p1.1.1.m1.4.4.3.3.5" xref="ThmProx1.p1.1.1.m1.4.4.3.4.cmml">,</mo><mrow id="ThmProx1.p1.1.1.m1.3.3.2.2.2" xref="ThmProx1.p1.1.1.m1.3.3.2.2.2.cmml"><mi id="ThmProx1.p1.1.1.m1.3.3.2.2.2.2" xref="ThmProx1.p1.1.1.m1.3.3.2.2.2.2.cmml">T</mi><mo mathvariant="italic" id="ThmProx1.p1.1.1.m1.3.3.2.2.2.1" xref="ThmProx1.p1.1.1.m1.3.3.2.2.2.1.cmml">⁢</mo><msub id="ThmProx1.p1.1.1.m1.3.3.2.2.2.3" xref="ThmProx1.p1.1.1.m1.3.3.2.2.2.3.cmml"><mi id="ThmProx1.p1.1.1.m1.3.3.2.2.2.3.2" xref="ThmProx1.p1.1.1.m1.3.3.2.2.2.3.2.cmml">r</mi><mn mathvariant="normal" id="ThmProx1.p1.1.1.m1.3.3.2.2.2.3.3" xref="ThmProx1.p1.1.1.m1.3.3.2.2.2.3.3.cmml">2</mn></msub></mrow><mo mathvariant="normal" id="ThmProx1.p1.1.1.m1.4.4.3.3.6" xref="ThmProx1.p1.1.1.m1.4.4.3.4.cmml">,</mo><mi mathvariant="normal" id="ThmProx1.p1.1.1.m1.1.1" xref="ThmProx1.p1.1.1.m1.1.1.cmml">…</mi><mo mathvariant="normal" id="ThmProx1.p1.1.1.m1.4.4.3.3.7" xref="ThmProx1.p1.1.1.m1.4.4.3.4.cmml">,</mo><mrow id="ThmProx1.p1.1.1.m1.4.4.3.3.3" xref="ThmProx1.p1.1.1.m1.4.4.3.3.3.cmml"><mi id="ThmProx1.p1.1.1.m1.4.4.3.3.3.2" xref="ThmProx1.p1.1.1.m1.4.4.3.3.3.2.cmml">T</mi><mo mathvariant="italic" id="ThmProx1.p1.1.1.m1.4.4.3.3.3.1" xref="ThmProx1.p1.1.1.m1.4.4.3.3.3.1.cmml">⁢</mo><msub id="ThmProx1.p1.1.1.m1.4.4.3.3.3.3" xref="ThmProx1.p1.1.1.m1.4.4.3.3.3.3.cmml"><mi id="ThmProx1.p1.1.1.m1.4.4.3.3.3.3.2" xref="ThmProx1.p1.1.1.m1.4.4.3.3.3.3.2.cmml">r</mi><mi id="ThmProx1.p1.1.1.m1.4.4.3.3.3.3.3" xref="ThmProx1.p1.1.1.m1.4.4.3.3.3.3.3.cmml">n</mi></msub></mrow><mo mathvariant="normal" stretchy="false" id="ThmProx1.p1.1.1.m1.4.4.3.3.8" xref="ThmProx1.p1.1.1.m1.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="ThmProx1.p1.1.1.m1.4b"><apply id="ThmProx1.p1.1.1.m1.4.4.cmml" xref="ThmProx1.p1.1.1.m1.4.4"><eq id="ThmProx1.p1.1.1.m1.4.4.4.cmml" xref="ThmProx1.p1.1.1.m1.4.4.4"></eq><ci id="ThmProx1.p1.1.1.m1.4.4.5.cmml" xref="ThmProx1.p1.1.1.m1.4.4.5">𝒯</ci><set id="ThmProx1.p1.1.1.m1.4.4.3.4.cmml" xref="ThmProx1.p1.1.1.m1.4.4.3.3"><apply id="ThmProx1.p1.1.1.m1.2.2.1.1.1.cmml" xref="ThmProx1.p1.1.1.m1.2.2.1.1.1"><times id="ThmProx1.p1.1.1.m1.2.2.1.1.1.1.cmml" xref="ThmProx1.p1.1.1.m1.2.2.1.1.1.1"></times><ci id="ThmProx1.p1.1.1.m1.2.2.1.1.1.2.cmml" xref="ThmProx1.p1.1.1.m1.2.2.1.1.1.2">𝑇</ci><apply id="ThmProx1.p1.1.1.m1.2.2.1.1.1.3.cmml" xref="ThmProx1.p1.1.1.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="ThmProx1.p1.1.1.m1.2.2.1.1.1.3.1.cmml" xref="ThmProx1.p1.1.1.m1.2.2.1.1.1.3">subscript</csymbol><ci id="ThmProx1.p1.1.1.m1.2.2.1.1.1.3.2.cmml" xref="ThmProx1.p1.1.1.m1.2.2.1.1.1.3.2">𝑟</ci><cn type="integer" id="ThmProx1.p1.1.1.m1.2.2.1.1.1.3.3.cmml" xref="ThmProx1.p1.1.1.m1.2.2.1.1.1.3.3">1</cn></apply></apply><apply id="ThmProx1.p1.1.1.m1.3.3.2.2.2.cmml" xref="ThmProx1.p1.1.1.m1.3.3.2.2.2"><times id="ThmProx1.p1.1.1.m1.3.3.2.2.2.1.cmml" xref="ThmProx1.p1.1.1.m1.3.3.2.2.2.1"></times><ci id="ThmProx1.p1.1.1.m1.3.3.2.2.2.2.cmml" xref="ThmProx1.p1.1.1.m1.3.3.2.2.2.2">𝑇</ci><apply id="ThmProx1.p1.1.1.m1.3.3.2.2.2.3.cmml" xref="ThmProx1.p1.1.1.m1.3.3.2.2.2.3"><csymbol cd="ambiguous" id="ThmProx1.p1.1.1.m1.3.3.2.2.2.3.1.cmml" xref="ThmProx1.p1.1.1.m1.3.3.2.2.2.3">subscript</csymbol><ci id="ThmProx1.p1.1.1.m1.3.3.2.2.2.3.2.cmml" xref="ThmProx1.p1.1.1.m1.3.3.2.2.2.3.2">𝑟</ci><cn type="integer" id="ThmProx1.p1.1.1.m1.3.3.2.2.2.3.3.cmml" xref="ThmProx1.p1.1.1.m1.3.3.2.2.2.3.3">2</cn></apply></apply><ci id="ThmProx1.p1.1.1.m1.1.1.cmml" xref="ThmProx1.p1.1.1.m1.1.1">normal-…</ci><apply id="ThmProx1.p1.1.1.m1.4.4.3.3.3.cmml" xref="ThmProx1.p1.1.1.m1.4.4.3.3.3"><times id="ThmProx1.p1.1.1.m1.4.4.3.3.3.1.cmml" xref="ThmProx1.p1.1.1.m1.4.4.3.3.3.1"></times><ci id="ThmProx1.p1.1.1.m1.4.4.3.3.3.2.cmml" xref="ThmProx1.p1.1.1.m1.4.4.3.3.3.2">𝑇</ci><apply id="ThmProx1.p1.1.1.m1.4.4.3.3.3.3.cmml" xref="ThmProx1.p1.1.1.m1.4.4.3.3.3.3"><csymbol cd="ambiguous" id="ThmProx1.p1.1.1.m1.4.4.3.3.3.3.1.cmml" xref="ThmProx1.p1.1.1.m1.4.4.3.3.3.3">subscript</csymbol><ci id="ThmProx1.p1.1.1.m1.4.4.3.3.3.3.2.cmml" xref="ThmProx1.p1.1.1.m1.4.4.3.3.3.3.2">𝑟</ci><ci id="ThmProx1.p1.1.1.m1.4.4.3.3.3.3.3.cmml" xref="ThmProx1.p1.1.1.m1.4.4.3.3.3.3.3">𝑛</ci></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="ThmProx1.p1.1.1.m1.4c">\mathcal{T}=\{Tr_{1},Tr_{2},\dots,Tr_{n}\}</annotation><annotation encoding="application/x-llamapun" id="ThmProx1.p1.1.1.m1.4d">caligraphic_T = { italic_T italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_T italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_T italic_r start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT }</annotation></semantics></math> represent the set of unlinked trajectories, and <math id="ThmProx1.p1.2.2.m2.4" class="ltx_Math" alttext="\mathcal{U}=\{u_{1},u_{2},\dots,u_{m}\}" display="inline"><semantics id="ThmProx1.p1.2.2.m2.4a"><mrow id="ThmProx1.p1.2.2.m2.4.4" xref="ThmProx1.p1.2.2.m2.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="ThmProx1.p1.2.2.m2.4.4.5" xref="ThmProx1.p1.2.2.m2.4.4.5.cmml">𝒰</mi><mo mathvariant="normal" id="ThmProx1.p1.2.2.m2.4.4.4" xref="ThmProx1.p1.2.2.m2.4.4.4.cmml">=</mo><mrow id="ThmProx1.p1.2.2.m2.4.4.3.3" xref="ThmProx1.p1.2.2.m2.4.4.3.4.cmml"><mo mathvariant="normal" stretchy="false" id="ThmProx1.p1.2.2.m2.4.4.3.3.4" xref="ThmProx1.p1.2.2.m2.4.4.3.4.cmml">{</mo><msub id="ThmProx1.p1.2.2.m2.2.2.1.1.1" xref="ThmProx1.p1.2.2.m2.2.2.1.1.1.cmml"><mi id="ThmProx1.p1.2.2.m2.2.2.1.1.1.2" xref="ThmProx1.p1.2.2.m2.2.2.1.1.1.2.cmml">u</mi><mn mathvariant="normal" id="ThmProx1.p1.2.2.m2.2.2.1.1.1.3" xref="ThmProx1.p1.2.2.m2.2.2.1.1.1.3.cmml">1</mn></msub><mo mathvariant="normal" id="ThmProx1.p1.2.2.m2.4.4.3.3.5" xref="ThmProx1.p1.2.2.m2.4.4.3.4.cmml">,</mo><msub id="ThmProx1.p1.2.2.m2.3.3.2.2.2" xref="ThmProx1.p1.2.2.m2.3.3.2.2.2.cmml"><mi id="ThmProx1.p1.2.2.m2.3.3.2.2.2.2" xref="ThmProx1.p1.2.2.m2.3.3.2.2.2.2.cmml">u</mi><mn mathvariant="normal" id="ThmProx1.p1.2.2.m2.3.3.2.2.2.3" xref="ThmProx1.p1.2.2.m2.3.3.2.2.2.3.cmml">2</mn></msub><mo mathvariant="normal" id="ThmProx1.p1.2.2.m2.4.4.3.3.6" xref="ThmProx1.p1.2.2.m2.4.4.3.4.cmml">,</mo><mi mathvariant="normal" id="ThmProx1.p1.2.2.m2.1.1" xref="ThmProx1.p1.2.2.m2.1.1.cmml">…</mi><mo mathvariant="normal" id="ThmProx1.p1.2.2.m2.4.4.3.3.7" xref="ThmProx1.p1.2.2.m2.4.4.3.4.cmml">,</mo><msub id="ThmProx1.p1.2.2.m2.4.4.3.3.3" xref="ThmProx1.p1.2.2.m2.4.4.3.3.3.cmml"><mi id="ThmProx1.p1.2.2.m2.4.4.3.3.3.2" xref="ThmProx1.p1.2.2.m2.4.4.3.3.3.2.cmml">u</mi><mi id="ThmProx1.p1.2.2.m2.4.4.3.3.3.3" xref="ThmProx1.p1.2.2.m2.4.4.3.3.3.3.cmml">m</mi></msub><mo mathvariant="normal" stretchy="false" id="ThmProx1.p1.2.2.m2.4.4.3.3.8" xref="ThmProx1.p1.2.2.m2.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="ThmProx1.p1.2.2.m2.4b"><apply id="ThmProx1.p1.2.2.m2.4.4.cmml" xref="ThmProx1.p1.2.2.m2.4.4"><eq id="ThmProx1.p1.2.2.m2.4.4.4.cmml" xref="ThmProx1.p1.2.2.m2.4.4.4"></eq><ci id="ThmProx1.p1.2.2.m2.4.4.5.cmml" xref="ThmProx1.p1.2.2.m2.4.4.5">𝒰</ci><set id="ThmProx1.p1.2.2.m2.4.4.3.4.cmml" xref="ThmProx1.p1.2.2.m2.4.4.3.3"><apply id="ThmProx1.p1.2.2.m2.2.2.1.1.1.cmml" xref="ThmProx1.p1.2.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="ThmProx1.p1.2.2.m2.2.2.1.1.1.1.cmml" xref="ThmProx1.p1.2.2.m2.2.2.1.1.1">subscript</csymbol><ci id="ThmProx1.p1.2.2.m2.2.2.1.1.1.2.cmml" xref="ThmProx1.p1.2.2.m2.2.2.1.1.1.2">𝑢</ci><cn type="integer" id="ThmProx1.p1.2.2.m2.2.2.1.1.1.3.cmml" xref="ThmProx1.p1.2.2.m2.2.2.1.1.1.3">1</cn></apply><apply id="ThmProx1.p1.2.2.m2.3.3.2.2.2.cmml" xref="ThmProx1.p1.2.2.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="ThmProx1.p1.2.2.m2.3.3.2.2.2.1.cmml" xref="ThmProx1.p1.2.2.m2.3.3.2.2.2">subscript</csymbol><ci id="ThmProx1.p1.2.2.m2.3.3.2.2.2.2.cmml" xref="ThmProx1.p1.2.2.m2.3.3.2.2.2.2">𝑢</ci><cn type="integer" id="ThmProx1.p1.2.2.m2.3.3.2.2.2.3.cmml" xref="ThmProx1.p1.2.2.m2.3.3.2.2.2.3">2</cn></apply><ci id="ThmProx1.p1.2.2.m2.1.1.cmml" xref="ThmProx1.p1.2.2.m2.1.1">normal-…</ci><apply id="ThmProx1.p1.2.2.m2.4.4.3.3.3.cmml" xref="ThmProx1.p1.2.2.m2.4.4.3.3.3"><csymbol cd="ambiguous" id="ThmProx1.p1.2.2.m2.4.4.3.3.3.1.cmml" xref="ThmProx1.p1.2.2.m2.4.4.3.3.3">subscript</csymbol><ci id="ThmProx1.p1.2.2.m2.4.4.3.3.3.2.cmml" xref="ThmProx1.p1.2.2.m2.4.4.3.3.3.2">𝑢</ci><ci id="ThmProx1.p1.2.2.m2.4.4.3.3.3.3.cmml" xref="ThmProx1.p1.2.2.m2.4.4.3.3.3.3">𝑚</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="ThmProx1.p1.2.2.m2.4c">\mathcal{U}=\{u_{1},u_{2},\dots,u_{m}\}</annotation><annotation encoding="application/x-llamapun" id="ThmProx1.p1.2.2.m2.4d">caligraphic_U = { italic_u start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_u start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_u start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT }</annotation></semantics></math> denote a set of users. Our goal is to find the mapping function <math id="ThmProx1.p1.3.3.m3.1" class="ltx_Math" alttext="f(\cdot)" display="inline"><semantics id="ThmProx1.p1.3.3.m3.1a"><mrow id="ThmProx1.p1.3.3.m3.1.2" xref="ThmProx1.p1.3.3.m3.1.2.cmml"><mi id="ThmProx1.p1.3.3.m3.1.2.2" xref="ThmProx1.p1.3.3.m3.1.2.2.cmml">f</mi><mo mathvariant="italic" id="ThmProx1.p1.3.3.m3.1.2.1" xref="ThmProx1.p1.3.3.m3.1.2.1.cmml">⁢</mo><mrow id="ThmProx1.p1.3.3.m3.1.2.3.2" xref="ThmProx1.p1.3.3.m3.1.2.cmml"><mo mathvariant="normal" stretchy="false" id="ThmProx1.p1.3.3.m3.1.2.3.2.1" xref="ThmProx1.p1.3.3.m3.1.2.cmml">(</mo><mo mathvariant="normal" id="ThmProx1.p1.3.3.m3.1.1" xref="ThmProx1.p1.3.3.m3.1.1.cmml">⋅</mo><mo mathvariant="normal" stretchy="false" id="ThmProx1.p1.3.3.m3.1.2.3.2.2" xref="ThmProx1.p1.3.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="ThmProx1.p1.3.3.m3.1b"><apply id="ThmProx1.p1.3.3.m3.1.2.cmml" xref="ThmProx1.p1.3.3.m3.1.2"><times id="ThmProx1.p1.3.3.m3.1.2.1.cmml" xref="ThmProx1.p1.3.3.m3.1.2.1"></times><ci id="ThmProx1.p1.3.3.m3.1.2.2.cmml" xref="ThmProx1.p1.3.3.m3.1.2.2">𝑓</ci><ci id="ThmProx1.p1.3.3.m3.1.1.cmml" xref="ThmProx1.p1.3.3.m3.1.1">normal-⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="ThmProx1.p1.3.3.m3.1c">f(\cdot)</annotation><annotation encoding="application/x-llamapun" id="ThmProx1.p1.3.3.m3.1d">italic_f ( ⋅ )</annotation></semantics></math> satisfying the following condition:</span></p>
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.1" class="ltx_Math" alttext="\min_{f\in\mathcal{F}}\frac{1}{n}\sum_{i=1}^{n}\left\|f(Tr_{i})-y_{i}\right\|,%
f(Tr_{i})\in\mathcal{U},y_{i}\in\mathcal{U}," display="block"><semantics id="S3.E1.m1.1a"><mrow id="S3.E1.m1.1.1.1"><mrow id="S3.E1.m1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.3.cmml"><mrow id="S3.E1.m1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.cmml"><mrow id="S3.E1.m1.1.1.1.1.1.1.2.2" xref="S3.E1.m1.1.1.1.1.1.1.2.3.cmml"><mrow id="S3.E1.m1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E1.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.cmml"><munder id="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.1.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.1.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.1.2.cmml">min</mi><mrow id="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.1.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.1.3.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.1.3.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.1.3.2.cmml">f</mi><mo id="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.1.3.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.1.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.1.3.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.1.3.3.cmml">ℱ</mi></mrow></munder><mo id="S3.E1.m1.1.1.1.1.1.1.1.1.1.3a" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.cmml">⁡</mo><mfrac id="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.2.cmml"><mn id="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.2.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">1</mn><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.2.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.2.3.cmml">n</mi></mfrac></mrow><mo id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.cmml"><munderover id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mo largeop="true" movablelimits="false" symmetric="true" id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.2.2.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.2.2.3.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.2.2.3.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.2.2.3.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">n</mi></munderover><mrow id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mo id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml">∥</mo><mrow id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">f</mi><mo id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">T</mi><mo id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><msub id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">r</mi><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo stretchy="false" id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">-</mo><msub id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">y</mi><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml">∥</mo></mrow></mrow></mrow><mo id="S3.E1.m1.1.1.1.1.1.1.2.2.3" xref="S3.E1.m1.1.1.1.1.1.1.2.3.cmml">,</mo><mrow id="S3.E1.m1.1.1.1.1.1.1.2.2.2" xref="S3.E1.m1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.2.2.2.3" xref="S3.E1.m1.1.1.1.1.1.1.2.2.2.3.cmml">f</mi><mo id="S3.E1.m1.1.1.1.1.1.1.2.2.2.2" xref="S3.E1.m1.1.1.1.1.1.1.2.2.2.2.cmml">⁢</mo><mrow id="S3.E1.m1.1.1.1.1.1.1.2.2.2.1.1" xref="S3.E1.m1.1.1.1.1.1.1.2.2.2.1.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.1.1.1.1.1.1.2.2.2.1.1.2" xref="S3.E1.m1.1.1.1.1.1.1.2.2.2.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.1.1.1.1.1.1.2.2.2.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.2.2.2.1.1.1.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.2.2.2.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.1.2.2.2.1.1.1.2.cmml">T</mi><mo id="S3.E1.m1.1.1.1.1.1.1.2.2.2.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.2.2.2.1.1.1.1.cmml">⁢</mo><msub id="S3.E1.m1.1.1.1.1.1.1.2.2.2.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.2.2.2.1.1.1.3.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.2.2.2.1.1.1.3.2" xref="S3.E1.m1.1.1.1.1.1.1.2.2.2.1.1.1.3.2.cmml">r</mi><mi id="S3.E1.m1.1.1.1.1.1.1.2.2.2.1.1.1.3.3" xref="S3.E1.m1.1.1.1.1.1.1.2.2.2.1.1.1.3.3.cmml">i</mi></msub></mrow><mo stretchy="false" id="S3.E1.m1.1.1.1.1.1.1.2.2.2.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E1.m1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.3.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.1.1.1.1.1.1.4" xref="S3.E1.m1.1.1.1.1.1.1.4.cmml">𝒰</mi></mrow><mo id="S3.E1.m1.1.1.1.1.2.3" xref="S3.E1.m1.1.1.1.1.3a.cmml">,</mo><mrow id="S3.E1.m1.1.1.1.1.2.2" xref="S3.E1.m1.1.1.1.1.2.2.cmml"><msub id="S3.E1.m1.1.1.1.1.2.2.2" xref="S3.E1.m1.1.1.1.1.2.2.2.cmml"><mi id="S3.E1.m1.1.1.1.1.2.2.2.2" xref="S3.E1.m1.1.1.1.1.2.2.2.2.cmml">y</mi><mi id="S3.E1.m1.1.1.1.1.2.2.2.3" xref="S3.E1.m1.1.1.1.1.2.2.2.3.cmml">i</mi></msub><mo id="S3.E1.m1.1.1.1.1.2.2.1" xref="S3.E1.m1.1.1.1.1.2.2.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.1.1.1.1.2.2.3" xref="S3.E1.m1.1.1.1.1.2.2.3.cmml">𝒰</mi></mrow></mrow><mo id="S3.E1.m1.1.1.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.1b"><apply id="S3.E1.m1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.3a.cmml" xref="S3.E1.m1.1.1.1.1.2.3">formulae-sequence</csymbol><apply id="S3.E1.m1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1"><in id="S3.E1.m1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3"></in><list id="S3.E1.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.2.2"><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1"><times id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2"></times><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.3"><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.1">subscript</csymbol><min id="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.1.2"></min><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.1.3"><in id="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.1.3.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.1.3.1"></in><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.1.3.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.1.3.2">𝑓</ci><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.1.3.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.1.3.3">ℱ</ci></apply></apply><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.2"><divide id="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.2"></divide><cn type="integer" id="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.2.2">1</cn><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.2.3">𝑛</ci></apply></apply><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1"><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><sum id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.2.2.2"></sum><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.2.2.3"><eq id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.2.2.3.1"></eq><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.2.2.3.2">𝑖</ci><cn type="integer" id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.2.2.3.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.2.3">𝑛</ci></apply><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2">norm</csymbol><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1"><minus id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2"></minus><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><times id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2"></times><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑓</ci><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><times id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"></times><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝑇</ci><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2">𝑟</ci><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply></apply><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2">𝑦</ci><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply></apply></apply></apply><apply id="S3.E1.m1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.2.2.2"><times id="S3.E1.m1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.2.2.2.2"></times><ci id="S3.E1.m1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.2.2.2.3">𝑓</ci><apply id="S3.E1.m1.1.1.1.1.1.1.2.2.2.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.2.2.2.1.1"><times id="S3.E1.m1.1.1.1.1.1.1.2.2.2.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.2.2.2.1.1.1.1"></times><ci id="S3.E1.m1.1.1.1.1.1.1.2.2.2.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.2.2.2.1.1.1.2">𝑇</ci><apply id="S3.E1.m1.1.1.1.1.1.1.2.2.2.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.2.2.2.1.1.1.3.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.2.2.2.1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.2.2.2.1.1.1.3.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.2.2.2.1.1.1.3.2">𝑟</ci><ci id="S3.E1.m1.1.1.1.1.1.1.2.2.2.1.1.1.3.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.2.2.2.1.1.1.3.3">𝑖</ci></apply></apply></apply></list><ci id="S3.E1.m1.1.1.1.1.1.1.4.cmml" xref="S3.E1.m1.1.1.1.1.1.1.4">𝒰</ci></apply><apply id="S3.E1.m1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.1.1.1.1.2.2"><in id="S3.E1.m1.1.1.1.1.2.2.1.cmml" xref="S3.E1.m1.1.1.1.1.2.2.1"></in><apply id="S3.E1.m1.1.1.1.1.2.2.2.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.2.2.2.1.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.2.2.2.2.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.2">𝑦</ci><ci id="S3.E1.m1.1.1.1.1.2.2.2.3.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.3">𝑖</ci></apply><ci id="S3.E1.m1.1.1.1.1.2.2.3.cmml" xref="S3.E1.m1.1.1.1.1.2.2.3">𝒰</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.1c">\min_{f\in\mathcal{F}}\frac{1}{n}\sum_{i=1}^{n}\left\|f(Tr_{i})-y_{i}\right\|,%
f(Tr_{i})\in\mathcal{U},y_{i}\in\mathcal{U},</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.1d">roman_min start_POSTSUBSCRIPT italic_f ∈ caligraphic_F end_POSTSUBSCRIPT divide start_ARG 1 end_ARG start_ARG italic_n end_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT ∥ italic_f ( italic_T italic_r start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) - italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∥ , italic_f ( italic_T italic_r start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ∈ caligraphic_U , italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ caligraphic_U ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr>
</table>
<p id="ThmProx1.p1.9" class="ltx_p"><span id="ThmProx1.p1.9.6" class="ltx_text ltx_font_italic">where <math id="ThmProx1.p1.4.1.m1.1" class="ltx_Math" alttext="y_{i}" display="inline"><semantics id="ThmProx1.p1.4.1.m1.1a"><msub id="ThmProx1.p1.4.1.m1.1.1" xref="ThmProx1.p1.4.1.m1.1.1.cmml"><mi id="ThmProx1.p1.4.1.m1.1.1.2" xref="ThmProx1.p1.4.1.m1.1.1.2.cmml">y</mi><mi id="ThmProx1.p1.4.1.m1.1.1.3" xref="ThmProx1.p1.4.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="ThmProx1.p1.4.1.m1.1b"><apply id="ThmProx1.p1.4.1.m1.1.1.cmml" xref="ThmProx1.p1.4.1.m1.1.1"><csymbol cd="ambiguous" id="ThmProx1.p1.4.1.m1.1.1.1.cmml" xref="ThmProx1.p1.4.1.m1.1.1">subscript</csymbol><ci id="ThmProx1.p1.4.1.m1.1.1.2.cmml" xref="ThmProx1.p1.4.1.m1.1.1.2">𝑦</ci><ci id="ThmProx1.p1.4.1.m1.1.1.3.cmml" xref="ThmProx1.p1.4.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="ThmProx1.p1.4.1.m1.1c">y_{i}</annotation><annotation encoding="application/x-llamapun" id="ThmProx1.p1.4.1.m1.1d">italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is the true label of trajectory <math id="ThmProx1.p1.5.2.m2.1" class="ltx_Math" alttext="Tr_{i}" display="inline"><semantics id="ThmProx1.p1.5.2.m2.1a"><mrow id="ThmProx1.p1.5.2.m2.1.1" xref="ThmProx1.p1.5.2.m2.1.1.cmml"><mi id="ThmProx1.p1.5.2.m2.1.1.2" xref="ThmProx1.p1.5.2.m2.1.1.2.cmml">T</mi><mo mathvariant="italic" id="ThmProx1.p1.5.2.m2.1.1.1" xref="ThmProx1.p1.5.2.m2.1.1.1.cmml">⁢</mo><msub id="ThmProx1.p1.5.2.m2.1.1.3" xref="ThmProx1.p1.5.2.m2.1.1.3.cmml"><mi id="ThmProx1.p1.5.2.m2.1.1.3.2" xref="ThmProx1.p1.5.2.m2.1.1.3.2.cmml">r</mi><mi id="ThmProx1.p1.5.2.m2.1.1.3.3" xref="ThmProx1.p1.5.2.m2.1.1.3.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="ThmProx1.p1.5.2.m2.1b"><apply id="ThmProx1.p1.5.2.m2.1.1.cmml" xref="ThmProx1.p1.5.2.m2.1.1"><times id="ThmProx1.p1.5.2.m2.1.1.1.cmml" xref="ThmProx1.p1.5.2.m2.1.1.1"></times><ci id="ThmProx1.p1.5.2.m2.1.1.2.cmml" xref="ThmProx1.p1.5.2.m2.1.1.2">𝑇</ci><apply id="ThmProx1.p1.5.2.m2.1.1.3.cmml" xref="ThmProx1.p1.5.2.m2.1.1.3"><csymbol cd="ambiguous" id="ThmProx1.p1.5.2.m2.1.1.3.1.cmml" xref="ThmProx1.p1.5.2.m2.1.1.3">subscript</csymbol><ci id="ThmProx1.p1.5.2.m2.1.1.3.2.cmml" xref="ThmProx1.p1.5.2.m2.1.1.3.2">𝑟</ci><ci id="ThmProx1.p1.5.2.m2.1.1.3.3.cmml" xref="ThmProx1.p1.5.2.m2.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="ThmProx1.p1.5.2.m2.1c">Tr_{i}</annotation><annotation encoding="application/x-llamapun" id="ThmProx1.p1.5.2.m2.1d">italic_T italic_r start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, <math id="ThmProx1.p1.6.3.m3.1" class="kludge_parse" alttext="\|\cdot\|" display="inline"><semantics id="ThmProx1.p1.6.3.m3.1a"><mrow id="ThmProx1.p1.6.3.m3.1b"><mo mathvariant="normal" id="ThmProx1.p1.6.3.m3.1.1">∥</mo><mo mathvariant="normal" id="ThmProx1.p1.6.3.m3.1.2">⋅</mo><mo mathvariant="normal" id="ThmProx1.p1.6.3.m3.1.3">∥</mo></mrow><annotation encoding="application/x-tex" id="ThmProx1.p1.6.3.m3.1c">\|\cdot\|</annotation><annotation encoding="application/x-llamapun" id="ThmProx1.p1.6.3.m3.1d">∥ ⋅ ∥</annotation></semantics></math> represents difference evaluation operator (e.g., if <math id="ThmProx1.p1.7.4.m4.1" class="ltx_Math" alttext="i=j" display="inline"><semantics id="ThmProx1.p1.7.4.m4.1a"><mrow id="ThmProx1.p1.7.4.m4.1.1" xref="ThmProx1.p1.7.4.m4.1.1.cmml"><mi id="ThmProx1.p1.7.4.m4.1.1.2" xref="ThmProx1.p1.7.4.m4.1.1.2.cmml">i</mi><mo mathvariant="normal" id="ThmProx1.p1.7.4.m4.1.1.1" xref="ThmProx1.p1.7.4.m4.1.1.1.cmml">=</mo><mi id="ThmProx1.p1.7.4.m4.1.1.3" xref="ThmProx1.p1.7.4.m4.1.1.3.cmml">j</mi></mrow><annotation-xml encoding="MathML-Content" id="ThmProx1.p1.7.4.m4.1b"><apply id="ThmProx1.p1.7.4.m4.1.1.cmml" xref="ThmProx1.p1.7.4.m4.1.1"><eq id="ThmProx1.p1.7.4.m4.1.1.1.cmml" xref="ThmProx1.p1.7.4.m4.1.1.1"></eq><ci id="ThmProx1.p1.7.4.m4.1.1.2.cmml" xref="ThmProx1.p1.7.4.m4.1.1.2">𝑖</ci><ci id="ThmProx1.p1.7.4.m4.1.1.3.cmml" xref="ThmProx1.p1.7.4.m4.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="ThmProx1.p1.7.4.m4.1c">i=j</annotation><annotation encoding="application/x-llamapun" id="ThmProx1.p1.7.4.m4.1d">italic_i = italic_j</annotation></semantics></math>, <math id="ThmProx1.p1.8.5.m5.1" class="ltx_Math" alttext="\|u_{i}-u_{j}\|=0" display="inline"><semantics id="ThmProx1.p1.8.5.m5.1a"><mrow id="ThmProx1.p1.8.5.m5.1.1" xref="ThmProx1.p1.8.5.m5.1.1.cmml"><mrow id="ThmProx1.p1.8.5.m5.1.1.1.1" xref="ThmProx1.p1.8.5.m5.1.1.1.2.cmml"><mo mathvariant="normal" id="ThmProx1.p1.8.5.m5.1.1.1.1.2" xref="ThmProx1.p1.8.5.m5.1.1.1.2.1.cmml">∥</mo><mrow id="ThmProx1.p1.8.5.m5.1.1.1.1.1" xref="ThmProx1.p1.8.5.m5.1.1.1.1.1.cmml"><msub id="ThmProx1.p1.8.5.m5.1.1.1.1.1.2" xref="ThmProx1.p1.8.5.m5.1.1.1.1.1.2.cmml"><mi id="ThmProx1.p1.8.5.m5.1.1.1.1.1.2.2" xref="ThmProx1.p1.8.5.m5.1.1.1.1.1.2.2.cmml">u</mi><mi id="ThmProx1.p1.8.5.m5.1.1.1.1.1.2.3" xref="ThmProx1.p1.8.5.m5.1.1.1.1.1.2.3.cmml">i</mi></msub><mo mathvariant="normal" id="ThmProx1.p1.8.5.m5.1.1.1.1.1.1" xref="ThmProx1.p1.8.5.m5.1.1.1.1.1.1.cmml">-</mo><msub id="ThmProx1.p1.8.5.m5.1.1.1.1.1.3" xref="ThmProx1.p1.8.5.m5.1.1.1.1.1.3.cmml"><mi id="ThmProx1.p1.8.5.m5.1.1.1.1.1.3.2" xref="ThmProx1.p1.8.5.m5.1.1.1.1.1.3.2.cmml">u</mi><mi id="ThmProx1.p1.8.5.m5.1.1.1.1.1.3.3" xref="ThmProx1.p1.8.5.m5.1.1.1.1.1.3.3.cmml">j</mi></msub></mrow><mo mathvariant="normal" id="ThmProx1.p1.8.5.m5.1.1.1.1.3" xref="ThmProx1.p1.8.5.m5.1.1.1.2.1.cmml">∥</mo></mrow><mo mathvariant="normal" id="ThmProx1.p1.8.5.m5.1.1.2" xref="ThmProx1.p1.8.5.m5.1.1.2.cmml">=</mo><mn mathvariant="normal" id="ThmProx1.p1.8.5.m5.1.1.3" xref="ThmProx1.p1.8.5.m5.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="ThmProx1.p1.8.5.m5.1b"><apply id="ThmProx1.p1.8.5.m5.1.1.cmml" xref="ThmProx1.p1.8.5.m5.1.1"><eq id="ThmProx1.p1.8.5.m5.1.1.2.cmml" xref="ThmProx1.p1.8.5.m5.1.1.2"></eq><apply id="ThmProx1.p1.8.5.m5.1.1.1.2.cmml" xref="ThmProx1.p1.8.5.m5.1.1.1.1"><csymbol cd="latexml" id="ThmProx1.p1.8.5.m5.1.1.1.2.1.cmml" xref="ThmProx1.p1.8.5.m5.1.1.1.1.2">norm</csymbol><apply id="ThmProx1.p1.8.5.m5.1.1.1.1.1.cmml" xref="ThmProx1.p1.8.5.m5.1.1.1.1.1"><minus id="ThmProx1.p1.8.5.m5.1.1.1.1.1.1.cmml" xref="ThmProx1.p1.8.5.m5.1.1.1.1.1.1"></minus><apply id="ThmProx1.p1.8.5.m5.1.1.1.1.1.2.cmml" xref="ThmProx1.p1.8.5.m5.1.1.1.1.1.2"><csymbol cd="ambiguous" id="ThmProx1.p1.8.5.m5.1.1.1.1.1.2.1.cmml" xref="ThmProx1.p1.8.5.m5.1.1.1.1.1.2">subscript</csymbol><ci id="ThmProx1.p1.8.5.m5.1.1.1.1.1.2.2.cmml" xref="ThmProx1.p1.8.5.m5.1.1.1.1.1.2.2">𝑢</ci><ci id="ThmProx1.p1.8.5.m5.1.1.1.1.1.2.3.cmml" xref="ThmProx1.p1.8.5.m5.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="ThmProx1.p1.8.5.m5.1.1.1.1.1.3.cmml" xref="ThmProx1.p1.8.5.m5.1.1.1.1.1.3"><csymbol cd="ambiguous" id="ThmProx1.p1.8.5.m5.1.1.1.1.1.3.1.cmml" xref="ThmProx1.p1.8.5.m5.1.1.1.1.1.3">subscript</csymbol><ci id="ThmProx1.p1.8.5.m5.1.1.1.1.1.3.2.cmml" xref="ThmProx1.p1.8.5.m5.1.1.1.1.1.3.2">𝑢</ci><ci id="ThmProx1.p1.8.5.m5.1.1.1.1.1.3.3.cmml" xref="ThmProx1.p1.8.5.m5.1.1.1.1.1.3.3">𝑗</ci></apply></apply></apply><cn type="integer" id="ThmProx1.p1.8.5.m5.1.1.3.cmml" xref="ThmProx1.p1.8.5.m5.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="ThmProx1.p1.8.5.m5.1c">\|u_{i}-u_{j}\|=0</annotation><annotation encoding="application/x-llamapun" id="ThmProx1.p1.8.5.m5.1d">∥ italic_u start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT - italic_u start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ∥ = 0</annotation></semantics></math>, otherwise 1), and <math id="ThmProx1.p1.9.6.m6.1" class="ltx_Math" alttext="\mathcal{F}" display="inline"><semantics id="ThmProx1.p1.9.6.m6.1a"><mi class="ltx_font_mathcaligraphic" id="ThmProx1.p1.9.6.m6.1.1" xref="ThmProx1.p1.9.6.m6.1.1.cmml">ℱ</mi><annotation-xml encoding="MathML-Content" id="ThmProx1.p1.9.6.m6.1b"><ci id="ThmProx1.p1.9.6.m6.1.1.cmml" xref="ThmProx1.p1.9.6.m6.1.1">ℱ</ci></annotation-xml><annotation encoding="application/x-tex" id="ThmProx1.p1.9.6.m6.1c">\mathcal{F}</annotation><annotation encoding="application/x-llamapun" id="ThmProx1.p1.9.6.m6.1d">caligraphic_F</annotation></semantics></math> is hypothesis space of TUL task.</span></p>
</div>
</div>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Methodology</h2>

<figure id="S4.F1" class="ltx_figure"><img src="/html/2205.03773/assets/x1.png" id="S4.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="838" height="248" alt="The architecture of the proposed MainTUL framework.">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>The architecture of the proposed MainTUL framework.</figcaption>
</figure>
<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">The architecture of MainTUL is presented in Figure <a href="#S4.F1" title="Figure 1 ‣ 4 Methodology ‣ Mutual Distillation Learning Network for Trajectory-User Linking" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. MainTUL contains three major components: <span id="S4.p1.1.1" class="ltx_text ltx_font_italic">check-in embedding</span>, <span id="S4.p1.1.2" class="ltx_text ltx_font_italic">trajectory encoder</span>, and <span id="S4.p1.1.3" class="ltx_text ltx_font_italic">mutual distillation network</span>.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Multi-Semantic Check-in Embedding</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.1" class="ltx_p">This module contains two sub-modules: <span id="S4.SS1.p1.1.1" class="ltx_text ltx_font_italic">trajectory augmentation</span> and <span id="S4.SS1.p1.1.2" class="ltx_text ltx_font_italic">check-in embedding layer</span>.</p>
</div>
<section id="S4.SS1.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.1 </span>Trajectory Augmentation</h4>

<div id="S4.SS1.SSS1.p1" class="ltx_para">
<p id="S4.SS1.SSS1.p1.1" class="ltx_p">For check-in data, due to its inherent sparsity, the number of user check-ins in a sub-trajectory within a time window is very limited, while its long-term historical trajectory often implies more user movement patterns. Therefore, we explore two different trajectory augmentation strategies to generate the long-term trajectories for mutual distillation learning:</p>
<ul id="S4.I1" class="ltx_itemize">
<li id="S4.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i1.p1" class="ltx_para">
<p id="S4.I1.i1.p1.4" class="ltx_p"><span id="S4.I1.i1.p1.4.1" class="ltx_text ltx_font_italic">Neighbor Augmentation:</span> Given an input trajectory <math id="S4.I1.i1.p1.1.m1.1" class="ltx_Math" alttext="Tr" display="inline"><semantics id="S4.I1.i1.p1.1.m1.1a"><mrow id="S4.I1.i1.p1.1.m1.1.1" xref="S4.I1.i1.p1.1.m1.1.1.cmml"><mi id="S4.I1.i1.p1.1.m1.1.1.2" xref="S4.I1.i1.p1.1.m1.1.1.2.cmml">T</mi><mo id="S4.I1.i1.p1.1.m1.1.1.1" xref="S4.I1.i1.p1.1.m1.1.1.1.cmml">⁢</mo><mi id="S4.I1.i1.p1.1.m1.1.1.3" xref="S4.I1.i1.p1.1.m1.1.1.3.cmml">r</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p1.1.m1.1b"><apply id="S4.I1.i1.p1.1.m1.1.1.cmml" xref="S4.I1.i1.p1.1.m1.1.1"><times id="S4.I1.i1.p1.1.m1.1.1.1.cmml" xref="S4.I1.i1.p1.1.m1.1.1.1"></times><ci id="S4.I1.i1.p1.1.m1.1.1.2.cmml" xref="S4.I1.i1.p1.1.m1.1.1.2">𝑇</ci><ci id="S4.I1.i1.p1.1.m1.1.1.3.cmml" xref="S4.I1.i1.p1.1.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p1.1.m1.1c">Tr</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i1.p1.1.m1.1d">italic_T italic_r</annotation></semantics></math> in the time interval <math id="S4.I1.i1.p1.2.m2.1" class="ltx_Math" alttext="\tau_{i}" display="inline"><semantics id="S4.I1.i1.p1.2.m2.1a"><msub id="S4.I1.i1.p1.2.m2.1.1" xref="S4.I1.i1.p1.2.m2.1.1.cmml"><mi id="S4.I1.i1.p1.2.m2.1.1.2" xref="S4.I1.i1.p1.2.m2.1.1.2.cmml">τ</mi><mi id="S4.I1.i1.p1.2.m2.1.1.3" xref="S4.I1.i1.p1.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p1.2.m2.1b"><apply id="S4.I1.i1.p1.2.m2.1.1.cmml" xref="S4.I1.i1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.I1.i1.p1.2.m2.1.1.1.cmml" xref="S4.I1.i1.p1.2.m2.1.1">subscript</csymbol><ci id="S4.I1.i1.p1.2.m2.1.1.2.cmml" xref="S4.I1.i1.p1.2.m2.1.1.2">𝜏</ci><ci id="S4.I1.i1.p1.2.m2.1.1.3.cmml" xref="S4.I1.i1.p1.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p1.2.m2.1c">\tau_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i1.p1.2.m2.1d">italic_τ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, we use <math id="S4.I1.i1.p1.3.m3.1" class="ltx_Math" alttext="k+1" display="inline"><semantics id="S4.I1.i1.p1.3.m3.1a"><mrow id="S4.I1.i1.p1.3.m3.1.1" xref="S4.I1.i1.p1.3.m3.1.1.cmml"><mi id="S4.I1.i1.p1.3.m3.1.1.2" xref="S4.I1.i1.p1.3.m3.1.1.2.cmml">k</mi><mo id="S4.I1.i1.p1.3.m3.1.1.1" xref="S4.I1.i1.p1.3.m3.1.1.1.cmml">+</mo><mn id="S4.I1.i1.p1.3.m3.1.1.3" xref="S4.I1.i1.p1.3.m3.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p1.3.m3.1b"><apply id="S4.I1.i1.p1.3.m3.1.1.cmml" xref="S4.I1.i1.p1.3.m3.1.1"><plus id="S4.I1.i1.p1.3.m3.1.1.1.cmml" xref="S4.I1.i1.p1.3.m3.1.1.1"></plus><ci id="S4.I1.i1.p1.3.m3.1.1.2.cmml" xref="S4.I1.i1.p1.3.m3.1.1.2">𝑘</ci><cn type="integer" id="S4.I1.i1.p1.3.m3.1.1.3.cmml" xref="S4.I1.i1.p1.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p1.3.m3.1c">k+1</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i1.p1.3.m3.1d">italic_k + 1</annotation></semantics></math> sub-trajectories in time interval <math id="S4.I1.i1.p1.4.m4.1" class="ltx_Math" alttext="[\tau_{i-k/2}:\tau_{i+k/2}]" display="inline"><semantics id="S4.I1.i1.p1.4.m4.1a"><mrow id="S4.I1.i1.p1.4.m4.1.1.1" xref="S4.I1.i1.p1.4.m4.1.1.2.cmml"><mo stretchy="false" id="S4.I1.i1.p1.4.m4.1.1.1.2" xref="S4.I1.i1.p1.4.m4.1.1.2.1.cmml">[</mo><mrow id="S4.I1.i1.p1.4.m4.1.1.1.1" xref="S4.I1.i1.p1.4.m4.1.1.1.1.cmml"><msub id="S4.I1.i1.p1.4.m4.1.1.1.1.2" xref="S4.I1.i1.p1.4.m4.1.1.1.1.2.cmml"><mi id="S4.I1.i1.p1.4.m4.1.1.1.1.2.2" xref="S4.I1.i1.p1.4.m4.1.1.1.1.2.2.cmml">τ</mi><mrow id="S4.I1.i1.p1.4.m4.1.1.1.1.2.3" xref="S4.I1.i1.p1.4.m4.1.1.1.1.2.3.cmml"><mi id="S4.I1.i1.p1.4.m4.1.1.1.1.2.3.2" xref="S4.I1.i1.p1.4.m4.1.1.1.1.2.3.2.cmml">i</mi><mo id="S4.I1.i1.p1.4.m4.1.1.1.1.2.3.1" xref="S4.I1.i1.p1.4.m4.1.1.1.1.2.3.1.cmml">-</mo><mrow id="S4.I1.i1.p1.4.m4.1.1.1.1.2.3.3" xref="S4.I1.i1.p1.4.m4.1.1.1.1.2.3.3.cmml"><mi id="S4.I1.i1.p1.4.m4.1.1.1.1.2.3.3.2" xref="S4.I1.i1.p1.4.m4.1.1.1.1.2.3.3.2.cmml">k</mi><mo id="S4.I1.i1.p1.4.m4.1.1.1.1.2.3.3.1" xref="S4.I1.i1.p1.4.m4.1.1.1.1.2.3.3.1.cmml">/</mo><mn id="S4.I1.i1.p1.4.m4.1.1.1.1.2.3.3.3" xref="S4.I1.i1.p1.4.m4.1.1.1.1.2.3.3.3.cmml">2</mn></mrow></mrow></msub><mo id="S4.I1.i1.p1.4.m4.1.1.1.1.1" xref="S4.I1.i1.p1.4.m4.1.1.1.1.1.cmml">:</mo><msub id="S4.I1.i1.p1.4.m4.1.1.1.1.3" xref="S4.I1.i1.p1.4.m4.1.1.1.1.3.cmml"><mi id="S4.I1.i1.p1.4.m4.1.1.1.1.3.2" xref="S4.I1.i1.p1.4.m4.1.1.1.1.3.2.cmml">τ</mi><mrow id="S4.I1.i1.p1.4.m4.1.1.1.1.3.3" xref="S4.I1.i1.p1.4.m4.1.1.1.1.3.3.cmml"><mi id="S4.I1.i1.p1.4.m4.1.1.1.1.3.3.2" xref="S4.I1.i1.p1.4.m4.1.1.1.1.3.3.2.cmml">i</mi><mo id="S4.I1.i1.p1.4.m4.1.1.1.1.3.3.1" xref="S4.I1.i1.p1.4.m4.1.1.1.1.3.3.1.cmml">+</mo><mrow id="S4.I1.i1.p1.4.m4.1.1.1.1.3.3.3" xref="S4.I1.i1.p1.4.m4.1.1.1.1.3.3.3.cmml"><mi id="S4.I1.i1.p1.4.m4.1.1.1.1.3.3.3.2" xref="S4.I1.i1.p1.4.m4.1.1.1.1.3.3.3.2.cmml">k</mi><mo id="S4.I1.i1.p1.4.m4.1.1.1.1.3.3.3.1" xref="S4.I1.i1.p1.4.m4.1.1.1.1.3.3.3.1.cmml">/</mo><mn id="S4.I1.i1.p1.4.m4.1.1.1.1.3.3.3.3" xref="S4.I1.i1.p1.4.m4.1.1.1.1.3.3.3.3.cmml">2</mn></mrow></mrow></msub></mrow><mo stretchy="false" id="S4.I1.i1.p1.4.m4.1.1.1.3" xref="S4.I1.i1.p1.4.m4.1.1.2.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p1.4.m4.1b"><apply id="S4.I1.i1.p1.4.m4.1.1.2.cmml" xref="S4.I1.i1.p1.4.m4.1.1.1"><csymbol cd="latexml" id="S4.I1.i1.p1.4.m4.1.1.2.1.cmml" xref="S4.I1.i1.p1.4.m4.1.1.1.2">delimited-[]</csymbol><apply id="S4.I1.i1.p1.4.m4.1.1.1.1.cmml" xref="S4.I1.i1.p1.4.m4.1.1.1.1"><ci id="S4.I1.i1.p1.4.m4.1.1.1.1.1.cmml" xref="S4.I1.i1.p1.4.m4.1.1.1.1.1">:</ci><apply id="S4.I1.i1.p1.4.m4.1.1.1.1.2.cmml" xref="S4.I1.i1.p1.4.m4.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.I1.i1.p1.4.m4.1.1.1.1.2.1.cmml" xref="S4.I1.i1.p1.4.m4.1.1.1.1.2">subscript</csymbol><ci id="S4.I1.i1.p1.4.m4.1.1.1.1.2.2.cmml" xref="S4.I1.i1.p1.4.m4.1.1.1.1.2.2">𝜏</ci><apply id="S4.I1.i1.p1.4.m4.1.1.1.1.2.3.cmml" xref="S4.I1.i1.p1.4.m4.1.1.1.1.2.3"><minus id="S4.I1.i1.p1.4.m4.1.1.1.1.2.3.1.cmml" xref="S4.I1.i1.p1.4.m4.1.1.1.1.2.3.1"></minus><ci id="S4.I1.i1.p1.4.m4.1.1.1.1.2.3.2.cmml" xref="S4.I1.i1.p1.4.m4.1.1.1.1.2.3.2">𝑖</ci><apply id="S4.I1.i1.p1.4.m4.1.1.1.1.2.3.3.cmml" xref="S4.I1.i1.p1.4.m4.1.1.1.1.2.3.3"><divide id="S4.I1.i1.p1.4.m4.1.1.1.1.2.3.3.1.cmml" xref="S4.I1.i1.p1.4.m4.1.1.1.1.2.3.3.1"></divide><ci id="S4.I1.i1.p1.4.m4.1.1.1.1.2.3.3.2.cmml" xref="S4.I1.i1.p1.4.m4.1.1.1.1.2.3.3.2">𝑘</ci><cn type="integer" id="S4.I1.i1.p1.4.m4.1.1.1.1.2.3.3.3.cmml" xref="S4.I1.i1.p1.4.m4.1.1.1.1.2.3.3.3">2</cn></apply></apply></apply><apply id="S4.I1.i1.p1.4.m4.1.1.1.1.3.cmml" xref="S4.I1.i1.p1.4.m4.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.I1.i1.p1.4.m4.1.1.1.1.3.1.cmml" xref="S4.I1.i1.p1.4.m4.1.1.1.1.3">subscript</csymbol><ci id="S4.I1.i1.p1.4.m4.1.1.1.1.3.2.cmml" xref="S4.I1.i1.p1.4.m4.1.1.1.1.3.2">𝜏</ci><apply id="S4.I1.i1.p1.4.m4.1.1.1.1.3.3.cmml" xref="S4.I1.i1.p1.4.m4.1.1.1.1.3.3"><plus id="S4.I1.i1.p1.4.m4.1.1.1.1.3.3.1.cmml" xref="S4.I1.i1.p1.4.m4.1.1.1.1.3.3.1"></plus><ci id="S4.I1.i1.p1.4.m4.1.1.1.1.3.3.2.cmml" xref="S4.I1.i1.p1.4.m4.1.1.1.1.3.3.2">𝑖</ci><apply id="S4.I1.i1.p1.4.m4.1.1.1.1.3.3.3.cmml" xref="S4.I1.i1.p1.4.m4.1.1.1.1.3.3.3"><divide id="S4.I1.i1.p1.4.m4.1.1.1.1.3.3.3.1.cmml" xref="S4.I1.i1.p1.4.m4.1.1.1.1.3.3.3.1"></divide><ci id="S4.I1.i1.p1.4.m4.1.1.1.1.3.3.3.2.cmml" xref="S4.I1.i1.p1.4.m4.1.1.1.1.3.3.3.2">𝑘</ci><cn type="integer" id="S4.I1.i1.p1.4.m4.1.1.1.1.3.3.3.3.cmml" xref="S4.I1.i1.p1.4.m4.1.1.1.1.3.3.3.3">2</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p1.4.m4.1c">[\tau_{i-k/2}:\tau_{i+k/2}]</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i1.p1.4.m4.1d">[ italic_τ start_POSTSUBSCRIPT italic_i - italic_k / 2 end_POSTSUBSCRIPT : italic_τ start_POSTSUBSCRIPT italic_i + italic_k / 2 end_POSTSUBSCRIPT ]</annotation></semantics></math> to form a long-term augmented trajectory in chronological order.</p>
</div>
</li>
<li id="S4.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i2.p1" class="ltx_para">
<p id="S4.I1.i2.p1.1" class="ltx_p"><span id="S4.I1.i2.p1.1.1" class="ltx_text ltx_font_italic">Random Augmentation:</span> For the input trajectory, we randomly sample <math id="S4.I1.i2.p1.1.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.I1.i2.p1.1.m1.1a"><mi id="S4.I1.i2.p1.1.m1.1.1" xref="S4.I1.i2.p1.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.1.m1.1b"><ci id="S4.I1.i2.p1.1.m1.1.1.cmml" xref="S4.I1.i2.p1.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i2.p1.1.m1.1d">italic_k</annotation></semantics></math> sub-trajectories from all trajectories of the corresponding user, and then form a long-term trajectory together with the input trajectory according to the time information. </p>
</div>
</li>
</ul>
</div>
</section>
<section id="S4.SS1.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.2 </span>Check-in Embedding Layer</h4>

<div id="S4.SS1.SSS2.p1" class="ltx_para">
<p id="S4.SS1.SSS2.p1.11" class="ltx_p">The goal of multi-semantic check-in embedding is to generate dense representations for each part in a check-in (such as location, category, and time slice) from sparse one-hot representations. In this way, we not only avoid the curse of dimensionality, but also capture contextual semantic information.
For each trajectory, we actually have two sequence forms, one is a sequence of POIs, and the other is a sequence of POI categories.
We divide a periodic time interval (<span id="S4.SS1.SSS2.p1.11.1" class="ltx_text ltx_font_italic">e</span>.<span id="S4.SS1.SSS2.p1.11.2" class="ltx_text ltx_font_italic">g</span>., one day) into multiple time slices (<span id="S4.SS1.SSS2.p1.11.3" class="ltx_text ltx_font_italic">e</span>.<span id="S4.SS1.SSS2.p1.11.4" class="ltx_text ltx_font_italic">g</span>., one hour for one time slice) and map check-in timestamps into corresponding time slices. Finally, we separately learn the embeddings for two sequences integrating with time slices as follows:</p>
<table id="S4.E2" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E2.m1.59" class="ltx_Math" alttext="\begin{split}x_{i}^{p}=tanh([\mathbf{W}_{p}p_{i}+b_{p};\mathbf{W}_{t}t_{i}+b_{%
t}]),\\
x_{i}^{c}=tanh([\mathbf{W}_{c}c_{i}+b_{c};\mathbf{W}_{t}t_{i}+b_{t}]),\end{split}" display="block"><semantics id="S4.E2.m1.59a"><mtable displaystyle="true" rowspacing="0pt" id="S4.E2.m1.59.59.3"><mtr id="S4.E2.m1.59.59.3a"><mtd columnalign="right" id="S4.E2.m1.59.59.3b"><mrow id="S4.E2.m1.58.58.2.57.29.29.29"><mrow id="S4.E2.m1.58.58.2.57.29.29.29.1"><msubsup id="S4.E2.m1.58.58.2.57.29.29.29.1.2"><mi id="S4.E2.m1.1.1.1.1.1.1" xref="S4.E2.m1.1.1.1.1.1.1.cmml">x</mi><mi id="S4.E2.m1.2.2.2.2.2.2.1" xref="S4.E2.m1.2.2.2.2.2.2.1.cmml">i</mi><mi id="S4.E2.m1.3.3.3.3.3.3.1" xref="S4.E2.m1.3.3.3.3.3.3.1.cmml">p</mi></msubsup><mo id="S4.E2.m1.4.4.4.4.4.4" xref="S4.E2.m1.4.4.4.4.4.4.cmml">=</mo><mrow id="S4.E2.m1.58.58.2.57.29.29.29.1.1"><mi id="S4.E2.m1.5.5.5.5.5.5" xref="S4.E2.m1.5.5.5.5.5.5.cmml">t</mi><mo id="S4.E2.m1.58.58.2.57.29.29.29.1.1.2">⁢</mo><mi id="S4.E2.m1.6.6.6.6.6.6" xref="S4.E2.m1.6.6.6.6.6.6.cmml">a</mi><mo id="S4.E2.m1.58.58.2.57.29.29.29.1.1.2a">⁢</mo><mi id="S4.E2.m1.7.7.7.7.7.7" xref="S4.E2.m1.7.7.7.7.7.7.cmml">n</mi><mo id="S4.E2.m1.58.58.2.57.29.29.29.1.1.2b">⁢</mo><mi id="S4.E2.m1.8.8.8.8.8.8" xref="S4.E2.m1.8.8.8.8.8.8.cmml">h</mi><mo id="S4.E2.m1.58.58.2.57.29.29.29.1.1.2c">⁢</mo><mrow id="S4.E2.m1.58.58.2.57.29.29.29.1.1.1.1"><mo stretchy="false" id="S4.E2.m1.9.9.9.9.9.9">(</mo><mrow id="S4.E2.m1.58.58.2.57.29.29.29.1.1.1.1.1"><mo stretchy="false" id="S4.E2.m1.10.10.10.10.10.10">[</mo><mrow id="S4.E2.m1.58.58.2.57.29.29.29.1.1.1.1.1.1.1"><mrow id="S4.E2.m1.58.58.2.57.29.29.29.1.1.1.1.1.1.1.1"><msub id="S4.E2.m1.58.58.2.57.29.29.29.1.1.1.1.1.1.1.1.2"><mi id="S4.E2.m1.11.11.11.11.11.11" xref="S4.E2.m1.11.11.11.11.11.11.cmml">𝐖</mi><mi id="S4.E2.m1.12.12.12.12.12.12.1" xref="S4.E2.m1.12.12.12.12.12.12.1.cmml">p</mi></msub><mo id="S4.E2.m1.58.58.2.57.29.29.29.1.1.1.1.1.1.1.1.1">⁢</mo><msub id="S4.E2.m1.58.58.2.57.29.29.29.1.1.1.1.1.1.1.1.3"><mi id="S4.E2.m1.13.13.13.13.13.13" xref="S4.E2.m1.13.13.13.13.13.13.cmml">p</mi><mi id="S4.E2.m1.14.14.14.14.14.14.1" xref="S4.E2.m1.14.14.14.14.14.14.1.cmml">i</mi></msub></mrow><mo id="S4.E2.m1.15.15.15.15.15.15" xref="S4.E2.m1.15.15.15.15.15.15.cmml">+</mo><msub id="S4.E2.m1.58.58.2.57.29.29.29.1.1.1.1.1.1.1.2"><mi id="S4.E2.m1.16.16.16.16.16.16" xref="S4.E2.m1.16.16.16.16.16.16.cmml">b</mi><mi id="S4.E2.m1.17.17.17.17.17.17.1" xref="S4.E2.m1.17.17.17.17.17.17.1.cmml">p</mi></msub></mrow><mo id="S4.E2.m1.18.18.18.18.18.18">;</mo><mrow id="S4.E2.m1.58.58.2.57.29.29.29.1.1.1.1.1.2.2"><mrow id="S4.E2.m1.58.58.2.57.29.29.29.1.1.1.1.1.2.2.1"><msub id="S4.E2.m1.58.58.2.57.29.29.29.1.1.1.1.1.2.2.1.2"><mi id="S4.E2.m1.19.19.19.19.19.19" xref="S4.E2.m1.19.19.19.19.19.19.cmml">𝐖</mi><mi id="S4.E2.m1.20.20.20.20.20.20.1" xref="S4.E2.m1.20.20.20.20.20.20.1.cmml">t</mi></msub><mo id="S4.E2.m1.58.58.2.57.29.29.29.1.1.1.1.1.2.2.1.1">⁢</mo><msub id="S4.E2.m1.58.58.2.57.29.29.29.1.1.1.1.1.2.2.1.3"><mi id="S4.E2.m1.21.21.21.21.21.21" xref="S4.E2.m1.21.21.21.21.21.21.cmml">t</mi><mi id="S4.E2.m1.22.22.22.22.22.22.1" xref="S4.E2.m1.22.22.22.22.22.22.1.cmml">i</mi></msub></mrow><mo id="S4.E2.m1.23.23.23.23.23.23" xref="S4.E2.m1.23.23.23.23.23.23.cmml">+</mo><msub id="S4.E2.m1.58.58.2.57.29.29.29.1.1.1.1.1.2.2.2"><mi id="S4.E2.m1.24.24.24.24.24.24" xref="S4.E2.m1.24.24.24.24.24.24.cmml">b</mi><mi id="S4.E2.m1.25.25.25.25.25.25.1" xref="S4.E2.m1.25.25.25.25.25.25.1.cmml">t</mi></msub></mrow><mo stretchy="false" id="S4.E2.m1.26.26.26.26.26.26">]</mo></mrow><mo stretchy="false" id="S4.E2.m1.27.27.27.27.27.27">)</mo></mrow></mrow></mrow><mo id="S4.E2.m1.28.28.28.28.28.28">,</mo></mrow></mtd></mtr><mtr id="S4.E2.m1.59.59.3c"><mtd columnalign="right" id="S4.E2.m1.59.59.3d"><mrow id="S4.E2.m1.59.59.3.58.29.29.29"><mrow id="S4.E2.m1.59.59.3.58.29.29.29.1"><msubsup id="S4.E2.m1.59.59.3.58.29.29.29.1.2"><mi id="S4.E2.m1.29.29.29.1.1.1" xref="S4.E2.m1.29.29.29.1.1.1.cmml">x</mi><mi id="S4.E2.m1.30.30.30.2.2.2.1" xref="S4.E2.m1.30.30.30.2.2.2.1.cmml">i</mi><mi id="S4.E2.m1.31.31.31.3.3.3.1" xref="S4.E2.m1.31.31.31.3.3.3.1.cmml">c</mi></msubsup><mo id="S4.E2.m1.32.32.32.4.4.4" xref="S4.E2.m1.32.32.32.4.4.4.cmml">=</mo><mrow id="S4.E2.m1.59.59.3.58.29.29.29.1.1"><mi id="S4.E2.m1.33.33.33.5.5.5" xref="S4.E2.m1.33.33.33.5.5.5.cmml">t</mi><mo id="S4.E2.m1.59.59.3.58.29.29.29.1.1.2">⁢</mo><mi id="S4.E2.m1.34.34.34.6.6.6" xref="S4.E2.m1.34.34.34.6.6.6.cmml">a</mi><mo id="S4.E2.m1.59.59.3.58.29.29.29.1.1.2a">⁢</mo><mi id="S4.E2.m1.35.35.35.7.7.7" xref="S4.E2.m1.35.35.35.7.7.7.cmml">n</mi><mo id="S4.E2.m1.59.59.3.58.29.29.29.1.1.2b">⁢</mo><mi id="S4.E2.m1.36.36.36.8.8.8" xref="S4.E2.m1.36.36.36.8.8.8.cmml">h</mi><mo id="S4.E2.m1.59.59.3.58.29.29.29.1.1.2c">⁢</mo><mrow id="S4.E2.m1.59.59.3.58.29.29.29.1.1.1.1"><mo stretchy="false" id="S4.E2.m1.37.37.37.9.9.9">(</mo><mrow id="S4.E2.m1.59.59.3.58.29.29.29.1.1.1.1.1"><mo stretchy="false" id="S4.E2.m1.38.38.38.10.10.10">[</mo><mrow id="S4.E2.m1.59.59.3.58.29.29.29.1.1.1.1.1.1.1"><mrow id="S4.E2.m1.59.59.3.58.29.29.29.1.1.1.1.1.1.1.1"><msub id="S4.E2.m1.59.59.3.58.29.29.29.1.1.1.1.1.1.1.1.2"><mi id="S4.E2.m1.39.39.39.11.11.11" xref="S4.E2.m1.39.39.39.11.11.11.cmml">𝐖</mi><mi id="S4.E2.m1.40.40.40.12.12.12.1" xref="S4.E2.m1.40.40.40.12.12.12.1.cmml">c</mi></msub><mo id="S4.E2.m1.59.59.3.58.29.29.29.1.1.1.1.1.1.1.1.1">⁢</mo><msub id="S4.E2.m1.59.59.3.58.29.29.29.1.1.1.1.1.1.1.1.3"><mi id="S4.E2.m1.41.41.41.13.13.13" xref="S4.E2.m1.41.41.41.13.13.13.cmml">c</mi><mi id="S4.E2.m1.42.42.42.14.14.14.1" xref="S4.E2.m1.42.42.42.14.14.14.1.cmml">i</mi></msub></mrow><mo id="S4.E2.m1.43.43.43.15.15.15" xref="S4.E2.m1.43.43.43.15.15.15.cmml">+</mo><msub id="S4.E2.m1.59.59.3.58.29.29.29.1.1.1.1.1.1.1.2"><mi id="S4.E2.m1.44.44.44.16.16.16" xref="S4.E2.m1.44.44.44.16.16.16.cmml">b</mi><mi id="S4.E2.m1.45.45.45.17.17.17.1" xref="S4.E2.m1.45.45.45.17.17.17.1.cmml">c</mi></msub></mrow><mo id="S4.E2.m1.46.46.46.18.18.18">;</mo><mrow id="S4.E2.m1.59.59.3.58.29.29.29.1.1.1.1.1.2.2"><mrow id="S4.E2.m1.59.59.3.58.29.29.29.1.1.1.1.1.2.2.1"><msub id="S4.E2.m1.59.59.3.58.29.29.29.1.1.1.1.1.2.2.1.2"><mi id="S4.E2.m1.47.47.47.19.19.19" xref="S4.E2.m1.47.47.47.19.19.19.cmml">𝐖</mi><mi id="S4.E2.m1.48.48.48.20.20.20.1" xref="S4.E2.m1.48.48.48.20.20.20.1.cmml">t</mi></msub><mo id="S4.E2.m1.59.59.3.58.29.29.29.1.1.1.1.1.2.2.1.1">⁢</mo><msub id="S4.E2.m1.59.59.3.58.29.29.29.1.1.1.1.1.2.2.1.3"><mi id="S4.E2.m1.49.49.49.21.21.21" xref="S4.E2.m1.49.49.49.21.21.21.cmml">t</mi><mi id="S4.E2.m1.50.50.50.22.22.22.1" xref="S4.E2.m1.50.50.50.22.22.22.1.cmml">i</mi></msub></mrow><mo id="S4.E2.m1.51.51.51.23.23.23" xref="S4.E2.m1.51.51.51.23.23.23.cmml">+</mo><msub id="S4.E2.m1.59.59.3.58.29.29.29.1.1.1.1.1.2.2.2"><mi id="S4.E2.m1.52.52.52.24.24.24" xref="S4.E2.m1.52.52.52.24.24.24.cmml">b</mi><mi id="S4.E2.m1.53.53.53.25.25.25.1" xref="S4.E2.m1.53.53.53.25.25.25.1.cmml">t</mi></msub></mrow><mo stretchy="false" id="S4.E2.m1.54.54.54.26.26.26">]</mo></mrow><mo stretchy="false" id="S4.E2.m1.55.55.55.27.27.27">)</mo></mrow></mrow></mrow><mo id="S4.E2.m1.56.56.56.28.28.28">,</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S4.E2.m1.59b"><apply id="S4.E2.m1.57.57.1.1.1.3.cmml"><csymbol cd="ambiguous" id="S4.E2.m1.57.57.1.1.1.3a.cmml">formulae-sequence</csymbol><apply id="S4.E2.m1.57.57.1.1.1.1.1.cmml"><eq id="S4.E2.m1.4.4.4.4.4.4.cmml" xref="S4.E2.m1.4.4.4.4.4.4"></eq><apply id="S4.E2.m1.57.57.1.1.1.1.1.3.cmml"><csymbol cd="ambiguous" id="S4.E2.m1.57.57.1.1.1.1.1.3.1.cmml">superscript</csymbol><apply id="S4.E2.m1.57.57.1.1.1.1.1.3.2.cmml"><csymbol cd="ambiguous" id="S4.E2.m1.57.57.1.1.1.1.1.3.2.1.cmml">subscript</csymbol><ci id="S4.E2.m1.1.1.1.1.1.1.cmml" xref="S4.E2.m1.1.1.1.1.1.1">𝑥</ci><ci id="S4.E2.m1.2.2.2.2.2.2.1.cmml" xref="S4.E2.m1.2.2.2.2.2.2.1">𝑖</ci></apply><ci id="S4.E2.m1.3.3.3.3.3.3.1.cmml" xref="S4.E2.m1.3.3.3.3.3.3.1">𝑝</ci></apply><apply id="S4.E2.m1.57.57.1.1.1.1.1.1.cmml"><times id="S4.E2.m1.57.57.1.1.1.1.1.1.2.cmml"></times><ci id="S4.E2.m1.5.5.5.5.5.5.cmml" xref="S4.E2.m1.5.5.5.5.5.5">𝑡</ci><ci id="S4.E2.m1.6.6.6.6.6.6.cmml" xref="S4.E2.m1.6.6.6.6.6.6">𝑎</ci><ci id="S4.E2.m1.7.7.7.7.7.7.cmml" xref="S4.E2.m1.7.7.7.7.7.7">𝑛</ci><ci id="S4.E2.m1.8.8.8.8.8.8.cmml" xref="S4.E2.m1.8.8.8.8.8.8">ℎ</ci><list id="S4.E2.m1.57.57.1.1.1.1.1.1.1.1.1.3.cmml"><apply id="S4.E2.m1.57.57.1.1.1.1.1.1.1.1.1.1.1.cmml"><plus id="S4.E2.m1.15.15.15.15.15.15.cmml" xref="S4.E2.m1.15.15.15.15.15.15"></plus><apply id="S4.E2.m1.57.57.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><times id="S4.E2.m1.57.57.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml"></times><apply id="S4.E2.m1.57.57.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml"><csymbol cd="ambiguous" id="S4.E2.m1.57.57.1.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml">subscript</csymbol><ci id="S4.E2.m1.11.11.11.11.11.11.cmml" xref="S4.E2.m1.11.11.11.11.11.11">𝐖</ci><ci id="S4.E2.m1.12.12.12.12.12.12.1.cmml" xref="S4.E2.m1.12.12.12.12.12.12.1">𝑝</ci></apply><apply id="S4.E2.m1.57.57.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml"><csymbol cd="ambiguous" id="S4.E2.m1.57.57.1.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml">subscript</csymbol><ci id="S4.E2.m1.13.13.13.13.13.13.cmml" xref="S4.E2.m1.13.13.13.13.13.13">𝑝</ci><ci id="S4.E2.m1.14.14.14.14.14.14.1.cmml" xref="S4.E2.m1.14.14.14.14.14.14.1">𝑖</ci></apply></apply><apply id="S4.E2.m1.57.57.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><csymbol cd="ambiguous" id="S4.E2.m1.57.57.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">subscript</csymbol><ci id="S4.E2.m1.16.16.16.16.16.16.cmml" xref="S4.E2.m1.16.16.16.16.16.16">𝑏</ci><ci id="S4.E2.m1.17.17.17.17.17.17.1.cmml" xref="S4.E2.m1.17.17.17.17.17.17.1">𝑝</ci></apply></apply><apply id="S4.E2.m1.57.57.1.1.1.1.1.1.1.1.1.2.2.cmml"><plus id="S4.E2.m1.23.23.23.23.23.23.cmml" xref="S4.E2.m1.23.23.23.23.23.23"></plus><apply id="S4.E2.m1.57.57.1.1.1.1.1.1.1.1.1.2.2.2.cmml"><times id="S4.E2.m1.57.57.1.1.1.1.1.1.1.1.1.2.2.2.1.cmml"></times><apply id="S4.E2.m1.57.57.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml"><csymbol cd="ambiguous" id="S4.E2.m1.57.57.1.1.1.1.1.1.1.1.1.2.2.2.2.1.cmml">subscript</csymbol><ci id="S4.E2.m1.19.19.19.19.19.19.cmml" xref="S4.E2.m1.19.19.19.19.19.19">𝐖</ci><ci id="S4.E2.m1.20.20.20.20.20.20.1.cmml" xref="S4.E2.m1.20.20.20.20.20.20.1">𝑡</ci></apply><apply id="S4.E2.m1.57.57.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml"><csymbol cd="ambiguous" id="S4.E2.m1.57.57.1.1.1.1.1.1.1.1.1.2.2.2.3.1.cmml">subscript</csymbol><ci id="S4.E2.m1.21.21.21.21.21.21.cmml" xref="S4.E2.m1.21.21.21.21.21.21">𝑡</ci><ci id="S4.E2.m1.22.22.22.22.22.22.1.cmml" xref="S4.E2.m1.22.22.22.22.22.22.1">𝑖</ci></apply></apply><apply id="S4.E2.m1.57.57.1.1.1.1.1.1.1.1.1.2.2.3.cmml"><csymbol cd="ambiguous" id="S4.E2.m1.57.57.1.1.1.1.1.1.1.1.1.2.2.3.1.cmml">subscript</csymbol><ci id="S4.E2.m1.24.24.24.24.24.24.cmml" xref="S4.E2.m1.24.24.24.24.24.24">𝑏</ci><ci id="S4.E2.m1.25.25.25.25.25.25.1.cmml" xref="S4.E2.m1.25.25.25.25.25.25.1">𝑡</ci></apply></apply></list></apply></apply><apply id="S4.E2.m1.57.57.1.1.1.2.2.cmml"><eq id="S4.E2.m1.32.32.32.4.4.4.cmml" xref="S4.E2.m1.32.32.32.4.4.4"></eq><apply id="S4.E2.m1.57.57.1.1.1.2.2.3.cmml"><csymbol cd="ambiguous" id="S4.E2.m1.57.57.1.1.1.2.2.3.1.cmml">superscript</csymbol><apply id="S4.E2.m1.57.57.1.1.1.2.2.3.2.cmml"><csymbol cd="ambiguous" id="S4.E2.m1.57.57.1.1.1.2.2.3.2.1.cmml">subscript</csymbol><ci id="S4.E2.m1.29.29.29.1.1.1.cmml" xref="S4.E2.m1.29.29.29.1.1.1">𝑥</ci><ci id="S4.E2.m1.30.30.30.2.2.2.1.cmml" xref="S4.E2.m1.30.30.30.2.2.2.1">𝑖</ci></apply><ci id="S4.E2.m1.31.31.31.3.3.3.1.cmml" xref="S4.E2.m1.31.31.31.3.3.3.1">𝑐</ci></apply><apply id="S4.E2.m1.57.57.1.1.1.2.2.1.cmml"><times id="S4.E2.m1.57.57.1.1.1.2.2.1.2.cmml"></times><ci id="S4.E2.m1.33.33.33.5.5.5.cmml" xref="S4.E2.m1.33.33.33.5.5.5">𝑡</ci><ci id="S4.E2.m1.34.34.34.6.6.6.cmml" xref="S4.E2.m1.34.34.34.6.6.6">𝑎</ci><ci id="S4.E2.m1.35.35.35.7.7.7.cmml" xref="S4.E2.m1.35.35.35.7.7.7">𝑛</ci><ci id="S4.E2.m1.36.36.36.8.8.8.cmml" xref="S4.E2.m1.36.36.36.8.8.8">ℎ</ci><list id="S4.E2.m1.57.57.1.1.1.2.2.1.1.1.1.3.cmml"><apply id="S4.E2.m1.57.57.1.1.1.2.2.1.1.1.1.1.1.cmml"><plus id="S4.E2.m1.43.43.43.15.15.15.cmml" xref="S4.E2.m1.43.43.43.15.15.15"></plus><apply id="S4.E2.m1.57.57.1.1.1.2.2.1.1.1.1.1.1.2.cmml"><times id="S4.E2.m1.57.57.1.1.1.2.2.1.1.1.1.1.1.2.1.cmml"></times><apply id="S4.E2.m1.57.57.1.1.1.2.2.1.1.1.1.1.1.2.2.cmml"><csymbol cd="ambiguous" id="S4.E2.m1.57.57.1.1.1.2.2.1.1.1.1.1.1.2.2.1.cmml">subscript</csymbol><ci id="S4.E2.m1.39.39.39.11.11.11.cmml" xref="S4.E2.m1.39.39.39.11.11.11">𝐖</ci><ci id="S4.E2.m1.40.40.40.12.12.12.1.cmml" xref="S4.E2.m1.40.40.40.12.12.12.1">𝑐</ci></apply><apply id="S4.E2.m1.57.57.1.1.1.2.2.1.1.1.1.1.1.2.3.cmml"><csymbol cd="ambiguous" id="S4.E2.m1.57.57.1.1.1.2.2.1.1.1.1.1.1.2.3.1.cmml">subscript</csymbol><ci id="S4.E2.m1.41.41.41.13.13.13.cmml" xref="S4.E2.m1.41.41.41.13.13.13">𝑐</ci><ci id="S4.E2.m1.42.42.42.14.14.14.1.cmml" xref="S4.E2.m1.42.42.42.14.14.14.1">𝑖</ci></apply></apply><apply id="S4.E2.m1.57.57.1.1.1.2.2.1.1.1.1.1.1.3.cmml"><csymbol cd="ambiguous" id="S4.E2.m1.57.57.1.1.1.2.2.1.1.1.1.1.1.3.1.cmml">subscript</csymbol><ci id="S4.E2.m1.44.44.44.16.16.16.cmml" xref="S4.E2.m1.44.44.44.16.16.16">𝑏</ci><ci id="S4.E2.m1.45.45.45.17.17.17.1.cmml" xref="S4.E2.m1.45.45.45.17.17.17.1">𝑐</ci></apply></apply><apply id="S4.E2.m1.57.57.1.1.1.2.2.1.1.1.1.2.2.cmml"><plus id="S4.E2.m1.51.51.51.23.23.23.cmml" xref="S4.E2.m1.51.51.51.23.23.23"></plus><apply id="S4.E2.m1.57.57.1.1.1.2.2.1.1.1.1.2.2.2.cmml"><times id="S4.E2.m1.57.57.1.1.1.2.2.1.1.1.1.2.2.2.1.cmml"></times><apply id="S4.E2.m1.57.57.1.1.1.2.2.1.1.1.1.2.2.2.2.cmml"><csymbol cd="ambiguous" id="S4.E2.m1.57.57.1.1.1.2.2.1.1.1.1.2.2.2.2.1.cmml">subscript</csymbol><ci id="S4.E2.m1.47.47.47.19.19.19.cmml" xref="S4.E2.m1.47.47.47.19.19.19">𝐖</ci><ci id="S4.E2.m1.48.48.48.20.20.20.1.cmml" xref="S4.E2.m1.48.48.48.20.20.20.1">𝑡</ci></apply><apply id="S4.E2.m1.57.57.1.1.1.2.2.1.1.1.1.2.2.2.3.cmml"><csymbol cd="ambiguous" id="S4.E2.m1.57.57.1.1.1.2.2.1.1.1.1.2.2.2.3.1.cmml">subscript</csymbol><ci id="S4.E2.m1.49.49.49.21.21.21.cmml" xref="S4.E2.m1.49.49.49.21.21.21">𝑡</ci><ci id="S4.E2.m1.50.50.50.22.22.22.1.cmml" xref="S4.E2.m1.50.50.50.22.22.22.1">𝑖</ci></apply></apply><apply id="S4.E2.m1.57.57.1.1.1.2.2.1.1.1.1.2.2.3.cmml"><csymbol cd="ambiguous" id="S4.E2.m1.57.57.1.1.1.2.2.1.1.1.1.2.2.3.1.cmml">subscript</csymbol><ci id="S4.E2.m1.52.52.52.24.24.24.cmml" xref="S4.E2.m1.52.52.52.24.24.24">𝑏</ci><ci id="S4.E2.m1.53.53.53.25.25.25.1.cmml" xref="S4.E2.m1.53.53.53.25.25.25.1">𝑡</ci></apply></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E2.m1.59c">\begin{split}x_{i}^{p}=tanh([\mathbf{W}_{p}p_{i}+b_{p};\mathbf{W}_{t}t_{i}+b_{%
t}]),\\
x_{i}^{c}=tanh([\mathbf{W}_{c}c_{i}+b_{c};\mathbf{W}_{t}t_{i}+b_{t}]),\end{split}</annotation><annotation encoding="application/x-llamapun" id="S4.E2.m1.59d">start_ROW start_CELL italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT = italic_t italic_a italic_n italic_h ( [ bold_W start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT + italic_b start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ; bold_W start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT + italic_b start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ] ) , end_CELL end_ROW start_ROW start_CELL italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_c end_POSTSUPERSCRIPT = italic_t italic_a italic_n italic_h ( [ bold_W start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT italic_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT + italic_b start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT ; bold_W start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT + italic_b start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ] ) , end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr>
</table>
<p id="S4.SS1.SSS2.p1.10" class="ltx_p">where <math id="S4.SS1.SSS2.p1.1.m1.1" class="ltx_Math" alttext="p_{i}" display="inline"><semantics id="S4.SS1.SSS2.p1.1.m1.1a"><msub id="S4.SS1.SSS2.p1.1.m1.1.1" xref="S4.SS1.SSS2.p1.1.m1.1.1.cmml"><mi id="S4.SS1.SSS2.p1.1.m1.1.1.2" xref="S4.SS1.SSS2.p1.1.m1.1.1.2.cmml">p</mi><mi id="S4.SS1.SSS2.p1.1.m1.1.1.3" xref="S4.SS1.SSS2.p1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p1.1.m1.1b"><apply id="S4.SS1.SSS2.p1.1.m1.1.1.cmml" xref="S4.SS1.SSS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p1.1.m1.1.1.1.cmml" xref="S4.SS1.SSS2.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS1.SSS2.p1.1.m1.1.1.2.cmml" xref="S4.SS1.SSS2.p1.1.m1.1.1.2">𝑝</ci><ci id="S4.SS1.SSS2.p1.1.m1.1.1.3.cmml" xref="S4.SS1.SSS2.p1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p1.1.m1.1c">p_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS2.p1.1.m1.1d">italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, <math id="S4.SS1.SSS2.p1.2.m2.1" class="ltx_Math" alttext="c_{i}" display="inline"><semantics id="S4.SS1.SSS2.p1.2.m2.1a"><msub id="S4.SS1.SSS2.p1.2.m2.1.1" xref="S4.SS1.SSS2.p1.2.m2.1.1.cmml"><mi id="S4.SS1.SSS2.p1.2.m2.1.1.2" xref="S4.SS1.SSS2.p1.2.m2.1.1.2.cmml">c</mi><mi id="S4.SS1.SSS2.p1.2.m2.1.1.3" xref="S4.SS1.SSS2.p1.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p1.2.m2.1b"><apply id="S4.SS1.SSS2.p1.2.m2.1.1.cmml" xref="S4.SS1.SSS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p1.2.m2.1.1.1.cmml" xref="S4.SS1.SSS2.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS1.SSS2.p1.2.m2.1.1.2.cmml" xref="S4.SS1.SSS2.p1.2.m2.1.1.2">𝑐</ci><ci id="S4.SS1.SSS2.p1.2.m2.1.1.3.cmml" xref="S4.SS1.SSS2.p1.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p1.2.m2.1c">c_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS2.p1.2.m2.1d">italic_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and <math id="S4.SS1.SSS2.p1.3.m3.1" class="ltx_Math" alttext="t_{i}" display="inline"><semantics id="S4.SS1.SSS2.p1.3.m3.1a"><msub id="S4.SS1.SSS2.p1.3.m3.1.1" xref="S4.SS1.SSS2.p1.3.m3.1.1.cmml"><mi id="S4.SS1.SSS2.p1.3.m3.1.1.2" xref="S4.SS1.SSS2.p1.3.m3.1.1.2.cmml">t</mi><mi id="S4.SS1.SSS2.p1.3.m3.1.1.3" xref="S4.SS1.SSS2.p1.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p1.3.m3.1b"><apply id="S4.SS1.SSS2.p1.3.m3.1.1.cmml" xref="S4.SS1.SSS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p1.3.m3.1.1.1.cmml" xref="S4.SS1.SSS2.p1.3.m3.1.1">subscript</csymbol><ci id="S4.SS1.SSS2.p1.3.m3.1.1.2.cmml" xref="S4.SS1.SSS2.p1.3.m3.1.1.2">𝑡</ci><ci id="S4.SS1.SSS2.p1.3.m3.1.1.3.cmml" xref="S4.SS1.SSS2.p1.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p1.3.m3.1c">t_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS2.p1.3.m3.1d">italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> are one-hot encodings for the <math id="S4.SS1.SSS2.p1.4.m4.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S4.SS1.SSS2.p1.4.m4.1a"><mi id="S4.SS1.SSS2.p1.4.m4.1.1" xref="S4.SS1.SSS2.p1.4.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p1.4.m4.1b"><ci id="S4.SS1.SSS2.p1.4.m4.1.1.cmml" xref="S4.SS1.SSS2.p1.4.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p1.4.m4.1c">i</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS2.p1.4.m4.1d">italic_i</annotation></semantics></math>-th POI, its category and time slice in the sequences, and <math id="S4.SS1.SSS2.p1.5.m5.1" class="ltx_Math" alttext="\mathbf{W}_{p}" display="inline"><semantics id="S4.SS1.SSS2.p1.5.m5.1a"><msub id="S4.SS1.SSS2.p1.5.m5.1.1" xref="S4.SS1.SSS2.p1.5.m5.1.1.cmml"><mi id="S4.SS1.SSS2.p1.5.m5.1.1.2" xref="S4.SS1.SSS2.p1.5.m5.1.1.2.cmml">𝐖</mi><mi id="S4.SS1.SSS2.p1.5.m5.1.1.3" xref="S4.SS1.SSS2.p1.5.m5.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p1.5.m5.1b"><apply id="S4.SS1.SSS2.p1.5.m5.1.1.cmml" xref="S4.SS1.SSS2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p1.5.m5.1.1.1.cmml" xref="S4.SS1.SSS2.p1.5.m5.1.1">subscript</csymbol><ci id="S4.SS1.SSS2.p1.5.m5.1.1.2.cmml" xref="S4.SS1.SSS2.p1.5.m5.1.1.2">𝐖</ci><ci id="S4.SS1.SSS2.p1.5.m5.1.1.3.cmml" xref="S4.SS1.SSS2.p1.5.m5.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p1.5.m5.1c">\mathbf{W}_{p}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS2.p1.5.m5.1d">bold_W start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT</annotation></semantics></math>, <math id="S4.SS1.SSS2.p1.6.m6.1" class="ltx_Math" alttext="\mathbf{W}_{c}" display="inline"><semantics id="S4.SS1.SSS2.p1.6.m6.1a"><msub id="S4.SS1.SSS2.p1.6.m6.1.1" xref="S4.SS1.SSS2.p1.6.m6.1.1.cmml"><mi id="S4.SS1.SSS2.p1.6.m6.1.1.2" xref="S4.SS1.SSS2.p1.6.m6.1.1.2.cmml">𝐖</mi><mi id="S4.SS1.SSS2.p1.6.m6.1.1.3" xref="S4.SS1.SSS2.p1.6.m6.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p1.6.m6.1b"><apply id="S4.SS1.SSS2.p1.6.m6.1.1.cmml" xref="S4.SS1.SSS2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p1.6.m6.1.1.1.cmml" xref="S4.SS1.SSS2.p1.6.m6.1.1">subscript</csymbol><ci id="S4.SS1.SSS2.p1.6.m6.1.1.2.cmml" xref="S4.SS1.SSS2.p1.6.m6.1.1.2">𝐖</ci><ci id="S4.SS1.SSS2.p1.6.m6.1.1.3.cmml" xref="S4.SS1.SSS2.p1.6.m6.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p1.6.m6.1c">\mathbf{W}_{c}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS2.p1.6.m6.1d">bold_W start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math>, <math id="S4.SS1.SSS2.p1.7.m7.1" class="ltx_Math" alttext="\mathbf{W}_{t}" display="inline"><semantics id="S4.SS1.SSS2.p1.7.m7.1a"><msub id="S4.SS1.SSS2.p1.7.m7.1.1" xref="S4.SS1.SSS2.p1.7.m7.1.1.cmml"><mi id="S4.SS1.SSS2.p1.7.m7.1.1.2" xref="S4.SS1.SSS2.p1.7.m7.1.1.2.cmml">𝐖</mi><mi id="S4.SS1.SSS2.p1.7.m7.1.1.3" xref="S4.SS1.SSS2.p1.7.m7.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p1.7.m7.1b"><apply id="S4.SS1.SSS2.p1.7.m7.1.1.cmml" xref="S4.SS1.SSS2.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p1.7.m7.1.1.1.cmml" xref="S4.SS1.SSS2.p1.7.m7.1.1">subscript</csymbol><ci id="S4.SS1.SSS2.p1.7.m7.1.1.2.cmml" xref="S4.SS1.SSS2.p1.7.m7.1.1.2">𝐖</ci><ci id="S4.SS1.SSS2.p1.7.m7.1.1.3.cmml" xref="S4.SS1.SSS2.p1.7.m7.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p1.7.m7.1c">\mathbf{W}_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS2.p1.7.m7.1d">bold_W start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, <math id="S4.SS1.SSS2.p1.8.m8.1" class="ltx_Math" alttext="b_{p}" display="inline"><semantics id="S4.SS1.SSS2.p1.8.m8.1a"><msub id="S4.SS1.SSS2.p1.8.m8.1.1" xref="S4.SS1.SSS2.p1.8.m8.1.1.cmml"><mi id="S4.SS1.SSS2.p1.8.m8.1.1.2" xref="S4.SS1.SSS2.p1.8.m8.1.1.2.cmml">b</mi><mi id="S4.SS1.SSS2.p1.8.m8.1.1.3" xref="S4.SS1.SSS2.p1.8.m8.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p1.8.m8.1b"><apply id="S4.SS1.SSS2.p1.8.m8.1.1.cmml" xref="S4.SS1.SSS2.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p1.8.m8.1.1.1.cmml" xref="S4.SS1.SSS2.p1.8.m8.1.1">subscript</csymbol><ci id="S4.SS1.SSS2.p1.8.m8.1.1.2.cmml" xref="S4.SS1.SSS2.p1.8.m8.1.1.2">𝑏</ci><ci id="S4.SS1.SSS2.p1.8.m8.1.1.3.cmml" xref="S4.SS1.SSS2.p1.8.m8.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p1.8.m8.1c">b_{p}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS2.p1.8.m8.1d">italic_b start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT</annotation></semantics></math>, <math id="S4.SS1.SSS2.p1.9.m9.1" class="ltx_Math" alttext="b_{c}" display="inline"><semantics id="S4.SS1.SSS2.p1.9.m9.1a"><msub id="S4.SS1.SSS2.p1.9.m9.1.1" xref="S4.SS1.SSS2.p1.9.m9.1.1.cmml"><mi id="S4.SS1.SSS2.p1.9.m9.1.1.2" xref="S4.SS1.SSS2.p1.9.m9.1.1.2.cmml">b</mi><mi id="S4.SS1.SSS2.p1.9.m9.1.1.3" xref="S4.SS1.SSS2.p1.9.m9.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p1.9.m9.1b"><apply id="S4.SS1.SSS2.p1.9.m9.1.1.cmml" xref="S4.SS1.SSS2.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p1.9.m9.1.1.1.cmml" xref="S4.SS1.SSS2.p1.9.m9.1.1">subscript</csymbol><ci id="S4.SS1.SSS2.p1.9.m9.1.1.2.cmml" xref="S4.SS1.SSS2.p1.9.m9.1.1.2">𝑏</ci><ci id="S4.SS1.SSS2.p1.9.m9.1.1.3.cmml" xref="S4.SS1.SSS2.p1.9.m9.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p1.9.m9.1c">b_{c}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS2.p1.9.m9.1d">italic_b start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math> and <math id="S4.SS1.SSS2.p1.10.m10.1" class="ltx_Math" alttext="b_{t}" display="inline"><semantics id="S4.SS1.SSS2.p1.10.m10.1a"><msub id="S4.SS1.SSS2.p1.10.m10.1.1" xref="S4.SS1.SSS2.p1.10.m10.1.1.cmml"><mi id="S4.SS1.SSS2.p1.10.m10.1.1.2" xref="S4.SS1.SSS2.p1.10.m10.1.1.2.cmml">b</mi><mi id="S4.SS1.SSS2.p1.10.m10.1.1.3" xref="S4.SS1.SSS2.p1.10.m10.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p1.10.m10.1b"><apply id="S4.SS1.SSS2.p1.10.m10.1.1.cmml" xref="S4.SS1.SSS2.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p1.10.m10.1.1.1.cmml" xref="S4.SS1.SSS2.p1.10.m10.1.1">subscript</csymbol><ci id="S4.SS1.SSS2.p1.10.m10.1.1.2.cmml" xref="S4.SS1.SSS2.p1.10.m10.1.1.2">𝑏</ci><ci id="S4.SS1.SSS2.p1.10.m10.1.1.3.cmml" xref="S4.SS1.SSS2.p1.10.m10.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p1.10.m10.1c">b_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS2.p1.10.m10.1d">italic_b start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> are learnable parameters. </p>
</div>
</section>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Trajectory Encoder</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p">To learn higher-order transition patterns of check-in trajectory sequences, trajectory encoders need to be designed. We note that the sequence lengths of input trajectories and augmented long-term trajectories differ greatly. Overly complex trajectory encoder is not suitable for processing shorter trajectories, and overly simple trajectory encoder cannot capture the long-term time dependencies of long trajectory sequences. Therefore, we design two different trajectory encoder based on RNN model and temporal-aware self-attention network respectively.</p>
</div>
<section id="S4.SS2.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.2.1 </span>RNN-based Encoder</h4>

<div id="S4.SS2.SSS1.p1" class="ltx_para">
<p id="S4.SS2.SSS1.p1.3" class="ltx_p">RNN is an efficient architecture for processing simple variable-length sequences. Due to the sparse nature of check-in trajectory, we use a popular RNN variant, Long Short-Term Memory network (LSTM) <cite class="ltx_cite ltx_citemacro_citep">(Hochreiter and
Schmidhuber, <a href="#bib.bib6" title="" class="ltx_ref">1997</a>; Huang <span class="ltx_text ltx_font_italic">et al.</span>, <a href="#bib.bib8" title="" class="ltx_ref">2019</a>)</cite>, as the encoder <math id="S4.SS2.SSS1.p1.1.m1.1" class="ltx_Math" alttext="f_{\theta}(\cdot)" display="inline"><semantics id="S4.SS2.SSS1.p1.1.m1.1a"><mrow id="S4.SS2.SSS1.p1.1.m1.1.2" xref="S4.SS2.SSS1.p1.1.m1.1.2.cmml"><msub id="S4.SS2.SSS1.p1.1.m1.1.2.2" xref="S4.SS2.SSS1.p1.1.m1.1.2.2.cmml"><mi id="S4.SS2.SSS1.p1.1.m1.1.2.2.2" xref="S4.SS2.SSS1.p1.1.m1.1.2.2.2.cmml">f</mi><mi id="S4.SS2.SSS1.p1.1.m1.1.2.2.3" xref="S4.SS2.SSS1.p1.1.m1.1.2.2.3.cmml">θ</mi></msub><mo id="S4.SS2.SSS1.p1.1.m1.1.2.1" xref="S4.SS2.SSS1.p1.1.m1.1.2.1.cmml">⁢</mo><mrow id="S4.SS2.SSS1.p1.1.m1.1.2.3.2" xref="S4.SS2.SSS1.p1.1.m1.1.2.cmml"><mo stretchy="false" id="S4.SS2.SSS1.p1.1.m1.1.2.3.2.1" xref="S4.SS2.SSS1.p1.1.m1.1.2.cmml">(</mo><mo id="S4.SS2.SSS1.p1.1.m1.1.1" xref="S4.SS2.SSS1.p1.1.m1.1.1.cmml">⋅</mo><mo stretchy="false" id="S4.SS2.SSS1.p1.1.m1.1.2.3.2.2" xref="S4.SS2.SSS1.p1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.1.m1.1b"><apply id="S4.SS2.SSS1.p1.1.m1.1.2.cmml" xref="S4.SS2.SSS1.p1.1.m1.1.2"><times id="S4.SS2.SSS1.p1.1.m1.1.2.1.cmml" xref="S4.SS2.SSS1.p1.1.m1.1.2.1"></times><apply id="S4.SS2.SSS1.p1.1.m1.1.2.2.cmml" xref="S4.SS2.SSS1.p1.1.m1.1.2.2"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p1.1.m1.1.2.2.1.cmml" xref="S4.SS2.SSS1.p1.1.m1.1.2.2">subscript</csymbol><ci id="S4.SS2.SSS1.p1.1.m1.1.2.2.2.cmml" xref="S4.SS2.SSS1.p1.1.m1.1.2.2.2">𝑓</ci><ci id="S4.SS2.SSS1.p1.1.m1.1.2.2.3.cmml" xref="S4.SS2.SSS1.p1.1.m1.1.2.2.3">𝜃</ci></apply><ci id="S4.SS2.SSS1.p1.1.m1.1.1.cmml" xref="S4.SS2.SSS1.p1.1.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.1.m1.1c">f_{\theta}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p1.1.m1.1d">italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( ⋅ )</annotation></semantics></math> for processing the input trajectory. For both check-in POI and category sequences, we use a shared encoder <math id="S4.SS2.SSS1.p1.2.m2.1" class="ltx_Math" alttext="f_{\theta}(\cdot)" display="inline"><semantics id="S4.SS2.SSS1.p1.2.m2.1a"><mrow id="S4.SS2.SSS1.p1.2.m2.1.2" xref="S4.SS2.SSS1.p1.2.m2.1.2.cmml"><msub id="S4.SS2.SSS1.p1.2.m2.1.2.2" xref="S4.SS2.SSS1.p1.2.m2.1.2.2.cmml"><mi id="S4.SS2.SSS1.p1.2.m2.1.2.2.2" xref="S4.SS2.SSS1.p1.2.m2.1.2.2.2.cmml">f</mi><mi id="S4.SS2.SSS1.p1.2.m2.1.2.2.3" xref="S4.SS2.SSS1.p1.2.m2.1.2.2.3.cmml">θ</mi></msub><mo id="S4.SS2.SSS1.p1.2.m2.1.2.1" xref="S4.SS2.SSS1.p1.2.m2.1.2.1.cmml">⁢</mo><mrow id="S4.SS2.SSS1.p1.2.m2.1.2.3.2" xref="S4.SS2.SSS1.p1.2.m2.1.2.cmml"><mo stretchy="false" id="S4.SS2.SSS1.p1.2.m2.1.2.3.2.1" xref="S4.SS2.SSS1.p1.2.m2.1.2.cmml">(</mo><mo id="S4.SS2.SSS1.p1.2.m2.1.1" xref="S4.SS2.SSS1.p1.2.m2.1.1.cmml">⋅</mo><mo stretchy="false" id="S4.SS2.SSS1.p1.2.m2.1.2.3.2.2" xref="S4.SS2.SSS1.p1.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.2.m2.1b"><apply id="S4.SS2.SSS1.p1.2.m2.1.2.cmml" xref="S4.SS2.SSS1.p1.2.m2.1.2"><times id="S4.SS2.SSS1.p1.2.m2.1.2.1.cmml" xref="S4.SS2.SSS1.p1.2.m2.1.2.1"></times><apply id="S4.SS2.SSS1.p1.2.m2.1.2.2.cmml" xref="S4.SS2.SSS1.p1.2.m2.1.2.2"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p1.2.m2.1.2.2.1.cmml" xref="S4.SS2.SSS1.p1.2.m2.1.2.2">subscript</csymbol><ci id="S4.SS2.SSS1.p1.2.m2.1.2.2.2.cmml" xref="S4.SS2.SSS1.p1.2.m2.1.2.2.2">𝑓</ci><ci id="S4.SS2.SSS1.p1.2.m2.1.2.2.3.cmml" xref="S4.SS2.SSS1.p1.2.m2.1.2.2.3">𝜃</ci></apply><ci id="S4.SS2.SSS1.p1.2.m2.1.1.cmml" xref="S4.SS2.SSS1.p1.2.m2.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.2.m2.1c">f_{\theta}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p1.2.m2.1d">italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( ⋅ )</annotation></semantics></math> and choose the hidden layer embedding of last time step as the representation of the two sequences.
Then we use a learnable parameter <math id="S4.SS2.SSS1.p1.3.m3.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.SS2.SSS1.p1.3.m3.1a"><mi id="S4.SS2.SSS1.p1.3.m3.1.1" xref="S4.SS2.SSS1.p1.3.m3.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.3.m3.1b"><ci id="S4.SS2.SSS1.p1.3.m3.1.1.cmml" xref="S4.SS2.SSS1.p1.3.m3.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.3.m3.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p1.3.m3.1d">italic_α</annotation></semantics></math> to balance the weights of the two representations and map them to user dimension via a multilayer perceptron (MLP) to obtain the final representation of the input trajectory:</p>
<table id="S4.E3" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E3.m1.1" class="ltx_Math" alttext="z_{in}^{\theta}=MLP(\alpha\cdot f_{\theta}(\mathbf{X}_{in}^{p})+(1-\alpha)%
\cdot f_{\theta}(\mathbf{X}_{in}^{c}))," display="block"><semantics id="S4.E3.m1.1a"><mrow id="S4.E3.m1.1.1.1" xref="S4.E3.m1.1.1.1.1.cmml"><mrow id="S4.E3.m1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.cmml"><msubsup id="S4.E3.m1.1.1.1.1.3" xref="S4.E3.m1.1.1.1.1.3.cmml"><mi id="S4.E3.m1.1.1.1.1.3.2.2" xref="S4.E3.m1.1.1.1.1.3.2.2.cmml">z</mi><mrow id="S4.E3.m1.1.1.1.1.3.2.3" xref="S4.E3.m1.1.1.1.1.3.2.3.cmml"><mi id="S4.E3.m1.1.1.1.1.3.2.3.2" xref="S4.E3.m1.1.1.1.1.3.2.3.2.cmml">i</mi><mo id="S4.E3.m1.1.1.1.1.3.2.3.1" xref="S4.E3.m1.1.1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S4.E3.m1.1.1.1.1.3.2.3.3" xref="S4.E3.m1.1.1.1.1.3.2.3.3.cmml">n</mi></mrow><mi id="S4.E3.m1.1.1.1.1.3.3" xref="S4.E3.m1.1.1.1.1.3.3.cmml">θ</mi></msubsup><mo id="S4.E3.m1.1.1.1.1.2" xref="S4.E3.m1.1.1.1.1.2.cmml">=</mo><mrow id="S4.E3.m1.1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.1.cmml"><mi id="S4.E3.m1.1.1.1.1.1.3" xref="S4.E3.m1.1.1.1.1.1.3.cmml">M</mi><mo id="S4.E3.m1.1.1.1.1.1.2" xref="S4.E3.m1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S4.E3.m1.1.1.1.1.1.4" xref="S4.E3.m1.1.1.1.1.1.4.cmml">L</mi><mo id="S4.E3.m1.1.1.1.1.1.2a" xref="S4.E3.m1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S4.E3.m1.1.1.1.1.1.5" xref="S4.E3.m1.1.1.1.1.1.5.cmml">P</mi><mo id="S4.E3.m1.1.1.1.1.1.2b" xref="S4.E3.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E3.m1.1.1.1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E3.m1.1.1.1.1.1.1.1.2" xref="S4.E3.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E3.m1.1.1.1.1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.1.1.1.1.cmml"><mrow id="S4.E3.m1.1.1.1.1.1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S4.E3.m1.1.1.1.1.1.1.1.1.1.3" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E3.m1.1.1.1.1.1.1.1.1.1.3.2" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.3.2.cmml">α</mi><mo id="S4.E3.m1.1.1.1.1.1.1.1.1.1.3.1" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.3.1.cmml">⋅</mo><msub id="S4.E3.m1.1.1.1.1.1.1.1.1.1.3.3" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S4.E3.m1.1.1.1.1.1.1.1.1.1.3.3.2" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.3.3.2.cmml">f</mi><mi id="S4.E3.m1.1.1.1.1.1.1.1.1.1.3.3.3" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.3.3.3.cmml">θ</mi></msub></mrow><mo id="S4.E3.m1.1.1.1.1.1.1.1.1.1.2" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐗</mi><mrow id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml">i</mi><mo id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml">n</mi></mrow><mi id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">p</mi></msubsup><mo stretchy="false" id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E3.m1.1.1.1.1.1.1.1.1.4" xref="S4.E3.m1.1.1.1.1.1.1.1.1.4.cmml">+</mo><mrow id="S4.E3.m1.1.1.1.1.1.1.1.1.3" xref="S4.E3.m1.1.1.1.1.1.1.1.1.3.cmml"><mrow id="S4.E3.m1.1.1.1.1.1.1.1.1.2.1" xref="S4.E3.m1.1.1.1.1.1.1.1.1.2.1.cmml"><mrow id="S4.E3.m1.1.1.1.1.1.1.1.1.2.1.1.1" xref="S4.E3.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.cmml"><mo stretchy="false" id="S4.E3.m1.1.1.1.1.1.1.1.1.2.1.1.1.2" xref="S4.E3.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.cmml">(</mo><mrow id="S4.E3.m1.1.1.1.1.1.1.1.1.2.1.1.1.1" xref="S4.E3.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.cmml"><mn id="S4.E3.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.2" xref="S4.E3.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.2.cmml">1</mn><mo id="S4.E3.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.cmml">-</mo><mi id="S4.E3.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.3" xref="S4.E3.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.3.cmml">α</mi></mrow><mo stretchy="false" id="S4.E3.m1.1.1.1.1.1.1.1.1.2.1.1.1.3" xref="S4.E3.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.cmml">)</mo></mrow><mo id="S4.E3.m1.1.1.1.1.1.1.1.1.2.1.2" xref="S4.E3.m1.1.1.1.1.1.1.1.1.2.1.2.cmml">⋅</mo><msub id="S4.E3.m1.1.1.1.1.1.1.1.1.2.1.3" xref="S4.E3.m1.1.1.1.1.1.1.1.1.2.1.3.cmml"><mi id="S4.E3.m1.1.1.1.1.1.1.1.1.2.1.3.2" xref="S4.E3.m1.1.1.1.1.1.1.1.1.2.1.3.2.cmml">f</mi><mi id="S4.E3.m1.1.1.1.1.1.1.1.1.2.1.3.3" xref="S4.E3.m1.1.1.1.1.1.1.1.1.2.1.3.3.cmml">θ</mi></msub></mrow><mo id="S4.E3.m1.1.1.1.1.1.1.1.1.3.3" xref="S4.E3.m1.1.1.1.1.1.1.1.1.3.3.cmml">⁢</mo><mrow id="S4.E3.m1.1.1.1.1.1.1.1.1.3.2.1" xref="S4.E3.m1.1.1.1.1.1.1.1.1.3.2.1.1.cmml"><mo stretchy="false" id="S4.E3.m1.1.1.1.1.1.1.1.1.3.2.1.2" xref="S4.E3.m1.1.1.1.1.1.1.1.1.3.2.1.1.cmml">(</mo><msubsup id="S4.E3.m1.1.1.1.1.1.1.1.1.3.2.1.1" xref="S4.E3.m1.1.1.1.1.1.1.1.1.3.2.1.1.cmml"><mi id="S4.E3.m1.1.1.1.1.1.1.1.1.3.2.1.1.2.2" xref="S4.E3.m1.1.1.1.1.1.1.1.1.3.2.1.1.2.2.cmml">𝐗</mi><mrow id="S4.E3.m1.1.1.1.1.1.1.1.1.3.2.1.1.2.3" xref="S4.E3.m1.1.1.1.1.1.1.1.1.3.2.1.1.2.3.cmml"><mi id="S4.E3.m1.1.1.1.1.1.1.1.1.3.2.1.1.2.3.2" xref="S4.E3.m1.1.1.1.1.1.1.1.1.3.2.1.1.2.3.2.cmml">i</mi><mo id="S4.E3.m1.1.1.1.1.1.1.1.1.3.2.1.1.2.3.1" xref="S4.E3.m1.1.1.1.1.1.1.1.1.3.2.1.1.2.3.1.cmml">⁢</mo><mi id="S4.E3.m1.1.1.1.1.1.1.1.1.3.2.1.1.2.3.3" xref="S4.E3.m1.1.1.1.1.1.1.1.1.3.2.1.1.2.3.3.cmml">n</mi></mrow><mi id="S4.E3.m1.1.1.1.1.1.1.1.1.3.2.1.1.3" xref="S4.E3.m1.1.1.1.1.1.1.1.1.3.2.1.1.3.cmml">c</mi></msubsup><mo stretchy="false" id="S4.E3.m1.1.1.1.1.1.1.1.1.3.2.1.3" xref="S4.E3.m1.1.1.1.1.1.1.1.1.3.2.1.1.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S4.E3.m1.1.1.1.1.1.1.1.3" xref="S4.E3.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E3.m1.1.1.1.2" xref="S4.E3.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E3.m1.1b"><apply id="S4.E3.m1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1"><eq id="S4.E3.m1.1.1.1.1.2.cmml" xref="S4.E3.m1.1.1.1.1.2"></eq><apply id="S4.E3.m1.1.1.1.1.3.cmml" xref="S4.E3.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.1.1.3.1.cmml" xref="S4.E3.m1.1.1.1.1.3">superscript</csymbol><apply id="S4.E3.m1.1.1.1.1.3.2.cmml" xref="S4.E3.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.1.1.3.2.1.cmml" xref="S4.E3.m1.1.1.1.1.3">subscript</csymbol><ci id="S4.E3.m1.1.1.1.1.3.2.2.cmml" xref="S4.E3.m1.1.1.1.1.3.2.2">𝑧</ci><apply id="S4.E3.m1.1.1.1.1.3.2.3.cmml" xref="S4.E3.m1.1.1.1.1.3.2.3"><times id="S4.E3.m1.1.1.1.1.3.2.3.1.cmml" xref="S4.E3.m1.1.1.1.1.3.2.3.1"></times><ci id="S4.E3.m1.1.1.1.1.3.2.3.2.cmml" xref="S4.E3.m1.1.1.1.1.3.2.3.2">𝑖</ci><ci id="S4.E3.m1.1.1.1.1.3.2.3.3.cmml" xref="S4.E3.m1.1.1.1.1.3.2.3.3">𝑛</ci></apply></apply><ci id="S4.E3.m1.1.1.1.1.3.3.cmml" xref="S4.E3.m1.1.1.1.1.3.3">𝜃</ci></apply><apply id="S4.E3.m1.1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1.1"><times id="S4.E3.m1.1.1.1.1.1.2.cmml" xref="S4.E3.m1.1.1.1.1.1.2"></times><ci id="S4.E3.m1.1.1.1.1.1.3.cmml" xref="S4.E3.m1.1.1.1.1.1.3">𝑀</ci><ci id="S4.E3.m1.1.1.1.1.1.4.cmml" xref="S4.E3.m1.1.1.1.1.1.4">𝐿</ci><ci id="S4.E3.m1.1.1.1.1.1.5.cmml" xref="S4.E3.m1.1.1.1.1.1.5">𝑃</ci><apply id="S4.E3.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1"><plus id="S4.E3.m1.1.1.1.1.1.1.1.1.4.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.4"></plus><apply id="S4.E3.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1"><times id="S4.E3.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.2"></times><apply id="S4.E3.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.3"><ci id="S4.E3.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.3.1">⋅</ci><ci id="S4.E3.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.3.2">𝛼</ci><apply id="S4.E3.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S4.E3.m1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.3.3.2">𝑓</ci><ci id="S4.E3.m1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.3.3.3">𝜃</ci></apply></apply><apply id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝐗</ci><apply id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3"><times id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1"></times><ci id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2">𝑖</ci><ci id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3">𝑛</ci></apply></apply><ci id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑝</ci></apply></apply><apply id="S4.E3.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.3"><times id="S4.E3.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.3.3"></times><apply id="S4.E3.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.2.1"><ci id="S4.E3.m1.1.1.1.1.1.1.1.1.2.1.2.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.2.1.2">⋅</ci><apply id="S4.E3.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.2.1.1.1"><minus id="S4.E3.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.1"></minus><cn type="integer" id="S4.E3.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.2.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.2">1</cn><ci id="S4.E3.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.3.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.3">𝛼</ci></apply><apply id="S4.E3.m1.1.1.1.1.1.1.1.1.2.1.3.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.2.1.3"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.1.1.1.1.1.1.2.1.3.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.2.1.3">subscript</csymbol><ci id="S4.E3.m1.1.1.1.1.1.1.1.1.2.1.3.2.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.2.1.3.2">𝑓</ci><ci id="S4.E3.m1.1.1.1.1.1.1.1.1.2.1.3.3.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.2.1.3.3">𝜃</ci></apply></apply><apply id="S4.E3.m1.1.1.1.1.1.1.1.1.3.2.1.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.3.2.1"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.1.1.1.1.1.1.3.2.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.3.2.1">superscript</csymbol><apply id="S4.E3.m1.1.1.1.1.1.1.1.1.3.2.1.1.2.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.3.2.1"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.1.1.1.1.1.1.3.2.1.1.2.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.3.2.1">subscript</csymbol><ci id="S4.E3.m1.1.1.1.1.1.1.1.1.3.2.1.1.2.2.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.3.2.1.1.2.2">𝐗</ci><apply id="S4.E3.m1.1.1.1.1.1.1.1.1.3.2.1.1.2.3.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.3.2.1.1.2.3"><times id="S4.E3.m1.1.1.1.1.1.1.1.1.3.2.1.1.2.3.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.3.2.1.1.2.3.1"></times><ci id="S4.E3.m1.1.1.1.1.1.1.1.1.3.2.1.1.2.3.2.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.3.2.1.1.2.3.2">𝑖</ci><ci id="S4.E3.m1.1.1.1.1.1.1.1.1.3.2.1.1.2.3.3.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.3.2.1.1.2.3.3">𝑛</ci></apply></apply><ci id="S4.E3.m1.1.1.1.1.1.1.1.1.3.2.1.1.3.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.3.2.1.1.3">𝑐</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E3.m1.1c">z_{in}^{\theta}=MLP(\alpha\cdot f_{\theta}(\mathbf{X}_{in}^{p})+(1-\alpha)%
\cdot f_{\theta}(\mathbf{X}_{in}^{c})),</annotation><annotation encoding="application/x-llamapun" id="S4.E3.m1.1d">italic_z start_POSTSUBSCRIPT italic_i italic_n end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_θ end_POSTSUPERSCRIPT = italic_M italic_L italic_P ( italic_α ⋅ italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_X start_POSTSUBSCRIPT italic_i italic_n end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT ) + ( 1 - italic_α ) ⋅ italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_X start_POSTSUBSCRIPT italic_i italic_n end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_c end_POSTSUPERSCRIPT ) ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr>
</table>
<p id="S4.SS2.SSS1.p1.5" class="ltx_p">where <math id="S4.SS2.SSS1.p1.4.m1.6" class="ltx_Math" alttext="\mathbf{X}_{in}^{p}=\{x_{i}^{p}|i=1,2,\dots,m\}" display="inline"><semantics id="S4.SS2.SSS1.p1.4.m1.6a"><mrow id="S4.SS2.SSS1.p1.4.m1.6.6" xref="S4.SS2.SSS1.p1.4.m1.6.6.cmml"><msubsup id="S4.SS2.SSS1.p1.4.m1.6.6.4" xref="S4.SS2.SSS1.p1.4.m1.6.6.4.cmml"><mi id="S4.SS2.SSS1.p1.4.m1.6.6.4.2.2" xref="S4.SS2.SSS1.p1.4.m1.6.6.4.2.2.cmml">𝐗</mi><mrow id="S4.SS2.SSS1.p1.4.m1.6.6.4.2.3" xref="S4.SS2.SSS1.p1.4.m1.6.6.4.2.3.cmml"><mi id="S4.SS2.SSS1.p1.4.m1.6.6.4.2.3.2" xref="S4.SS2.SSS1.p1.4.m1.6.6.4.2.3.2.cmml">i</mi><mo id="S4.SS2.SSS1.p1.4.m1.6.6.4.2.3.1" xref="S4.SS2.SSS1.p1.4.m1.6.6.4.2.3.1.cmml">⁢</mo><mi id="S4.SS2.SSS1.p1.4.m1.6.6.4.2.3.3" xref="S4.SS2.SSS1.p1.4.m1.6.6.4.2.3.3.cmml">n</mi></mrow><mi id="S4.SS2.SSS1.p1.4.m1.6.6.4.3" xref="S4.SS2.SSS1.p1.4.m1.6.6.4.3.cmml">p</mi></msubsup><mo id="S4.SS2.SSS1.p1.4.m1.6.6.3" xref="S4.SS2.SSS1.p1.4.m1.6.6.3.cmml">=</mo><mrow id="S4.SS2.SSS1.p1.4.m1.6.6.2.2" xref="S4.SS2.SSS1.p1.4.m1.6.6.2.3.cmml"><mo stretchy="false" id="S4.SS2.SSS1.p1.4.m1.6.6.2.2.3" xref="S4.SS2.SSS1.p1.4.m1.6.6.2.3.1.cmml">{</mo><msubsup id="S4.SS2.SSS1.p1.4.m1.5.5.1.1.1" xref="S4.SS2.SSS1.p1.4.m1.5.5.1.1.1.cmml"><mi id="S4.SS2.SSS1.p1.4.m1.5.5.1.1.1.2.2" xref="S4.SS2.SSS1.p1.4.m1.5.5.1.1.1.2.2.cmml">x</mi><mi id="S4.SS2.SSS1.p1.4.m1.5.5.1.1.1.2.3" xref="S4.SS2.SSS1.p1.4.m1.5.5.1.1.1.2.3.cmml">i</mi><mi id="S4.SS2.SSS1.p1.4.m1.5.5.1.1.1.3" xref="S4.SS2.SSS1.p1.4.m1.5.5.1.1.1.3.cmml">p</mi></msubsup><mo stretchy="false" id="S4.SS2.SSS1.p1.4.m1.6.6.2.2.4" xref="S4.SS2.SSS1.p1.4.m1.6.6.2.3.1.cmml">|</mo><mrow id="S4.SS2.SSS1.p1.4.m1.6.6.2.2.2" xref="S4.SS2.SSS1.p1.4.m1.6.6.2.2.2.cmml"><mi id="S4.SS2.SSS1.p1.4.m1.6.6.2.2.2.2" xref="S4.SS2.SSS1.p1.4.m1.6.6.2.2.2.2.cmml">i</mi><mo id="S4.SS2.SSS1.p1.4.m1.6.6.2.2.2.1" xref="S4.SS2.SSS1.p1.4.m1.6.6.2.2.2.1.cmml">=</mo><mrow id="S4.SS2.SSS1.p1.4.m1.6.6.2.2.2.3.2" xref="S4.SS2.SSS1.p1.4.m1.6.6.2.2.2.3.1.cmml"><mn id="S4.SS2.SSS1.p1.4.m1.1.1" xref="S4.SS2.SSS1.p1.4.m1.1.1.cmml">1</mn><mo id="S4.SS2.SSS1.p1.4.m1.6.6.2.2.2.3.2.1" xref="S4.SS2.SSS1.p1.4.m1.6.6.2.2.2.3.1.cmml">,</mo><mn id="S4.SS2.SSS1.p1.4.m1.2.2" xref="S4.SS2.SSS1.p1.4.m1.2.2.cmml">2</mn><mo id="S4.SS2.SSS1.p1.4.m1.6.6.2.2.2.3.2.2" xref="S4.SS2.SSS1.p1.4.m1.6.6.2.2.2.3.1.cmml">,</mo><mi mathvariant="normal" id="S4.SS2.SSS1.p1.4.m1.3.3" xref="S4.SS2.SSS1.p1.4.m1.3.3.cmml">…</mi><mo id="S4.SS2.SSS1.p1.4.m1.6.6.2.2.2.3.2.3" xref="S4.SS2.SSS1.p1.4.m1.6.6.2.2.2.3.1.cmml">,</mo><mi id="S4.SS2.SSS1.p1.4.m1.4.4" xref="S4.SS2.SSS1.p1.4.m1.4.4.cmml">m</mi></mrow></mrow><mo stretchy="false" id="S4.SS2.SSS1.p1.4.m1.6.6.2.2.5" xref="S4.SS2.SSS1.p1.4.m1.6.6.2.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.4.m1.6b"><apply id="S4.SS2.SSS1.p1.4.m1.6.6.cmml" xref="S4.SS2.SSS1.p1.4.m1.6.6"><eq id="S4.SS2.SSS1.p1.4.m1.6.6.3.cmml" xref="S4.SS2.SSS1.p1.4.m1.6.6.3"></eq><apply id="S4.SS2.SSS1.p1.4.m1.6.6.4.cmml" xref="S4.SS2.SSS1.p1.4.m1.6.6.4"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p1.4.m1.6.6.4.1.cmml" xref="S4.SS2.SSS1.p1.4.m1.6.6.4">superscript</csymbol><apply id="S4.SS2.SSS1.p1.4.m1.6.6.4.2.cmml" xref="S4.SS2.SSS1.p1.4.m1.6.6.4"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p1.4.m1.6.6.4.2.1.cmml" xref="S4.SS2.SSS1.p1.4.m1.6.6.4">subscript</csymbol><ci id="S4.SS2.SSS1.p1.4.m1.6.6.4.2.2.cmml" xref="S4.SS2.SSS1.p1.4.m1.6.6.4.2.2">𝐗</ci><apply id="S4.SS2.SSS1.p1.4.m1.6.6.4.2.3.cmml" xref="S4.SS2.SSS1.p1.4.m1.6.6.4.2.3"><times id="S4.SS2.SSS1.p1.4.m1.6.6.4.2.3.1.cmml" xref="S4.SS2.SSS1.p1.4.m1.6.6.4.2.3.1"></times><ci id="S4.SS2.SSS1.p1.4.m1.6.6.4.2.3.2.cmml" xref="S4.SS2.SSS1.p1.4.m1.6.6.4.2.3.2">𝑖</ci><ci id="S4.SS2.SSS1.p1.4.m1.6.6.4.2.3.3.cmml" xref="S4.SS2.SSS1.p1.4.m1.6.6.4.2.3.3">𝑛</ci></apply></apply><ci id="S4.SS2.SSS1.p1.4.m1.6.6.4.3.cmml" xref="S4.SS2.SSS1.p1.4.m1.6.6.4.3">𝑝</ci></apply><apply id="S4.SS2.SSS1.p1.4.m1.6.6.2.3.cmml" xref="S4.SS2.SSS1.p1.4.m1.6.6.2.2"><csymbol cd="latexml" id="S4.SS2.SSS1.p1.4.m1.6.6.2.3.1.cmml" xref="S4.SS2.SSS1.p1.4.m1.6.6.2.2.3">conditional-set</csymbol><apply id="S4.SS2.SSS1.p1.4.m1.5.5.1.1.1.cmml" xref="S4.SS2.SSS1.p1.4.m1.5.5.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p1.4.m1.5.5.1.1.1.1.cmml" xref="S4.SS2.SSS1.p1.4.m1.5.5.1.1.1">superscript</csymbol><apply id="S4.SS2.SSS1.p1.4.m1.5.5.1.1.1.2.cmml" xref="S4.SS2.SSS1.p1.4.m1.5.5.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p1.4.m1.5.5.1.1.1.2.1.cmml" xref="S4.SS2.SSS1.p1.4.m1.5.5.1.1.1">subscript</csymbol><ci id="S4.SS2.SSS1.p1.4.m1.5.5.1.1.1.2.2.cmml" xref="S4.SS2.SSS1.p1.4.m1.5.5.1.1.1.2.2">𝑥</ci><ci id="S4.SS2.SSS1.p1.4.m1.5.5.1.1.1.2.3.cmml" xref="S4.SS2.SSS1.p1.4.m1.5.5.1.1.1.2.3">𝑖</ci></apply><ci id="S4.SS2.SSS1.p1.4.m1.5.5.1.1.1.3.cmml" xref="S4.SS2.SSS1.p1.4.m1.5.5.1.1.1.3">𝑝</ci></apply><apply id="S4.SS2.SSS1.p1.4.m1.6.6.2.2.2.cmml" xref="S4.SS2.SSS1.p1.4.m1.6.6.2.2.2"><eq id="S4.SS2.SSS1.p1.4.m1.6.6.2.2.2.1.cmml" xref="S4.SS2.SSS1.p1.4.m1.6.6.2.2.2.1"></eq><ci id="S4.SS2.SSS1.p1.4.m1.6.6.2.2.2.2.cmml" xref="S4.SS2.SSS1.p1.4.m1.6.6.2.2.2.2">𝑖</ci><list id="S4.SS2.SSS1.p1.4.m1.6.6.2.2.2.3.1.cmml" xref="S4.SS2.SSS1.p1.4.m1.6.6.2.2.2.3.2"><cn type="integer" id="S4.SS2.SSS1.p1.4.m1.1.1.cmml" xref="S4.SS2.SSS1.p1.4.m1.1.1">1</cn><cn type="integer" id="S4.SS2.SSS1.p1.4.m1.2.2.cmml" xref="S4.SS2.SSS1.p1.4.m1.2.2">2</cn><ci id="S4.SS2.SSS1.p1.4.m1.3.3.cmml" xref="S4.SS2.SSS1.p1.4.m1.3.3">…</ci><ci id="S4.SS2.SSS1.p1.4.m1.4.4.cmml" xref="S4.SS2.SSS1.p1.4.m1.4.4">𝑚</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.4.m1.6c">\mathbf{X}_{in}^{p}=\{x_{i}^{p}|i=1,2,\dots,m\}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p1.4.m1.6d">bold_X start_POSTSUBSCRIPT italic_i italic_n end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT = { italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT | italic_i = 1 , 2 , … , italic_m }</annotation></semantics></math> and <math id="S4.SS2.SSS1.p1.5.m2.6" class="ltx_Math" alttext="\mathbf{X}_{in}^{c}=\{x_{i}^{c}|i=1,2,\\
\dots,m\}" display="inline"><semantics id="S4.SS2.SSS1.p1.5.m2.6a"><mrow id="S4.SS2.SSS1.p1.5.m2.6.6" xref="S4.SS2.SSS1.p1.5.m2.6.6.cmml"><msubsup id="S4.SS2.SSS1.p1.5.m2.6.6.4" xref="S4.SS2.SSS1.p1.5.m2.6.6.4.cmml"><mi id="S4.SS2.SSS1.p1.5.m2.6.6.4.2.2" xref="S4.SS2.SSS1.p1.5.m2.6.6.4.2.2.cmml">𝐗</mi><mrow id="S4.SS2.SSS1.p1.5.m2.6.6.4.2.3" xref="S4.SS2.SSS1.p1.5.m2.6.6.4.2.3.cmml"><mi id="S4.SS2.SSS1.p1.5.m2.6.6.4.2.3.2" xref="S4.SS2.SSS1.p1.5.m2.6.6.4.2.3.2.cmml">i</mi><mo id="S4.SS2.SSS1.p1.5.m2.6.6.4.2.3.1" xref="S4.SS2.SSS1.p1.5.m2.6.6.4.2.3.1.cmml">⁢</mo><mi id="S4.SS2.SSS1.p1.5.m2.6.6.4.2.3.3" xref="S4.SS2.SSS1.p1.5.m2.6.6.4.2.3.3.cmml">n</mi></mrow><mi id="S4.SS2.SSS1.p1.5.m2.6.6.4.3" xref="S4.SS2.SSS1.p1.5.m2.6.6.4.3.cmml">c</mi></msubsup><mo id="S4.SS2.SSS1.p1.5.m2.6.6.3" xref="S4.SS2.SSS1.p1.5.m2.6.6.3.cmml">=</mo><mrow id="S4.SS2.SSS1.p1.5.m2.6.6.2.2" xref="S4.SS2.SSS1.p1.5.m2.6.6.2.3.cmml"><mo stretchy="false" id="S4.SS2.SSS1.p1.5.m2.6.6.2.2.3" xref="S4.SS2.SSS1.p1.5.m2.6.6.2.3.1.cmml">{</mo><msubsup id="S4.SS2.SSS1.p1.5.m2.5.5.1.1.1" xref="S4.SS2.SSS1.p1.5.m2.5.5.1.1.1.cmml"><mi id="S4.SS2.SSS1.p1.5.m2.5.5.1.1.1.2.2" xref="S4.SS2.SSS1.p1.5.m2.5.5.1.1.1.2.2.cmml">x</mi><mi id="S4.SS2.SSS1.p1.5.m2.5.5.1.1.1.2.3" xref="S4.SS2.SSS1.p1.5.m2.5.5.1.1.1.2.3.cmml">i</mi><mi id="S4.SS2.SSS1.p1.5.m2.5.5.1.1.1.3" xref="S4.SS2.SSS1.p1.5.m2.5.5.1.1.1.3.cmml">c</mi></msubsup><mo stretchy="false" id="S4.SS2.SSS1.p1.5.m2.6.6.2.2.4" xref="S4.SS2.SSS1.p1.5.m2.6.6.2.3.1.cmml">|</mo><mrow id="S4.SS2.SSS1.p1.5.m2.6.6.2.2.2" xref="S4.SS2.SSS1.p1.5.m2.6.6.2.2.2.cmml"><mi id="S4.SS2.SSS1.p1.5.m2.6.6.2.2.2.2" xref="S4.SS2.SSS1.p1.5.m2.6.6.2.2.2.2.cmml">i</mi><mo id="S4.SS2.SSS1.p1.5.m2.6.6.2.2.2.1" xref="S4.SS2.SSS1.p1.5.m2.6.6.2.2.2.1.cmml">=</mo><mrow id="S4.SS2.SSS1.p1.5.m2.6.6.2.2.2.3.2" xref="S4.SS2.SSS1.p1.5.m2.6.6.2.2.2.3.1.cmml"><mn id="S4.SS2.SSS1.p1.5.m2.1.1" xref="S4.SS2.SSS1.p1.5.m2.1.1.cmml">1</mn><mo id="S4.SS2.SSS1.p1.5.m2.6.6.2.2.2.3.2.1" xref="S4.SS2.SSS1.p1.5.m2.6.6.2.2.2.3.1.cmml">,</mo><mn id="S4.SS2.SSS1.p1.5.m2.2.2" xref="S4.SS2.SSS1.p1.5.m2.2.2.cmml">2</mn><mo id="S4.SS2.SSS1.p1.5.m2.6.6.2.2.2.3.2.2" xref="S4.SS2.SSS1.p1.5.m2.6.6.2.2.2.3.1.cmml">,</mo><mi mathvariant="normal" id="S4.SS2.SSS1.p1.5.m2.3.3" xref="S4.SS2.SSS1.p1.5.m2.3.3.cmml">…</mi><mo id="S4.SS2.SSS1.p1.5.m2.6.6.2.2.2.3.2.3" xref="S4.SS2.SSS1.p1.5.m2.6.6.2.2.2.3.1.cmml">,</mo><mi id="S4.SS2.SSS1.p1.5.m2.4.4" xref="S4.SS2.SSS1.p1.5.m2.4.4.cmml">m</mi></mrow></mrow><mo stretchy="false" id="S4.SS2.SSS1.p1.5.m2.6.6.2.2.5" xref="S4.SS2.SSS1.p1.5.m2.6.6.2.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.5.m2.6b"><apply id="S4.SS2.SSS1.p1.5.m2.6.6.cmml" xref="S4.SS2.SSS1.p1.5.m2.6.6"><eq id="S4.SS2.SSS1.p1.5.m2.6.6.3.cmml" xref="S4.SS2.SSS1.p1.5.m2.6.6.3"></eq><apply id="S4.SS2.SSS1.p1.5.m2.6.6.4.cmml" xref="S4.SS2.SSS1.p1.5.m2.6.6.4"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p1.5.m2.6.6.4.1.cmml" xref="S4.SS2.SSS1.p1.5.m2.6.6.4">superscript</csymbol><apply id="S4.SS2.SSS1.p1.5.m2.6.6.4.2.cmml" xref="S4.SS2.SSS1.p1.5.m2.6.6.4"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p1.5.m2.6.6.4.2.1.cmml" xref="S4.SS2.SSS1.p1.5.m2.6.6.4">subscript</csymbol><ci id="S4.SS2.SSS1.p1.5.m2.6.6.4.2.2.cmml" xref="S4.SS2.SSS1.p1.5.m2.6.6.4.2.2">𝐗</ci><apply id="S4.SS2.SSS1.p1.5.m2.6.6.4.2.3.cmml" xref="S4.SS2.SSS1.p1.5.m2.6.6.4.2.3"><times id="S4.SS2.SSS1.p1.5.m2.6.6.4.2.3.1.cmml" xref="S4.SS2.SSS1.p1.5.m2.6.6.4.2.3.1"></times><ci id="S4.SS2.SSS1.p1.5.m2.6.6.4.2.3.2.cmml" xref="S4.SS2.SSS1.p1.5.m2.6.6.4.2.3.2">𝑖</ci><ci id="S4.SS2.SSS1.p1.5.m2.6.6.4.2.3.3.cmml" xref="S4.SS2.SSS1.p1.5.m2.6.6.4.2.3.3">𝑛</ci></apply></apply><ci id="S4.SS2.SSS1.p1.5.m2.6.6.4.3.cmml" xref="S4.SS2.SSS1.p1.5.m2.6.6.4.3">𝑐</ci></apply><apply id="S4.SS2.SSS1.p1.5.m2.6.6.2.3.cmml" xref="S4.SS2.SSS1.p1.5.m2.6.6.2.2"><csymbol cd="latexml" id="S4.SS2.SSS1.p1.5.m2.6.6.2.3.1.cmml" xref="S4.SS2.SSS1.p1.5.m2.6.6.2.2.3">conditional-set</csymbol><apply id="S4.SS2.SSS1.p1.5.m2.5.5.1.1.1.cmml" xref="S4.SS2.SSS1.p1.5.m2.5.5.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p1.5.m2.5.5.1.1.1.1.cmml" xref="S4.SS2.SSS1.p1.5.m2.5.5.1.1.1">superscript</csymbol><apply id="S4.SS2.SSS1.p1.5.m2.5.5.1.1.1.2.cmml" xref="S4.SS2.SSS1.p1.5.m2.5.5.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p1.5.m2.5.5.1.1.1.2.1.cmml" xref="S4.SS2.SSS1.p1.5.m2.5.5.1.1.1">subscript</csymbol><ci id="S4.SS2.SSS1.p1.5.m2.5.5.1.1.1.2.2.cmml" xref="S4.SS2.SSS1.p1.5.m2.5.5.1.1.1.2.2">𝑥</ci><ci id="S4.SS2.SSS1.p1.5.m2.5.5.1.1.1.2.3.cmml" xref="S4.SS2.SSS1.p1.5.m2.5.5.1.1.1.2.3">𝑖</ci></apply><ci id="S4.SS2.SSS1.p1.5.m2.5.5.1.1.1.3.cmml" xref="S4.SS2.SSS1.p1.5.m2.5.5.1.1.1.3">𝑐</ci></apply><apply id="S4.SS2.SSS1.p1.5.m2.6.6.2.2.2.cmml" xref="S4.SS2.SSS1.p1.5.m2.6.6.2.2.2"><eq id="S4.SS2.SSS1.p1.5.m2.6.6.2.2.2.1.cmml" xref="S4.SS2.SSS1.p1.5.m2.6.6.2.2.2.1"></eq><ci id="S4.SS2.SSS1.p1.5.m2.6.6.2.2.2.2.cmml" xref="S4.SS2.SSS1.p1.5.m2.6.6.2.2.2.2">𝑖</ci><list id="S4.SS2.SSS1.p1.5.m2.6.6.2.2.2.3.1.cmml" xref="S4.SS2.SSS1.p1.5.m2.6.6.2.2.2.3.2"><cn type="integer" id="S4.SS2.SSS1.p1.5.m2.1.1.cmml" xref="S4.SS2.SSS1.p1.5.m2.1.1">1</cn><cn type="integer" id="S4.SS2.SSS1.p1.5.m2.2.2.cmml" xref="S4.SS2.SSS1.p1.5.m2.2.2">2</cn><ci id="S4.SS2.SSS1.p1.5.m2.3.3.cmml" xref="S4.SS2.SSS1.p1.5.m2.3.3">…</ci><ci id="S4.SS2.SSS1.p1.5.m2.4.4.cmml" xref="S4.SS2.SSS1.p1.5.m2.4.4">𝑚</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.5.m2.6c">\mathbf{X}_{in}^{c}=\{x_{i}^{c}|i=1,2,\\
\dots,m\}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p1.5.m2.6d">bold_X start_POSTSUBSCRIPT italic_i italic_n end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_c end_POSTSUPERSCRIPT = { italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_c end_POSTSUPERSCRIPT | italic_i = 1 , 2 , … , italic_m }</annotation></semantics></math> denote the embeddings of check-in POI sequence and category sequence of input trajectory, respectively.</p>
</div>
</section>
<section id="S4.SS2.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.2.2 </span>Temporal-aware Transformer Encoder</h4>

<div id="S4.SS2.SSS2.p1" class="ltx_para">
<p id="S4.SS2.SSS2.p1.6" class="ltx_p">The Transformer architecture <cite class="ltx_cite ltx_citemacro_citep">(Vaswani <span class="ltx_text ltx_font_italic">et al.</span>, <a href="#bib.bib23" title="" class="ltx_ref">2017</a>)</cite> is very expressive and flexible for both long- and short-term dependencies, which is proven to be superior to traditional sequence models in dealing with long sequences <cite class="ltx_cite ltx_citemacro_citep">(Yang <span class="ltx_text ltx_font_italic">et al.</span>, <a href="#bib.bib26" title="" class="ltx_ref">2019</a>; Wu <span class="ltx_text ltx_font_italic">et al.</span>, <a href="#bib.bib24" title="" class="ltx_ref">2020</a>)</cite>. However, for a long trajectory sequence, it should be noted that there is still a problem, that is, the time slice information cannot fully reflect the information changes of the trajectory in the time dimension (<span id="S4.SS2.SSS2.p1.6.1" class="ltx_text ltx_font_italic">e</span>.<span id="S4.SS2.SSS2.p1.6.2" class="ltx_text ltx_font_italic">g</span>., relative visit time difference). Therefore, inspired by <cite class="ltx_cite ltx_citemacro_citep">(Zuo <span class="ltx_text ltx_font_italic">et al.</span>, <a href="#bib.bib36" title="" class="ltx_ref">2020</a>; Lin <span class="ltx_text ltx_font_italic">et al.</span>, <a href="#bib.bib16" title="" class="ltx_ref">2020</a>)</cite>, we design a temporal-aware position encoder to replace the position encoder in the original transformer:</p>
<table id="S4.E4" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E4.m1.7" class="ltx_Math" alttext="\left[PE\left(t_{j}\right)\right]_{i}=\left\{\begin{array}[]{ll}\cos\left(w_{i%
}t_{j}\right),&amp;\text{ if }i\text{ is odd },\\
\sin\left(w_{i}t_{j}\right),&amp;\text{ if }i\text{ is even },\end{array}\right." display="block"><semantics id="S4.E4.m1.7a"><mrow id="S4.E4.m1.7.7" xref="S4.E4.m1.7.7.cmml"><msub id="S4.E4.m1.7.7.1" xref="S4.E4.m1.7.7.1.cmml"><mrow id="S4.E4.m1.7.7.1.1.1" xref="S4.E4.m1.7.7.1.1.2.cmml"><mo id="S4.E4.m1.7.7.1.1.1.2" xref="S4.E4.m1.7.7.1.1.2.1.cmml">[</mo><mrow id="S4.E4.m1.7.7.1.1.1.1" xref="S4.E4.m1.7.7.1.1.1.1.cmml"><mi id="S4.E4.m1.7.7.1.1.1.1.3" xref="S4.E4.m1.7.7.1.1.1.1.3.cmml">P</mi><mo id="S4.E4.m1.7.7.1.1.1.1.2" xref="S4.E4.m1.7.7.1.1.1.1.2.cmml">⁢</mo><mi id="S4.E4.m1.7.7.1.1.1.1.4" xref="S4.E4.m1.7.7.1.1.1.1.4.cmml">E</mi><mo id="S4.E4.m1.7.7.1.1.1.1.2a" xref="S4.E4.m1.7.7.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E4.m1.7.7.1.1.1.1.1.1" xref="S4.E4.m1.7.7.1.1.1.1.1.1.1.cmml"><mo id="S4.E4.m1.7.7.1.1.1.1.1.1.2" xref="S4.E4.m1.7.7.1.1.1.1.1.1.1.cmml">(</mo><msub id="S4.E4.m1.7.7.1.1.1.1.1.1.1" xref="S4.E4.m1.7.7.1.1.1.1.1.1.1.cmml"><mi id="S4.E4.m1.7.7.1.1.1.1.1.1.1.2" xref="S4.E4.m1.7.7.1.1.1.1.1.1.1.2.cmml">t</mi><mi id="S4.E4.m1.7.7.1.1.1.1.1.1.1.3" xref="S4.E4.m1.7.7.1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="S4.E4.m1.7.7.1.1.1.1.1.1.3" xref="S4.E4.m1.7.7.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E4.m1.7.7.1.1.1.3" xref="S4.E4.m1.7.7.1.1.2.1.cmml">]</mo></mrow><mi id="S4.E4.m1.7.7.1.3" xref="S4.E4.m1.7.7.1.3.cmml">i</mi></msub><mo id="S4.E4.m1.7.7.2" xref="S4.E4.m1.7.7.2.cmml">=</mo><mrow id="S4.E4.m1.7.7.3.2" xref="S4.E4.m1.7.7.3.1.cmml"><mo id="S4.E4.m1.7.7.3.2.1" xref="S4.E4.m1.7.7.3.1.1.cmml">{</mo><mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt" id="S4.E4.m1.6.6" xref="S4.E4.m1.6.6.cmml"><mtr id="S4.E4.m1.6.6a" xref="S4.E4.m1.6.6.cmml"><mtd columnalign="left" id="S4.E4.m1.6.6b" xref="S4.E4.m1.6.6.cmml"><mrow id="S4.E4.m1.2.2.2.2.2.2" xref="S4.E4.m1.6.6.cmml"><mrow id="S4.E4.m1.2.2.2.2.2.2.1.1" xref="S4.E4.m1.2.2.2.2.2.2.1.2.cmml"><mi id="S4.E4.m1.1.1.1.1.1.1" xref="S4.E4.m1.1.1.1.1.1.1.cmml">cos</mi><mo id="S4.E4.m1.2.2.2.2.2.2.1.1a" xref="S4.E4.m1.2.2.2.2.2.2.1.2.cmml">⁡</mo><mrow id="S4.E4.m1.2.2.2.2.2.2.1.1.1" xref="S4.E4.m1.2.2.2.2.2.2.1.2.cmml"><mo id="S4.E4.m1.2.2.2.2.2.2.1.1.1.2" xref="S4.E4.m1.2.2.2.2.2.2.1.2.cmml">(</mo><mrow id="S4.E4.m1.2.2.2.2.2.2.1.1.1.1" xref="S4.E4.m1.2.2.2.2.2.2.1.1.1.1.cmml"><msub id="S4.E4.m1.2.2.2.2.2.2.1.1.1.1.2" xref="S4.E4.m1.2.2.2.2.2.2.1.1.1.1.2.cmml"><mi id="S4.E4.m1.2.2.2.2.2.2.1.1.1.1.2.2" xref="S4.E4.m1.2.2.2.2.2.2.1.1.1.1.2.2.cmml">w</mi><mi id="S4.E4.m1.2.2.2.2.2.2.1.1.1.1.2.3" xref="S4.E4.m1.2.2.2.2.2.2.1.1.1.1.2.3.cmml">i</mi></msub><mo id="S4.E4.m1.2.2.2.2.2.2.1.1.1.1.1" xref="S4.E4.m1.2.2.2.2.2.2.1.1.1.1.1.cmml">⁢</mo><msub id="S4.E4.m1.2.2.2.2.2.2.1.1.1.1.3" xref="S4.E4.m1.2.2.2.2.2.2.1.1.1.1.3.cmml"><mi id="S4.E4.m1.2.2.2.2.2.2.1.1.1.1.3.2" xref="S4.E4.m1.2.2.2.2.2.2.1.1.1.1.3.2.cmml">t</mi><mi id="S4.E4.m1.2.2.2.2.2.2.1.1.1.1.3.3" xref="S4.E4.m1.2.2.2.2.2.2.1.1.1.1.3.3.cmml">j</mi></msub></mrow><mo id="S4.E4.m1.2.2.2.2.2.2.1.1.1.3" xref="S4.E4.m1.2.2.2.2.2.2.1.2.cmml">)</mo></mrow></mrow><mo id="S4.E4.m1.2.2.2.2.2.2.2" xref="S4.E4.m1.6.6.cmml">,</mo></mrow></mtd><mtd columnalign="left" id="S4.E4.m1.6.6c" xref="S4.E4.m1.6.6.cmml"><mrow id="S4.E4.m1.3.3.3.3.1.1" xref="S4.E4.m1.3.3.3.3.1.1.1.cmml"><mrow id="S4.E4.m1.3.3.3.3.1.1.1" xref="S4.E4.m1.3.3.3.3.1.1.1.cmml"><mtext id="S4.E4.m1.3.3.3.3.1.1.1.2" xref="S4.E4.m1.3.3.3.3.1.1.1.2a.cmml"> if </mtext><mo id="S4.E4.m1.3.3.3.3.1.1.1.1" xref="S4.E4.m1.3.3.3.3.1.1.1.1.cmml">⁢</mo><mi id="S4.E4.m1.3.3.3.3.1.1.1.3" xref="S4.E4.m1.3.3.3.3.1.1.1.3.cmml">i</mi><mo id="S4.E4.m1.3.3.3.3.1.1.1.1a" xref="S4.E4.m1.3.3.3.3.1.1.1.1.cmml">⁢</mo><mtext id="S4.E4.m1.3.3.3.3.1.1.1.4" xref="S4.E4.m1.3.3.3.3.1.1.1.4a.cmml"> is odd </mtext></mrow><mo id="S4.E4.m1.3.3.3.3.1.1.2" xref="S4.E4.m1.3.3.3.3.1.1.1.cmml">,</mo></mrow></mtd></mtr><mtr id="S4.E4.m1.6.6d" xref="S4.E4.m1.6.6.cmml"><mtd columnalign="left" id="S4.E4.m1.6.6e" xref="S4.E4.m1.6.6.cmml"><mrow id="S4.E4.m1.5.5.5.2.2.2" xref="S4.E4.m1.6.6.cmml"><mrow id="S4.E4.m1.5.5.5.2.2.2.1.1" xref="S4.E4.m1.5.5.5.2.2.2.1.2.cmml"><mi id="S4.E4.m1.4.4.4.1.1.1" xref="S4.E4.m1.4.4.4.1.1.1.cmml">sin</mi><mo id="S4.E4.m1.5.5.5.2.2.2.1.1a" xref="S4.E4.m1.5.5.5.2.2.2.1.2.cmml">⁡</mo><mrow id="S4.E4.m1.5.5.5.2.2.2.1.1.1" xref="S4.E4.m1.5.5.5.2.2.2.1.2.cmml"><mo id="S4.E4.m1.5.5.5.2.2.2.1.1.1.2" xref="S4.E4.m1.5.5.5.2.2.2.1.2.cmml">(</mo><mrow id="S4.E4.m1.5.5.5.2.2.2.1.1.1.1" xref="S4.E4.m1.5.5.5.2.2.2.1.1.1.1.cmml"><msub id="S4.E4.m1.5.5.5.2.2.2.1.1.1.1.2" xref="S4.E4.m1.5.5.5.2.2.2.1.1.1.1.2.cmml"><mi id="S4.E4.m1.5.5.5.2.2.2.1.1.1.1.2.2" xref="S4.E4.m1.5.5.5.2.2.2.1.1.1.1.2.2.cmml">w</mi><mi id="S4.E4.m1.5.5.5.2.2.2.1.1.1.1.2.3" xref="S4.E4.m1.5.5.5.2.2.2.1.1.1.1.2.3.cmml">i</mi></msub><mo id="S4.E4.m1.5.5.5.2.2.2.1.1.1.1.1" xref="S4.E4.m1.5.5.5.2.2.2.1.1.1.1.1.cmml">⁢</mo><msub id="S4.E4.m1.5.5.5.2.2.2.1.1.1.1.3" xref="S4.E4.m1.5.5.5.2.2.2.1.1.1.1.3.cmml"><mi id="S4.E4.m1.5.5.5.2.2.2.1.1.1.1.3.2" xref="S4.E4.m1.5.5.5.2.2.2.1.1.1.1.3.2.cmml">t</mi><mi id="S4.E4.m1.5.5.5.2.2.2.1.1.1.1.3.3" xref="S4.E4.m1.5.5.5.2.2.2.1.1.1.1.3.3.cmml">j</mi></msub></mrow><mo id="S4.E4.m1.5.5.5.2.2.2.1.1.1.3" xref="S4.E4.m1.5.5.5.2.2.2.1.2.cmml">)</mo></mrow></mrow><mo id="S4.E4.m1.5.5.5.2.2.2.2" xref="S4.E4.m1.6.6.cmml">,</mo></mrow></mtd><mtd columnalign="left" id="S4.E4.m1.6.6f" xref="S4.E4.m1.6.6.cmml"><mrow id="S4.E4.m1.6.6.6.3.1.1" xref="S4.E4.m1.6.6.6.3.1.1.1.cmml"><mrow id="S4.E4.m1.6.6.6.3.1.1.1" xref="S4.E4.m1.6.6.6.3.1.1.1.cmml"><mtext id="S4.E4.m1.6.6.6.3.1.1.1.2" xref="S4.E4.m1.6.6.6.3.1.1.1.2a.cmml"> if </mtext><mo id="S4.E4.m1.6.6.6.3.1.1.1.1" xref="S4.E4.m1.6.6.6.3.1.1.1.1.cmml">⁢</mo><mi id="S4.E4.m1.6.6.6.3.1.1.1.3" xref="S4.E4.m1.6.6.6.3.1.1.1.3.cmml">i</mi><mo id="S4.E4.m1.6.6.6.3.1.1.1.1a" xref="S4.E4.m1.6.6.6.3.1.1.1.1.cmml">⁢</mo><mtext id="S4.E4.m1.6.6.6.3.1.1.1.4" xref="S4.E4.m1.6.6.6.3.1.1.1.4a.cmml"> is even </mtext></mrow><mo id="S4.E4.m1.6.6.6.3.1.1.2" xref="S4.E4.m1.6.6.6.3.1.1.1.cmml">,</mo></mrow></mtd></mtr></mtable><mi id="S4.E4.m1.7.7.3.2.2" xref="S4.E4.m1.7.7.3.1.1.cmml"></mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E4.m1.7b"><apply id="S4.E4.m1.7.7.cmml" xref="S4.E4.m1.7.7"><eq id="S4.E4.m1.7.7.2.cmml" xref="S4.E4.m1.7.7.2"></eq><apply id="S4.E4.m1.7.7.1.cmml" xref="S4.E4.m1.7.7.1"><csymbol cd="ambiguous" id="S4.E4.m1.7.7.1.2.cmml" xref="S4.E4.m1.7.7.1">subscript</csymbol><apply id="S4.E4.m1.7.7.1.1.2.cmml" xref="S4.E4.m1.7.7.1.1.1"><csymbol cd="latexml" id="S4.E4.m1.7.7.1.1.2.1.cmml" xref="S4.E4.m1.7.7.1.1.1.2">delimited-[]</csymbol><apply id="S4.E4.m1.7.7.1.1.1.1.cmml" xref="S4.E4.m1.7.7.1.1.1.1"><times id="S4.E4.m1.7.7.1.1.1.1.2.cmml" xref="S4.E4.m1.7.7.1.1.1.1.2"></times><ci id="S4.E4.m1.7.7.1.1.1.1.3.cmml" xref="S4.E4.m1.7.7.1.1.1.1.3">𝑃</ci><ci id="S4.E4.m1.7.7.1.1.1.1.4.cmml" xref="S4.E4.m1.7.7.1.1.1.1.4">𝐸</ci><apply id="S4.E4.m1.7.7.1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.7.7.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E4.m1.7.7.1.1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.7.7.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E4.m1.7.7.1.1.1.1.1.1.1.2.cmml" xref="S4.E4.m1.7.7.1.1.1.1.1.1.1.2">𝑡</ci><ci id="S4.E4.m1.7.7.1.1.1.1.1.1.1.3.cmml" xref="S4.E4.m1.7.7.1.1.1.1.1.1.1.3">𝑗</ci></apply></apply></apply><ci id="S4.E4.m1.7.7.1.3.cmml" xref="S4.E4.m1.7.7.1.3">𝑖</ci></apply><apply id="S4.E4.m1.7.7.3.1.cmml" xref="S4.E4.m1.7.7.3.2"><csymbol cd="latexml" id="S4.E4.m1.7.7.3.1.1.cmml" xref="S4.E4.m1.7.7.3.2.1">cases</csymbol><matrix id="S4.E4.m1.6.6.cmml" xref="S4.E4.m1.6.6"><matrixrow id="S4.E4.m1.6.6a.cmml" xref="S4.E4.m1.6.6"><apply id="S4.E4.m1.2.2.2.2.2.2.1.2.cmml" xref="S4.E4.m1.2.2.2.2.2.2.1.1"><cos id="S4.E4.m1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.1.1.1.1.1.1"></cos><apply id="S4.E4.m1.2.2.2.2.2.2.1.1.1.1.cmml" xref="S4.E4.m1.2.2.2.2.2.2.1.1.1.1"><times id="S4.E4.m1.2.2.2.2.2.2.1.1.1.1.1.cmml" xref="S4.E4.m1.2.2.2.2.2.2.1.1.1.1.1"></times><apply id="S4.E4.m1.2.2.2.2.2.2.1.1.1.1.2.cmml" xref="S4.E4.m1.2.2.2.2.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E4.m1.2.2.2.2.2.2.1.1.1.1.2.1.cmml" xref="S4.E4.m1.2.2.2.2.2.2.1.1.1.1.2">subscript</csymbol><ci id="S4.E4.m1.2.2.2.2.2.2.1.1.1.1.2.2.cmml" xref="S4.E4.m1.2.2.2.2.2.2.1.1.1.1.2.2">𝑤</ci><ci id="S4.E4.m1.2.2.2.2.2.2.1.1.1.1.2.3.cmml" xref="S4.E4.m1.2.2.2.2.2.2.1.1.1.1.2.3">𝑖</ci></apply><apply id="S4.E4.m1.2.2.2.2.2.2.1.1.1.1.3.cmml" xref="S4.E4.m1.2.2.2.2.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E4.m1.2.2.2.2.2.2.1.1.1.1.3.1.cmml" xref="S4.E4.m1.2.2.2.2.2.2.1.1.1.1.3">subscript</csymbol><ci id="S4.E4.m1.2.2.2.2.2.2.1.1.1.1.3.2.cmml" xref="S4.E4.m1.2.2.2.2.2.2.1.1.1.1.3.2">𝑡</ci><ci id="S4.E4.m1.2.2.2.2.2.2.1.1.1.1.3.3.cmml" xref="S4.E4.m1.2.2.2.2.2.2.1.1.1.1.3.3">𝑗</ci></apply></apply></apply><apply id="S4.E4.m1.3.3.3.3.1.1.1.cmml" xref="S4.E4.m1.3.3.3.3.1.1"><times id="S4.E4.m1.3.3.3.3.1.1.1.1.cmml" xref="S4.E4.m1.3.3.3.3.1.1.1.1"></times><ci id="S4.E4.m1.3.3.3.3.1.1.1.2a.cmml" xref="S4.E4.m1.3.3.3.3.1.1.1.2"><mtext id="S4.E4.m1.3.3.3.3.1.1.1.2.cmml" xref="S4.E4.m1.3.3.3.3.1.1.1.2"> if </mtext></ci><ci id="S4.E4.m1.3.3.3.3.1.1.1.3.cmml" xref="S4.E4.m1.3.3.3.3.1.1.1.3">𝑖</ci><ci id="S4.E4.m1.3.3.3.3.1.1.1.4a.cmml" xref="S4.E4.m1.3.3.3.3.1.1.1.4"><mtext id="S4.E4.m1.3.3.3.3.1.1.1.4.cmml" xref="S4.E4.m1.3.3.3.3.1.1.1.4"> is odd </mtext></ci></apply></matrixrow><matrixrow id="S4.E4.m1.6.6b.cmml" xref="S4.E4.m1.6.6"><apply id="S4.E4.m1.5.5.5.2.2.2.1.2.cmml" xref="S4.E4.m1.5.5.5.2.2.2.1.1"><sin id="S4.E4.m1.4.4.4.1.1.1.cmml" xref="S4.E4.m1.4.4.4.1.1.1"></sin><apply id="S4.E4.m1.5.5.5.2.2.2.1.1.1.1.cmml" xref="S4.E4.m1.5.5.5.2.2.2.1.1.1.1"><times id="S4.E4.m1.5.5.5.2.2.2.1.1.1.1.1.cmml" xref="S4.E4.m1.5.5.5.2.2.2.1.1.1.1.1"></times><apply id="S4.E4.m1.5.5.5.2.2.2.1.1.1.1.2.cmml" xref="S4.E4.m1.5.5.5.2.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E4.m1.5.5.5.2.2.2.1.1.1.1.2.1.cmml" xref="S4.E4.m1.5.5.5.2.2.2.1.1.1.1.2">subscript</csymbol><ci id="S4.E4.m1.5.5.5.2.2.2.1.1.1.1.2.2.cmml" xref="S4.E4.m1.5.5.5.2.2.2.1.1.1.1.2.2">𝑤</ci><ci id="S4.E4.m1.5.5.5.2.2.2.1.1.1.1.2.3.cmml" xref="S4.E4.m1.5.5.5.2.2.2.1.1.1.1.2.3">𝑖</ci></apply><apply id="S4.E4.m1.5.5.5.2.2.2.1.1.1.1.3.cmml" xref="S4.E4.m1.5.5.5.2.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E4.m1.5.5.5.2.2.2.1.1.1.1.3.1.cmml" xref="S4.E4.m1.5.5.5.2.2.2.1.1.1.1.3">subscript</csymbol><ci id="S4.E4.m1.5.5.5.2.2.2.1.1.1.1.3.2.cmml" xref="S4.E4.m1.5.5.5.2.2.2.1.1.1.1.3.2">𝑡</ci><ci id="S4.E4.m1.5.5.5.2.2.2.1.1.1.1.3.3.cmml" xref="S4.E4.m1.5.5.5.2.2.2.1.1.1.1.3.3">𝑗</ci></apply></apply></apply><apply id="S4.E4.m1.6.6.6.3.1.1.1.cmml" xref="S4.E4.m1.6.6.6.3.1.1"><times id="S4.E4.m1.6.6.6.3.1.1.1.1.cmml" xref="S4.E4.m1.6.6.6.3.1.1.1.1"></times><ci id="S4.E4.m1.6.6.6.3.1.1.1.2a.cmml" xref="S4.E4.m1.6.6.6.3.1.1.1.2"><mtext id="S4.E4.m1.6.6.6.3.1.1.1.2.cmml" xref="S4.E4.m1.6.6.6.3.1.1.1.2"> if </mtext></ci><ci id="S4.E4.m1.6.6.6.3.1.1.1.3.cmml" xref="S4.E4.m1.6.6.6.3.1.1.1.3">𝑖</ci><ci id="S4.E4.m1.6.6.6.3.1.1.1.4a.cmml" xref="S4.E4.m1.6.6.6.3.1.1.1.4"><mtext id="S4.E4.m1.6.6.6.3.1.1.1.4.cmml" xref="S4.E4.m1.6.6.6.3.1.1.1.4"> is even </mtext></ci></apply></matrixrow></matrix></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E4.m1.7c">\left[PE\left(t_{j}\right)\right]_{i}=\left\{\begin{array}[]{ll}\cos\left(w_{i%
}t_{j}\right),&amp;\text{ if }i\text{ is odd },\\
\sin\left(w_{i}t_{j}\right),&amp;\text{ if }i\text{ is even },\end{array}\right.</annotation><annotation encoding="application/x-llamapun" id="S4.E4.m1.7d">[ italic_P italic_E ( italic_t start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) ] start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = { start_ARRAY start_ROW start_CELL roman_cos ( italic_w start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_t start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) , end_CELL start_CELL if italic_i is odd , end_CELL end_ROW start_ROW start_CELL roman_sin ( italic_w start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_t start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) , end_CELL start_CELL if italic_i is even , end_CELL end_ROW end_ARRAY</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr>
</table>
<p id="S4.SS2.SSS2.p1.5" class="ltx_p">where <math id="S4.SS2.SSS2.p1.1.m1.1" class="ltx_Math" alttext="w_{i}" display="inline"><semantics id="S4.SS2.SSS2.p1.1.m1.1a"><msub id="S4.SS2.SSS2.p1.1.m1.1.1" xref="S4.SS2.SSS2.p1.1.m1.1.1.cmml"><mi id="S4.SS2.SSS2.p1.1.m1.1.1.2" xref="S4.SS2.SSS2.p1.1.m1.1.1.2.cmml">w</mi><mi id="S4.SS2.SSS2.p1.1.m1.1.1.3" xref="S4.SS2.SSS2.p1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.1.m1.1b"><apply id="S4.SS2.SSS2.p1.1.m1.1.1.cmml" xref="S4.SS2.SSS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p1.1.m1.1.1.1.cmml" xref="S4.SS2.SSS2.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS2.SSS2.p1.1.m1.1.1.2.cmml" xref="S4.SS2.SSS2.p1.1.m1.1.1.2">𝑤</ci><ci id="S4.SS2.SSS2.p1.1.m1.1.1.3.cmml" xref="S4.SS2.SSS2.p1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.1.m1.1c">w_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p1.1.m1.1d">italic_w start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is a learnable parameter, <math id="S4.SS2.SSS2.p1.2.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S4.SS2.SSS2.p1.2.m2.1a"><mi id="S4.SS2.SSS2.p1.2.m2.1.1" xref="S4.SS2.SSS2.p1.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.2.m2.1b"><ci id="S4.SS2.SSS2.p1.2.m2.1.1.cmml" xref="S4.SS2.SSS2.p1.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.2.m2.1c">i</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p1.2.m2.1d">italic_i</annotation></semantics></math> is the order of embedding dimension (<math id="S4.SS2.SSS2.p1.3.m3.1" class="ltx_Math" alttext="i\leq 2d" display="inline"><semantics id="S4.SS2.SSS2.p1.3.m3.1a"><mrow id="S4.SS2.SSS2.p1.3.m3.1.1" xref="S4.SS2.SSS2.p1.3.m3.1.1.cmml"><mi id="S4.SS2.SSS2.p1.3.m3.1.1.2" xref="S4.SS2.SSS2.p1.3.m3.1.1.2.cmml">i</mi><mo id="S4.SS2.SSS2.p1.3.m3.1.1.1" xref="S4.SS2.SSS2.p1.3.m3.1.1.1.cmml">≤</mo><mrow id="S4.SS2.SSS2.p1.3.m3.1.1.3" xref="S4.SS2.SSS2.p1.3.m3.1.1.3.cmml"><mn id="S4.SS2.SSS2.p1.3.m3.1.1.3.2" xref="S4.SS2.SSS2.p1.3.m3.1.1.3.2.cmml">2</mn><mo id="S4.SS2.SSS2.p1.3.m3.1.1.3.1" xref="S4.SS2.SSS2.p1.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S4.SS2.SSS2.p1.3.m3.1.1.3.3" xref="S4.SS2.SSS2.p1.3.m3.1.1.3.3.cmml">d</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.3.m3.1b"><apply id="S4.SS2.SSS2.p1.3.m3.1.1.cmml" xref="S4.SS2.SSS2.p1.3.m3.1.1"><leq id="S4.SS2.SSS2.p1.3.m3.1.1.1.cmml" xref="S4.SS2.SSS2.p1.3.m3.1.1.1"></leq><ci id="S4.SS2.SSS2.p1.3.m3.1.1.2.cmml" xref="S4.SS2.SSS2.p1.3.m3.1.1.2">𝑖</ci><apply id="S4.SS2.SSS2.p1.3.m3.1.1.3.cmml" xref="S4.SS2.SSS2.p1.3.m3.1.1.3"><times id="S4.SS2.SSS2.p1.3.m3.1.1.3.1.cmml" xref="S4.SS2.SSS2.p1.3.m3.1.1.3.1"></times><cn type="integer" id="S4.SS2.SSS2.p1.3.m3.1.1.3.2.cmml" xref="S4.SS2.SSS2.p1.3.m3.1.1.3.2">2</cn><ci id="S4.SS2.SSS2.p1.3.m3.1.1.3.3.cmml" xref="S4.SS2.SSS2.p1.3.m3.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.3.m3.1c">i\leq 2d</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p1.3.m3.1d">italic_i ≤ 2 italic_d</annotation></semantics></math>), and <math id="S4.SS2.SSS2.p1.4.m4.1" class="ltx_Math" alttext="t_{j}" display="inline"><semantics id="S4.SS2.SSS2.p1.4.m4.1a"><msub id="S4.SS2.SSS2.p1.4.m4.1.1" xref="S4.SS2.SSS2.p1.4.m4.1.1.cmml"><mi id="S4.SS2.SSS2.p1.4.m4.1.1.2" xref="S4.SS2.SSS2.p1.4.m4.1.1.2.cmml">t</mi><mi id="S4.SS2.SSS2.p1.4.m4.1.1.3" xref="S4.SS2.SSS2.p1.4.m4.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.4.m4.1b"><apply id="S4.SS2.SSS2.p1.4.m4.1.1.cmml" xref="S4.SS2.SSS2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p1.4.m4.1.1.1.cmml" xref="S4.SS2.SSS2.p1.4.m4.1.1">subscript</csymbol><ci id="S4.SS2.SSS2.p1.4.m4.1.1.2.cmml" xref="S4.SS2.SSS2.p1.4.m4.1.1.2">𝑡</ci><ci id="S4.SS2.SSS2.p1.4.m4.1.1.3.cmml" xref="S4.SS2.SSS2.p1.4.m4.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.4.m4.1c">t_{j}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p1.4.m4.1d">italic_t start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> is the visit timestamp for <math id="S4.SS2.SSS2.p1.5.m5.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S4.SS2.SSS2.p1.5.m5.1a"><mi id="S4.SS2.SSS2.p1.5.m5.1.1" xref="S4.SS2.SSS2.p1.5.m5.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.5.m5.1b"><ci id="S4.SS2.SSS2.p1.5.m5.1.1.cmml" xref="S4.SS2.SSS2.p1.5.m5.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.5.m5.1c">j</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p1.5.m5.1d">italic_j</annotation></semantics></math>-th check-in record.</p>
</div>
<div id="S4.SS2.SSS2.p2" class="ltx_para">
<p id="S4.SS2.SSS2.p2.1" class="ltx_p">Therefore, for any two POIs or categories in the sequence, the relative visit time information can be captured by:</p>
<table id="S4.E5" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E5.m1.2" class="ltx_Math" alttext="PE\left(t_{j}\right)PE\left(t_{j}+\Delta_{t}\right)^{\mathsf{T}}=\sum_{i=1}^{d%
}\cos\left(w_{i}\Delta_{t}\right)." display="block"><semantics id="S4.E5.m1.2a"><mrow id="S4.E5.m1.2.2.1" xref="S4.E5.m1.2.2.1.1.cmml"><mrow id="S4.E5.m1.2.2.1.1" xref="S4.E5.m1.2.2.1.1.cmml"><mrow id="S4.E5.m1.2.2.1.1.2" xref="S4.E5.m1.2.2.1.1.2.cmml"><mi id="S4.E5.m1.2.2.1.1.2.4" xref="S4.E5.m1.2.2.1.1.2.4.cmml">P</mi><mo id="S4.E5.m1.2.2.1.1.2.3" xref="S4.E5.m1.2.2.1.1.2.3.cmml">⁢</mo><mi id="S4.E5.m1.2.2.1.1.2.5" xref="S4.E5.m1.2.2.1.1.2.5.cmml">E</mi><mo id="S4.E5.m1.2.2.1.1.2.3a" xref="S4.E5.m1.2.2.1.1.2.3.cmml">⁢</mo><mrow id="S4.E5.m1.2.2.1.1.1.1.1" xref="S4.E5.m1.2.2.1.1.1.1.1.1.cmml"><mo id="S4.E5.m1.2.2.1.1.1.1.1.2" xref="S4.E5.m1.2.2.1.1.1.1.1.1.cmml">(</mo><msub id="S4.E5.m1.2.2.1.1.1.1.1.1" xref="S4.E5.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S4.E5.m1.2.2.1.1.1.1.1.1.2" xref="S4.E5.m1.2.2.1.1.1.1.1.1.2.cmml">t</mi><mi id="S4.E5.m1.2.2.1.1.1.1.1.1.3" xref="S4.E5.m1.2.2.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="S4.E5.m1.2.2.1.1.1.1.1.3" xref="S4.E5.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S4.E5.m1.2.2.1.1.2.3b" xref="S4.E5.m1.2.2.1.1.2.3.cmml">⁢</mo><mi id="S4.E5.m1.2.2.1.1.2.6" xref="S4.E5.m1.2.2.1.1.2.6.cmml">P</mi><mo id="S4.E5.m1.2.2.1.1.2.3c" xref="S4.E5.m1.2.2.1.1.2.3.cmml">⁢</mo><mi id="S4.E5.m1.2.2.1.1.2.7" xref="S4.E5.m1.2.2.1.1.2.7.cmml">E</mi><mo id="S4.E5.m1.2.2.1.1.2.3d" xref="S4.E5.m1.2.2.1.1.2.3.cmml">⁢</mo><msup id="S4.E5.m1.2.2.1.1.2.2" xref="S4.E5.m1.2.2.1.1.2.2.cmml"><mrow id="S4.E5.m1.2.2.1.1.2.2.1.1" xref="S4.E5.m1.2.2.1.1.2.2.1.1.1.cmml"><mo id="S4.E5.m1.2.2.1.1.2.2.1.1.2" xref="S4.E5.m1.2.2.1.1.2.2.1.1.1.cmml">(</mo><mrow id="S4.E5.m1.2.2.1.1.2.2.1.1.1" xref="S4.E5.m1.2.2.1.1.2.2.1.1.1.cmml"><msub id="S4.E5.m1.2.2.1.1.2.2.1.1.1.2" xref="S4.E5.m1.2.2.1.1.2.2.1.1.1.2.cmml"><mi id="S4.E5.m1.2.2.1.1.2.2.1.1.1.2.2" xref="S4.E5.m1.2.2.1.1.2.2.1.1.1.2.2.cmml">t</mi><mi id="S4.E5.m1.2.2.1.1.2.2.1.1.1.2.3" xref="S4.E5.m1.2.2.1.1.2.2.1.1.1.2.3.cmml">j</mi></msub><mo id="S4.E5.m1.2.2.1.1.2.2.1.1.1.1" xref="S4.E5.m1.2.2.1.1.2.2.1.1.1.1.cmml">+</mo><msub id="S4.E5.m1.2.2.1.1.2.2.1.1.1.3" xref="S4.E5.m1.2.2.1.1.2.2.1.1.1.3.cmml"><mi mathvariant="normal" id="S4.E5.m1.2.2.1.1.2.2.1.1.1.3.2" xref="S4.E5.m1.2.2.1.1.2.2.1.1.1.3.2.cmml">Δ</mi><mi id="S4.E5.m1.2.2.1.1.2.2.1.1.1.3.3" xref="S4.E5.m1.2.2.1.1.2.2.1.1.1.3.3.cmml">t</mi></msub></mrow><mo id="S4.E5.m1.2.2.1.1.2.2.1.1.3" xref="S4.E5.m1.2.2.1.1.2.2.1.1.1.cmml">)</mo></mrow><mi id="S4.E5.m1.2.2.1.1.2.2.3" xref="S4.E5.m1.2.2.1.1.2.2.3.cmml">𝖳</mi></msup></mrow><mo id="S4.E5.m1.2.2.1.1.4" xref="S4.E5.m1.2.2.1.1.4.cmml">=</mo><mrow id="S4.E5.m1.2.2.1.1.3" xref="S4.E5.m1.2.2.1.1.3.cmml"><munderover id="S4.E5.m1.2.2.1.1.3.2" xref="S4.E5.m1.2.2.1.1.3.2.cmml"><mo largeop="true" movablelimits="false" symmetric="true" id="S4.E5.m1.2.2.1.1.3.2.2.2" xref="S4.E5.m1.2.2.1.1.3.2.2.2.cmml">∑</mo><mrow id="S4.E5.m1.2.2.1.1.3.2.2.3" xref="S4.E5.m1.2.2.1.1.3.2.2.3.cmml"><mi id="S4.E5.m1.2.2.1.1.3.2.2.3.2" xref="S4.E5.m1.2.2.1.1.3.2.2.3.2.cmml">i</mi><mo id="S4.E5.m1.2.2.1.1.3.2.2.3.1" xref="S4.E5.m1.2.2.1.1.3.2.2.3.1.cmml">=</mo><mn id="S4.E5.m1.2.2.1.1.3.2.2.3.3" xref="S4.E5.m1.2.2.1.1.3.2.2.3.3.cmml">1</mn></mrow><mi id="S4.E5.m1.2.2.1.1.3.2.3" xref="S4.E5.m1.2.2.1.1.3.2.3.cmml">d</mi></munderover><mrow id="S4.E5.m1.2.2.1.1.3.1.1" xref="S4.E5.m1.2.2.1.1.3.1.2.cmml"><mi id="S4.E5.m1.1.1" xref="S4.E5.m1.1.1.cmml">cos</mi><mo id="S4.E5.m1.2.2.1.1.3.1.1a" xref="S4.E5.m1.2.2.1.1.3.1.2.cmml">⁡</mo><mrow id="S4.E5.m1.2.2.1.1.3.1.1.1" xref="S4.E5.m1.2.2.1.1.3.1.2.cmml"><mo id="S4.E5.m1.2.2.1.1.3.1.1.1.2" xref="S4.E5.m1.2.2.1.1.3.1.2.cmml">(</mo><mrow id="S4.E5.m1.2.2.1.1.3.1.1.1.1" xref="S4.E5.m1.2.2.1.1.3.1.1.1.1.cmml"><msub id="S4.E5.m1.2.2.1.1.3.1.1.1.1.2" xref="S4.E5.m1.2.2.1.1.3.1.1.1.1.2.cmml"><mi id="S4.E5.m1.2.2.1.1.3.1.1.1.1.2.2" xref="S4.E5.m1.2.2.1.1.3.1.1.1.1.2.2.cmml">w</mi><mi id="S4.E5.m1.2.2.1.1.3.1.1.1.1.2.3" xref="S4.E5.m1.2.2.1.1.3.1.1.1.1.2.3.cmml">i</mi></msub><mo id="S4.E5.m1.2.2.1.1.3.1.1.1.1.1" xref="S4.E5.m1.2.2.1.1.3.1.1.1.1.1.cmml">⁢</mo><msub id="S4.E5.m1.2.2.1.1.3.1.1.1.1.3" xref="S4.E5.m1.2.2.1.1.3.1.1.1.1.3.cmml"><mi mathvariant="normal" id="S4.E5.m1.2.2.1.1.3.1.1.1.1.3.2" xref="S4.E5.m1.2.2.1.1.3.1.1.1.1.3.2.cmml">Δ</mi><mi id="S4.E5.m1.2.2.1.1.3.1.1.1.1.3.3" xref="S4.E5.m1.2.2.1.1.3.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo id="S4.E5.m1.2.2.1.1.3.1.1.1.3" xref="S4.E5.m1.2.2.1.1.3.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S4.E5.m1.2.2.1.2" xref="S4.E5.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E5.m1.2b"><apply id="S4.E5.m1.2.2.1.1.cmml" xref="S4.E5.m1.2.2.1"><eq id="S4.E5.m1.2.2.1.1.4.cmml" xref="S4.E5.m1.2.2.1.1.4"></eq><apply id="S4.E5.m1.2.2.1.1.2.cmml" xref="S4.E5.m1.2.2.1.1.2"><times id="S4.E5.m1.2.2.1.1.2.3.cmml" xref="S4.E5.m1.2.2.1.1.2.3"></times><ci id="S4.E5.m1.2.2.1.1.2.4.cmml" xref="S4.E5.m1.2.2.1.1.2.4">𝑃</ci><ci id="S4.E5.m1.2.2.1.1.2.5.cmml" xref="S4.E5.m1.2.2.1.1.2.5">𝐸</ci><apply id="S4.E5.m1.2.2.1.1.1.1.1.1.cmml" xref="S4.E5.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E5.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.2.2.1.1.1.1.1">subscript</csymbol><ci id="S4.E5.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S4.E5.m1.2.2.1.1.1.1.1.1.2">𝑡</ci><ci id="S4.E5.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S4.E5.m1.2.2.1.1.1.1.1.1.3">𝑗</ci></apply><ci id="S4.E5.m1.2.2.1.1.2.6.cmml" xref="S4.E5.m1.2.2.1.1.2.6">𝑃</ci><ci id="S4.E5.m1.2.2.1.1.2.7.cmml" xref="S4.E5.m1.2.2.1.1.2.7">𝐸</ci><apply id="S4.E5.m1.2.2.1.1.2.2.cmml" xref="S4.E5.m1.2.2.1.1.2.2"><csymbol cd="ambiguous" id="S4.E5.m1.2.2.1.1.2.2.2.cmml" xref="S4.E5.m1.2.2.1.1.2.2">superscript</csymbol><apply id="S4.E5.m1.2.2.1.1.2.2.1.1.1.cmml" xref="S4.E5.m1.2.2.1.1.2.2.1.1"><plus id="S4.E5.m1.2.2.1.1.2.2.1.1.1.1.cmml" xref="S4.E5.m1.2.2.1.1.2.2.1.1.1.1"></plus><apply id="S4.E5.m1.2.2.1.1.2.2.1.1.1.2.cmml" xref="S4.E5.m1.2.2.1.1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S4.E5.m1.2.2.1.1.2.2.1.1.1.2.1.cmml" xref="S4.E5.m1.2.2.1.1.2.2.1.1.1.2">subscript</csymbol><ci id="S4.E5.m1.2.2.1.1.2.2.1.1.1.2.2.cmml" xref="S4.E5.m1.2.2.1.1.2.2.1.1.1.2.2">𝑡</ci><ci id="S4.E5.m1.2.2.1.1.2.2.1.1.1.2.3.cmml" xref="S4.E5.m1.2.2.1.1.2.2.1.1.1.2.3">𝑗</ci></apply><apply id="S4.E5.m1.2.2.1.1.2.2.1.1.1.3.cmml" xref="S4.E5.m1.2.2.1.1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S4.E5.m1.2.2.1.1.2.2.1.1.1.3.1.cmml" xref="S4.E5.m1.2.2.1.1.2.2.1.1.1.3">subscript</csymbol><ci id="S4.E5.m1.2.2.1.1.2.2.1.1.1.3.2.cmml" xref="S4.E5.m1.2.2.1.1.2.2.1.1.1.3.2">Δ</ci><ci id="S4.E5.m1.2.2.1.1.2.2.1.1.1.3.3.cmml" xref="S4.E5.m1.2.2.1.1.2.2.1.1.1.3.3">𝑡</ci></apply></apply><ci id="S4.E5.m1.2.2.1.1.2.2.3.cmml" xref="S4.E5.m1.2.2.1.1.2.2.3">𝖳</ci></apply></apply><apply id="S4.E5.m1.2.2.1.1.3.cmml" xref="S4.E5.m1.2.2.1.1.3"><apply id="S4.E5.m1.2.2.1.1.3.2.cmml" xref="S4.E5.m1.2.2.1.1.3.2"><csymbol cd="ambiguous" id="S4.E5.m1.2.2.1.1.3.2.1.cmml" xref="S4.E5.m1.2.2.1.1.3.2">superscript</csymbol><apply id="S4.E5.m1.2.2.1.1.3.2.2.cmml" xref="S4.E5.m1.2.2.1.1.3.2"><csymbol cd="ambiguous" id="S4.E5.m1.2.2.1.1.3.2.2.1.cmml" xref="S4.E5.m1.2.2.1.1.3.2">subscript</csymbol><sum id="S4.E5.m1.2.2.1.1.3.2.2.2.cmml" xref="S4.E5.m1.2.2.1.1.3.2.2.2"></sum><apply id="S4.E5.m1.2.2.1.1.3.2.2.3.cmml" xref="S4.E5.m1.2.2.1.1.3.2.2.3"><eq id="S4.E5.m1.2.2.1.1.3.2.2.3.1.cmml" xref="S4.E5.m1.2.2.1.1.3.2.2.3.1"></eq><ci id="S4.E5.m1.2.2.1.1.3.2.2.3.2.cmml" xref="S4.E5.m1.2.2.1.1.3.2.2.3.2">𝑖</ci><cn type="integer" id="S4.E5.m1.2.2.1.1.3.2.2.3.3.cmml" xref="S4.E5.m1.2.2.1.1.3.2.2.3.3">1</cn></apply></apply><ci id="S4.E5.m1.2.2.1.1.3.2.3.cmml" xref="S4.E5.m1.2.2.1.1.3.2.3">𝑑</ci></apply><apply id="S4.E5.m1.2.2.1.1.3.1.2.cmml" xref="S4.E5.m1.2.2.1.1.3.1.1"><cos id="S4.E5.m1.1.1.cmml" xref="S4.E5.m1.1.1"></cos><apply id="S4.E5.m1.2.2.1.1.3.1.1.1.1.cmml" xref="S4.E5.m1.2.2.1.1.3.1.1.1.1"><times id="S4.E5.m1.2.2.1.1.3.1.1.1.1.1.cmml" xref="S4.E5.m1.2.2.1.1.3.1.1.1.1.1"></times><apply id="S4.E5.m1.2.2.1.1.3.1.1.1.1.2.cmml" xref="S4.E5.m1.2.2.1.1.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E5.m1.2.2.1.1.3.1.1.1.1.2.1.cmml" xref="S4.E5.m1.2.2.1.1.3.1.1.1.1.2">subscript</csymbol><ci id="S4.E5.m1.2.2.1.1.3.1.1.1.1.2.2.cmml" xref="S4.E5.m1.2.2.1.1.3.1.1.1.1.2.2">𝑤</ci><ci id="S4.E5.m1.2.2.1.1.3.1.1.1.1.2.3.cmml" xref="S4.E5.m1.2.2.1.1.3.1.1.1.1.2.3">𝑖</ci></apply><apply id="S4.E5.m1.2.2.1.1.3.1.1.1.1.3.cmml" xref="S4.E5.m1.2.2.1.1.3.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E5.m1.2.2.1.1.3.1.1.1.1.3.1.cmml" xref="S4.E5.m1.2.2.1.1.3.1.1.1.1.3">subscript</csymbol><ci id="S4.E5.m1.2.2.1.1.3.1.1.1.1.3.2.cmml" xref="S4.E5.m1.2.2.1.1.3.1.1.1.1.3.2">Δ</ci><ci id="S4.E5.m1.2.2.1.1.3.1.1.1.1.3.3.cmml" xref="S4.E5.m1.2.2.1.1.3.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E5.m1.2c">PE\left(t_{j}\right)PE\left(t_{j}+\Delta_{t}\right)^{\mathsf{T}}=\sum_{i=1}^{d%
}\cos\left(w_{i}\Delta_{t}\right).</annotation><annotation encoding="application/x-llamapun" id="S4.E5.m1.2d">italic_P italic_E ( italic_t start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) italic_P italic_E ( italic_t start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT + roman_Δ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT sansserif_T end_POSTSUPERSCRIPT = ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT roman_cos ( italic_w start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT roman_Δ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr>
</table>
</div>
<div id="S4.SS2.SSS2.p3" class="ltx_para">
<p id="S4.SS2.SSS2.p3.3" class="ltx_p">We use the improved temporal-aware transformer encoder as trajectory encoder <math id="S4.SS2.SSS2.p3.1.m1.1" class="ltx_Math" alttext="f_{\phi}(\cdot)" display="inline"><semantics id="S4.SS2.SSS2.p3.1.m1.1a"><mrow id="S4.SS2.SSS2.p3.1.m1.1.2" xref="S4.SS2.SSS2.p3.1.m1.1.2.cmml"><msub id="S4.SS2.SSS2.p3.1.m1.1.2.2" xref="S4.SS2.SSS2.p3.1.m1.1.2.2.cmml"><mi id="S4.SS2.SSS2.p3.1.m1.1.2.2.2" xref="S4.SS2.SSS2.p3.1.m1.1.2.2.2.cmml">f</mi><mi id="S4.SS2.SSS2.p3.1.m1.1.2.2.3" xref="S4.SS2.SSS2.p3.1.m1.1.2.2.3.cmml">ϕ</mi></msub><mo id="S4.SS2.SSS2.p3.1.m1.1.2.1" xref="S4.SS2.SSS2.p3.1.m1.1.2.1.cmml">⁢</mo><mrow id="S4.SS2.SSS2.p3.1.m1.1.2.3.2" xref="S4.SS2.SSS2.p3.1.m1.1.2.cmml"><mo stretchy="false" id="S4.SS2.SSS2.p3.1.m1.1.2.3.2.1" xref="S4.SS2.SSS2.p3.1.m1.1.2.cmml">(</mo><mo id="S4.SS2.SSS2.p3.1.m1.1.1" xref="S4.SS2.SSS2.p3.1.m1.1.1.cmml">⋅</mo><mo stretchy="false" id="S4.SS2.SSS2.p3.1.m1.1.2.3.2.2" xref="S4.SS2.SSS2.p3.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p3.1.m1.1b"><apply id="S4.SS2.SSS2.p3.1.m1.1.2.cmml" xref="S4.SS2.SSS2.p3.1.m1.1.2"><times id="S4.SS2.SSS2.p3.1.m1.1.2.1.cmml" xref="S4.SS2.SSS2.p3.1.m1.1.2.1"></times><apply id="S4.SS2.SSS2.p3.1.m1.1.2.2.cmml" xref="S4.SS2.SSS2.p3.1.m1.1.2.2"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p3.1.m1.1.2.2.1.cmml" xref="S4.SS2.SSS2.p3.1.m1.1.2.2">subscript</csymbol><ci id="S4.SS2.SSS2.p3.1.m1.1.2.2.2.cmml" xref="S4.SS2.SSS2.p3.1.m1.1.2.2.2">𝑓</ci><ci id="S4.SS2.SSS2.p3.1.m1.1.2.2.3.cmml" xref="S4.SS2.SSS2.p3.1.m1.1.2.2.3">italic-ϕ</ci></apply><ci id="S4.SS2.SSS2.p3.1.m1.1.1.cmml" xref="S4.SS2.SSS2.p3.1.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p3.1.m1.1c">f_{\phi}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p3.1.m1.1d">italic_f start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( ⋅ )</annotation></semantics></math> for the augmented long-term trajectory. Similarly, a shared encoder <math id="S4.SS2.SSS2.p3.2.m2.1" class="ltx_Math" alttext="f_{\phi}(\cdot)" display="inline"><semantics id="S4.SS2.SSS2.p3.2.m2.1a"><mrow id="S4.SS2.SSS2.p3.2.m2.1.2" xref="S4.SS2.SSS2.p3.2.m2.1.2.cmml"><msub id="S4.SS2.SSS2.p3.2.m2.1.2.2" xref="S4.SS2.SSS2.p3.2.m2.1.2.2.cmml"><mi id="S4.SS2.SSS2.p3.2.m2.1.2.2.2" xref="S4.SS2.SSS2.p3.2.m2.1.2.2.2.cmml">f</mi><mi id="S4.SS2.SSS2.p3.2.m2.1.2.2.3" xref="S4.SS2.SSS2.p3.2.m2.1.2.2.3.cmml">ϕ</mi></msub><mo id="S4.SS2.SSS2.p3.2.m2.1.2.1" xref="S4.SS2.SSS2.p3.2.m2.1.2.1.cmml">⁢</mo><mrow id="S4.SS2.SSS2.p3.2.m2.1.2.3.2" xref="S4.SS2.SSS2.p3.2.m2.1.2.cmml"><mo stretchy="false" id="S4.SS2.SSS2.p3.2.m2.1.2.3.2.1" xref="S4.SS2.SSS2.p3.2.m2.1.2.cmml">(</mo><mo id="S4.SS2.SSS2.p3.2.m2.1.1" xref="S4.SS2.SSS2.p3.2.m2.1.1.cmml">⋅</mo><mo stretchy="false" id="S4.SS2.SSS2.p3.2.m2.1.2.3.2.2" xref="S4.SS2.SSS2.p3.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p3.2.m2.1b"><apply id="S4.SS2.SSS2.p3.2.m2.1.2.cmml" xref="S4.SS2.SSS2.p3.2.m2.1.2"><times id="S4.SS2.SSS2.p3.2.m2.1.2.1.cmml" xref="S4.SS2.SSS2.p3.2.m2.1.2.1"></times><apply id="S4.SS2.SSS2.p3.2.m2.1.2.2.cmml" xref="S4.SS2.SSS2.p3.2.m2.1.2.2"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p3.2.m2.1.2.2.1.cmml" xref="S4.SS2.SSS2.p3.2.m2.1.2.2">subscript</csymbol><ci id="S4.SS2.SSS2.p3.2.m2.1.2.2.2.cmml" xref="S4.SS2.SSS2.p3.2.m2.1.2.2.2">𝑓</ci><ci id="S4.SS2.SSS2.p3.2.m2.1.2.2.3.cmml" xref="S4.SS2.SSS2.p3.2.m2.1.2.2.3">italic-ϕ</ci></apply><ci id="S4.SS2.SSS2.p3.2.m2.1.1.cmml" xref="S4.SS2.SSS2.p3.2.m2.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p3.2.m2.1c">f_{\phi}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p3.2.m2.1d">italic_f start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( ⋅ )</annotation></semantics></math> is used to process the check-in POI and category sequences, and pooling the embedded tokens of last layer to obtain the latent representations of the two sequences. Next, we also use a learnable parameter <math id="S4.SS2.SSS2.p3.3.m3.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S4.SS2.SSS2.p3.3.m3.1a"><mi id="S4.SS2.SSS2.p3.3.m3.1.1" xref="S4.SS2.SSS2.p3.3.m3.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p3.3.m3.1b"><ci id="S4.SS2.SSS2.p3.3.m3.1.1.cmml" xref="S4.SS2.SSS2.p3.3.m3.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p3.3.m3.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p3.3.m3.1d">italic_β</annotation></semantics></math> to balance the weights of the two representations to obtain the final representation for the augmented long-term trajectory through a MLP predictor:</p>
<table id="S4.E6" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E6.m1.1" class="ltx_Math" alttext="z_{au}^{\phi}=MLP(\beta\cdot f_{\phi}(\mathbf{X}_{au}^{p})+(1-\beta)\cdot f_{%
\phi}(\mathbf{X}_{au}^{c}))," display="block"><semantics id="S4.E6.m1.1a"><mrow id="S4.E6.m1.1.1.1" xref="S4.E6.m1.1.1.1.1.cmml"><mrow id="S4.E6.m1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.cmml"><msubsup id="S4.E6.m1.1.1.1.1.3" xref="S4.E6.m1.1.1.1.1.3.cmml"><mi id="S4.E6.m1.1.1.1.1.3.2.2" xref="S4.E6.m1.1.1.1.1.3.2.2.cmml">z</mi><mrow id="S4.E6.m1.1.1.1.1.3.2.3" xref="S4.E6.m1.1.1.1.1.3.2.3.cmml"><mi id="S4.E6.m1.1.1.1.1.3.2.3.2" xref="S4.E6.m1.1.1.1.1.3.2.3.2.cmml">a</mi><mo id="S4.E6.m1.1.1.1.1.3.2.3.1" xref="S4.E6.m1.1.1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S4.E6.m1.1.1.1.1.3.2.3.3" xref="S4.E6.m1.1.1.1.1.3.2.3.3.cmml">u</mi></mrow><mi id="S4.E6.m1.1.1.1.1.3.3" xref="S4.E6.m1.1.1.1.1.3.3.cmml">ϕ</mi></msubsup><mo id="S4.E6.m1.1.1.1.1.2" xref="S4.E6.m1.1.1.1.1.2.cmml">=</mo><mrow id="S4.E6.m1.1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.1.cmml"><mi id="S4.E6.m1.1.1.1.1.1.3" xref="S4.E6.m1.1.1.1.1.1.3.cmml">M</mi><mo id="S4.E6.m1.1.1.1.1.1.2" xref="S4.E6.m1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S4.E6.m1.1.1.1.1.1.4" xref="S4.E6.m1.1.1.1.1.1.4.cmml">L</mi><mo id="S4.E6.m1.1.1.1.1.1.2a" xref="S4.E6.m1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S4.E6.m1.1.1.1.1.1.5" xref="S4.E6.m1.1.1.1.1.1.5.cmml">P</mi><mo id="S4.E6.m1.1.1.1.1.1.2b" xref="S4.E6.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E6.m1.1.1.1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E6.m1.1.1.1.1.1.1.1.2" xref="S4.E6.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E6.m1.1.1.1.1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.1.1.1.1.cmml"><mrow id="S4.E6.m1.1.1.1.1.1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S4.E6.m1.1.1.1.1.1.1.1.1.1.3" xref="S4.E6.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E6.m1.1.1.1.1.1.1.1.1.1.3.2" xref="S4.E6.m1.1.1.1.1.1.1.1.1.1.3.2.cmml">β</mi><mo id="S4.E6.m1.1.1.1.1.1.1.1.1.1.3.1" xref="S4.E6.m1.1.1.1.1.1.1.1.1.1.3.1.cmml">⋅</mo><msub id="S4.E6.m1.1.1.1.1.1.1.1.1.1.3.3" xref="S4.E6.m1.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S4.E6.m1.1.1.1.1.1.1.1.1.1.3.3.2" xref="S4.E6.m1.1.1.1.1.1.1.1.1.1.3.3.2.cmml">f</mi><mi id="S4.E6.m1.1.1.1.1.1.1.1.1.1.3.3.3" xref="S4.E6.m1.1.1.1.1.1.1.1.1.1.3.3.3.cmml">ϕ</mi></msub></mrow><mo id="S4.E6.m1.1.1.1.1.1.1.1.1.1.2" xref="S4.E6.m1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E6.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E6.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S4.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S4.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐗</mi><mrow id="S4.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S4.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S4.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2" xref="S4.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml">a</mi><mo id="S4.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1" xref="S4.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S4.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3" xref="S4.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml">u</mi></mrow><mi id="S4.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">p</mi></msubsup><mo stretchy="false" id="S4.E6.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E6.m1.1.1.1.1.1.1.1.1.4" xref="S4.E6.m1.1.1.1.1.1.1.1.1.4.cmml">+</mo><mrow id="S4.E6.m1.1.1.1.1.1.1.1.1.3" xref="S4.E6.m1.1.1.1.1.1.1.1.1.3.cmml"><mrow id="S4.E6.m1.1.1.1.1.1.1.1.1.2.1" xref="S4.E6.m1.1.1.1.1.1.1.1.1.2.1.cmml"><mrow id="S4.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1" xref="S4.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.cmml"><mo stretchy="false" id="S4.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.2" xref="S4.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.cmml">(</mo><mrow id="S4.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.1" xref="S4.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.cmml"><mn id="S4.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.2" xref="S4.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.2.cmml">1</mn><mo id="S4.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.cmml">-</mo><mi id="S4.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.3" xref="S4.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.3.cmml">β</mi></mrow><mo stretchy="false" id="S4.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.3" xref="S4.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.cmml">)</mo></mrow><mo id="S4.E6.m1.1.1.1.1.1.1.1.1.2.1.2" xref="S4.E6.m1.1.1.1.1.1.1.1.1.2.1.2.cmml">⋅</mo><msub id="S4.E6.m1.1.1.1.1.1.1.1.1.2.1.3" xref="S4.E6.m1.1.1.1.1.1.1.1.1.2.1.3.cmml"><mi id="S4.E6.m1.1.1.1.1.1.1.1.1.2.1.3.2" xref="S4.E6.m1.1.1.1.1.1.1.1.1.2.1.3.2.cmml">f</mi><mi id="S4.E6.m1.1.1.1.1.1.1.1.1.2.1.3.3" xref="S4.E6.m1.1.1.1.1.1.1.1.1.2.1.3.3.cmml">ϕ</mi></msub></mrow><mo id="S4.E6.m1.1.1.1.1.1.1.1.1.3.3" xref="S4.E6.m1.1.1.1.1.1.1.1.1.3.3.cmml">⁢</mo><mrow id="S4.E6.m1.1.1.1.1.1.1.1.1.3.2.1" xref="S4.E6.m1.1.1.1.1.1.1.1.1.3.2.1.1.cmml"><mo stretchy="false" id="S4.E6.m1.1.1.1.1.1.1.1.1.3.2.1.2" xref="S4.E6.m1.1.1.1.1.1.1.1.1.3.2.1.1.cmml">(</mo><msubsup id="S4.E6.m1.1.1.1.1.1.1.1.1.3.2.1.1" xref="S4.E6.m1.1.1.1.1.1.1.1.1.3.2.1.1.cmml"><mi id="S4.E6.m1.1.1.1.1.1.1.1.1.3.2.1.1.2.2" xref="S4.E6.m1.1.1.1.1.1.1.1.1.3.2.1.1.2.2.cmml">𝐗</mi><mrow id="S4.E6.m1.1.1.1.1.1.1.1.1.3.2.1.1.2.3" xref="S4.E6.m1.1.1.1.1.1.1.1.1.3.2.1.1.2.3.cmml"><mi id="S4.E6.m1.1.1.1.1.1.1.1.1.3.2.1.1.2.3.2" xref="S4.E6.m1.1.1.1.1.1.1.1.1.3.2.1.1.2.3.2.cmml">a</mi><mo id="S4.E6.m1.1.1.1.1.1.1.1.1.3.2.1.1.2.3.1" xref="S4.E6.m1.1.1.1.1.1.1.1.1.3.2.1.1.2.3.1.cmml">⁢</mo><mi id="S4.E6.m1.1.1.1.1.1.1.1.1.3.2.1.1.2.3.3" xref="S4.E6.m1.1.1.1.1.1.1.1.1.3.2.1.1.2.3.3.cmml">u</mi></mrow><mi id="S4.E6.m1.1.1.1.1.1.1.1.1.3.2.1.1.3" xref="S4.E6.m1.1.1.1.1.1.1.1.1.3.2.1.1.3.cmml">c</mi></msubsup><mo stretchy="false" id="S4.E6.m1.1.1.1.1.1.1.1.1.3.2.1.3" xref="S4.E6.m1.1.1.1.1.1.1.1.1.3.2.1.1.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S4.E6.m1.1.1.1.1.1.1.1.3" xref="S4.E6.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E6.m1.1.1.1.2" xref="S4.E6.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E6.m1.1b"><apply id="S4.E6.m1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1"><eq id="S4.E6.m1.1.1.1.1.2.cmml" xref="S4.E6.m1.1.1.1.1.2"></eq><apply id="S4.E6.m1.1.1.1.1.3.cmml" xref="S4.E6.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E6.m1.1.1.1.1.3.1.cmml" xref="S4.E6.m1.1.1.1.1.3">superscript</csymbol><apply id="S4.E6.m1.1.1.1.1.3.2.cmml" xref="S4.E6.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E6.m1.1.1.1.1.3.2.1.cmml" xref="S4.E6.m1.1.1.1.1.3">subscript</csymbol><ci id="S4.E6.m1.1.1.1.1.3.2.2.cmml" xref="S4.E6.m1.1.1.1.1.3.2.2">𝑧</ci><apply id="S4.E6.m1.1.1.1.1.3.2.3.cmml" xref="S4.E6.m1.1.1.1.1.3.2.3"><times id="S4.E6.m1.1.1.1.1.3.2.3.1.cmml" xref="S4.E6.m1.1.1.1.1.3.2.3.1"></times><ci id="S4.E6.m1.1.1.1.1.3.2.3.2.cmml" xref="S4.E6.m1.1.1.1.1.3.2.3.2">𝑎</ci><ci id="S4.E6.m1.1.1.1.1.3.2.3.3.cmml" xref="S4.E6.m1.1.1.1.1.3.2.3.3">𝑢</ci></apply></apply><ci id="S4.E6.m1.1.1.1.1.3.3.cmml" xref="S4.E6.m1.1.1.1.1.3.3">italic-ϕ</ci></apply><apply id="S4.E6.m1.1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1.1.1"><times id="S4.E6.m1.1.1.1.1.1.2.cmml" xref="S4.E6.m1.1.1.1.1.1.2"></times><ci id="S4.E6.m1.1.1.1.1.1.3.cmml" xref="S4.E6.m1.1.1.1.1.1.3">𝑀</ci><ci id="S4.E6.m1.1.1.1.1.1.4.cmml" xref="S4.E6.m1.1.1.1.1.1.4">𝐿</ci><ci id="S4.E6.m1.1.1.1.1.1.5.cmml" xref="S4.E6.m1.1.1.1.1.1.5">𝑃</ci><apply id="S4.E6.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1"><plus id="S4.E6.m1.1.1.1.1.1.1.1.1.4.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1.4"></plus><apply id="S4.E6.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1.1"><times id="S4.E6.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1.1.2"></times><apply id="S4.E6.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1.1.3"><ci id="S4.E6.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1.1.3.1">⋅</ci><ci id="S4.E6.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1.1.3.2">𝛽</ci><apply id="S4.E6.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E6.m1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S4.E6.m1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1.1.3.3.2">𝑓</ci><ci id="S4.E6.m1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1.1.3.3.3">italic-ϕ</ci></apply></apply><apply id="S4.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S4.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝐗</ci><apply id="S4.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3"><times id="S4.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1"></times><ci id="S4.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2">𝑎</ci><ci id="S4.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3">𝑢</ci></apply></apply><ci id="S4.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑝</ci></apply></apply><apply id="S4.E6.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1.3"><times id="S4.E6.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1.3.3"></times><apply id="S4.E6.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1.2.1"><ci id="S4.E6.m1.1.1.1.1.1.1.1.1.2.1.2.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1.2.1.2">⋅</ci><apply id="S4.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1"><minus id="S4.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.1"></minus><cn type="integer" id="S4.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.2.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.2">1</cn><ci id="S4.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.3.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.3">𝛽</ci></apply><apply id="S4.E6.m1.1.1.1.1.1.1.1.1.2.1.3.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1.2.1.3"><csymbol cd="ambiguous" id="S4.E6.m1.1.1.1.1.1.1.1.1.2.1.3.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1.2.1.3">subscript</csymbol><ci id="S4.E6.m1.1.1.1.1.1.1.1.1.2.1.3.2.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1.2.1.3.2">𝑓</ci><ci id="S4.E6.m1.1.1.1.1.1.1.1.1.2.1.3.3.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1.2.1.3.3">italic-ϕ</ci></apply></apply><apply id="S4.E6.m1.1.1.1.1.1.1.1.1.3.2.1.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1.3.2.1"><csymbol cd="ambiguous" id="S4.E6.m1.1.1.1.1.1.1.1.1.3.2.1.1.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1.3.2.1">superscript</csymbol><apply id="S4.E6.m1.1.1.1.1.1.1.1.1.3.2.1.1.2.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1.3.2.1"><csymbol cd="ambiguous" id="S4.E6.m1.1.1.1.1.1.1.1.1.3.2.1.1.2.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1.3.2.1">subscript</csymbol><ci id="S4.E6.m1.1.1.1.1.1.1.1.1.3.2.1.1.2.2.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1.3.2.1.1.2.2">𝐗</ci><apply id="S4.E6.m1.1.1.1.1.1.1.1.1.3.2.1.1.2.3.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1.3.2.1.1.2.3"><times id="S4.E6.m1.1.1.1.1.1.1.1.1.3.2.1.1.2.3.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1.3.2.1.1.2.3.1"></times><ci id="S4.E6.m1.1.1.1.1.1.1.1.1.3.2.1.1.2.3.2.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1.3.2.1.1.2.3.2">𝑎</ci><ci id="S4.E6.m1.1.1.1.1.1.1.1.1.3.2.1.1.2.3.3.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1.3.2.1.1.2.3.3">𝑢</ci></apply></apply><ci id="S4.E6.m1.1.1.1.1.1.1.1.1.3.2.1.1.3.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1.3.2.1.1.3">𝑐</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E6.m1.1c">z_{au}^{\phi}=MLP(\beta\cdot f_{\phi}(\mathbf{X}_{au}^{p})+(1-\beta)\cdot f_{%
\phi}(\mathbf{X}_{au}^{c})),</annotation><annotation encoding="application/x-llamapun" id="S4.E6.m1.1d">italic_z start_POSTSUBSCRIPT italic_a italic_u end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_ϕ end_POSTSUPERSCRIPT = italic_M italic_L italic_P ( italic_β ⋅ italic_f start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( bold_X start_POSTSUBSCRIPT italic_a italic_u end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT ) + ( 1 - italic_β ) ⋅ italic_f start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( bold_X start_POSTSUBSCRIPT italic_a italic_u end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_c end_POSTSUPERSCRIPT ) ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr>
</table>
<p id="S4.SS2.SSS2.p3.5" class="ltx_p">where <math id="S4.SS2.SSS2.p3.4.m1.1" class="ltx_Math" alttext="\mathbf{X}_{au}^{p}" display="inline"><semantics id="S4.SS2.SSS2.p3.4.m1.1a"><msubsup id="S4.SS2.SSS2.p3.4.m1.1.1" xref="S4.SS2.SSS2.p3.4.m1.1.1.cmml"><mi id="S4.SS2.SSS2.p3.4.m1.1.1.2.2" xref="S4.SS2.SSS2.p3.4.m1.1.1.2.2.cmml">𝐗</mi><mrow id="S4.SS2.SSS2.p3.4.m1.1.1.2.3" xref="S4.SS2.SSS2.p3.4.m1.1.1.2.3.cmml"><mi id="S4.SS2.SSS2.p3.4.m1.1.1.2.3.2" xref="S4.SS2.SSS2.p3.4.m1.1.1.2.3.2.cmml">a</mi><mo id="S4.SS2.SSS2.p3.4.m1.1.1.2.3.1" xref="S4.SS2.SSS2.p3.4.m1.1.1.2.3.1.cmml">⁢</mo><mi id="S4.SS2.SSS2.p3.4.m1.1.1.2.3.3" xref="S4.SS2.SSS2.p3.4.m1.1.1.2.3.3.cmml">u</mi></mrow><mi id="S4.SS2.SSS2.p3.4.m1.1.1.3" xref="S4.SS2.SSS2.p3.4.m1.1.1.3.cmml">p</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p3.4.m1.1b"><apply id="S4.SS2.SSS2.p3.4.m1.1.1.cmml" xref="S4.SS2.SSS2.p3.4.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p3.4.m1.1.1.1.cmml" xref="S4.SS2.SSS2.p3.4.m1.1.1">superscript</csymbol><apply id="S4.SS2.SSS2.p3.4.m1.1.1.2.cmml" xref="S4.SS2.SSS2.p3.4.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p3.4.m1.1.1.2.1.cmml" xref="S4.SS2.SSS2.p3.4.m1.1.1">subscript</csymbol><ci id="S4.SS2.SSS2.p3.4.m1.1.1.2.2.cmml" xref="S4.SS2.SSS2.p3.4.m1.1.1.2.2">𝐗</ci><apply id="S4.SS2.SSS2.p3.4.m1.1.1.2.3.cmml" xref="S4.SS2.SSS2.p3.4.m1.1.1.2.3"><times id="S4.SS2.SSS2.p3.4.m1.1.1.2.3.1.cmml" xref="S4.SS2.SSS2.p3.4.m1.1.1.2.3.1"></times><ci id="S4.SS2.SSS2.p3.4.m1.1.1.2.3.2.cmml" xref="S4.SS2.SSS2.p3.4.m1.1.1.2.3.2">𝑎</ci><ci id="S4.SS2.SSS2.p3.4.m1.1.1.2.3.3.cmml" xref="S4.SS2.SSS2.p3.4.m1.1.1.2.3.3">𝑢</ci></apply></apply><ci id="S4.SS2.SSS2.p3.4.m1.1.1.3.cmml" xref="S4.SS2.SSS2.p3.4.m1.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p3.4.m1.1c">\mathbf{X}_{au}^{p}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p3.4.m1.1d">bold_X start_POSTSUBSCRIPT italic_a italic_u end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT</annotation></semantics></math> and <math id="S4.SS2.SSS2.p3.5.m2.1" class="ltx_Math" alttext="\mathbf{X}_{au}^{c}" display="inline"><semantics id="S4.SS2.SSS2.p3.5.m2.1a"><msubsup id="S4.SS2.SSS2.p3.5.m2.1.1" xref="S4.SS2.SSS2.p3.5.m2.1.1.cmml"><mi id="S4.SS2.SSS2.p3.5.m2.1.1.2.2" xref="S4.SS2.SSS2.p3.5.m2.1.1.2.2.cmml">𝐗</mi><mrow id="S4.SS2.SSS2.p3.5.m2.1.1.2.3" xref="S4.SS2.SSS2.p3.5.m2.1.1.2.3.cmml"><mi id="S4.SS2.SSS2.p3.5.m2.1.1.2.3.2" xref="S4.SS2.SSS2.p3.5.m2.1.1.2.3.2.cmml">a</mi><mo id="S4.SS2.SSS2.p3.5.m2.1.1.2.3.1" xref="S4.SS2.SSS2.p3.5.m2.1.1.2.3.1.cmml">⁢</mo><mi id="S4.SS2.SSS2.p3.5.m2.1.1.2.3.3" xref="S4.SS2.SSS2.p3.5.m2.1.1.2.3.3.cmml">u</mi></mrow><mi id="S4.SS2.SSS2.p3.5.m2.1.1.3" xref="S4.SS2.SSS2.p3.5.m2.1.1.3.cmml">c</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p3.5.m2.1b"><apply id="S4.SS2.SSS2.p3.5.m2.1.1.cmml" xref="S4.SS2.SSS2.p3.5.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p3.5.m2.1.1.1.cmml" xref="S4.SS2.SSS2.p3.5.m2.1.1">superscript</csymbol><apply id="S4.SS2.SSS2.p3.5.m2.1.1.2.cmml" xref="S4.SS2.SSS2.p3.5.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p3.5.m2.1.1.2.1.cmml" xref="S4.SS2.SSS2.p3.5.m2.1.1">subscript</csymbol><ci id="S4.SS2.SSS2.p3.5.m2.1.1.2.2.cmml" xref="S4.SS2.SSS2.p3.5.m2.1.1.2.2">𝐗</ci><apply id="S4.SS2.SSS2.p3.5.m2.1.1.2.3.cmml" xref="S4.SS2.SSS2.p3.5.m2.1.1.2.3"><times id="S4.SS2.SSS2.p3.5.m2.1.1.2.3.1.cmml" xref="S4.SS2.SSS2.p3.5.m2.1.1.2.3.1"></times><ci id="S4.SS2.SSS2.p3.5.m2.1.1.2.3.2.cmml" xref="S4.SS2.SSS2.p3.5.m2.1.1.2.3.2">𝑎</ci><ci id="S4.SS2.SSS2.p3.5.m2.1.1.2.3.3.cmml" xref="S4.SS2.SSS2.p3.5.m2.1.1.2.3.3">𝑢</ci></apply></apply><ci id="S4.SS2.SSS2.p3.5.m2.1.1.3.cmml" xref="S4.SS2.SSS2.p3.5.m2.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p3.5.m2.1c">\mathbf{X}_{au}^{c}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p3.5.m2.1d">bold_X start_POSTSUBSCRIPT italic_a italic_u end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_c end_POSTSUPERSCRIPT</annotation></semantics></math> denote the embeddings of check-in POI sequence and category sequence of augmented long-term trajectory, respectively.</p>
</div>
<div id="S4.SS2.SSS2.p4" class="ltx_para">
<p id="S4.SS2.SSS2.p4.2" class="ltx_p">Notice that the detailed formulations of encoders <math id="S4.SS2.SSS2.p4.1.m1.1" class="ltx_Math" alttext="f_{\theta}" display="inline"><semantics id="S4.SS2.SSS2.p4.1.m1.1a"><msub id="S4.SS2.SSS2.p4.1.m1.1.1" xref="S4.SS2.SSS2.p4.1.m1.1.1.cmml"><mi id="S4.SS2.SSS2.p4.1.m1.1.1.2" xref="S4.SS2.SSS2.p4.1.m1.1.1.2.cmml">f</mi><mi id="S4.SS2.SSS2.p4.1.m1.1.1.3" xref="S4.SS2.SSS2.p4.1.m1.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p4.1.m1.1b"><apply id="S4.SS2.SSS2.p4.1.m1.1.1.cmml" xref="S4.SS2.SSS2.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p4.1.m1.1.1.1.cmml" xref="S4.SS2.SSS2.p4.1.m1.1.1">subscript</csymbol><ci id="S4.SS2.SSS2.p4.1.m1.1.1.2.cmml" xref="S4.SS2.SSS2.p4.1.m1.1.1.2">𝑓</ci><ci id="S4.SS2.SSS2.p4.1.m1.1.1.3.cmml" xref="S4.SS2.SSS2.p4.1.m1.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p4.1.m1.1c">f_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p4.1.m1.1d">italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> and <math id="S4.SS2.SSS2.p4.2.m2.1" class="ltx_Math" alttext="f_{\phi}" display="inline"><semantics id="S4.SS2.SSS2.p4.2.m2.1a"><msub id="S4.SS2.SSS2.p4.2.m2.1.1" xref="S4.SS2.SSS2.p4.2.m2.1.1.cmml"><mi id="S4.SS2.SSS2.p4.2.m2.1.1.2" xref="S4.SS2.SSS2.p4.2.m2.1.1.2.cmml">f</mi><mi id="S4.SS2.SSS2.p4.2.m2.1.1.3" xref="S4.SS2.SSS2.p4.2.m2.1.1.3.cmml">ϕ</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p4.2.m2.1b"><apply id="S4.SS2.SSS2.p4.2.m2.1.1.cmml" xref="S4.SS2.SSS2.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p4.2.m2.1.1.1.cmml" xref="S4.SS2.SSS2.p4.2.m2.1.1">subscript</csymbol><ci id="S4.SS2.SSS2.p4.2.m2.1.1.2.cmml" xref="S4.SS2.SSS2.p4.2.m2.1.1.2">𝑓</ci><ci id="S4.SS2.SSS2.p4.2.m2.1.1.3.cmml" xref="S4.SS2.SSS2.p4.2.m2.1.1.3">italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p4.2.m2.1c">f_{\phi}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p4.2.m2.1d">italic_f start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT</annotation></semantics></math> can be found at Appendix<span id="footnote2" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>https://github.com/Onedean/MainTUL/tree/main/appendix</span></span></span></p>
</div>
</section>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Mutual Distillation Network</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.1" class="ltx_p">Different from the traditional knowledge distillation <cite class="ltx_cite ltx_citemacro_citep">(Hinton <span class="ltx_text ltx_font_italic">et al.</span>, <a href="#bib.bib5" title="" class="ltx_ref">2015</a>)</cite>, in this work, we do not strictly distinguish between teacher and student networks. Both are learning from scratch rather than compressing a new network from another deeper frozen model.</p>
</div>
<div id="S4.SS3.p2" class="ltx_para">
<p id="S4.SS3.p2.12" class="ltx_p">Let <math id="S4.SS3.p2.1.m1.1" class="ltx_Math" alttext="Tr_{in}" display="inline"><semantics id="S4.SS3.p2.1.m1.1a"><mrow id="S4.SS3.p2.1.m1.1.1" xref="S4.SS3.p2.1.m1.1.1.cmml"><mi id="S4.SS3.p2.1.m1.1.1.2" xref="S4.SS3.p2.1.m1.1.1.2.cmml">T</mi><mo id="S4.SS3.p2.1.m1.1.1.1" xref="S4.SS3.p2.1.m1.1.1.1.cmml">⁢</mo><msub id="S4.SS3.p2.1.m1.1.1.3" xref="S4.SS3.p2.1.m1.1.1.3.cmml"><mi id="S4.SS3.p2.1.m1.1.1.3.2" xref="S4.SS3.p2.1.m1.1.1.3.2.cmml">r</mi><mrow id="S4.SS3.p2.1.m1.1.1.3.3" xref="S4.SS3.p2.1.m1.1.1.3.3.cmml"><mi id="S4.SS3.p2.1.m1.1.1.3.3.2" xref="S4.SS3.p2.1.m1.1.1.3.3.2.cmml">i</mi><mo id="S4.SS3.p2.1.m1.1.1.3.3.1" xref="S4.SS3.p2.1.m1.1.1.3.3.1.cmml">⁢</mo><mi id="S4.SS3.p2.1.m1.1.1.3.3.3" xref="S4.SS3.p2.1.m1.1.1.3.3.3.cmml">n</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.1.m1.1b"><apply id="S4.SS3.p2.1.m1.1.1.cmml" xref="S4.SS3.p2.1.m1.1.1"><times id="S4.SS3.p2.1.m1.1.1.1.cmml" xref="S4.SS3.p2.1.m1.1.1.1"></times><ci id="S4.SS3.p2.1.m1.1.1.2.cmml" xref="S4.SS3.p2.1.m1.1.1.2">𝑇</ci><apply id="S4.SS3.p2.1.m1.1.1.3.cmml" xref="S4.SS3.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p2.1.m1.1.1.3.1.cmml" xref="S4.SS3.p2.1.m1.1.1.3">subscript</csymbol><ci id="S4.SS3.p2.1.m1.1.1.3.2.cmml" xref="S4.SS3.p2.1.m1.1.1.3.2">𝑟</ci><apply id="S4.SS3.p2.1.m1.1.1.3.3.cmml" xref="S4.SS3.p2.1.m1.1.1.3.3"><times id="S4.SS3.p2.1.m1.1.1.3.3.1.cmml" xref="S4.SS3.p2.1.m1.1.1.3.3.1"></times><ci id="S4.SS3.p2.1.m1.1.1.3.3.2.cmml" xref="S4.SS3.p2.1.m1.1.1.3.3.2">𝑖</ci><ci id="S4.SS3.p2.1.m1.1.1.3.3.3.cmml" xref="S4.SS3.p2.1.m1.1.1.3.3.3">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.1.m1.1c">Tr_{in}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.1.m1.1d">italic_T italic_r start_POSTSUBSCRIPT italic_i italic_n end_POSTSUBSCRIPT</annotation></semantics></math> and <math id="S4.SS3.p2.2.m2.1" class="ltx_Math" alttext="Tr_{au}" display="inline"><semantics id="S4.SS3.p2.2.m2.1a"><mrow id="S4.SS3.p2.2.m2.1.1" xref="S4.SS3.p2.2.m2.1.1.cmml"><mi id="S4.SS3.p2.2.m2.1.1.2" xref="S4.SS3.p2.2.m2.1.1.2.cmml">T</mi><mo id="S4.SS3.p2.2.m2.1.1.1" xref="S4.SS3.p2.2.m2.1.1.1.cmml">⁢</mo><msub id="S4.SS3.p2.2.m2.1.1.3" xref="S4.SS3.p2.2.m2.1.1.3.cmml"><mi id="S4.SS3.p2.2.m2.1.1.3.2" xref="S4.SS3.p2.2.m2.1.1.3.2.cmml">r</mi><mrow id="S4.SS3.p2.2.m2.1.1.3.3" xref="S4.SS3.p2.2.m2.1.1.3.3.cmml"><mi id="S4.SS3.p2.2.m2.1.1.3.3.2" xref="S4.SS3.p2.2.m2.1.1.3.3.2.cmml">a</mi><mo id="S4.SS3.p2.2.m2.1.1.3.3.1" xref="S4.SS3.p2.2.m2.1.1.3.3.1.cmml">⁢</mo><mi id="S4.SS3.p2.2.m2.1.1.3.3.3" xref="S4.SS3.p2.2.m2.1.1.3.3.3.cmml">u</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.2.m2.1b"><apply id="S4.SS3.p2.2.m2.1.1.cmml" xref="S4.SS3.p2.2.m2.1.1"><times id="S4.SS3.p2.2.m2.1.1.1.cmml" xref="S4.SS3.p2.2.m2.1.1.1"></times><ci id="S4.SS3.p2.2.m2.1.1.2.cmml" xref="S4.SS3.p2.2.m2.1.1.2">𝑇</ci><apply id="S4.SS3.p2.2.m2.1.1.3.cmml" xref="S4.SS3.p2.2.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p2.2.m2.1.1.3.1.cmml" xref="S4.SS3.p2.2.m2.1.1.3">subscript</csymbol><ci id="S4.SS3.p2.2.m2.1.1.3.2.cmml" xref="S4.SS3.p2.2.m2.1.1.3.2">𝑟</ci><apply id="S4.SS3.p2.2.m2.1.1.3.3.cmml" xref="S4.SS3.p2.2.m2.1.1.3.3"><times id="S4.SS3.p2.2.m2.1.1.3.3.1.cmml" xref="S4.SS3.p2.2.m2.1.1.3.3.1"></times><ci id="S4.SS3.p2.2.m2.1.1.3.3.2.cmml" xref="S4.SS3.p2.2.m2.1.1.3.3.2">𝑎</ci><ci id="S4.SS3.p2.2.m2.1.1.3.3.3.cmml" xref="S4.SS3.p2.2.m2.1.1.3.3.3">𝑢</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.2.m2.1c">Tr_{au}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.2.m2.1d">italic_T italic_r start_POSTSUBSCRIPT italic_a italic_u end_POSTSUBSCRIPT</annotation></semantics></math> represent the input trajectory and the augmented trajectory respectively. Trajectory encoder <math id="S4.SS3.p2.3.m3.1" class="ltx_Math" alttext="f_{\theta}" display="inline"><semantics id="S4.SS3.p2.3.m3.1a"><msub id="S4.SS3.p2.3.m3.1.1" xref="S4.SS3.p2.3.m3.1.1.cmml"><mi id="S4.SS3.p2.3.m3.1.1.2" xref="S4.SS3.p2.3.m3.1.1.2.cmml">f</mi><mi id="S4.SS3.p2.3.m3.1.1.3" xref="S4.SS3.p2.3.m3.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.3.m3.1b"><apply id="S4.SS3.p2.3.m3.1.1.cmml" xref="S4.SS3.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.3.m3.1.1.1.cmml" xref="S4.SS3.p2.3.m3.1.1">subscript</csymbol><ci id="S4.SS3.p2.3.m3.1.1.2.cmml" xref="S4.SS3.p2.3.m3.1.1.2">𝑓</ci><ci id="S4.SS3.p2.3.m3.1.1.3.cmml" xref="S4.SS3.p2.3.m3.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.3.m3.1c">f_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.3.m3.1d">italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> embeds <math id="S4.SS3.p2.4.m4.1" class="ltx_Math" alttext="Tr_{in}" display="inline"><semantics id="S4.SS3.p2.4.m4.1a"><mrow id="S4.SS3.p2.4.m4.1.1" xref="S4.SS3.p2.4.m4.1.1.cmml"><mi id="S4.SS3.p2.4.m4.1.1.2" xref="S4.SS3.p2.4.m4.1.1.2.cmml">T</mi><mo id="S4.SS3.p2.4.m4.1.1.1" xref="S4.SS3.p2.4.m4.1.1.1.cmml">⁢</mo><msub id="S4.SS3.p2.4.m4.1.1.3" xref="S4.SS3.p2.4.m4.1.1.3.cmml"><mi id="S4.SS3.p2.4.m4.1.1.3.2" xref="S4.SS3.p2.4.m4.1.1.3.2.cmml">r</mi><mrow id="S4.SS3.p2.4.m4.1.1.3.3" xref="S4.SS3.p2.4.m4.1.1.3.3.cmml"><mi id="S4.SS3.p2.4.m4.1.1.3.3.2" xref="S4.SS3.p2.4.m4.1.1.3.3.2.cmml">i</mi><mo id="S4.SS3.p2.4.m4.1.1.3.3.1" xref="S4.SS3.p2.4.m4.1.1.3.3.1.cmml">⁢</mo><mi id="S4.SS3.p2.4.m4.1.1.3.3.3" xref="S4.SS3.p2.4.m4.1.1.3.3.3.cmml">n</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.4.m4.1b"><apply id="S4.SS3.p2.4.m4.1.1.cmml" xref="S4.SS3.p2.4.m4.1.1"><times id="S4.SS3.p2.4.m4.1.1.1.cmml" xref="S4.SS3.p2.4.m4.1.1.1"></times><ci id="S4.SS3.p2.4.m4.1.1.2.cmml" xref="S4.SS3.p2.4.m4.1.1.2">𝑇</ci><apply id="S4.SS3.p2.4.m4.1.1.3.cmml" xref="S4.SS3.p2.4.m4.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p2.4.m4.1.1.3.1.cmml" xref="S4.SS3.p2.4.m4.1.1.3">subscript</csymbol><ci id="S4.SS3.p2.4.m4.1.1.3.2.cmml" xref="S4.SS3.p2.4.m4.1.1.3.2">𝑟</ci><apply id="S4.SS3.p2.4.m4.1.1.3.3.cmml" xref="S4.SS3.p2.4.m4.1.1.3.3"><times id="S4.SS3.p2.4.m4.1.1.3.3.1.cmml" xref="S4.SS3.p2.4.m4.1.1.3.3.1"></times><ci id="S4.SS3.p2.4.m4.1.1.3.3.2.cmml" xref="S4.SS3.p2.4.m4.1.1.3.3.2">𝑖</ci><ci id="S4.SS3.p2.4.m4.1.1.3.3.3.cmml" xref="S4.SS3.p2.4.m4.1.1.3.3.3">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.4.m4.1c">Tr_{in}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.4.m4.1d">italic_T italic_r start_POSTSUBSCRIPT italic_i italic_n end_POSTSUBSCRIPT</annotation></semantics></math> into <math id="S4.SS3.p2.5.m5.1" class="ltx_Math" alttext="z_{in}^{\theta}" display="inline"><semantics id="S4.SS3.p2.5.m5.1a"><msubsup id="S4.SS3.p2.5.m5.1.1" xref="S4.SS3.p2.5.m5.1.1.cmml"><mi id="S4.SS3.p2.5.m5.1.1.2.2" xref="S4.SS3.p2.5.m5.1.1.2.2.cmml">z</mi><mrow id="S4.SS3.p2.5.m5.1.1.2.3" xref="S4.SS3.p2.5.m5.1.1.2.3.cmml"><mi id="S4.SS3.p2.5.m5.1.1.2.3.2" xref="S4.SS3.p2.5.m5.1.1.2.3.2.cmml">i</mi><mo id="S4.SS3.p2.5.m5.1.1.2.3.1" xref="S4.SS3.p2.5.m5.1.1.2.3.1.cmml">⁢</mo><mi id="S4.SS3.p2.5.m5.1.1.2.3.3" xref="S4.SS3.p2.5.m5.1.1.2.3.3.cmml">n</mi></mrow><mi id="S4.SS3.p2.5.m5.1.1.3" xref="S4.SS3.p2.5.m5.1.1.3.cmml">θ</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.5.m5.1b"><apply id="S4.SS3.p2.5.m5.1.1.cmml" xref="S4.SS3.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.5.m5.1.1.1.cmml" xref="S4.SS3.p2.5.m5.1.1">superscript</csymbol><apply id="S4.SS3.p2.5.m5.1.1.2.cmml" xref="S4.SS3.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.5.m5.1.1.2.1.cmml" xref="S4.SS3.p2.5.m5.1.1">subscript</csymbol><ci id="S4.SS3.p2.5.m5.1.1.2.2.cmml" xref="S4.SS3.p2.5.m5.1.1.2.2">𝑧</ci><apply id="S4.SS3.p2.5.m5.1.1.2.3.cmml" xref="S4.SS3.p2.5.m5.1.1.2.3"><times id="S4.SS3.p2.5.m5.1.1.2.3.1.cmml" xref="S4.SS3.p2.5.m5.1.1.2.3.1"></times><ci id="S4.SS3.p2.5.m5.1.1.2.3.2.cmml" xref="S4.SS3.p2.5.m5.1.1.2.3.2">𝑖</ci><ci id="S4.SS3.p2.5.m5.1.1.2.3.3.cmml" xref="S4.SS3.p2.5.m5.1.1.2.3.3">𝑛</ci></apply></apply><ci id="S4.SS3.p2.5.m5.1.1.3.cmml" xref="S4.SS3.p2.5.m5.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.5.m5.1c">z_{in}^{\theta}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.5.m5.1d">italic_z start_POSTSUBSCRIPT italic_i italic_n end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_θ end_POSTSUPERSCRIPT</annotation></semantics></math>. Similarly, <math id="S4.SS3.p2.6.m6.1" class="ltx_Math" alttext="Tr_{au}" display="inline"><semantics id="S4.SS3.p2.6.m6.1a"><mrow id="S4.SS3.p2.6.m6.1.1" xref="S4.SS3.p2.6.m6.1.1.cmml"><mi id="S4.SS3.p2.6.m6.1.1.2" xref="S4.SS3.p2.6.m6.1.1.2.cmml">T</mi><mo id="S4.SS3.p2.6.m6.1.1.1" xref="S4.SS3.p2.6.m6.1.1.1.cmml">⁢</mo><msub id="S4.SS3.p2.6.m6.1.1.3" xref="S4.SS3.p2.6.m6.1.1.3.cmml"><mi id="S4.SS3.p2.6.m6.1.1.3.2" xref="S4.SS3.p2.6.m6.1.1.3.2.cmml">r</mi><mrow id="S4.SS3.p2.6.m6.1.1.3.3" xref="S4.SS3.p2.6.m6.1.1.3.3.cmml"><mi id="S4.SS3.p2.6.m6.1.1.3.3.2" xref="S4.SS3.p2.6.m6.1.1.3.3.2.cmml">a</mi><mo id="S4.SS3.p2.6.m6.1.1.3.3.1" xref="S4.SS3.p2.6.m6.1.1.3.3.1.cmml">⁢</mo><mi id="S4.SS3.p2.6.m6.1.1.3.3.3" xref="S4.SS3.p2.6.m6.1.1.3.3.3.cmml">u</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.6.m6.1b"><apply id="S4.SS3.p2.6.m6.1.1.cmml" xref="S4.SS3.p2.6.m6.1.1"><times id="S4.SS3.p2.6.m6.1.1.1.cmml" xref="S4.SS3.p2.6.m6.1.1.1"></times><ci id="S4.SS3.p2.6.m6.1.1.2.cmml" xref="S4.SS3.p2.6.m6.1.1.2">𝑇</ci><apply id="S4.SS3.p2.6.m6.1.1.3.cmml" xref="S4.SS3.p2.6.m6.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p2.6.m6.1.1.3.1.cmml" xref="S4.SS3.p2.6.m6.1.1.3">subscript</csymbol><ci id="S4.SS3.p2.6.m6.1.1.3.2.cmml" xref="S4.SS3.p2.6.m6.1.1.3.2">𝑟</ci><apply id="S4.SS3.p2.6.m6.1.1.3.3.cmml" xref="S4.SS3.p2.6.m6.1.1.3.3"><times id="S4.SS3.p2.6.m6.1.1.3.3.1.cmml" xref="S4.SS3.p2.6.m6.1.1.3.3.1"></times><ci id="S4.SS3.p2.6.m6.1.1.3.3.2.cmml" xref="S4.SS3.p2.6.m6.1.1.3.3.2">𝑎</ci><ci id="S4.SS3.p2.6.m6.1.1.3.3.3.cmml" xref="S4.SS3.p2.6.m6.1.1.3.3.3">𝑢</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.6.m6.1c">Tr_{au}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.6.m6.1d">italic_T italic_r start_POSTSUBSCRIPT italic_a italic_u end_POSTSUBSCRIPT</annotation></semantics></math> is encoded into <math id="S4.SS3.p2.7.m7.1" class="ltx_Math" alttext="z_{au}^{\phi}" display="inline"><semantics id="S4.SS3.p2.7.m7.1a"><msubsup id="S4.SS3.p2.7.m7.1.1" xref="S4.SS3.p2.7.m7.1.1.cmml"><mi id="S4.SS3.p2.7.m7.1.1.2.2" xref="S4.SS3.p2.7.m7.1.1.2.2.cmml">z</mi><mrow id="S4.SS3.p2.7.m7.1.1.2.3" xref="S4.SS3.p2.7.m7.1.1.2.3.cmml"><mi id="S4.SS3.p2.7.m7.1.1.2.3.2" xref="S4.SS3.p2.7.m7.1.1.2.3.2.cmml">a</mi><mo id="S4.SS3.p2.7.m7.1.1.2.3.1" xref="S4.SS3.p2.7.m7.1.1.2.3.1.cmml">⁢</mo><mi id="S4.SS3.p2.7.m7.1.1.2.3.3" xref="S4.SS3.p2.7.m7.1.1.2.3.3.cmml">u</mi></mrow><mi id="S4.SS3.p2.7.m7.1.1.3" xref="S4.SS3.p2.7.m7.1.1.3.cmml">ϕ</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.7.m7.1b"><apply id="S4.SS3.p2.7.m7.1.1.cmml" xref="S4.SS3.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.7.m7.1.1.1.cmml" xref="S4.SS3.p2.7.m7.1.1">superscript</csymbol><apply id="S4.SS3.p2.7.m7.1.1.2.cmml" xref="S4.SS3.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.7.m7.1.1.2.1.cmml" xref="S4.SS3.p2.7.m7.1.1">subscript</csymbol><ci id="S4.SS3.p2.7.m7.1.1.2.2.cmml" xref="S4.SS3.p2.7.m7.1.1.2.2">𝑧</ci><apply id="S4.SS3.p2.7.m7.1.1.2.3.cmml" xref="S4.SS3.p2.7.m7.1.1.2.3"><times id="S4.SS3.p2.7.m7.1.1.2.3.1.cmml" xref="S4.SS3.p2.7.m7.1.1.2.3.1"></times><ci id="S4.SS3.p2.7.m7.1.1.2.3.2.cmml" xref="S4.SS3.p2.7.m7.1.1.2.3.2">𝑎</ci><ci id="S4.SS3.p2.7.m7.1.1.2.3.3.cmml" xref="S4.SS3.p2.7.m7.1.1.2.3.3">𝑢</ci></apply></apply><ci id="S4.SS3.p2.7.m7.1.1.3.cmml" xref="S4.SS3.p2.7.m7.1.1.3">italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.7.m7.1c">z_{au}^{\phi}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.7.m7.1d">italic_z start_POSTSUBSCRIPT italic_a italic_u end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_ϕ end_POSTSUPERSCRIPT</annotation></semantics></math> via encoder <math id="S4.SS3.p2.8.m8.1" class="ltx_Math" alttext="f_{\phi}" display="inline"><semantics id="S4.SS3.p2.8.m8.1a"><msub id="S4.SS3.p2.8.m8.1.1" xref="S4.SS3.p2.8.m8.1.1.cmml"><mi id="S4.SS3.p2.8.m8.1.1.2" xref="S4.SS3.p2.8.m8.1.1.2.cmml">f</mi><mi id="S4.SS3.p2.8.m8.1.1.3" xref="S4.SS3.p2.8.m8.1.1.3.cmml">ϕ</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.8.m8.1b"><apply id="S4.SS3.p2.8.m8.1.1.cmml" xref="S4.SS3.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.8.m8.1.1.1.cmml" xref="S4.SS3.p2.8.m8.1.1">subscript</csymbol><ci id="S4.SS3.p2.8.m8.1.1.2.cmml" xref="S4.SS3.p2.8.m8.1.1.2">𝑓</ci><ci id="S4.SS3.p2.8.m8.1.1.3.cmml" xref="S4.SS3.p2.8.m8.1.1.3">italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.8.m8.1c">f_{\phi}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.8.m8.1d">italic_f start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT</annotation></semantics></math>.
We expect encoder network <math id="S4.SS3.p2.9.m9.1" class="ltx_Math" alttext="f_{\theta}" display="inline"><semantics id="S4.SS3.p2.9.m9.1a"><msub id="S4.SS3.p2.9.m9.1.1" xref="S4.SS3.p2.9.m9.1.1.cmml"><mi id="S4.SS3.p2.9.m9.1.1.2" xref="S4.SS3.p2.9.m9.1.1.2.cmml">f</mi><mi id="S4.SS3.p2.9.m9.1.1.3" xref="S4.SS3.p2.9.m9.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.9.m9.1b"><apply id="S4.SS3.p2.9.m9.1.1.cmml" xref="S4.SS3.p2.9.m9.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.9.m9.1.1.1.cmml" xref="S4.SS3.p2.9.m9.1.1">subscript</csymbol><ci id="S4.SS3.p2.9.m9.1.1.2.cmml" xref="S4.SS3.p2.9.m9.1.1.2">𝑓</ci><ci id="S4.SS3.p2.9.m9.1.1.3.cmml" xref="S4.SS3.p2.9.m9.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.9.m9.1c">f_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.9.m9.1d">italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> can be trained similar to the true label <math id="S4.SS3.p2.10.m10.1" class="ltx_Math" alttext="y" display="inline"><semantics id="S4.SS3.p2.10.m10.1a"><mi id="S4.SS3.p2.10.m10.1.1" xref="S4.SS3.p2.10.m10.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.10.m10.1b"><ci id="S4.SS3.p2.10.m10.1.1.cmml" xref="S4.SS3.p2.10.m10.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.10.m10.1c">y</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.10.m10.1d">italic_y</annotation></semantics></math>, and the knowledge of long-term trajectory with more representation ability can be transferred to <math id="S4.SS3.p2.11.m11.1" class="ltx_Math" alttext="f_{\theta}" display="inline"><semantics id="S4.SS3.p2.11.m11.1a"><msub id="S4.SS3.p2.11.m11.1.1" xref="S4.SS3.p2.11.m11.1.1.cmml"><mi id="S4.SS3.p2.11.m11.1.1.2" xref="S4.SS3.p2.11.m11.1.1.2.cmml">f</mi><mi id="S4.SS3.p2.11.m11.1.1.3" xref="S4.SS3.p2.11.m11.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.11.m11.1b"><apply id="S4.SS3.p2.11.m11.1.1.cmml" xref="S4.SS3.p2.11.m11.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.11.m11.1.1.1.cmml" xref="S4.SS3.p2.11.m11.1.1">subscript</csymbol><ci id="S4.SS3.p2.11.m11.1.1.2.cmml" xref="S4.SS3.p2.11.m11.1.1.2">𝑓</ci><ci id="S4.SS3.p2.11.m11.1.1.3.cmml" xref="S4.SS3.p2.11.m11.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.11.m11.1c">f_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.11.m11.1d">italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math>. During the training, the loss function <math id="S4.SS3.p2.12.m12.1" class="ltx_Math" alttext="\mathcal{L}_{1}" display="inline"><semantics id="S4.SS3.p2.12.m12.1a"><msub id="S4.SS3.p2.12.m12.1.1" xref="S4.SS3.p2.12.m12.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p2.12.m12.1.1.2" xref="S4.SS3.p2.12.m12.1.1.2.cmml">ℒ</mi><mn id="S4.SS3.p2.12.m12.1.1.3" xref="S4.SS3.p2.12.m12.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.12.m12.1b"><apply id="S4.SS3.p2.12.m12.1.1.cmml" xref="S4.SS3.p2.12.m12.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.12.m12.1.1.1.cmml" xref="S4.SS3.p2.12.m12.1.1">subscript</csymbol><ci id="S4.SS3.p2.12.m12.1.1.2.cmml" xref="S4.SS3.p2.12.m12.1.1.2">ℒ</ci><cn type="integer" id="S4.SS3.p2.12.m12.1.1.3.cmml" xref="S4.SS3.p2.12.m12.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.12.m12.1c">\mathcal{L}_{1}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.12.m12.1d">caligraphic_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> is as:</p>
<table id="S4.E7" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E7.m1.49" class="ltx_Math" alttext="\begin{split}\mathcal{L}_{1}=&amp;\mathcal{H}(y,z_{in}^{\theta})+\mathcal{H}(y,z_{%
au}^{\phi})+\\
&amp;\lambda T^{2}\operatorname{KL}(\varphi(z_{in}^{\theta}/T),\psi(z_{au}^{\phi}/%
T)),\end{split}" display="block"><semantics id="S4.E7.m1.49a"><mtable columnspacing="0pt" displaystyle="true" rowspacing="0pt" id="S4.E7.m1.49.49.4"><mtr id="S4.E7.m1.49.49.4a"><mtd columnalign="right" id="S4.E7.m1.49.49.4b"><mrow id="S4.E7.m1.3.3.3.3.3"><msub id="S4.E7.m1.3.3.3.3.3.4"><mi class="ltx_font_mathcaligraphic" id="S4.E7.m1.1.1.1.1.1.1" xref="S4.E7.m1.1.1.1.1.1.1.cmml">ℒ</mi><mn id="S4.E7.m1.2.2.2.2.2.2.1" xref="S4.E7.m1.2.2.2.2.2.2.1.cmml">1</mn></msub><mo id="S4.E7.m1.3.3.3.3.3.3" xref="S4.E7.m1.3.3.3.3.3.3.cmml">=</mo><mi id="S4.E7.m1.3.3.3.3.3.5" xref="S4.E7.m1.46.46.1.1.1.cmml"></mi></mrow></mtd><mtd columnalign="left" id="S4.E7.m1.49.49.4c"><mrow id="S4.E7.m1.48.48.3.47.23.20"><mrow id="S4.E7.m1.47.47.2.46.22.19.19"><mi class="ltx_font_mathcaligraphic" id="S4.E7.m1.4.4.4.4.1.1" xref="S4.E7.m1.4.4.4.4.1.1.cmml">ℋ</mi><mo id="S4.E7.m1.47.47.2.46.22.19.19.2" xref="S4.E7.m1.46.46.1.1.1.cmml">⁢</mo><mrow id="S4.E7.m1.47.47.2.46.22.19.19.1.1"><mo stretchy="false" id="S4.E7.m1.5.5.5.5.2.2" xref="S4.E7.m1.46.46.1.1.1.cmml">(</mo><mi id="S4.E7.m1.6.6.6.6.3.3" xref="S4.E7.m1.6.6.6.6.3.3.cmml">y</mi><mo id="S4.E7.m1.7.7.7.7.4.4" xref="S4.E7.m1.46.46.1.1.1.cmml">,</mo><msubsup id="S4.E7.m1.47.47.2.46.22.19.19.1.1.1"><mi id="S4.E7.m1.8.8.8.8.5.5" xref="S4.E7.m1.8.8.8.8.5.5.cmml">z</mi><mrow id="S4.E7.m1.9.9.9.9.6.6.1" xref="S4.E7.m1.9.9.9.9.6.6.1.cmml"><mi id="S4.E7.m1.9.9.9.9.6.6.1.2" xref="S4.E7.m1.9.9.9.9.6.6.1.2.cmml">i</mi><mo id="S4.E7.m1.9.9.9.9.6.6.1.1" xref="S4.E7.m1.9.9.9.9.6.6.1.1.cmml">⁢</mo><mi id="S4.E7.m1.9.9.9.9.6.6.1.3" xref="S4.E7.m1.9.9.9.9.6.6.1.3.cmml">n</mi></mrow><mi id="S4.E7.m1.10.10.10.10.7.7.1" xref="S4.E7.m1.10.10.10.10.7.7.1.cmml">θ</mi></msubsup><mo stretchy="false" id="S4.E7.m1.11.11.11.11.8.8" xref="S4.E7.m1.46.46.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E7.m1.12.12.12.12.9.9" xref="S4.E7.m1.12.12.12.12.9.9.cmml">+</mo><mrow id="S4.E7.m1.48.48.3.47.23.20.20"><mrow id="S4.E7.m1.48.48.3.47.23.20.20.1"><mi class="ltx_font_mathcaligraphic" id="S4.E7.m1.13.13.13.13.10.10" xref="S4.E7.m1.13.13.13.13.10.10.cmml">ℋ</mi><mo id="S4.E7.m1.48.48.3.47.23.20.20.1.2" xref="S4.E7.m1.46.46.1.1.1.cmml">⁢</mo><mrow id="S4.E7.m1.48.48.3.47.23.20.20.1.1.1"><mo stretchy="false" id="S4.E7.m1.14.14.14.14.11.11" xref="S4.E7.m1.46.46.1.1.1.cmml">(</mo><mi id="S4.E7.m1.15.15.15.15.12.12" xref="S4.E7.m1.15.15.15.15.12.12.cmml">y</mi><mo id="S4.E7.m1.16.16.16.16.13.13" xref="S4.E7.m1.46.46.1.1.1.cmml">,</mo><msubsup id="S4.E7.m1.48.48.3.47.23.20.20.1.1.1.1"><mi id="S4.E7.m1.17.17.17.17.14.14" xref="S4.E7.m1.17.17.17.17.14.14.cmml">z</mi><mrow id="S4.E7.m1.18.18.18.18.15.15.1" xref="S4.E7.m1.18.18.18.18.15.15.1.cmml"><mi id="S4.E7.m1.18.18.18.18.15.15.1.2" xref="S4.E7.m1.18.18.18.18.15.15.1.2.cmml">a</mi><mo id="S4.E7.m1.18.18.18.18.15.15.1.1" xref="S4.E7.m1.18.18.18.18.15.15.1.1.cmml">⁢</mo><mi id="S4.E7.m1.18.18.18.18.15.15.1.3" xref="S4.E7.m1.18.18.18.18.15.15.1.3.cmml">u</mi></mrow><mi id="S4.E7.m1.19.19.19.19.16.16.1" xref="S4.E7.m1.19.19.19.19.16.16.1.cmml">ϕ</mi></msubsup><mo stretchy="false" id="S4.E7.m1.20.20.20.20.17.17" xref="S4.E7.m1.46.46.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E7.m1.21.21.21.21.18.18" xref="S4.E7.m1.46.46.1.1.1.cmml">+</mo></mrow></mrow></mtd></mtr><mtr id="S4.E7.m1.49.49.4d"><mtd id="S4.E7.m1.49.49.4e" xref="S4.E7.m1.46.46.1.1.1.cmml"></mtd><mtd columnalign="left" id="S4.E7.m1.49.49.4f"><mrow id="S4.E7.m1.49.49.4.48.25.25.25"><mrow id="S4.E7.m1.49.49.4.48.25.25.25.1"><mi id="S4.E7.m1.22.22.22.1.1.1" xref="S4.E7.m1.22.22.22.1.1.1.cmml">λ</mi><mo id="S4.E7.m1.49.49.4.48.25.25.25.1.3" xref="S4.E7.m1.46.46.1.1.1.cmml">⁢</mo><msup id="S4.E7.m1.49.49.4.48.25.25.25.1.4"><mi id="S4.E7.m1.23.23.23.2.2.2" xref="S4.E7.m1.23.23.23.2.2.2.cmml">T</mi><mn id="S4.E7.m1.24.24.24.3.3.3.1" xref="S4.E7.m1.24.24.24.3.3.3.1.cmml">2</mn></msup><mo id="S4.E7.m1.49.49.4.48.25.25.25.1.3a" xref="S4.E7.m1.46.46.1.1.1.cmml">⁢</mo><mrow id="S4.E7.m1.49.49.4.48.25.25.25.1.2.2"><mi id="S4.E7.m1.25.25.25.4.4.4" xref="S4.E7.m1.25.25.25.4.4.4.cmml">KL</mi><mo id="S4.E7.m1.49.49.4.48.25.25.25.1.2.2a" xref="S4.E7.m1.46.46.1.1.1.cmml">⁡</mo><mrow id="S4.E7.m1.49.49.4.48.25.25.25.1.2.2.2"><mo stretchy="false" id="S4.E7.m1.26.26.26.5.5.5" xref="S4.E7.m1.46.46.1.1.1.cmml">(</mo><mrow id="S4.E7.m1.49.49.4.48.25.25.25.1.1.1.1.1"><mi id="S4.E7.m1.27.27.27.6.6.6" xref="S4.E7.m1.27.27.27.6.6.6.cmml">φ</mi><mo id="S4.E7.m1.49.49.4.48.25.25.25.1.1.1.1.1.2" xref="S4.E7.m1.46.46.1.1.1.cmml">⁢</mo><mrow id="S4.E7.m1.49.49.4.48.25.25.25.1.1.1.1.1.1.1"><mo stretchy="false" id="S4.E7.m1.28.28.28.7.7.7" xref="S4.E7.m1.46.46.1.1.1.cmml">(</mo><mrow id="S4.E7.m1.49.49.4.48.25.25.25.1.1.1.1.1.1.1.1"><msubsup id="S4.E7.m1.49.49.4.48.25.25.25.1.1.1.1.1.1.1.1.1"><mi id="S4.E7.m1.29.29.29.8.8.8" xref="S4.E7.m1.29.29.29.8.8.8.cmml">z</mi><mrow id="S4.E7.m1.30.30.30.9.9.9.1" xref="S4.E7.m1.30.30.30.9.9.9.1.cmml"><mi id="S4.E7.m1.30.30.30.9.9.9.1.2" xref="S4.E7.m1.30.30.30.9.9.9.1.2.cmml">i</mi><mo id="S4.E7.m1.30.30.30.9.9.9.1.1" xref="S4.E7.m1.30.30.30.9.9.9.1.1.cmml">⁢</mo><mi id="S4.E7.m1.30.30.30.9.9.9.1.3" xref="S4.E7.m1.30.30.30.9.9.9.1.3.cmml">n</mi></mrow><mi id="S4.E7.m1.31.31.31.10.10.10.1" xref="S4.E7.m1.31.31.31.10.10.10.1.cmml">θ</mi></msubsup><mo id="S4.E7.m1.32.32.32.11.11.11" xref="S4.E7.m1.32.32.32.11.11.11.cmml">/</mo><mi id="S4.E7.m1.33.33.33.12.12.12" xref="S4.E7.m1.33.33.33.12.12.12.cmml">T</mi></mrow><mo stretchy="false" id="S4.E7.m1.34.34.34.13.13.13" xref="S4.E7.m1.46.46.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E7.m1.35.35.35.14.14.14" xref="S4.E7.m1.46.46.1.1.1.cmml">,</mo><mrow id="S4.E7.m1.49.49.4.48.25.25.25.1.2.2.2.2"><mi id="S4.E7.m1.36.36.36.15.15.15" xref="S4.E7.m1.36.36.36.15.15.15.cmml">ψ</mi><mo id="S4.E7.m1.49.49.4.48.25.25.25.1.2.2.2.2.2" xref="S4.E7.m1.46.46.1.1.1.cmml">⁢</mo><mrow id="S4.E7.m1.49.49.4.48.25.25.25.1.2.2.2.2.1.1"><mo stretchy="false" id="S4.E7.m1.37.37.37.16.16.16" xref="S4.E7.m1.46.46.1.1.1.cmml">(</mo><mrow id="S4.E7.m1.49.49.4.48.25.25.25.1.2.2.2.2.1.1.1"><msubsup id="S4.E7.m1.49.49.4.48.25.25.25.1.2.2.2.2.1.1.1.1"><mi id="S4.E7.m1.38.38.38.17.17.17" xref="S4.E7.m1.38.38.38.17.17.17.cmml">z</mi><mrow id="S4.E7.m1.39.39.39.18.18.18.1" xref="S4.E7.m1.39.39.39.18.18.18.1.cmml"><mi id="S4.E7.m1.39.39.39.18.18.18.1.2" xref="S4.E7.m1.39.39.39.18.18.18.1.2.cmml">a</mi><mo id="S4.E7.m1.39.39.39.18.18.18.1.1" xref="S4.E7.m1.39.39.39.18.18.18.1.1.cmml">⁢</mo><mi id="S4.E7.m1.39.39.39.18.18.18.1.3" xref="S4.E7.m1.39.39.39.18.18.18.1.3.cmml">u</mi></mrow><mi id="S4.E7.m1.40.40.40.19.19.19.1" xref="S4.E7.m1.40.40.40.19.19.19.1.cmml">ϕ</mi></msubsup><mo id="S4.E7.m1.41.41.41.20.20.20" xref="S4.E7.m1.41.41.41.20.20.20.cmml">/</mo><mi id="S4.E7.m1.42.42.42.21.21.21" xref="S4.E7.m1.42.42.42.21.21.21.cmml">T</mi></mrow><mo stretchy="false" id="S4.E7.m1.43.43.43.22.22.22" xref="S4.E7.m1.46.46.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S4.E7.m1.44.44.44.23.23.23" xref="S4.E7.m1.46.46.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E7.m1.45.45.45.24.24.24" xref="S4.E7.m1.46.46.1.1.1.cmml">,</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S4.E7.m1.49b"><apply id="S4.E7.m1.46.46.1.1.1.cmml" xref="S4.E7.m1.3.3.3.3.3.5"><eq id="S4.E7.m1.3.3.3.3.3.3.cmml" xref="S4.E7.m1.3.3.3.3.3.3"></eq><apply id="S4.E7.m1.46.46.1.1.1.6.cmml" xref="S4.E7.m1.3.3.3.3.3.5"><csymbol cd="ambiguous" id="S4.E7.m1.46.46.1.1.1.6.1.cmml" xref="S4.E7.m1.3.3.3.3.3.5">subscript</csymbol><ci id="S4.E7.m1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.1.1.1.1.1.1">ℒ</ci><cn type="integer" id="S4.E7.m1.2.2.2.2.2.2.1.cmml" xref="S4.E7.m1.2.2.2.2.2.2.1">1</cn></apply><apply id="S4.E7.m1.46.46.1.1.1.4.cmml" xref="S4.E7.m1.3.3.3.3.3.5"><plus id="S4.E7.m1.12.12.12.12.9.9.cmml" xref="S4.E7.m1.12.12.12.12.9.9"></plus><apply id="S4.E7.m1.46.46.1.1.1.1.1.cmml" xref="S4.E7.m1.3.3.3.3.3.5"><times id="S4.E7.m1.46.46.1.1.1.1.1.2.cmml" xref="S4.E7.m1.3.3.3.3.3.5"></times><ci id="S4.E7.m1.4.4.4.4.1.1.cmml" xref="S4.E7.m1.4.4.4.4.1.1">ℋ</ci><interval closure="open" id="S4.E7.m1.46.46.1.1.1.1.1.1.2.cmml" xref="S4.E7.m1.3.3.3.3.3.5"><ci id="S4.E7.m1.6.6.6.6.3.3.cmml" xref="S4.E7.m1.6.6.6.6.3.3">𝑦</ci><apply id="S4.E7.m1.46.46.1.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.3.3.3.3.3.5"><csymbol cd="ambiguous" id="S4.E7.m1.46.46.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.3.3.3.3.3.5">superscript</csymbol><apply id="S4.E7.m1.46.46.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E7.m1.3.3.3.3.3.5"><csymbol cd="ambiguous" id="S4.E7.m1.46.46.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E7.m1.3.3.3.3.3.5">subscript</csymbol><ci id="S4.E7.m1.8.8.8.8.5.5.cmml" xref="S4.E7.m1.8.8.8.8.5.5">𝑧</ci><apply id="S4.E7.m1.9.9.9.9.6.6.1.cmml" xref="S4.E7.m1.9.9.9.9.6.6.1"><times id="S4.E7.m1.9.9.9.9.6.6.1.1.cmml" xref="S4.E7.m1.9.9.9.9.6.6.1.1"></times><ci id="S4.E7.m1.9.9.9.9.6.6.1.2.cmml" xref="S4.E7.m1.9.9.9.9.6.6.1.2">𝑖</ci><ci id="S4.E7.m1.9.9.9.9.6.6.1.3.cmml" xref="S4.E7.m1.9.9.9.9.6.6.1.3">𝑛</ci></apply></apply><ci id="S4.E7.m1.10.10.10.10.7.7.1.cmml" xref="S4.E7.m1.10.10.10.10.7.7.1">𝜃</ci></apply></interval></apply><apply id="S4.E7.m1.46.46.1.1.1.2.2.cmml" xref="S4.E7.m1.3.3.3.3.3.5"><times id="S4.E7.m1.46.46.1.1.1.2.2.2.cmml" xref="S4.E7.m1.3.3.3.3.3.5"></times><ci id="S4.E7.m1.13.13.13.13.10.10.cmml" xref="S4.E7.m1.13.13.13.13.10.10">ℋ</ci><interval closure="open" id="S4.E7.m1.46.46.1.1.1.2.2.1.2.cmml" xref="S4.E7.m1.3.3.3.3.3.5"><ci id="S4.E7.m1.15.15.15.15.12.12.cmml" xref="S4.E7.m1.15.15.15.15.12.12">𝑦</ci><apply id="S4.E7.m1.46.46.1.1.1.2.2.1.1.1.cmml" xref="S4.E7.m1.3.3.3.3.3.5"><csymbol cd="ambiguous" id="S4.E7.m1.46.46.1.1.1.2.2.1.1.1.1.cmml" xref="S4.E7.m1.3.3.3.3.3.5">superscript</csymbol><apply id="S4.E7.m1.46.46.1.1.1.2.2.1.1.1.2.cmml" xref="S4.E7.m1.3.3.3.3.3.5"><csymbol cd="ambiguous" id="S4.E7.m1.46.46.1.1.1.2.2.1.1.1.2.1.cmml" xref="S4.E7.m1.3.3.3.3.3.5">subscript</csymbol><ci id="S4.E7.m1.17.17.17.17.14.14.cmml" xref="S4.E7.m1.17.17.17.17.14.14">𝑧</ci><apply id="S4.E7.m1.18.18.18.18.15.15.1.cmml" xref="S4.E7.m1.18.18.18.18.15.15.1"><times id="S4.E7.m1.18.18.18.18.15.15.1.1.cmml" xref="S4.E7.m1.18.18.18.18.15.15.1.1"></times><ci id="S4.E7.m1.18.18.18.18.15.15.1.2.cmml" xref="S4.E7.m1.18.18.18.18.15.15.1.2">𝑎</ci><ci id="S4.E7.m1.18.18.18.18.15.15.1.3.cmml" xref="S4.E7.m1.18.18.18.18.15.15.1.3">𝑢</ci></apply></apply><ci id="S4.E7.m1.19.19.19.19.16.16.1.cmml" xref="S4.E7.m1.19.19.19.19.16.16.1">italic-ϕ</ci></apply></interval></apply><apply id="S4.E7.m1.46.46.1.1.1.4.4.cmml" xref="S4.E7.m1.3.3.3.3.3.5"><times id="S4.E7.m1.46.46.1.1.1.4.4.3.cmml" xref="S4.E7.m1.3.3.3.3.3.5"></times><ci id="S4.E7.m1.22.22.22.1.1.1.cmml" xref="S4.E7.m1.22.22.22.1.1.1">𝜆</ci><apply id="S4.E7.m1.46.46.1.1.1.4.4.5.cmml" xref="S4.E7.m1.3.3.3.3.3.5"><csymbol cd="ambiguous" id="S4.E7.m1.46.46.1.1.1.4.4.5.1.cmml" xref="S4.E7.m1.3.3.3.3.3.5">superscript</csymbol><ci id="S4.E7.m1.23.23.23.2.2.2.cmml" xref="S4.E7.m1.23.23.23.2.2.2">𝑇</ci><cn type="integer" id="S4.E7.m1.24.24.24.3.3.3.1.cmml" xref="S4.E7.m1.24.24.24.3.3.3.1">2</cn></apply><apply id="S4.E7.m1.46.46.1.1.1.4.4.2.3.cmml" xref="S4.E7.m1.3.3.3.3.3.5"><ci id="S4.E7.m1.25.25.25.4.4.4.cmml" xref="S4.E7.m1.25.25.25.4.4.4">KL</ci><apply id="S4.E7.m1.46.46.1.1.1.3.3.1.1.1.1.cmml" xref="S4.E7.m1.3.3.3.3.3.5"><times id="S4.E7.m1.46.46.1.1.1.3.3.1.1.1.1.2.cmml" xref="S4.E7.m1.3.3.3.3.3.5"></times><ci id="S4.E7.m1.27.27.27.6.6.6.cmml" xref="S4.E7.m1.27.27.27.6.6.6">𝜑</ci><apply id="S4.E7.m1.46.46.1.1.1.3.3.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.3.3.3.3.3.5"><divide id="S4.E7.m1.32.32.32.11.11.11.cmml" xref="S4.E7.m1.32.32.32.11.11.11"></divide><apply id="S4.E7.m1.46.46.1.1.1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S4.E7.m1.3.3.3.3.3.5"><csymbol cd="ambiguous" id="S4.E7.m1.46.46.1.1.1.3.3.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E7.m1.3.3.3.3.3.5">superscript</csymbol><apply id="S4.E7.m1.46.46.1.1.1.3.3.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E7.m1.3.3.3.3.3.5"><csymbol cd="ambiguous" id="S4.E7.m1.46.46.1.1.1.3.3.1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E7.m1.3.3.3.3.3.5">subscript</csymbol><ci id="S4.E7.m1.29.29.29.8.8.8.cmml" xref="S4.E7.m1.29.29.29.8.8.8">𝑧</ci><apply id="S4.E7.m1.30.30.30.9.9.9.1.cmml" xref="S4.E7.m1.30.30.30.9.9.9.1"><times id="S4.E7.m1.30.30.30.9.9.9.1.1.cmml" xref="S4.E7.m1.30.30.30.9.9.9.1.1"></times><ci id="S4.E7.m1.30.30.30.9.9.9.1.2.cmml" xref="S4.E7.m1.30.30.30.9.9.9.1.2">𝑖</ci><ci id="S4.E7.m1.30.30.30.9.9.9.1.3.cmml" xref="S4.E7.m1.30.30.30.9.9.9.1.3">𝑛</ci></apply></apply><ci id="S4.E7.m1.31.31.31.10.10.10.1.cmml" xref="S4.E7.m1.31.31.31.10.10.10.1">𝜃</ci></apply><ci id="S4.E7.m1.33.33.33.12.12.12.cmml" xref="S4.E7.m1.33.33.33.12.12.12">𝑇</ci></apply></apply><apply id="S4.E7.m1.46.46.1.1.1.4.4.2.2.2.2.cmml" xref="S4.E7.m1.3.3.3.3.3.5"><times id="S4.E7.m1.46.46.1.1.1.4.4.2.2.2.2.2.cmml" xref="S4.E7.m1.3.3.3.3.3.5"></times><ci id="S4.E7.m1.36.36.36.15.15.15.cmml" xref="S4.E7.m1.36.36.36.15.15.15">𝜓</ci><apply id="S4.E7.m1.46.46.1.1.1.4.4.2.2.2.2.1.1.1.cmml" xref="S4.E7.m1.3.3.3.3.3.5"><divide id="S4.E7.m1.41.41.41.20.20.20.cmml" xref="S4.E7.m1.41.41.41.20.20.20"></divide><apply id="S4.E7.m1.46.46.1.1.1.4.4.2.2.2.2.1.1.1.2.cmml" xref="S4.E7.m1.3.3.3.3.3.5"><csymbol cd="ambiguous" id="S4.E7.m1.46.46.1.1.1.4.4.2.2.2.2.1.1.1.2.1.cmml" xref="S4.E7.m1.3.3.3.3.3.5">superscript</csymbol><apply id="S4.E7.m1.46.46.1.1.1.4.4.2.2.2.2.1.1.1.2.2.cmml" xref="S4.E7.m1.3.3.3.3.3.5"><csymbol cd="ambiguous" id="S4.E7.m1.46.46.1.1.1.4.4.2.2.2.2.1.1.1.2.2.1.cmml" xref="S4.E7.m1.3.3.3.3.3.5">subscript</csymbol><ci id="S4.E7.m1.38.38.38.17.17.17.cmml" xref="S4.E7.m1.38.38.38.17.17.17">𝑧</ci><apply id="S4.E7.m1.39.39.39.18.18.18.1.cmml" xref="S4.E7.m1.39.39.39.18.18.18.1"><times id="S4.E7.m1.39.39.39.18.18.18.1.1.cmml" xref="S4.E7.m1.39.39.39.18.18.18.1.1"></times><ci id="S4.E7.m1.39.39.39.18.18.18.1.2.cmml" xref="S4.E7.m1.39.39.39.18.18.18.1.2">𝑎</ci><ci id="S4.E7.m1.39.39.39.18.18.18.1.3.cmml" xref="S4.E7.m1.39.39.39.18.18.18.1.3">𝑢</ci></apply></apply><ci id="S4.E7.m1.40.40.40.19.19.19.1.cmml" xref="S4.E7.m1.40.40.40.19.19.19.1">italic-ϕ</ci></apply><ci id="S4.E7.m1.42.42.42.21.21.21.cmml" xref="S4.E7.m1.42.42.42.21.21.21">𝑇</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E7.m1.49c">\begin{split}\mathcal{L}_{1}=&amp;\mathcal{H}(y,z_{in}^{\theta})+\mathcal{H}(y,z_{%
au}^{\phi})+\\
&amp;\lambda T^{2}\operatorname{KL}(\varphi(z_{in}^{\theta}/T),\psi(z_{au}^{\phi}/%
T)),\end{split}</annotation><annotation encoding="application/x-llamapun" id="S4.E7.m1.49d">start_ROW start_CELL caligraphic_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = end_CELL start_CELL caligraphic_H ( italic_y , italic_z start_POSTSUBSCRIPT italic_i italic_n end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_θ end_POSTSUPERSCRIPT ) + caligraphic_H ( italic_y , italic_z start_POSTSUBSCRIPT italic_a italic_u end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_ϕ end_POSTSUPERSCRIPT ) + end_CELL end_ROW start_ROW start_CELL end_CELL start_CELL italic_λ italic_T start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT roman_KL ( italic_φ ( italic_z start_POSTSUBSCRIPT italic_i italic_n end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_θ end_POSTSUPERSCRIPT / italic_T ) , italic_ψ ( italic_z start_POSTSUBSCRIPT italic_a italic_u end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_ϕ end_POSTSUPERSCRIPT / italic_T ) ) , end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr>
</table>
<p id="S4.SS3.p2.18" class="ltx_p">where <math id="S4.SS3.p2.13.m1.2" class="ltx_Math" alttext="\mathcal{H(\cdot,\cdot)}" display="inline"><semantics id="S4.SS3.p2.13.m1.2a"><mrow id="S4.SS3.p2.13.m1.2.3" xref="S4.SS3.p2.13.m1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p2.13.m1.2.3.2" xref="S4.SS3.p2.13.m1.2.3.2.cmml">ℋ</mi><mo id="S4.SS3.p2.13.m1.2.3.1" xref="S4.SS3.p2.13.m1.2.3.1.cmml">⁢</mo><mrow id="S4.SS3.p2.13.m1.2.3.3.2" xref="S4.SS3.p2.13.m1.2.3.3.1.cmml"><mo stretchy="false" id="S4.SS3.p2.13.m1.2.3.3.2.1" xref="S4.SS3.p2.13.m1.2.3.3.1.cmml">(</mo><mo id="S4.SS3.p2.13.m1.1.1" xref="S4.SS3.p2.13.m1.1.1.cmml">⋅</mo><mo id="S4.SS3.p2.13.m1.2.3.3.2.2" xref="S4.SS3.p2.13.m1.2.3.3.1.cmml">,</mo><mo id="S4.SS3.p2.13.m1.2.2" xref="S4.SS3.p2.13.m1.2.2.cmml">⋅</mo><mo stretchy="false" id="S4.SS3.p2.13.m1.2.3.3.2.3" xref="S4.SS3.p2.13.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.13.m1.2b"><apply id="S4.SS3.p2.13.m1.2.3.cmml" xref="S4.SS3.p2.13.m1.2.3"><times id="S4.SS3.p2.13.m1.2.3.1.cmml" xref="S4.SS3.p2.13.m1.2.3.1"></times><ci id="S4.SS3.p2.13.m1.2.3.2.cmml" xref="S4.SS3.p2.13.m1.2.3.2">ℋ</ci><interval closure="open" id="S4.SS3.p2.13.m1.2.3.3.1.cmml" xref="S4.SS3.p2.13.m1.2.3.3.2"><ci id="S4.SS3.p2.13.m1.1.1.cmml" xref="S4.SS3.p2.13.m1.1.1">⋅</ci><ci id="S4.SS3.p2.13.m1.2.2.cmml" xref="S4.SS3.p2.13.m1.2.2">⋅</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.13.m1.2c">\mathcal{H(\cdot,\cdot)}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.13.m1.2d">caligraphic_H ( ⋅ , ⋅ )</annotation></semantics></math> refers to the conventional cross-entropy loss and <math id="S4.SS3.p2.14.m2.3" class="ltx_Math" alttext="\operatorname{KL}(\cdot,\cdot)" display="inline"><semantics id="S4.SS3.p2.14.m2.3a"><mrow id="S4.SS3.p2.14.m2.3.4.2" xref="S4.SS3.p2.14.m2.3.4.1.cmml"><mi id="S4.SS3.p2.14.m2.1.1" xref="S4.SS3.p2.14.m2.1.1.cmml">KL</mi><mo id="S4.SS3.p2.14.m2.3.4.2a" xref="S4.SS3.p2.14.m2.3.4.1.cmml">⁡</mo><mrow id="S4.SS3.p2.14.m2.3.4.2.1" xref="S4.SS3.p2.14.m2.3.4.1.cmml"><mo stretchy="false" id="S4.SS3.p2.14.m2.3.4.2.1.1" xref="S4.SS3.p2.14.m2.3.4.1.cmml">(</mo><mo id="S4.SS3.p2.14.m2.2.2" xref="S4.SS3.p2.14.m2.2.2.cmml">⋅</mo><mo id="S4.SS3.p2.14.m2.3.4.2.1.2" xref="S4.SS3.p2.14.m2.3.4.1.cmml">,</mo><mo id="S4.SS3.p2.14.m2.3.3" xref="S4.SS3.p2.14.m2.3.3.cmml">⋅</mo><mo stretchy="false" id="S4.SS3.p2.14.m2.3.4.2.1.3" xref="S4.SS3.p2.14.m2.3.4.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.14.m2.3b"><apply id="S4.SS3.p2.14.m2.3.4.1.cmml" xref="S4.SS3.p2.14.m2.3.4.2"><ci id="S4.SS3.p2.14.m2.1.1.cmml" xref="S4.SS3.p2.14.m2.1.1">KL</ci><ci id="S4.SS3.p2.14.m2.2.2.cmml" xref="S4.SS3.p2.14.m2.2.2">⋅</ci><ci id="S4.SS3.p2.14.m2.3.3.cmml" xref="S4.SS3.p2.14.m2.3.3">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.14.m2.3c">\operatorname{KL}(\cdot,\cdot)</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.14.m2.3d">roman_KL ( ⋅ , ⋅ )</annotation></semantics></math> to the Kullback–Leibler divergence of softmax <math id="S4.SS3.p2.15.m3.1" class="ltx_Math" alttext="\varphi" display="inline"><semantics id="S4.SS3.p2.15.m3.1a"><mi id="S4.SS3.p2.15.m3.1.1" xref="S4.SS3.p2.15.m3.1.1.cmml">φ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.15.m3.1b"><ci id="S4.SS3.p2.15.m3.1.1.cmml" xref="S4.SS3.p2.15.m3.1.1">𝜑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.15.m3.1c">\varphi</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.15.m3.1d">italic_φ</annotation></semantics></math> and log-softmax <math id="S4.SS3.p2.16.m4.1" class="ltx_Math" alttext="\psi" display="inline"><semantics id="S4.SS3.p2.16.m4.1a"><mi id="S4.SS3.p2.16.m4.1.1" xref="S4.SS3.p2.16.m4.1.1.cmml">ψ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.16.m4.1b"><ci id="S4.SS3.p2.16.m4.1.1.cmml" xref="S4.SS3.p2.16.m4.1.1">𝜓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.16.m4.1c">\psi</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.16.m4.1d">italic_ψ</annotation></semantics></math>. <math id="S4.SS3.p2.17.m5.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S4.SS3.p2.17.m5.1a"><mi id="S4.SS3.p2.17.m5.1.1" xref="S4.SS3.p2.17.m5.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.17.m5.1b"><ci id="S4.SS3.p2.17.m5.1.1.cmml" xref="S4.SS3.p2.17.m5.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.17.m5.1c">T</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.17.m5.1d">italic_T</annotation></semantics></math> is the temperature, intended to smooth outputs and <math id="S4.SS3.p2.18.m6.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S4.SS3.p2.18.m6.1a"><mi id="S4.SS3.p2.18.m6.1.1" xref="S4.SS3.p2.18.m6.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.18.m6.1b"><ci id="S4.SS3.p2.18.m6.1.1.cmml" xref="S4.SS3.p2.18.m6.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.18.m6.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.18.m6.1d">italic_λ</annotation></semantics></math> is a balancing weight.</p>
</div>
<div id="S4.SS3.p3" class="ltx_para">
<p id="S4.SS3.p3.7" class="ltx_p">To maximize the use of training data, we propose a mutual distillation strategy, that is, exchange the input trajectory and the augmented trajectory for retraining, so that the two trajectory encoders can see more data to enhance the discriminative ability.
In the mutual distillation strategy, encoders <math id="S4.SS3.p3.1.m1.1" class="ltx_Math" alttext="f_{\theta}" display="inline"><semantics id="S4.SS3.p3.1.m1.1a"><msub id="S4.SS3.p3.1.m1.1.1" xref="S4.SS3.p3.1.m1.1.1.cmml"><mi id="S4.SS3.p3.1.m1.1.1.2" xref="S4.SS3.p3.1.m1.1.1.2.cmml">f</mi><mi id="S4.SS3.p3.1.m1.1.1.3" xref="S4.SS3.p3.1.m1.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.1.m1.1b"><apply id="S4.SS3.p3.1.m1.1.1.cmml" xref="S4.SS3.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.1.m1.1.1.1.cmml" xref="S4.SS3.p3.1.m1.1.1">subscript</csymbol><ci id="S4.SS3.p3.1.m1.1.1.2.cmml" xref="S4.SS3.p3.1.m1.1.1.2">𝑓</ci><ci id="S4.SS3.p3.1.m1.1.1.3.cmml" xref="S4.SS3.p3.1.m1.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.1.m1.1c">f_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.1.m1.1d">italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> and <math id="S4.SS3.p3.2.m2.1" class="ltx_Math" alttext="f_{\phi}" display="inline"><semantics id="S4.SS3.p3.2.m2.1a"><msub id="S4.SS3.p3.2.m2.1.1" xref="S4.SS3.p3.2.m2.1.1.cmml"><mi id="S4.SS3.p3.2.m2.1.1.2" xref="S4.SS3.p3.2.m2.1.1.2.cmml">f</mi><mi id="S4.SS3.p3.2.m2.1.1.3" xref="S4.SS3.p3.2.m2.1.1.3.cmml">ϕ</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.2.m2.1b"><apply id="S4.SS3.p3.2.m2.1.1.cmml" xref="S4.SS3.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.2.m2.1.1.1.cmml" xref="S4.SS3.p3.2.m2.1.1">subscript</csymbol><ci id="S4.SS3.p3.2.m2.1.1.2.cmml" xref="S4.SS3.p3.2.m2.1.1.2">𝑓</ci><ci id="S4.SS3.p3.2.m2.1.1.3.cmml" xref="S4.SS3.p3.2.m2.1.1.3">italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.2.m2.1c">f_{\phi}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.2.m2.1d">italic_f start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT</annotation></semantics></math> are trained collaboratively and treated as peers rather than student/teacher. Specifically, for input trajectory <math id="S4.SS3.p3.3.m3.1" class="ltx_Math" alttext="Tr_{in}" display="inline"><semantics id="S4.SS3.p3.3.m3.1a"><mrow id="S4.SS3.p3.3.m3.1.1" xref="S4.SS3.p3.3.m3.1.1.cmml"><mi id="S4.SS3.p3.3.m3.1.1.2" xref="S4.SS3.p3.3.m3.1.1.2.cmml">T</mi><mo id="S4.SS3.p3.3.m3.1.1.1" xref="S4.SS3.p3.3.m3.1.1.1.cmml">⁢</mo><msub id="S4.SS3.p3.3.m3.1.1.3" xref="S4.SS3.p3.3.m3.1.1.3.cmml"><mi id="S4.SS3.p3.3.m3.1.1.3.2" xref="S4.SS3.p3.3.m3.1.1.3.2.cmml">r</mi><mrow id="S4.SS3.p3.3.m3.1.1.3.3" xref="S4.SS3.p3.3.m3.1.1.3.3.cmml"><mi id="S4.SS3.p3.3.m3.1.1.3.3.2" xref="S4.SS3.p3.3.m3.1.1.3.3.2.cmml">i</mi><mo id="S4.SS3.p3.3.m3.1.1.3.3.1" xref="S4.SS3.p3.3.m3.1.1.3.3.1.cmml">⁢</mo><mi id="S4.SS3.p3.3.m3.1.1.3.3.3" xref="S4.SS3.p3.3.m3.1.1.3.3.3.cmml">n</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.3.m3.1b"><apply id="S4.SS3.p3.3.m3.1.1.cmml" xref="S4.SS3.p3.3.m3.1.1"><times id="S4.SS3.p3.3.m3.1.1.1.cmml" xref="S4.SS3.p3.3.m3.1.1.1"></times><ci id="S4.SS3.p3.3.m3.1.1.2.cmml" xref="S4.SS3.p3.3.m3.1.1.2">𝑇</ci><apply id="S4.SS3.p3.3.m3.1.1.3.cmml" xref="S4.SS3.p3.3.m3.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p3.3.m3.1.1.3.1.cmml" xref="S4.SS3.p3.3.m3.1.1.3">subscript</csymbol><ci id="S4.SS3.p3.3.m3.1.1.3.2.cmml" xref="S4.SS3.p3.3.m3.1.1.3.2">𝑟</ci><apply id="S4.SS3.p3.3.m3.1.1.3.3.cmml" xref="S4.SS3.p3.3.m3.1.1.3.3"><times id="S4.SS3.p3.3.m3.1.1.3.3.1.cmml" xref="S4.SS3.p3.3.m3.1.1.3.3.1"></times><ci id="S4.SS3.p3.3.m3.1.1.3.3.2.cmml" xref="S4.SS3.p3.3.m3.1.1.3.3.2">𝑖</ci><ci id="S4.SS3.p3.3.m3.1.1.3.3.3.cmml" xref="S4.SS3.p3.3.m3.1.1.3.3.3">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.3.m3.1c">Tr_{in}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.3.m3.1d">italic_T italic_r start_POSTSUBSCRIPT italic_i italic_n end_POSTSUBSCRIPT</annotation></semantics></math> and augmented trajectory <math id="S4.SS3.p3.4.m4.1" class="ltx_Math" alttext="Tr_{au}" display="inline"><semantics id="S4.SS3.p3.4.m4.1a"><mrow id="S4.SS3.p3.4.m4.1.1" xref="S4.SS3.p3.4.m4.1.1.cmml"><mi id="S4.SS3.p3.4.m4.1.1.2" xref="S4.SS3.p3.4.m4.1.1.2.cmml">T</mi><mo id="S4.SS3.p3.4.m4.1.1.1" xref="S4.SS3.p3.4.m4.1.1.1.cmml">⁢</mo><msub id="S4.SS3.p3.4.m4.1.1.3" xref="S4.SS3.p3.4.m4.1.1.3.cmml"><mi id="S4.SS3.p3.4.m4.1.1.3.2" xref="S4.SS3.p3.4.m4.1.1.3.2.cmml">r</mi><mrow id="S4.SS3.p3.4.m4.1.1.3.3" xref="S4.SS3.p3.4.m4.1.1.3.3.cmml"><mi id="S4.SS3.p3.4.m4.1.1.3.3.2" xref="S4.SS3.p3.4.m4.1.1.3.3.2.cmml">a</mi><mo id="S4.SS3.p3.4.m4.1.1.3.3.1" xref="S4.SS3.p3.4.m4.1.1.3.3.1.cmml">⁢</mo><mi id="S4.SS3.p3.4.m4.1.1.3.3.3" xref="S4.SS3.p3.4.m4.1.1.3.3.3.cmml">u</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.4.m4.1b"><apply id="S4.SS3.p3.4.m4.1.1.cmml" xref="S4.SS3.p3.4.m4.1.1"><times id="S4.SS3.p3.4.m4.1.1.1.cmml" xref="S4.SS3.p3.4.m4.1.1.1"></times><ci id="S4.SS3.p3.4.m4.1.1.2.cmml" xref="S4.SS3.p3.4.m4.1.1.2">𝑇</ci><apply id="S4.SS3.p3.4.m4.1.1.3.cmml" xref="S4.SS3.p3.4.m4.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p3.4.m4.1.1.3.1.cmml" xref="S4.SS3.p3.4.m4.1.1.3">subscript</csymbol><ci id="S4.SS3.p3.4.m4.1.1.3.2.cmml" xref="S4.SS3.p3.4.m4.1.1.3.2">𝑟</ci><apply id="S4.SS3.p3.4.m4.1.1.3.3.cmml" xref="S4.SS3.p3.4.m4.1.1.3.3"><times id="S4.SS3.p3.4.m4.1.1.3.3.1.cmml" xref="S4.SS3.p3.4.m4.1.1.3.3.1"></times><ci id="S4.SS3.p3.4.m4.1.1.3.3.2.cmml" xref="S4.SS3.p3.4.m4.1.1.3.3.2">𝑎</ci><ci id="S4.SS3.p3.4.m4.1.1.3.3.3.cmml" xref="S4.SS3.p3.4.m4.1.1.3.3.3">𝑢</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.4.m4.1c">Tr_{au}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.4.m4.1d">italic_T italic_r start_POSTSUBSCRIPT italic_a italic_u end_POSTSUBSCRIPT</annotation></semantics></math>, we swap and send them to different encoders to obtain new representations <math id="S4.SS3.p3.5.m5.1" class="ltx_Math" alttext="z_{in}^{\phi}" display="inline"><semantics id="S4.SS3.p3.5.m5.1a"><msubsup id="S4.SS3.p3.5.m5.1.1" xref="S4.SS3.p3.5.m5.1.1.cmml"><mi id="S4.SS3.p3.5.m5.1.1.2.2" xref="S4.SS3.p3.5.m5.1.1.2.2.cmml">z</mi><mrow id="S4.SS3.p3.5.m5.1.1.2.3" xref="S4.SS3.p3.5.m5.1.1.2.3.cmml"><mi id="S4.SS3.p3.5.m5.1.1.2.3.2" xref="S4.SS3.p3.5.m5.1.1.2.3.2.cmml">i</mi><mo id="S4.SS3.p3.5.m5.1.1.2.3.1" xref="S4.SS3.p3.5.m5.1.1.2.3.1.cmml">⁢</mo><mi id="S4.SS3.p3.5.m5.1.1.2.3.3" xref="S4.SS3.p3.5.m5.1.1.2.3.3.cmml">n</mi></mrow><mi id="S4.SS3.p3.5.m5.1.1.3" xref="S4.SS3.p3.5.m5.1.1.3.cmml">ϕ</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.5.m5.1b"><apply id="S4.SS3.p3.5.m5.1.1.cmml" xref="S4.SS3.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.5.m5.1.1.1.cmml" xref="S4.SS3.p3.5.m5.1.1">superscript</csymbol><apply id="S4.SS3.p3.5.m5.1.1.2.cmml" xref="S4.SS3.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.5.m5.1.1.2.1.cmml" xref="S4.SS3.p3.5.m5.1.1">subscript</csymbol><ci id="S4.SS3.p3.5.m5.1.1.2.2.cmml" xref="S4.SS3.p3.5.m5.1.1.2.2">𝑧</ci><apply id="S4.SS3.p3.5.m5.1.1.2.3.cmml" xref="S4.SS3.p3.5.m5.1.1.2.3"><times id="S4.SS3.p3.5.m5.1.1.2.3.1.cmml" xref="S4.SS3.p3.5.m5.1.1.2.3.1"></times><ci id="S4.SS3.p3.5.m5.1.1.2.3.2.cmml" xref="S4.SS3.p3.5.m5.1.1.2.3.2">𝑖</ci><ci id="S4.SS3.p3.5.m5.1.1.2.3.3.cmml" xref="S4.SS3.p3.5.m5.1.1.2.3.3">𝑛</ci></apply></apply><ci id="S4.SS3.p3.5.m5.1.1.3.cmml" xref="S4.SS3.p3.5.m5.1.1.3">italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.5.m5.1c">z_{in}^{\phi}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.5.m5.1d">italic_z start_POSTSUBSCRIPT italic_i italic_n end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_ϕ end_POSTSUPERSCRIPT</annotation></semantics></math> and <math id="S4.SS3.p3.6.m6.1" class="ltx_Math" alttext="z_{au}^{\theta}" display="inline"><semantics id="S4.SS3.p3.6.m6.1a"><msubsup id="S4.SS3.p3.6.m6.1.1" xref="S4.SS3.p3.6.m6.1.1.cmml"><mi id="S4.SS3.p3.6.m6.1.1.2.2" xref="S4.SS3.p3.6.m6.1.1.2.2.cmml">z</mi><mrow id="S4.SS3.p3.6.m6.1.1.2.3" xref="S4.SS3.p3.6.m6.1.1.2.3.cmml"><mi id="S4.SS3.p3.6.m6.1.1.2.3.2" xref="S4.SS3.p3.6.m6.1.1.2.3.2.cmml">a</mi><mo id="S4.SS3.p3.6.m6.1.1.2.3.1" xref="S4.SS3.p3.6.m6.1.1.2.3.1.cmml">⁢</mo><mi id="S4.SS3.p3.6.m6.1.1.2.3.3" xref="S4.SS3.p3.6.m6.1.1.2.3.3.cmml">u</mi></mrow><mi id="S4.SS3.p3.6.m6.1.1.3" xref="S4.SS3.p3.6.m6.1.1.3.cmml">θ</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.6.m6.1b"><apply id="S4.SS3.p3.6.m6.1.1.cmml" xref="S4.SS3.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.6.m6.1.1.1.cmml" xref="S4.SS3.p3.6.m6.1.1">superscript</csymbol><apply id="S4.SS3.p3.6.m6.1.1.2.cmml" xref="S4.SS3.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.6.m6.1.1.2.1.cmml" xref="S4.SS3.p3.6.m6.1.1">subscript</csymbol><ci id="S4.SS3.p3.6.m6.1.1.2.2.cmml" xref="S4.SS3.p3.6.m6.1.1.2.2">𝑧</ci><apply id="S4.SS3.p3.6.m6.1.1.2.3.cmml" xref="S4.SS3.p3.6.m6.1.1.2.3"><times id="S4.SS3.p3.6.m6.1.1.2.3.1.cmml" xref="S4.SS3.p3.6.m6.1.1.2.3.1"></times><ci id="S4.SS3.p3.6.m6.1.1.2.3.2.cmml" xref="S4.SS3.p3.6.m6.1.1.2.3.2">𝑎</ci><ci id="S4.SS3.p3.6.m6.1.1.2.3.3.cmml" xref="S4.SS3.p3.6.m6.1.1.2.3.3">𝑢</ci></apply></apply><ci id="S4.SS3.p3.6.m6.1.1.3.cmml" xref="S4.SS3.p3.6.m6.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.6.m6.1c">z_{au}^{\theta}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.6.m6.1d">italic_z start_POSTSUBSCRIPT italic_a italic_u end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_θ end_POSTSUPERSCRIPT</annotation></semantics></math>, and calculate the loss function <math id="S4.SS3.p3.7.m7.1" class="ltx_Math" alttext="\mathcal{L}_{2}" display="inline"><semantics id="S4.SS3.p3.7.m7.1a"><msub id="S4.SS3.p3.7.m7.1.1" xref="S4.SS3.p3.7.m7.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p3.7.m7.1.1.2" xref="S4.SS3.p3.7.m7.1.1.2.cmml">ℒ</mi><mn id="S4.SS3.p3.7.m7.1.1.3" xref="S4.SS3.p3.7.m7.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.7.m7.1b"><apply id="S4.SS3.p3.7.m7.1.1.cmml" xref="S4.SS3.p3.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.7.m7.1.1.1.cmml" xref="S4.SS3.p3.7.m7.1.1">subscript</csymbol><ci id="S4.SS3.p3.7.m7.1.1.2.cmml" xref="S4.SS3.p3.7.m7.1.1.2">ℒ</ci><cn type="integer" id="S4.SS3.p3.7.m7.1.1.3.cmml" xref="S4.SS3.p3.7.m7.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.7.m7.1c">\mathcal{L}_{2}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.7.m7.1d">caligraphic_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> as follows:</p>
<table id="S4.E8" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E8.m1.49" class="ltx_Math" alttext="\begin{split}\mathcal{L}_{2}=&amp;\mathcal{H}(y,z_{in}^{\phi})+\mathcal{H}(y,z_{au%
}^{\theta})+\\
&amp;\lambda T^{2}\operatorname{KL}(\varphi(z_{in}^{\phi}/T),\psi(z_{au}^{\theta}/%
T)).\end{split}" display="block"><semantics id="S4.E8.m1.49a"><mtable columnspacing="0pt" displaystyle="true" rowspacing="0pt" id="S4.E8.m1.49.49.4"><mtr id="S4.E8.m1.49.49.4a"><mtd columnalign="right" id="S4.E8.m1.49.49.4b"><mrow id="S4.E8.m1.3.3.3.3.3"><msub id="S4.E8.m1.3.3.3.3.3.4"><mi class="ltx_font_mathcaligraphic" id="S4.E8.m1.1.1.1.1.1.1" xref="S4.E8.m1.1.1.1.1.1.1.cmml">ℒ</mi><mn id="S4.E8.m1.2.2.2.2.2.2.1" xref="S4.E8.m1.2.2.2.2.2.2.1.cmml">2</mn></msub><mo id="S4.E8.m1.3.3.3.3.3.3" xref="S4.E8.m1.3.3.3.3.3.3.cmml">=</mo><mi id="S4.E8.m1.3.3.3.3.3.5" xref="S4.E8.m1.46.46.1.1.1.cmml"></mi></mrow></mtd><mtd columnalign="left" id="S4.E8.m1.49.49.4c"><mrow id="S4.E8.m1.48.48.3.47.23.20"><mrow id="S4.E8.m1.47.47.2.46.22.19.19"><mi class="ltx_font_mathcaligraphic" id="S4.E8.m1.4.4.4.4.1.1" xref="S4.E8.m1.4.4.4.4.1.1.cmml">ℋ</mi><mo id="S4.E8.m1.47.47.2.46.22.19.19.2" xref="S4.E8.m1.46.46.1.1.1.cmml">⁢</mo><mrow id="S4.E8.m1.47.47.2.46.22.19.19.1.1"><mo stretchy="false" id="S4.E8.m1.5.5.5.5.2.2" xref="S4.E8.m1.46.46.1.1.1.cmml">(</mo><mi id="S4.E8.m1.6.6.6.6.3.3" xref="S4.E8.m1.6.6.6.6.3.3.cmml">y</mi><mo id="S4.E8.m1.7.7.7.7.4.4" xref="S4.E8.m1.46.46.1.1.1.cmml">,</mo><msubsup id="S4.E8.m1.47.47.2.46.22.19.19.1.1.1"><mi id="S4.E8.m1.8.8.8.8.5.5" xref="S4.E8.m1.8.8.8.8.5.5.cmml">z</mi><mrow id="S4.E8.m1.9.9.9.9.6.6.1" xref="S4.E8.m1.9.9.9.9.6.6.1.cmml"><mi id="S4.E8.m1.9.9.9.9.6.6.1.2" xref="S4.E8.m1.9.9.9.9.6.6.1.2.cmml">i</mi><mo id="S4.E8.m1.9.9.9.9.6.6.1.1" xref="S4.E8.m1.9.9.9.9.6.6.1.1.cmml">⁢</mo><mi id="S4.E8.m1.9.9.9.9.6.6.1.3" xref="S4.E8.m1.9.9.9.9.6.6.1.3.cmml">n</mi></mrow><mi id="S4.E8.m1.10.10.10.10.7.7.1" xref="S4.E8.m1.10.10.10.10.7.7.1.cmml">ϕ</mi></msubsup><mo stretchy="false" id="S4.E8.m1.11.11.11.11.8.8" xref="S4.E8.m1.46.46.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E8.m1.12.12.12.12.9.9" xref="S4.E8.m1.12.12.12.12.9.9.cmml">+</mo><mrow id="S4.E8.m1.48.48.3.47.23.20.20"><mrow id="S4.E8.m1.48.48.3.47.23.20.20.1"><mi class="ltx_font_mathcaligraphic" id="S4.E8.m1.13.13.13.13.10.10" xref="S4.E8.m1.13.13.13.13.10.10.cmml">ℋ</mi><mo id="S4.E8.m1.48.48.3.47.23.20.20.1.2" xref="S4.E8.m1.46.46.1.1.1.cmml">⁢</mo><mrow id="S4.E8.m1.48.48.3.47.23.20.20.1.1.1"><mo stretchy="false" id="S4.E8.m1.14.14.14.14.11.11" xref="S4.E8.m1.46.46.1.1.1.cmml">(</mo><mi id="S4.E8.m1.15.15.15.15.12.12" xref="S4.E8.m1.15.15.15.15.12.12.cmml">y</mi><mo id="S4.E8.m1.16.16.16.16.13.13" xref="S4.E8.m1.46.46.1.1.1.cmml">,</mo><msubsup id="S4.E8.m1.48.48.3.47.23.20.20.1.1.1.1"><mi id="S4.E8.m1.17.17.17.17.14.14" xref="S4.E8.m1.17.17.17.17.14.14.cmml">z</mi><mrow id="S4.E8.m1.18.18.18.18.15.15.1" xref="S4.E8.m1.18.18.18.18.15.15.1.cmml"><mi id="S4.E8.m1.18.18.18.18.15.15.1.2" xref="S4.E8.m1.18.18.18.18.15.15.1.2.cmml">a</mi><mo id="S4.E8.m1.18.18.18.18.15.15.1.1" xref="S4.E8.m1.18.18.18.18.15.15.1.1.cmml">⁢</mo><mi id="S4.E8.m1.18.18.18.18.15.15.1.3" xref="S4.E8.m1.18.18.18.18.15.15.1.3.cmml">u</mi></mrow><mi id="S4.E8.m1.19.19.19.19.16.16.1" xref="S4.E8.m1.19.19.19.19.16.16.1.cmml">θ</mi></msubsup><mo stretchy="false" id="S4.E8.m1.20.20.20.20.17.17" xref="S4.E8.m1.46.46.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E8.m1.21.21.21.21.18.18" xref="S4.E8.m1.46.46.1.1.1.cmml">+</mo></mrow></mrow></mtd></mtr><mtr id="S4.E8.m1.49.49.4d"><mtd id="S4.E8.m1.49.49.4e" xref="S4.E8.m1.46.46.1.1.1.cmml"></mtd><mtd columnalign="left" id="S4.E8.m1.49.49.4f"><mrow id="S4.E8.m1.49.49.4.48.25.25.25"><mrow id="S4.E8.m1.49.49.4.48.25.25.25.1"><mi id="S4.E8.m1.22.22.22.1.1.1" xref="S4.E8.m1.22.22.22.1.1.1.cmml">λ</mi><mo id="S4.E8.m1.49.49.4.48.25.25.25.1.3" xref="S4.E8.m1.46.46.1.1.1.cmml">⁢</mo><msup id="S4.E8.m1.49.49.4.48.25.25.25.1.4"><mi id="S4.E8.m1.23.23.23.2.2.2" xref="S4.E8.m1.23.23.23.2.2.2.cmml">T</mi><mn id="S4.E8.m1.24.24.24.3.3.3.1" xref="S4.E8.m1.24.24.24.3.3.3.1.cmml">2</mn></msup><mo id="S4.E8.m1.49.49.4.48.25.25.25.1.3a" xref="S4.E8.m1.46.46.1.1.1.cmml">⁢</mo><mrow id="S4.E8.m1.49.49.4.48.25.25.25.1.2.2"><mi id="S4.E8.m1.25.25.25.4.4.4" xref="S4.E8.m1.25.25.25.4.4.4.cmml">KL</mi><mo id="S4.E8.m1.49.49.4.48.25.25.25.1.2.2a" xref="S4.E8.m1.46.46.1.1.1.cmml">⁡</mo><mrow id="S4.E8.m1.49.49.4.48.25.25.25.1.2.2.2"><mo stretchy="false" id="S4.E8.m1.26.26.26.5.5.5" xref="S4.E8.m1.46.46.1.1.1.cmml">(</mo><mrow id="S4.E8.m1.49.49.4.48.25.25.25.1.1.1.1.1"><mi id="S4.E8.m1.27.27.27.6.6.6" xref="S4.E8.m1.27.27.27.6.6.6.cmml">φ</mi><mo id="S4.E8.m1.49.49.4.48.25.25.25.1.1.1.1.1.2" xref="S4.E8.m1.46.46.1.1.1.cmml">⁢</mo><mrow id="S4.E8.m1.49.49.4.48.25.25.25.1.1.1.1.1.1.1"><mo stretchy="false" id="S4.E8.m1.28.28.28.7.7.7" xref="S4.E8.m1.46.46.1.1.1.cmml">(</mo><mrow id="S4.E8.m1.49.49.4.48.25.25.25.1.1.1.1.1.1.1.1"><msubsup id="S4.E8.m1.49.49.4.48.25.25.25.1.1.1.1.1.1.1.1.1"><mi id="S4.E8.m1.29.29.29.8.8.8" xref="S4.E8.m1.29.29.29.8.8.8.cmml">z</mi><mrow id="S4.E8.m1.30.30.30.9.9.9.1" xref="S4.E8.m1.30.30.30.9.9.9.1.cmml"><mi id="S4.E8.m1.30.30.30.9.9.9.1.2" xref="S4.E8.m1.30.30.30.9.9.9.1.2.cmml">i</mi><mo id="S4.E8.m1.30.30.30.9.9.9.1.1" xref="S4.E8.m1.30.30.30.9.9.9.1.1.cmml">⁢</mo><mi id="S4.E8.m1.30.30.30.9.9.9.1.3" xref="S4.E8.m1.30.30.30.9.9.9.1.3.cmml">n</mi></mrow><mi id="S4.E8.m1.31.31.31.10.10.10.1" xref="S4.E8.m1.31.31.31.10.10.10.1.cmml">ϕ</mi></msubsup><mo id="S4.E8.m1.32.32.32.11.11.11" xref="S4.E8.m1.32.32.32.11.11.11.cmml">/</mo><mi id="S4.E8.m1.33.33.33.12.12.12" xref="S4.E8.m1.33.33.33.12.12.12.cmml">T</mi></mrow><mo stretchy="false" id="S4.E8.m1.34.34.34.13.13.13" xref="S4.E8.m1.46.46.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E8.m1.35.35.35.14.14.14" xref="S4.E8.m1.46.46.1.1.1.cmml">,</mo><mrow id="S4.E8.m1.49.49.4.48.25.25.25.1.2.2.2.2"><mi id="S4.E8.m1.36.36.36.15.15.15" xref="S4.E8.m1.36.36.36.15.15.15.cmml">ψ</mi><mo id="S4.E8.m1.49.49.4.48.25.25.25.1.2.2.2.2.2" xref="S4.E8.m1.46.46.1.1.1.cmml">⁢</mo><mrow id="S4.E8.m1.49.49.4.48.25.25.25.1.2.2.2.2.1.1"><mo stretchy="false" id="S4.E8.m1.37.37.37.16.16.16" xref="S4.E8.m1.46.46.1.1.1.cmml">(</mo><mrow id="S4.E8.m1.49.49.4.48.25.25.25.1.2.2.2.2.1.1.1"><msubsup id="S4.E8.m1.49.49.4.48.25.25.25.1.2.2.2.2.1.1.1.1"><mi id="S4.E8.m1.38.38.38.17.17.17" xref="S4.E8.m1.38.38.38.17.17.17.cmml">z</mi><mrow id="S4.E8.m1.39.39.39.18.18.18.1" xref="S4.E8.m1.39.39.39.18.18.18.1.cmml"><mi id="S4.E8.m1.39.39.39.18.18.18.1.2" xref="S4.E8.m1.39.39.39.18.18.18.1.2.cmml">a</mi><mo id="S4.E8.m1.39.39.39.18.18.18.1.1" xref="S4.E8.m1.39.39.39.18.18.18.1.1.cmml">⁢</mo><mi id="S4.E8.m1.39.39.39.18.18.18.1.3" xref="S4.E8.m1.39.39.39.18.18.18.1.3.cmml">u</mi></mrow><mi id="S4.E8.m1.40.40.40.19.19.19.1" xref="S4.E8.m1.40.40.40.19.19.19.1.cmml">θ</mi></msubsup><mo id="S4.E8.m1.41.41.41.20.20.20" xref="S4.E8.m1.41.41.41.20.20.20.cmml">/</mo><mi id="S4.E8.m1.42.42.42.21.21.21" xref="S4.E8.m1.42.42.42.21.21.21.cmml">T</mi></mrow><mo stretchy="false" id="S4.E8.m1.43.43.43.22.22.22" xref="S4.E8.m1.46.46.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S4.E8.m1.44.44.44.23.23.23" xref="S4.E8.m1.46.46.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E8.m1.45.45.45.24.24.24" xref="S4.E8.m1.46.46.1.1.1.cmml">.</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S4.E8.m1.49b"><apply id="S4.E8.m1.46.46.1.1.1.cmml" xref="S4.E8.m1.3.3.3.3.3.5"><eq id="S4.E8.m1.3.3.3.3.3.3.cmml" xref="S4.E8.m1.3.3.3.3.3.3"></eq><apply id="S4.E8.m1.46.46.1.1.1.6.cmml" xref="S4.E8.m1.3.3.3.3.3.5"><csymbol cd="ambiguous" id="S4.E8.m1.46.46.1.1.1.6.1.cmml" xref="S4.E8.m1.3.3.3.3.3.5">subscript</csymbol><ci id="S4.E8.m1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.1.1.1.1.1.1">ℒ</ci><cn type="integer" id="S4.E8.m1.2.2.2.2.2.2.1.cmml" xref="S4.E8.m1.2.2.2.2.2.2.1">2</cn></apply><apply id="S4.E8.m1.46.46.1.1.1.4.cmml" xref="S4.E8.m1.3.3.3.3.3.5"><plus id="S4.E8.m1.12.12.12.12.9.9.cmml" xref="S4.E8.m1.12.12.12.12.9.9"></plus><apply id="S4.E8.m1.46.46.1.1.1.1.1.cmml" xref="S4.E8.m1.3.3.3.3.3.5"><times id="S4.E8.m1.46.46.1.1.1.1.1.2.cmml" xref="S4.E8.m1.3.3.3.3.3.5"></times><ci id="S4.E8.m1.4.4.4.4.1.1.cmml" xref="S4.E8.m1.4.4.4.4.1.1">ℋ</ci><interval closure="open" id="S4.E8.m1.46.46.1.1.1.1.1.1.2.cmml" xref="S4.E8.m1.3.3.3.3.3.5"><ci id="S4.E8.m1.6.6.6.6.3.3.cmml" xref="S4.E8.m1.6.6.6.6.3.3">𝑦</ci><apply id="S4.E8.m1.46.46.1.1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.3.3.3.3.3.5"><csymbol cd="ambiguous" id="S4.E8.m1.46.46.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.3.3.3.3.3.5">superscript</csymbol><apply id="S4.E8.m1.46.46.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E8.m1.3.3.3.3.3.5"><csymbol cd="ambiguous" id="S4.E8.m1.46.46.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E8.m1.3.3.3.3.3.5">subscript</csymbol><ci id="S4.E8.m1.8.8.8.8.5.5.cmml" xref="S4.E8.m1.8.8.8.8.5.5">𝑧</ci><apply id="S4.E8.m1.9.9.9.9.6.6.1.cmml" xref="S4.E8.m1.9.9.9.9.6.6.1"><times id="S4.E8.m1.9.9.9.9.6.6.1.1.cmml" xref="S4.E8.m1.9.9.9.9.6.6.1.1"></times><ci id="S4.E8.m1.9.9.9.9.6.6.1.2.cmml" xref="S4.E8.m1.9.9.9.9.6.6.1.2">𝑖</ci><ci id="S4.E8.m1.9.9.9.9.6.6.1.3.cmml" xref="S4.E8.m1.9.9.9.9.6.6.1.3">𝑛</ci></apply></apply><ci id="S4.E8.m1.10.10.10.10.7.7.1.cmml" xref="S4.E8.m1.10.10.10.10.7.7.1">italic-ϕ</ci></apply></interval></apply><apply id="S4.E8.m1.46.46.1.1.1.2.2.cmml" xref="S4.E8.m1.3.3.3.3.3.5"><times id="S4.E8.m1.46.46.1.1.1.2.2.2.cmml" xref="S4.E8.m1.3.3.3.3.3.5"></times><ci id="S4.E8.m1.13.13.13.13.10.10.cmml" xref="S4.E8.m1.13.13.13.13.10.10">ℋ</ci><interval closure="open" id="S4.E8.m1.46.46.1.1.1.2.2.1.2.cmml" xref="S4.E8.m1.3.3.3.3.3.5"><ci id="S4.E8.m1.15.15.15.15.12.12.cmml" xref="S4.E8.m1.15.15.15.15.12.12">𝑦</ci><apply id="S4.E8.m1.46.46.1.1.1.2.2.1.1.1.cmml" xref="S4.E8.m1.3.3.3.3.3.5"><csymbol cd="ambiguous" id="S4.E8.m1.46.46.1.1.1.2.2.1.1.1.1.cmml" xref="S4.E8.m1.3.3.3.3.3.5">superscript</csymbol><apply id="S4.E8.m1.46.46.1.1.1.2.2.1.1.1.2.cmml" xref="S4.E8.m1.3.3.3.3.3.5"><csymbol cd="ambiguous" id="S4.E8.m1.46.46.1.1.1.2.2.1.1.1.2.1.cmml" xref="S4.E8.m1.3.3.3.3.3.5">subscript</csymbol><ci id="S4.E8.m1.17.17.17.17.14.14.cmml" xref="S4.E8.m1.17.17.17.17.14.14">𝑧</ci><apply id="S4.E8.m1.18.18.18.18.15.15.1.cmml" xref="S4.E8.m1.18.18.18.18.15.15.1"><times id="S4.E8.m1.18.18.18.18.15.15.1.1.cmml" xref="S4.E8.m1.18.18.18.18.15.15.1.1"></times><ci id="S4.E8.m1.18.18.18.18.15.15.1.2.cmml" xref="S4.E8.m1.18.18.18.18.15.15.1.2">𝑎</ci><ci id="S4.E8.m1.18.18.18.18.15.15.1.3.cmml" xref="S4.E8.m1.18.18.18.18.15.15.1.3">𝑢</ci></apply></apply><ci id="S4.E8.m1.19.19.19.19.16.16.1.cmml" xref="S4.E8.m1.19.19.19.19.16.16.1">𝜃</ci></apply></interval></apply><apply id="S4.E8.m1.46.46.1.1.1.4.4.cmml" xref="S4.E8.m1.3.3.3.3.3.5"><times id="S4.E8.m1.46.46.1.1.1.4.4.3.cmml" xref="S4.E8.m1.3.3.3.3.3.5"></times><ci id="S4.E8.m1.22.22.22.1.1.1.cmml" xref="S4.E8.m1.22.22.22.1.1.1">𝜆</ci><apply id="S4.E8.m1.46.46.1.1.1.4.4.5.cmml" xref="S4.E8.m1.3.3.3.3.3.5"><csymbol cd="ambiguous" id="S4.E8.m1.46.46.1.1.1.4.4.5.1.cmml" xref="S4.E8.m1.3.3.3.3.3.5">superscript</csymbol><ci id="S4.E8.m1.23.23.23.2.2.2.cmml" xref="S4.E8.m1.23.23.23.2.2.2">𝑇</ci><cn type="integer" id="S4.E8.m1.24.24.24.3.3.3.1.cmml" xref="S4.E8.m1.24.24.24.3.3.3.1">2</cn></apply><apply id="S4.E8.m1.46.46.1.1.1.4.4.2.3.cmml" xref="S4.E8.m1.3.3.3.3.3.5"><ci id="S4.E8.m1.25.25.25.4.4.4.cmml" xref="S4.E8.m1.25.25.25.4.4.4">KL</ci><apply id="S4.E8.m1.46.46.1.1.1.3.3.1.1.1.1.cmml" xref="S4.E8.m1.3.3.3.3.3.5"><times id="S4.E8.m1.46.46.1.1.1.3.3.1.1.1.1.2.cmml" xref="S4.E8.m1.3.3.3.3.3.5"></times><ci id="S4.E8.m1.27.27.27.6.6.6.cmml" xref="S4.E8.m1.27.27.27.6.6.6">𝜑</ci><apply id="S4.E8.m1.46.46.1.1.1.3.3.1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.3.3.3.3.3.5"><divide id="S4.E8.m1.32.32.32.11.11.11.cmml" xref="S4.E8.m1.32.32.32.11.11.11"></divide><apply id="S4.E8.m1.46.46.1.1.1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S4.E8.m1.3.3.3.3.3.5"><csymbol cd="ambiguous" id="S4.E8.m1.46.46.1.1.1.3.3.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E8.m1.3.3.3.3.3.5">superscript</csymbol><apply id="S4.E8.m1.46.46.1.1.1.3.3.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E8.m1.3.3.3.3.3.5"><csymbol cd="ambiguous" id="S4.E8.m1.46.46.1.1.1.3.3.1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E8.m1.3.3.3.3.3.5">subscript</csymbol><ci id="S4.E8.m1.29.29.29.8.8.8.cmml" xref="S4.E8.m1.29.29.29.8.8.8">𝑧</ci><apply id="S4.E8.m1.30.30.30.9.9.9.1.cmml" xref="S4.E8.m1.30.30.30.9.9.9.1"><times id="S4.E8.m1.30.30.30.9.9.9.1.1.cmml" xref="S4.E8.m1.30.30.30.9.9.9.1.1"></times><ci id="S4.E8.m1.30.30.30.9.9.9.1.2.cmml" xref="S4.E8.m1.30.30.30.9.9.9.1.2">𝑖</ci><ci id="S4.E8.m1.30.30.30.9.9.9.1.3.cmml" xref="S4.E8.m1.30.30.30.9.9.9.1.3">𝑛</ci></apply></apply><ci id="S4.E8.m1.31.31.31.10.10.10.1.cmml" xref="S4.E8.m1.31.31.31.10.10.10.1">italic-ϕ</ci></apply><ci id="S4.E8.m1.33.33.33.12.12.12.cmml" xref="S4.E8.m1.33.33.33.12.12.12">𝑇</ci></apply></apply><apply id="S4.E8.m1.46.46.1.1.1.4.4.2.2.2.2.cmml" xref="S4.E8.m1.3.3.3.3.3.5"><times id="S4.E8.m1.46.46.1.1.1.4.4.2.2.2.2.2.cmml" xref="S4.E8.m1.3.3.3.3.3.5"></times><ci id="S4.E8.m1.36.36.36.15.15.15.cmml" xref="S4.E8.m1.36.36.36.15.15.15">𝜓</ci><apply id="S4.E8.m1.46.46.1.1.1.4.4.2.2.2.2.1.1.1.cmml" xref="S4.E8.m1.3.3.3.3.3.5"><divide id="S4.E8.m1.41.41.41.20.20.20.cmml" xref="S4.E8.m1.41.41.41.20.20.20"></divide><apply id="S4.E8.m1.46.46.1.1.1.4.4.2.2.2.2.1.1.1.2.cmml" xref="S4.E8.m1.3.3.3.3.3.5"><csymbol cd="ambiguous" id="S4.E8.m1.46.46.1.1.1.4.4.2.2.2.2.1.1.1.2.1.cmml" xref="S4.E8.m1.3.3.3.3.3.5">superscript</csymbol><apply id="S4.E8.m1.46.46.1.1.1.4.4.2.2.2.2.1.1.1.2.2.cmml" xref="S4.E8.m1.3.3.3.3.3.5"><csymbol cd="ambiguous" id="S4.E8.m1.46.46.1.1.1.4.4.2.2.2.2.1.1.1.2.2.1.cmml" xref="S4.E8.m1.3.3.3.3.3.5">subscript</csymbol><ci id="S4.E8.m1.38.38.38.17.17.17.cmml" xref="S4.E8.m1.38.38.38.17.17.17">𝑧</ci><apply id="S4.E8.m1.39.39.39.18.18.18.1.cmml" xref="S4.E8.m1.39.39.39.18.18.18.1"><times id="S4.E8.m1.39.39.39.18.18.18.1.1.cmml" xref="S4.E8.m1.39.39.39.18.18.18.1.1"></times><ci id="S4.E8.m1.39.39.39.18.18.18.1.2.cmml" xref="S4.E8.m1.39.39.39.18.18.18.1.2">𝑎</ci><ci id="S4.E8.m1.39.39.39.18.18.18.1.3.cmml" xref="S4.E8.m1.39.39.39.18.18.18.1.3">𝑢</ci></apply></apply><ci id="S4.E8.m1.40.40.40.19.19.19.1.cmml" xref="S4.E8.m1.40.40.40.19.19.19.1">𝜃</ci></apply><ci id="S4.E8.m1.42.42.42.21.21.21.cmml" xref="S4.E8.m1.42.42.42.21.21.21">𝑇</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E8.m1.49c">\begin{split}\mathcal{L}_{2}=&amp;\mathcal{H}(y,z_{in}^{\phi})+\mathcal{H}(y,z_{au%
}^{\theta})+\\
&amp;\lambda T^{2}\operatorname{KL}(\varphi(z_{in}^{\phi}/T),\psi(z_{au}^{\theta}/%
T)).\end{split}</annotation><annotation encoding="application/x-llamapun" id="S4.E8.m1.49d">start_ROW start_CELL caligraphic_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT = end_CELL start_CELL caligraphic_H ( italic_y , italic_z start_POSTSUBSCRIPT italic_i italic_n end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_ϕ end_POSTSUPERSCRIPT ) + caligraphic_H ( italic_y , italic_z start_POSTSUBSCRIPT italic_a italic_u end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_θ end_POSTSUPERSCRIPT ) + end_CELL end_ROW start_ROW start_CELL end_CELL start_CELL italic_λ italic_T start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT roman_KL ( italic_φ ( italic_z start_POSTSUBSCRIPT italic_i italic_n end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_ϕ end_POSTSUPERSCRIPT / italic_T ) , italic_ψ ( italic_z start_POSTSUBSCRIPT italic_a italic_u end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_θ end_POSTSUPERSCRIPT / italic_T ) ) . end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr>
</table>
</div>
<div id="S4.SS3.p4" class="ltx_para">
<p id="S4.SS3.p4.1" class="ltx_p">This operation can also be regarded as a data augmentation strategy. Although the RNN encoder is not specially designed for long-term trajectory data, it is also beneficial to use more trajectory sequences related to the input trajectory during training. Our final loss function for optimizing mutual distillation network is:</p>
<table id="S4.E9" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E9.m1.1" class="ltx_Math" alttext="\mathcal{L}_{total}=\mathcal{L}_{1}+\mathcal{L}_{2}." display="block"><semantics id="S4.E9.m1.1a"><mrow id="S4.E9.m1.1.1.1" xref="S4.E9.m1.1.1.1.1.cmml"><mrow id="S4.E9.m1.1.1.1.1" xref="S4.E9.m1.1.1.1.1.cmml"><msub id="S4.E9.m1.1.1.1.1.2" xref="S4.E9.m1.1.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E9.m1.1.1.1.1.2.2" xref="S4.E9.m1.1.1.1.1.2.2.cmml">ℒ</mi><mrow id="S4.E9.m1.1.1.1.1.2.3" xref="S4.E9.m1.1.1.1.1.2.3.cmml"><mi id="S4.E9.m1.1.1.1.1.2.3.2" xref="S4.E9.m1.1.1.1.1.2.3.2.cmml">t</mi><mo id="S4.E9.m1.1.1.1.1.2.3.1" xref="S4.E9.m1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S4.E9.m1.1.1.1.1.2.3.3" xref="S4.E9.m1.1.1.1.1.2.3.3.cmml">o</mi><mo id="S4.E9.m1.1.1.1.1.2.3.1a" xref="S4.E9.m1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S4.E9.m1.1.1.1.1.2.3.4" xref="S4.E9.m1.1.1.1.1.2.3.4.cmml">t</mi><mo id="S4.E9.m1.1.1.1.1.2.3.1b" xref="S4.E9.m1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S4.E9.m1.1.1.1.1.2.3.5" xref="S4.E9.m1.1.1.1.1.2.3.5.cmml">a</mi><mo id="S4.E9.m1.1.1.1.1.2.3.1c" xref="S4.E9.m1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S4.E9.m1.1.1.1.1.2.3.6" xref="S4.E9.m1.1.1.1.1.2.3.6.cmml">l</mi></mrow></msub><mo id="S4.E9.m1.1.1.1.1.1" xref="S4.E9.m1.1.1.1.1.1.cmml">=</mo><mrow id="S4.E9.m1.1.1.1.1.3" xref="S4.E9.m1.1.1.1.1.3.cmml"><msub id="S4.E9.m1.1.1.1.1.3.2" xref="S4.E9.m1.1.1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E9.m1.1.1.1.1.3.2.2" xref="S4.E9.m1.1.1.1.1.3.2.2.cmml">ℒ</mi><mn id="S4.E9.m1.1.1.1.1.3.2.3" xref="S4.E9.m1.1.1.1.1.3.2.3.cmml">1</mn></msub><mo id="S4.E9.m1.1.1.1.1.3.1" xref="S4.E9.m1.1.1.1.1.3.1.cmml">+</mo><msub id="S4.E9.m1.1.1.1.1.3.3" xref="S4.E9.m1.1.1.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E9.m1.1.1.1.1.3.3.2" xref="S4.E9.m1.1.1.1.1.3.3.2.cmml">ℒ</mi><mn id="S4.E9.m1.1.1.1.1.3.3.3" xref="S4.E9.m1.1.1.1.1.3.3.3.cmml">2</mn></msub></mrow></mrow><mo id="S4.E9.m1.1.1.1.2" xref="S4.E9.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E9.m1.1b"><apply id="S4.E9.m1.1.1.1.1.cmml" xref="S4.E9.m1.1.1.1"><eq id="S4.E9.m1.1.1.1.1.1.cmml" xref="S4.E9.m1.1.1.1.1.1"></eq><apply id="S4.E9.m1.1.1.1.1.2.cmml" xref="S4.E9.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E9.m1.1.1.1.1.2.1.cmml" xref="S4.E9.m1.1.1.1.1.2">subscript</csymbol><ci id="S4.E9.m1.1.1.1.1.2.2.cmml" xref="S4.E9.m1.1.1.1.1.2.2">ℒ</ci><apply id="S4.E9.m1.1.1.1.1.2.3.cmml" xref="S4.E9.m1.1.1.1.1.2.3"><times id="S4.E9.m1.1.1.1.1.2.3.1.cmml" xref="S4.E9.m1.1.1.1.1.2.3.1"></times><ci id="S4.E9.m1.1.1.1.1.2.3.2.cmml" xref="S4.E9.m1.1.1.1.1.2.3.2">𝑡</ci><ci id="S4.E9.m1.1.1.1.1.2.3.3.cmml" xref="S4.E9.m1.1.1.1.1.2.3.3">𝑜</ci><ci id="S4.E9.m1.1.1.1.1.2.3.4.cmml" xref="S4.E9.m1.1.1.1.1.2.3.4">𝑡</ci><ci id="S4.E9.m1.1.1.1.1.2.3.5.cmml" xref="S4.E9.m1.1.1.1.1.2.3.5">𝑎</ci><ci id="S4.E9.m1.1.1.1.1.2.3.6.cmml" xref="S4.E9.m1.1.1.1.1.2.3.6">𝑙</ci></apply></apply><apply id="S4.E9.m1.1.1.1.1.3.cmml" xref="S4.E9.m1.1.1.1.1.3"><plus id="S4.E9.m1.1.1.1.1.3.1.cmml" xref="S4.E9.m1.1.1.1.1.3.1"></plus><apply id="S4.E9.m1.1.1.1.1.3.2.cmml" xref="S4.E9.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E9.m1.1.1.1.1.3.2.1.cmml" xref="S4.E9.m1.1.1.1.1.3.2">subscript</csymbol><ci id="S4.E9.m1.1.1.1.1.3.2.2.cmml" xref="S4.E9.m1.1.1.1.1.3.2.2">ℒ</ci><cn type="integer" id="S4.E9.m1.1.1.1.1.3.2.3.cmml" xref="S4.E9.m1.1.1.1.1.3.2.3">1</cn></apply><apply id="S4.E9.m1.1.1.1.1.3.3.cmml" xref="S4.E9.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E9.m1.1.1.1.1.3.3.1.cmml" xref="S4.E9.m1.1.1.1.1.3.3">subscript</csymbol><ci id="S4.E9.m1.1.1.1.1.3.3.2.cmml" xref="S4.E9.m1.1.1.1.1.3.3.2">ℒ</ci><cn type="integer" id="S4.E9.m1.1.1.1.1.3.3.3.cmml" xref="S4.E9.m1.1.1.1.1.3.3.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E9.m1.1c">\mathcal{L}_{total}=\mathcal{L}_{1}+\mathcal{L}_{2}.</annotation><annotation encoding="application/x-llamapun" id="S4.E9.m1.1d">caligraphic_L start_POSTSUBSCRIPT italic_t italic_o italic_t italic_a italic_l end_POSTSUBSCRIPT = caligraphic_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT + caligraphic_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr>
</table>
</div>
<div id="S4.SS3.p5" class="ltx_para">
<p id="S4.SS3.p5.1" class="ltx_p">Notice that in TUL prediction stage, there is no data augmentation operation. That is, in testing, each input trajectory is encoded by trajectory encoder <math id="S4.SS3.p5.1.m1.1" class="ltx_Math" alttext="f_{\theta}" display="inline"><semantics id="S4.SS3.p5.1.m1.1a"><msub id="S4.SS3.p5.1.m1.1.1" xref="S4.SS3.p5.1.m1.1.1.cmml"><mi id="S4.SS3.p5.1.m1.1.1.2" xref="S4.SS3.p5.1.m1.1.1.2.cmml">f</mi><mi id="S4.SS3.p5.1.m1.1.1.3" xref="S4.SS3.p5.1.m1.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p5.1.m1.1b"><apply id="S4.SS3.p5.1.m1.1.1.cmml" xref="S4.SS3.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p5.1.m1.1.1.1.cmml" xref="S4.SS3.p5.1.m1.1.1">subscript</csymbol><ci id="S4.SS3.p5.1.m1.1.1.2.cmml" xref="S4.SS3.p5.1.m1.1.1.2">𝑓</ci><ci id="S4.SS3.p5.1.m1.1.1.3.cmml" xref="S4.SS3.p5.1.m1.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p5.1.m1.1c">f_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p5.1.m1.1d">italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math>, and then is linked with the predicted user label.</p>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Experiments</h2>

<section id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Datasets</h3>

<figure id="S5.T1" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Statistics of the datasets.</figcaption>
<table id="S5.T1.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T1.1.1.1" class="ltx_tr">
<th id="S5.T1.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" style="padding-left:2.6pt;padding-right:2.6pt;"><span id="S5.T1.1.1.1.1.1" class="ltx_text ltx_font_bold">Datasets</span></th>
<th id="S5.T1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" style="padding-left:2.6pt;padding-right:2.6pt;">#users</th>
<th id="S5.T1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" style="padding-left:2.6pt;padding-right:2.6pt;">#trajectories</th>
<th id="S5.T1.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" style="padding-left:2.6pt;padding-right:2.6pt;">#POIs</th>
<th id="S5.T1.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" style="padding-left:2.6pt;padding-right:2.6pt;">#categories</th>
<th id="S5.T1.1.1.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:2.6pt;padding-right:2.6pt;">Duration</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T1.1.2.1" class="ltx_tr">
<td id="S5.T1.1.2.1.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:2.6pt;padding-right:2.6pt;" rowspan="2"><span id="S5.T1.1.2.1.1.1" class="ltx_text">Foursquare</span></td>
<td id="S5.T1.1.2.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:2.6pt;padding-right:2.6pt;">800</td>
<td id="S5.T1.1.2.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:2.6pt;padding-right:2.6pt;">104,413</td>
<td id="S5.T1.1.2.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:2.6pt;padding-right:2.6pt;">39,698</td>
<td id="S5.T1.1.2.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:2.6pt;padding-right:2.6pt;">239</td>
<td id="S5.T1.1.2.1.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.6pt;padding-right:2.6pt;">11 months</td>
</tr>
<tr id="S5.T1.1.3.2" class="ltx_tr">
<td id="S5.T1.1.3.2.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:2.6pt;padding-right:2.6pt;">400</td>
<td id="S5.T1.1.3.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:2.6pt;padding-right:2.6pt;">51,969</td>
<td id="S5.T1.1.3.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:2.6pt;padding-right:2.6pt;">24,526</td>
<td id="S5.T1.1.3.2.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:2.6pt;padding-right:2.6pt;">231</td>
<td id="S5.T1.1.3.2.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.6pt;padding-right:2.6pt;">11 months</td>
</tr>
<tr id="S5.T1.1.4.3" class="ltx_tr">
<td id="S5.T1.1.4.3.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" style="padding-left:2.6pt;padding-right:2.6pt;" rowspan="2"><span id="S5.T1.1.4.3.1.1" class="ltx_text">Weeplaces</span></td>
<td id="S5.T1.1.4.3.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:2.6pt;padding-right:2.6pt;">800</td>
<td id="S5.T1.1.4.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:2.6pt;padding-right:2.6pt;">152,583</td>
<td id="S5.T1.1.4.3.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:2.6pt;padding-right:2.6pt;">24,649</td>
<td id="S5.T1.1.4.3.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:2.6pt;padding-right:2.6pt;">1,373</td>
<td id="S5.T1.1.4.3.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.6pt;padding-right:2.6pt;">7 years</td>
</tr>
<tr id="S5.T1.1.5.4" class="ltx_tr">
<td id="S5.T1.1.5.4.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" style="padding-left:2.6pt;padding-right:2.6pt;">400</td>
<td id="S5.T1.1.5.4.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" style="padding-left:2.6pt;padding-right:2.6pt;">75,873</td>
<td id="S5.T1.1.5.4.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" style="padding-left:2.6pt;padding-right:2.6pt;">18,482</td>
<td id="S5.T1.1.5.4.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" style="padding-left:2.6pt;padding-right:2.6pt;">1,177</td>
<td id="S5.T1.1.5.4.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:2.6pt;padding-right:2.6pt;">6 years</td>
</tr>
</tbody>
</table>
</figure>
<div id="S5.SS1.p1" class="ltx_para">
<p id="S5.SS1.p1.1" class="ltx_p">We use two real-world check-in mobility datasets <cite class="ltx_cite ltx_citemacro_citep">(Liu <span class="ltx_text ltx_font_italic">et al.</span>, <a href="#bib.bib17" title="" class="ltx_ref">2014</a>; Yang <span class="ltx_text ltx_font_italic">et al.</span>, <a href="#bib.bib25" title="" class="ltx_ref">2015</a>)</cite> collected from two popular location-based social network platforms, <span id="S5.SS1.p1.1.1" class="ltx_text ltx_font_italic">i</span>.<span id="S5.SS1.p1.1.2" class="ltx_text ltx_font_italic">e</span>., Foursquare<span id="footnote3" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span>http://sites.google.com/site/yangdingqi/home/foursquare-dataset</span></span></span> and Weeplaces<span id="footnote4" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">4</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">4</sup><span class="ltx_tag ltx_tag_note">4</span>http://www.yongliu.org/datasets.html</span></span></span>.
For Foursquare and Weeplaces, we choose top 800 and 400 users with the most check-ins for evaluating model performance respectively. In experiments, we use the first 80% of sub-trajectories of each user for training and the remaining 20% for testing, and select 20% training data as the validation set to cooperate with the early stop mechanism to find the best parameters and avoid overfitting.</p>
</div>
<div id="S5.SS1.p2" class="ltx_para">
<p id="S5.SS1.p2.1" class="ltx_p">The statistics of two datasets are summarized in Table <a href="#S5.T1" title="Table 1 ‣ 5.1 Datasets ‣ 5 Experiments ‣ Mutual Distillation Learning Network for Trajectory-User Linking" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
</section>
<section id="S5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Baselines</h3>

<div id="S5.SS2.p1" class="ltx_para">
<p id="S5.SS2.p1.1" class="ltx_p">We consider the following baselines for comparison.</p>
<ul id="S5.I1" class="ltx_itemize">
<li id="S5.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I1.i1.p1" class="ltx_para">
<p id="S5.I1.i1.p1.1" class="ltx_p"><span id="S5.I1.i1.p1.1.1" class="ltx_text ltx_font_bold">Classical methods:</span> (1) <span id="S5.I1.i1.p1.1.2" class="ltx_text ltx_font_bold">LCSS</span> – a common and effective trajectory similarity measure method <cite class="ltx_cite ltx_citemacro_citep">(Ying <span class="ltx_text ltx_font_italic">et al.</span>, <a href="#bib.bib30" title="" class="ltx_ref">2010</a>)</cite>. (2) Signature Representation (<span id="S5.I1.i1.p1.1.3" class="ltx_text ltx_font_bold">SR</span>) – a state-of-the-art trajectory similarity measure for moving object linking <cite class="ltx_cite ltx_citemacro_citep">(Jin <span class="ltx_text ltx_font_italic">et al.</span>, <a href="#bib.bib10" title="" class="ltx_ref">2019</a>, <a href="#bib.bib11" title="" class="ltx_ref">2020</a>)</cite>.</p>
</div>
</li>
<li id="S5.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I1.i2.p1" class="ltx_para">
<p id="S5.I1.i2.p1.1" class="ltx_p"><span id="S5.I1.i2.p1.1.1" class="ltx_text ltx_font_bold">Machine learning methods:</span> (3) Linear Discriminant Analysis (<span id="S5.I1.i2.p1.1.2" class="ltx_text ltx_font_bold">LDA</span>) – a classic spatial data classification method <cite class="ltx_cite ltx_citemacro_citep">(Shahdoosti and
Mirzapour, <a href="#bib.bib21" title="" class="ltx_ref">2017</a>)</cite>. (4) Decision Tree (<span id="S5.I1.i2.p1.1.3" class="ltx_text ltx_font_bold">DT</span>) – an effective classification method for trajectory data <cite class="ltx_cite ltx_citemacro_citep">(Jiang, <a href="#bib.bib9" title="" class="ltx_ref">2018</a>)</cite>.</p>
</div>
</li>
<li id="S5.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I1.i3.p1" class="ltx_para">
<p id="S5.I1.i3.p1.1" class="ltx_p"><span id="S5.I1.i3.p1.1.1" class="ltx_text ltx_font_bold">Deep neural network models:</span> (5) <span id="S5.I1.i3.p1.1.2" class="ltx_text ltx_font_bold">TULER</span> – an RNN model for TUL task <cite class="ltx_cite ltx_citemacro_citep">(Gao <span class="ltx_text ltx_font_italic">et al.</span>, <a href="#bib.bib2" title="" class="ltx_ref">2017</a>)</cite>, including three variants: RNN with Gated Recurrent Unit (<span id="S5.I1.i3.p1.1.3" class="ltx_text ltx_font_bold">TULER-G</span>), LSTM (<span id="S5.I1.i3.p1.1.4" class="ltx_text ltx_font_bold">TULER-L</span>) and bidirectional LSTM (<span id="S5.I1.i3.p1.1.5" class="ltx_text ltx_font_bold">Bi-TULER</span>). (6) <span id="S5.I1.i3.p1.1.6" class="ltx_text ltx_font_bold">TULVAE</span> – It utilizes VAE to learn the hierarchical semantics of trajectory in RNN <cite class="ltx_cite ltx_citemacro_citep">(Zhou <span class="ltx_text ltx_font_italic">et al.</span>, <a href="#bib.bib33" title="" class="ltx_ref">2018</a>)</cite>. (7) <span id="S5.I1.i3.p1.1.7" class="ltx_text ltx_font_bold">DeepTUL</span> – a recurrent network with attention mechanism for TUL task <cite class="ltx_cite ltx_citemacro_citep">(Miao <span class="ltx_text ltx_font_italic">et al.</span>, <a href="#bib.bib19" title="" class="ltx_ref">2020</a>)</cite>.</p>
</div>
</li>
</ul>
</div>
</section>
<section id="S5.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3 </span>Evaluation Metrics and Parameter Settings</h3>

<div id="S5.SS3.p1" class="ltx_para">
<p id="S5.SS3.p1.2" class="ltx_p">We use the Acc@<math id="S5.SS3.p1.1.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S5.SS3.p1.1.m1.1a"><mi id="S5.SS3.p1.1.m1.1.1" xref="S5.SS3.p1.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.1.m1.1b"><ci id="S5.SS3.p1.1.m1.1.1.cmml" xref="S5.SS3.p1.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p1.1.m1.1d">italic_k</annotation></semantics></math>, Macro-Precision, Macro-Recall and Macro-F1 to evaluate the model performance. Specifically, Acc@<math id="S5.SS3.p1.2.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S5.SS3.p1.2.m2.1a"><mi id="S5.SS3.p1.2.m2.1.1" xref="S5.SS3.p1.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.2.m2.1b"><ci id="S5.SS3.p1.2.m2.1.1.cmml" xref="S5.SS3.p1.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.2.m2.1c">k</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p1.2.m2.1d">italic_k</annotation></semantics></math> is used to evaluate the accuracy of TUL prediction.
</p>
</div>
<div id="S5.SS3.p2" class="ltx_para">
<p id="S5.SS3.p2.2" class="ltx_p">For baselines, we use the parameter settings recommended in their papers and fine-tune them to be optimal. For MainTUL, we set check-in embedding dimension <math id="S5.SS3.p2.1.m1.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S5.SS3.p2.1.m1.1a"><mi id="S5.SS3.p2.1.m1.1.1" xref="S5.SS3.p2.1.m1.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.1.m1.1b"><ci id="S5.SS3.p2.1.m1.1.1.cmml" xref="S5.SS3.p2.1.m1.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.1.m1.1c">d</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p2.1.m1.1d">italic_d</annotation></semantics></math> to 512, <math id="S5.SS3.p2.2.m2.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S5.SS3.p2.2.m2.1a"><mi id="S5.SS3.p2.2.m2.1.1" xref="S5.SS3.p2.2.m2.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.2.m2.1b"><ci id="S5.SS3.p2.2.m2.1.1.cmml" xref="S5.SS3.p2.2.m2.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.2.m2.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p2.2.m2.1d">italic_λ</annotation></semantics></math> to 10, use early stopping mechanism, and set patience to 3 to avoid over fitting. The learning rate is initially set to 0.001 and decays by 10% every 5 epochs. We repeat 10 runs for each experiment and report the average for all methods. More experimental settings can be found in the appendix.</p>
</div>
</section>
<section id="S5.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.4 </span>Overall Performance</h3>

<figure id="S5.T2" class="ltx_table">
<figcaption class="ltx_caption ltx_centering" style="font-size:80%;"><span class="ltx_tag ltx_tag_table">Table 2: </span>Performance comparison with deep neural network models. Macro-P/R: Macro-Precision/Recall</figcaption>
<table id="S5.T2.2" class="ltx_tabular ltx_centering ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S5.T2.2.3.1" class="ltx_tr">
<td id="S5.T2.2.3.1.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" style="padding-left:4.3pt;padding-right:4.3pt;" rowspan="2"><span id="S5.T2.2.3.1.1.1" class="ltx_text" style="font-size:80%;">Dataset</span></td>
<td id="S5.T2.2.3.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" style="padding-left:4.3pt;padding-right:4.3pt;" rowspan="2"><span id="S5.T2.2.3.1.2.1" class="ltx_text" style="font-size:80%;">Methods</span></td>
<td id="S5.T2.2.3.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.3.1.3.1" class="ltx_text" style="font-size:80%;">Acc@1</span></td>
<td id="S5.T2.2.3.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.3.1.4.1" class="ltx_text" style="font-size:80%;">Acc@5</span></td>
<td id="S5.T2.2.3.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.3.1.5.1" class="ltx_text" style="font-size:80%;">Macro-P</span></td>
<td id="S5.T2.2.3.1.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.3.1.6.1" class="ltx_text" style="font-size:80%;">Macro-R</span></td>
<td id="S5.T2.2.3.1.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.3.1.7.1" class="ltx_text" style="font-size:80%;">Macro-F1</span></td>
<td id="S5.T2.2.3.1.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.3.1.8.1" class="ltx_text" style="font-size:80%;">Acc@1</span></td>
<td id="S5.T2.2.3.1.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.3.1.9.1" class="ltx_text" style="font-size:80%;">Acc@5</span></td>
<td id="S5.T2.2.3.1.10" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.3.1.10.1" class="ltx_text" style="font-size:80%;">Macro-P</span></td>
<td id="S5.T2.2.3.1.11" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.3.1.11.1" class="ltx_text" style="font-size:80%;">Macro-R</span></td>
<td id="S5.T2.2.3.1.12" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.3.1.12.1" class="ltx_text" style="font-size:80%;">Macro-F1</span></td>
</tr>
<tr id="S5.T2.2.2" class="ltx_tr">
<td id="S5.T2.1.1.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;" colspan="5">
<math id="S5.T2.1.1.1.m1.1" class="ltx_Math" alttext="|\mathcal{U}|=400" display="inline"><semantics id="S5.T2.1.1.1.m1.1a"><mrow id="S5.T2.1.1.1.m1.1.2" xref="S5.T2.1.1.1.m1.1.2.cmml"><mrow id="S5.T2.1.1.1.m1.1.2.2.2" xref="S5.T2.1.1.1.m1.1.2.2.1.cmml"><mo maxsize="80%" minsize="80%" id="S5.T2.1.1.1.m1.1.2.2.2.1" xref="S5.T2.1.1.1.m1.1.2.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" mathsize="80%" id="S5.T2.1.1.1.m1.1.1" xref="S5.T2.1.1.1.m1.1.1.cmml">𝒰</mi><mo maxsize="80%" minsize="80%" id="S5.T2.1.1.1.m1.1.2.2.2.2" xref="S5.T2.1.1.1.m1.1.2.2.1.1.cmml">|</mo></mrow><mo mathsize="80%" stretchy="false" id="S5.T2.1.1.1.m1.1.2.1" xref="S5.T2.1.1.1.m1.1.2.1.cmml">=</mo><mn mathsize="80%" id="S5.T2.1.1.1.m1.1.2.3" xref="S5.T2.1.1.1.m1.1.2.3.cmml">400</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.1.1.1.m1.1b"><apply id="S5.T2.1.1.1.m1.1.2.cmml" xref="S5.T2.1.1.1.m1.1.2"><eq id="S5.T2.1.1.1.m1.1.2.1.cmml" xref="S5.T2.1.1.1.m1.1.2.1"></eq><apply id="S5.T2.1.1.1.m1.1.2.2.1.cmml" xref="S5.T2.1.1.1.m1.1.2.2.2"><abs id="S5.T2.1.1.1.m1.1.2.2.1.1.cmml" xref="S5.T2.1.1.1.m1.1.2.2.2.1"></abs><ci id="S5.T2.1.1.1.m1.1.1.cmml" xref="S5.T2.1.1.1.m1.1.1">𝒰</ci></apply><cn type="integer" id="S5.T2.1.1.1.m1.1.2.3.cmml" xref="S5.T2.1.1.1.m1.1.2.3">400</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.1.1.1.m1.1c">|\mathcal{U}|=400</annotation><annotation encoding="application/x-llamapun" id="S5.T2.1.1.1.m1.1d">| caligraphic_U | = 400</annotation></semantics></math><span id="S5.T2.1.1.1.1" class="ltx_text" style="font-size:80%;"></span>
</td>
<td id="S5.T2.2.2.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;" colspan="5"><math id="S5.T2.2.2.2.m1.1" class="ltx_Math" alttext="|\mathcal{U}|=800" display="inline"><semantics id="S5.T2.2.2.2.m1.1a"><mrow id="S5.T2.2.2.2.m1.1.2" xref="S5.T2.2.2.2.m1.1.2.cmml"><mrow id="S5.T2.2.2.2.m1.1.2.2.2" xref="S5.T2.2.2.2.m1.1.2.2.1.cmml"><mo maxsize="80%" minsize="80%" id="S5.T2.2.2.2.m1.1.2.2.2.1" xref="S5.T2.2.2.2.m1.1.2.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" mathsize="80%" id="S5.T2.2.2.2.m1.1.1" xref="S5.T2.2.2.2.m1.1.1.cmml">𝒰</mi><mo maxsize="80%" minsize="80%" id="S5.T2.2.2.2.m1.1.2.2.2.2" xref="S5.T2.2.2.2.m1.1.2.2.1.1.cmml">|</mo></mrow><mo mathsize="80%" stretchy="false" id="S5.T2.2.2.2.m1.1.2.1" xref="S5.T2.2.2.2.m1.1.2.1.cmml">=</mo><mn mathsize="80%" id="S5.T2.2.2.2.m1.1.2.3" xref="S5.T2.2.2.2.m1.1.2.3.cmml">800</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.2.2.2.m1.1b"><apply id="S5.T2.2.2.2.m1.1.2.cmml" xref="S5.T2.2.2.2.m1.1.2"><eq id="S5.T2.2.2.2.m1.1.2.1.cmml" xref="S5.T2.2.2.2.m1.1.2.1"></eq><apply id="S5.T2.2.2.2.m1.1.2.2.1.cmml" xref="S5.T2.2.2.2.m1.1.2.2.2"><abs id="S5.T2.2.2.2.m1.1.2.2.1.1.cmml" xref="S5.T2.2.2.2.m1.1.2.2.2.1"></abs><ci id="S5.T2.2.2.2.m1.1.1.cmml" xref="S5.T2.2.2.2.m1.1.1">𝒰</ci></apply><cn type="integer" id="S5.T2.2.2.2.m1.1.2.3.cmml" xref="S5.T2.2.2.2.m1.1.2.3">800</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.2.2.2.m1.1c">|\mathcal{U}|=800</annotation><annotation encoding="application/x-llamapun" id="S5.T2.2.2.2.m1.1d">| caligraphic_U | = 800</annotation></semantics></math></td>
</tr>
<tr id="S5.T2.2.4.2" class="ltx_tr">
<td id="S5.T2.2.4.2.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;" rowspan="6"><span id="S5.T2.2.4.2.1.1" class="ltx_text" style="font-size:80%;">Foursquare</span></td>
<td id="S5.T2.2.4.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.4.2.2.1" class="ltx_text" style="font-size:80%;">TULER-L</span></td>
<td id="S5.T2.2.4.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.4.2.3.1" class="ltx_text" style="font-size:80%;">52.88%</span></td>
<td id="S5.T2.2.4.2.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.4.2.4.1" class="ltx_text" style="font-size:80%;">64.08%</span></td>
<td id="S5.T2.2.4.2.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.4.2.5.1" class="ltx_text" style="font-size:80%;">58.96%</span></td>
<td id="S5.T2.2.4.2.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.4.2.6.1" class="ltx_text" style="font-size:80%;">50.69%</span></td>
<td id="S5.T2.2.4.2.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.4.2.7.1" class="ltx_text" style="font-size:80%;">52.75%</span></td>
<td id="S5.T2.2.4.2.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.4.2.8.1" class="ltx_text" style="font-size:80%;">47.36%</span></td>
<td id="S5.T2.2.4.2.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.4.2.9.1" class="ltx_text" style="font-size:80%;">59.11%</span></td>
<td id="S5.T2.2.4.2.10" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.4.2.10.1" class="ltx_text" style="font-size:80%;">52.52%</span></td>
<td id="S5.T2.2.4.2.11" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.4.2.11.1" class="ltx_text" style="font-size:80%;">45.28%</span></td>
<td id="S5.T2.2.4.2.12" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.4.2.12.1" class="ltx_text" style="font-size:80%;">46.73%</span></td>
</tr>
<tr id="S5.T2.2.5.3" class="ltx_tr">
<td id="S5.T2.2.5.3.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.5.3.1.1" class="ltx_text" style="font-size:80%;">TULER-G</span></td>
<td id="S5.T2.2.5.3.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.5.3.2.1" class="ltx_text" style="font-size:80%;">52.41%</span></td>
<td id="S5.T2.2.5.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.5.3.3.1" class="ltx_text" style="font-size:80%;">63.41%</span></td>
<td id="S5.T2.2.5.3.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.5.3.4.1" class="ltx_text" style="font-size:80%;">58.39%</span></td>
<td id="S5.T2.2.5.3.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.5.3.5.1" class="ltx_text" style="font-size:80%;">50.17%</span></td>
<td id="S5.T2.2.5.3.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.5.3.6.1" class="ltx_text" style="font-size:80%;">52.09%</span></td>
<td id="S5.T2.2.5.3.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.5.3.7.1" class="ltx_text" style="font-size:80%;">47.67%</span></td>
<td id="S5.T2.2.5.3.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.5.3.8.1" class="ltx_text" style="font-size:80%;">58.94%</span></td>
<td id="S5.T2.2.5.3.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.5.3.9.1" class="ltx_text" style="font-size:80%;">52.39%</span></td>
<td id="S5.T2.2.5.3.10" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.5.3.10.1" class="ltx_text" style="font-size:80%;">45.53%</span></td>
<td id="S5.T2.2.5.3.11" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.5.3.11.1" class="ltx_text" style="font-size:80%;">46.55%</span></td>
</tr>
<tr id="S5.T2.2.6.4" class="ltx_tr">
<td id="S5.T2.2.6.4.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.6.4.1.1" class="ltx_text" style="font-size:80%;">Bi-TULER</span></td>
<td id="S5.T2.2.6.4.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.6.4.2.1" class="ltx_text" style="font-size:80%;">51.59%</span></td>
<td id="S5.T2.2.6.4.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.6.4.3.1" class="ltx_text" style="font-size:80%;">63.02%</span></td>
<td id="S5.T2.2.6.4.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.6.4.4.1" class="ltx_text" style="font-size:80%;">58.46%</span></td>
<td id="S5.T2.2.6.4.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.6.4.5.1" class="ltx_text" style="font-size:80%;">49.45%</span></td>
<td id="S5.T2.2.6.4.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.6.4.6.1" class="ltx_text" style="font-size:80%;">51.62%</span></td>
<td id="S5.T2.2.6.4.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;">
<span id="S5.T2.2.6.4.7.1" class="ltx_text ltx_framed_underline" style="font-size:80%;">49.03</span><span id="S5.T2.2.6.4.7.2" class="ltx_text" style="font-size:80%;">%</span>
</td>
<td id="S5.T2.2.6.4.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;">
<span id="S5.T2.2.6.4.8.1" class="ltx_text ltx_framed_underline" style="font-size:80%;">60.48</span><span id="S5.T2.2.6.4.8.2" class="ltx_text" style="font-size:80%;">%</span>
</td>
<td id="S5.T2.2.6.4.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.6.4.9.1" class="ltx_text" style="font-size:80%;">54.92%</span></td>
<td id="S5.T2.2.6.4.10" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;">
<span id="S5.T2.2.6.4.10.1" class="ltx_text ltx_framed_underline" style="font-size:80%;">47.10</span><span id="S5.T2.2.6.4.10.2" class="ltx_text" style="font-size:80%;">%</span>
</td>
<td id="S5.T2.2.6.4.11" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;">
<span id="S5.T2.2.6.4.11.1" class="ltx_text ltx_framed_underline" style="font-size:80%;">48.51</span><span id="S5.T2.2.6.4.11.2" class="ltx_text" style="font-size:80%;">%</span>
</td>
</tr>
<tr id="S5.T2.2.7.5" class="ltx_tr">
<td id="S5.T2.2.7.5.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.7.5.1.1" class="ltx_text" style="font-size:80%;">TULVAE</span></td>
<td id="S5.T2.2.7.5.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.7.5.2.1" class="ltx_text" style="font-size:80%;">52.61%</span></td>
<td id="S5.T2.2.7.5.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.7.5.3.1" class="ltx_text" style="font-size:80%;">63.33%</span></td>
<td id="S5.T2.2.7.5.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.7.5.4.1" class="ltx_text" style="font-size:80%;">58.75%</span></td>
<td id="S5.T2.2.7.5.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.7.5.5.1" class="ltx_text" style="font-size:80%;">50.51%</span></td>
<td id="S5.T2.2.7.5.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.7.5.6.1" class="ltx_text" style="font-size:80%;">52.66%</span></td>
<td id="S5.T2.2.7.5.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.7.5.7.1" class="ltx_text" style="font-size:80%;">47.71%</span></td>
<td id="S5.T2.2.7.5.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.7.5.8.1" class="ltx_text" style="font-size:80%;">59.55%</span></td>
<td id="S5.T2.2.7.5.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.7.5.9.1" class="ltx_text" style="font-size:80%;">53.20%</span></td>
<td id="S5.T2.2.7.5.10" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.7.5.10.1" class="ltx_text" style="font-size:80%;">45.65%</span></td>
<td id="S5.T2.2.7.5.11" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.7.5.11.1" class="ltx_text" style="font-size:80%;">47.09%</span></td>
</tr>
<tr id="S5.T2.2.8.6" class="ltx_tr">
<td id="S5.T2.2.8.6.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.8.6.1.1" class="ltx_text" style="font-size:80%;">DeepTUL</span></td>
<td id="S5.T2.2.8.6.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;">
<span id="S5.T2.2.8.6.2.1" class="ltx_text ltx_framed_underline" style="font-size:80%;">53.99</span><span id="S5.T2.2.8.6.2.2" class="ltx_text" style="font-size:80%;">%</span>
</td>
<td id="S5.T2.2.8.6.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;">
<span id="S5.T2.2.8.6.3.1" class="ltx_text ltx_framed_underline" style="font-size:80%;">65.22</span><span id="S5.T2.2.8.6.3.2" class="ltx_text" style="font-size:80%;">%</span>
</td>
<td id="S5.T2.2.8.6.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;">
<span id="S5.T2.2.8.6.4.1" class="ltx_text ltx_framed_underline" style="font-size:80%;">61.78</span><span id="S5.T2.2.8.6.4.2" class="ltx_text" style="font-size:80%;">%</span>
</td>
<td id="S5.T2.2.8.6.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;">
<span id="S5.T2.2.8.6.5.1" class="ltx_text ltx_framed_underline" style="font-size:80%;">52.00</span><span id="S5.T2.2.8.6.5.2" class="ltx_text" style="font-size:80%;">%</span>
</td>
<td id="S5.T2.2.8.6.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;">
<span id="S5.T2.2.8.6.6.1" class="ltx_text ltx_framed_underline" style="font-size:80%;">54.65</span><span id="S5.T2.2.8.6.6.2" class="ltx_text" style="font-size:80%;">%</span>
</td>
<td id="S5.T2.2.8.6.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.8.6.7.1" class="ltx_text" style="font-size:80%;">45.41%</span></td>
<td id="S5.T2.2.8.6.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.8.6.8.1" class="ltx_text" style="font-size:80%;">58.20%</span></td>
<td id="S5.T2.2.8.6.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;">
<span id="S5.T2.2.8.6.9.1" class="ltx_text ltx_framed_underline" style="font-size:80%;">57.75</span><span id="S5.T2.2.8.6.9.2" class="ltx_text" style="font-size:80%;">%</span>
</td>
<td id="S5.T2.2.8.6.10" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.8.6.10.1" class="ltx_text" style="font-size:80%;">43.33%</span></td>
<td id="S5.T2.2.8.6.11" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.8.6.11.1" class="ltx_text" style="font-size:80%;">45.43%</span></td>
</tr>
<tr id="S5.T2.2.9.7" class="ltx_tr">
<td id="S5.T2.2.9.7.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.9.7.1.1" class="ltx_text ltx_font_bold" style="font-size:80%;">MainTUL</span></td>
<td id="S5.T2.2.9.7.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;">
<span id="S5.T2.2.9.7.2.1" class="ltx_text ltx_font_bold" style="font-size:80%;">60.58</span><span id="S5.T2.2.9.7.2.2" class="ltx_text" style="font-size:80%;">%</span>
</td>
<td id="S5.T2.2.9.7.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;">
<span id="S5.T2.2.9.7.3.1" class="ltx_text ltx_font_bold" style="font-size:80%;">70.22</span><span id="S5.T2.2.9.7.3.2" class="ltx_text" style="font-size:80%;">%</span>
</td>
<td id="S5.T2.2.9.7.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;">
<span id="S5.T2.2.9.7.4.1" class="ltx_text ltx_font_bold" style="font-size:80%;">62.91</span><span id="S5.T2.2.9.7.4.2" class="ltx_text" style="font-size:80%;">%</span>
</td>
<td id="S5.T2.2.9.7.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;">
<span id="S5.T2.2.9.7.5.1" class="ltx_text ltx_font_bold" style="font-size:80%;">58.49</span><span id="S5.T2.2.9.7.5.2" class="ltx_text" style="font-size:80%;">%</span>
</td>
<td id="S5.T2.2.9.7.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;">
<span id="S5.T2.2.9.7.6.1" class="ltx_text ltx_font_bold" style="font-size:80%;">59.12</span><span id="S5.T2.2.9.7.6.2" class="ltx_text" style="font-size:80%;">%</span>
</td>
<td id="S5.T2.2.9.7.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;">
<span id="S5.T2.2.9.7.7.1" class="ltx_text ltx_font_bold" style="font-size:80%;">56.92</span><span id="S5.T2.2.9.7.7.2" class="ltx_text" style="font-size:80%;">%</span>
</td>
<td id="S5.T2.2.9.7.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;">
<span id="S5.T2.2.9.7.8.1" class="ltx_text ltx_font_bold" style="font-size:80%;">67.85</span><span id="S5.T2.2.9.7.8.2" class="ltx_text" style="font-size:80%;">%</span>
</td>
<td id="S5.T2.2.9.7.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;">
<span id="S5.T2.2.9.7.9.1" class="ltx_text ltx_font_bold" style="font-size:80%;">59.20</span><span id="S5.T2.2.9.7.9.2" class="ltx_text" style="font-size:80%;">%</span>
</td>
<td id="S5.T2.2.9.7.10" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;">
<span id="S5.T2.2.9.7.10.1" class="ltx_text ltx_font_bold" style="font-size:80%;">55.02</span><span id="S5.T2.2.9.7.10.2" class="ltx_text" style="font-size:80%;">%</span>
</td>
<td id="S5.T2.2.9.7.11" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;">
<span id="S5.T2.2.9.7.11.1" class="ltx_text ltx_font_bold" style="font-size:80%;">55.37</span><span id="S5.T2.2.9.7.11.2" class="ltx_text" style="font-size:80%;">%</span>
</td>
</tr>
<tr id="S5.T2.2.10.8" class="ltx_tr">
<td id="S5.T2.2.10.8.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;" rowspan="6"><span id="S5.T2.2.10.8.1.1" class="ltx_text" style="font-size:80%;">Weeplaces</span></td>
<td id="S5.T2.2.10.8.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.10.8.2.1" class="ltx_text" style="font-size:80%;">TULER-L</span></td>
<td id="S5.T2.2.10.8.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.10.8.3.1" class="ltx_text" style="font-size:80%;">38.44%</span></td>
<td id="S5.T2.2.10.8.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.10.8.4.1" class="ltx_text" style="font-size:80%;">49.60%</span></td>
<td id="S5.T2.2.10.8.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.10.8.5.1" class="ltx_text" style="font-size:80%;">41.54%</span></td>
<td id="S5.T2.2.10.8.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.10.8.6.1" class="ltx_text" style="font-size:80%;">37.50%</span></td>
<td id="S5.T2.2.10.8.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.10.8.7.1" class="ltx_text" style="font-size:80%;">37.33%</span></td>
<td id="S5.T2.2.10.8.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.10.8.8.1" class="ltx_text" style="font-size:80%;">36.12%</span></td>
<td id="S5.T2.2.10.8.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.10.8.9.1" class="ltx_text" style="font-size:80%;">47.56%</span></td>
<td id="S5.T2.2.10.8.10" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.10.8.10.1" class="ltx_text" style="font-size:80%;">40.62%</span></td>
<td id="S5.T2.2.10.8.11" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.10.8.11.1" class="ltx_text" style="font-size:80%;">35.27%</span></td>
<td id="S5.T2.2.10.8.12" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.10.8.12.1" class="ltx_text" style="font-size:80%;">35.78%</span></td>
</tr>
<tr id="S5.T2.2.11.9" class="ltx_tr">
<td id="S5.T2.2.11.9.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.11.9.1.1" class="ltx_text" style="font-size:80%;">TULER-G</span></td>
<td id="S5.T2.2.11.9.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.11.9.2.1" class="ltx_text" style="font-size:80%;">38.84%</span></td>
<td id="S5.T2.2.11.9.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.11.9.3.1" class="ltx_text" style="font-size:80%;">50.17%</span></td>
<td id="S5.T2.2.11.9.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.11.9.4.1" class="ltx_text" style="font-size:80%;">42.56%</span></td>
<td id="S5.T2.2.11.9.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.11.9.5.1" class="ltx_text" style="font-size:80%;">37.76%</span></td>
<td id="S5.T2.2.11.9.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.11.9.6.1" class="ltx_text" style="font-size:80%;">38.09%</span></td>
<td id="S5.T2.2.11.9.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;">
<span id="S5.T2.2.11.9.7.1" class="ltx_text ltx_framed_underline" style="font-size:80%;">36.35</span><span id="S5.T2.2.11.9.7.2" class="ltx_text" style="font-size:80%;">%</span>
</td>
<td id="S5.T2.2.11.9.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.11.9.8.1" class="ltx_text" style="font-size:80%;">47.78%</span></td>
<td id="S5.T2.2.11.9.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.11.9.9.1" class="ltx_text" style="font-size:80%;">40.63%</span></td>
<td id="S5.T2.2.11.9.10" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;">
<span id="S5.T2.2.11.9.10.1" class="ltx_text ltx_framed_underline" style="font-size:80%;">35.40</span><span id="S5.T2.2.11.9.10.2" class="ltx_text" style="font-size:80%;">%</span>
</td>
<td id="S5.T2.2.11.9.11" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;">
<span id="S5.T2.2.11.9.11.1" class="ltx_text ltx_framed_underline" style="font-size:80%;">35.81</span><span id="S5.T2.2.11.9.11.2" class="ltx_text" style="font-size:80%;">%</span>
</td>
</tr>
<tr id="S5.T2.2.12.10" class="ltx_tr">
<td id="S5.T2.2.12.10.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.12.10.1.1" class="ltx_text" style="font-size:80%;">Bi-TULER</span></td>
<td id="S5.T2.2.12.10.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.12.10.2.1" class="ltx_text" style="font-size:80%;">38.15%</span></td>
<td id="S5.T2.2.12.10.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.12.10.3.1" class="ltx_text" style="font-size:80%;">50.21%</span></td>
<td id="S5.T2.2.12.10.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.12.10.4.1" class="ltx_text" style="font-size:80%;">43.23%</span></td>
<td id="S5.T2.2.12.10.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.12.10.5.1" class="ltx_text" style="font-size:80%;">37.19%</span></td>
<td id="S5.T2.2.12.10.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.12.10.6.1" class="ltx_text" style="font-size:80%;">37.77%</span></td>
<td id="S5.T2.2.12.10.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.12.10.7.1" class="ltx_text" style="font-size:80%;">36.23%</span></td>
<td id="S5.T2.2.12.10.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;">
<span id="S5.T2.2.12.10.8.1" class="ltx_text ltx_framed_underline" style="font-size:80%;">47.93</span><span id="S5.T2.2.12.10.8.2" class="ltx_text" style="font-size:80%;">%</span>
</td>
<td id="S5.T2.2.12.10.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;">
<span id="S5.T2.2.12.10.9.1" class="ltx_text ltx_framed_underline" style="font-size:80%;">40.89</span><span id="S5.T2.2.12.10.9.2" class="ltx_text" style="font-size:80%;">%</span>
</td>
<td id="S5.T2.2.12.10.10" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.12.10.10.1" class="ltx_text" style="font-size:80%;">35.29%</span></td>
<td id="S5.T2.2.12.10.11" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.12.10.11.1" class="ltx_text" style="font-size:80%;">35.60%</span></td>
</tr>
<tr id="S5.T2.2.13.11" class="ltx_tr">
<td id="S5.T2.2.13.11.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.13.11.1.1" class="ltx_text" style="font-size:80%;">TULVAE</span></td>
<td id="S5.T2.2.13.11.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;">
<span id="S5.T2.2.13.11.2.1" class="ltx_text ltx_framed_underline" style="font-size:80%;">38.98</span><span id="S5.T2.2.13.11.2.2" class="ltx_text" style="font-size:80%;">%</span>
</td>
<td id="S5.T2.2.13.11.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;">
<span id="S5.T2.2.13.11.3.1" class="ltx_text ltx_framed_underline" style="font-size:80%;">50.60</span><span id="S5.T2.2.13.11.3.2" class="ltx_text" style="font-size:80%;">%</span>
</td>
<td id="S5.T2.2.13.11.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.13.11.4.1" class="ltx_text" style="font-size:80%;">42.59%</span></td>
<td id="S5.T2.2.13.11.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;">
<span id="S5.T2.2.13.11.5.1" class="ltx_text ltx_framed_underline" style="font-size:80%;">38.11</span><span id="S5.T2.2.13.11.5.2" class="ltx_text" style="font-size:80%;">%</span>
</td>
<td id="S5.T2.2.13.11.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;">
<span id="S5.T2.2.13.11.6.1" class="ltx_text ltx_framed_underline" style="font-size:80%;">38.36</span><span id="S5.T2.2.13.11.6.2" class="ltx_text" style="font-size:80%;">%</span>
</td>
<td id="S5.T2.2.13.11.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.13.11.7.1" class="ltx_text" style="font-size:80%;">35.23%</span></td>
<td id="S5.T2.2.13.11.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.13.11.8.1" class="ltx_text" style="font-size:80%;">46.84%</span></td>
<td id="S5.T2.2.13.11.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.13.11.9.1" class="ltx_text" style="font-size:80%;">38.87%</span></td>
<td id="S5.T2.2.13.11.10" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.13.11.10.1" class="ltx_text" style="font-size:80%;">34.32%</span></td>
<td id="S5.T2.2.13.11.11" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.13.11.11.1" class="ltx_text" style="font-size:80%;">34.51%</span></td>
</tr>
<tr id="S5.T2.2.14.12" class="ltx_tr">
<td id="S5.T2.2.14.12.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.14.12.1.1" class="ltx_text" style="font-size:80%;">DeepTUL</span></td>
<td id="S5.T2.2.14.12.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.14.12.2.1" class="ltx_text" style="font-size:80%;">33.48%</span></td>
<td id="S5.T2.2.14.12.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.14.12.3.1" class="ltx_text" style="font-size:80%;">46.34%</span></td>
<td id="S5.T2.2.14.12.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;">
<span id="S5.T2.2.14.12.4.1" class="ltx_text ltx_framed_underline" style="font-size:80%;">46.50</span><span id="S5.T2.2.14.12.4.2" class="ltx_text" style="font-size:80%;">%</span>
</td>
<td id="S5.T2.2.14.12.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.14.12.5.1" class="ltx_text" style="font-size:80%;">33.08%</span></td>
<td id="S5.T2.2.14.12.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.14.12.6.1" class="ltx_text" style="font-size:80%;">34.37%</span></td>
<td id="S5.T2.2.14.12.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.14.12.7.1" class="ltx_text" style="font-size:80%;">26.65%</span></td>
<td id="S5.T2.2.14.12.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.14.12.8.1" class="ltx_text" style="font-size:80%;">37.73%</span></td>
<td id="S5.T2.2.14.12.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.14.12.9.1" class="ltx_text" style="font-size:80%;">37.22%</span></td>
<td id="S5.T2.2.14.12.10" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.14.12.10.1" class="ltx_text" style="font-size:80%;">25.66%</span></td>
<td id="S5.T2.2.14.12.11" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.14.12.11.1" class="ltx_text" style="font-size:80%;">26.24%</span></td>
</tr>
<tr id="S5.T2.2.15.13" class="ltx_tr">
<td id="S5.T2.2.15.13.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;"><span id="S5.T2.2.15.13.1.1" class="ltx_text ltx_font_bold" style="font-size:80%;">MainTUL</span></td>
<td id="S5.T2.2.15.13.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;">
<span id="S5.T2.2.15.13.2.1" class="ltx_text ltx_font_bold" style="font-size:80%;">45.31</span><span id="S5.T2.2.15.13.2.2" class="ltx_text" style="font-size:80%;">%</span>
</td>
<td id="S5.T2.2.15.13.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;">
<span id="S5.T2.2.15.13.3.1" class="ltx_text ltx_font_bold" style="font-size:80%;">58.28</span><span id="S5.T2.2.15.13.3.2" class="ltx_text" style="font-size:80%;">%</span>
</td>
<td id="S5.T2.2.15.13.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;">
<span id="S5.T2.2.15.13.4.1" class="ltx_text ltx_font_bold" style="font-size:80%;">49.81</span><span id="S5.T2.2.15.13.4.2" class="ltx_text" style="font-size:80%;">%</span>
</td>
<td id="S5.T2.2.15.13.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;">
<span id="S5.T2.2.15.13.5.1" class="ltx_text ltx_font_bold" style="font-size:80%;">44.24</span><span id="S5.T2.2.15.13.5.2" class="ltx_text" style="font-size:80%;">%</span>
</td>
<td id="S5.T2.2.15.13.6" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;">
<span id="S5.T2.2.15.13.6.1" class="ltx_text ltx_font_bold" style="font-size:80%;">45.22</span><span id="S5.T2.2.15.13.6.2" class="ltx_text" style="font-size:80%;">%</span>
</td>
<td id="S5.T2.2.15.13.7" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;">
<span id="S5.T2.2.15.13.7.1" class="ltx_text ltx_font_bold" style="font-size:80%;">41.90</span><span id="S5.T2.2.15.13.7.2" class="ltx_text" style="font-size:80%;">%</span>
</td>
<td id="S5.T2.2.15.13.8" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;">
<span id="S5.T2.2.15.13.8.1" class="ltx_text ltx_font_bold" style="font-size:80%;">55.51</span><span id="S5.T2.2.15.13.8.2" class="ltx_text" style="font-size:80%;">%</span>
</td>
<td id="S5.T2.2.15.13.9" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;">
<span id="S5.T2.2.15.13.9.1" class="ltx_text ltx_font_bold" style="font-size:80%;">46.63</span><span id="S5.T2.2.15.13.9.2" class="ltx_text" style="font-size:80%;">%</span>
</td>
<td id="S5.T2.2.15.13.10" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;">
<span id="S5.T2.2.15.13.10.1" class="ltx_text ltx_font_bold" style="font-size:80%;">40.58</span><span id="S5.T2.2.15.13.10.2" class="ltx_text" style="font-size:80%;">%</span>
</td>
<td id="S5.T2.2.15.13.11" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:4.3pt;padding-right:4.3pt;">
<span id="S5.T2.2.15.13.11.1" class="ltx_text ltx_font_bold" style="font-size:80%;">41.62</span><span id="S5.T2.2.15.13.11.2" class="ltx_text" style="font-size:80%;">%</span>
</td>
</tr>
</tbody>
</table>
</figure>
<figure id="S5.F2" class="ltx_figure"><img src="/html/2205.03773/assets/x2.png" id="S5.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="747" height="371" alt="Performance comparison with classical models.">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Performance comparison with classical models.</figcaption>
</figure>
<div id="S5.SS4.p1" class="ltx_para">
<p id="S5.SS4.p1.1" class="ltx_p">We report the overall performance with deep neural network models in Table  <a href="#S5.T2" title="Table 2 ‣ 5.4 Overall Performance ‣ 5 Experiments ‣ Mutual Distillation Learning Network for Trajectory-User Linking" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, where the best is shown in bold and the second best is shown as underlined. The comparison with classical learning methods are shown in Figure <a href="#S5.F2" title="Figure 2 ‣ 5.4 Overall Performance ‣ 5 Experiments ‣ Mutual Distillation Learning Network for Trajectory-User Linking" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<div id="S5.SS4.p2" class="ltx_para">
<p id="S5.SS4.p2.1" class="ltx_p">As shown in Table  <a href="#S5.T2" title="Table 2 ‣ 5.4 Overall Performance ‣ 5 Experiments ‣ Mutual Distillation Learning Network for Trajectory-User Linking" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> and Figure <a href="#S5.F2" title="Figure 2 ‣ 5.4 Overall Performance ‣ 5 Experiments ‣ Mutual Distillation Learning Network for Trajectory-User Linking" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, MainTUL significantly outperforms all baselines in terms of all evaluation metrics on two real-world check-in datasets. Specifically, MainTUL achieves average 14.95% Acc@1 and 14.11% Macro-F1 improvement in comparison to the bested performed baseline on two datasets. The main reason is that our designed mutual distillation model based on two different trajectory encoders captures the spatio-temporal movement patterns of users’ check-in trajectories more effectively than RNN-based models (<span id="S5.SS4.p2.1.1" class="ltx_text ltx_font_italic">e</span>.<span id="S5.SS4.p2.1.2" class="ltx_text ltx_font_italic">g</span>., TULER and DeepTUL).
In addition, contextual features such as POI category and temporal information are integrated in MainTUL to further improve the performance.</p>
</div>
<div id="S5.SS4.p3" class="ltx_para">
<p id="S5.SS4.p3.2" class="ltx_p">We also observe that model performance on data with more users is worse than that on data with fewer users. This is intuitive because the more users the more difficult the classification becomes. However, the performance of our MainTUL is only reduced by 3.68% in Macro-F1 from <math id="S5.SS4.p3.1.m1.1" class="ltx_Math" alttext="|\mathcal{U}|=400" display="inline"><semantics id="S5.SS4.p3.1.m1.1a"><mrow id="S5.SS4.p3.1.m1.1.2" xref="S5.SS4.p3.1.m1.1.2.cmml"><mrow id="S5.SS4.p3.1.m1.1.2.2.2" xref="S5.SS4.p3.1.m1.1.2.2.1.cmml"><mo stretchy="false" id="S5.SS4.p3.1.m1.1.2.2.2.1" xref="S5.SS4.p3.1.m1.1.2.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S5.SS4.p3.1.m1.1.1" xref="S5.SS4.p3.1.m1.1.1.cmml">𝒰</mi><mo stretchy="false" id="S5.SS4.p3.1.m1.1.2.2.2.2" xref="S5.SS4.p3.1.m1.1.2.2.1.1.cmml">|</mo></mrow><mo id="S5.SS4.p3.1.m1.1.2.1" xref="S5.SS4.p3.1.m1.1.2.1.cmml">=</mo><mn id="S5.SS4.p3.1.m1.1.2.3" xref="S5.SS4.p3.1.m1.1.2.3.cmml">400</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.p3.1.m1.1b"><apply id="S5.SS4.p3.1.m1.1.2.cmml" xref="S5.SS4.p3.1.m1.1.2"><eq id="S5.SS4.p3.1.m1.1.2.1.cmml" xref="S5.SS4.p3.1.m1.1.2.1"></eq><apply id="S5.SS4.p3.1.m1.1.2.2.1.cmml" xref="S5.SS4.p3.1.m1.1.2.2.2"><abs id="S5.SS4.p3.1.m1.1.2.2.1.1.cmml" xref="S5.SS4.p3.1.m1.1.2.2.2.1"></abs><ci id="S5.SS4.p3.1.m1.1.1.cmml" xref="S5.SS4.p3.1.m1.1.1">𝒰</ci></apply><cn type="integer" id="S5.SS4.p3.1.m1.1.2.3.cmml" xref="S5.SS4.p3.1.m1.1.2.3">400</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p3.1.m1.1c">|\mathcal{U}|=400</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p3.1.m1.1d">| caligraphic_U | = 400</annotation></semantics></math> to <math id="S5.SS4.p3.2.m2.1" class="ltx_Math" alttext="|\mathcal{U}|=800" display="inline"><semantics id="S5.SS4.p3.2.m2.1a"><mrow id="S5.SS4.p3.2.m2.1.2" xref="S5.SS4.p3.2.m2.1.2.cmml"><mrow id="S5.SS4.p3.2.m2.1.2.2.2" xref="S5.SS4.p3.2.m2.1.2.2.1.cmml"><mo stretchy="false" id="S5.SS4.p3.2.m2.1.2.2.2.1" xref="S5.SS4.p3.2.m2.1.2.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S5.SS4.p3.2.m2.1.1" xref="S5.SS4.p3.2.m2.1.1.cmml">𝒰</mi><mo stretchy="false" id="S5.SS4.p3.2.m2.1.2.2.2.2" xref="S5.SS4.p3.2.m2.1.2.2.1.1.cmml">|</mo></mrow><mo id="S5.SS4.p3.2.m2.1.2.1" xref="S5.SS4.p3.2.m2.1.2.1.cmml">=</mo><mn id="S5.SS4.p3.2.m2.1.2.3" xref="S5.SS4.p3.2.m2.1.2.3.cmml">800</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.p3.2.m2.1b"><apply id="S5.SS4.p3.2.m2.1.2.cmml" xref="S5.SS4.p3.2.m2.1.2"><eq id="S5.SS4.p3.2.m2.1.2.1.cmml" xref="S5.SS4.p3.2.m2.1.2.1"></eq><apply id="S5.SS4.p3.2.m2.1.2.2.1.cmml" xref="S5.SS4.p3.2.m2.1.2.2.2"><abs id="S5.SS4.p3.2.m2.1.2.2.1.1.cmml" xref="S5.SS4.p3.2.m2.1.2.2.2.1"></abs><ci id="S5.SS4.p3.2.m2.1.1.cmml" xref="S5.SS4.p3.2.m2.1.1">𝒰</ci></apply><cn type="integer" id="S5.SS4.p3.2.m2.1.2.3.cmml" xref="S5.SS4.p3.2.m2.1.2.3">800</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p3.2.m2.1c">|\mathcal{U}|=800</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p3.2.m2.1d">| caligraphic_U | = 800</annotation></semantics></math>, while state-of-the-art model (<span id="S5.SS4.p3.2.1" class="ltx_text ltx_font_italic">i</span>.<span id="S5.SS4.p3.2.2" class="ltx_text ltx_font_italic">e</span>., DeepTUL) is reduced by 8.13%-9.22%.
For DeepTUL, considering the historical data of all users does have a certain improvement on the data with fewer users, but when the number of users is large, a large amount of history data will also bring more noise, resulting in a sharp drop in performance.
However, our model only uses the historical data of same user for trajectory enhancement and knowledge distillation during training, and does not require historical data for testing, and thus still performs better on the data with more users.</p>
</div>
<div id="S5.SS4.p4" class="ltx_para">
<p id="S5.SS4.p4.1" class="ltx_p">Notice that SML-TUL <cite class="ltx_cite ltx_citemacro_citep">(Zhou <span class="ltx_text ltx_font_italic">et al.</span>, <a href="#bib.bib34" title="" class="ltx_ref">2021a</a>)</cite> and TGAN <cite class="ltx_cite ltx_citemacro_citep">(Zhou <span class="ltx_text ltx_font_italic">et al.</span>, <a href="#bib.bib35" title="" class="ltx_ref">2021b</a>)</cite> are not compared in our experiments due to no publicly available source codes. However, our MainTUL significantly outperforms SML-TUL and TGAN in terms of Acc@<math id="S5.SS4.p4.1.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S5.SS4.p4.1.m1.1a"><mi id="S5.SS4.p4.1.m1.1.1" xref="S5.SS4.p4.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S5.SS4.p4.1.m1.1b"><ci id="S5.SS4.p4.1.m1.1.1.cmml" xref="S5.SS4.p4.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p4.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p4.1.m1.1d">italic_k</annotation></semantics></math> and Macro-F1 on Foursquare according to the results reported in <cite class="ltx_cite ltx_citemacro_citep">(Zhou <span class="ltx_text ltx_font_italic">et al.</span>, <a href="#bib.bib34" title="" class="ltx_ref">2021a</a>)</cite>, even if MainTUL links more users (<span id="S5.SS4.p4.1.1" class="ltx_text ltx_font_italic">e</span>.<span id="S5.SS4.p4.1.2" class="ltx_text ltx_font_italic">g</span>., <span id="S5.SS4.p4.1.3" class="ltx_text ltx_framed_underline">MainTUL</span> vs. SML-TUL vs. TGAN: <span id="S5.SS4.p4.1.4" class="ltx_text ltx_framed_underline">60.58%</span> vs. 57.23% vs. 53.00% in Acc@1, and <span id="S5.SS4.p4.1.5" class="ltx_text ltx_framed_underline">59.12%</span> vs 52.66% vs. 47.76% in Macro-F1 on Foursquare).</p>
</div>
</section>
<section id="S5.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.5 </span>Ablation Study</h3>

<section id="S5.SS5.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.5.1 </span>Component Ablation</h4>

<div id="S5.SS5.SSS1.p1" class="ltx_para">
<p id="S5.SS5.SSS1.p1.1" class="ltx_p">In our ablation study, we compare our model with the following three carefully designed variations: (1) <span id="S5.SS5.SSS1.p1.1.1" class="ltx_text ltx_font_bold">TUL-CA</span> – This variation removes the category and time information in check-in embedding layer. (2) <span id="S5.SS5.SSS1.p1.1.2" class="ltx_text ltx_font_bold">TUL-TA</span> – It uses position encoding in <cite class="ltx_cite ltx_citemacro_citep">(Vaswani <span class="ltx_text ltx_font_italic">et al.</span>, <a href="#bib.bib23" title="" class="ltx_ref">2017</a>)</cite> to replace our proposed temporal-aware position encoding. (3) <span id="S5.SS5.SSS1.p1.1.3" class="ltx_text ltx_font_bold">TUL-MUT</span> – It removes loss function <math id="S5.SS5.SSS1.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{L}_{2}" display="inline"><semantics id="S5.SS5.SSS1.p1.1.m1.1a"><msub id="S5.SS5.SSS1.p1.1.m1.1.1" xref="S5.SS5.SSS1.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS5.SSS1.p1.1.m1.1.1.2" xref="S5.SS5.SSS1.p1.1.m1.1.1.2.cmml">ℒ</mi><mn id="S5.SS5.SSS1.p1.1.m1.1.1.3" xref="S5.SS5.SSS1.p1.1.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S5.SS5.SSS1.p1.1.m1.1b"><apply id="S5.SS5.SSS1.p1.1.m1.1.1.cmml" xref="S5.SS5.SSS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS5.SSS1.p1.1.m1.1.1.1.cmml" xref="S5.SS5.SSS1.p1.1.m1.1.1">subscript</csymbol><ci id="S5.SS5.SSS1.p1.1.m1.1.1.2.cmml" xref="S5.SS5.SSS1.p1.1.m1.1.1.2">ℒ</ci><cn type="integer" id="S5.SS5.SSS1.p1.1.m1.1.1.3.cmml" xref="S5.SS5.SSS1.p1.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.SSS1.p1.1.m1.1c">\mathcal{L}_{2}</annotation><annotation encoding="application/x-llamapun" id="S5.SS5.SSS1.p1.1.m1.1d">caligraphic_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> to prove the importance of extracting knowledge from each other.</p>
</div>
<div id="S5.SS5.SSS1.p2" class="ltx_para">
<p id="S5.SS5.SSS1.p2.1" class="ltx_p">The results of ablation study are shown in Figure <a href="#S5.F3" title="Figure 3 ‣ 5.5.1 Component Ablation ‣ 5.5 Ablation Study ‣ 5 Experiments ‣ Mutual Distillation Learning Network for Trajectory-User Linking" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>.
As we can see, the key components all contribute to performance improvement of our model.
We can observe that TUL-MUT performs the worst in most cases, indicating that the mutual distillation strategy has the greatest impact on the performance improvement of our model.
The comparisons between TUL-CA, TUL-TA and MainTUL reflects the importance of the contextual features and temporal-aware position encoding, respectively. The results in Figure <a href="#S5.F3" title="Figure 3 ‣ 5.5.1 Component Ablation ‣ 5.5 Ablation Study ‣ 5 Experiments ‣ Mutual Distillation Learning Network for Trajectory-User Linking" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> demonstrate that temporal-aware position encoding has a greater impact on model performance on Foursquare dataset, while contextual features have a greater effect on Weeplaces dataset.</p>
</div>
<figure id="S5.F3" class="ltx_figure"><img src="/html/2205.03773/assets/x3.png" id="S5.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="747" height="304" alt="Experimental results of component ablation.">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Experimental results of component ablation.</figcaption>
</figure>
<figure id="S5.T3" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>Loss function explorations. Mac-F1: Macro-F1.</figcaption>
<table id="S5.T3.3" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T3.3.4.1" class="ltx_tr">
<th id="S5.T3.3.4.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" style="padding-left:3.4pt;padding-right:3.4pt;">Loss function</th>
<th id="S5.T3.3.4.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:3.4pt;padding-right:3.4pt;">
<table id="S5.T3.3.4.1.2.1" class="ltx_tabular ltx_align_middle">
<tr id="S5.T3.3.4.1.2.1.1" class="ltx_tr">
<td id="S5.T3.3.4.1.2.1.1.1" class="ltx_td ltx_align_center" style="padding-left:3.4pt;padding-right:3.4pt;">Foursqaure</td>
</tr>
<tr id="S5.T3.3.4.1.2.1.2" class="ltx_tr">
<td id="S5.T3.3.4.1.2.1.2.1" class="ltx_td ltx_align_center" style="padding-left:3.4pt;padding-right:3.4pt;">Acc@1/Mac-F1</td>
</tr>
</table>
</th>
<th id="S5.T3.3.4.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:3.4pt;padding-right:3.4pt;">
<table id="S5.T3.3.4.1.3.1" class="ltx_tabular ltx_align_middle">
<tr id="S5.T3.3.4.1.3.1.1" class="ltx_tr">
<td id="S5.T3.3.4.1.3.1.1.1" class="ltx_td ltx_align_center" style="padding-left:3.4pt;padding-right:3.4pt;">Weeplaces</td>
</tr>
<tr id="S5.T3.3.4.1.3.1.2" class="ltx_tr">
<td id="S5.T3.3.4.1.3.1.2.1" class="ltx_td ltx_align_center" style="padding-left:3.4pt;padding-right:3.4pt;">Acc@1/Mac-F1</td>
</tr>
</table>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T3.3.5.1" class="ltx_tr" style="background-color:#D9D9D9;">
<th id="S5.T3.3.5.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:3.4pt;padding-right:3.4pt;"><span id="S5.T3.3.5.1.1.1" class="ltx_text" style="background-color:#D9D9D9;">original</span></th>
<td id="S5.T3.3.5.1.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:3.4pt;padding-right:3.4pt;"><span id="S5.T3.3.5.1.2.1" class="ltx_text" style="background-color:#D9D9D9;">60.58%/59.12%</span></td>
<td id="S5.T3.3.5.1.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:3.4pt;padding-right:3.4pt;"><span id="S5.T3.3.5.1.3.1" class="ltx_text" style="background-color:#D9D9D9;">45.31%/45.22%</span></td>
</tr>
<tr id="S5.T3.1.1" class="ltx_tr">
<th id="S5.T3.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:3.4pt;padding-right:3.4pt;">w/o all <math id="S5.T3.1.1.1.m1.2" class="ltx_Math" alttext="\lambda T^{2}\operatorname{KL}(\cdot)" display="inline"><semantics id="S5.T3.1.1.1.m1.2a"><mrow id="S5.T3.1.1.1.m1.2.3" xref="S5.T3.1.1.1.m1.2.3.cmml"><mi id="S5.T3.1.1.1.m1.2.3.2" xref="S5.T3.1.1.1.m1.2.3.2.cmml">λ</mi><mo id="S5.T3.1.1.1.m1.2.3.1" xref="S5.T3.1.1.1.m1.2.3.1.cmml">⁢</mo><msup id="S5.T3.1.1.1.m1.2.3.3" xref="S5.T3.1.1.1.m1.2.3.3.cmml"><mi id="S5.T3.1.1.1.m1.2.3.3.2" xref="S5.T3.1.1.1.m1.2.3.3.2.cmml">T</mi><mn id="S5.T3.1.1.1.m1.2.3.3.3" xref="S5.T3.1.1.1.m1.2.3.3.3.cmml">2</mn></msup><mo id="S5.T3.1.1.1.m1.2.3.1a" xref="S5.T3.1.1.1.m1.2.3.1.cmml">⁢</mo><mrow id="S5.T3.1.1.1.m1.2.3.4.2" xref="S5.T3.1.1.1.m1.2.3.4.1.cmml"><mi id="S5.T3.1.1.1.m1.1.1" xref="S5.T3.1.1.1.m1.1.1.cmml">KL</mi><mo id="S5.T3.1.1.1.m1.2.3.4.2a" xref="S5.T3.1.1.1.m1.2.3.4.1.cmml">⁡</mo><mrow id="S5.T3.1.1.1.m1.2.3.4.2.1" xref="S5.T3.1.1.1.m1.2.3.4.1.cmml"><mo stretchy="false" id="S5.T3.1.1.1.m1.2.3.4.2.1.1" xref="S5.T3.1.1.1.m1.2.3.4.1.cmml">(</mo><mo id="S5.T3.1.1.1.m1.2.2" xref="S5.T3.1.1.1.m1.2.2.cmml">⋅</mo><mo stretchy="false" id="S5.T3.1.1.1.m1.2.3.4.2.1.2" xref="S5.T3.1.1.1.m1.2.3.4.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.T3.1.1.1.m1.2b"><apply id="S5.T3.1.1.1.m1.2.3.cmml" xref="S5.T3.1.1.1.m1.2.3"><times id="S5.T3.1.1.1.m1.2.3.1.cmml" xref="S5.T3.1.1.1.m1.2.3.1"></times><ci id="S5.T3.1.1.1.m1.2.3.2.cmml" xref="S5.T3.1.1.1.m1.2.3.2">𝜆</ci><apply id="S5.T3.1.1.1.m1.2.3.3.cmml" xref="S5.T3.1.1.1.m1.2.3.3"><csymbol cd="ambiguous" id="S5.T3.1.1.1.m1.2.3.3.1.cmml" xref="S5.T3.1.1.1.m1.2.3.3">superscript</csymbol><ci id="S5.T3.1.1.1.m1.2.3.3.2.cmml" xref="S5.T3.1.1.1.m1.2.3.3.2">𝑇</ci><cn type="integer" id="S5.T3.1.1.1.m1.2.3.3.3.cmml" xref="S5.T3.1.1.1.m1.2.3.3.3">2</cn></apply><apply id="S5.T3.1.1.1.m1.2.3.4.1.cmml" xref="S5.T3.1.1.1.m1.2.3.4.2"><ci id="S5.T3.1.1.1.m1.1.1.cmml" xref="S5.T3.1.1.1.m1.1.1">KL</ci><ci id="S5.T3.1.1.1.m1.2.2.cmml" xref="S5.T3.1.1.1.m1.2.2">⋅</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.1.1.1.m1.2c">\lambda T^{2}\operatorname{KL}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S5.T3.1.1.1.m1.2d">italic_λ italic_T start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT roman_KL ( ⋅ )</annotation></semantics></math>
</th>
<td id="S5.T3.1.1.2" class="ltx_td ltx_align_center" style="padding-left:3.4pt;padding-right:3.4pt;">55.36%/53.57%</td>
<td id="S5.T3.1.1.3" class="ltx_td ltx_align_center" style="padding-left:3.4pt;padding-right:3.4pt;">40.01%/39.24%</td>
</tr>
<tr id="S5.T3.3.3" class="ltx_tr">
<th id="S5.T3.3.3.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" style="padding-left:3.4pt;padding-right:3.4pt;">w/o <math id="S5.T3.2.2.1.m1.2" class="ltx_Math" alttext="\mathcal{H}(y,z_{in}^{\theta})" display="inline"><semantics id="S5.T3.2.2.1.m1.2a"><mrow id="S5.T3.2.2.1.m1.2.2" xref="S5.T3.2.2.1.m1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.T3.2.2.1.m1.2.2.3" xref="S5.T3.2.2.1.m1.2.2.3.cmml">ℋ</mi><mo id="S5.T3.2.2.1.m1.2.2.2" xref="S5.T3.2.2.1.m1.2.2.2.cmml">⁢</mo><mrow id="S5.T3.2.2.1.m1.2.2.1.1" xref="S5.T3.2.2.1.m1.2.2.1.2.cmml"><mo stretchy="false" id="S5.T3.2.2.1.m1.2.2.1.1.2" xref="S5.T3.2.2.1.m1.2.2.1.2.cmml">(</mo><mi id="S5.T3.2.2.1.m1.1.1" xref="S5.T3.2.2.1.m1.1.1.cmml">y</mi><mo id="S5.T3.2.2.1.m1.2.2.1.1.3" xref="S5.T3.2.2.1.m1.2.2.1.2.cmml">,</mo><msubsup id="S5.T3.2.2.1.m1.2.2.1.1.1" xref="S5.T3.2.2.1.m1.2.2.1.1.1.cmml"><mi id="S5.T3.2.2.1.m1.2.2.1.1.1.2.2" xref="S5.T3.2.2.1.m1.2.2.1.1.1.2.2.cmml">z</mi><mrow id="S5.T3.2.2.1.m1.2.2.1.1.1.2.3" xref="S5.T3.2.2.1.m1.2.2.1.1.1.2.3.cmml"><mi id="S5.T3.2.2.1.m1.2.2.1.1.1.2.3.2" xref="S5.T3.2.2.1.m1.2.2.1.1.1.2.3.2.cmml">i</mi><mo id="S5.T3.2.2.1.m1.2.2.1.1.1.2.3.1" xref="S5.T3.2.2.1.m1.2.2.1.1.1.2.3.1.cmml">⁢</mo><mi id="S5.T3.2.2.1.m1.2.2.1.1.1.2.3.3" xref="S5.T3.2.2.1.m1.2.2.1.1.1.2.3.3.cmml">n</mi></mrow><mi id="S5.T3.2.2.1.m1.2.2.1.1.1.3" xref="S5.T3.2.2.1.m1.2.2.1.1.1.3.cmml">θ</mi></msubsup><mo stretchy="false" id="S5.T3.2.2.1.m1.2.2.1.1.4" xref="S5.T3.2.2.1.m1.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.T3.2.2.1.m1.2b"><apply id="S5.T3.2.2.1.m1.2.2.cmml" xref="S5.T3.2.2.1.m1.2.2"><times id="S5.T3.2.2.1.m1.2.2.2.cmml" xref="S5.T3.2.2.1.m1.2.2.2"></times><ci id="S5.T3.2.2.1.m1.2.2.3.cmml" xref="S5.T3.2.2.1.m1.2.2.3">ℋ</ci><interval closure="open" id="S5.T3.2.2.1.m1.2.2.1.2.cmml" xref="S5.T3.2.2.1.m1.2.2.1.1"><ci id="S5.T3.2.2.1.m1.1.1.cmml" xref="S5.T3.2.2.1.m1.1.1">𝑦</ci><apply id="S5.T3.2.2.1.m1.2.2.1.1.1.cmml" xref="S5.T3.2.2.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S5.T3.2.2.1.m1.2.2.1.1.1.1.cmml" xref="S5.T3.2.2.1.m1.2.2.1.1.1">superscript</csymbol><apply id="S5.T3.2.2.1.m1.2.2.1.1.1.2.cmml" xref="S5.T3.2.2.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S5.T3.2.2.1.m1.2.2.1.1.1.2.1.cmml" xref="S5.T3.2.2.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S5.T3.2.2.1.m1.2.2.1.1.1.2.2.cmml" xref="S5.T3.2.2.1.m1.2.2.1.1.1.2.2">𝑧</ci><apply id="S5.T3.2.2.1.m1.2.2.1.1.1.2.3.cmml" xref="S5.T3.2.2.1.m1.2.2.1.1.1.2.3"><times id="S5.T3.2.2.1.m1.2.2.1.1.1.2.3.1.cmml" xref="S5.T3.2.2.1.m1.2.2.1.1.1.2.3.1"></times><ci id="S5.T3.2.2.1.m1.2.2.1.1.1.2.3.2.cmml" xref="S5.T3.2.2.1.m1.2.2.1.1.1.2.3.2">𝑖</ci><ci id="S5.T3.2.2.1.m1.2.2.1.1.1.2.3.3.cmml" xref="S5.T3.2.2.1.m1.2.2.1.1.1.2.3.3">𝑛</ci></apply></apply><ci id="S5.T3.2.2.1.m1.2.2.1.1.1.3.cmml" xref="S5.T3.2.2.1.m1.2.2.1.1.1.3">𝜃</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.2.2.1.m1.2c">\mathcal{H}(y,z_{in}^{\theta})</annotation><annotation encoding="application/x-llamapun" id="S5.T3.2.2.1.m1.2d">caligraphic_H ( italic_y , italic_z start_POSTSUBSCRIPT italic_i italic_n end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_θ end_POSTSUPERSCRIPT )</annotation></semantics></math> and <math id="S5.T3.3.3.2.m2.2" class="ltx_Math" alttext="\mathcal{H}(y,z_{in}^{\phi})" display="inline"><semantics id="S5.T3.3.3.2.m2.2a"><mrow id="S5.T3.3.3.2.m2.2.2" xref="S5.T3.3.3.2.m2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.T3.3.3.2.m2.2.2.3" xref="S5.T3.3.3.2.m2.2.2.3.cmml">ℋ</mi><mo id="S5.T3.3.3.2.m2.2.2.2" xref="S5.T3.3.3.2.m2.2.2.2.cmml">⁢</mo><mrow id="S5.T3.3.3.2.m2.2.2.1.1" xref="S5.T3.3.3.2.m2.2.2.1.2.cmml"><mo stretchy="false" id="S5.T3.3.3.2.m2.2.2.1.1.2" xref="S5.T3.3.3.2.m2.2.2.1.2.cmml">(</mo><mi id="S5.T3.3.3.2.m2.1.1" xref="S5.T3.3.3.2.m2.1.1.cmml">y</mi><mo id="S5.T3.3.3.2.m2.2.2.1.1.3" xref="S5.T3.3.3.2.m2.2.2.1.2.cmml">,</mo><msubsup id="S5.T3.3.3.2.m2.2.2.1.1.1" xref="S5.T3.3.3.2.m2.2.2.1.1.1.cmml"><mi id="S5.T3.3.3.2.m2.2.2.1.1.1.2.2" xref="S5.T3.3.3.2.m2.2.2.1.1.1.2.2.cmml">z</mi><mrow id="S5.T3.3.3.2.m2.2.2.1.1.1.2.3" xref="S5.T3.3.3.2.m2.2.2.1.1.1.2.3.cmml"><mi id="S5.T3.3.3.2.m2.2.2.1.1.1.2.3.2" xref="S5.T3.3.3.2.m2.2.2.1.1.1.2.3.2.cmml">i</mi><mo id="S5.T3.3.3.2.m2.2.2.1.1.1.2.3.1" xref="S5.T3.3.3.2.m2.2.2.1.1.1.2.3.1.cmml">⁢</mo><mi id="S5.T3.3.3.2.m2.2.2.1.1.1.2.3.3" xref="S5.T3.3.3.2.m2.2.2.1.1.1.2.3.3.cmml">n</mi></mrow><mi id="S5.T3.3.3.2.m2.2.2.1.1.1.3" xref="S5.T3.3.3.2.m2.2.2.1.1.1.3.cmml">ϕ</mi></msubsup><mo stretchy="false" id="S5.T3.3.3.2.m2.2.2.1.1.4" xref="S5.T3.3.3.2.m2.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.T3.3.3.2.m2.2b"><apply id="S5.T3.3.3.2.m2.2.2.cmml" xref="S5.T3.3.3.2.m2.2.2"><times id="S5.T3.3.3.2.m2.2.2.2.cmml" xref="S5.T3.3.3.2.m2.2.2.2"></times><ci id="S5.T3.3.3.2.m2.2.2.3.cmml" xref="S5.T3.3.3.2.m2.2.2.3">ℋ</ci><interval closure="open" id="S5.T3.3.3.2.m2.2.2.1.2.cmml" xref="S5.T3.3.3.2.m2.2.2.1.1"><ci id="S5.T3.3.3.2.m2.1.1.cmml" xref="S5.T3.3.3.2.m2.1.1">𝑦</ci><apply id="S5.T3.3.3.2.m2.2.2.1.1.1.cmml" xref="S5.T3.3.3.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S5.T3.3.3.2.m2.2.2.1.1.1.1.cmml" xref="S5.T3.3.3.2.m2.2.2.1.1.1">superscript</csymbol><apply id="S5.T3.3.3.2.m2.2.2.1.1.1.2.cmml" xref="S5.T3.3.3.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S5.T3.3.3.2.m2.2.2.1.1.1.2.1.cmml" xref="S5.T3.3.3.2.m2.2.2.1.1.1">subscript</csymbol><ci id="S5.T3.3.3.2.m2.2.2.1.1.1.2.2.cmml" xref="S5.T3.3.3.2.m2.2.2.1.1.1.2.2">𝑧</ci><apply id="S5.T3.3.3.2.m2.2.2.1.1.1.2.3.cmml" xref="S5.T3.3.3.2.m2.2.2.1.1.1.2.3"><times id="S5.T3.3.3.2.m2.2.2.1.1.1.2.3.1.cmml" xref="S5.T3.3.3.2.m2.2.2.1.1.1.2.3.1"></times><ci id="S5.T3.3.3.2.m2.2.2.1.1.1.2.3.2.cmml" xref="S5.T3.3.3.2.m2.2.2.1.1.1.2.3.2">𝑖</ci><ci id="S5.T3.3.3.2.m2.2.2.1.1.1.2.3.3.cmml" xref="S5.T3.3.3.2.m2.2.2.1.1.1.2.3.3">𝑛</ci></apply></apply><ci id="S5.T3.3.3.2.m2.2.2.1.1.1.3.cmml" xref="S5.T3.3.3.2.m2.2.2.1.1.1.3">italic-ϕ</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.3.3.2.m2.2c">\mathcal{H}(y,z_{in}^{\phi})</annotation><annotation encoding="application/x-llamapun" id="S5.T3.3.3.2.m2.2d">caligraphic_H ( italic_y , italic_z start_POSTSUBSCRIPT italic_i italic_n end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_ϕ end_POSTSUPERSCRIPT )</annotation></semantics></math>
</th>
<td id="S5.T3.3.3.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:3.4pt;padding-right:3.4pt;">60.06%/58.64%</td>
<td id="S5.T3.3.3.4" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:3.4pt;padding-right:3.4pt;">43.49%/43.58%</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section id="S5.SS5.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.5.2 </span>Loss Function Ablation</h4>

<div id="S5.SS5.SSS2.p1" class="ltx_para">
<p id="S5.SS5.SSS2.p1.1" class="ltx_p">We also evaluate the effectiveness of each term in our loss function (Eq. (<a href="#S4.E9" title="(9) ‣ 4.3 Mutual Distillation Network ‣ 4 Methodology ‣ Mutual Distillation Learning Network for Trajectory-User Linking" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a>)).
Table <a href="#S5.T3" title="Table 3 ‣ 5.5.1 Component Ablation ‣ 5.5 Ablation Study ‣ 5 Experiments ‣ Mutual Distillation Learning Network for Trajectory-User Linking" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> depicts the experimental results of different loss functions on two datasets with 400 users.</p>
</div>
<div id="S5.SS5.SSS2.p2" class="ltx_para">
<p id="S5.SS5.SSS2.p2.3" class="ltx_p">First, we can see that removing term <math id="S5.SS5.SSS2.p2.1.m1.2" class="ltx_Math" alttext="\lambda T^{2}\operatorname{KL}(\cdot)" display="inline"><semantics id="S5.SS5.SSS2.p2.1.m1.2a"><mrow id="S5.SS5.SSS2.p2.1.m1.2.3" xref="S5.SS5.SSS2.p2.1.m1.2.3.cmml"><mi id="S5.SS5.SSS2.p2.1.m1.2.3.2" xref="S5.SS5.SSS2.p2.1.m1.2.3.2.cmml">λ</mi><mo id="S5.SS5.SSS2.p2.1.m1.2.3.1" xref="S5.SS5.SSS2.p2.1.m1.2.3.1.cmml">⁢</mo><msup id="S5.SS5.SSS2.p2.1.m1.2.3.3" xref="S5.SS5.SSS2.p2.1.m1.2.3.3.cmml"><mi id="S5.SS5.SSS2.p2.1.m1.2.3.3.2" xref="S5.SS5.SSS2.p2.1.m1.2.3.3.2.cmml">T</mi><mn id="S5.SS5.SSS2.p2.1.m1.2.3.3.3" xref="S5.SS5.SSS2.p2.1.m1.2.3.3.3.cmml">2</mn></msup><mo id="S5.SS5.SSS2.p2.1.m1.2.3.1a" xref="S5.SS5.SSS2.p2.1.m1.2.3.1.cmml">⁢</mo><mrow id="S5.SS5.SSS2.p2.1.m1.2.3.4.2" xref="S5.SS5.SSS2.p2.1.m1.2.3.4.1.cmml"><mi id="S5.SS5.SSS2.p2.1.m1.1.1" xref="S5.SS5.SSS2.p2.1.m1.1.1.cmml">KL</mi><mo id="S5.SS5.SSS2.p2.1.m1.2.3.4.2a" xref="S5.SS5.SSS2.p2.1.m1.2.3.4.1.cmml">⁡</mo><mrow id="S5.SS5.SSS2.p2.1.m1.2.3.4.2.1" xref="S5.SS5.SSS2.p2.1.m1.2.3.4.1.cmml"><mo stretchy="false" id="S5.SS5.SSS2.p2.1.m1.2.3.4.2.1.1" xref="S5.SS5.SSS2.p2.1.m1.2.3.4.1.cmml">(</mo><mo id="S5.SS5.SSS2.p2.1.m1.2.2" xref="S5.SS5.SSS2.p2.1.m1.2.2.cmml">⋅</mo><mo stretchy="false" id="S5.SS5.SSS2.p2.1.m1.2.3.4.2.1.2" xref="S5.SS5.SSS2.p2.1.m1.2.3.4.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS5.SSS2.p2.1.m1.2b"><apply id="S5.SS5.SSS2.p2.1.m1.2.3.cmml" xref="S5.SS5.SSS2.p2.1.m1.2.3"><times id="S5.SS5.SSS2.p2.1.m1.2.3.1.cmml" xref="S5.SS5.SSS2.p2.1.m1.2.3.1"></times><ci id="S5.SS5.SSS2.p2.1.m1.2.3.2.cmml" xref="S5.SS5.SSS2.p2.1.m1.2.3.2">𝜆</ci><apply id="S5.SS5.SSS2.p2.1.m1.2.3.3.cmml" xref="S5.SS5.SSS2.p2.1.m1.2.3.3"><csymbol cd="ambiguous" id="S5.SS5.SSS2.p2.1.m1.2.3.3.1.cmml" xref="S5.SS5.SSS2.p2.1.m1.2.3.3">superscript</csymbol><ci id="S5.SS5.SSS2.p2.1.m1.2.3.3.2.cmml" xref="S5.SS5.SSS2.p2.1.m1.2.3.3.2">𝑇</ci><cn type="integer" id="S5.SS5.SSS2.p2.1.m1.2.3.3.3.cmml" xref="S5.SS5.SSS2.p2.1.m1.2.3.3.3">2</cn></apply><apply id="S5.SS5.SSS2.p2.1.m1.2.3.4.1.cmml" xref="S5.SS5.SSS2.p2.1.m1.2.3.4.2"><ci id="S5.SS5.SSS2.p2.1.m1.1.1.cmml" xref="S5.SS5.SSS2.p2.1.m1.1.1">KL</ci><ci id="S5.SS5.SSS2.p2.1.m1.2.2.cmml" xref="S5.SS5.SSS2.p2.1.m1.2.2">⋅</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.SSS2.p2.1.m1.2c">\lambda T^{2}\operatorname{KL}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S5.SS5.SSS2.p2.1.m1.2d">italic_λ italic_T start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT roman_KL ( ⋅ )</annotation></semantics></math> leads to the decrease in performance, which demonstrates the importance of dark knowledge of long-term augmented trajectory. Second, we notice that removing term <math id="S5.SS5.SSS2.p2.2.m2.2" class="ltx_Math" alttext="\mathcal{H}(y,z_{in}^{\theta})" display="inline"><semantics id="S5.SS5.SSS2.p2.2.m2.2a"><mrow id="S5.SS5.SSS2.p2.2.m2.2.2" xref="S5.SS5.SSS2.p2.2.m2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS5.SSS2.p2.2.m2.2.2.3" xref="S5.SS5.SSS2.p2.2.m2.2.2.3.cmml">ℋ</mi><mo id="S5.SS5.SSS2.p2.2.m2.2.2.2" xref="S5.SS5.SSS2.p2.2.m2.2.2.2.cmml">⁢</mo><mrow id="S5.SS5.SSS2.p2.2.m2.2.2.1.1" xref="S5.SS5.SSS2.p2.2.m2.2.2.1.2.cmml"><mo stretchy="false" id="S5.SS5.SSS2.p2.2.m2.2.2.1.1.2" xref="S5.SS5.SSS2.p2.2.m2.2.2.1.2.cmml">(</mo><mi id="S5.SS5.SSS2.p2.2.m2.1.1" xref="S5.SS5.SSS2.p2.2.m2.1.1.cmml">y</mi><mo id="S5.SS5.SSS2.p2.2.m2.2.2.1.1.3" xref="S5.SS5.SSS2.p2.2.m2.2.2.1.2.cmml">,</mo><msubsup id="S5.SS5.SSS2.p2.2.m2.2.2.1.1.1" xref="S5.SS5.SSS2.p2.2.m2.2.2.1.1.1.cmml"><mi id="S5.SS5.SSS2.p2.2.m2.2.2.1.1.1.2.2" xref="S5.SS5.SSS2.p2.2.m2.2.2.1.1.1.2.2.cmml">z</mi><mrow id="S5.SS5.SSS2.p2.2.m2.2.2.1.1.1.2.3" xref="S5.SS5.SSS2.p2.2.m2.2.2.1.1.1.2.3.cmml"><mi id="S5.SS5.SSS2.p2.2.m2.2.2.1.1.1.2.3.2" xref="S5.SS5.SSS2.p2.2.m2.2.2.1.1.1.2.3.2.cmml">i</mi><mo id="S5.SS5.SSS2.p2.2.m2.2.2.1.1.1.2.3.1" xref="S5.SS5.SSS2.p2.2.m2.2.2.1.1.1.2.3.1.cmml">⁢</mo><mi id="S5.SS5.SSS2.p2.2.m2.2.2.1.1.1.2.3.3" xref="S5.SS5.SSS2.p2.2.m2.2.2.1.1.1.2.3.3.cmml">n</mi></mrow><mi id="S5.SS5.SSS2.p2.2.m2.2.2.1.1.1.3" xref="S5.SS5.SSS2.p2.2.m2.2.2.1.1.1.3.cmml">θ</mi></msubsup><mo stretchy="false" id="S5.SS5.SSS2.p2.2.m2.2.2.1.1.4" xref="S5.SS5.SSS2.p2.2.m2.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS5.SSS2.p2.2.m2.2b"><apply id="S5.SS5.SSS2.p2.2.m2.2.2.cmml" xref="S5.SS5.SSS2.p2.2.m2.2.2"><times id="S5.SS5.SSS2.p2.2.m2.2.2.2.cmml" xref="S5.SS5.SSS2.p2.2.m2.2.2.2"></times><ci id="S5.SS5.SSS2.p2.2.m2.2.2.3.cmml" xref="S5.SS5.SSS2.p2.2.m2.2.2.3">ℋ</ci><interval closure="open" id="S5.SS5.SSS2.p2.2.m2.2.2.1.2.cmml" xref="S5.SS5.SSS2.p2.2.m2.2.2.1.1"><ci id="S5.SS5.SSS2.p2.2.m2.1.1.cmml" xref="S5.SS5.SSS2.p2.2.m2.1.1">𝑦</ci><apply id="S5.SS5.SSS2.p2.2.m2.2.2.1.1.1.cmml" xref="S5.SS5.SSS2.p2.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S5.SS5.SSS2.p2.2.m2.2.2.1.1.1.1.cmml" xref="S5.SS5.SSS2.p2.2.m2.2.2.1.1.1">superscript</csymbol><apply id="S5.SS5.SSS2.p2.2.m2.2.2.1.1.1.2.cmml" xref="S5.SS5.SSS2.p2.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S5.SS5.SSS2.p2.2.m2.2.2.1.1.1.2.1.cmml" xref="S5.SS5.SSS2.p2.2.m2.2.2.1.1.1">subscript</csymbol><ci id="S5.SS5.SSS2.p2.2.m2.2.2.1.1.1.2.2.cmml" xref="S5.SS5.SSS2.p2.2.m2.2.2.1.1.1.2.2">𝑧</ci><apply id="S5.SS5.SSS2.p2.2.m2.2.2.1.1.1.2.3.cmml" xref="S5.SS5.SSS2.p2.2.m2.2.2.1.1.1.2.3"><times id="S5.SS5.SSS2.p2.2.m2.2.2.1.1.1.2.3.1.cmml" xref="S5.SS5.SSS2.p2.2.m2.2.2.1.1.1.2.3.1"></times><ci id="S5.SS5.SSS2.p2.2.m2.2.2.1.1.1.2.3.2.cmml" xref="S5.SS5.SSS2.p2.2.m2.2.2.1.1.1.2.3.2">𝑖</ci><ci id="S5.SS5.SSS2.p2.2.m2.2.2.1.1.1.2.3.3.cmml" xref="S5.SS5.SSS2.p2.2.m2.2.2.1.1.1.2.3.3">𝑛</ci></apply></apply><ci id="S5.SS5.SSS2.p2.2.m2.2.2.1.1.1.3.cmml" xref="S5.SS5.SSS2.p2.2.m2.2.2.1.1.1.3">𝜃</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.SSS2.p2.2.m2.2c">\mathcal{H}(y,z_{in}^{\theta})</annotation><annotation encoding="application/x-llamapun" id="S5.SS5.SSS2.p2.2.m2.2d">caligraphic_H ( italic_y , italic_z start_POSTSUBSCRIPT italic_i italic_n end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_θ end_POSTSUPERSCRIPT )</annotation></semantics></math> and <math id="S5.SS5.SSS2.p2.3.m3.2" class="ltx_Math" alttext="\mathcal{H}(y,z_{in}^{\phi})" display="inline"><semantics id="S5.SS5.SSS2.p2.3.m3.2a"><mrow id="S5.SS5.SSS2.p2.3.m3.2.2" xref="S5.SS5.SSS2.p2.3.m3.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS5.SSS2.p2.3.m3.2.2.3" xref="S5.SS5.SSS2.p2.3.m3.2.2.3.cmml">ℋ</mi><mo id="S5.SS5.SSS2.p2.3.m3.2.2.2" xref="S5.SS5.SSS2.p2.3.m3.2.2.2.cmml">⁢</mo><mrow id="S5.SS5.SSS2.p2.3.m3.2.2.1.1" xref="S5.SS5.SSS2.p2.3.m3.2.2.1.2.cmml"><mo stretchy="false" id="S5.SS5.SSS2.p2.3.m3.2.2.1.1.2" xref="S5.SS5.SSS2.p2.3.m3.2.2.1.2.cmml">(</mo><mi id="S5.SS5.SSS2.p2.3.m3.1.1" xref="S5.SS5.SSS2.p2.3.m3.1.1.cmml">y</mi><mo id="S5.SS5.SSS2.p2.3.m3.2.2.1.1.3" xref="S5.SS5.SSS2.p2.3.m3.2.2.1.2.cmml">,</mo><msubsup id="S5.SS5.SSS2.p2.3.m3.2.2.1.1.1" xref="S5.SS5.SSS2.p2.3.m3.2.2.1.1.1.cmml"><mi id="S5.SS5.SSS2.p2.3.m3.2.2.1.1.1.2.2" xref="S5.SS5.SSS2.p2.3.m3.2.2.1.1.1.2.2.cmml">z</mi><mrow id="S5.SS5.SSS2.p2.3.m3.2.2.1.1.1.2.3" xref="S5.SS5.SSS2.p2.3.m3.2.2.1.1.1.2.3.cmml"><mi id="S5.SS5.SSS2.p2.3.m3.2.2.1.1.1.2.3.2" xref="S5.SS5.SSS2.p2.3.m3.2.2.1.1.1.2.3.2.cmml">i</mi><mo id="S5.SS5.SSS2.p2.3.m3.2.2.1.1.1.2.3.1" xref="S5.SS5.SSS2.p2.3.m3.2.2.1.1.1.2.3.1.cmml">⁢</mo><mi id="S5.SS5.SSS2.p2.3.m3.2.2.1.1.1.2.3.3" xref="S5.SS5.SSS2.p2.3.m3.2.2.1.1.1.2.3.3.cmml">n</mi></mrow><mi id="S5.SS5.SSS2.p2.3.m3.2.2.1.1.1.3" xref="S5.SS5.SSS2.p2.3.m3.2.2.1.1.1.3.cmml">ϕ</mi></msubsup><mo stretchy="false" id="S5.SS5.SSS2.p2.3.m3.2.2.1.1.4" xref="S5.SS5.SSS2.p2.3.m3.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS5.SSS2.p2.3.m3.2b"><apply id="S5.SS5.SSS2.p2.3.m3.2.2.cmml" xref="S5.SS5.SSS2.p2.3.m3.2.2"><times id="S5.SS5.SSS2.p2.3.m3.2.2.2.cmml" xref="S5.SS5.SSS2.p2.3.m3.2.2.2"></times><ci id="S5.SS5.SSS2.p2.3.m3.2.2.3.cmml" xref="S5.SS5.SSS2.p2.3.m3.2.2.3">ℋ</ci><interval closure="open" id="S5.SS5.SSS2.p2.3.m3.2.2.1.2.cmml" xref="S5.SS5.SSS2.p2.3.m3.2.2.1.1"><ci id="S5.SS5.SSS2.p2.3.m3.1.1.cmml" xref="S5.SS5.SSS2.p2.3.m3.1.1">𝑦</ci><apply id="S5.SS5.SSS2.p2.3.m3.2.2.1.1.1.cmml" xref="S5.SS5.SSS2.p2.3.m3.2.2.1.1.1"><csymbol cd="ambiguous" id="S5.SS5.SSS2.p2.3.m3.2.2.1.1.1.1.cmml" xref="S5.SS5.SSS2.p2.3.m3.2.2.1.1.1">superscript</csymbol><apply id="S5.SS5.SSS2.p2.3.m3.2.2.1.1.1.2.cmml" xref="S5.SS5.SSS2.p2.3.m3.2.2.1.1.1"><csymbol cd="ambiguous" id="S5.SS5.SSS2.p2.3.m3.2.2.1.1.1.2.1.cmml" xref="S5.SS5.SSS2.p2.3.m3.2.2.1.1.1">subscript</csymbol><ci id="S5.SS5.SSS2.p2.3.m3.2.2.1.1.1.2.2.cmml" xref="S5.SS5.SSS2.p2.3.m3.2.2.1.1.1.2.2">𝑧</ci><apply id="S5.SS5.SSS2.p2.3.m3.2.2.1.1.1.2.3.cmml" xref="S5.SS5.SSS2.p2.3.m3.2.2.1.1.1.2.3"><times id="S5.SS5.SSS2.p2.3.m3.2.2.1.1.1.2.3.1.cmml" xref="S5.SS5.SSS2.p2.3.m3.2.2.1.1.1.2.3.1"></times><ci id="S5.SS5.SSS2.p2.3.m3.2.2.1.1.1.2.3.2.cmml" xref="S5.SS5.SSS2.p2.3.m3.2.2.1.1.1.2.3.2">𝑖</ci><ci id="S5.SS5.SSS2.p2.3.m3.2.2.1.1.1.2.3.3.cmml" xref="S5.SS5.SSS2.p2.3.m3.2.2.1.1.1.2.3.3">𝑛</ci></apply></apply><ci id="S5.SS5.SSS2.p2.3.m3.2.2.1.1.1.3.cmml" xref="S5.SS5.SSS2.p2.3.m3.2.2.1.1.1.3">italic-ϕ</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.SSS2.p2.3.m3.2c">\mathcal{H}(y,z_{in}^{\phi})</annotation><annotation encoding="application/x-llamapun" id="S5.SS5.SSS2.p2.3.m3.2d">caligraphic_H ( italic_y , italic_z start_POSTSUBSCRIPT italic_i italic_n end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_ϕ end_POSTSUPERSCRIPT )</annotation></semantics></math>, i.e., without considering the input trajectory labels, the model performance does not drop significantly. This indicates that our model can still achieve better results only through the knowledge distillation of augmented trajectories.</p>
</div>
</section>
</section>
<section id="S5.SS6" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.6 </span>Parameter Study</h3>

<div id="S5.SS6.p1" class="ltx_para">
<p id="S5.SS6.p1.5" class="ltx_p">We also evaluate the sensitivity of our MainTUL with respect to different settings of temperature <math id="S5.SS6.p1.1.m1.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S5.SS6.p1.1.m1.1a"><mi id="S5.SS6.p1.1.m1.1.1" xref="S5.SS6.p1.1.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S5.SS6.p1.1.m1.1b"><ci id="S5.SS6.p1.1.m1.1.1.cmml" xref="S5.SS6.p1.1.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p1.1.m1.1c">T</annotation><annotation encoding="application/x-llamapun" id="S5.SS6.p1.1.m1.1d">italic_T</annotation></semantics></math> and hyperparameter <math id="S5.SS6.p1.2.m2.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S5.SS6.p1.2.m2.1a"><mi id="S5.SS6.p1.2.m2.1.1" xref="S5.SS6.p1.2.m2.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S5.SS6.p1.2.m2.1b"><ci id="S5.SS6.p1.2.m2.1.1.cmml" xref="S5.SS6.p1.2.m2.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p1.2.m2.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S5.SS6.p1.2.m2.1d">italic_λ</annotation></semantics></math> in our loss function. The results on Foursquare are shown in Figure <a href="#S5.F4" title="Figure 4 ‣ 5.6 Parameter Study ‣ 5 Experiments ‣ Mutual Distillation Learning Network for Trajectory-User Linking" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>.
As we can see, the performance first increases and then decreases, as <math id="S5.SS6.p1.3.m3.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S5.SS6.p1.3.m3.1a"><mi id="S5.SS6.p1.3.m3.1.1" xref="S5.SS6.p1.3.m3.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S5.SS6.p1.3.m3.1b"><ci id="S5.SS6.p1.3.m3.1.1.cmml" xref="S5.SS6.p1.3.m3.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p1.3.m3.1c">T</annotation><annotation encoding="application/x-llamapun" id="S5.SS6.p1.3.m3.1d">italic_T</annotation></semantics></math> increases. This is intuitive because lower temperature the distribution more sharp, and higher temperature makes the distribution unable to extract effective information.
The same observation is also presented on hyperparameter <math id="S5.SS6.p1.4.m4.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S5.SS6.p1.4.m4.1a"><mi id="S5.SS6.p1.4.m4.1.1" xref="S5.SS6.p1.4.m4.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S5.SS6.p1.4.m4.1b"><ci id="S5.SS6.p1.4.m4.1.1.cmml" xref="S5.SS6.p1.4.m4.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p1.4.m4.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S5.SS6.p1.4.m4.1d">italic_λ</annotation></semantics></math>.
In addition, it is clear that the performance increases rapidly with <math id="S5.SS6.p1.5.m5.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S5.SS6.p1.5.m5.1a"><mi id="S5.SS6.p1.5.m5.1.1" xref="S5.SS6.p1.5.m5.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S5.SS6.p1.5.m5.1b"><ci id="S5.SS6.p1.5.m5.1.1.cmml" xref="S5.SS6.p1.5.m5.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p1.5.m5.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S5.SS6.p1.5.m5.1d">italic_λ</annotation></semantics></math> increasing from 0.1. This suggests our proposed knowledge distillation module contributes a lot to the overall performance.</p>
</div>
<figure id="S5.F4" class="ltx_figure"><img src="/html/2205.03773/assets/x4.png" id="S5.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="747" height="301" alt="Parameter sensitivity ">
<br class="ltx_break ltx_centering">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Parameter sensitivity <span id="S5.F4.8.1" class="ltx_text ltx_font_italic">w</span>.<span id="S5.F4.9.2" class="ltx_text ltx_font_italic">r</span>.<span id="S5.F4.10.3" class="ltx_text ltx_font_italic">t</span>. <math id="S5.F4.3.m1.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S5.F4.3.m1.1b"><mi id="S5.F4.3.m1.1.1" xref="S5.F4.3.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S5.F4.3.m1.1c"><ci id="S5.F4.3.m1.1.1.cmml" xref="S5.F4.3.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F4.3.m1.1d">T</annotation><annotation encoding="application/x-llamapun" id="S5.F4.3.m1.1e">italic_T</annotation></semantics></math> and <math id="S5.F4.4.m2.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S5.F4.4.m2.1b"><mi id="S5.F4.4.m2.1.1" xref="S5.F4.4.m2.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S5.F4.4.m2.1c"><ci id="S5.F4.4.m2.1.1.cmml" xref="S5.F4.4.m2.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F4.4.m2.1d">\lambda</annotation><annotation encoding="application/x-llamapun" id="S5.F4.4.m2.1e">italic_λ</annotation></semantics></math> on Foursquare.</figcaption>
</figure>
</section>
<section id="S5.SS7" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.7 </span>Strategy Study</h3>

<figure id="S5.T4" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span>Effect of trajectory encoder selection. R-based: RNN-based, T-based: Transformer-based.</figcaption>
<table id="S5.T4.4" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T4.4.5.1" class="ltx_tr">
<th id="S5.T4.4.5.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" style="padding-left:3.1pt;padding-right:3.1pt;" colspan="4">Train</th>
<th id="S5.T4.4.5.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" style="padding-left:3.1pt;padding-right:3.1pt;" colspan="2">Test</th>
<th id="S5.T4.4.5.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt" style="padding-left:3.1pt;padding-right:3.1pt;" rowspan="3"><span id="S5.T4.4.5.1.3.1" class="ltx_text">Acc@1</span></th>
<th id="S5.T4.4.5.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:3.1pt;padding-right:3.1pt;" rowspan="3"><span id="S5.T4.4.5.1.4.1" class="ltx_text">Mac-F1</span></th>
</tr>
<tr id="S5.T4.4.4" class="ltx_tr">
<th id="S5.T4.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" style="padding-left:3.1pt;padding-right:3.1pt;" colspan="2">
<math id="S5.T4.1.1.1.m1.1" class="ltx_Math" alttext="f_{\theta}" display="inline"><semantics id="S5.T4.1.1.1.m1.1a"><msub id="S5.T4.1.1.1.m1.1.1" xref="S5.T4.1.1.1.m1.1.1.cmml"><mi id="S5.T4.1.1.1.m1.1.1.2" xref="S5.T4.1.1.1.m1.1.1.2.cmml">f</mi><mi id="S5.T4.1.1.1.m1.1.1.3" xref="S5.T4.1.1.1.m1.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S5.T4.1.1.1.m1.1b"><apply id="S5.T4.1.1.1.m1.1.1.cmml" xref="S5.T4.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.T4.1.1.1.m1.1.1.1.cmml" xref="S5.T4.1.1.1.m1.1.1">subscript</csymbol><ci id="S5.T4.1.1.1.m1.1.1.2.cmml" xref="S5.T4.1.1.1.m1.1.1.2">𝑓</ci><ci id="S5.T4.1.1.1.m1.1.1.3.cmml" xref="S5.T4.1.1.1.m1.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.1.1.1.m1.1c">f_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S5.T4.1.1.1.m1.1d">italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math></th>
<th id="S5.T4.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" style="padding-left:3.1pt;padding-right:3.1pt;" colspan="2">
<math id="S5.T4.2.2.2.m1.1" class="ltx_Math" alttext="f_{\phi}" display="inline"><semantics id="S5.T4.2.2.2.m1.1a"><msub id="S5.T4.2.2.2.m1.1.1" xref="S5.T4.2.2.2.m1.1.1.cmml"><mi id="S5.T4.2.2.2.m1.1.1.2" xref="S5.T4.2.2.2.m1.1.1.2.cmml">f</mi><mi id="S5.T4.2.2.2.m1.1.1.3" xref="S5.T4.2.2.2.m1.1.1.3.cmml">ϕ</mi></msub><annotation-xml encoding="MathML-Content" id="S5.T4.2.2.2.m1.1b"><apply id="S5.T4.2.2.2.m1.1.1.cmml" xref="S5.T4.2.2.2.m1.1.1"><csymbol cd="ambiguous" id="S5.T4.2.2.2.m1.1.1.1.cmml" xref="S5.T4.2.2.2.m1.1.1">subscript</csymbol><ci id="S5.T4.2.2.2.m1.1.1.2.cmml" xref="S5.T4.2.2.2.m1.1.1.2">𝑓</ci><ci id="S5.T4.2.2.2.m1.1.1.3.cmml" xref="S5.T4.2.2.2.m1.1.1.3">italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.2.2.2.m1.1c">f_{\phi}</annotation><annotation encoding="application/x-llamapun" id="S5.T4.2.2.2.m1.1d">italic_f start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT</annotation></semantics></math></th>
<th id="S5.T4.3.3.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_t" style="padding-left:3.1pt;padding-right:3.1pt;" rowspan="2"><span id="S5.T4.3.3.3.1" class="ltx_text"><math id="S5.T4.3.3.3.1.m1.1" class="ltx_Math" alttext="f_{\theta}" display="inline"><semantics id="S5.T4.3.3.3.1.m1.1a"><msub id="S5.T4.3.3.3.1.m1.1.1" xref="S5.T4.3.3.3.1.m1.1.1.cmml"><mi id="S5.T4.3.3.3.1.m1.1.1.2" xref="S5.T4.3.3.3.1.m1.1.1.2.cmml">f</mi><mi id="S5.T4.3.3.3.1.m1.1.1.3" xref="S5.T4.3.3.3.1.m1.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S5.T4.3.3.3.1.m1.1b"><apply id="S5.T4.3.3.3.1.m1.1.1.cmml" xref="S5.T4.3.3.3.1.m1.1.1"><csymbol cd="ambiguous" id="S5.T4.3.3.3.1.m1.1.1.1.cmml" xref="S5.T4.3.3.3.1.m1.1.1">subscript</csymbol><ci id="S5.T4.3.3.3.1.m1.1.1.2.cmml" xref="S5.T4.3.3.3.1.m1.1.1.2">𝑓</ci><ci id="S5.T4.3.3.3.1.m1.1.1.3.cmml" xref="S5.T4.3.3.3.1.m1.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.3.3.3.1.m1.1c">f_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S5.T4.3.3.3.1.m1.1d">italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math></span></th>
<th id="S5.T4.4.4.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" style="padding-left:3.1pt;padding-right:3.1pt;" rowspan="2"><span id="S5.T4.4.4.4.1" class="ltx_text"><math id="S5.T4.4.4.4.1.m1.1" class="ltx_Math" alttext="f_{\phi}" display="inline"><semantics id="S5.T4.4.4.4.1.m1.1a"><msub id="S5.T4.4.4.4.1.m1.1.1" xref="S5.T4.4.4.4.1.m1.1.1.cmml"><mi id="S5.T4.4.4.4.1.m1.1.1.2" xref="S5.T4.4.4.4.1.m1.1.1.2.cmml">f</mi><mi id="S5.T4.4.4.4.1.m1.1.1.3" xref="S5.T4.4.4.4.1.m1.1.1.3.cmml">ϕ</mi></msub><annotation-xml encoding="MathML-Content" id="S5.T4.4.4.4.1.m1.1b"><apply id="S5.T4.4.4.4.1.m1.1.1.cmml" xref="S5.T4.4.4.4.1.m1.1.1"><csymbol cd="ambiguous" id="S5.T4.4.4.4.1.m1.1.1.1.cmml" xref="S5.T4.4.4.4.1.m1.1.1">subscript</csymbol><ci id="S5.T4.4.4.4.1.m1.1.1.2.cmml" xref="S5.T4.4.4.4.1.m1.1.1.2">𝑓</ci><ci id="S5.T4.4.4.4.1.m1.1.1.3.cmml" xref="S5.T4.4.4.4.1.m1.1.1.3">italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.4.4.4.1.m1.1c">f_{\phi}</annotation><annotation encoding="application/x-llamapun" id="S5.T4.4.4.4.1.m1.1d">italic_f start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT</annotation></semantics></math></span></th>
</tr>
<tr id="S5.T4.4.6.2" class="ltx_tr">
<th id="S5.T4.4.6.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_t" style="padding-left:3.1pt;padding-right:3.1pt;">R-based</th>
<th id="S5.T4.4.6.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" style="padding-left:3.1pt;padding-right:3.1pt;">T-based</th>
<th id="S5.T4.4.6.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_t" style="padding-left:3.1pt;padding-right:3.1pt;">R-based</th>
<th id="S5.T4.4.6.2.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" style="padding-left:3.1pt;padding-right:3.1pt;">T-based</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T4.4.7.1" class="ltx_tr">
<th id="S5.T4.4.7.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" style="padding-left:3.1pt;padding-right:3.1pt;">✓</th>
<td id="S5.T4.4.7.1.2" class="ltx_td ltx_border_r ltx_border_t" style="padding-left:3.1pt;padding-right:3.1pt;"></td>
<th id="S5.T4.4.7.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" style="padding-left:3.1pt;padding-right:3.1pt;">✓</th>
<td id="S5.T4.4.7.1.4" class="ltx_td ltx_border_r ltx_border_t" style="padding-left:3.1pt;padding-right:3.1pt;"></td>
<th id="S5.T4.4.7.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" style="padding-left:3.1pt;padding-right:3.1pt;">✓</th>
<td id="S5.T4.4.7.1.6" class="ltx_td ltx_border_r ltx_border_t" style="padding-left:3.1pt;padding-right:3.1pt;"></td>
<th id="S5.T4.4.7.1.7" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" style="padding-left:3.1pt;padding-right:3.1pt;">56.47%</th>
<td id="S5.T4.4.7.1.8" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:3.1pt;padding-right:3.1pt;">55.03%</td>
</tr>
<tr id="S5.T4.4.8.2" class="ltx_tr">
<th id="S5.T4.4.8.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row" style="padding-left:3.1pt;padding-right:3.1pt;">✓</th>
<td id="S5.T4.4.8.2.2" class="ltx_td ltx_border_r" style="padding-left:3.1pt;padding-right:3.1pt;"></td>
<th id="S5.T4.4.8.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_row" style="padding-left:3.1pt;padding-right:3.1pt;">✓</th>
<td id="S5.T4.4.8.2.4" class="ltx_td ltx_border_r" style="padding-left:3.1pt;padding-right:3.1pt;"></td>
<th id="S5.T4.4.8.2.5" class="ltx_td ltx_th ltx_th_row" style="padding-left:3.1pt;padding-right:3.1pt;"></th>
<td id="S5.T4.4.8.2.6" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:3.1pt;padding-right:3.1pt;">✓</td>
<th id="S5.T4.4.8.2.7" class="ltx_td ltx_align_center ltx_th ltx_th_row" style="padding-left:3.1pt;padding-right:3.1pt;">56.55%</th>
<td id="S5.T4.4.8.2.8" class="ltx_td ltx_align_center" style="padding-left:3.1pt;padding-right:3.1pt;">55.23%</td>
</tr>
<tr id="S5.T4.4.9.3" class="ltx_tr" style="background-color:#CCCCCC;">
<th id="S5.T4.4.9.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row" style="padding-left:3.1pt;padding-right:3.1pt;"><span id="S5.T4.4.9.3.1.1" class="ltx_text" style="background-color:#CCCCCC;">✓</span></th>
<td id="S5.T4.4.9.3.2" class="ltx_td ltx_border_r" style="padding-left:3.1pt;padding-right:3.1pt;"></td>
<th id="S5.T4.4.9.3.3" class="ltx_td ltx_th ltx_th_row" style="padding-left:3.1pt;padding-right:3.1pt;"></th>
<td id="S5.T4.4.9.3.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:3.1pt;padding-right:3.1pt;"><span id="S5.T4.4.9.3.4.1" class="ltx_text" style="background-color:#CCCCCC;">✓</span></td>
<th id="S5.T4.4.9.3.5" class="ltx_td ltx_align_center ltx_th ltx_th_row" style="padding-left:3.1pt;padding-right:3.1pt;"><span id="S5.T4.4.9.3.5.1" class="ltx_text" style="background-color:#CCCCCC;">✓</span></th>
<td id="S5.T4.4.9.3.6" class="ltx_td ltx_border_r" style="padding-left:3.1pt;padding-right:3.1pt;"></td>
<th id="S5.T4.4.9.3.7" class="ltx_td ltx_align_center ltx_th ltx_th_row" style="padding-left:3.1pt;padding-right:3.1pt;"><span id="S5.T4.4.9.3.7.1" class="ltx_text" style="background-color:#CCCCCC;">60.58%</span></th>
<td id="S5.T4.4.9.3.8" class="ltx_td ltx_align_center" style="padding-left:3.1pt;padding-right:3.1pt;"><span id="S5.T4.4.9.3.8.1" class="ltx_text" style="background-color:#CCCCCC;">59.12%</span></td>
</tr>
<tr id="S5.T4.4.10.4" class="ltx_tr" style="background-color:#ECECEC;">
<th id="S5.T4.4.10.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row" style="padding-left:3.1pt;padding-right:3.1pt;"><span id="S5.T4.4.10.4.1.1" class="ltx_text" style="background-color:#ECECEC;">✓</span></th>
<td id="S5.T4.4.10.4.2" class="ltx_td ltx_border_r" style="padding-left:3.1pt;padding-right:3.1pt;"></td>
<th id="S5.T4.4.10.4.3" class="ltx_td ltx_th ltx_th_row" style="padding-left:3.1pt;padding-right:3.1pt;"></th>
<td id="S5.T4.4.10.4.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:3.1pt;padding-right:3.1pt;"><span id="S5.T4.4.10.4.4.1" class="ltx_text" style="background-color:#ECECEC;">✓</span></td>
<th id="S5.T4.4.10.4.5" class="ltx_td ltx_th ltx_th_row" style="padding-left:3.1pt;padding-right:3.1pt;"></th>
<td id="S5.T4.4.10.4.6" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:3.1pt;padding-right:3.1pt;"><span id="S5.T4.4.10.4.6.1" class="ltx_text" style="background-color:#ECECEC;">✓</span></td>
<th id="S5.T4.4.10.4.7" class="ltx_td ltx_align_center ltx_th ltx_th_row" style="padding-left:3.1pt;padding-right:3.1pt;"><span id="S5.T4.4.10.4.7.1" class="ltx_text" style="background-color:#ECECEC;">57.87%</span></th>
<td id="S5.T4.4.10.4.8" class="ltx_td ltx_align_center" style="padding-left:3.1pt;padding-right:3.1pt;"><span id="S5.T4.4.10.4.8.1" class="ltx_text" style="background-color:#ECECEC;">55.83%</span></td>
</tr>
<tr id="S5.T4.4.11.5" class="ltx_tr">
<th id="S5.T4.4.11.5.1" class="ltx_td ltx_th ltx_th_row" style="padding-left:3.1pt;padding-right:3.1pt;"></th>
<td id="S5.T4.4.11.5.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:3.1pt;padding-right:3.1pt;">✓</td>
<th id="S5.T4.4.11.5.3" class="ltx_td ltx_align_center ltx_th ltx_th_row" style="padding-left:3.1pt;padding-right:3.1pt;">✓</th>
<td id="S5.T4.4.11.5.4" class="ltx_td ltx_border_r" style="padding-left:3.1pt;padding-right:3.1pt;"></td>
<th id="S5.T4.4.11.5.5" class="ltx_td ltx_align_center ltx_th ltx_th_row" style="padding-left:3.1pt;padding-right:3.1pt;">✓</th>
<td id="S5.T4.4.11.5.6" class="ltx_td ltx_border_r" style="padding-left:3.1pt;padding-right:3.1pt;"></td>
<th id="S5.T4.4.11.5.7" class="ltx_td ltx_align_center ltx_th ltx_th_row" style="padding-left:3.1pt;padding-right:3.1pt;">57.60%</th>
<td id="S5.T4.4.11.5.8" class="ltx_td ltx_align_center" style="padding-left:3.1pt;padding-right:3.1pt;">55.75%</td>
</tr>
<tr id="S5.T4.4.12.6" class="ltx_tr">
<th id="S5.T4.4.12.6.1" class="ltx_td ltx_th ltx_th_row" style="padding-left:3.1pt;padding-right:3.1pt;"></th>
<td id="S5.T4.4.12.6.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:3.1pt;padding-right:3.1pt;">✓</td>
<th id="S5.T4.4.12.6.3" class="ltx_td ltx_align_center ltx_th ltx_th_row" style="padding-left:3.1pt;padding-right:3.1pt;">✓</th>
<td id="S5.T4.4.12.6.4" class="ltx_td ltx_border_r" style="padding-left:3.1pt;padding-right:3.1pt;"></td>
<th id="S5.T4.4.12.6.5" class="ltx_td ltx_th ltx_th_row" style="padding-left:3.1pt;padding-right:3.1pt;"></th>
<td id="S5.T4.4.12.6.6" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:3.1pt;padding-right:3.1pt;">✓</td>
<th id="S5.T4.4.12.6.7" class="ltx_td ltx_align_center ltx_th ltx_th_row" style="padding-left:3.1pt;padding-right:3.1pt;">59.39%</th>
<td id="S5.T4.4.12.6.8" class="ltx_td ltx_align_center" style="padding-left:3.1pt;padding-right:3.1pt;">58.22%</td>
</tr>
<tr id="S5.T4.4.13.7" class="ltx_tr">
<th id="S5.T4.4.13.7.1" class="ltx_td ltx_th ltx_th_row" style="padding-left:3.1pt;padding-right:3.1pt;"></th>
<td id="S5.T4.4.13.7.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:3.1pt;padding-right:3.1pt;">✓</td>
<th id="S5.T4.4.13.7.3" class="ltx_td ltx_th ltx_th_row" style="padding-left:3.1pt;padding-right:3.1pt;"></th>
<td id="S5.T4.4.13.7.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:3.1pt;padding-right:3.1pt;">✓</td>
<th id="S5.T4.4.13.7.5" class="ltx_td ltx_align_center ltx_th ltx_th_row" style="padding-left:3.1pt;padding-right:3.1pt;">✓</th>
<td id="S5.T4.4.13.7.6" class="ltx_td ltx_border_r" style="padding-left:3.1pt;padding-right:3.1pt;"></td>
<th id="S5.T4.4.13.7.7" class="ltx_td ltx_align_center ltx_th ltx_th_row" style="padding-left:3.1pt;padding-right:3.1pt;">53.80%</th>
<td id="S5.T4.4.13.7.8" class="ltx_td ltx_align_center" style="padding-left:3.1pt;padding-right:3.1pt;">53.56%</td>
</tr>
<tr id="S5.T4.4.14.8" class="ltx_tr">
<th id="S5.T4.4.14.8.1" class="ltx_td ltx_th ltx_th_row ltx_border_bb" style="padding-left:3.1pt;padding-right:3.1pt;"></th>
<td id="S5.T4.4.14.8.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="padding-left:3.1pt;padding-right:3.1pt;">✓</td>
<th id="S5.T4.4.14.8.3" class="ltx_td ltx_th ltx_th_row ltx_border_bb" style="padding-left:3.1pt;padding-right:3.1pt;"></th>
<td id="S5.T4.4.14.8.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="padding-left:3.1pt;padding-right:3.1pt;">✓</td>
<th id="S5.T4.4.14.8.5" class="ltx_td ltx_th ltx_th_row ltx_border_bb" style="padding-left:3.1pt;padding-right:3.1pt;"></th>
<td id="S5.T4.4.14.8.6" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="padding-left:3.1pt;padding-right:3.1pt;">✓</td>
<th id="S5.T4.4.14.8.7" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb" style="padding-left:3.1pt;padding-right:3.1pt;">53.80%</th>
<td id="S5.T4.4.14.8.8" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:3.1pt;padding-right:3.1pt;">53.94%</td>
</tr>
</tbody>
</table>
</figure>
<section id="S5.SS7.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.7.1 </span>Effect of Trajectory Encoder Selection</h4>

<div id="S5.SS7.SSS1.p1" class="ltx_para">
<p id="S5.SS7.SSS1.p1.3" class="ltx_p">We also evaluated the combination selection of different types of trajectory encoders. The results on Foursquare are shown in Table <a href="#S5.T4" title="Table 4 ‣ 5.7 Strategy Study ‣ 5 Experiments ‣ Mutual Distillation Learning Network for Trajectory-User Linking" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>.
We can conclude that when using the same type of trajectory encoders at the same time, the model performance is poor, which validates the rationality of our design of two different types of trajectory encoders.
In the case of using two different encoders (<span id="S5.SS7.SSS1.p1.3.1" class="ltx_text ltx_font_italic">i</span>.<span id="S5.SS7.SSS1.p1.3.2" class="ltx_text ltx_font_italic">e</span>., <math id="S5.SS7.SSS1.p1.1.m1.1" class="ltx_Math" alttext="f_{\theta}" display="inline"><semantics id="S5.SS7.SSS1.p1.1.m1.1a"><msub id="S5.SS7.SSS1.p1.1.m1.1.1" xref="S5.SS7.SSS1.p1.1.m1.1.1.cmml"><mi id="S5.SS7.SSS1.p1.1.m1.1.1.2" xref="S5.SS7.SSS1.p1.1.m1.1.1.2.cmml">f</mi><mi id="S5.SS7.SSS1.p1.1.m1.1.1.3" xref="S5.SS7.SSS1.p1.1.m1.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS7.SSS1.p1.1.m1.1b"><apply id="S5.SS7.SSS1.p1.1.m1.1.1.cmml" xref="S5.SS7.SSS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS7.SSS1.p1.1.m1.1.1.1.cmml" xref="S5.SS7.SSS1.p1.1.m1.1.1">subscript</csymbol><ci id="S5.SS7.SSS1.p1.1.m1.1.1.2.cmml" xref="S5.SS7.SSS1.p1.1.m1.1.1.2">𝑓</ci><ci id="S5.SS7.SSS1.p1.1.m1.1.1.3.cmml" xref="S5.SS7.SSS1.p1.1.m1.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS7.SSS1.p1.1.m1.1c">f_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S5.SS7.SSS1.p1.1.m1.1d">italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> uses RNN encoder and <math id="S5.SS7.SSS1.p1.2.m2.1" class="ltx_Math" alttext="f_{\phi}" display="inline"><semantics id="S5.SS7.SSS1.p1.2.m2.1a"><msub id="S5.SS7.SSS1.p1.2.m2.1.1" xref="S5.SS7.SSS1.p1.2.m2.1.1.cmml"><mi id="S5.SS7.SSS1.p1.2.m2.1.1.2" xref="S5.SS7.SSS1.p1.2.m2.1.1.2.cmml">f</mi><mi id="S5.SS7.SSS1.p1.2.m2.1.1.3" xref="S5.SS7.SSS1.p1.2.m2.1.1.3.cmml">ϕ</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS7.SSS1.p1.2.m2.1b"><apply id="S5.SS7.SSS1.p1.2.m2.1.1.cmml" xref="S5.SS7.SSS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S5.SS7.SSS1.p1.2.m2.1.1.1.cmml" xref="S5.SS7.SSS1.p1.2.m2.1.1">subscript</csymbol><ci id="S5.SS7.SSS1.p1.2.m2.1.1.2.cmml" xref="S5.SS7.SSS1.p1.2.m2.1.1.2">𝑓</ci><ci id="S5.SS7.SSS1.p1.2.m2.1.1.3.cmml" xref="S5.SS7.SSS1.p1.2.m2.1.1.3">italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS7.SSS1.p1.2.m2.1c">f_{\phi}</annotation><annotation encoding="application/x-llamapun" id="S5.SS7.SSS1.p1.2.m2.1d">italic_f start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT</annotation></semantics></math> adopts transformer encoder), using encoder <math id="S5.SS7.SSS1.p1.3.m3.1" class="ltx_Math" alttext="f_{\theta}" display="inline"><semantics id="S5.SS7.SSS1.p1.3.m3.1a"><msub id="S5.SS7.SSS1.p1.3.m3.1.1" xref="S5.SS7.SSS1.p1.3.m3.1.1.cmml"><mi id="S5.SS7.SSS1.p1.3.m3.1.1.2" xref="S5.SS7.SSS1.p1.3.m3.1.1.2.cmml">f</mi><mi id="S5.SS7.SSS1.p1.3.m3.1.1.3" xref="S5.SS7.SSS1.p1.3.m3.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS7.SSS1.p1.3.m3.1b"><apply id="S5.SS7.SSS1.p1.3.m3.1.1.cmml" xref="S5.SS7.SSS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S5.SS7.SSS1.p1.3.m3.1.1.1.cmml" xref="S5.SS7.SSS1.p1.3.m3.1.1">subscript</csymbol><ci id="S5.SS7.SSS1.p1.3.m3.1.1.2.cmml" xref="S5.SS7.SSS1.p1.3.m3.1.1.2">𝑓</ci><ci id="S5.SS7.SSS1.p1.3.m3.1.1.3.cmml" xref="S5.SS7.SSS1.p1.3.m3.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS7.SSS1.p1.3.m3.1c">f_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S5.SS7.SSS1.p1.3.m3.1d">italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> for testing can achieve the best performance, which also shows that the simple encoder is more suitable for capturing the movement patterns of sparse sub-trajectories.</p>
</div>
</section>
<section id="S5.SS7.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.7.2 </span>Effect of Augmentation Strategy</h4>

<div id="S5.SS7.SSS2.p1" class="ltx_para">
<p id="S5.SS7.SSS2.p1.1" class="ltx_p">Finally, we evaluate the proposed two trajectory augmentation strategies.
Based on the results on Foursquare in Table <a href="#S5.T5" title="Table 5 ‣ 5.7.2 Effect of Augmentation Strategy ‣ 5.7 Strategy Study ‣ 5 Experiments ‣ Mutual Distillation Learning Network for Trajectory-User Linking" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>, we have two observations: (1) Both data augmentation strategies help improve model performance.
(2) The random augmentation is better than the neighbor augmentation. The reason is that the random strategy may obtain the potential movement patterns of users by combining users’ past travels randomly, resulting in better results.
</p>
</div>
<figure id="S5.T5" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 5: </span>Effect of augmentation strategy in Macro-F1.</figcaption>
<table id="S5.T5.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T5.1.1" class="ltx_tr">
<th id="S5.T5.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" style="padding-left:3.4pt;padding-right:3.4pt;"><math id="S5.T5.1.1.1.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S5.T5.1.1.1.m1.1a"><mi id="S5.T5.1.1.1.m1.1.1" xref="S5.T5.1.1.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S5.T5.1.1.1.m1.1b"><ci id="S5.T5.1.1.1.m1.1.1.cmml" xref="S5.T5.1.1.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T5.1.1.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="S5.T5.1.1.1.m1.1d">italic_k</annotation></semantics></math></th>
<th id="S5.T5.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" style="padding-left:3.4pt;padding-right:3.4pt;">0</th>
<th id="S5.T5.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" style="padding-left:3.4pt;padding-right:3.4pt;">2</th>
<th id="S5.T5.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" style="padding-left:3.4pt;padding-right:3.4pt;">4</th>
<th id="S5.T5.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" style="padding-left:3.4pt;padding-right:3.4pt;">8</th>
<th id="S5.T5.1.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:3.4pt;padding-right:3.4pt;">16</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T5.1.2.1" class="ltx_tr">
<td id="S5.T5.1.2.1.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:3.4pt;padding-right:3.4pt;">Neighbor</td>
<td id="S5.T5.1.2.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:3.4pt;padding-right:3.4pt;">51.09%</td>
<td id="S5.T5.1.2.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:3.4pt;padding-right:3.4pt;">53.78%</td>
<td id="S5.T5.1.2.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:3.4pt;padding-right:3.4pt;">54.01%</td>
<td id="S5.T5.1.2.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:3.4pt;padding-right:3.4pt;">53.49%</td>
<td id="S5.T5.1.2.1.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:3.4pt;padding-right:3.4pt;">53.51%</td>
</tr>
<tr id="S5.T5.1.3.2" class="ltx_tr" style="background-color:#D9D9D9;">
<td id="S5.T5.1.3.2.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="padding-left:3.4pt;padding-right:3.4pt;"><span id="S5.T5.1.3.2.1.1" class="ltx_text" style="background-color:#D9D9D9;">Random</span></td>
<td id="S5.T5.1.3.2.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="padding-left:3.4pt;padding-right:3.4pt;"><span id="S5.T5.1.3.2.2.1" class="ltx_text" style="background-color:#D9D9D9;">51.09%</span></td>
<td id="S5.T5.1.3.2.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="padding-left:3.4pt;padding-right:3.4pt;"><span id="S5.T5.1.3.2.3.1" class="ltx_text" style="background-color:#D9D9D9;">54.25%</span></td>
<td id="S5.T5.1.3.2.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="padding-left:3.4pt;padding-right:3.4pt;"><span id="S5.T5.1.3.2.4.1" class="ltx_text" style="background-color:#D9D9D9;">59.14%</span></td>
<td id="S5.T5.1.3.2.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="padding-left:3.4pt;padding-right:3.4pt;"><span id="S5.T5.1.3.2.5.1" class="ltx_text" style="background-color:#D9D9D9;">59.12%</span></td>
<td id="S5.T5.1.3.2.6" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:3.4pt;padding-right:3.4pt;"><span id="S5.T5.1.3.2.6.1" class="ltx_text" style="background-color:#D9D9D9;">59.00%</span></td>
</tr>
</tbody>
</table>
</figure>
</section>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusion</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">In this paper, we propose a novel mutual distillation learning network (MainTUL) to solve TUL problem for sparse check-in mobility data.
MainTUL effectively learns user movement patterns for input trajectory by the designed mutual distillation network consisting of two different trajectory encoders with multi-semantic check-in embeddings.
Experiments on two real-world check-in mobility datasets demonstrate that MainTUL significantly outperforms state-of-the-art baselines in terms of all evaluation metrics for TUL prediction.</p>
</div>
</section>
<section id="Sx1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Acknowledgments</h2>

<div id="Sx1.p1" class="ltx_para">
<p id="Sx1.p1.1" class="ltx_p">This work is partially supported by the National Natural Science Foundation of China under grant Nos. 62176243, 61773331 and 41927805, the National Program on Key Research Project under grant No. 2019YFC1509100, and the National Key Research and Development Program of China under grant No. 2018AAA0100602.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dai <span id="bib.bib1.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2021]</span>
<span class="ltx_bibblock">
Shaojie Dai, Jinshuai Wang, Chao Huang, Yanwei Yu, and Junyu Dong.

</span>
<span class="ltx_bibblock">Temporal multi-view graph convolutional networks for citywide traffic
volume inference.

</span>
<span class="ltx_bibblock">In <span id="bib.bib1.3.1" class="ltx_text ltx_font_italic">ICDM</span>, pages 1042–1047. IEEE, 2021.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gao <span id="bib.bib2.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2017]</span>
<span class="ltx_bibblock">
Qiang Gao, Fan Zhou, Kunpeng Zhang, Goce Trajcevski, et al.

</span>
<span class="ltx_bibblock">Identifying human mobility via trajectory embeddings.

</span>
<span class="ltx_bibblock">In <span id="bib.bib2.3.1" class="ltx_text ltx_font_italic">IJCAI</span>, volume 17, pages 1689–1695, 2017.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gao <span id="bib.bib3.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2020]</span>
<span class="ltx_bibblock">
Qiang Gao, Fengli Zhang, Fuming Yao, Ailing Li, et al.

</span>
<span class="ltx_bibblock">Adversarial mobility learning for human trajectory classification.

</span>
<span class="ltx_bibblock"><span id="bib.bib3.3.1" class="ltx_text ltx_font_italic">IEEE Access</span>, 8:20563–20576, 2020.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hao <span id="bib.bib4.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2020]</span>
<span class="ltx_bibblock">
Qianyue Hao, Lin Chen, Fengli Xu, and Yong Li.

</span>
<span class="ltx_bibblock">Understanding the urban pandemic spreading of covid-19 with real
world mobility data.

</span>
<span class="ltx_bibblock">In <span id="bib.bib4.3.1" class="ltx_text ltx_font_italic">KDD</span>, pages 3485–3492, 2020.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hinton <span id="bib.bib5.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2015]</span>
<span class="ltx_bibblock">
Geoffrey Hinton, Oriol Vinyals, and Jeff Dean.

</span>
<span class="ltx_bibblock">Distilling the knowledge in a neural network.

</span>
<span class="ltx_bibblock"><span id="bib.bib5.3.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1503.02531</span>, 2015.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hochreiter and
Schmidhuber [1997]</span>
<span class="ltx_bibblock">
Sepp Hochreiter and Jürgen Schmidhuber.

</span>
<span class="ltx_bibblock">Long short-term memory.

</span>
<span class="ltx_bibblock"><span id="bib.bib6.1.1" class="ltx_text ltx_font_italic">Neural computation</span>, 9(8):1735–1780, 1997.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Huang <span id="bib.bib7.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2018]</span>
<span class="ltx_bibblock">
Chao Huang, Junbo Zhang, Yu Zheng, and Nitesh V Chawla.

</span>
<span class="ltx_bibblock">Deepcrime: Attentive hierarchical recurrent networks for crime
prediction.

</span>
<span class="ltx_bibblock">In <span id="bib.bib7.3.1" class="ltx_text ltx_font_italic">CIKM</span>, pages 1423–1432, 2018.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Huang <span id="bib.bib8.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2019]</span>
<span class="ltx_bibblock">
Chao Huang, Chuxu Zhang, Jiashu Zhao, et al.

</span>
<span class="ltx_bibblock">Mist: A multiview and multimodal spatial-temporal learning framework
for citywide abnormal event forecasting.

</span>
<span class="ltx_bibblock">In <span id="bib.bib8.3.1" class="ltx_text ltx_font_italic">WWW</span>, 2019.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jiang [2018]</span>
<span class="ltx_bibblock">
Zhe Jiang.

</span>
<span class="ltx_bibblock">A survey on spatial prediction methods.

</span>
<span class="ltx_bibblock"><span id="bib.bib9.1.1" class="ltx_text ltx_font_italic">TKDE</span>, 31(9):1645–1664, 2018.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jin <span id="bib.bib10.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2019]</span>
<span class="ltx_bibblock">
Fengmei Jin, Wen Hua, et al.

</span>
<span class="ltx_bibblock">Moving object linking based on historical trace.

</span>
<span class="ltx_bibblock">In <span id="bib.bib10.3.1" class="ltx_text ltx_font_italic">ICDE</span>, pages 1058–1069. IEEE, 2019.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jin <span id="bib.bib11.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2020]</span>
<span class="ltx_bibblock">
Fengmei Jin, Wen Hua, Thomas Zhou, et al.

</span>
<span class="ltx_bibblock">Trajectory-based spatiotemporal entity linking.

</span>
<span class="ltx_bibblock"><span id="bib.bib11.3.1" class="ltx_text ltx_font_italic">TKDE</span>, 2020.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Keogh and Pazzani [2000]</span>
<span class="ltx_bibblock">
Eamonn J Keogh and Michael J Pazzani.

</span>
<span class="ltx_bibblock">Scaling up dynamic time warping for datamining applications.

</span>
<span class="ltx_bibblock">In <span id="bib.bib12.1.1" class="ltx_text ltx_font_italic">KDD</span>, pages 285–289, 2000.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li <span id="bib.bib13.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2018]</span>
<span class="ltx_bibblock">
Xiucheng Li, Kaiqi Zhao, Gao Cong, Christian S Jensen, and Wei Wei.

</span>
<span class="ltx_bibblock">Deep representation learning for trajectory similarity computation.

</span>
<span class="ltx_bibblock">In <span id="bib.bib13.3.1" class="ltx_text ltx_font_italic">ICDE</span>, pages 617–628. IEEE, 2018.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lian <span id="bib.bib14.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2014]</span>
<span class="ltx_bibblock">
Defu Lian, Yin Zhu, Xing Xie, and Enhong Chen.

</span>
<span class="ltx_bibblock">Analyzing location predictability on location-based social networks.

</span>
<span class="ltx_bibblock">In <span id="bib.bib14.3.1" class="ltx_text ltx_font_italic">PAKDD</span>, pages 102–113. Springer, 2014.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lian <span id="bib.bib15.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2020]</span>
<span class="ltx_bibblock">
Defu Lian, Yongji Wu, Yong Ge, Xing Xie, and Enhong Chen.

</span>
<span class="ltx_bibblock">Geography-aware sequential location recommendation.

</span>
<span class="ltx_bibblock">In <span id="bib.bib15.3.1" class="ltx_text ltx_font_italic">KDD</span>, pages 2009–2019, 2020.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin <span id="bib.bib16.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2020]</span>
<span class="ltx_bibblock">
Yan Lin, Huaiyu Wan, et al.

</span>
<span class="ltx_bibblock">Pre-training context and time aware location embeddings from
spatial-temporal trajectories for user next location prediction.

</span>
<span class="ltx_bibblock">In <span id="bib.bib16.3.1" class="ltx_text ltx_font_italic">AAAI</span>, 2020.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu <span id="bib.bib17.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2014]</span>
<span class="ltx_bibblock">
Yong Liu, Wei Wei, Aixin Sun, and Chunyan Miao.

</span>
<span class="ltx_bibblock">Exploiting geographical neighborhood characteristics for location
recommendation.

</span>
<span class="ltx_bibblock">In <span id="bib.bib17.3.1" class="ltx_text ltx_font_italic">CIKM</span>, pages 739–748, 2014.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu <span id="bib.bib18.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2019]</span>
<span class="ltx_bibblock">
Wei Liu, Zhi-Jie Wang, et al.

</span>
<span class="ltx_bibblock">Geo-alm: Poi recommendation by fusing geographical information and
adversarial learning mechanism.

</span>
<span class="ltx_bibblock">In <span id="bib.bib18.3.1" class="ltx_text ltx_font_italic">IJCAI</span>, pages 1807–1813, 2019.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Miao <span id="bib.bib19.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2020]</span>
<span class="ltx_bibblock">
Congcong Miao, Jilong Wang, Heng Yu, Weichen Zhang, and Yinyao Qi.

</span>
<span class="ltx_bibblock">Trajectory-user linking with attentive recurrent network.

</span>
<span class="ltx_bibblock">In <span id="bib.bib19.3.1" class="ltx_text ltx_font_italic">AAMAS</span>, pages 878–886, 2020.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ruffy and Chahal [2019]</span>
<span class="ltx_bibblock">
Fabian Ruffy and Karanbir Chahal.

</span>
<span class="ltx_bibblock">The state of knowledge distillation for classification.

</span>
<span class="ltx_bibblock"><span id="bib.bib20.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1912.10850</span>, 2019.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shahdoosti and
Mirzapour [2017]</span>
<span class="ltx_bibblock">
Hamid Reza Shahdoosti and Fardin Mirzapour.

</span>
<span class="ltx_bibblock">Spectral–spatial feature extraction using orthogonal linear
discriminant analysis for classification of hyperspectral data.

</span>
<span class="ltx_bibblock"><span id="bib.bib21.1.1" class="ltx_text ltx_font_italic">European Journal of Remote Sensing</span>, 50(1):111–124, 2017.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shang <span id="bib.bib22.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2017]</span>
<span class="ltx_bibblock">
Shuo Shang, Lisi Chen, Zhewei Wei, et al.

</span>
<span class="ltx_bibblock">Trajectory similarity join in spatial networks.

</span>
<span class="ltx_bibblock"><span id="bib.bib22.3.1" class="ltx_text ltx_font_italic">VLDB</span>, 10(11), 2017.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vaswani <span id="bib.bib23.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2017]</span>
<span class="ltx_bibblock">
Ashish Vaswani, Noam Shazeer, Niki Parmar, et al.

</span>
<span class="ltx_bibblock">Attention is all you need.

</span>
<span class="ltx_bibblock">In <span id="bib.bib23.3.1" class="ltx_text ltx_font_italic">NeurIPS</span>, pages 5998–6008, 2017.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu <span id="bib.bib24.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2020]</span>
<span class="ltx_bibblock">
Xian Wu, Chao Huang, Chuxu Zhang, and Nitesh V Chawla.

</span>
<span class="ltx_bibblock">Hierarchically structured transformer networks for fine-grained
spatial event forecasting.

</span>
<span class="ltx_bibblock">In <span id="bib.bib24.3.1" class="ltx_text ltx_font_italic">WWW</span>, pages 2320–2330, 2020.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang <span id="bib.bib25.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2015]</span>
<span class="ltx_bibblock">
Dingqi Yang, Daqing Zhang, et al.

</span>
<span class="ltx_bibblock">Modeling user activity preference by leveraging user spatial temporal
characteristics in lbsns.

</span>
<span class="ltx_bibblock"><span id="bib.bib25.3.1" class="ltx_text ltx_font_italic">Transactions On SMC</span>, 45(1):129–142, 2015.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang <span id="bib.bib26.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2019]</span>
<span class="ltx_bibblock">
Zhilin Yang, Zihang Dai, Yiming Yang, et al.

</span>
<span class="ltx_bibblock">Xlnet: Generalized autoregressive pretraining for language
understanding.

</span>
<span class="ltx_bibblock"><span id="bib.bib26.3.1" class="ltx_text ltx_font_italic">NeurIPS</span>, 32, 2019.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang <span id="bib.bib27.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2021]</span>
<span class="ltx_bibblock">
Peilun Yang, Hanchen Wang, Ying Zhang, et al.

</span>
<span class="ltx_bibblock">T3s: Effective representation learning for trajectory similarity
computation.

</span>
<span class="ltx_bibblock">In <span id="bib.bib27.3.1" class="ltx_text ltx_font_italic">ICDE</span>, pages 2183–2188. IEEE, 2021.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yao <span id="bib.bib28.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2019]</span>
<span class="ltx_bibblock">
Di Yao, Gao Cong, Chao Zhang, and Jingping Bi.

</span>
<span class="ltx_bibblock">Computing trajectory similarity in linear time: A generic seed-guided
neural metric learning approach.

</span>
<span class="ltx_bibblock">In <span id="bib.bib28.3.1" class="ltx_text ltx_font_italic">ICDE</span>, pages 1358–1369. IEEE, 2019.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yao <span id="bib.bib29.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2020]</span>
<span class="ltx_bibblock">
Di Yao, Gao Cong, Chao Zhang, Xuying Meng, et al.

</span>
<span class="ltx_bibblock">A linear time approach to computing time series similarity based on
deep metric learning.

</span>
<span class="ltx_bibblock"><span id="bib.bib29.3.1" class="ltx_text ltx_font_italic">TKDE</span>, 2020.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ying <span id="bib.bib30.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2010]</span>
<span class="ltx_bibblock">
Josh Jia-Ching Ying, Eric Hsueh-Chan Lu, et al.

</span>
<span class="ltx_bibblock">Mining user similarity from semantic trajectories.

</span>
<span class="ltx_bibblock">In <span id="bib.bib30.3.1" class="ltx_text ltx_font_italic">SIGSPATIAL Workshop on LBSNs</span>, pages 19–26, 2010.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang <span id="bib.bib31.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2020]</span>
<span class="ltx_bibblock">
Hanyuan Zhang, Xinyu Zhang, Qize Jiang, et al.

</span>
<span class="ltx_bibblock">Trajectory similarity learning with auxiliary supervision and optimal
matching.

</span>
<span class="ltx_bibblock">In <span id="bib.bib31.3.1" class="ltx_text ltx_font_italic">IJCAI</span>, pages 3209–3215, 2020.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao <span id="bib.bib32.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2021]</span>
<span class="ltx_bibblock">
Jiawei Zhao, Wei Luo, Boxing Chen, and Andrew Gilman.

</span>
<span class="ltx_bibblock">Mutual-learning improves end-to-end speech translation.

</span>
<span class="ltx_bibblock">In <span id="bib.bib32.3.1" class="ltx_text ltx_font_italic">EMNLP</span>, pages 3989–3994, 2021.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou <span id="bib.bib33.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2018]</span>
<span class="ltx_bibblock">
Fan Zhou, Qiang Gao, et al.

</span>
<span class="ltx_bibblock">Trajectory-user linking via variational autoencoder.

</span>
<span class="ltx_bibblock">In <span id="bib.bib33.3.1" class="ltx_text ltx_font_italic">IJCAI</span>, pages 3212–3218, 2018.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou <span id="bib.bib34.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2021a]</span>
<span class="ltx_bibblock">
Fan Zhou, Yurou Dai, Qiang Gao, et al.

</span>
<span class="ltx_bibblock">Self-supervised human mobility learning for next location prediction
and trajectory classification.

</span>
<span class="ltx_bibblock"><span id="bib.bib34.3.1" class="ltx_text ltx_font_italic">KBS</span>, page 107214, 2021.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou <span id="bib.bib35.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2021b]</span>
<span class="ltx_bibblock">
Fan Zhou, Ruiyang Yin, Goce Trajcevski, et al.

</span>
<span class="ltx_bibblock">Improving human mobility identification with trajectory augmentation.

</span>
<span class="ltx_bibblock"><span id="bib.bib35.3.1" class="ltx_text ltx_font_italic">GeoInformatica</span>, 25(3):453–483, 2021.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zuo <span id="bib.bib36.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2020]</span>
<span class="ltx_bibblock">
Simiao Zuo, Haoming Jiang, Zichong Li, Tuo Zhao, and Hongyuan Zha.

</span>
<span class="ltx_bibblock">Transformer hawkes process.

</span>
<span class="ltx_bibblock">In <span id="bib.bib36.3.1" class="ltx_text ltx_font_italic">ICML</span>, pages 11692–11702. PMLR, 2020.

</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2205.03772" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="56" alt="ar5iv homepage" class="ar5iv_logo" src="/assets/ar5iv_halloween.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2205.03773" class="ar5iv-text-button ar5iv-severity-error">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2205.03773">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2205.03773" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2205.03774" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Mon Jun  6 02:51:42 2022 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/">LaTeXML <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="[LOGO]"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
