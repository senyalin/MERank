<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2206.14597] Generative Anomaly Detection for Time Series Datasets</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Generative Anomaly Detection for Time Series Datasets">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Generative Anomaly Detection for Time Series Datasets">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2206.14597">

<!--Generated on Sat Dec 24 18:52:46 2022 by LaTeXML (version 0.8.6) http://dlmf.nist.gov/LaTeXML/.-->
<!--Document created on June 2022.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv.0.7.5.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.0.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Generative Anomaly Detection for Time Series Datasets</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Zhuangwei Kang1, Ayan Mukhopadhyay1, Aniruddha Gokhale1, Shijie Wen2, Abhishek Dubey1 
<br class="ltx_break">
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">1 Institute for Software Integrated Systems,
Vanderbilt University
</span>
<span class="ltx_contact ltx_role_affiliation">2 Cisco Systems, Inc.
</span></span></span>
</div>
<div class="ltx_dates">(June 2022)</div>

<div id="p1" class="ltx_para">
<p id="p1.1" class="ltx_p"><span id="p1.1.1" class="ltx_text" style="color:#FF0000;">A version of this paper was presented at the ITSC 2022</span></p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">I </span><span id="S1.1.1" class="ltx_text ltx_font_smallcaps">Introduction</span>
</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">In many real-world monitoring scenarios, such as stock returns, road traffic conditions, data center KPIs, and personal health metrics, collected data appears in the form of multivariate time series (MTS). Monitoring is critical in practice. For instance, Transportation Management Centers are critical for managing the surface road network; delays accrued during the monitoring phase delay response and resolution <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>. Frequently, secondary crashes and long-clearance times lead to additional congestion on critical arterial road segments. To improve the real-time monitoring of extensive road networks, transportation agencies are increasing the available sensing modalities, often in smart corridors. However, this drastic increase in the number of sensors raises an essential question from an operational perspective—how can transportation agencies monitor thousands of sensors in (near) real-time to detect incidents of interest? Our conversations with local transportation agencies revealed that this monitoring is largely performed manually, an infeasible strategy in the long run. One approach to enable transportation agencies to utilize an extensive array of sensors is to detect potentially anomalous patterns in real-time using the data generated by the sensors; then, human experts (or potentially decision-theoretic approaches <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>) can narrow their focus on the anomalies and take necessary operational actions. Similarly, in large data centers, server machine KPIs, such as CPU, memory, TCP, UDP metrics, are periodically collected as multi-variate time series by some profilers. These KPIs are critical for estimating machine health status and making timely responses.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p"><span id="S1.p2.1.1" class="ltx_text ltx_font_bold">Challenges</span> Anomaly detection is a rich field in data mining and has been explored widely in the domain of transportation networks. While detection has been traditionally done for various traffic condition variables with techniques such as CUSUM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>, K-nearest Neighbors <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>, Isolation Forests <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>, and forecasting models (e.g., ARIMA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>), deep neural networks (DNN) have gradually become the state-of-the-art due to the remarkable capability of modeling high-dimensional MTS data. However, despite the universal approximation power of DNN on learning unknown data distributions, performing anomaly detection on MTS is still challenging. For example, many DNN-based approaches either rely on an uncontaminated training dataset to learn the normal traffic patterns (semi-supervised) or reframe the detection task as a classification task using a fully-labeled traffic mobility dataset (supervised).</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">Such approaches, however, are not practical in general, and moreover, such data often do not account for a large number of incidents such as phantom traffic jams, slowdowns, and weather hazards. Further, even if labels are available, such classifiers and approaches identify point anomalies, where the observation is clearly far away from what is expected globally. In addition, traditional anomaly detection techniques focus on maximizing the accuracy of detection. However, in the specific use case of transportation centers, the goal of such a detector is to ensure that the search space for monitoring is shrunk for domain experts. As a result, in practice, the detector must demonstrate high recall with relatively low precision, i.e., false negatives are more costly than false positives. Finally, an additional challenge is proactive model improvement; agencies must ensure that the learned model used to detect anomalies is improved proactively to detect potentially unseen anomalies.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p"><span id="S1.p4.1.1" class="ltx_text ltx_font_bold">Contributions</span> This work systematically addresses these challenges by developing a multi-variate anomaly detection framework based on conditional normalizing flow, a probabilistic generative model that can tractably perform density estimation and sampling in extremely high dimensional spaces <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>. Through this approach, we can model the multimodal distributions of time series data. In particular, we summarize the contributions of this paper as follows:</p>
<ol id="S1.I1" class="ltx_enumerate">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">We propose a principled MTS anomaly detection and diagnosis model for traffic data that comprises an LSTM-Encoder-Decoder (LSTM-EncDec) model and a Normalizing Flow architecture <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>, specifically a RealNVP <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> flow. The former makes sequence-to-sequence forecasting with a sliding-window scheme to extract internal spatial-temporal information from ground-truth data. The flow model is used to model complex data distribution in the high-dimensional transit data. Specifically, it performs conditional density estimation using the outputs of the forecasting model.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">To ensure tractability of our approach, we divide the road network of a city into clusters, and perform anomaly detection at the granularity of clusters.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">Then, we use a simpler density estimator based on a kernel density function to identify anomalies at the granularity of features(e.g., road segments in transportation systems or KPIs for server machines).</p>
</div>
</li>
<li id="S1.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">4.</span> 
<div id="S1.I1.i4.p1" class="ltx_para">
<p id="S1.I1.i4.p1.1" class="ltx_p">We compare our approach with existing state-of-the-art baselines using traffic data collected from the City of Nashville, Tennessee as well as an open dataset on server machines. Experimental results show that our approach has superior performance and sensitivity on anomaly detection in traffic networks.</p>
</div>
</li>
</ol>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">II </span><span id="S2.1.1" class="ltx_text ltx_font_smallcaps">Background</span>
</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p">In this section, we provide some preliminary knowledge about general normalizing flows and RealNVP.</p>
</div>
<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S2.SS1.5.1.1" class="ltx_text">II-A</span> </span><span id="S2.SS1.6.2" class="ltx_text ltx_font_italic">Normalizing Flow</span>
</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.12" class="ltx_p">Normalizing flows define a series of bijective transformations that can transform the probability density <math id="S2.SS1.p1.1.m1.1" class="ltx_Math" alttext="p_{X}(x)" display="inline"><semantics id="S2.SS1.p1.1.m1.1a"><mrow id="S2.SS1.p1.1.m1.1.2" xref="S2.SS1.p1.1.m1.1.2.cmml"><msub id="S2.SS1.p1.1.m1.1.2.2" xref="S2.SS1.p1.1.m1.1.2.2.cmml"><mi id="S2.SS1.p1.1.m1.1.2.2.2" xref="S2.SS1.p1.1.m1.1.2.2.2.cmml">p</mi><mi id="S2.SS1.p1.1.m1.1.2.2.3" xref="S2.SS1.p1.1.m1.1.2.2.3.cmml">X</mi></msub><mo id="S2.SS1.p1.1.m1.1.2.1" xref="S2.SS1.p1.1.m1.1.2.1.cmml">⁢</mo><mrow id="S2.SS1.p1.1.m1.1.2.3.2" xref="S2.SS1.p1.1.m1.1.2.cmml"><mo stretchy="false" id="S2.SS1.p1.1.m1.1.2.3.2.1" xref="S2.SS1.p1.1.m1.1.2.cmml">(</mo><mi id="S2.SS1.p1.1.m1.1.1" xref="S2.SS1.p1.1.m1.1.1.cmml">x</mi><mo stretchy="false" id="S2.SS1.p1.1.m1.1.2.3.2.2" xref="S2.SS1.p1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.1.m1.1b"><apply id="S2.SS1.p1.1.m1.1.2.cmml" xref="S2.SS1.p1.1.m1.1.2"><times id="S2.SS1.p1.1.m1.1.2.1.cmml" xref="S2.SS1.p1.1.m1.1.2.1"></times><apply id="S2.SS1.p1.1.m1.1.2.2.cmml" xref="S2.SS1.p1.1.m1.1.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.1.m1.1.2.2.1.cmml" xref="S2.SS1.p1.1.m1.1.2.2">subscript</csymbol><ci id="S2.SS1.p1.1.m1.1.2.2.2.cmml" xref="S2.SS1.p1.1.m1.1.2.2.2">𝑝</ci><ci id="S2.SS1.p1.1.m1.1.2.2.3.cmml" xref="S2.SS1.p1.1.m1.1.2.2.3">𝑋</ci></apply><ci id="S2.SS1.p1.1.m1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.1.m1.1c">p_{X}(x)</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.1.m1.1d">italic_p start_POSTSUBSCRIPT italic_X end_POSTSUBSCRIPT ( italic_x )</annotation></semantics></math> of a random variable <math id="S2.SS1.p1.2.m2.1" class="ltx_Math" alttext="X\in\mathbb{R}^{D}" display="inline"><semantics id="S2.SS1.p1.2.m2.1a"><mrow id="S2.SS1.p1.2.m2.1.1" xref="S2.SS1.p1.2.m2.1.1.cmml"><mi id="S2.SS1.p1.2.m2.1.1.2" xref="S2.SS1.p1.2.m2.1.1.2.cmml">X</mi><mo id="S2.SS1.p1.2.m2.1.1.1" xref="S2.SS1.p1.2.m2.1.1.1.cmml">∈</mo><msup id="S2.SS1.p1.2.m2.1.1.3" xref="S2.SS1.p1.2.m2.1.1.3.cmml"><mi id="S2.SS1.p1.2.m2.1.1.3.2" xref="S2.SS1.p1.2.m2.1.1.3.2.cmml">ℝ</mi><mi id="S2.SS1.p1.2.m2.1.1.3.3" xref="S2.SS1.p1.2.m2.1.1.3.3.cmml">D</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.2.m2.1b"><apply id="S2.SS1.p1.2.m2.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1"><in id="S2.SS1.p1.2.m2.1.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1.1"></in><ci id="S2.SS1.p1.2.m2.1.1.2.cmml" xref="S2.SS1.p1.2.m2.1.1.2">𝑋</ci><apply id="S2.SS1.p1.2.m2.1.1.3.cmml" xref="S2.SS1.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p1.2.m2.1.1.3.1.cmml" xref="S2.SS1.p1.2.m2.1.1.3">superscript</csymbol><ci id="S2.SS1.p1.2.m2.1.1.3.2.cmml" xref="S2.SS1.p1.2.m2.1.1.3.2">ℝ</ci><ci id="S2.SS1.p1.2.m2.1.1.3.3.cmml" xref="S2.SS1.p1.2.m2.1.1.3.3">𝐷</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.2.m2.1c">X\in\mathbb{R}^{D}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.2.m2.1d">italic_X ∈ blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT</annotation></semantics></math> to a well-known base distribution <math id="S2.SS1.p1.3.m3.1" class="ltx_Math" alttext="p_{Z}(z)" display="inline"><semantics id="S2.SS1.p1.3.m3.1a"><mrow id="S2.SS1.p1.3.m3.1.2" xref="S2.SS1.p1.3.m3.1.2.cmml"><msub id="S2.SS1.p1.3.m3.1.2.2" xref="S2.SS1.p1.3.m3.1.2.2.cmml"><mi id="S2.SS1.p1.3.m3.1.2.2.2" xref="S2.SS1.p1.3.m3.1.2.2.2.cmml">p</mi><mi id="S2.SS1.p1.3.m3.1.2.2.3" xref="S2.SS1.p1.3.m3.1.2.2.3.cmml">Z</mi></msub><mo id="S2.SS1.p1.3.m3.1.2.1" xref="S2.SS1.p1.3.m3.1.2.1.cmml">⁢</mo><mrow id="S2.SS1.p1.3.m3.1.2.3.2" xref="S2.SS1.p1.3.m3.1.2.cmml"><mo stretchy="false" id="S2.SS1.p1.3.m3.1.2.3.2.1" xref="S2.SS1.p1.3.m3.1.2.cmml">(</mo><mi id="S2.SS1.p1.3.m3.1.1" xref="S2.SS1.p1.3.m3.1.1.cmml">z</mi><mo stretchy="false" id="S2.SS1.p1.3.m3.1.2.3.2.2" xref="S2.SS1.p1.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.3.m3.1b"><apply id="S2.SS1.p1.3.m3.1.2.cmml" xref="S2.SS1.p1.3.m3.1.2"><times id="S2.SS1.p1.3.m3.1.2.1.cmml" xref="S2.SS1.p1.3.m3.1.2.1"></times><apply id="S2.SS1.p1.3.m3.1.2.2.cmml" xref="S2.SS1.p1.3.m3.1.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.3.m3.1.2.2.1.cmml" xref="S2.SS1.p1.3.m3.1.2.2">subscript</csymbol><ci id="S2.SS1.p1.3.m3.1.2.2.2.cmml" xref="S2.SS1.p1.3.m3.1.2.2.2">𝑝</ci><ci id="S2.SS1.p1.3.m3.1.2.2.3.cmml" xref="S2.SS1.p1.3.m3.1.2.2.3">𝑍</ci></apply><ci id="S2.SS1.p1.3.m3.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1">𝑧</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.3.m3.1c">p_{Z}(z)</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.3.m3.1d">italic_p start_POSTSUBSCRIPT italic_Z end_POSTSUBSCRIPT ( italic_z )</annotation></semantics></math> defined by a random variable <math id="S2.SS1.p1.4.m4.1" class="ltx_Math" alttext="Z\in\mathbb{R}^{D}" display="inline"><semantics id="S2.SS1.p1.4.m4.1a"><mrow id="S2.SS1.p1.4.m4.1.1" xref="S2.SS1.p1.4.m4.1.1.cmml"><mi id="S2.SS1.p1.4.m4.1.1.2" xref="S2.SS1.p1.4.m4.1.1.2.cmml">Z</mi><mo id="S2.SS1.p1.4.m4.1.1.1" xref="S2.SS1.p1.4.m4.1.1.1.cmml">∈</mo><msup id="S2.SS1.p1.4.m4.1.1.3" xref="S2.SS1.p1.4.m4.1.1.3.cmml"><mi id="S2.SS1.p1.4.m4.1.1.3.2" xref="S2.SS1.p1.4.m4.1.1.3.2.cmml">ℝ</mi><mi id="S2.SS1.p1.4.m4.1.1.3.3" xref="S2.SS1.p1.4.m4.1.1.3.3.cmml">D</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.4.m4.1b"><apply id="S2.SS1.p1.4.m4.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1"><in id="S2.SS1.p1.4.m4.1.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1.1"></in><ci id="S2.SS1.p1.4.m4.1.1.2.cmml" xref="S2.SS1.p1.4.m4.1.1.2">𝑍</ci><apply id="S2.SS1.p1.4.m4.1.1.3.cmml" xref="S2.SS1.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p1.4.m4.1.1.3.1.cmml" xref="S2.SS1.p1.4.m4.1.1.3">superscript</csymbol><ci id="S2.SS1.p1.4.m4.1.1.3.2.cmml" xref="S2.SS1.p1.4.m4.1.1.3.2">ℝ</ci><ci id="S2.SS1.p1.4.m4.1.1.3.3.cmml" xref="S2.SS1.p1.4.m4.1.1.3.3">𝐷</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.4.m4.1c">Z\in\mathbb{R}^{D}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.4.m4.1d">italic_Z ∈ blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>. The random variable <math id="S2.SS1.p1.5.m5.1" class="ltx_Math" alttext="Z" display="inline"><semantics id="S2.SS1.p1.5.m5.1a"><mi id="S2.SS1.p1.5.m5.1.1" xref="S2.SS1.p1.5.m5.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.5.m5.1b"><ci id="S2.SS1.p1.5.m5.1.1.cmml" xref="S2.SS1.p1.5.m5.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.5.m5.1c">Z</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.5.m5.1d">italic_Z</annotation></semantics></math> is chosen such that it has an explicit probability density function. The problem of training the normalizing flow is to learn an invertible transformation, <math id="S2.SS1.p1.6.m6.1" class="ltx_Math" alttext="f" display="inline"><semantics id="S2.SS1.p1.6.m6.1a"><mi id="S2.SS1.p1.6.m6.1.1" xref="S2.SS1.p1.6.m6.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.6.m6.1b"><ci id="S2.SS1.p1.6.m6.1.1.cmml" xref="S2.SS1.p1.6.m6.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.6.m6.1c">f</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.6.m6.1d">italic_f</annotation></semantics></math> such that <math id="S2.SS1.p1.7.m7.1" class="ltx_Math" alttext="z=f(x)" display="inline"><semantics id="S2.SS1.p1.7.m7.1a"><mrow id="S2.SS1.p1.7.m7.1.2" xref="S2.SS1.p1.7.m7.1.2.cmml"><mi id="S2.SS1.p1.7.m7.1.2.2" xref="S2.SS1.p1.7.m7.1.2.2.cmml">z</mi><mo id="S2.SS1.p1.7.m7.1.2.1" xref="S2.SS1.p1.7.m7.1.2.1.cmml">=</mo><mrow id="S2.SS1.p1.7.m7.1.2.3" xref="S2.SS1.p1.7.m7.1.2.3.cmml"><mi id="S2.SS1.p1.7.m7.1.2.3.2" xref="S2.SS1.p1.7.m7.1.2.3.2.cmml">f</mi><mo id="S2.SS1.p1.7.m7.1.2.3.1" xref="S2.SS1.p1.7.m7.1.2.3.1.cmml">⁢</mo><mrow id="S2.SS1.p1.7.m7.1.2.3.3.2" xref="S2.SS1.p1.7.m7.1.2.3.cmml"><mo stretchy="false" id="S2.SS1.p1.7.m7.1.2.3.3.2.1" xref="S2.SS1.p1.7.m7.1.2.3.cmml">(</mo><mi id="S2.SS1.p1.7.m7.1.1" xref="S2.SS1.p1.7.m7.1.1.cmml">x</mi><mo stretchy="false" id="S2.SS1.p1.7.m7.1.2.3.3.2.2" xref="S2.SS1.p1.7.m7.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.7.m7.1b"><apply id="S2.SS1.p1.7.m7.1.2.cmml" xref="S2.SS1.p1.7.m7.1.2"><eq id="S2.SS1.p1.7.m7.1.2.1.cmml" xref="S2.SS1.p1.7.m7.1.2.1"></eq><ci id="S2.SS1.p1.7.m7.1.2.2.cmml" xref="S2.SS1.p1.7.m7.1.2.2">𝑧</ci><apply id="S2.SS1.p1.7.m7.1.2.3.cmml" xref="S2.SS1.p1.7.m7.1.2.3"><times id="S2.SS1.p1.7.m7.1.2.3.1.cmml" xref="S2.SS1.p1.7.m7.1.2.3.1"></times><ci id="S2.SS1.p1.7.m7.1.2.3.2.cmml" xref="S2.SS1.p1.7.m7.1.2.3.2">𝑓</ci><ci id="S2.SS1.p1.7.m7.1.1.cmml" xref="S2.SS1.p1.7.m7.1.1">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.7.m7.1c">z=f(x)</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.7.m7.1d">italic_z = italic_f ( italic_x )</annotation></semantics></math> and <math id="S2.SS1.p1.8.m8.1" class="ltx_Math" alttext="x=f^{-1}(z)" display="inline"><semantics id="S2.SS1.p1.8.m8.1a"><mrow id="S2.SS1.p1.8.m8.1.2" xref="S2.SS1.p1.8.m8.1.2.cmml"><mi id="S2.SS1.p1.8.m8.1.2.2" xref="S2.SS1.p1.8.m8.1.2.2.cmml">x</mi><mo id="S2.SS1.p1.8.m8.1.2.1" xref="S2.SS1.p1.8.m8.1.2.1.cmml">=</mo><mrow id="S2.SS1.p1.8.m8.1.2.3" xref="S2.SS1.p1.8.m8.1.2.3.cmml"><msup id="S2.SS1.p1.8.m8.1.2.3.2" xref="S2.SS1.p1.8.m8.1.2.3.2.cmml"><mi id="S2.SS1.p1.8.m8.1.2.3.2.2" xref="S2.SS1.p1.8.m8.1.2.3.2.2.cmml">f</mi><mrow id="S2.SS1.p1.8.m8.1.2.3.2.3" xref="S2.SS1.p1.8.m8.1.2.3.2.3.cmml"><mo id="S2.SS1.p1.8.m8.1.2.3.2.3a" xref="S2.SS1.p1.8.m8.1.2.3.2.3.cmml">−</mo><mn id="S2.SS1.p1.8.m8.1.2.3.2.3.2" xref="S2.SS1.p1.8.m8.1.2.3.2.3.2.cmml">1</mn></mrow></msup><mo id="S2.SS1.p1.8.m8.1.2.3.1" xref="S2.SS1.p1.8.m8.1.2.3.1.cmml">⁢</mo><mrow id="S2.SS1.p1.8.m8.1.2.3.3.2" xref="S2.SS1.p1.8.m8.1.2.3.cmml"><mo stretchy="false" id="S2.SS1.p1.8.m8.1.2.3.3.2.1" xref="S2.SS1.p1.8.m8.1.2.3.cmml">(</mo><mi id="S2.SS1.p1.8.m8.1.1" xref="S2.SS1.p1.8.m8.1.1.cmml">z</mi><mo stretchy="false" id="S2.SS1.p1.8.m8.1.2.3.3.2.2" xref="S2.SS1.p1.8.m8.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.8.m8.1b"><apply id="S2.SS1.p1.8.m8.1.2.cmml" xref="S2.SS1.p1.8.m8.1.2"><eq id="S2.SS1.p1.8.m8.1.2.1.cmml" xref="S2.SS1.p1.8.m8.1.2.1"></eq><ci id="S2.SS1.p1.8.m8.1.2.2.cmml" xref="S2.SS1.p1.8.m8.1.2.2">𝑥</ci><apply id="S2.SS1.p1.8.m8.1.2.3.cmml" xref="S2.SS1.p1.8.m8.1.2.3"><times id="S2.SS1.p1.8.m8.1.2.3.1.cmml" xref="S2.SS1.p1.8.m8.1.2.3.1"></times><apply id="S2.SS1.p1.8.m8.1.2.3.2.cmml" xref="S2.SS1.p1.8.m8.1.2.3.2"><csymbol cd="ambiguous" id="S2.SS1.p1.8.m8.1.2.3.2.1.cmml" xref="S2.SS1.p1.8.m8.1.2.3.2">superscript</csymbol><ci id="S2.SS1.p1.8.m8.1.2.3.2.2.cmml" xref="S2.SS1.p1.8.m8.1.2.3.2.2">𝑓</ci><apply id="S2.SS1.p1.8.m8.1.2.3.2.3.cmml" xref="S2.SS1.p1.8.m8.1.2.3.2.3"><minus id="S2.SS1.p1.8.m8.1.2.3.2.3.1.cmml" xref="S2.SS1.p1.8.m8.1.2.3.2.3"></minus><cn type="integer" id="S2.SS1.p1.8.m8.1.2.3.2.3.2.cmml" xref="S2.SS1.p1.8.m8.1.2.3.2.3.2">1</cn></apply></apply><ci id="S2.SS1.p1.8.m8.1.1.cmml" xref="S2.SS1.p1.8.m8.1.1">𝑧</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.8.m8.1c">x=f^{-1}(z)</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.8.m8.1d">italic_x = italic_f start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ( italic_z )</annotation></semantics></math>. The transformation is a sequence of bijective functions composed together, i.e., <math id="S2.SS1.p1.9.m9.1" class="ltx_math_unparsed" alttext="f=(f_{1}.f_{2}\cdots" display="inline"><semantics id="S2.SS1.p1.9.m9.1a"><mrow id="S2.SS1.p1.9.m9.1b"><mi id="S2.SS1.p1.9.m9.1.1">f</mi><mo id="S2.SS1.p1.9.m9.1.2">=</mo><mrow id="S2.SS1.p1.9.m9.1.3"><mo stretchy="false" id="S2.SS1.p1.9.m9.1.3.1">(</mo><msub id="S2.SS1.p1.9.m9.1.3.2"><mi id="S2.SS1.p1.9.m9.1.3.2.2">f</mi><mn id="S2.SS1.p1.9.m9.1.3.2.3">1</mn></msub><mo lspace="0em" rspace="0.167em" id="S2.SS1.p1.9.m9.1.3.3">.</mo><msub id="S2.SS1.p1.9.m9.1.3.4"><mi id="S2.SS1.p1.9.m9.1.3.4.2">f</mi><mn id="S2.SS1.p1.9.m9.1.3.4.3">2</mn></msub><mi mathvariant="normal" id="S2.SS1.p1.9.m9.1.3.5">⋯</mi></mrow></mrow><annotation encoding="application/x-tex" id="S2.SS1.p1.9.m9.1c">f=(f_{1}.f_{2}\cdots</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.9.m9.1d">italic_f = ( italic_f start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT . italic_f start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ⋯</annotation></semantics></math>).
Once learned, the forward mapping, <math id="S2.SS1.p1.10.m10.1" class="ltx_Math" alttext="X\rightarrow Z" display="inline"><semantics id="S2.SS1.p1.10.m10.1a"><mrow id="S2.SS1.p1.10.m10.1.1" xref="S2.SS1.p1.10.m10.1.1.cmml"><mi id="S2.SS1.p1.10.m10.1.1.2" xref="S2.SS1.p1.10.m10.1.1.2.cmml">X</mi><mo stretchy="false" id="S2.SS1.p1.10.m10.1.1.1" xref="S2.SS1.p1.10.m10.1.1.1.cmml">→</mo><mi id="S2.SS1.p1.10.m10.1.1.3" xref="S2.SS1.p1.10.m10.1.1.3.cmml">Z</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.10.m10.1b"><apply id="S2.SS1.p1.10.m10.1.1.cmml" xref="S2.SS1.p1.10.m10.1.1"><ci id="S2.SS1.p1.10.m10.1.1.1.cmml" xref="S2.SS1.p1.10.m10.1.1.1">→</ci><ci id="S2.SS1.p1.10.m10.1.1.2.cmml" xref="S2.SS1.p1.10.m10.1.1.2">𝑋</ci><ci id="S2.SS1.p1.10.m10.1.1.3.cmml" xref="S2.SS1.p1.10.m10.1.1.3">𝑍</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.10.m10.1c">X\rightarrow Z</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.10.m10.1d">italic_X → italic_Z</annotation></semantics></math> can be used for density estimation and the inverse mapping <math id="S2.SS1.p1.11.m11.1" class="ltx_Math" alttext="Z\rightarrow X" display="inline"><semantics id="S2.SS1.p1.11.m11.1a"><mrow id="S2.SS1.p1.11.m11.1.1" xref="S2.SS1.p1.11.m11.1.1.cmml"><mi id="S2.SS1.p1.11.m11.1.1.2" xref="S2.SS1.p1.11.m11.1.1.2.cmml">Z</mi><mo stretchy="false" id="S2.SS1.p1.11.m11.1.1.1" xref="S2.SS1.p1.11.m11.1.1.1.cmml">→</mo><mi id="S2.SS1.p1.11.m11.1.1.3" xref="S2.SS1.p1.11.m11.1.1.3.cmml">X</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.11.m11.1b"><apply id="S2.SS1.p1.11.m11.1.1.cmml" xref="S2.SS1.p1.11.m11.1.1"><ci id="S2.SS1.p1.11.m11.1.1.1.cmml" xref="S2.SS1.p1.11.m11.1.1.1">→</ci><ci id="S2.SS1.p1.11.m11.1.1.2.cmml" xref="S2.SS1.p1.11.m11.1.1.2">𝑍</ci><ci id="S2.SS1.p1.11.m11.1.1.3.cmml" xref="S2.SS1.p1.11.m11.1.1.3">𝑋</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.11.m11.1c">Z\rightarrow X</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.11.m11.1d">italic_Z → italic_X</annotation></semantics></math> can be used for sampling (synthetic data generation). This mapping presents a key advantage that enables exact density estimation without loss of dimensional information, making it suitable for anomaly detection.
In particular, the marginal likelihood <math id="S2.SS1.p1.12.m12.1" class="ltx_Math" alttext="p_{X}(x)" display="inline"><semantics id="S2.SS1.p1.12.m12.1a"><mrow id="S2.SS1.p1.12.m12.1.2" xref="S2.SS1.p1.12.m12.1.2.cmml"><msub id="S2.SS1.p1.12.m12.1.2.2" xref="S2.SS1.p1.12.m12.1.2.2.cmml"><mi id="S2.SS1.p1.12.m12.1.2.2.2" xref="S2.SS1.p1.12.m12.1.2.2.2.cmml">p</mi><mi id="S2.SS1.p1.12.m12.1.2.2.3" xref="S2.SS1.p1.12.m12.1.2.2.3.cmml">X</mi></msub><mo id="S2.SS1.p1.12.m12.1.2.1" xref="S2.SS1.p1.12.m12.1.2.1.cmml">⁢</mo><mrow id="S2.SS1.p1.12.m12.1.2.3.2" xref="S2.SS1.p1.12.m12.1.2.cmml"><mo stretchy="false" id="S2.SS1.p1.12.m12.1.2.3.2.1" xref="S2.SS1.p1.12.m12.1.2.cmml">(</mo><mi id="S2.SS1.p1.12.m12.1.1" xref="S2.SS1.p1.12.m12.1.1.cmml">x</mi><mo stretchy="false" id="S2.SS1.p1.12.m12.1.2.3.2.2" xref="S2.SS1.p1.12.m12.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.12.m12.1b"><apply id="S2.SS1.p1.12.m12.1.2.cmml" xref="S2.SS1.p1.12.m12.1.2"><times id="S2.SS1.p1.12.m12.1.2.1.cmml" xref="S2.SS1.p1.12.m12.1.2.1"></times><apply id="S2.SS1.p1.12.m12.1.2.2.cmml" xref="S2.SS1.p1.12.m12.1.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.12.m12.1.2.2.1.cmml" xref="S2.SS1.p1.12.m12.1.2.2">subscript</csymbol><ci id="S2.SS1.p1.12.m12.1.2.2.2.cmml" xref="S2.SS1.p1.12.m12.1.2.2.2">𝑝</ci><ci id="S2.SS1.p1.12.m12.1.2.2.3.cmml" xref="S2.SS1.p1.12.m12.1.2.2.3">𝑋</ci></apply><ci id="S2.SS1.p1.12.m12.1.1.cmml" xref="S2.SS1.p1.12.m12.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.12.m12.1c">p_{X}(x)</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.12.m12.1d">italic_p start_POSTSUBSCRIPT italic_X end_POSTSUBSCRIPT ( italic_x )</annotation></semantics></math> can be expressed as:</p>
<table id="S2.E1" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S2.E1X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E1X.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle p_{X}(x)" display="inline"><semantics id="S2.E1X.2.1.1.m1.1a"><mrow id="S2.E1X.2.1.1.m1.1.2" xref="S2.E1X.2.1.1.m1.1.2.cmml"><msub id="S2.E1X.2.1.1.m1.1.2.2" xref="S2.E1X.2.1.1.m1.1.2.2.cmml"><mi id="S2.E1X.2.1.1.m1.1.2.2.2" xref="S2.E1X.2.1.1.m1.1.2.2.2.cmml">p</mi><mi id="S2.E1X.2.1.1.m1.1.2.2.3" xref="S2.E1X.2.1.1.m1.1.2.2.3.cmml">X</mi></msub><mo id="S2.E1X.2.1.1.m1.1.2.1" xref="S2.E1X.2.1.1.m1.1.2.1.cmml">⁢</mo><mrow id="S2.E1X.2.1.1.m1.1.2.3.2" xref="S2.E1X.2.1.1.m1.1.2.cmml"><mo stretchy="false" id="S2.E1X.2.1.1.m1.1.2.3.2.1" xref="S2.E1X.2.1.1.m1.1.2.cmml">(</mo><mi id="S2.E1X.2.1.1.m1.1.1" xref="S2.E1X.2.1.1.m1.1.1.cmml">x</mi><mo stretchy="false" id="S2.E1X.2.1.1.m1.1.2.3.2.2" xref="S2.E1X.2.1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E1X.2.1.1.m1.1b"><apply id="S2.E1X.2.1.1.m1.1.2.cmml" xref="S2.E1X.2.1.1.m1.1.2"><times id="S2.E1X.2.1.1.m1.1.2.1.cmml" xref="S2.E1X.2.1.1.m1.1.2.1"></times><apply id="S2.E1X.2.1.1.m1.1.2.2.cmml" xref="S2.E1X.2.1.1.m1.1.2.2"><csymbol cd="ambiguous" id="S2.E1X.2.1.1.m1.1.2.2.1.cmml" xref="S2.E1X.2.1.1.m1.1.2.2">subscript</csymbol><ci id="S2.E1X.2.1.1.m1.1.2.2.2.cmml" xref="S2.E1X.2.1.1.m1.1.2.2.2">𝑝</ci><ci id="S2.E1X.2.1.1.m1.1.2.2.3.cmml" xref="S2.E1X.2.1.1.m1.1.2.2.3">𝑋</ci></apply><ci id="S2.E1X.2.1.1.m1.1.1.cmml" xref="S2.E1X.2.1.1.m1.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1X.2.1.1.m1.1c">\displaystyle p_{X}(x)</annotation><annotation encoding="application/x-llamapun" id="S2.E1X.2.1.1.m1.1d">italic_p start_POSTSUBSCRIPT italic_X end_POSTSUBSCRIPT ( italic_x )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E1X.3.2.2.m1.4" class="ltx_Math" alttext="\displaystyle=p_{Z}(f(x))\left|\det\left(\frac{\partial f(x)}{\partial x}\right)\right|" display="inline"><semantics id="S2.E1X.3.2.2.m1.4a"><mrow id="S2.E1X.3.2.2.m1.4.4" xref="S2.E1X.3.2.2.m1.4.4.cmml"><mi id="S2.E1X.3.2.2.m1.4.4.4" xref="S2.E1X.3.2.2.m1.4.4.4.cmml"></mi><mo id="S2.E1X.3.2.2.m1.4.4.3" xref="S2.E1X.3.2.2.m1.4.4.3.cmml">=</mo><mrow id="S2.E1X.3.2.2.m1.4.4.2" xref="S2.E1X.3.2.2.m1.4.4.2.cmml"><msub id="S2.E1X.3.2.2.m1.4.4.2.4" xref="S2.E1X.3.2.2.m1.4.4.2.4.cmml"><mi id="S2.E1X.3.2.2.m1.4.4.2.4.2" xref="S2.E1X.3.2.2.m1.4.4.2.4.2.cmml">p</mi><mi id="S2.E1X.3.2.2.m1.4.4.2.4.3" xref="S2.E1X.3.2.2.m1.4.4.2.4.3.cmml">Z</mi></msub><mo id="S2.E1X.3.2.2.m1.4.4.2.3" xref="S2.E1X.3.2.2.m1.4.4.2.3.cmml">⁢</mo><mrow id="S2.E1X.3.2.2.m1.3.3.1.1.1" xref="S2.E1X.3.2.2.m1.3.3.1.1.1.1.cmml"><mo stretchy="false" id="S2.E1X.3.2.2.m1.3.3.1.1.1.2" xref="S2.E1X.3.2.2.m1.3.3.1.1.1.1.cmml">(</mo><mrow id="S2.E1X.3.2.2.m1.3.3.1.1.1.1" xref="S2.E1X.3.2.2.m1.3.3.1.1.1.1.cmml"><mi id="S2.E1X.3.2.2.m1.3.3.1.1.1.1.2" xref="S2.E1X.3.2.2.m1.3.3.1.1.1.1.2.cmml">f</mi><mo id="S2.E1X.3.2.2.m1.3.3.1.1.1.1.1" xref="S2.E1X.3.2.2.m1.3.3.1.1.1.1.1.cmml">⁢</mo><mrow id="S2.E1X.3.2.2.m1.3.3.1.1.1.1.3.2" xref="S2.E1X.3.2.2.m1.3.3.1.1.1.1.cmml"><mo stretchy="false" id="S2.E1X.3.2.2.m1.3.3.1.1.1.1.3.2.1" xref="S2.E1X.3.2.2.m1.3.3.1.1.1.1.cmml">(</mo><mi id="S2.E1X.3.2.2.m1.2.2" xref="S2.E1X.3.2.2.m1.2.2.cmml">x</mi><mo stretchy="false" id="S2.E1X.3.2.2.m1.3.3.1.1.1.1.3.2.2" xref="S2.E1X.3.2.2.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S2.E1X.3.2.2.m1.3.3.1.1.1.3" xref="S2.E1X.3.2.2.m1.3.3.1.1.1.1.cmml">)</mo></mrow><mo id="S2.E1X.3.2.2.m1.4.4.2.3a" xref="S2.E1X.3.2.2.m1.4.4.2.3.cmml">⁢</mo><mrow id="S2.E1X.3.2.2.m1.4.4.2.2.1" xref="S2.E1X.3.2.2.m1.4.4.2.2.2.cmml"><mo id="S2.E1X.3.2.2.m1.4.4.2.2.1.2" xref="S2.E1X.3.2.2.m1.4.4.2.2.2.1.cmml">|</mo><mrow id="S2.E1X.3.2.2.m1.4.4.2.2.1.1" xref="S2.E1X.3.2.2.m1.4.4.2.2.1.1.cmml"><mo lspace="0em" movablelimits="false" rspace="0em" id="S2.E1X.3.2.2.m1.4.4.2.2.1.1.1" xref="S2.E1X.3.2.2.m1.4.4.2.2.1.1.1.cmml">det</mo><mrow id="S2.E1X.3.2.2.m1.4.4.2.2.1.1.2.2" xref="S2.E1X.3.2.2.m1.1.1.cmml"><mo id="S2.E1X.3.2.2.m1.4.4.2.2.1.1.2.2.1" xref="S2.E1X.3.2.2.m1.1.1.cmml">(</mo><mstyle displaystyle="true" id="S2.E1X.3.2.2.m1.1.1" xref="S2.E1X.3.2.2.m1.1.1.cmml"><mfrac id="S2.E1X.3.2.2.m1.1.1a" xref="S2.E1X.3.2.2.m1.1.1.cmml"><mrow id="S2.E1X.3.2.2.m1.1.1.1" xref="S2.E1X.3.2.2.m1.1.1.1.cmml"><mo rspace="0em" id="S2.E1X.3.2.2.m1.1.1.1.2" xref="S2.E1X.3.2.2.m1.1.1.1.2.cmml">∂</mo><mrow id="S2.E1X.3.2.2.m1.1.1.1.3" xref="S2.E1X.3.2.2.m1.1.1.1.3.cmml"><mi id="S2.E1X.3.2.2.m1.1.1.1.3.2" xref="S2.E1X.3.2.2.m1.1.1.1.3.2.cmml">f</mi><mo id="S2.E1X.3.2.2.m1.1.1.1.3.1" xref="S2.E1X.3.2.2.m1.1.1.1.3.1.cmml">⁢</mo><mrow id="S2.E1X.3.2.2.m1.1.1.1.3.3.2" xref="S2.E1X.3.2.2.m1.1.1.1.3.cmml"><mo stretchy="false" id="S2.E1X.3.2.2.m1.1.1.1.3.3.2.1" xref="S2.E1X.3.2.2.m1.1.1.1.3.cmml">(</mo><mi id="S2.E1X.3.2.2.m1.1.1.1.1" xref="S2.E1X.3.2.2.m1.1.1.1.1.cmml">x</mi><mo stretchy="false" id="S2.E1X.3.2.2.m1.1.1.1.3.3.2.2" xref="S2.E1X.3.2.2.m1.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mrow id="S2.E1X.3.2.2.m1.1.1.3" xref="S2.E1X.3.2.2.m1.1.1.3.cmml"><mo rspace="0em" id="S2.E1X.3.2.2.m1.1.1.3.1" xref="S2.E1X.3.2.2.m1.1.1.3.1.cmml">∂</mo><mi id="S2.E1X.3.2.2.m1.1.1.3.2" xref="S2.E1X.3.2.2.m1.1.1.3.2.cmml">x</mi></mrow></mfrac></mstyle><mo id="S2.E1X.3.2.2.m1.4.4.2.2.1.1.2.2.2" xref="S2.E1X.3.2.2.m1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E1X.3.2.2.m1.4.4.2.2.1.3" xref="S2.E1X.3.2.2.m1.4.4.2.2.2.1.cmml">|</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E1X.3.2.2.m1.4b"><apply id="S2.E1X.3.2.2.m1.4.4.cmml" xref="S2.E1X.3.2.2.m1.4.4"><eq id="S2.E1X.3.2.2.m1.4.4.3.cmml" xref="S2.E1X.3.2.2.m1.4.4.3"></eq><csymbol cd="latexml" id="S2.E1X.3.2.2.m1.4.4.4.cmml" xref="S2.E1X.3.2.2.m1.4.4.4">absent</csymbol><apply id="S2.E1X.3.2.2.m1.4.4.2.cmml" xref="S2.E1X.3.2.2.m1.4.4.2"><times id="S2.E1X.3.2.2.m1.4.4.2.3.cmml" xref="S2.E1X.3.2.2.m1.4.4.2.3"></times><apply id="S2.E1X.3.2.2.m1.4.4.2.4.cmml" xref="S2.E1X.3.2.2.m1.4.4.2.4"><csymbol cd="ambiguous" id="S2.E1X.3.2.2.m1.4.4.2.4.1.cmml" xref="S2.E1X.3.2.2.m1.4.4.2.4">subscript</csymbol><ci id="S2.E1X.3.2.2.m1.4.4.2.4.2.cmml" xref="S2.E1X.3.2.2.m1.4.4.2.4.2">𝑝</ci><ci id="S2.E1X.3.2.2.m1.4.4.2.4.3.cmml" xref="S2.E1X.3.2.2.m1.4.4.2.4.3">𝑍</ci></apply><apply id="S2.E1X.3.2.2.m1.3.3.1.1.1.1.cmml" xref="S2.E1X.3.2.2.m1.3.3.1.1.1"><times id="S2.E1X.3.2.2.m1.3.3.1.1.1.1.1.cmml" xref="S2.E1X.3.2.2.m1.3.3.1.1.1.1.1"></times><ci id="S2.E1X.3.2.2.m1.3.3.1.1.1.1.2.cmml" xref="S2.E1X.3.2.2.m1.3.3.1.1.1.1.2">𝑓</ci><ci id="S2.E1X.3.2.2.m1.2.2.cmml" xref="S2.E1X.3.2.2.m1.2.2">𝑥</ci></apply><apply id="S2.E1X.3.2.2.m1.4.4.2.2.2.cmml" xref="S2.E1X.3.2.2.m1.4.4.2.2.1"><abs id="S2.E1X.3.2.2.m1.4.4.2.2.2.1.cmml" xref="S2.E1X.3.2.2.m1.4.4.2.2.1.2"></abs><apply id="S2.E1X.3.2.2.m1.4.4.2.2.1.1.cmml" xref="S2.E1X.3.2.2.m1.4.4.2.2.1.1"><determinant id="S2.E1X.3.2.2.m1.4.4.2.2.1.1.1.cmml" xref="S2.E1X.3.2.2.m1.4.4.2.2.1.1.1"></determinant><apply id="S2.E1X.3.2.2.m1.1.1.cmml" xref="S2.E1X.3.2.2.m1.4.4.2.2.1.1.2.2"><divide id="S2.E1X.3.2.2.m1.1.1.2.cmml" xref="S2.E1X.3.2.2.m1.4.4.2.2.1.1.2.2"></divide><apply id="S2.E1X.3.2.2.m1.1.1.1.cmml" xref="S2.E1X.3.2.2.m1.1.1.1"><partialdiff id="S2.E1X.3.2.2.m1.1.1.1.2.cmml" xref="S2.E1X.3.2.2.m1.1.1.1.2"></partialdiff><apply id="S2.E1X.3.2.2.m1.1.1.1.3.cmml" xref="S2.E1X.3.2.2.m1.1.1.1.3"><times id="S2.E1X.3.2.2.m1.1.1.1.3.1.cmml" xref="S2.E1X.3.2.2.m1.1.1.1.3.1"></times><ci id="S2.E1X.3.2.2.m1.1.1.1.3.2.cmml" xref="S2.E1X.3.2.2.m1.1.1.1.3.2">𝑓</ci><ci id="S2.E1X.3.2.2.m1.1.1.1.1.cmml" xref="S2.E1X.3.2.2.m1.1.1.1.1">𝑥</ci></apply></apply><apply id="S2.E1X.3.2.2.m1.1.1.3.cmml" xref="S2.E1X.3.2.2.m1.1.1.3"><partialdiff id="S2.E1X.3.2.2.m1.1.1.3.1.cmml" xref="S2.E1X.3.2.2.m1.1.1.3.1"></partialdiff><ci id="S2.E1X.3.2.2.m1.1.1.3.2.cmml" xref="S2.E1X.3.2.2.m1.1.1.3.2">𝑥</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1X.3.2.2.m1.4c">\displaystyle=p_{Z}(f(x))\left|\det\left(\frac{\partial f(x)}{\partial x}\right)\right|</annotation><annotation encoding="application/x-llamapun" id="S2.E1X.3.2.2.m1.4d">= italic_p start_POSTSUBSCRIPT italic_Z end_POSTSUBSCRIPT ( italic_f ( italic_x ) ) | roman_det ( divide start_ARG ∂ italic_f ( italic_x ) end_ARG start_ARG ∂ italic_x end_ARG ) |</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(1)</span></td>
</tr>
</tbody>
</table>
<p id="S2.SS1.p1.18" class="ltx_p">where <math id="S2.SS1.p1.13.m1.2" class="ltx_Math" alttext="p_{Z}(f(x))" display="inline"><semantics id="S2.SS1.p1.13.m1.2a"><mrow id="S2.SS1.p1.13.m1.2.2" xref="S2.SS1.p1.13.m1.2.2.cmml"><msub id="S2.SS1.p1.13.m1.2.2.3" xref="S2.SS1.p1.13.m1.2.2.3.cmml"><mi id="S2.SS1.p1.13.m1.2.2.3.2" xref="S2.SS1.p1.13.m1.2.2.3.2.cmml">p</mi><mi id="S2.SS1.p1.13.m1.2.2.3.3" xref="S2.SS1.p1.13.m1.2.2.3.3.cmml">Z</mi></msub><mo id="S2.SS1.p1.13.m1.2.2.2" xref="S2.SS1.p1.13.m1.2.2.2.cmml">⁢</mo><mrow id="S2.SS1.p1.13.m1.2.2.1.1" xref="S2.SS1.p1.13.m1.2.2.1.1.1.cmml"><mo stretchy="false" id="S2.SS1.p1.13.m1.2.2.1.1.2" xref="S2.SS1.p1.13.m1.2.2.1.1.1.cmml">(</mo><mrow id="S2.SS1.p1.13.m1.2.2.1.1.1" xref="S2.SS1.p1.13.m1.2.2.1.1.1.cmml"><mi id="S2.SS1.p1.13.m1.2.2.1.1.1.2" xref="S2.SS1.p1.13.m1.2.2.1.1.1.2.cmml">f</mi><mo id="S2.SS1.p1.13.m1.2.2.1.1.1.1" xref="S2.SS1.p1.13.m1.2.2.1.1.1.1.cmml">⁢</mo><mrow id="S2.SS1.p1.13.m1.2.2.1.1.1.3.2" xref="S2.SS1.p1.13.m1.2.2.1.1.1.cmml"><mo stretchy="false" id="S2.SS1.p1.13.m1.2.2.1.1.1.3.2.1" xref="S2.SS1.p1.13.m1.2.2.1.1.1.cmml">(</mo><mi id="S2.SS1.p1.13.m1.1.1" xref="S2.SS1.p1.13.m1.1.1.cmml">x</mi><mo stretchy="false" id="S2.SS1.p1.13.m1.2.2.1.1.1.3.2.2" xref="S2.SS1.p1.13.m1.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S2.SS1.p1.13.m1.2.2.1.1.3" xref="S2.SS1.p1.13.m1.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.13.m1.2b"><apply id="S2.SS1.p1.13.m1.2.2.cmml" xref="S2.SS1.p1.13.m1.2.2"><times id="S2.SS1.p1.13.m1.2.2.2.cmml" xref="S2.SS1.p1.13.m1.2.2.2"></times><apply id="S2.SS1.p1.13.m1.2.2.3.cmml" xref="S2.SS1.p1.13.m1.2.2.3"><csymbol cd="ambiguous" id="S2.SS1.p1.13.m1.2.2.3.1.cmml" xref="S2.SS1.p1.13.m1.2.2.3">subscript</csymbol><ci id="S2.SS1.p1.13.m1.2.2.3.2.cmml" xref="S2.SS1.p1.13.m1.2.2.3.2">𝑝</ci><ci id="S2.SS1.p1.13.m1.2.2.3.3.cmml" xref="S2.SS1.p1.13.m1.2.2.3.3">𝑍</ci></apply><apply id="S2.SS1.p1.13.m1.2.2.1.1.1.cmml" xref="S2.SS1.p1.13.m1.2.2.1.1"><times id="S2.SS1.p1.13.m1.2.2.1.1.1.1.cmml" xref="S2.SS1.p1.13.m1.2.2.1.1.1.1"></times><ci id="S2.SS1.p1.13.m1.2.2.1.1.1.2.cmml" xref="S2.SS1.p1.13.m1.2.2.1.1.1.2">𝑓</ci><ci id="S2.SS1.p1.13.m1.1.1.cmml" xref="S2.SS1.p1.13.m1.1.1">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.13.m1.2c">p_{Z}(f(x))</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.13.m1.2d">italic_p start_POSTSUBSCRIPT italic_Z end_POSTSUBSCRIPT ( italic_f ( italic_x ) )</annotation></semantics></math> is density of <math id="S2.SS1.p1.14.m2.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S2.SS1.p1.14.m2.1a"><mi id="S2.SS1.p1.14.m2.1.1" xref="S2.SS1.p1.14.m2.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.14.m2.1b"><ci id="S2.SS1.p1.14.m2.1.1.cmml" xref="S2.SS1.p1.14.m2.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.14.m2.1c">x</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.14.m2.1d">italic_x</annotation></semantics></math> under the base distribution <math id="S2.SS1.p1.15.m3.1" class="ltx_Math" alttext="p_{Z}" display="inline"><semantics id="S2.SS1.p1.15.m3.1a"><msub id="S2.SS1.p1.15.m3.1.1" xref="S2.SS1.p1.15.m3.1.1.cmml"><mi id="S2.SS1.p1.15.m3.1.1.2" xref="S2.SS1.p1.15.m3.1.1.2.cmml">p</mi><mi id="S2.SS1.p1.15.m3.1.1.3" xref="S2.SS1.p1.15.m3.1.1.3.cmml">Z</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.15.m3.1b"><apply id="S2.SS1.p1.15.m3.1.1.cmml" xref="S2.SS1.p1.15.m3.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.15.m3.1.1.1.cmml" xref="S2.SS1.p1.15.m3.1.1">subscript</csymbol><ci id="S2.SS1.p1.15.m3.1.1.2.cmml" xref="S2.SS1.p1.15.m3.1.1.2">𝑝</ci><ci id="S2.SS1.p1.15.m3.1.1.3.cmml" xref="S2.SS1.p1.15.m3.1.1.3">𝑍</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.15.m3.1c">p_{Z}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.15.m3.1d">italic_p start_POSTSUBSCRIPT italic_Z end_POSTSUBSCRIPT</annotation></semantics></math> and <math id="S2.SS1.p1.16.m4.1" class="ltx_Math" alttext="\det\left(\frac{\partial f(x)}{\partial x}\right)" display="inline"><semantics id="S2.SS1.p1.16.m4.1a"><mrow id="S2.SS1.p1.16.m4.1.2" xref="S2.SS1.p1.16.m4.1.2.cmml"><mo rspace="0em" id="S2.SS1.p1.16.m4.1.2.1" xref="S2.SS1.p1.16.m4.1.2.1.cmml">det</mo><mrow id="S2.SS1.p1.16.m4.1.2.2.2" xref="S2.SS1.p1.16.m4.1.1.cmml"><mo id="S2.SS1.p1.16.m4.1.2.2.2.1" xref="S2.SS1.p1.16.m4.1.1.cmml">(</mo><mfrac id="S2.SS1.p1.16.m4.1.1" xref="S2.SS1.p1.16.m4.1.1.cmml"><mrow id="S2.SS1.p1.16.m4.1.1.1" xref="S2.SS1.p1.16.m4.1.1.1.cmml"><mo rspace="0em" id="S2.SS1.p1.16.m4.1.1.1.2" xref="S2.SS1.p1.16.m4.1.1.1.2.cmml">∂</mo><mrow id="S2.SS1.p1.16.m4.1.1.1.3" xref="S2.SS1.p1.16.m4.1.1.1.3.cmml"><mi id="S2.SS1.p1.16.m4.1.1.1.3.2" xref="S2.SS1.p1.16.m4.1.1.1.3.2.cmml">f</mi><mo id="S2.SS1.p1.16.m4.1.1.1.3.1" xref="S2.SS1.p1.16.m4.1.1.1.3.1.cmml">⁢</mo><mrow id="S2.SS1.p1.16.m4.1.1.1.3.3.2" xref="S2.SS1.p1.16.m4.1.1.1.3.cmml"><mo stretchy="false" id="S2.SS1.p1.16.m4.1.1.1.3.3.2.1" xref="S2.SS1.p1.16.m4.1.1.1.3.cmml">(</mo><mi id="S2.SS1.p1.16.m4.1.1.1.1" xref="S2.SS1.p1.16.m4.1.1.1.1.cmml">x</mi><mo stretchy="false" id="S2.SS1.p1.16.m4.1.1.1.3.3.2.2" xref="S2.SS1.p1.16.m4.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mrow id="S2.SS1.p1.16.m4.1.1.3" xref="S2.SS1.p1.16.m4.1.1.3.cmml"><mo rspace="0em" id="S2.SS1.p1.16.m4.1.1.3.1" xref="S2.SS1.p1.16.m4.1.1.3.1.cmml">∂</mo><mi id="S2.SS1.p1.16.m4.1.1.3.2" xref="S2.SS1.p1.16.m4.1.1.3.2.cmml">x</mi></mrow></mfrac><mo id="S2.SS1.p1.16.m4.1.2.2.2.2" xref="S2.SS1.p1.16.m4.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.16.m4.1b"><apply id="S2.SS1.p1.16.m4.1.2.cmml" xref="S2.SS1.p1.16.m4.1.2"><determinant id="S2.SS1.p1.16.m4.1.2.1.cmml" xref="S2.SS1.p1.16.m4.1.2.1"></determinant><apply id="S2.SS1.p1.16.m4.1.1.cmml" xref="S2.SS1.p1.16.m4.1.2.2.2"><divide id="S2.SS1.p1.16.m4.1.1.2.cmml" xref="S2.SS1.p1.16.m4.1.2.2.2"></divide><apply id="S2.SS1.p1.16.m4.1.1.1.cmml" xref="S2.SS1.p1.16.m4.1.1.1"><partialdiff id="S2.SS1.p1.16.m4.1.1.1.2.cmml" xref="S2.SS1.p1.16.m4.1.1.1.2"></partialdiff><apply id="S2.SS1.p1.16.m4.1.1.1.3.cmml" xref="S2.SS1.p1.16.m4.1.1.1.3"><times id="S2.SS1.p1.16.m4.1.1.1.3.1.cmml" xref="S2.SS1.p1.16.m4.1.1.1.3.1"></times><ci id="S2.SS1.p1.16.m4.1.1.1.3.2.cmml" xref="S2.SS1.p1.16.m4.1.1.1.3.2">𝑓</ci><ci id="S2.SS1.p1.16.m4.1.1.1.1.cmml" xref="S2.SS1.p1.16.m4.1.1.1.1">𝑥</ci></apply></apply><apply id="S2.SS1.p1.16.m4.1.1.3.cmml" xref="S2.SS1.p1.16.m4.1.1.3"><partialdiff id="S2.SS1.p1.16.m4.1.1.3.1.cmml" xref="S2.SS1.p1.16.m4.1.1.3.1"></partialdiff><ci id="S2.SS1.p1.16.m4.1.1.3.2.cmml" xref="S2.SS1.p1.16.m4.1.1.3.2">𝑥</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.16.m4.1c">\det\left(\frac{\partial f(x)}{\partial x}\right)</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.16.m4.1d">roman_det ( divide start_ARG ∂ italic_f ( italic_x ) end_ARG start_ARG ∂ italic_x end_ARG )</annotation></semantics></math> is the determinant of the Jacobian of <math id="S2.SS1.p1.17.m5.1" class="ltx_Math" alttext="f" display="inline"><semantics id="S2.SS1.p1.17.m5.1a"><mi id="S2.SS1.p1.17.m5.1.1" xref="S2.SS1.p1.17.m5.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.17.m5.1b"><ci id="S2.SS1.p1.17.m5.1.1.cmml" xref="S2.SS1.p1.17.m5.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.17.m5.1c">f</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.17.m5.1d">italic_f</annotation></semantics></math>. The main challenges of modeling arbitrary distributions using normalizing flow lie in designing the compositional and invertible transformation <math id="S2.SS1.p1.18.m6.1" class="ltx_Math" alttext="f" display="inline"><semantics id="S2.SS1.p1.18.m6.1a"><mi id="S2.SS1.p1.18.m6.1.1" xref="S2.SS1.p1.18.m6.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.18.m6.1b"><ci id="S2.SS1.p1.18.m6.1.1.cmml" xref="S2.SS1.p1.18.m6.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.18.m6.1c">f</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.18.m6.1d">italic_f</annotation></semantics></math>. Further, the choice of the architectures are restricted by the need for the efficient computation of the determinant of the Jacobian matrix.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S2.SS2.5.1.1" class="ltx_text">II-B</span> </span><span id="S2.SS2.6.2" class="ltx_text ltx_font_italic">RealNVP</span>
</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.10" class="ltx_p">One of the recent innovations in normalizing flow is the use of the real-valued non-volume preserving transformations <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> as the function <math id="S2.SS2.p1.1.m1.1" class="ltx_Math" alttext="f" display="inline"><semantics id="S2.SS2.p1.1.m1.1a"><mi id="S2.SS2.p1.1.m1.1.1" xref="S2.SS2.p1.1.m1.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.1.m1.1b"><ci id="S2.SS2.p1.1.m1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.1.m1.1c">f</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.1.m1.1d">italic_f</annotation></semantics></math>. Effectively, RealNVP is a set of affine coupling layers, one of the possible bijective transformations that can be used to design the composition <math id="S2.SS2.p1.2.m2.1" class="ltx_Math" alttext="f" display="inline"><semantics id="S2.SS2.p1.2.m2.1a"><mi id="S2.SS2.p1.2.m2.1.1" xref="S2.SS2.p1.2.m2.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.2.m2.1b"><ci id="S2.SS2.p1.2.m2.1.1.cmml" xref="S2.SS2.p1.2.m2.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.2.m2.1c">f</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.2.m2.1d">italic_f</annotation></semantics></math>. To explain this further, consider the example of a single layer transformation (several such layers are composed in practice) <math id="S2.SS2.p1.3.m3.1" class="ltx_Math" alttext="Y" display="inline"><semantics id="S2.SS2.p1.3.m3.1a"><mi id="S2.SS2.p1.3.m3.1.1" xref="S2.SS2.p1.3.m3.1.1.cmml">Y</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.3.m3.1b"><ci id="S2.SS2.p1.3.m3.1.1.cmml" xref="S2.SS2.p1.3.m3.1.1">𝑌</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.3.m3.1c">Y</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.3.m3.1d">italic_Y</annotation></semantics></math> that maps <math id="S2.SS2.p1.4.m4.1" class="ltx_Math" alttext="X" display="inline"><semantics id="S2.SS2.p1.4.m4.1a"><mi id="S2.SS2.p1.4.m4.1.1" xref="S2.SS2.p1.4.m4.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.4.m4.1b"><ci id="S2.SS2.p1.4.m4.1.1.cmml" xref="S2.SS2.p1.4.m4.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.4.m4.1c">X</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.4.m4.1d">italic_X</annotation></semantics></math> to <math id="S2.SS2.p1.5.m5.1" class="ltx_Math" alttext="Z" display="inline"><semantics id="S2.SS2.p1.5.m5.1a"><mi id="S2.SS2.p1.5.m5.1.1" xref="S2.SS2.p1.5.m5.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.5.m5.1b"><ci id="S2.SS2.p1.5.m5.1.1.cmml" xref="S2.SS2.p1.5.m5.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.5.m5.1c">Z</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.5.m5.1d">italic_Z</annotation></semantics></math>. RealNVP transformation <math id="S2.SS2.p1.6.m6.1" class="ltx_Math" alttext="Y" display="inline"><semantics id="S2.SS2.p1.6.m6.1a"><mi id="S2.SS2.p1.6.m6.1.1" xref="S2.SS2.p1.6.m6.1.1.cmml">Y</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.6.m6.1b"><ci id="S2.SS2.p1.6.m6.1.1.cmml" xref="S2.SS2.p1.6.m6.1.1">𝑌</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.6.m6.1c">Y</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.6.m6.1d">italic_Y</annotation></semantics></math> partitions <math id="S2.SS2.p1.7.m7.1" class="ltx_Math" alttext="X" display="inline"><semantics id="S2.SS2.p1.7.m7.1a"><mi id="S2.SS2.p1.7.m7.1.1" xref="S2.SS2.p1.7.m7.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.7.m7.1b"><ci id="S2.SS2.p1.7.m7.1.1.cmml" xref="S2.SS2.p1.7.m7.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.7.m7.1c">X</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.7.m7.1d">italic_X</annotation></semantics></math> into two disjoint groups, where the first <math id="S2.SS2.p1.8.m8.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S2.SS2.p1.8.m8.1a"><mi id="S2.SS2.p1.8.m8.1.1" xref="S2.SS2.p1.8.m8.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.8.m8.1b"><ci id="S2.SS2.p1.8.m8.1.1.cmml" xref="S2.SS2.p1.8.m8.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.8.m8.1c">d</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.8.m8.1d">italic_d</annotation></semantics></math> dimensions remain unchanged while the latter part, i.e., from the <math id="S2.SS2.p1.9.m9.1" class="ltx_Math" alttext="d+1" display="inline"><semantics id="S2.SS2.p1.9.m9.1a"><mrow id="S2.SS2.p1.9.m9.1.1" xref="S2.SS2.p1.9.m9.1.1.cmml"><mi id="S2.SS2.p1.9.m9.1.1.2" xref="S2.SS2.p1.9.m9.1.1.2.cmml">d</mi><mo id="S2.SS2.p1.9.m9.1.1.1" xref="S2.SS2.p1.9.m9.1.1.1.cmml">+</mo><mn id="S2.SS2.p1.9.m9.1.1.3" xref="S2.SS2.p1.9.m9.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.9.m9.1b"><apply id="S2.SS2.p1.9.m9.1.1.cmml" xref="S2.SS2.p1.9.m9.1.1"><plus id="S2.SS2.p1.9.m9.1.1.1.cmml" xref="S2.SS2.p1.9.m9.1.1.1"></plus><ci id="S2.SS2.p1.9.m9.1.1.2.cmml" xref="S2.SS2.p1.9.m9.1.1.2">𝑑</ci><cn type="integer" id="S2.SS2.p1.9.m9.1.1.3.cmml" xref="S2.SS2.p1.9.m9.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.9.m9.1c">d+1</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.9.m9.1d">italic_d + 1</annotation></semantics></math>-th to the <math id="S2.SS2.p1.10.m10.1" class="ltx_Math" alttext="D" display="inline"><semantics id="S2.SS2.p1.10.m10.1a"><mi id="S2.SS2.p1.10.m10.1.1" xref="S2.SS2.p1.10.m10.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.10.m10.1b"><ci id="S2.SS2.p1.10.m10.1.1.cmml" xref="S2.SS2.p1.10.m10.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.10.m10.1c">D</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.10.m10.1d">italic_D</annotation></semantics></math>-th dimension, undergoes an affine transformation. Formally,</p>
<table id="A1.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S2.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td colspan="2" class="ltx_td ltx_align_center ltx_eqn_cell"><math id="S2.E2.m1.31" class="ltx_Math" alttext="\displaystyle\begin{split}y^{1:d}&amp;=x^{1:d}\\
y^{d+1:D}&amp;=x^{d+1:D}\odot\exp(s_{net}(x^{1:d}))+t_{net}(x^{1:d})\end{split}" display="inline"><semantics id="S2.E2.m1.31a"><mtable columnspacing="0pt" rowspacing="0pt" id="S2.E2.m1.31.31.4" xref="S2.E2.m1.29.29.2.cmml"><mtr id="S2.E2.m1.31.31.4a" xref="S2.E2.m1.29.29.2.cmml"><mtd class="ltx_align_right" columnalign="right" id="S2.E2.m1.31.31.4b" xref="S2.E2.m1.29.29.2.cmml"><msup id="S2.E2.m1.2.2.2.2.2a" xref="S2.E2.m1.29.29.2.cmml"><mi id="S2.E2.m1.1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.1.cmml">y</mi><mrow id="S2.E2.m1.2.2.2.2.2.2.1" xref="S2.E2.m1.2.2.2.2.2.2.1.cmml"><mn id="S2.E2.m1.2.2.2.2.2.2.1.2" xref="S2.E2.m1.2.2.2.2.2.2.1.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S2.E2.m1.2.2.2.2.2.2.1.1" xref="S2.E2.m1.2.2.2.2.2.2.1.1.cmml">:</mo><mi id="S2.E2.m1.2.2.2.2.2.2.1.3" xref="S2.E2.m1.2.2.2.2.2.2.1.3.cmml">d</mi></mrow></msup></mtd><mtd class="ltx_align_left" columnalign="left" id="S2.E2.m1.31.31.4c" xref="S2.E2.m1.29.29.2.cmml"><mrow id="S2.E2.m1.5.5.5.5.3a" xref="S2.E2.m1.29.29.2.cmml"><mi id="S2.E2.m1.5.5.5.5.3a.4" xref="S2.E2.m1.29.29.2a.cmml"></mi><mo id="S2.E2.m1.3.3.3.3.1.1" xref="S2.E2.m1.3.3.3.3.1.1.cmml">=</mo><msup id="S2.E2.m1.5.5.5.5.3a.5" xref="S2.E2.m1.29.29.2.cmml"><mi id="S2.E2.m1.4.4.4.4.2.2" xref="S2.E2.m1.4.4.4.4.2.2.cmml">x</mi><mrow id="S2.E2.m1.5.5.5.5.3.3.1" xref="S2.E2.m1.5.5.5.5.3.3.1.cmml"><mn id="S2.E2.m1.5.5.5.5.3.3.1.2" xref="S2.E2.m1.5.5.5.5.3.3.1.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S2.E2.m1.5.5.5.5.3.3.1.1" xref="S2.E2.m1.5.5.5.5.3.3.1.1.cmml">:</mo><mi id="S2.E2.m1.5.5.5.5.3.3.1.3" xref="S2.E2.m1.5.5.5.5.3.3.1.3.cmml">d</mi></mrow></msup></mrow></mtd></mtr><mtr id="S2.E2.m1.31.31.4d" xref="S2.E2.m1.29.29.2.cmml"><mtd class="ltx_align_right" columnalign="right" id="S2.E2.m1.31.31.4e" xref="S2.E2.m1.29.29.2.cmml"><msup id="S2.E2.m1.7.7.7.2.2a" xref="S2.E2.m1.29.29.2.cmml"><mi id="S2.E2.m1.6.6.6.1.1.1" xref="S2.E2.m1.6.6.6.1.1.1.cmml">y</mi><mrow id="S2.E2.m1.7.7.7.2.2.2.1" xref="S2.E2.m1.7.7.7.2.2.2.1.cmml"><mrow id="S2.E2.m1.7.7.7.2.2.2.1.2" xref="S2.E2.m1.7.7.7.2.2.2.1.2.cmml"><mi id="S2.E2.m1.7.7.7.2.2.2.1.2.2" xref="S2.E2.m1.7.7.7.2.2.2.1.2.2.cmml">d</mi><mo id="S2.E2.m1.7.7.7.2.2.2.1.2.1" xref="S2.E2.m1.7.7.7.2.2.2.1.2.1.cmml">+</mo><mn id="S2.E2.m1.7.7.7.2.2.2.1.2.3" xref="S2.E2.m1.7.7.7.2.2.2.1.2.3.cmml">1</mn></mrow><mo lspace="0.278em" rspace="0.278em" id="S2.E2.m1.7.7.7.2.2.2.1.1" xref="S2.E2.m1.7.7.7.2.2.2.1.1.cmml">:</mo><mi id="S2.E2.m1.7.7.7.2.2.2.1.3" xref="S2.E2.m1.7.7.7.2.2.2.1.3.cmml">D</mi></mrow></msup></mtd><mtd class="ltx_align_left" columnalign="left" id="S2.E2.m1.31.31.4f" xref="S2.E2.m1.29.29.2.cmml"><mrow id="S2.E2.m1.31.31.4.29.24.22" xref="S2.E2.m1.29.29.2.cmml"><mi id="S2.E2.m1.31.31.4.29.24.22.23" xref="S2.E2.m1.29.29.2a.cmml"></mi><mo id="S2.E2.m1.8.8.8.3.1.1" xref="S2.E2.m1.8.8.8.3.1.1.cmml">=</mo><mrow id="S2.E2.m1.31.31.4.29.24.22.22" xref="S2.E2.m1.29.29.2.cmml"><mrow id="S2.E2.m1.30.30.3.28.23.21.21.1" xref="S2.E2.m1.29.29.2.cmml"><msup id="S2.E2.m1.30.30.3.28.23.21.21.1.2" xref="S2.E2.m1.29.29.2.cmml"><mi id="S2.E2.m1.9.9.9.4.2.2" xref="S2.E2.m1.9.9.9.4.2.2.cmml">x</mi><mrow id="S2.E2.m1.10.10.10.5.3.3.1" xref="S2.E2.m1.10.10.10.5.3.3.1.cmml"><mrow id="S2.E2.m1.10.10.10.5.3.3.1.2" xref="S2.E2.m1.10.10.10.5.3.3.1.2.cmml"><mi id="S2.E2.m1.10.10.10.5.3.3.1.2.2" xref="S2.E2.m1.10.10.10.5.3.3.1.2.2.cmml">d</mi><mo id="S2.E2.m1.10.10.10.5.3.3.1.2.1" xref="S2.E2.m1.10.10.10.5.3.3.1.2.1.cmml">+</mo><mn id="S2.E2.m1.10.10.10.5.3.3.1.2.3" xref="S2.E2.m1.10.10.10.5.3.3.1.2.3.cmml">1</mn></mrow><mo lspace="0.278em" rspace="0.278em" id="S2.E2.m1.10.10.10.5.3.3.1.1" xref="S2.E2.m1.10.10.10.5.3.3.1.1.cmml">:</mo><mi id="S2.E2.m1.10.10.10.5.3.3.1.3" xref="S2.E2.m1.10.10.10.5.3.3.1.3.cmml">D</mi></mrow></msup><mo lspace="0.222em" rspace="0.222em" id="S2.E2.m1.11.11.11.6.4.4" xref="S2.E2.m1.11.11.11.6.4.4.cmml">⊙</mo><mrow id="S2.E2.m1.30.30.3.28.23.21.21.1.1.1" xref="S2.E2.m1.29.29.2.cmml"><mi id="S2.E2.m1.12.12.12.7.5.5" xref="S2.E2.m1.12.12.12.7.5.5.cmml">exp</mi><mo id="S2.E2.m1.30.30.3.28.23.21.21.1.1.1a" xref="S2.E2.m1.29.29.2a.cmml">⁡</mo><mrow id="S2.E2.m1.30.30.3.28.23.21.21.1.1.1.1" xref="S2.E2.m1.29.29.2.cmml"><mo stretchy="false" id="S2.E2.m1.13.13.13.8.6.6" xref="S2.E2.m1.29.29.2a.cmml">(</mo><mrow id="S2.E2.m1.30.30.3.28.23.21.21.1.1.1.1.1" xref="S2.E2.m1.29.29.2.cmml"><msub id="S2.E2.m1.30.30.3.28.23.21.21.1.1.1.1.1.3" xref="S2.E2.m1.29.29.2.cmml"><mi id="S2.E2.m1.14.14.14.9.7.7" xref="S2.E2.m1.14.14.14.9.7.7.cmml">s</mi><mrow id="S2.E2.m1.15.15.15.10.8.8.1" xref="S2.E2.m1.15.15.15.10.8.8.1.cmml"><mi id="S2.E2.m1.15.15.15.10.8.8.1.2" xref="S2.E2.m1.15.15.15.10.8.8.1.2.cmml">n</mi><mo id="S2.E2.m1.15.15.15.10.8.8.1.1" xref="S2.E2.m1.15.15.15.10.8.8.1.1.cmml">⁢</mo><mi id="S2.E2.m1.15.15.15.10.8.8.1.3" xref="S2.E2.m1.15.15.15.10.8.8.1.3.cmml">e</mi><mo id="S2.E2.m1.15.15.15.10.8.8.1.1a" xref="S2.E2.m1.15.15.15.10.8.8.1.1.cmml">⁢</mo><mi id="S2.E2.m1.15.15.15.10.8.8.1.4" xref="S2.E2.m1.15.15.15.10.8.8.1.4.cmml">t</mi></mrow></msub><mo id="S2.E2.m1.30.30.3.28.23.21.21.1.1.1.1.1.2" xref="S2.E2.m1.29.29.2a.cmml">⁢</mo><mrow id="S2.E2.m1.30.30.3.28.23.21.21.1.1.1.1.1.1.1" xref="S2.E2.m1.29.29.2.cmml"><mo stretchy="false" id="S2.E2.m1.16.16.16.11.9.9" xref="S2.E2.m1.29.29.2a.cmml">(</mo><msup id="S2.E2.m1.30.30.3.28.23.21.21.1.1.1.1.1.1.1.1" xref="S2.E2.m1.29.29.2.cmml"><mi id="S2.E2.m1.17.17.17.12.10.10" xref="S2.E2.m1.17.17.17.12.10.10.cmml">x</mi><mrow id="S2.E2.m1.18.18.18.13.11.11.1" xref="S2.E2.m1.18.18.18.13.11.11.1.cmml"><mn id="S2.E2.m1.18.18.18.13.11.11.1.2" xref="S2.E2.m1.18.18.18.13.11.11.1.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S2.E2.m1.18.18.18.13.11.11.1.1" xref="S2.E2.m1.18.18.18.13.11.11.1.1.cmml">:</mo><mi id="S2.E2.m1.18.18.18.13.11.11.1.3" xref="S2.E2.m1.18.18.18.13.11.11.1.3.cmml">d</mi></mrow></msup><mo stretchy="false" id="S2.E2.m1.19.19.19.14.12.12" xref="S2.E2.m1.29.29.2a.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S2.E2.m1.20.20.20.15.13.13" xref="S2.E2.m1.29.29.2a.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E2.m1.21.21.21.16.14.14" xref="S2.E2.m1.21.21.21.16.14.14.cmml">+</mo><mrow id="S2.E2.m1.31.31.4.29.24.22.22.2" xref="S2.E2.m1.29.29.2.cmml"><msub id="S2.E2.m1.31.31.4.29.24.22.22.2.3" xref="S2.E2.m1.29.29.2.cmml"><mi id="S2.E2.m1.22.22.22.17.15.15" xref="S2.E2.m1.22.22.22.17.15.15.cmml">t</mi><mrow id="S2.E2.m1.23.23.23.18.16.16.1" xref="S2.E2.m1.23.23.23.18.16.16.1.cmml"><mi id="S2.E2.m1.23.23.23.18.16.16.1.2" xref="S2.E2.m1.23.23.23.18.16.16.1.2.cmml">n</mi><mo id="S2.E2.m1.23.23.23.18.16.16.1.1" xref="S2.E2.m1.23.23.23.18.16.16.1.1.cmml">⁢</mo><mi id="S2.E2.m1.23.23.23.18.16.16.1.3" xref="S2.E2.m1.23.23.23.18.16.16.1.3.cmml">e</mi><mo id="S2.E2.m1.23.23.23.18.16.16.1.1a" xref="S2.E2.m1.23.23.23.18.16.16.1.1.cmml">⁢</mo><mi id="S2.E2.m1.23.23.23.18.16.16.1.4" xref="S2.E2.m1.23.23.23.18.16.16.1.4.cmml">t</mi></mrow></msub><mo id="S2.E2.m1.31.31.4.29.24.22.22.2.2" xref="S2.E2.m1.29.29.2a.cmml">⁢</mo><mrow id="S2.E2.m1.31.31.4.29.24.22.22.2.1.1" xref="S2.E2.m1.29.29.2.cmml"><mo stretchy="false" id="S2.E2.m1.24.24.24.19.17.17" xref="S2.E2.m1.29.29.2a.cmml">(</mo><msup id="S2.E2.m1.31.31.4.29.24.22.22.2.1.1.1" xref="S2.E2.m1.29.29.2.cmml"><mi id="S2.E2.m1.25.25.25.20.18.18" xref="S2.E2.m1.25.25.25.20.18.18.cmml">x</mi><mrow id="S2.E2.m1.26.26.26.21.19.19.1" xref="S2.E2.m1.26.26.26.21.19.19.1.cmml"><mn id="S2.E2.m1.26.26.26.21.19.19.1.2" xref="S2.E2.m1.26.26.26.21.19.19.1.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S2.E2.m1.26.26.26.21.19.19.1.1" xref="S2.E2.m1.26.26.26.21.19.19.1.1.cmml">:</mo><mi id="S2.E2.m1.26.26.26.21.19.19.1.3" xref="S2.E2.m1.26.26.26.21.19.19.1.3.cmml">d</mi></mrow></msup><mo stretchy="false" id="S2.E2.m1.27.27.27.22.20.20" xref="S2.E2.m1.29.29.2a.cmml">)</mo></mrow></mrow></mrow></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S2.E2.m1.31b"><apply id="S2.E2.m1.29.29.2.cmml" xref="S2.E2.m1.31.31.4"><and id="S2.E2.m1.29.29.2a.cmml" xref="S2.E2.m1.5.5.5.5.3a.4"></and><apply id="S2.E2.m1.29.29.2b.cmml" xref="S2.E2.m1.31.31.4"><eq id="S2.E2.m1.3.3.3.3.1.1.cmml" xref="S2.E2.m1.3.3.3.3.1.1"></eq><apply id="S2.E2.m1.29.29.2.4.cmml" xref="S2.E2.m1.31.31.4"><csymbol cd="ambiguous" id="S2.E2.m1.29.29.2.4.1.cmml" xref="S2.E2.m1.5.5.5.5.3a.4">superscript</csymbol><ci id="S2.E2.m1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1">𝑦</ci><apply id="S2.E2.m1.2.2.2.2.2.2.1.cmml" xref="S2.E2.m1.2.2.2.2.2.2.1"><ci id="S2.E2.m1.2.2.2.2.2.2.1.1.cmml" xref="S2.E2.m1.2.2.2.2.2.2.1.1">:</ci><cn type="integer" id="S2.E2.m1.2.2.2.2.2.2.1.2.cmml" xref="S2.E2.m1.2.2.2.2.2.2.1.2">1</cn><ci id="S2.E2.m1.2.2.2.2.2.2.1.3.cmml" xref="S2.E2.m1.2.2.2.2.2.2.1.3">𝑑</ci></apply></apply><apply id="S2.E2.m1.29.29.2.6.cmml" xref="S2.E2.m1.31.31.4"><times id="S2.E2.m1.29.29.2.6.1.cmml" xref="S2.E2.m1.5.5.5.5.3a.4"></times><apply id="S2.E2.m1.29.29.2.6.2.cmml" xref="S2.E2.m1.31.31.4"><csymbol cd="ambiguous" id="S2.E2.m1.29.29.2.6.2.1.cmml" xref="S2.E2.m1.5.5.5.5.3a.4">superscript</csymbol><ci id="S2.E2.m1.4.4.4.4.2.2.cmml" xref="S2.E2.m1.4.4.4.4.2.2">𝑥</ci><apply id="S2.E2.m1.5.5.5.5.3.3.1.cmml" xref="S2.E2.m1.5.5.5.5.3.3.1"><ci id="S2.E2.m1.5.5.5.5.3.3.1.1.cmml" xref="S2.E2.m1.5.5.5.5.3.3.1.1">:</ci><cn type="integer" id="S2.E2.m1.5.5.5.5.3.3.1.2.cmml" xref="S2.E2.m1.5.5.5.5.3.3.1.2">1</cn><ci id="S2.E2.m1.5.5.5.5.3.3.1.3.cmml" xref="S2.E2.m1.5.5.5.5.3.3.1.3">𝑑</ci></apply></apply><apply id="S2.E2.m1.29.29.2.6.3.cmml" xref="S2.E2.m1.31.31.4"><csymbol cd="ambiguous" id="S2.E2.m1.29.29.2.6.3.1.cmml" xref="S2.E2.m1.5.5.5.5.3a.4">superscript</csymbol><ci id="S2.E2.m1.6.6.6.1.1.1.cmml" xref="S2.E2.m1.6.6.6.1.1.1">𝑦</ci><apply id="S2.E2.m1.7.7.7.2.2.2.1.cmml" xref="S2.E2.m1.7.7.7.2.2.2.1"><ci id="S2.E2.m1.7.7.7.2.2.2.1.1.cmml" xref="S2.E2.m1.7.7.7.2.2.2.1.1">:</ci><apply id="S2.E2.m1.7.7.7.2.2.2.1.2.cmml" xref="S2.E2.m1.7.7.7.2.2.2.1.2"><plus id="S2.E2.m1.7.7.7.2.2.2.1.2.1.cmml" xref="S2.E2.m1.7.7.7.2.2.2.1.2.1"></plus><ci id="S2.E2.m1.7.7.7.2.2.2.1.2.2.cmml" xref="S2.E2.m1.7.7.7.2.2.2.1.2.2">𝑑</ci><cn type="integer" id="S2.E2.m1.7.7.7.2.2.2.1.2.3.cmml" xref="S2.E2.m1.7.7.7.2.2.2.1.2.3">1</cn></apply><ci id="S2.E2.m1.7.7.7.2.2.2.1.3.cmml" xref="S2.E2.m1.7.7.7.2.2.2.1.3">𝐷</ci></apply></apply></apply></apply><apply id="S2.E2.m1.29.29.2c.cmml" xref="S2.E2.m1.31.31.4"><eq id="S2.E2.m1.8.8.8.3.1.1.cmml" xref="S2.E2.m1.8.8.8.3.1.1"></eq><share href="#S2.E2.m1.29.29.2.6.cmml" id="S2.E2.m1.29.29.2d.cmml" xref="S2.E2.m1.5.5.5.5.3a.4"></share><apply id="S2.E2.m1.29.29.2.2.cmml" xref="S2.E2.m1.31.31.4"><plus id="S2.E2.m1.21.21.21.16.14.14.cmml" xref="S2.E2.m1.21.21.21.16.14.14"></plus><apply id="S2.E2.m1.28.28.1.1.1.cmml" xref="S2.E2.m1.31.31.4"><csymbol cd="latexml" id="S2.E2.m1.11.11.11.6.4.4.cmml" xref="S2.E2.m1.11.11.11.6.4.4">direct-product</csymbol><apply id="S2.E2.m1.28.28.1.1.1.3.cmml" xref="S2.E2.m1.31.31.4"><csymbol cd="ambiguous" id="S2.E2.m1.28.28.1.1.1.3.1.cmml" xref="S2.E2.m1.5.5.5.5.3a.4">superscript</csymbol><ci id="S2.E2.m1.9.9.9.4.2.2.cmml" xref="S2.E2.m1.9.9.9.4.2.2">𝑥</ci><apply id="S2.E2.m1.10.10.10.5.3.3.1.cmml" xref="S2.E2.m1.10.10.10.5.3.3.1"><ci id="S2.E2.m1.10.10.10.5.3.3.1.1.cmml" xref="S2.E2.m1.10.10.10.5.3.3.1.1">:</ci><apply id="S2.E2.m1.10.10.10.5.3.3.1.2.cmml" xref="S2.E2.m1.10.10.10.5.3.3.1.2"><plus id="S2.E2.m1.10.10.10.5.3.3.1.2.1.cmml" xref="S2.E2.m1.10.10.10.5.3.3.1.2.1"></plus><ci id="S2.E2.m1.10.10.10.5.3.3.1.2.2.cmml" xref="S2.E2.m1.10.10.10.5.3.3.1.2.2">𝑑</ci><cn type="integer" id="S2.E2.m1.10.10.10.5.3.3.1.2.3.cmml" xref="S2.E2.m1.10.10.10.5.3.3.1.2.3">1</cn></apply><ci id="S2.E2.m1.10.10.10.5.3.3.1.3.cmml" xref="S2.E2.m1.10.10.10.5.3.3.1.3">𝐷</ci></apply></apply><apply id="S2.E2.m1.28.28.1.1.1.1.2.cmml" xref="S2.E2.m1.31.31.4"><exp id="S2.E2.m1.12.12.12.7.5.5.cmml" xref="S2.E2.m1.12.12.12.7.5.5"></exp><apply id="S2.E2.m1.28.28.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.31.31.4"><times id="S2.E2.m1.28.28.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.31.31.4"></times><apply id="S2.E2.m1.28.28.1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.31.31.4"><csymbol cd="ambiguous" id="S2.E2.m1.28.28.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E2.m1.31.31.4">subscript</csymbol><ci id="S2.E2.m1.14.14.14.9.7.7.cmml" xref="S2.E2.m1.14.14.14.9.7.7">𝑠</ci><apply id="S2.E2.m1.15.15.15.10.8.8.1.cmml" xref="S2.E2.m1.15.15.15.10.8.8.1"><times id="S2.E2.m1.15.15.15.10.8.8.1.1.cmml" xref="S2.E2.m1.15.15.15.10.8.8.1.1"></times><ci id="S2.E2.m1.15.15.15.10.8.8.1.2.cmml" xref="S2.E2.m1.15.15.15.10.8.8.1.2">𝑛</ci><ci id="S2.E2.m1.15.15.15.10.8.8.1.3.cmml" xref="S2.E2.m1.15.15.15.10.8.8.1.3">𝑒</ci><ci id="S2.E2.m1.15.15.15.10.8.8.1.4.cmml" xref="S2.E2.m1.15.15.15.10.8.8.1.4">𝑡</ci></apply></apply><apply id="S2.E2.m1.28.28.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.31.31.4"><csymbol cd="ambiguous" id="S2.E2.m1.28.28.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.31.31.4">superscript</csymbol><ci id="S2.E2.m1.17.17.17.12.10.10.cmml" xref="S2.E2.m1.17.17.17.12.10.10">𝑥</ci><apply id="S2.E2.m1.18.18.18.13.11.11.1.cmml" xref="S2.E2.m1.18.18.18.13.11.11.1"><ci id="S2.E2.m1.18.18.18.13.11.11.1.1.cmml" xref="S2.E2.m1.18.18.18.13.11.11.1.1">:</ci><cn type="integer" id="S2.E2.m1.18.18.18.13.11.11.1.2.cmml" xref="S2.E2.m1.18.18.18.13.11.11.1.2">1</cn><ci id="S2.E2.m1.18.18.18.13.11.11.1.3.cmml" xref="S2.E2.m1.18.18.18.13.11.11.1.3">𝑑</ci></apply></apply></apply></apply></apply><apply id="S2.E2.m1.29.29.2.2.2.cmml" xref="S2.E2.m1.31.31.4"><times id="S2.E2.m1.29.29.2.2.2.2.cmml" xref="S2.E2.m1.5.5.5.5.3a.4"></times><apply id="S2.E2.m1.29.29.2.2.2.3.cmml" xref="S2.E2.m1.31.31.4"><csymbol cd="ambiguous" id="S2.E2.m1.29.29.2.2.2.3.1.cmml" xref="S2.E2.m1.5.5.5.5.3a.4">subscript</csymbol><ci id="S2.E2.m1.22.22.22.17.15.15.cmml" xref="S2.E2.m1.22.22.22.17.15.15">𝑡</ci><apply id="S2.E2.m1.23.23.23.18.16.16.1.cmml" xref="S2.E2.m1.23.23.23.18.16.16.1"><times id="S2.E2.m1.23.23.23.18.16.16.1.1.cmml" xref="S2.E2.m1.23.23.23.18.16.16.1.1"></times><ci id="S2.E2.m1.23.23.23.18.16.16.1.2.cmml" xref="S2.E2.m1.23.23.23.18.16.16.1.2">𝑛</ci><ci id="S2.E2.m1.23.23.23.18.16.16.1.3.cmml" xref="S2.E2.m1.23.23.23.18.16.16.1.3">𝑒</ci><ci id="S2.E2.m1.23.23.23.18.16.16.1.4.cmml" xref="S2.E2.m1.23.23.23.18.16.16.1.4">𝑡</ci></apply></apply><apply id="S2.E2.m1.29.29.2.2.2.1.1.1.cmml" xref="S2.E2.m1.31.31.4"><csymbol cd="ambiguous" id="S2.E2.m1.29.29.2.2.2.1.1.1.1.cmml" xref="S2.E2.m1.31.31.4">superscript</csymbol><ci id="S2.E2.m1.25.25.25.20.18.18.cmml" xref="S2.E2.m1.25.25.25.20.18.18">𝑥</ci><apply id="S2.E2.m1.26.26.26.21.19.19.1.cmml" xref="S2.E2.m1.26.26.26.21.19.19.1"><ci id="S2.E2.m1.26.26.26.21.19.19.1.1.cmml" xref="S2.E2.m1.26.26.26.21.19.19.1.1">:</ci><cn type="integer" id="S2.E2.m1.26.26.26.21.19.19.1.2.cmml" xref="S2.E2.m1.26.26.26.21.19.19.1.2">1</cn><ci id="S2.E2.m1.26.26.26.21.19.19.1.3.cmml" xref="S2.E2.m1.26.26.26.21.19.19.1.3">𝑑</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.31c">\displaystyle\begin{split}y^{1:d}&amp;=x^{1:d}\\
y^{d+1:D}&amp;=x^{d+1:D}\odot\exp(s_{net}(x^{1:d}))+t_{net}(x^{1:d})\end{split}</annotation><annotation encoding="application/x-llamapun" id="S2.E2.m1.31d">start_ROW start_CELL italic_y start_POSTSUPERSCRIPT 1 : italic_d end_POSTSUPERSCRIPT end_CELL start_CELL = italic_x start_POSTSUPERSCRIPT 1 : italic_d end_POSTSUPERSCRIPT end_CELL end_ROW start_ROW start_CELL italic_y start_POSTSUPERSCRIPT italic_d + 1 : italic_D end_POSTSUPERSCRIPT end_CELL start_CELL = italic_x start_POSTSUPERSCRIPT italic_d + 1 : italic_D end_POSTSUPERSCRIPT ⊙ roman_exp ( italic_s start_POSTSUBSCRIPT italic_n italic_e italic_t end_POSTSUBSCRIPT ( italic_x start_POSTSUPERSCRIPT 1 : italic_d end_POSTSUPERSCRIPT ) ) + italic_t start_POSTSUBSCRIPT italic_n italic_e italic_t end_POSTSUBSCRIPT ( italic_x start_POSTSUPERSCRIPT 1 : italic_d end_POSTSUPERSCRIPT ) end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S2.SS2.p1.17" class="ltx_p"><math id="S2.SS2.p1.11.m1.1" class="ltx_Math" alttext="s_{net}" display="inline"><semantics id="S2.SS2.p1.11.m1.1a"><msub id="S2.SS2.p1.11.m1.1.1" xref="S2.SS2.p1.11.m1.1.1.cmml"><mi id="S2.SS2.p1.11.m1.1.1.2" xref="S2.SS2.p1.11.m1.1.1.2.cmml">s</mi><mrow id="S2.SS2.p1.11.m1.1.1.3" xref="S2.SS2.p1.11.m1.1.1.3.cmml"><mi id="S2.SS2.p1.11.m1.1.1.3.2" xref="S2.SS2.p1.11.m1.1.1.3.2.cmml">n</mi><mo id="S2.SS2.p1.11.m1.1.1.3.1" xref="S2.SS2.p1.11.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.SS2.p1.11.m1.1.1.3.3" xref="S2.SS2.p1.11.m1.1.1.3.3.cmml">e</mi><mo id="S2.SS2.p1.11.m1.1.1.3.1a" xref="S2.SS2.p1.11.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.SS2.p1.11.m1.1.1.3.4" xref="S2.SS2.p1.11.m1.1.1.3.4.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.11.m1.1b"><apply id="S2.SS2.p1.11.m1.1.1.cmml" xref="S2.SS2.p1.11.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.11.m1.1.1.1.cmml" xref="S2.SS2.p1.11.m1.1.1">subscript</csymbol><ci id="S2.SS2.p1.11.m1.1.1.2.cmml" xref="S2.SS2.p1.11.m1.1.1.2">𝑠</ci><apply id="S2.SS2.p1.11.m1.1.1.3.cmml" xref="S2.SS2.p1.11.m1.1.1.3"><times id="S2.SS2.p1.11.m1.1.1.3.1.cmml" xref="S2.SS2.p1.11.m1.1.1.3.1"></times><ci id="S2.SS2.p1.11.m1.1.1.3.2.cmml" xref="S2.SS2.p1.11.m1.1.1.3.2">𝑛</ci><ci id="S2.SS2.p1.11.m1.1.1.3.3.cmml" xref="S2.SS2.p1.11.m1.1.1.3.3">𝑒</ci><ci id="S2.SS2.p1.11.m1.1.1.3.4.cmml" xref="S2.SS2.p1.11.m1.1.1.3.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.11.m1.1c">s_{net}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.11.m1.1d">italic_s start_POSTSUBSCRIPT italic_n italic_e italic_t end_POSTSUBSCRIPT</annotation></semantics></math> and <math id="S2.SS2.p1.12.m2.1" class="ltx_Math" alttext="t_{net}" display="inline"><semantics id="S2.SS2.p1.12.m2.1a"><msub id="S2.SS2.p1.12.m2.1.1" xref="S2.SS2.p1.12.m2.1.1.cmml"><mi id="S2.SS2.p1.12.m2.1.1.2" xref="S2.SS2.p1.12.m2.1.1.2.cmml">t</mi><mrow id="S2.SS2.p1.12.m2.1.1.3" xref="S2.SS2.p1.12.m2.1.1.3.cmml"><mi id="S2.SS2.p1.12.m2.1.1.3.2" xref="S2.SS2.p1.12.m2.1.1.3.2.cmml">n</mi><mo id="S2.SS2.p1.12.m2.1.1.3.1" xref="S2.SS2.p1.12.m2.1.1.3.1.cmml">⁢</mo><mi id="S2.SS2.p1.12.m2.1.1.3.3" xref="S2.SS2.p1.12.m2.1.1.3.3.cmml">e</mi><mo id="S2.SS2.p1.12.m2.1.1.3.1a" xref="S2.SS2.p1.12.m2.1.1.3.1.cmml">⁢</mo><mi id="S2.SS2.p1.12.m2.1.1.3.4" xref="S2.SS2.p1.12.m2.1.1.3.4.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.12.m2.1b"><apply id="S2.SS2.p1.12.m2.1.1.cmml" xref="S2.SS2.p1.12.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.12.m2.1.1.1.cmml" xref="S2.SS2.p1.12.m2.1.1">subscript</csymbol><ci id="S2.SS2.p1.12.m2.1.1.2.cmml" xref="S2.SS2.p1.12.m2.1.1.2">𝑡</ci><apply id="S2.SS2.p1.12.m2.1.1.3.cmml" xref="S2.SS2.p1.12.m2.1.1.3"><times id="S2.SS2.p1.12.m2.1.1.3.1.cmml" xref="S2.SS2.p1.12.m2.1.1.3.1"></times><ci id="S2.SS2.p1.12.m2.1.1.3.2.cmml" xref="S2.SS2.p1.12.m2.1.1.3.2">𝑛</ci><ci id="S2.SS2.p1.12.m2.1.1.3.3.cmml" xref="S2.SS2.p1.12.m2.1.1.3.3">𝑒</ci><ci id="S2.SS2.p1.12.m2.1.1.3.4.cmml" xref="S2.SS2.p1.12.m2.1.1.3.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.12.m2.1c">t_{net}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.12.m2.1d">italic_t start_POSTSUBSCRIPT italic_n italic_e italic_t end_POSTSUBSCRIPT</annotation></semantics></math> indicate a “scale” and a “translation” function respectively and <math id="S2.SS2.p1.13.m3.1" class="ltx_Math" alttext="\odot" display="inline"><semantics id="S2.SS2.p1.13.m3.1a"><mo id="S2.SS2.p1.13.m3.1.1" xref="S2.SS2.p1.13.m3.1.1.cmml">⊙</mo><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.13.m3.1b"><csymbol cd="latexml" id="S2.SS2.p1.13.m3.1.1.cmml" xref="S2.SS2.p1.13.m3.1.1">direct-product</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.13.m3.1c">\odot</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.13.m3.1d">⊙</annotation></semantics></math> stands for element-wise product. The representation power of RealNVP depends on <math id="S2.SS2.p1.14.m4.1" class="ltx_Math" alttext="s_{net}" display="inline"><semantics id="S2.SS2.p1.14.m4.1a"><msub id="S2.SS2.p1.14.m4.1.1" xref="S2.SS2.p1.14.m4.1.1.cmml"><mi id="S2.SS2.p1.14.m4.1.1.2" xref="S2.SS2.p1.14.m4.1.1.2.cmml">s</mi><mrow id="S2.SS2.p1.14.m4.1.1.3" xref="S2.SS2.p1.14.m4.1.1.3.cmml"><mi id="S2.SS2.p1.14.m4.1.1.3.2" xref="S2.SS2.p1.14.m4.1.1.3.2.cmml">n</mi><mo id="S2.SS2.p1.14.m4.1.1.3.1" xref="S2.SS2.p1.14.m4.1.1.3.1.cmml">⁢</mo><mi id="S2.SS2.p1.14.m4.1.1.3.3" xref="S2.SS2.p1.14.m4.1.1.3.3.cmml">e</mi><mo id="S2.SS2.p1.14.m4.1.1.3.1a" xref="S2.SS2.p1.14.m4.1.1.3.1.cmml">⁢</mo><mi id="S2.SS2.p1.14.m4.1.1.3.4" xref="S2.SS2.p1.14.m4.1.1.3.4.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.14.m4.1b"><apply id="S2.SS2.p1.14.m4.1.1.cmml" xref="S2.SS2.p1.14.m4.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.14.m4.1.1.1.cmml" xref="S2.SS2.p1.14.m4.1.1">subscript</csymbol><ci id="S2.SS2.p1.14.m4.1.1.2.cmml" xref="S2.SS2.p1.14.m4.1.1.2">𝑠</ci><apply id="S2.SS2.p1.14.m4.1.1.3.cmml" xref="S2.SS2.p1.14.m4.1.1.3"><times id="S2.SS2.p1.14.m4.1.1.3.1.cmml" xref="S2.SS2.p1.14.m4.1.1.3.1"></times><ci id="S2.SS2.p1.14.m4.1.1.3.2.cmml" xref="S2.SS2.p1.14.m4.1.1.3.2">𝑛</ci><ci id="S2.SS2.p1.14.m4.1.1.3.3.cmml" xref="S2.SS2.p1.14.m4.1.1.3.3">𝑒</ci><ci id="S2.SS2.p1.14.m4.1.1.3.4.cmml" xref="S2.SS2.p1.14.m4.1.1.3.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.14.m4.1c">s_{net}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.14.m4.1d">italic_s start_POSTSUBSCRIPT italic_n italic_e italic_t end_POSTSUBSCRIPT</annotation></semantics></math> and <math id="S2.SS2.p1.15.m5.1" class="ltx_Math" alttext="t_{net}" display="inline"><semantics id="S2.SS2.p1.15.m5.1a"><msub id="S2.SS2.p1.15.m5.1.1" xref="S2.SS2.p1.15.m5.1.1.cmml"><mi id="S2.SS2.p1.15.m5.1.1.2" xref="S2.SS2.p1.15.m5.1.1.2.cmml">t</mi><mrow id="S2.SS2.p1.15.m5.1.1.3" xref="S2.SS2.p1.15.m5.1.1.3.cmml"><mi id="S2.SS2.p1.15.m5.1.1.3.2" xref="S2.SS2.p1.15.m5.1.1.3.2.cmml">n</mi><mo id="S2.SS2.p1.15.m5.1.1.3.1" xref="S2.SS2.p1.15.m5.1.1.3.1.cmml">⁢</mo><mi id="S2.SS2.p1.15.m5.1.1.3.3" xref="S2.SS2.p1.15.m5.1.1.3.3.cmml">e</mi><mo id="S2.SS2.p1.15.m5.1.1.3.1a" xref="S2.SS2.p1.15.m5.1.1.3.1.cmml">⁢</mo><mi id="S2.SS2.p1.15.m5.1.1.3.4" xref="S2.SS2.p1.15.m5.1.1.3.4.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.15.m5.1b"><apply id="S2.SS2.p1.15.m5.1.1.cmml" xref="S2.SS2.p1.15.m5.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.15.m5.1.1.1.cmml" xref="S2.SS2.p1.15.m5.1.1">subscript</csymbol><ci id="S2.SS2.p1.15.m5.1.1.2.cmml" xref="S2.SS2.p1.15.m5.1.1.2">𝑡</ci><apply id="S2.SS2.p1.15.m5.1.1.3.cmml" xref="S2.SS2.p1.15.m5.1.1.3"><times id="S2.SS2.p1.15.m5.1.1.3.1.cmml" xref="S2.SS2.p1.15.m5.1.1.3.1"></times><ci id="S2.SS2.p1.15.m5.1.1.3.2.cmml" xref="S2.SS2.p1.15.m5.1.1.3.2">𝑛</ci><ci id="S2.SS2.p1.15.m5.1.1.3.3.cmml" xref="S2.SS2.p1.15.m5.1.1.3.3">𝑒</ci><ci id="S2.SS2.p1.15.m5.1.1.3.4.cmml" xref="S2.SS2.p1.15.m5.1.1.3.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.15.m5.1c">t_{net}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.15.m5.1d">italic_t start_POSTSUBSCRIPT italic_n italic_e italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, which can be any arbitrarily complex function (often a neural network architecture). Note that because the first <math id="S2.SS2.p1.16.m6.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S2.SS2.p1.16.m6.1a"><mi id="S2.SS2.p1.16.m6.1.1" xref="S2.SS2.p1.16.m6.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.16.m6.1b"><ci id="S2.SS2.p1.16.m6.1.1.cmml" xref="S2.SS2.p1.16.m6.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.16.m6.1c">d</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.16.m6.1d">italic_d</annotation></semantics></math> dimensions remain unchanged during transformation, to make the flow model capture the full picture of input space, RealNVP swaps active and inactive dimensions in an alternating manner. A convenient way to realize this is to multiply the <math id="S2.SS2.p1.17.m7.1" class="ltx_Math" alttext="D" display="inline"><semantics id="S2.SS2.p1.17.m7.1a"><mi id="S2.SS2.p1.17.m7.1.1" xref="S2.SS2.p1.17.m7.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.17.m7.1b"><ci id="S2.SS2.p1.17.m7.1.1.cmml" xref="S2.SS2.p1.17.m7.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.17.m7.1c">D</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.17.m7.1d">italic_D</annotation></semantics></math> dimensional inputs and outputs with a binary mask vector.
</p>
</div>
<div id="S2.SS2.p2" class="ltx_para">
<p id="S2.SS2.p2.4" class="ltx_p">RealNVP guarantees its computation of Jacobian function is efficient because the Jacobian is a block-triangular matrix, where elements on the diagonal are an identity matrix and a diagonal matrix whose diagonal elements correspond to the vector <math id="S2.SS2.p2.1.m1.2" class="ltx_Math" alttext="\exp\left(s_{net}(x^{1:d})\right)" display="inline"><semantics id="S2.SS2.p2.1.m1.2a"><mrow id="S2.SS2.p2.1.m1.2.2.1" xref="S2.SS2.p2.1.m1.2.2.2.cmml"><mi id="S2.SS2.p2.1.m1.1.1" xref="S2.SS2.p2.1.m1.1.1.cmml">exp</mi><mo id="S2.SS2.p2.1.m1.2.2.1a" xref="S2.SS2.p2.1.m1.2.2.2.cmml">⁡</mo><mrow id="S2.SS2.p2.1.m1.2.2.1.1" xref="S2.SS2.p2.1.m1.2.2.2.cmml"><mo id="S2.SS2.p2.1.m1.2.2.1.1.2" xref="S2.SS2.p2.1.m1.2.2.2.cmml">(</mo><mrow id="S2.SS2.p2.1.m1.2.2.1.1.1" xref="S2.SS2.p2.1.m1.2.2.1.1.1.cmml"><msub id="S2.SS2.p2.1.m1.2.2.1.1.1.3" xref="S2.SS2.p2.1.m1.2.2.1.1.1.3.cmml"><mi id="S2.SS2.p2.1.m1.2.2.1.1.1.3.2" xref="S2.SS2.p2.1.m1.2.2.1.1.1.3.2.cmml">s</mi><mrow id="S2.SS2.p2.1.m1.2.2.1.1.1.3.3" xref="S2.SS2.p2.1.m1.2.2.1.1.1.3.3.cmml"><mi id="S2.SS2.p2.1.m1.2.2.1.1.1.3.3.2" xref="S2.SS2.p2.1.m1.2.2.1.1.1.3.3.2.cmml">n</mi><mo id="S2.SS2.p2.1.m1.2.2.1.1.1.3.3.1" xref="S2.SS2.p2.1.m1.2.2.1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.SS2.p2.1.m1.2.2.1.1.1.3.3.3" xref="S2.SS2.p2.1.m1.2.2.1.1.1.3.3.3.cmml">e</mi><mo id="S2.SS2.p2.1.m1.2.2.1.1.1.3.3.1a" xref="S2.SS2.p2.1.m1.2.2.1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.SS2.p2.1.m1.2.2.1.1.1.3.3.4" xref="S2.SS2.p2.1.m1.2.2.1.1.1.3.3.4.cmml">t</mi></mrow></msub><mo id="S2.SS2.p2.1.m1.2.2.1.1.1.2" xref="S2.SS2.p2.1.m1.2.2.1.1.1.2.cmml">⁢</mo><mrow id="S2.SS2.p2.1.m1.2.2.1.1.1.1.1" xref="S2.SS2.p2.1.m1.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS2.p2.1.m1.2.2.1.1.1.1.1.2" xref="S2.SS2.p2.1.m1.2.2.1.1.1.1.1.1.cmml">(</mo><msup id="S2.SS2.p2.1.m1.2.2.1.1.1.1.1.1" xref="S2.SS2.p2.1.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S2.SS2.p2.1.m1.2.2.1.1.1.1.1.1.2" xref="S2.SS2.p2.1.m1.2.2.1.1.1.1.1.1.2.cmml">x</mi><mrow id="S2.SS2.p2.1.m1.2.2.1.1.1.1.1.1.3" xref="S2.SS2.p2.1.m1.2.2.1.1.1.1.1.1.3.cmml"><mn id="S2.SS2.p2.1.m1.2.2.1.1.1.1.1.1.3.2" xref="S2.SS2.p2.1.m1.2.2.1.1.1.1.1.1.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S2.SS2.p2.1.m1.2.2.1.1.1.1.1.1.3.1" xref="S2.SS2.p2.1.m1.2.2.1.1.1.1.1.1.3.1.cmml">:</mo><mi id="S2.SS2.p2.1.m1.2.2.1.1.1.1.1.1.3.3" xref="S2.SS2.p2.1.m1.2.2.1.1.1.1.1.1.3.3.cmml">d</mi></mrow></msup><mo stretchy="false" id="S2.SS2.p2.1.m1.2.2.1.1.1.1.1.3" xref="S2.SS2.p2.1.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.SS2.p2.1.m1.2.2.1.1.3" xref="S2.SS2.p2.1.m1.2.2.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.1.m1.2b"><apply id="S2.SS2.p2.1.m1.2.2.2.cmml" xref="S2.SS2.p2.1.m1.2.2.1"><exp id="S2.SS2.p2.1.m1.1.1.cmml" xref="S2.SS2.p2.1.m1.1.1"></exp><apply id="S2.SS2.p2.1.m1.2.2.1.1.1.cmml" xref="S2.SS2.p2.1.m1.2.2.1.1.1"><times id="S2.SS2.p2.1.m1.2.2.1.1.1.2.cmml" xref="S2.SS2.p2.1.m1.2.2.1.1.1.2"></times><apply id="S2.SS2.p2.1.m1.2.2.1.1.1.3.cmml" xref="S2.SS2.p2.1.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p2.1.m1.2.2.1.1.1.3.1.cmml" xref="S2.SS2.p2.1.m1.2.2.1.1.1.3">subscript</csymbol><ci id="S2.SS2.p2.1.m1.2.2.1.1.1.3.2.cmml" xref="S2.SS2.p2.1.m1.2.2.1.1.1.3.2">𝑠</ci><apply id="S2.SS2.p2.1.m1.2.2.1.1.1.3.3.cmml" xref="S2.SS2.p2.1.m1.2.2.1.1.1.3.3"><times id="S2.SS2.p2.1.m1.2.2.1.1.1.3.3.1.cmml" xref="S2.SS2.p2.1.m1.2.2.1.1.1.3.3.1"></times><ci id="S2.SS2.p2.1.m1.2.2.1.1.1.3.3.2.cmml" xref="S2.SS2.p2.1.m1.2.2.1.1.1.3.3.2">𝑛</ci><ci id="S2.SS2.p2.1.m1.2.2.1.1.1.3.3.3.cmml" xref="S2.SS2.p2.1.m1.2.2.1.1.1.3.3.3">𝑒</ci><ci id="S2.SS2.p2.1.m1.2.2.1.1.1.3.3.4.cmml" xref="S2.SS2.p2.1.m1.2.2.1.1.1.3.3.4">𝑡</ci></apply></apply><apply id="S2.SS2.p2.1.m1.2.2.1.1.1.1.1.1.cmml" xref="S2.SS2.p2.1.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.1.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p2.1.m1.2.2.1.1.1.1.1">superscript</csymbol><ci id="S2.SS2.p2.1.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S2.SS2.p2.1.m1.2.2.1.1.1.1.1.1.2">𝑥</ci><apply id="S2.SS2.p2.1.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S2.SS2.p2.1.m1.2.2.1.1.1.1.1.1.3"><ci id="S2.SS2.p2.1.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="S2.SS2.p2.1.m1.2.2.1.1.1.1.1.1.3.1">:</ci><cn type="integer" id="S2.SS2.p2.1.m1.2.2.1.1.1.1.1.1.3.2.cmml" xref="S2.SS2.p2.1.m1.2.2.1.1.1.1.1.1.3.2">1</cn><ci id="S2.SS2.p2.1.m1.2.2.1.1.1.1.1.1.3.3.cmml" xref="S2.SS2.p2.1.m1.2.2.1.1.1.1.1.1.3.3">𝑑</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.1.m1.2c">\exp\left(s_{net}(x^{1:d})\right)</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.1.m1.2d">roman_exp ( italic_s start_POSTSUBSCRIPT italic_n italic_e italic_t end_POSTSUBSCRIPT ( italic_x start_POSTSUPERSCRIPT 1 : italic_d end_POSTSUPERSCRIPT ) )</annotation></semantics></math>. Therefore, the determinant of Jacobian, which simplifies to <math id="S2.SS2.p2.2.m2.2" class="ltx_Math" alttext="\exp(\sum_{j}(s_{net}(x^{1:d})_{j}))" display="inline"><semantics id="S2.SS2.p2.2.m2.2a"><mrow id="S2.SS2.p2.2.m2.2.2.1" xref="S2.SS2.p2.2.m2.2.2.2.cmml"><mi id="S2.SS2.p2.2.m2.1.1" xref="S2.SS2.p2.2.m2.1.1.cmml">exp</mi><mo id="S2.SS2.p2.2.m2.2.2.1a" xref="S2.SS2.p2.2.m2.2.2.2.cmml">⁡</mo><mrow id="S2.SS2.p2.2.m2.2.2.1.1" xref="S2.SS2.p2.2.m2.2.2.2.cmml"><mo stretchy="false" id="S2.SS2.p2.2.m2.2.2.1.1.2" xref="S2.SS2.p2.2.m2.2.2.2.cmml">(</mo><mrow id="S2.SS2.p2.2.m2.2.2.1.1.1" xref="S2.SS2.p2.2.m2.2.2.1.1.1.cmml"><msub id="S2.SS2.p2.2.m2.2.2.1.1.1.2" xref="S2.SS2.p2.2.m2.2.2.1.1.1.2.cmml"><mo lspace="0em" rspace="0em" id="S2.SS2.p2.2.m2.2.2.1.1.1.2.2" xref="S2.SS2.p2.2.m2.2.2.1.1.1.2.2.cmml">∑</mo><mi id="S2.SS2.p2.2.m2.2.2.1.1.1.2.3" xref="S2.SS2.p2.2.m2.2.2.1.1.1.2.3.cmml">j</mi></msub><mrow id="S2.SS2.p2.2.m2.2.2.1.1.1.1.1" xref="S2.SS2.p2.2.m2.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS2.p2.2.m2.2.2.1.1.1.1.1.2" xref="S2.SS2.p2.2.m2.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS2.p2.2.m2.2.2.1.1.1.1.1.1" xref="S2.SS2.p2.2.m2.2.2.1.1.1.1.1.1.cmml"><msub id="S2.SS2.p2.2.m2.2.2.1.1.1.1.1.1.3" xref="S2.SS2.p2.2.m2.2.2.1.1.1.1.1.1.3.cmml"><mi id="S2.SS2.p2.2.m2.2.2.1.1.1.1.1.1.3.2" xref="S2.SS2.p2.2.m2.2.2.1.1.1.1.1.1.3.2.cmml">s</mi><mrow id="S2.SS2.p2.2.m2.2.2.1.1.1.1.1.1.3.3" xref="S2.SS2.p2.2.m2.2.2.1.1.1.1.1.1.3.3.cmml"><mi id="S2.SS2.p2.2.m2.2.2.1.1.1.1.1.1.3.3.2" xref="S2.SS2.p2.2.m2.2.2.1.1.1.1.1.1.3.3.2.cmml">n</mi><mo id="S2.SS2.p2.2.m2.2.2.1.1.1.1.1.1.3.3.1" xref="S2.SS2.p2.2.m2.2.2.1.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.SS2.p2.2.m2.2.2.1.1.1.1.1.1.3.3.3" xref="S2.SS2.p2.2.m2.2.2.1.1.1.1.1.1.3.3.3.cmml">e</mi><mo id="S2.SS2.p2.2.m2.2.2.1.1.1.1.1.1.3.3.1a" xref="S2.SS2.p2.2.m2.2.2.1.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.SS2.p2.2.m2.2.2.1.1.1.1.1.1.3.3.4" xref="S2.SS2.p2.2.m2.2.2.1.1.1.1.1.1.3.3.4.cmml">t</mi></mrow></msub><mo id="S2.SS2.p2.2.m2.2.2.1.1.1.1.1.1.2" xref="S2.SS2.p2.2.m2.2.2.1.1.1.1.1.1.2.cmml">⁢</mo><msub id="S2.SS2.p2.2.m2.2.2.1.1.1.1.1.1.1" xref="S2.SS2.p2.2.m2.2.2.1.1.1.1.1.1.1.cmml"><mrow id="S2.SS2.p2.2.m2.2.2.1.1.1.1.1.1.1.1.1" xref="S2.SS2.p2.2.m2.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS2.p2.2.m2.2.2.1.1.1.1.1.1.1.1.1.2" xref="S2.SS2.p2.2.m2.2.2.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="S2.SS2.p2.2.m2.2.2.1.1.1.1.1.1.1.1.1.1" xref="S2.SS2.p2.2.m2.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.SS2.p2.2.m2.2.2.1.1.1.1.1.1.1.1.1.1.2" xref="S2.SS2.p2.2.m2.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml">x</mi><mrow id="S2.SS2.p2.2.m2.2.2.1.1.1.1.1.1.1.1.1.1.3" xref="S2.SS2.p2.2.m2.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml"><mn id="S2.SS2.p2.2.m2.2.2.1.1.1.1.1.1.1.1.1.1.3.2" xref="S2.SS2.p2.2.m2.2.2.1.1.1.1.1.1.1.1.1.1.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S2.SS2.p2.2.m2.2.2.1.1.1.1.1.1.1.1.1.1.3.1" xref="S2.SS2.p2.2.m2.2.2.1.1.1.1.1.1.1.1.1.1.3.1.cmml">:</mo><mi id="S2.SS2.p2.2.m2.2.2.1.1.1.1.1.1.1.1.1.1.3.3" xref="S2.SS2.p2.2.m2.2.2.1.1.1.1.1.1.1.1.1.1.3.3.cmml">d</mi></mrow></msup><mo stretchy="false" id="S2.SS2.p2.2.m2.2.2.1.1.1.1.1.1.1.1.1.3" xref="S2.SS2.p2.2.m2.2.2.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mi id="S2.SS2.p2.2.m2.2.2.1.1.1.1.1.1.1.3" xref="S2.SS2.p2.2.m2.2.2.1.1.1.1.1.1.1.3.cmml">j</mi></msub></mrow><mo stretchy="false" id="S2.SS2.p2.2.m2.2.2.1.1.1.1.1.3" xref="S2.SS2.p2.2.m2.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S2.SS2.p2.2.m2.2.2.1.1.3" xref="S2.SS2.p2.2.m2.2.2.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.2.m2.2b"><apply id="S2.SS2.p2.2.m2.2.2.2.cmml" xref="S2.SS2.p2.2.m2.2.2.1"><exp id="S2.SS2.p2.2.m2.1.1.cmml" xref="S2.SS2.p2.2.m2.1.1"></exp><apply id="S2.SS2.p2.2.m2.2.2.1.1.1.cmml" xref="S2.SS2.p2.2.m2.2.2.1.1.1"><apply id="S2.SS2.p2.2.m2.2.2.1.1.1.2.cmml" xref="S2.SS2.p2.2.m2.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p2.2.m2.2.2.1.1.1.2.1.cmml" xref="S2.SS2.p2.2.m2.2.2.1.1.1.2">subscript</csymbol><sum id="S2.SS2.p2.2.m2.2.2.1.1.1.2.2.cmml" xref="S2.SS2.p2.2.m2.2.2.1.1.1.2.2"></sum><ci id="S2.SS2.p2.2.m2.2.2.1.1.1.2.3.cmml" xref="S2.SS2.p2.2.m2.2.2.1.1.1.2.3">𝑗</ci></apply><apply id="S2.SS2.p2.2.m2.2.2.1.1.1.1.1.1.cmml" xref="S2.SS2.p2.2.m2.2.2.1.1.1.1.1"><times id="S2.SS2.p2.2.m2.2.2.1.1.1.1.1.1.2.cmml" xref="S2.SS2.p2.2.m2.2.2.1.1.1.1.1.1.2"></times><apply id="S2.SS2.p2.2.m2.2.2.1.1.1.1.1.1.3.cmml" xref="S2.SS2.p2.2.m2.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p2.2.m2.2.2.1.1.1.1.1.1.3.1.cmml" xref="S2.SS2.p2.2.m2.2.2.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.SS2.p2.2.m2.2.2.1.1.1.1.1.1.3.2.cmml" xref="S2.SS2.p2.2.m2.2.2.1.1.1.1.1.1.3.2">𝑠</ci><apply id="S2.SS2.p2.2.m2.2.2.1.1.1.1.1.1.3.3.cmml" xref="S2.SS2.p2.2.m2.2.2.1.1.1.1.1.1.3.3"><times id="S2.SS2.p2.2.m2.2.2.1.1.1.1.1.1.3.3.1.cmml" xref="S2.SS2.p2.2.m2.2.2.1.1.1.1.1.1.3.3.1"></times><ci id="S2.SS2.p2.2.m2.2.2.1.1.1.1.1.1.3.3.2.cmml" xref="S2.SS2.p2.2.m2.2.2.1.1.1.1.1.1.3.3.2">𝑛</ci><ci id="S2.SS2.p2.2.m2.2.2.1.1.1.1.1.1.3.3.3.cmml" xref="S2.SS2.p2.2.m2.2.2.1.1.1.1.1.1.3.3.3">𝑒</ci><ci id="S2.SS2.p2.2.m2.2.2.1.1.1.1.1.1.3.3.4.cmml" xref="S2.SS2.p2.2.m2.2.2.1.1.1.1.1.1.3.3.4">𝑡</ci></apply></apply><apply id="S2.SS2.p2.2.m2.2.2.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p2.2.m2.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.2.m2.2.2.1.1.1.1.1.1.1.2.cmml" xref="S2.SS2.p2.2.m2.2.2.1.1.1.1.1.1.1">subscript</csymbol><apply id="S2.SS2.p2.2.m2.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p2.2.m2.2.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.2.m2.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p2.2.m2.2.2.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S2.SS2.p2.2.m2.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.SS2.p2.2.m2.2.2.1.1.1.1.1.1.1.1.1.1.2">𝑥</ci><apply id="S2.SS2.p2.2.m2.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.SS2.p2.2.m2.2.2.1.1.1.1.1.1.1.1.1.1.3"><ci id="S2.SS2.p2.2.m2.2.2.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.SS2.p2.2.m2.2.2.1.1.1.1.1.1.1.1.1.1.3.1">:</ci><cn type="integer" id="S2.SS2.p2.2.m2.2.2.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.SS2.p2.2.m2.2.2.1.1.1.1.1.1.1.1.1.1.3.2">1</cn><ci id="S2.SS2.p2.2.m2.2.2.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.SS2.p2.2.m2.2.2.1.1.1.1.1.1.1.1.1.1.3.3">𝑑</ci></apply></apply><ci id="S2.SS2.p2.2.m2.2.2.1.1.1.1.1.1.1.3.cmml" xref="S2.SS2.p2.2.m2.2.2.1.1.1.1.1.1.1.3">𝑗</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.2.m2.2c">\exp(\sum_{j}(s_{net}(x^{1:d})_{j}))</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.2.m2.2d">roman_exp ( ∑ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_n italic_e italic_t end_POSTSUBSCRIPT ( italic_x start_POSTSUPERSCRIPT 1 : italic_d end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) )</annotation></semantics></math> can be efficiently computed. If the flow is implemented using <math id="S2.SS2.p2.3.m3.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S2.SS2.p2.3.m3.1a"><mi id="S2.SS2.p2.3.m3.1.1" xref="S2.SS2.p2.3.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.3.m3.1b"><ci id="S2.SS2.p2.3.m3.1.1.cmml" xref="S2.SS2.p2.3.m3.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.3.m3.1c">K</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.3.m3.1d">italic_K</annotation></semantics></math> such layers, which is required to ensure better learning, the probability density of a given sample <math id="S2.SS2.p2.4.m4.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S2.SS2.p2.4.m4.1a"><mi id="S2.SS2.p2.4.m4.1.1" xref="S2.SS2.p2.4.m4.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.4.m4.1b"><ci id="S2.SS2.p2.4.m4.1.1.cmml" xref="S2.SS2.p2.4.m4.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.4.m4.1c">x</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.4.m4.1d">italic_x</annotation></semantics></math> can be calculated as follows:</p>
<table id="A1.EGx2" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S2.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td colspan="2" class="ltx_td ltx_align_center ltx_eqn_cell"><math id="S2.E3.m1.50" class="ltx_Math" alttext="\displaystyle\begin{split}log(p_{X}(x))=\log(p_{Z}(z))+\sum_{k=1}^{K}\log\left(\left|\exp(\sum_{j}(s_{net}^{k}(y_{k-1}^{1:d}))_{j})\right|\right)\end{split}" display="inline"><semantics id="S2.E3.m1.50a"><mtable id="S2.E3.m1.50.50.6" xref="S2.E3.m1.47.47.3.cmml"><mtr id="S2.E3.m1.50.50.6a" xref="S2.E3.m1.47.47.3.cmml"><mtd class="ltx_align_right" columnalign="right" id="S2.E3.m1.50.50.6b" xref="S2.E3.m1.47.47.3.cmml"><mrow id="S2.E3.m1.50.50.6.47.47.47" xref="S2.E3.m1.47.47.3.cmml"><mrow id="S2.E3.m1.48.48.4.45.45.45.45" xref="S2.E3.m1.47.47.3.cmml"><mi mathsize="90%" id="S2.E3.m1.1.1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.1.1.cmml">l</mi><mo id="S2.E3.m1.48.48.4.45.45.45.45.2" xref="S2.E3.m1.47.47.3.cmml">⁢</mo><mi mathsize="90%" id="S2.E3.m1.2.2.2.2.2.2" xref="S2.E3.m1.2.2.2.2.2.2.cmml">o</mi><mo id="S2.E3.m1.48.48.4.45.45.45.45.2a" xref="S2.E3.m1.47.47.3.cmml">⁢</mo><mi mathsize="90%" id="S2.E3.m1.3.3.3.3.3.3" xref="S2.E3.m1.3.3.3.3.3.3.cmml">g</mi><mo id="S2.E3.m1.48.48.4.45.45.45.45.2b" xref="S2.E3.m1.47.47.3.cmml">⁢</mo><mrow id="S2.E3.m1.48.48.4.45.45.45.45.1.1" xref="S2.E3.m1.47.47.3.cmml"><mo maxsize="90%" minsize="90%" id="S2.E3.m1.4.4.4.4.4.4" xref="S2.E3.m1.47.47.3.cmml">(</mo><mrow id="S2.E3.m1.48.48.4.45.45.45.45.1.1.1" xref="S2.E3.m1.47.47.3.cmml"><msub id="S2.E3.m1.48.48.4.45.45.45.45.1.1.1.2" xref="S2.E3.m1.47.47.3.cmml"><mi mathsize="90%" id="S2.E3.m1.5.5.5.5.5.5" xref="S2.E3.m1.5.5.5.5.5.5.cmml">p</mi><mi mathsize="90%" id="S2.E3.m1.6.6.6.6.6.6.1" xref="S2.E3.m1.6.6.6.6.6.6.1.cmml">X</mi></msub><mo id="S2.E3.m1.48.48.4.45.45.45.45.1.1.1.1" xref="S2.E3.m1.47.47.3.cmml">⁢</mo><mrow id="S2.E3.m1.48.48.4.45.45.45.45.1.1.1.3" xref="S2.E3.m1.47.47.3.cmml"><mo maxsize="90%" minsize="90%" id="S2.E3.m1.7.7.7.7.7.7" xref="S2.E3.m1.47.47.3.cmml">(</mo><mi mathsize="90%" id="S2.E3.m1.8.8.8.8.8.8" xref="S2.E3.m1.8.8.8.8.8.8.cmml">x</mi><mo maxsize="90%" minsize="90%" id="S2.E3.m1.9.9.9.9.9.9" xref="S2.E3.m1.47.47.3.cmml">)</mo></mrow></mrow><mo maxsize="90%" minsize="90%" id="S2.E3.m1.10.10.10.10.10.10" xref="S2.E3.m1.47.47.3.cmml">)</mo></mrow></mrow><mo mathsize="90%" id="S2.E3.m1.11.11.11.11.11.11" xref="S2.E3.m1.11.11.11.11.11.11.cmml">=</mo><mrow id="S2.E3.m1.50.50.6.47.47.47.47" xref="S2.E3.m1.47.47.3.cmml"><mrow id="S2.E3.m1.49.49.5.46.46.46.46.1.1" xref="S2.E3.m1.47.47.3.cmml"><mi mathsize="90%" id="S2.E3.m1.12.12.12.12.12.12" xref="S2.E3.m1.12.12.12.12.12.12.cmml">log</mi><mo id="S2.E3.m1.49.49.5.46.46.46.46.1.1a" xref="S2.E3.m1.47.47.3.cmml">⁡</mo><mrow id="S2.E3.m1.49.49.5.46.46.46.46.1.1.1" xref="S2.E3.m1.47.47.3.cmml"><mo maxsize="90%" minsize="90%" id="S2.E3.m1.13.13.13.13.13.13" xref="S2.E3.m1.47.47.3.cmml">(</mo><mrow id="S2.E3.m1.49.49.5.46.46.46.46.1.1.1.1" xref="S2.E3.m1.47.47.3.cmml"><msub id="S2.E3.m1.49.49.5.46.46.46.46.1.1.1.1.2" xref="S2.E3.m1.47.47.3.cmml"><mi mathsize="90%" id="S2.E3.m1.14.14.14.14.14.14" xref="S2.E3.m1.14.14.14.14.14.14.cmml">p</mi><mi mathsize="90%" id="S2.E3.m1.15.15.15.15.15.15.1" xref="S2.E3.m1.15.15.15.15.15.15.1.cmml">Z</mi></msub><mo id="S2.E3.m1.49.49.5.46.46.46.46.1.1.1.1.1" xref="S2.E3.m1.47.47.3.cmml">⁢</mo><mrow id="S2.E3.m1.49.49.5.46.46.46.46.1.1.1.1.3" xref="S2.E3.m1.47.47.3.cmml"><mo maxsize="90%" minsize="90%" id="S2.E3.m1.16.16.16.16.16.16" xref="S2.E3.m1.47.47.3.cmml">(</mo><mi mathsize="90%" id="S2.E3.m1.17.17.17.17.17.17" xref="S2.E3.m1.17.17.17.17.17.17.cmml">z</mi><mo maxsize="90%" minsize="90%" id="S2.E3.m1.18.18.18.18.18.18" xref="S2.E3.m1.47.47.3.cmml">)</mo></mrow></mrow><mo maxsize="90%" minsize="90%" id="S2.E3.m1.19.19.19.19.19.19" xref="S2.E3.m1.47.47.3.cmml">)</mo></mrow></mrow><mo mathsize="90%" id="S2.E3.m1.20.20.20.20.20.20" xref="S2.E3.m1.20.20.20.20.20.20.cmml">+</mo><mrow id="S2.E3.m1.50.50.6.47.47.47.47.2" xref="S2.E3.m1.47.47.3.cmml"><mstyle displaystyle="true" id="S2.E3.m1.50.50.6.47.47.47.47.2.2" xref="S2.E3.m1.47.47.3.cmml"><munderover id="S2.E3.m1.50.50.6.47.47.47.47.2.2a" xref="S2.E3.m1.47.47.3.cmml"><mo maxsize="90%" minsize="90%" movablelimits="false" stretchy="true" id="S2.E3.m1.21.21.21.21.21.21" xref="S2.E3.m1.21.21.21.21.21.21.cmml">∑</mo><mrow id="S2.E3.m1.22.22.22.22.22.22.1" xref="S2.E3.m1.22.22.22.22.22.22.1.cmml"><mi mathsize="90%" id="S2.E3.m1.22.22.22.22.22.22.1.2" xref="S2.E3.m1.22.22.22.22.22.22.1.2.cmml">k</mi><mo mathsize="90%" id="S2.E3.m1.22.22.22.22.22.22.1.1" xref="S2.E3.m1.22.22.22.22.22.22.1.1.cmml">=</mo><mn mathsize="90%" id="S2.E3.m1.22.22.22.22.22.22.1.3" xref="S2.E3.m1.22.22.22.22.22.22.1.3.cmml">1</mn></mrow><mi mathsize="90%" id="S2.E3.m1.23.23.23.23.23.23.1" xref="S2.E3.m1.23.23.23.23.23.23.1.cmml">K</mi></munderover></mstyle><mrow id="S2.E3.m1.50.50.6.47.47.47.47.2.1.1" xref="S2.E3.m1.47.47.3.cmml"><mi mathsize="90%" id="S2.E3.m1.24.24.24.24.24.24" xref="S2.E3.m1.24.24.24.24.24.24.cmml">log</mi><mo id="S2.E3.m1.50.50.6.47.47.47.47.2.1.1a" xref="S2.E3.m1.47.47.3.cmml">⁡</mo><mrow id="S2.E3.m1.50.50.6.47.47.47.47.2.1.1.1" xref="S2.E3.m1.47.47.3.cmml"><mo id="S2.E3.m1.25.25.25.25.25.25" xref="S2.E3.m1.47.47.3.cmml">(</mo><mrow id="S2.E3.m1.50.50.6.47.47.47.47.2.1.1.1.1" xref="S2.E3.m1.47.47.3.cmml"><mo id="S2.E3.m1.26.26.26.26.26.26" xref="S2.E3.m1.47.47.3.cmml">|</mo><mrow id="S2.E3.m1.50.50.6.47.47.47.47.2.1.1.1.1.1.1" xref="S2.E3.m1.47.47.3.cmml"><mi mathsize="90%" id="S2.E3.m1.27.27.27.27.27.27" xref="S2.E3.m1.27.27.27.27.27.27.cmml">exp</mi><mo id="S2.E3.m1.50.50.6.47.47.47.47.2.1.1.1.1.1.1a" xref="S2.E3.m1.47.47.3.cmml">⁡</mo><mrow id="S2.E3.m1.50.50.6.47.47.47.47.2.1.1.1.1.1.1.1.1" xref="S2.E3.m1.47.47.3.cmml"><mo maxsize="90%" minsize="90%" id="S2.E3.m1.28.28.28.28.28.28" xref="S2.E3.m1.47.47.3.cmml">(</mo><mrow id="S2.E3.m1.50.50.6.47.47.47.47.2.1.1.1.1.1.1.1.1.1" xref="S2.E3.m1.47.47.3.cmml"><mstyle displaystyle="true" id="S2.E3.m1.50.50.6.47.47.47.47.2.1.1.1.1.1.1.1.1.1.2" xref="S2.E3.m1.47.47.3.cmml"><munder id="S2.E3.m1.50.50.6.47.47.47.47.2.1.1.1.1.1.1.1.1.1.2a" xref="S2.E3.m1.47.47.3.cmml"><mo maxsize="90%" minsize="90%" movablelimits="false" stretchy="true" id="S2.E3.m1.29.29.29.29.29.29" xref="S2.E3.m1.29.29.29.29.29.29.cmml">∑</mo><mi mathsize="90%" id="S2.E3.m1.30.30.30.30.30.30.1" xref="S2.E3.m1.30.30.30.30.30.30.1.cmml">j</mi></munder></mstyle><msub id="S2.E3.m1.50.50.6.47.47.47.47.2.1.1.1.1.1.1.1.1.1.1" xref="S2.E3.m1.47.47.3.cmml"><mrow id="S2.E3.m1.50.50.6.47.47.47.47.2.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E3.m1.47.47.3.cmml"><mo maxsize="90%" minsize="90%" id="S2.E3.m1.31.31.31.31.31.31" xref="S2.E3.m1.47.47.3.cmml">(</mo><mrow id="S2.E3.m1.50.50.6.47.47.47.47.2.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E3.m1.47.47.3.cmml"><msubsup id="S2.E3.m1.50.50.6.47.47.47.47.2.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E3.m1.47.47.3.cmml"><mi mathsize="90%" id="S2.E3.m1.32.32.32.32.32.32" xref="S2.E3.m1.32.32.32.32.32.32.cmml">s</mi><mrow id="S2.E3.m1.33.33.33.33.33.33.1" xref="S2.E3.m1.33.33.33.33.33.33.1.cmml"><mi mathsize="90%" id="S2.E3.m1.33.33.33.33.33.33.1.2" xref="S2.E3.m1.33.33.33.33.33.33.1.2.cmml">n</mi><mo id="S2.E3.m1.33.33.33.33.33.33.1.1" xref="S2.E3.m1.33.33.33.33.33.33.1.1.cmml">⁢</mo><mi mathsize="90%" id="S2.E3.m1.33.33.33.33.33.33.1.3" xref="S2.E3.m1.33.33.33.33.33.33.1.3.cmml">e</mi><mo id="S2.E3.m1.33.33.33.33.33.33.1.1a" xref="S2.E3.m1.33.33.33.33.33.33.1.1.cmml">⁢</mo><mi mathsize="90%" id="S2.E3.m1.33.33.33.33.33.33.1.4" xref="S2.E3.m1.33.33.33.33.33.33.1.4.cmml">t</mi></mrow><mi mathsize="90%" id="S2.E3.m1.34.34.34.34.34.34.1" xref="S2.E3.m1.34.34.34.34.34.34.1.cmml">k</mi></msubsup><mo id="S2.E3.m1.50.50.6.47.47.47.47.2.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E3.m1.47.47.3.cmml">⁢</mo><mrow id="S2.E3.m1.50.50.6.47.47.47.47.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E3.m1.47.47.3.cmml"><mo maxsize="90%" minsize="90%" id="S2.E3.m1.35.35.35.35.35.35" xref="S2.E3.m1.47.47.3.cmml">(</mo><msubsup id="S2.E3.m1.50.50.6.47.47.47.47.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E3.m1.47.47.3.cmml"><mi mathsize="90%" id="S2.E3.m1.36.36.36.36.36.36" xref="S2.E3.m1.36.36.36.36.36.36.cmml">y</mi><mrow id="S2.E3.m1.37.37.37.37.37.37.1" xref="S2.E3.m1.37.37.37.37.37.37.1.cmml"><mi mathsize="90%" id="S2.E3.m1.37.37.37.37.37.37.1.2" xref="S2.E3.m1.37.37.37.37.37.37.1.2.cmml">k</mi><mo mathsize="90%" id="S2.E3.m1.37.37.37.37.37.37.1.1" xref="S2.E3.m1.37.37.37.37.37.37.1.1.cmml">−</mo><mn mathsize="90%" id="S2.E3.m1.37.37.37.37.37.37.1.3" xref="S2.E3.m1.37.37.37.37.37.37.1.3.cmml">1</mn></mrow><mrow id="S2.E3.m1.38.38.38.38.38.38.1" xref="S2.E3.m1.38.38.38.38.38.38.1.cmml"><mn mathsize="90%" id="S2.E3.m1.38.38.38.38.38.38.1.2" xref="S2.E3.m1.38.38.38.38.38.38.1.2.cmml">1</mn><mo lspace="0.278em" mathsize="90%" rspace="0.278em" id="S2.E3.m1.38.38.38.38.38.38.1.1" xref="S2.E3.m1.38.38.38.38.38.38.1.1.cmml">:</mo><mi mathsize="90%" id="S2.E3.m1.38.38.38.38.38.38.1.3" xref="S2.E3.m1.38.38.38.38.38.38.1.3.cmml">d</mi></mrow></msubsup><mo maxsize="90%" minsize="90%" id="S2.E3.m1.39.39.39.39.39.39" xref="S2.E3.m1.47.47.3.cmml">)</mo></mrow></mrow><mo maxsize="90%" minsize="90%" id="S2.E3.m1.40.40.40.40.40.40" xref="S2.E3.m1.47.47.3.cmml">)</mo></mrow><mi mathsize="90%" id="S2.E3.m1.41.41.41.41.41.41.1" xref="S2.E3.m1.41.41.41.41.41.41.1.cmml">j</mi></msub></mrow><mo maxsize="90%" minsize="90%" id="S2.E3.m1.42.42.42.42.42.42" xref="S2.E3.m1.47.47.3.cmml">)</mo></mrow></mrow><mo id="S2.E3.m1.43.43.43.43.43.43" xref="S2.E3.m1.47.47.3.cmml">|</mo></mrow><mo id="S2.E3.m1.44.44.44.44.44.44" xref="S2.E3.m1.47.47.3.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S2.E3.m1.50b"><apply id="S2.E3.m1.47.47.3.cmml" xref="S2.E3.m1.50.50.6"><eq id="S2.E3.m1.11.11.11.11.11.11.cmml" xref="S2.E3.m1.11.11.11.11.11.11"></eq><apply id="S2.E3.m1.45.45.1.1.cmml" xref="S2.E3.m1.50.50.6"><times id="S2.E3.m1.45.45.1.1.2.cmml" xref="S2.E3.m1.50.50.6"></times><ci id="S2.E3.m1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1">𝑙</ci><ci id="S2.E3.m1.2.2.2.2.2.2.cmml" xref="S2.E3.m1.2.2.2.2.2.2">𝑜</ci><ci id="S2.E3.m1.3.3.3.3.3.3.cmml" xref="S2.E3.m1.3.3.3.3.3.3">𝑔</ci><apply id="S2.E3.m1.45.45.1.1.1.1.1.cmml" xref="S2.E3.m1.50.50.6"><times id="S2.E3.m1.45.45.1.1.1.1.1.1.cmml" xref="S2.E3.m1.50.50.6"></times><apply id="S2.E3.m1.45.45.1.1.1.1.1.2.cmml" xref="S2.E3.m1.50.50.6"><csymbol cd="ambiguous" id="S2.E3.m1.45.45.1.1.1.1.1.2.1.cmml" xref="S2.E3.m1.50.50.6">subscript</csymbol><ci id="S2.E3.m1.5.5.5.5.5.5.cmml" xref="S2.E3.m1.5.5.5.5.5.5">𝑝</ci><ci id="S2.E3.m1.6.6.6.6.6.6.1.cmml" xref="S2.E3.m1.6.6.6.6.6.6.1">𝑋</ci></apply><ci id="S2.E3.m1.8.8.8.8.8.8.cmml" xref="S2.E3.m1.8.8.8.8.8.8">𝑥</ci></apply></apply><apply id="S2.E3.m1.47.47.3.3.cmml" xref="S2.E3.m1.50.50.6"><plus id="S2.E3.m1.20.20.20.20.20.20.cmml" xref="S2.E3.m1.20.20.20.20.20.20"></plus><apply id="S2.E3.m1.46.46.2.2.1.2.cmml" xref="S2.E3.m1.50.50.6"><log id="S2.E3.m1.12.12.12.12.12.12.cmml" xref="S2.E3.m1.12.12.12.12.12.12"></log><apply id="S2.E3.m1.46.46.2.2.1.1.1.1.cmml" xref="S2.E3.m1.50.50.6"><times id="S2.E3.m1.46.46.2.2.1.1.1.1.1.cmml" xref="S2.E3.m1.50.50.6"></times><apply id="S2.E3.m1.46.46.2.2.1.1.1.1.2.cmml" xref="S2.E3.m1.50.50.6"><csymbol cd="ambiguous" id="S2.E3.m1.46.46.2.2.1.1.1.1.2.1.cmml" xref="S2.E3.m1.50.50.6">subscript</csymbol><ci id="S2.E3.m1.14.14.14.14.14.14.cmml" xref="S2.E3.m1.14.14.14.14.14.14">𝑝</ci><ci id="S2.E3.m1.15.15.15.15.15.15.1.cmml" xref="S2.E3.m1.15.15.15.15.15.15.1">𝑍</ci></apply><ci id="S2.E3.m1.17.17.17.17.17.17.cmml" xref="S2.E3.m1.17.17.17.17.17.17">𝑧</ci></apply></apply><apply id="S2.E3.m1.47.47.3.3.2.cmml" xref="S2.E3.m1.50.50.6"><apply id="S2.E3.m1.47.47.3.3.2.2.cmml" xref="S2.E3.m1.50.50.6"><csymbol cd="ambiguous" id="S2.E3.m1.47.47.3.3.2.2.1.cmml" xref="S2.E3.m1.50.50.6">superscript</csymbol><apply id="S2.E3.m1.47.47.3.3.2.2.2.cmml" xref="S2.E3.m1.50.50.6"><csymbol cd="ambiguous" id="S2.E3.m1.47.47.3.3.2.2.2.1.cmml" xref="S2.E3.m1.50.50.6">subscript</csymbol><sum id="S2.E3.m1.21.21.21.21.21.21.cmml" xref="S2.E3.m1.21.21.21.21.21.21"></sum><apply id="S2.E3.m1.22.22.22.22.22.22.1.cmml" xref="S2.E3.m1.22.22.22.22.22.22.1"><eq id="S2.E3.m1.22.22.22.22.22.22.1.1.cmml" xref="S2.E3.m1.22.22.22.22.22.22.1.1"></eq><ci id="S2.E3.m1.22.22.22.22.22.22.1.2.cmml" xref="S2.E3.m1.22.22.22.22.22.22.1.2">𝑘</ci><cn type="integer" id="S2.E3.m1.22.22.22.22.22.22.1.3.cmml" xref="S2.E3.m1.22.22.22.22.22.22.1.3">1</cn></apply></apply><ci id="S2.E3.m1.23.23.23.23.23.23.1.cmml" xref="S2.E3.m1.23.23.23.23.23.23.1">𝐾</ci></apply><apply id="S2.E3.m1.47.47.3.3.2.1.2.cmml" xref="S2.E3.m1.50.50.6"><log id="S2.E3.m1.24.24.24.24.24.24.cmml" xref="S2.E3.m1.24.24.24.24.24.24"></log><apply id="S2.E3.m1.47.47.3.3.2.1.1.1.1.2.cmml" xref="S2.E3.m1.50.50.6"><abs id="S2.E3.m1.47.47.3.3.2.1.1.1.1.2.1.cmml" xref="S2.E3.m1.50.50.6"></abs><apply id="S2.E3.m1.47.47.3.3.2.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.50.50.6"><exp id="S2.E3.m1.27.27.27.27.27.27.cmml" xref="S2.E3.m1.27.27.27.27.27.27"></exp><apply id="S2.E3.m1.47.47.3.3.2.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.50.50.6"><apply id="S2.E3.m1.47.47.3.3.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.50.50.6"><csymbol cd="ambiguous" id="S2.E3.m1.47.47.3.3.2.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E3.m1.50.50.6">subscript</csymbol><sum id="S2.E3.m1.29.29.29.29.29.29.cmml" xref="S2.E3.m1.29.29.29.29.29.29"></sum><ci id="S2.E3.m1.30.30.30.30.30.30.1.cmml" xref="S2.E3.m1.30.30.30.30.30.30.1">𝑗</ci></apply><apply id="S2.E3.m1.47.47.3.3.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.50.50.6"><csymbol cd="ambiguous" id="S2.E3.m1.47.47.3.3.2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.50.50.6">subscript</csymbol><apply id="S2.E3.m1.47.47.3.3.2.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.50.50.6"><times id="S2.E3.m1.47.47.3.3.2.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.50.50.6"></times><apply id="S2.E3.m1.47.47.3.3.2.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E3.m1.50.50.6"><csymbol cd="ambiguous" id="S2.E3.m1.47.47.3.3.2.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E3.m1.50.50.6">superscript</csymbol><apply id="S2.E3.m1.47.47.3.3.2.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E3.m1.50.50.6"><csymbol cd="ambiguous" id="S2.E3.m1.47.47.3.3.2.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S2.E3.m1.50.50.6">subscript</csymbol><ci id="S2.E3.m1.32.32.32.32.32.32.cmml" xref="S2.E3.m1.32.32.32.32.32.32">𝑠</ci><apply id="S2.E3.m1.33.33.33.33.33.33.1.cmml" xref="S2.E3.m1.33.33.33.33.33.33.1"><times id="S2.E3.m1.33.33.33.33.33.33.1.1.cmml" xref="S2.E3.m1.33.33.33.33.33.33.1.1"></times><ci id="S2.E3.m1.33.33.33.33.33.33.1.2.cmml" xref="S2.E3.m1.33.33.33.33.33.33.1.2">𝑛</ci><ci id="S2.E3.m1.33.33.33.33.33.33.1.3.cmml" xref="S2.E3.m1.33.33.33.33.33.33.1.3">𝑒</ci><ci id="S2.E3.m1.33.33.33.33.33.33.1.4.cmml" xref="S2.E3.m1.33.33.33.33.33.33.1.4">𝑡</ci></apply></apply><ci id="S2.E3.m1.34.34.34.34.34.34.1.cmml" xref="S2.E3.m1.34.34.34.34.34.34.1">𝑘</ci></apply><apply id="S2.E3.m1.47.47.3.3.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.50.50.6"><csymbol cd="ambiguous" id="S2.E3.m1.47.47.3.3.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.50.50.6">superscript</csymbol><apply id="S2.E3.m1.47.47.3.3.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.50.50.6"><csymbol cd="ambiguous" id="S2.E3.m1.47.47.3.3.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E3.m1.50.50.6">subscript</csymbol><ci id="S2.E3.m1.36.36.36.36.36.36.cmml" xref="S2.E3.m1.36.36.36.36.36.36">𝑦</ci><apply id="S2.E3.m1.37.37.37.37.37.37.1.cmml" xref="S2.E3.m1.37.37.37.37.37.37.1"><minus id="S2.E3.m1.37.37.37.37.37.37.1.1.cmml" xref="S2.E3.m1.37.37.37.37.37.37.1.1"></minus><ci id="S2.E3.m1.37.37.37.37.37.37.1.2.cmml" xref="S2.E3.m1.37.37.37.37.37.37.1.2">𝑘</ci><cn type="integer" id="S2.E3.m1.37.37.37.37.37.37.1.3.cmml" xref="S2.E3.m1.37.37.37.37.37.37.1.3">1</cn></apply></apply><apply id="S2.E3.m1.38.38.38.38.38.38.1.cmml" xref="S2.E3.m1.38.38.38.38.38.38.1"><ci id="S2.E3.m1.38.38.38.38.38.38.1.1.cmml" xref="S2.E3.m1.38.38.38.38.38.38.1.1">:</ci><cn type="integer" id="S2.E3.m1.38.38.38.38.38.38.1.2.cmml" xref="S2.E3.m1.38.38.38.38.38.38.1.2">1</cn><ci id="S2.E3.m1.38.38.38.38.38.38.1.3.cmml" xref="S2.E3.m1.38.38.38.38.38.38.1.3">𝑑</ci></apply></apply></apply><ci id="S2.E3.m1.41.41.41.41.41.41.1.cmml" xref="S2.E3.m1.41.41.41.41.41.41.1">𝑗</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.50c">\displaystyle\begin{split}log(p_{X}(x))=\log(p_{Z}(z))+\sum_{k=1}^{K}\log\left(\left|\exp(\sum_{j}(s_{net}^{k}(y_{k-1}^{1:d}))_{j})\right|\right)\end{split}</annotation><annotation encoding="application/x-llamapun" id="S2.E3.m1.50d">start_ROW start_CELL italic_l italic_o italic_g ( italic_p start_POSTSUBSCRIPT italic_X end_POSTSUBSCRIPT ( italic_x ) ) = roman_log ( italic_p start_POSTSUBSCRIPT italic_Z end_POSTSUBSCRIPT ( italic_z ) ) + ∑ start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT roman_log ( | roman_exp ( ∑ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_n italic_e italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT ( italic_y start_POSTSUBSCRIPT italic_k - 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 1 : italic_d end_POSTSUPERSCRIPT ) ) start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) | ) end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S2.SS2.p2.10" class="ltx_p">where the first term denotes the likelihood of <math id="S2.SS2.p2.5.m1.1" class="ltx_Math" alttext="z" display="inline"><semantics id="S2.SS2.p2.5.m1.1a"><mi id="S2.SS2.p2.5.m1.1.1" xref="S2.SS2.p2.5.m1.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.5.m1.1b"><ci id="S2.SS2.p2.5.m1.1.1.cmml" xref="S2.SS2.p2.5.m1.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.5.m1.1c">z</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.5.m1.1d">italic_z</annotation></semantics></math> (transformed from <math id="S2.SS2.p2.6.m2.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S2.SS2.p2.6.m2.1a"><mi id="S2.SS2.p2.6.m2.1.1" xref="S2.SS2.p2.6.m2.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.6.m2.1b"><ci id="S2.SS2.p2.6.m2.1.1.cmml" xref="S2.SS2.p2.6.m2.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.6.m2.1c">x</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.6.m2.1d">italic_x</annotation></semantics></math>) on the base distribution, and the second term represents the accumulated changes while transforming <math id="S2.SS2.p2.7.m3.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S2.SS2.p2.7.m3.1a"><mi id="S2.SS2.p2.7.m3.1.1" xref="S2.SS2.p2.7.m3.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.7.m3.1b"><ci id="S2.SS2.p2.7.m3.1.1.cmml" xref="S2.SS2.p2.7.m3.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.7.m3.1c">x</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.7.m3.1d">italic_x</annotation></semantics></math> to <math id="S2.SS2.p2.8.m4.1" class="ltx_Math" alttext="z" display="inline"><semantics id="S2.SS2.p2.8.m4.1a"><mi id="S2.SS2.p2.8.m4.1.1" xref="S2.SS2.p2.8.m4.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.8.m4.1b"><ci id="S2.SS2.p2.8.m4.1.1.cmml" xref="S2.SS2.p2.8.m4.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.8.m4.1c">z</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.8.m4.1d">italic_z</annotation></semantics></math>. Thus, the training objective of RealNVP is to find the right set of hyperparameters of the <math id="S2.SS2.p2.9.m5.1" class="ltx_Math" alttext="s_{net}" display="inline"><semantics id="S2.SS2.p2.9.m5.1a"><msub id="S2.SS2.p2.9.m5.1.1" xref="S2.SS2.p2.9.m5.1.1.cmml"><mi id="S2.SS2.p2.9.m5.1.1.2" xref="S2.SS2.p2.9.m5.1.1.2.cmml">s</mi><mrow id="S2.SS2.p2.9.m5.1.1.3" xref="S2.SS2.p2.9.m5.1.1.3.cmml"><mi id="S2.SS2.p2.9.m5.1.1.3.2" xref="S2.SS2.p2.9.m5.1.1.3.2.cmml">n</mi><mo id="S2.SS2.p2.9.m5.1.1.3.1" xref="S2.SS2.p2.9.m5.1.1.3.1.cmml">⁢</mo><mi id="S2.SS2.p2.9.m5.1.1.3.3" xref="S2.SS2.p2.9.m5.1.1.3.3.cmml">e</mi><mo id="S2.SS2.p2.9.m5.1.1.3.1a" xref="S2.SS2.p2.9.m5.1.1.3.1.cmml">⁢</mo><mi id="S2.SS2.p2.9.m5.1.1.3.4" xref="S2.SS2.p2.9.m5.1.1.3.4.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.9.m5.1b"><apply id="S2.SS2.p2.9.m5.1.1.cmml" xref="S2.SS2.p2.9.m5.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.9.m5.1.1.1.cmml" xref="S2.SS2.p2.9.m5.1.1">subscript</csymbol><ci id="S2.SS2.p2.9.m5.1.1.2.cmml" xref="S2.SS2.p2.9.m5.1.1.2">𝑠</ci><apply id="S2.SS2.p2.9.m5.1.1.3.cmml" xref="S2.SS2.p2.9.m5.1.1.3"><times id="S2.SS2.p2.9.m5.1.1.3.1.cmml" xref="S2.SS2.p2.9.m5.1.1.3.1"></times><ci id="S2.SS2.p2.9.m5.1.1.3.2.cmml" xref="S2.SS2.p2.9.m5.1.1.3.2">𝑛</ci><ci id="S2.SS2.p2.9.m5.1.1.3.3.cmml" xref="S2.SS2.p2.9.m5.1.1.3.3">𝑒</ci><ci id="S2.SS2.p2.9.m5.1.1.3.4.cmml" xref="S2.SS2.p2.9.m5.1.1.3.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.9.m5.1c">s_{net}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.9.m5.1d">italic_s start_POSTSUBSCRIPT italic_n italic_e italic_t end_POSTSUBSCRIPT</annotation></semantics></math> and <math id="S2.SS2.p2.10.m6.1" class="ltx_Math" alttext="t_{net}" display="inline"><semantics id="S2.SS2.p2.10.m6.1a"><msub id="S2.SS2.p2.10.m6.1.1" xref="S2.SS2.p2.10.m6.1.1.cmml"><mi id="S2.SS2.p2.10.m6.1.1.2" xref="S2.SS2.p2.10.m6.1.1.2.cmml">t</mi><mrow id="S2.SS2.p2.10.m6.1.1.3" xref="S2.SS2.p2.10.m6.1.1.3.cmml"><mi id="S2.SS2.p2.10.m6.1.1.3.2" xref="S2.SS2.p2.10.m6.1.1.3.2.cmml">n</mi><mo id="S2.SS2.p2.10.m6.1.1.3.1" xref="S2.SS2.p2.10.m6.1.1.3.1.cmml">⁢</mo><mi id="S2.SS2.p2.10.m6.1.1.3.3" xref="S2.SS2.p2.10.m6.1.1.3.3.cmml">e</mi><mo id="S2.SS2.p2.10.m6.1.1.3.1a" xref="S2.SS2.p2.10.m6.1.1.3.1.cmml">⁢</mo><mi id="S2.SS2.p2.10.m6.1.1.3.4" xref="S2.SS2.p2.10.m6.1.1.3.4.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.10.m6.1b"><apply id="S2.SS2.p2.10.m6.1.1.cmml" xref="S2.SS2.p2.10.m6.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.10.m6.1.1.1.cmml" xref="S2.SS2.p2.10.m6.1.1">subscript</csymbol><ci id="S2.SS2.p2.10.m6.1.1.2.cmml" xref="S2.SS2.p2.10.m6.1.1.2">𝑡</ci><apply id="S2.SS2.p2.10.m6.1.1.3.cmml" xref="S2.SS2.p2.10.m6.1.1.3"><times id="S2.SS2.p2.10.m6.1.1.3.1.cmml" xref="S2.SS2.p2.10.m6.1.1.3.1"></times><ci id="S2.SS2.p2.10.m6.1.1.3.2.cmml" xref="S2.SS2.p2.10.m6.1.1.3.2">𝑛</ci><ci id="S2.SS2.p2.10.m6.1.1.3.3.cmml" xref="S2.SS2.p2.10.m6.1.1.3.3">𝑒</ci><ci id="S2.SS2.p2.10.m6.1.1.3.4.cmml" xref="S2.SS2.p2.10.m6.1.1.3.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.10.m6.1c">t_{net}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.10.m6.1d">italic_t start_POSTSUBSCRIPT italic_n italic_e italic_t end_POSTSUBSCRIPT</annotation></semantics></math> that maximize the overall likelihood of the observed data, which can be denoted as</p>
<table id="A1.EGx3" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S2.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E4.m1.3" class="ltx_Math" alttext="\displaystyle\theta^{*}=\underset{\theta\in\Theta}{\arg\max}\frac{1}{|\mathcal{D}|}\sum_{x\in\mathcal{D}}\log p_{X}(x;\theta)" display="inline"><semantics id="S2.E4.m1.3a"><mrow id="S2.E4.m1.3.4" xref="S2.E4.m1.3.4.cmml"><msup id="S2.E4.m1.3.4.2" xref="S2.E4.m1.3.4.2.cmml"><mi id="S2.E4.m1.3.4.2.2" xref="S2.E4.m1.3.4.2.2.cmml">θ</mi><mo id="S2.E4.m1.3.4.2.3" xref="S2.E4.m1.3.4.2.3.cmml">*</mo></msup><mo id="S2.E4.m1.3.4.1" xref="S2.E4.m1.3.4.1.cmml">=</mo><mrow id="S2.E4.m1.3.4.3" xref="S2.E4.m1.3.4.3.cmml"><munder accentunder="true" id="S2.E4.m1.3.4.3.2" xref="S2.E4.m1.3.4.3.2.cmml"><mrow id="S2.E4.m1.3.4.3.2.2" xref="S2.E4.m1.3.4.3.2.2.cmml"><mi id="S2.E4.m1.3.4.3.2.2.1" xref="S2.E4.m1.3.4.3.2.2.1.cmml">arg</mi><mo lspace="0.167em" id="S2.E4.m1.3.4.3.2.2a" xref="S2.E4.m1.3.4.3.2.2.cmml">⁡</mo><mi id="S2.E4.m1.3.4.3.2.2.2" xref="S2.E4.m1.3.4.3.2.2.2.cmml">max</mi></mrow><mrow id="S2.E4.m1.3.4.3.2.1" xref="S2.E4.m1.3.4.3.2.1.cmml"><mi id="S2.E4.m1.3.4.3.2.1.2" xref="S2.E4.m1.3.4.3.2.1.2.cmml">θ</mi><mo id="S2.E4.m1.3.4.3.2.1.1" xref="S2.E4.m1.3.4.3.2.1.1.cmml">∈</mo><mi mathvariant="normal" id="S2.E4.m1.3.4.3.2.1.3" xref="S2.E4.m1.3.4.3.2.1.3.cmml">Θ</mi></mrow></munder><mo lspace="0.167em" id="S2.E4.m1.3.4.3.1" xref="S2.E4.m1.3.4.3.1.cmml">⁢</mo><mstyle displaystyle="true" id="S2.E4.m1.1.1" xref="S2.E4.m1.1.1.cmml"><mfrac id="S2.E4.m1.1.1a" xref="S2.E4.m1.1.1.cmml"><mn id="S2.E4.m1.1.1.3" xref="S2.E4.m1.1.1.3.cmml">1</mn><mrow id="S2.E4.m1.1.1.1.3" xref="S2.E4.m1.1.1.1.2.cmml"><mo stretchy="false" id="S2.E4.m1.1.1.1.3.1" xref="S2.E4.m1.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S2.E4.m1.1.1.1.1" xref="S2.E4.m1.1.1.1.1.cmml">𝒟</mi><mo stretchy="false" id="S2.E4.m1.1.1.1.3.2" xref="S2.E4.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac></mstyle><mo id="S2.E4.m1.3.4.3.1a" xref="S2.E4.m1.3.4.3.1.cmml">⁢</mo><mrow id="S2.E4.m1.3.4.3.3" xref="S2.E4.m1.3.4.3.3.cmml"><mstyle displaystyle="true" id="S2.E4.m1.3.4.3.3.1" xref="S2.E4.m1.3.4.3.3.1.cmml"><munder id="S2.E4.m1.3.4.3.3.1a" xref="S2.E4.m1.3.4.3.3.1.cmml"><mo movablelimits="false" id="S2.E4.m1.3.4.3.3.1.2" xref="S2.E4.m1.3.4.3.3.1.2.cmml">∑</mo><mrow id="S2.E4.m1.3.4.3.3.1.3" xref="S2.E4.m1.3.4.3.3.1.3.cmml"><mi id="S2.E4.m1.3.4.3.3.1.3.2" xref="S2.E4.m1.3.4.3.3.1.3.2.cmml">x</mi><mo id="S2.E4.m1.3.4.3.3.1.3.1" xref="S2.E4.m1.3.4.3.3.1.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.E4.m1.3.4.3.3.1.3.3" xref="S2.E4.m1.3.4.3.3.1.3.3.cmml">𝒟</mi></mrow></munder></mstyle><mrow id="S2.E4.m1.3.4.3.3.2" xref="S2.E4.m1.3.4.3.3.2.cmml"><mrow id="S2.E4.m1.3.4.3.3.2.2" xref="S2.E4.m1.3.4.3.3.2.2.cmml"><mi id="S2.E4.m1.3.4.3.3.2.2.1" xref="S2.E4.m1.3.4.3.3.2.2.1.cmml">log</mi><mo lspace="0.167em" id="S2.E4.m1.3.4.3.3.2.2a" xref="S2.E4.m1.3.4.3.3.2.2.cmml">⁡</mo><msub id="S2.E4.m1.3.4.3.3.2.2.2" xref="S2.E4.m1.3.4.3.3.2.2.2.cmml"><mi id="S2.E4.m1.3.4.3.3.2.2.2.2" xref="S2.E4.m1.3.4.3.3.2.2.2.2.cmml">p</mi><mi id="S2.E4.m1.3.4.3.3.2.2.2.3" xref="S2.E4.m1.3.4.3.3.2.2.2.3.cmml">X</mi></msub></mrow><mo id="S2.E4.m1.3.4.3.3.2.1" xref="S2.E4.m1.3.4.3.3.2.1.cmml">⁢</mo><mrow id="S2.E4.m1.3.4.3.3.2.3.2" xref="S2.E4.m1.3.4.3.3.2.3.1.cmml"><mo stretchy="false" id="S2.E4.m1.3.4.3.3.2.3.2.1" xref="S2.E4.m1.3.4.3.3.2.3.1.cmml">(</mo><mi id="S2.E4.m1.2.2" xref="S2.E4.m1.2.2.cmml">x</mi><mo id="S2.E4.m1.3.4.3.3.2.3.2.2" xref="S2.E4.m1.3.4.3.3.2.3.1.cmml">;</mo><mi id="S2.E4.m1.3.3" xref="S2.E4.m1.3.3.cmml">θ</mi><mo stretchy="false" id="S2.E4.m1.3.4.3.3.2.3.2.3" xref="S2.E4.m1.3.4.3.3.2.3.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E4.m1.3b"><apply id="S2.E4.m1.3.4.cmml" xref="S2.E4.m1.3.4"><eq id="S2.E4.m1.3.4.1.cmml" xref="S2.E4.m1.3.4.1"></eq><apply id="S2.E4.m1.3.4.2.cmml" xref="S2.E4.m1.3.4.2"><csymbol cd="ambiguous" id="S2.E4.m1.3.4.2.1.cmml" xref="S2.E4.m1.3.4.2">superscript</csymbol><ci id="S2.E4.m1.3.4.2.2.cmml" xref="S2.E4.m1.3.4.2.2">𝜃</ci><times id="S2.E4.m1.3.4.2.3.cmml" xref="S2.E4.m1.3.4.2.3"></times></apply><apply id="S2.E4.m1.3.4.3.cmml" xref="S2.E4.m1.3.4.3"><times id="S2.E4.m1.3.4.3.1.cmml" xref="S2.E4.m1.3.4.3.1"></times><apply id="S2.E4.m1.3.4.3.2.cmml" xref="S2.E4.m1.3.4.3.2"><apply id="S2.E4.m1.3.4.3.2.1.cmml" xref="S2.E4.m1.3.4.3.2.1"><in id="S2.E4.m1.3.4.3.2.1.1.cmml" xref="S2.E4.m1.3.4.3.2.1.1"></in><ci id="S2.E4.m1.3.4.3.2.1.2.cmml" xref="S2.E4.m1.3.4.3.2.1.2">𝜃</ci><ci id="S2.E4.m1.3.4.3.2.1.3.cmml" xref="S2.E4.m1.3.4.3.2.1.3">Θ</ci></apply><apply id="S2.E4.m1.3.4.3.2.2.cmml" xref="S2.E4.m1.3.4.3.2.2"><arg id="S2.E4.m1.3.4.3.2.2.1.cmml" xref="S2.E4.m1.3.4.3.2.2.1"></arg><max id="S2.E4.m1.3.4.3.2.2.2.cmml" xref="S2.E4.m1.3.4.3.2.2.2"></max></apply></apply><apply id="S2.E4.m1.1.1.cmml" xref="S2.E4.m1.1.1"><divide id="S2.E4.m1.1.1.2.cmml" xref="S2.E4.m1.1.1"></divide><cn type="integer" id="S2.E4.m1.1.1.3.cmml" xref="S2.E4.m1.1.1.3">1</cn><apply id="S2.E4.m1.1.1.1.2.cmml" xref="S2.E4.m1.1.1.1.3"><abs id="S2.E4.m1.1.1.1.2.1.cmml" xref="S2.E4.m1.1.1.1.3.1"></abs><ci id="S2.E4.m1.1.1.1.1.cmml" xref="S2.E4.m1.1.1.1.1">𝒟</ci></apply></apply><apply id="S2.E4.m1.3.4.3.3.cmml" xref="S2.E4.m1.3.4.3.3"><apply id="S2.E4.m1.3.4.3.3.1.cmml" xref="S2.E4.m1.3.4.3.3.1"><csymbol cd="ambiguous" id="S2.E4.m1.3.4.3.3.1.1.cmml" xref="S2.E4.m1.3.4.3.3.1">subscript</csymbol><sum id="S2.E4.m1.3.4.3.3.1.2.cmml" xref="S2.E4.m1.3.4.3.3.1.2"></sum><apply id="S2.E4.m1.3.4.3.3.1.3.cmml" xref="S2.E4.m1.3.4.3.3.1.3"><in id="S2.E4.m1.3.4.3.3.1.3.1.cmml" xref="S2.E4.m1.3.4.3.3.1.3.1"></in><ci id="S2.E4.m1.3.4.3.3.1.3.2.cmml" xref="S2.E4.m1.3.4.3.3.1.3.2">𝑥</ci><ci id="S2.E4.m1.3.4.3.3.1.3.3.cmml" xref="S2.E4.m1.3.4.3.3.1.3.3">𝒟</ci></apply></apply><apply id="S2.E4.m1.3.4.3.3.2.cmml" xref="S2.E4.m1.3.4.3.3.2"><times id="S2.E4.m1.3.4.3.3.2.1.cmml" xref="S2.E4.m1.3.4.3.3.2.1"></times><apply id="S2.E4.m1.3.4.3.3.2.2.cmml" xref="S2.E4.m1.3.4.3.3.2.2"><log id="S2.E4.m1.3.4.3.3.2.2.1.cmml" xref="S2.E4.m1.3.4.3.3.2.2.1"></log><apply id="S2.E4.m1.3.4.3.3.2.2.2.cmml" xref="S2.E4.m1.3.4.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.E4.m1.3.4.3.3.2.2.2.1.cmml" xref="S2.E4.m1.3.4.3.3.2.2.2">subscript</csymbol><ci id="S2.E4.m1.3.4.3.3.2.2.2.2.cmml" xref="S2.E4.m1.3.4.3.3.2.2.2.2">𝑝</ci><ci id="S2.E4.m1.3.4.3.3.2.2.2.3.cmml" xref="S2.E4.m1.3.4.3.3.2.2.2.3">𝑋</ci></apply></apply><list id="S2.E4.m1.3.4.3.3.2.3.1.cmml" xref="S2.E4.m1.3.4.3.3.2.3.2"><ci id="S2.E4.m1.2.2.cmml" xref="S2.E4.m1.2.2">𝑥</ci><ci id="S2.E4.m1.3.3.cmml" xref="S2.E4.m1.3.3">𝜃</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4.m1.3c">\displaystyle\theta^{*}=\underset{\theta\in\Theta}{\arg\max}\frac{1}{|\mathcal{D}|}\sum_{x\in\mathcal{D}}\log p_{X}(x;\theta)</annotation><annotation encoding="application/x-llamapun" id="S2.E4.m1.3d">italic_θ start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT = start_UNDERACCENT italic_θ ∈ roman_Θ end_UNDERACCENT start_ARG roman_arg roman_max end_ARG divide start_ARG 1 end_ARG start_ARG | caligraphic_D | end_ARG ∑ start_POSTSUBSCRIPT italic_x ∈ caligraphic_D end_POSTSUBSCRIPT roman_log italic_p start_POSTSUBSCRIPT italic_X end_POSTSUBSCRIPT ( italic_x ; italic_θ )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S2.SS2.p2.14" class="ltx_p">, where <math id="S2.SS2.p2.11.m1.1" class="ltx_Math" alttext="\mathcal{D}" display="inline"><semantics id="S2.SS2.p2.11.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p2.11.m1.1.1" xref="S2.SS2.p2.11.m1.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.11.m1.1b"><ci id="S2.SS2.p2.11.m1.1.1.cmml" xref="S2.SS2.p2.11.m1.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.11.m1.1c">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.11.m1.1d">caligraphic_D</annotation></semantics></math> is the observed data and <math id="S2.SS2.p2.12.m2.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S2.SS2.p2.12.m2.1a"><mi id="S2.SS2.p2.12.m2.1.1" xref="S2.SS2.p2.12.m2.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.12.m2.1b"><ci id="S2.SS2.p2.12.m2.1.1.cmml" xref="S2.SS2.p2.12.m2.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.12.m2.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.12.m2.1d">italic_θ</annotation></semantics></math> denotes parameters of <math id="S2.SS2.p2.13.m3.1" class="ltx_Math" alttext="s_{net}" display="inline"><semantics id="S2.SS2.p2.13.m3.1a"><msub id="S2.SS2.p2.13.m3.1.1" xref="S2.SS2.p2.13.m3.1.1.cmml"><mi id="S2.SS2.p2.13.m3.1.1.2" xref="S2.SS2.p2.13.m3.1.1.2.cmml">s</mi><mrow id="S2.SS2.p2.13.m3.1.1.3" xref="S2.SS2.p2.13.m3.1.1.3.cmml"><mi id="S2.SS2.p2.13.m3.1.1.3.2" xref="S2.SS2.p2.13.m3.1.1.3.2.cmml">n</mi><mo id="S2.SS2.p2.13.m3.1.1.3.1" xref="S2.SS2.p2.13.m3.1.1.3.1.cmml">⁢</mo><mi id="S2.SS2.p2.13.m3.1.1.3.3" xref="S2.SS2.p2.13.m3.1.1.3.3.cmml">e</mi><mo id="S2.SS2.p2.13.m3.1.1.3.1a" xref="S2.SS2.p2.13.m3.1.1.3.1.cmml">⁢</mo><mi id="S2.SS2.p2.13.m3.1.1.3.4" xref="S2.SS2.p2.13.m3.1.1.3.4.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.13.m3.1b"><apply id="S2.SS2.p2.13.m3.1.1.cmml" xref="S2.SS2.p2.13.m3.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.13.m3.1.1.1.cmml" xref="S2.SS2.p2.13.m3.1.1">subscript</csymbol><ci id="S2.SS2.p2.13.m3.1.1.2.cmml" xref="S2.SS2.p2.13.m3.1.1.2">𝑠</ci><apply id="S2.SS2.p2.13.m3.1.1.3.cmml" xref="S2.SS2.p2.13.m3.1.1.3"><times id="S2.SS2.p2.13.m3.1.1.3.1.cmml" xref="S2.SS2.p2.13.m3.1.1.3.1"></times><ci id="S2.SS2.p2.13.m3.1.1.3.2.cmml" xref="S2.SS2.p2.13.m3.1.1.3.2">𝑛</ci><ci id="S2.SS2.p2.13.m3.1.1.3.3.cmml" xref="S2.SS2.p2.13.m3.1.1.3.3">𝑒</ci><ci id="S2.SS2.p2.13.m3.1.1.3.4.cmml" xref="S2.SS2.p2.13.m3.1.1.3.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.13.m3.1c">s_{net}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.13.m3.1d">italic_s start_POSTSUBSCRIPT italic_n italic_e italic_t end_POSTSUBSCRIPT</annotation></semantics></math> and <math id="S2.SS2.p2.14.m4.1" class="ltx_Math" alttext="t_{net}" display="inline"><semantics id="S2.SS2.p2.14.m4.1a"><msub id="S2.SS2.p2.14.m4.1.1" xref="S2.SS2.p2.14.m4.1.1.cmml"><mi id="S2.SS2.p2.14.m4.1.1.2" xref="S2.SS2.p2.14.m4.1.1.2.cmml">t</mi><mrow id="S2.SS2.p2.14.m4.1.1.3" xref="S2.SS2.p2.14.m4.1.1.3.cmml"><mi id="S2.SS2.p2.14.m4.1.1.3.2" xref="S2.SS2.p2.14.m4.1.1.3.2.cmml">n</mi><mo id="S2.SS2.p2.14.m4.1.1.3.1" xref="S2.SS2.p2.14.m4.1.1.3.1.cmml">⁢</mo><mi id="S2.SS2.p2.14.m4.1.1.3.3" xref="S2.SS2.p2.14.m4.1.1.3.3.cmml">e</mi><mo id="S2.SS2.p2.14.m4.1.1.3.1a" xref="S2.SS2.p2.14.m4.1.1.3.1.cmml">⁢</mo><mi id="S2.SS2.p2.14.m4.1.1.3.4" xref="S2.SS2.p2.14.m4.1.1.3.4.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.14.m4.1b"><apply id="S2.SS2.p2.14.m4.1.1.cmml" xref="S2.SS2.p2.14.m4.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.14.m4.1.1.1.cmml" xref="S2.SS2.p2.14.m4.1.1">subscript</csymbol><ci id="S2.SS2.p2.14.m4.1.1.2.cmml" xref="S2.SS2.p2.14.m4.1.1.2">𝑡</ci><apply id="S2.SS2.p2.14.m4.1.1.3.cmml" xref="S2.SS2.p2.14.m4.1.1.3"><times id="S2.SS2.p2.14.m4.1.1.3.1.cmml" xref="S2.SS2.p2.14.m4.1.1.3.1"></times><ci id="S2.SS2.p2.14.m4.1.1.3.2.cmml" xref="S2.SS2.p2.14.m4.1.1.3.2">𝑛</ci><ci id="S2.SS2.p2.14.m4.1.1.3.3.cmml" xref="S2.SS2.p2.14.m4.1.1.3.3">𝑒</ci><ci id="S2.SS2.p2.14.m4.1.1.3.4.cmml" xref="S2.SS2.p2.14.m4.1.1.3.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.14.m4.1c">t_{net}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.14.m4.1d">italic_t start_POSTSUBSCRIPT italic_n italic_e italic_t end_POSTSUBSCRIPT</annotation></semantics></math> functions.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">III </span><span id="S3.1.1" class="ltx_text ltx_font_smallcaps">Methodology</span>
</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">The problem statement of MTS anomaly detection and the function and principle of each component in our framework (as shown in figure <a href="#S3.F2" title="Figure 2 ‣ III-B Timestamp-level Anomaly Detection ‣ III Methodology ‣ Generative Anomaly Detection for Time Series Datasets" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>) are concentrated and discussed in this section.</p>
</div>
<figure id="S3.T1" class="ltx_table">
<table id="S3.T1.28" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S3.T1.28.29.1" class="ltx_tr">
<th id="S3.T1.28.29.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">Symbol</th>
<th id="S3.T1.28.29.1.2" class="ltx_td ltx_align_justify ltx_th ltx_th_column ltx_border_t" style="width:193.5pt;padding-left:3.0pt;padding-right:3.0pt;">
<p id="S3.T1.28.29.1.2.1" class="ltx_p ltx_align_top">Description</p>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S3.T1.1.1" class="ltx_tr">
<th id="S3.T1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;"><math id="S3.T1.1.1.1.m1.1" class="ltx_Math" alttext="\mathcal{D}" display="inline"><semantics id="S3.T1.1.1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.T1.1.1.1.m1.1.1" xref="S3.T1.1.1.1.m1.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S3.T1.1.1.1.m1.1b"><ci id="S3.T1.1.1.1.m1.1.1.cmml" xref="S3.T1.1.1.1.m1.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.1.1.1.m1.1c">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.1.1.1.m1.1d">caligraphic_D</annotation></semantics></math></th>
<td id="S3.T1.1.1.2" class="ltx_td ltx_align_justify ltx_border_t" style="width:193.5pt;padding-left:3.0pt;padding-right:3.0pt;">
<p id="S3.T1.1.1.2.1" class="ltx_p ltx_align_top">the traffic congestion dataset</p>
</td>
</tr>
<tr id="S3.T1.2.2" class="ltx_tr">
<th id="S3.T1.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;"><math id="S3.T1.2.2.1.m1.1" class="ltx_Math" alttext="X" display="inline"><semantics id="S3.T1.2.2.1.m1.1a"><mi id="S3.T1.2.2.1.m1.1.1" xref="S3.T1.2.2.1.m1.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S3.T1.2.2.1.m1.1b"><ci id="S3.T1.2.2.1.m1.1.1.cmml" xref="S3.T1.2.2.1.m1.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.2.2.1.m1.1c">X</annotation><annotation encoding="application/x-llamapun" id="S3.T1.2.2.1.m1.1d">italic_X</annotation></semantics></math></th>
<td id="S3.T1.2.2.2" class="ltx_td ltx_align_justify ltx_border_t" style="width:193.5pt;padding-left:3.0pt;padding-right:3.0pt;">
<p id="S3.T1.2.2.2.1" class="ltx_p ltx_align_top">set of congestion rate time series</p>
</td>
</tr>
<tr id="S3.T1.3.3" class="ltx_tr">
<th id="S3.T1.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;"><math id="S3.T1.3.3.1.m1.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S3.T1.3.3.1.m1.1a"><mi id="S3.T1.3.3.1.m1.1.1" xref="S3.T1.3.3.1.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.T1.3.3.1.m1.1b"><ci id="S3.T1.3.3.1.m1.1.1.cmml" xref="S3.T1.3.3.1.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.3.3.1.m1.1c">T</annotation><annotation encoding="application/x-llamapun" id="S3.T1.3.3.1.m1.1d">italic_T</annotation></semantics></math></th>
<td id="S3.T1.3.3.2" class="ltx_td ltx_align_justify ltx_border_t" style="width:193.5pt;padding-left:3.0pt;padding-right:3.0pt;">
<p id="S3.T1.3.3.2.1" class="ltx_p ltx_align_top">total length of the traffic dataset</p>
</td>
</tr>
<tr id="S3.T1.4.4" class="ltx_tr">
<th id="S3.T1.4.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;"><math id="S3.T1.4.4.1.m1.2" class="ltx_Math" alttext="i,t" display="inline"><semantics id="S3.T1.4.4.1.m1.2a"><mrow id="S3.T1.4.4.1.m1.2.3.2" xref="S3.T1.4.4.1.m1.2.3.1.cmml"><mi id="S3.T1.4.4.1.m1.1.1" xref="S3.T1.4.4.1.m1.1.1.cmml">i</mi><mo id="S3.T1.4.4.1.m1.2.3.2.1" xref="S3.T1.4.4.1.m1.2.3.1.cmml">,</mo><mi id="S3.T1.4.4.1.m1.2.2" xref="S3.T1.4.4.1.m1.2.2.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.4.4.1.m1.2b"><list id="S3.T1.4.4.1.m1.2.3.1.cmml" xref="S3.T1.4.4.1.m1.2.3.2"><ci id="S3.T1.4.4.1.m1.1.1.cmml" xref="S3.T1.4.4.1.m1.1.1">𝑖</ci><ci id="S3.T1.4.4.1.m1.2.2.cmml" xref="S3.T1.4.4.1.m1.2.2">𝑡</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.4.4.1.m1.2c">i,t</annotation><annotation encoding="application/x-llamapun" id="S3.T1.4.4.1.m1.2d">italic_i , italic_t</annotation></semantics></math></th>
<td id="S3.T1.4.4.2" class="ltx_td ltx_align_justify ltx_border_t" style="width:193.5pt;padding-left:3.0pt;padding-right:3.0pt;">
<p id="S3.T1.4.4.2.1" class="ltx_p ltx_align_top">a specific roadway segment and time step</p>
</td>
</tr>
<tr id="S3.T1.5.5" class="ltx_tr">
<th id="S3.T1.5.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;"><math id="S3.T1.5.5.1.m1.1" class="ltx_Math" alttext="\lambda^{t}" display="inline"><semantics id="S3.T1.5.5.1.m1.1a"><msup id="S3.T1.5.5.1.m1.1.1" xref="S3.T1.5.5.1.m1.1.1.cmml"><mi id="S3.T1.5.5.1.m1.1.1.2" xref="S3.T1.5.5.1.m1.1.1.2.cmml">λ</mi><mi id="S3.T1.5.5.1.m1.1.1.3" xref="S3.T1.5.5.1.m1.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S3.T1.5.5.1.m1.1b"><apply id="S3.T1.5.5.1.m1.1.1.cmml" xref="S3.T1.5.5.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.5.5.1.m1.1.1.1.cmml" xref="S3.T1.5.5.1.m1.1.1">superscript</csymbol><ci id="S3.T1.5.5.1.m1.1.1.2.cmml" xref="S3.T1.5.5.1.m1.1.1.2">𝜆</ci><ci id="S3.T1.5.5.1.m1.1.1.3.cmml" xref="S3.T1.5.5.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.5.5.1.m1.1c">\lambda^{t}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.5.5.1.m1.1d">italic_λ start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math></th>
<td id="S3.T1.5.5.2" class="ltx_td ltx_align_justify ltx_border_t" style="width:193.5pt;padding-left:3.0pt;padding-right:3.0pt;">
<p id="S3.T1.5.5.2.1" class="ltx_p ltx_align_top">a time feature vector for time t</p>
</td>
</tr>
<tr id="S3.T1.6.6" class="ltx_tr">
<th id="S3.T1.6.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;"><math id="S3.T1.6.6.1.m1.1" class="ltx_Math" alttext="S_{i}" display="inline"><semantics id="S3.T1.6.6.1.m1.1a"><msub id="S3.T1.6.6.1.m1.1.1" xref="S3.T1.6.6.1.m1.1.1.cmml"><mi id="S3.T1.6.6.1.m1.1.1.2" xref="S3.T1.6.6.1.m1.1.1.2.cmml">S</mi><mi id="S3.T1.6.6.1.m1.1.1.3" xref="S3.T1.6.6.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.T1.6.6.1.m1.1b"><apply id="S3.T1.6.6.1.m1.1.1.cmml" xref="S3.T1.6.6.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.6.6.1.m1.1.1.1.cmml" xref="S3.T1.6.6.1.m1.1.1">subscript</csymbol><ci id="S3.T1.6.6.1.m1.1.1.2.cmml" xref="S3.T1.6.6.1.m1.1.1.2">𝑆</ci><ci id="S3.T1.6.6.1.m1.1.1.3.cmml" xref="S3.T1.6.6.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.6.6.1.m1.1c">S_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.6.6.1.m1.1d">italic_S start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math></th>
<td id="S3.T1.6.6.2" class="ltx_td ltx_align_justify ltx_border_t" style="width:193.5pt;padding-left:3.0pt;padding-right:3.0pt;">
<p id="S3.T1.6.6.2.1" class="ltx_p ltx_align_top">the <span id="S3.T1.6.6.2.1.1" class="ltx_text ltx_font_italic">i</span>th road segment</p>
</td>
</tr>
<tr id="S3.T1.7.7" class="ltx_tr">
<th id="S3.T1.7.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;"><math id="S3.T1.7.7.1.m1.1" class="ltx_Math" alttext="x_{i}" display="inline"><semantics id="S3.T1.7.7.1.m1.1a"><msub id="S3.T1.7.7.1.m1.1.1" xref="S3.T1.7.7.1.m1.1.1.cmml"><mi id="S3.T1.7.7.1.m1.1.1.2" xref="S3.T1.7.7.1.m1.1.1.2.cmml">x</mi><mi id="S3.T1.7.7.1.m1.1.1.3" xref="S3.T1.7.7.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.T1.7.7.1.m1.1b"><apply id="S3.T1.7.7.1.m1.1.1.cmml" xref="S3.T1.7.7.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.7.7.1.m1.1.1.1.cmml" xref="S3.T1.7.7.1.m1.1.1">subscript</csymbol><ci id="S3.T1.7.7.1.m1.1.1.2.cmml" xref="S3.T1.7.7.1.m1.1.1.2">𝑥</ci><ci id="S3.T1.7.7.1.m1.1.1.3.cmml" xref="S3.T1.7.7.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.7.7.1.m1.1c">x_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.7.7.1.m1.1d">italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math></th>
<td id="S3.T1.7.7.2" class="ltx_td ltx_align_justify ltx_border_t" style="width:193.5pt;padding-left:3.0pt;padding-right:3.0pt;">
<p id="S3.T1.7.7.2.1" class="ltx_p ltx_align_top">univariate time series, congestion rate of the <span id="S3.T1.7.7.2.1.1" class="ltx_text ltx_font_italic">i</span>th road segment</p>
</td>
</tr>
<tr id="S3.T1.8.8" class="ltx_tr">
<th id="S3.T1.8.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;"><math id="S3.T1.8.8.1.m1.1" class="ltx_Math" alttext="x^{t}" display="inline"><semantics id="S3.T1.8.8.1.m1.1a"><msup id="S3.T1.8.8.1.m1.1.1" xref="S3.T1.8.8.1.m1.1.1.cmml"><mi id="S3.T1.8.8.1.m1.1.1.2" xref="S3.T1.8.8.1.m1.1.1.2.cmml">x</mi><mi id="S3.T1.8.8.1.m1.1.1.3" xref="S3.T1.8.8.1.m1.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S3.T1.8.8.1.m1.1b"><apply id="S3.T1.8.8.1.m1.1.1.cmml" xref="S3.T1.8.8.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.8.8.1.m1.1.1.1.cmml" xref="S3.T1.8.8.1.m1.1.1">superscript</csymbol><ci id="S3.T1.8.8.1.m1.1.1.2.cmml" xref="S3.T1.8.8.1.m1.1.1.2">𝑥</ci><ci id="S3.T1.8.8.1.m1.1.1.3.cmml" xref="S3.T1.8.8.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.8.8.1.m1.1c">x^{t}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.8.8.1.m1.1d">italic_x start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math></th>
<td id="S3.T1.8.8.2" class="ltx_td ltx_align_justify ltx_border_t" style="width:193.5pt;padding-left:3.0pt;padding-right:3.0pt;">
<p id="S3.T1.8.8.2.1" class="ltx_p ltx_align_top">a vector of congestion values at time t</p>
</td>
</tr>
<tr id="S3.T1.9.9" class="ltx_tr">
<th id="S3.T1.9.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;"><math id="S3.T1.9.9.1.m1.1" class="ltx_Math" alttext="x_{i}^{t}" display="inline"><semantics id="S3.T1.9.9.1.m1.1a"><msubsup id="S3.T1.9.9.1.m1.1.1" xref="S3.T1.9.9.1.m1.1.1.cmml"><mi id="S3.T1.9.9.1.m1.1.1.2.2" xref="S3.T1.9.9.1.m1.1.1.2.2.cmml">x</mi><mi id="S3.T1.9.9.1.m1.1.1.2.3" xref="S3.T1.9.9.1.m1.1.1.2.3.cmml">i</mi><mi id="S3.T1.9.9.1.m1.1.1.3" xref="S3.T1.9.9.1.m1.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.T1.9.9.1.m1.1b"><apply id="S3.T1.9.9.1.m1.1.1.cmml" xref="S3.T1.9.9.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.9.9.1.m1.1.1.1.cmml" xref="S3.T1.9.9.1.m1.1.1">superscript</csymbol><apply id="S3.T1.9.9.1.m1.1.1.2.cmml" xref="S3.T1.9.9.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.9.9.1.m1.1.1.2.1.cmml" xref="S3.T1.9.9.1.m1.1.1">subscript</csymbol><ci id="S3.T1.9.9.1.m1.1.1.2.2.cmml" xref="S3.T1.9.9.1.m1.1.1.2.2">𝑥</ci><ci id="S3.T1.9.9.1.m1.1.1.2.3.cmml" xref="S3.T1.9.9.1.m1.1.1.2.3">𝑖</ci></apply><ci id="S3.T1.9.9.1.m1.1.1.3.cmml" xref="S3.T1.9.9.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.9.9.1.m1.1c">x_{i}^{t}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.9.9.1.m1.1d">italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math></th>
<td id="S3.T1.9.9.2" class="ltx_td ltx_align_justify ltx_border_t" style="width:193.5pt;padding-left:3.0pt;padding-right:3.0pt;">
<p id="S3.T1.9.9.2.1" class="ltx_p ltx_align_top">congestion rate of the <span id="S3.T1.9.9.2.1.1" class="ltx_text ltx_font_italic">i</span>th road segment at time t</p>
</td>
</tr>
<tr id="S3.T1.10.10" class="ltx_tr">
<th id="S3.T1.10.10.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;"><math id="S3.T1.10.10.1.m1.2" class="ltx_Math" alttext="\bar{v}_{i}^{t},v_{i}^{t}" display="inline"><semantics id="S3.T1.10.10.1.m1.2a"><mrow id="S3.T1.10.10.1.m1.2.2.2" xref="S3.T1.10.10.1.m1.2.2.3.cmml"><msubsup id="S3.T1.10.10.1.m1.1.1.1.1" xref="S3.T1.10.10.1.m1.1.1.1.1.cmml"><mover accent="true" id="S3.T1.10.10.1.m1.1.1.1.1.2.2" xref="S3.T1.10.10.1.m1.1.1.1.1.2.2.cmml"><mi id="S3.T1.10.10.1.m1.1.1.1.1.2.2.2" xref="S3.T1.10.10.1.m1.1.1.1.1.2.2.2.cmml">v</mi><mo id="S3.T1.10.10.1.m1.1.1.1.1.2.2.1" xref="S3.T1.10.10.1.m1.1.1.1.1.2.2.1.cmml">¯</mo></mover><mi id="S3.T1.10.10.1.m1.1.1.1.1.2.3" xref="S3.T1.10.10.1.m1.1.1.1.1.2.3.cmml">i</mi><mi id="S3.T1.10.10.1.m1.1.1.1.1.3" xref="S3.T1.10.10.1.m1.1.1.1.1.3.cmml">t</mi></msubsup><mo id="S3.T1.10.10.1.m1.2.2.2.3" xref="S3.T1.10.10.1.m1.2.2.3.cmml">,</mo><msubsup id="S3.T1.10.10.1.m1.2.2.2.2" xref="S3.T1.10.10.1.m1.2.2.2.2.cmml"><mi id="S3.T1.10.10.1.m1.2.2.2.2.2.2" xref="S3.T1.10.10.1.m1.2.2.2.2.2.2.cmml">v</mi><mi id="S3.T1.10.10.1.m1.2.2.2.2.2.3" xref="S3.T1.10.10.1.m1.2.2.2.2.2.3.cmml">i</mi><mi id="S3.T1.10.10.1.m1.2.2.2.2.3" xref="S3.T1.10.10.1.m1.2.2.2.2.3.cmml">t</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.10.10.1.m1.2b"><list id="S3.T1.10.10.1.m1.2.2.3.cmml" xref="S3.T1.10.10.1.m1.2.2.2"><apply id="S3.T1.10.10.1.m1.1.1.1.1.cmml" xref="S3.T1.10.10.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.T1.10.10.1.m1.1.1.1.1.1.cmml" xref="S3.T1.10.10.1.m1.1.1.1.1">superscript</csymbol><apply id="S3.T1.10.10.1.m1.1.1.1.1.2.cmml" xref="S3.T1.10.10.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.T1.10.10.1.m1.1.1.1.1.2.1.cmml" xref="S3.T1.10.10.1.m1.1.1.1.1">subscript</csymbol><apply id="S3.T1.10.10.1.m1.1.1.1.1.2.2.cmml" xref="S3.T1.10.10.1.m1.1.1.1.1.2.2"><ci id="S3.T1.10.10.1.m1.1.1.1.1.2.2.1.cmml" xref="S3.T1.10.10.1.m1.1.1.1.1.2.2.1">¯</ci><ci id="S3.T1.10.10.1.m1.1.1.1.1.2.2.2.cmml" xref="S3.T1.10.10.1.m1.1.1.1.1.2.2.2">𝑣</ci></apply><ci id="S3.T1.10.10.1.m1.1.1.1.1.2.3.cmml" xref="S3.T1.10.10.1.m1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S3.T1.10.10.1.m1.1.1.1.1.3.cmml" xref="S3.T1.10.10.1.m1.1.1.1.1.3">𝑡</ci></apply><apply id="S3.T1.10.10.1.m1.2.2.2.2.cmml" xref="S3.T1.10.10.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="S3.T1.10.10.1.m1.2.2.2.2.1.cmml" xref="S3.T1.10.10.1.m1.2.2.2.2">superscript</csymbol><apply id="S3.T1.10.10.1.m1.2.2.2.2.2.cmml" xref="S3.T1.10.10.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="S3.T1.10.10.1.m1.2.2.2.2.2.1.cmml" xref="S3.T1.10.10.1.m1.2.2.2.2">subscript</csymbol><ci id="S3.T1.10.10.1.m1.2.2.2.2.2.2.cmml" xref="S3.T1.10.10.1.m1.2.2.2.2.2.2">𝑣</ci><ci id="S3.T1.10.10.1.m1.2.2.2.2.2.3.cmml" xref="S3.T1.10.10.1.m1.2.2.2.2.2.3">𝑖</ci></apply><ci id="S3.T1.10.10.1.m1.2.2.2.2.3.cmml" xref="S3.T1.10.10.1.m1.2.2.2.2.3">𝑡</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.10.10.1.m1.2c">\bar{v}_{i}^{t},v_{i}^{t}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.10.10.1.m1.2d">over¯ start_ARG italic_v end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT , italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math></th>
<td id="S3.T1.10.10.2" class="ltx_td ltx_align_justify ltx_border_t" style="width:193.5pt;padding-left:3.0pt;padding-right:3.0pt;">
<p id="S3.T1.10.10.2.1" class="ltx_p ltx_align_top">historical average speed and harmonic mean speed of the <span id="S3.T1.10.10.2.1.1" class="ltx_text ltx_font_italic">i</span>th segment at time t</p>
</td>
</tr>
<tr id="S3.T1.11.11" class="ltx_tr">
<th id="S3.T1.11.11.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;"><math id="S3.T1.11.11.1.m1.1" class="ltx_Math" alttext="\hat{v}_{i}" display="inline"><semantics id="S3.T1.11.11.1.m1.1a"><msub id="S3.T1.11.11.1.m1.1.1" xref="S3.T1.11.11.1.m1.1.1.cmml"><mover accent="true" id="S3.T1.11.11.1.m1.1.1.2" xref="S3.T1.11.11.1.m1.1.1.2.cmml"><mi id="S3.T1.11.11.1.m1.1.1.2.2" xref="S3.T1.11.11.1.m1.1.1.2.2.cmml">v</mi><mo id="S3.T1.11.11.1.m1.1.1.2.1" xref="S3.T1.11.11.1.m1.1.1.2.1.cmml">^</mo></mover><mi id="S3.T1.11.11.1.m1.1.1.3" xref="S3.T1.11.11.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.T1.11.11.1.m1.1b"><apply id="S3.T1.11.11.1.m1.1.1.cmml" xref="S3.T1.11.11.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.11.11.1.m1.1.1.1.cmml" xref="S3.T1.11.11.1.m1.1.1">subscript</csymbol><apply id="S3.T1.11.11.1.m1.1.1.2.cmml" xref="S3.T1.11.11.1.m1.1.1.2"><ci id="S3.T1.11.11.1.m1.1.1.2.1.cmml" xref="S3.T1.11.11.1.m1.1.1.2.1">^</ci><ci id="S3.T1.11.11.1.m1.1.1.2.2.cmml" xref="S3.T1.11.11.1.m1.1.1.2.2">𝑣</ci></apply><ci id="S3.T1.11.11.1.m1.1.1.3.cmml" xref="S3.T1.11.11.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.11.11.1.m1.1c">\hat{v}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.11.11.1.m1.1d">over^ start_ARG italic_v end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math></th>
<td id="S3.T1.11.11.2" class="ltx_td ltx_align_justify ltx_border_t" style="width:193.5pt;padding-left:3.0pt;padding-right:3.0pt;">
<p id="S3.T1.11.11.2.1" class="ltx_p ltx_align_top">free-flow speed of the <span id="S3.T1.11.11.2.1.1" class="ltx_text ltx_font_italic">i</span>th segment</p>
</td>
</tr>
<tr id="S3.T1.12.12" class="ltx_tr">
<th id="S3.T1.12.12.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;"><math id="S3.T1.12.12.1.m1.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="S3.T1.12.12.1.m1.1a"><mi id="S3.T1.12.12.1.m1.1.1" xref="S3.T1.12.12.1.m1.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S3.T1.12.12.1.m1.1b"><ci id="S3.T1.12.12.1.m1.1.1.cmml" xref="S3.T1.12.12.1.m1.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.12.12.1.m1.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="S3.T1.12.12.1.m1.1d">italic_τ</annotation></semantics></math></th>
<td id="S3.T1.12.12.2" class="ltx_td ltx_align_justify ltx_border_t" style="width:193.5pt;padding-left:3.0pt;padding-right:3.0pt;">
<p id="S3.T1.12.12.2.1" class="ltx_p ltx_align_top">the length of a sliding window</p>
</td>
</tr>
<tr id="S3.T1.13.13" class="ltx_tr">
<th id="S3.T1.13.13.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;"><math id="S3.T1.13.13.1.m1.1" class="ltx_Math" alttext="t_{0}" display="inline"><semantics id="S3.T1.13.13.1.m1.1a"><msub id="S3.T1.13.13.1.m1.1.1" xref="S3.T1.13.13.1.m1.1.1.cmml"><mi id="S3.T1.13.13.1.m1.1.1.2" xref="S3.T1.13.13.1.m1.1.1.2.cmml">t</mi><mn id="S3.T1.13.13.1.m1.1.1.3" xref="S3.T1.13.13.1.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.T1.13.13.1.m1.1b"><apply id="S3.T1.13.13.1.m1.1.1.cmml" xref="S3.T1.13.13.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.13.13.1.m1.1.1.1.cmml" xref="S3.T1.13.13.1.m1.1.1">subscript</csymbol><ci id="S3.T1.13.13.1.m1.1.1.2.cmml" xref="S3.T1.13.13.1.m1.1.1.2">𝑡</ci><cn type="integer" id="S3.T1.13.13.1.m1.1.1.3.cmml" xref="S3.T1.13.13.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.13.13.1.m1.1c">t_{0}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.13.13.1.m1.1d">italic_t start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math></th>
<td id="S3.T1.13.13.2" class="ltx_td ltx_align_justify ltx_border_t" style="width:193.5pt;padding-left:3.0pt;padding-right:3.0pt;">
<p id="S3.T1.13.13.2.1" class="ltx_p ltx_align_top">the start time step of the prediction window in a sliding window</p>
</td>
</tr>
<tr id="S3.T1.14.14" class="ltx_tr">
<th id="S3.T1.14.14.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;"><math id="S3.T1.14.14.1.m1.1" class="ltx_Math" alttext="B" display="inline"><semantics id="S3.T1.14.14.1.m1.1a"><mi id="S3.T1.14.14.1.m1.1.1" xref="S3.T1.14.14.1.m1.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S3.T1.14.14.1.m1.1b"><ci id="S3.T1.14.14.1.m1.1.1.cmml" xref="S3.T1.14.14.1.m1.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.14.14.1.m1.1c">B</annotation><annotation encoding="application/x-llamapun" id="S3.T1.14.14.1.m1.1d">italic_B</annotation></semantics></math></th>
<td id="S3.T1.14.14.2" class="ltx_td ltx_align_justify ltx_border_t" style="width:193.5pt;padding-left:3.0pt;padding-right:3.0pt;">
<p id="S3.T1.14.14.2.1" class="ltx_p ltx_align_top">a batch of sliding windows</p>
</td>
</tr>
<tr id="S3.T1.15.15" class="ltx_tr">
<th id="S3.T1.15.15.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;"><math id="S3.T1.15.15.1.m1.1" class="ltx_Math" alttext="e" display="inline"><semantics id="S3.T1.15.15.1.m1.1a"><mi id="S3.T1.15.15.1.m1.1.1" xref="S3.T1.15.15.1.m1.1.1.cmml">e</mi><annotation-xml encoding="MathML-Content" id="S3.T1.15.15.1.m1.1b"><ci id="S3.T1.15.15.1.m1.1.1.cmml" xref="S3.T1.15.15.1.m1.1.1">𝑒</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.15.15.1.m1.1c">e</annotation><annotation encoding="application/x-llamapun" id="S3.T1.15.15.1.m1.1d">italic_e</annotation></semantics></math></th>
<td id="S3.T1.15.15.2" class="ltx_td ltx_align_justify ltx_border_t" style="width:193.5pt;padding-left:3.0pt;padding-right:3.0pt;">
<p id="S3.T1.15.15.2.1" class="ltx_p ltx_align_top">encoding vector produced by Encoder for a specific context window</p>
</td>
</tr>
<tr id="S3.T1.16.16" class="ltx_tr">
<th id="S3.T1.16.16.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;"><math id="S3.T1.16.16.1.m1.1" class="ltx_Math" alttext="h^{t}" display="inline"><semantics id="S3.T1.16.16.1.m1.1a"><msup id="S3.T1.16.16.1.m1.1.1" xref="S3.T1.16.16.1.m1.1.1.cmml"><mi id="S3.T1.16.16.1.m1.1.1.2" xref="S3.T1.16.16.1.m1.1.1.2.cmml">h</mi><mi id="S3.T1.16.16.1.m1.1.1.3" xref="S3.T1.16.16.1.m1.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S3.T1.16.16.1.m1.1b"><apply id="S3.T1.16.16.1.m1.1.1.cmml" xref="S3.T1.16.16.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.16.16.1.m1.1.1.1.cmml" xref="S3.T1.16.16.1.m1.1.1">superscript</csymbol><ci id="S3.T1.16.16.1.m1.1.1.2.cmml" xref="S3.T1.16.16.1.m1.1.1.2">ℎ</ci><ci id="S3.T1.16.16.1.m1.1.1.3.cmml" xref="S3.T1.16.16.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.16.16.1.m1.1c">h^{t}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.16.16.1.m1.1d">italic_h start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math></th>
<td id="S3.T1.16.16.2" class="ltx_td ltx_align_justify ltx_border_t" style="width:193.5pt;padding-left:3.0pt;padding-right:3.0pt;">
<p id="S3.T1.16.16.2.1" class="ltx_p ltx_align_top">LSTM hidden states at time t</p>
</td>
</tr>
<tr id="S3.T1.17.17" class="ltx_tr">
<th id="S3.T1.17.17.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;"><math id="S3.T1.17.17.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.T1.17.17.1.m1.1a"><mi id="S3.T1.17.17.1.m1.1.1" xref="S3.T1.17.17.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.T1.17.17.1.m1.1b"><ci id="S3.T1.17.17.1.m1.1.1.cmml" xref="S3.T1.17.17.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.17.17.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.T1.17.17.1.m1.1d">italic_K</annotation></semantics></math></th>
<td id="S3.T1.17.17.2" class="ltx_td ltx_align_justify ltx_border_t" style="width:193.5pt;padding-left:3.0pt;padding-right:3.0pt;">
<p id="S3.T1.17.17.2.1" class="ltx_p ltx_align_top">the number of Coupling layer and Batch normalizing layer in the RealNVP model</p>
</td>
</tr>
<tr id="S3.T1.18.18" class="ltx_tr">
<th id="S3.T1.18.18.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;"><math id="S3.T1.18.18.1.m1.1" class="ltx_Math" alttext="z" display="inline"><semantics id="S3.T1.18.18.1.m1.1a"><mi id="S3.T1.18.18.1.m1.1.1" xref="S3.T1.18.18.1.m1.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S3.T1.18.18.1.m1.1b"><ci id="S3.T1.18.18.1.m1.1.1.cmml" xref="S3.T1.18.18.1.m1.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.18.18.1.m1.1c">z</annotation><annotation encoding="application/x-llamapun" id="S3.T1.18.18.1.m1.1d">italic_z</annotation></semantics></math></th>
<td id="S3.T1.18.18.2" class="ltx_td ltx_align_justify ltx_border_t" style="width:193.5pt;padding-left:3.0pt;padding-right:3.0pt;">
<p id="S3.T1.18.18.2.1" class="ltx_p ltx_align_top">the base distribution of the flow model</p>
</td>
</tr>
<tr id="S3.T1.19.19" class="ltx_tr">
<th id="S3.T1.19.19.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;"><math id="S3.T1.19.19.1.m1.1" class="ltx_Math" alttext="y" display="inline"><semantics id="S3.T1.19.19.1.m1.1a"><mi id="S3.T1.19.19.1.m1.1.1" xref="S3.T1.19.19.1.m1.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S3.T1.19.19.1.m1.1b"><ci id="S3.T1.19.19.1.m1.1.1.cmml" xref="S3.T1.19.19.1.m1.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.19.19.1.m1.1c">y</annotation><annotation encoding="application/x-llamapun" id="S3.T1.19.19.1.m1.1d">italic_y</annotation></semantics></math></th>
<td id="S3.T1.19.19.2" class="ltx_td ltx_align_justify ltx_border_t" style="width:193.5pt;padding-left:3.0pt;padding-right:3.0pt;">
<p id="S3.T1.19.19.2.1" class="ltx_p ltx_align_top">an arbitrary latent representation learned as part of the transformation in flow model</p>
</td>
</tr>
<tr id="S3.T1.21.21" class="ltx_tr">
<th id="S3.T1.20.20.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;"><math id="S3.T1.20.20.1.m1.1" class="ltx_Math" alttext="p(x^{t})" display="inline"><semantics id="S3.T1.20.20.1.m1.1a"><mrow id="S3.T1.20.20.1.m1.1.1" xref="S3.T1.20.20.1.m1.1.1.cmml"><mi id="S3.T1.20.20.1.m1.1.1.3" xref="S3.T1.20.20.1.m1.1.1.3.cmml">p</mi><mo id="S3.T1.20.20.1.m1.1.1.2" xref="S3.T1.20.20.1.m1.1.1.2.cmml">⁢</mo><mrow id="S3.T1.20.20.1.m1.1.1.1.1" xref="S3.T1.20.20.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.T1.20.20.1.m1.1.1.1.1.2" xref="S3.T1.20.20.1.m1.1.1.1.1.1.cmml">(</mo><msup id="S3.T1.20.20.1.m1.1.1.1.1.1" xref="S3.T1.20.20.1.m1.1.1.1.1.1.cmml"><mi id="S3.T1.20.20.1.m1.1.1.1.1.1.2" xref="S3.T1.20.20.1.m1.1.1.1.1.1.2.cmml">x</mi><mi id="S3.T1.20.20.1.m1.1.1.1.1.1.3" xref="S3.T1.20.20.1.m1.1.1.1.1.1.3.cmml">t</mi></msup><mo stretchy="false" id="S3.T1.20.20.1.m1.1.1.1.1.3" xref="S3.T1.20.20.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.20.20.1.m1.1b"><apply id="S3.T1.20.20.1.m1.1.1.cmml" xref="S3.T1.20.20.1.m1.1.1"><times id="S3.T1.20.20.1.m1.1.1.2.cmml" xref="S3.T1.20.20.1.m1.1.1.2"></times><ci id="S3.T1.20.20.1.m1.1.1.3.cmml" xref="S3.T1.20.20.1.m1.1.1.3">𝑝</ci><apply id="S3.T1.20.20.1.m1.1.1.1.1.1.cmml" xref="S3.T1.20.20.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.T1.20.20.1.m1.1.1.1.1.1.1.cmml" xref="S3.T1.20.20.1.m1.1.1.1.1">superscript</csymbol><ci id="S3.T1.20.20.1.m1.1.1.1.1.1.2.cmml" xref="S3.T1.20.20.1.m1.1.1.1.1.1.2">𝑥</ci><ci id="S3.T1.20.20.1.m1.1.1.1.1.1.3.cmml" xref="S3.T1.20.20.1.m1.1.1.1.1.1.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.20.20.1.m1.1c">p(x^{t})</annotation><annotation encoding="application/x-llamapun" id="S3.T1.20.20.1.m1.1d">italic_p ( italic_x start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT )</annotation></semantics></math></th>
<td id="S3.T1.21.21.2" class="ltx_td ltx_align_justify ltx_border_t" style="width:193.5pt;padding-left:3.0pt;padding-right:3.0pt;">
<p id="S3.T1.21.21.2.1.1" class="ltx_p ltx_align_top">probability density of <math id="S3.T1.21.21.2.1.1.m1.1" class="ltx_Math" alttext="x^{t}" display="inline"><semantics id="S3.T1.21.21.2.1.1.m1.1a"><msup id="S3.T1.21.21.2.1.1.m1.1.1" xref="S3.T1.21.21.2.1.1.m1.1.1.cmml"><mi id="S3.T1.21.21.2.1.1.m1.1.1.2" xref="S3.T1.21.21.2.1.1.m1.1.1.2.cmml">x</mi><mi id="S3.T1.21.21.2.1.1.m1.1.1.3" xref="S3.T1.21.21.2.1.1.m1.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S3.T1.21.21.2.1.1.m1.1b"><apply id="S3.T1.21.21.2.1.1.m1.1.1.cmml" xref="S3.T1.21.21.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.21.21.2.1.1.m1.1.1.1.cmml" xref="S3.T1.21.21.2.1.1.m1.1.1">superscript</csymbol><ci id="S3.T1.21.21.2.1.1.m1.1.1.2.cmml" xref="S3.T1.21.21.2.1.1.m1.1.1.2">𝑥</ci><ci id="S3.T1.21.21.2.1.1.m1.1.1.3.cmml" xref="S3.T1.21.21.2.1.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.21.21.2.1.1.m1.1c">x^{t}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.21.21.2.1.1.m1.1d">italic_x start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math></p>
</td>
</tr>
<tr id="S3.T1.23.23" class="ltx_tr">
<th id="S3.T1.22.22.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;"><math id="S3.T1.22.22.1.m1.2" class="ltx_Math" alttext="s_{net},t_{net}" display="inline"><semantics id="S3.T1.22.22.1.m1.2a"><mrow id="S3.T1.22.22.1.m1.2.2.2" xref="S3.T1.22.22.1.m1.2.2.3.cmml"><msub id="S3.T1.22.22.1.m1.1.1.1.1" xref="S3.T1.22.22.1.m1.1.1.1.1.cmml"><mi id="S3.T1.22.22.1.m1.1.1.1.1.2" xref="S3.T1.22.22.1.m1.1.1.1.1.2.cmml">s</mi><mrow id="S3.T1.22.22.1.m1.1.1.1.1.3" xref="S3.T1.22.22.1.m1.1.1.1.1.3.cmml"><mi id="S3.T1.22.22.1.m1.1.1.1.1.3.2" xref="S3.T1.22.22.1.m1.1.1.1.1.3.2.cmml">n</mi><mo id="S3.T1.22.22.1.m1.1.1.1.1.3.1" xref="S3.T1.22.22.1.m1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S3.T1.22.22.1.m1.1.1.1.1.3.3" xref="S3.T1.22.22.1.m1.1.1.1.1.3.3.cmml">e</mi><mo id="S3.T1.22.22.1.m1.1.1.1.1.3.1a" xref="S3.T1.22.22.1.m1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S3.T1.22.22.1.m1.1.1.1.1.3.4" xref="S3.T1.22.22.1.m1.1.1.1.1.3.4.cmml">t</mi></mrow></msub><mo id="S3.T1.22.22.1.m1.2.2.2.3" xref="S3.T1.22.22.1.m1.2.2.3.cmml">,</mo><msub id="S3.T1.22.22.1.m1.2.2.2.2" xref="S3.T1.22.22.1.m1.2.2.2.2.cmml"><mi id="S3.T1.22.22.1.m1.2.2.2.2.2" xref="S3.T1.22.22.1.m1.2.2.2.2.2.cmml">t</mi><mrow id="S3.T1.22.22.1.m1.2.2.2.2.3" xref="S3.T1.22.22.1.m1.2.2.2.2.3.cmml"><mi id="S3.T1.22.22.1.m1.2.2.2.2.3.2" xref="S3.T1.22.22.1.m1.2.2.2.2.3.2.cmml">n</mi><mo id="S3.T1.22.22.1.m1.2.2.2.2.3.1" xref="S3.T1.22.22.1.m1.2.2.2.2.3.1.cmml">⁢</mo><mi id="S3.T1.22.22.1.m1.2.2.2.2.3.3" xref="S3.T1.22.22.1.m1.2.2.2.2.3.3.cmml">e</mi><mo id="S3.T1.22.22.1.m1.2.2.2.2.3.1a" xref="S3.T1.22.22.1.m1.2.2.2.2.3.1.cmml">⁢</mo><mi id="S3.T1.22.22.1.m1.2.2.2.2.3.4" xref="S3.T1.22.22.1.m1.2.2.2.2.3.4.cmml">t</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.22.22.1.m1.2b"><list id="S3.T1.22.22.1.m1.2.2.3.cmml" xref="S3.T1.22.22.1.m1.2.2.2"><apply id="S3.T1.22.22.1.m1.1.1.1.1.cmml" xref="S3.T1.22.22.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.T1.22.22.1.m1.1.1.1.1.1.cmml" xref="S3.T1.22.22.1.m1.1.1.1.1">subscript</csymbol><ci id="S3.T1.22.22.1.m1.1.1.1.1.2.cmml" xref="S3.T1.22.22.1.m1.1.1.1.1.2">𝑠</ci><apply id="S3.T1.22.22.1.m1.1.1.1.1.3.cmml" xref="S3.T1.22.22.1.m1.1.1.1.1.3"><times id="S3.T1.22.22.1.m1.1.1.1.1.3.1.cmml" xref="S3.T1.22.22.1.m1.1.1.1.1.3.1"></times><ci id="S3.T1.22.22.1.m1.1.1.1.1.3.2.cmml" xref="S3.T1.22.22.1.m1.1.1.1.1.3.2">𝑛</ci><ci id="S3.T1.22.22.1.m1.1.1.1.1.3.3.cmml" xref="S3.T1.22.22.1.m1.1.1.1.1.3.3">𝑒</ci><ci id="S3.T1.22.22.1.m1.1.1.1.1.3.4.cmml" xref="S3.T1.22.22.1.m1.1.1.1.1.3.4">𝑡</ci></apply></apply><apply id="S3.T1.22.22.1.m1.2.2.2.2.cmml" xref="S3.T1.22.22.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="S3.T1.22.22.1.m1.2.2.2.2.1.cmml" xref="S3.T1.22.22.1.m1.2.2.2.2">subscript</csymbol><ci id="S3.T1.22.22.1.m1.2.2.2.2.2.cmml" xref="S3.T1.22.22.1.m1.2.2.2.2.2">𝑡</ci><apply id="S3.T1.22.22.1.m1.2.2.2.2.3.cmml" xref="S3.T1.22.22.1.m1.2.2.2.2.3"><times id="S3.T1.22.22.1.m1.2.2.2.2.3.1.cmml" xref="S3.T1.22.22.1.m1.2.2.2.2.3.1"></times><ci id="S3.T1.22.22.1.m1.2.2.2.2.3.2.cmml" xref="S3.T1.22.22.1.m1.2.2.2.2.3.2">𝑛</ci><ci id="S3.T1.22.22.1.m1.2.2.2.2.3.3.cmml" xref="S3.T1.22.22.1.m1.2.2.2.2.3.3">𝑒</ci><ci id="S3.T1.22.22.1.m1.2.2.2.2.3.4.cmml" xref="S3.T1.22.22.1.m1.2.2.2.2.3.4">𝑡</ci></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.22.22.1.m1.2c">s_{net},t_{net}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.22.22.1.m1.2d">italic_s start_POSTSUBSCRIPT italic_n italic_e italic_t end_POSTSUBSCRIPT , italic_t start_POSTSUBSCRIPT italic_n italic_e italic_t end_POSTSUBSCRIPT</annotation></semantics></math></th>
<td id="S3.T1.23.23.2" class="ltx_td ltx_align_justify ltx_border_t" style="width:193.5pt;padding-left:3.0pt;padding-right:3.0pt;">
<p id="S3.T1.23.23.2.1.1" class="ltx_p ltx_align_top"><span id="S3.T1.23.23.2.1.1.1" class="ltx_text ltx_font_italic">scale</span> and <math id="S3.T1.23.23.2.1.1.m1.1" class="ltx_Math" alttext="translation" display="inline"><semantics id="S3.T1.23.23.2.1.1.m1.1a"><mrow id="S3.T1.23.23.2.1.1.m1.1.1" xref="S3.T1.23.23.2.1.1.m1.1.1.cmml"><mi id="S3.T1.23.23.2.1.1.m1.1.1.2" xref="S3.T1.23.23.2.1.1.m1.1.1.2.cmml">t</mi><mo id="S3.T1.23.23.2.1.1.m1.1.1.1" xref="S3.T1.23.23.2.1.1.m1.1.1.1.cmml">⁢</mo><mi id="S3.T1.23.23.2.1.1.m1.1.1.3" xref="S3.T1.23.23.2.1.1.m1.1.1.3.cmml">r</mi><mo id="S3.T1.23.23.2.1.1.m1.1.1.1a" xref="S3.T1.23.23.2.1.1.m1.1.1.1.cmml">⁢</mo><mi id="S3.T1.23.23.2.1.1.m1.1.1.4" xref="S3.T1.23.23.2.1.1.m1.1.1.4.cmml">a</mi><mo id="S3.T1.23.23.2.1.1.m1.1.1.1b" xref="S3.T1.23.23.2.1.1.m1.1.1.1.cmml">⁢</mo><mi id="S3.T1.23.23.2.1.1.m1.1.1.5" xref="S3.T1.23.23.2.1.1.m1.1.1.5.cmml">n</mi><mo id="S3.T1.23.23.2.1.1.m1.1.1.1c" xref="S3.T1.23.23.2.1.1.m1.1.1.1.cmml">⁢</mo><mi id="S3.T1.23.23.2.1.1.m1.1.1.6" xref="S3.T1.23.23.2.1.1.m1.1.1.6.cmml">s</mi><mo id="S3.T1.23.23.2.1.1.m1.1.1.1d" xref="S3.T1.23.23.2.1.1.m1.1.1.1.cmml">⁢</mo><mi id="S3.T1.23.23.2.1.1.m1.1.1.7" xref="S3.T1.23.23.2.1.1.m1.1.1.7.cmml">l</mi><mo id="S3.T1.23.23.2.1.1.m1.1.1.1e" xref="S3.T1.23.23.2.1.1.m1.1.1.1.cmml">⁢</mo><mi id="S3.T1.23.23.2.1.1.m1.1.1.8" xref="S3.T1.23.23.2.1.1.m1.1.1.8.cmml">a</mi><mo id="S3.T1.23.23.2.1.1.m1.1.1.1f" xref="S3.T1.23.23.2.1.1.m1.1.1.1.cmml">⁢</mo><mi id="S3.T1.23.23.2.1.1.m1.1.1.9" xref="S3.T1.23.23.2.1.1.m1.1.1.9.cmml">t</mi><mo id="S3.T1.23.23.2.1.1.m1.1.1.1g" xref="S3.T1.23.23.2.1.1.m1.1.1.1.cmml">⁢</mo><mi id="S3.T1.23.23.2.1.1.m1.1.1.10" xref="S3.T1.23.23.2.1.1.m1.1.1.10.cmml">i</mi><mo id="S3.T1.23.23.2.1.1.m1.1.1.1h" xref="S3.T1.23.23.2.1.1.m1.1.1.1.cmml">⁢</mo><mi id="S3.T1.23.23.2.1.1.m1.1.1.11" xref="S3.T1.23.23.2.1.1.m1.1.1.11.cmml">o</mi><mo id="S3.T1.23.23.2.1.1.m1.1.1.1i" xref="S3.T1.23.23.2.1.1.m1.1.1.1.cmml">⁢</mo><mi id="S3.T1.23.23.2.1.1.m1.1.1.12" xref="S3.T1.23.23.2.1.1.m1.1.1.12.cmml">n</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.23.23.2.1.1.m1.1b"><apply id="S3.T1.23.23.2.1.1.m1.1.1.cmml" xref="S3.T1.23.23.2.1.1.m1.1.1"><times id="S3.T1.23.23.2.1.1.m1.1.1.1.cmml" xref="S3.T1.23.23.2.1.1.m1.1.1.1"></times><ci id="S3.T1.23.23.2.1.1.m1.1.1.2.cmml" xref="S3.T1.23.23.2.1.1.m1.1.1.2">𝑡</ci><ci id="S3.T1.23.23.2.1.1.m1.1.1.3.cmml" xref="S3.T1.23.23.2.1.1.m1.1.1.3">𝑟</ci><ci id="S3.T1.23.23.2.1.1.m1.1.1.4.cmml" xref="S3.T1.23.23.2.1.1.m1.1.1.4">𝑎</ci><ci id="S3.T1.23.23.2.1.1.m1.1.1.5.cmml" xref="S3.T1.23.23.2.1.1.m1.1.1.5">𝑛</ci><ci id="S3.T1.23.23.2.1.1.m1.1.1.6.cmml" xref="S3.T1.23.23.2.1.1.m1.1.1.6">𝑠</ci><ci id="S3.T1.23.23.2.1.1.m1.1.1.7.cmml" xref="S3.T1.23.23.2.1.1.m1.1.1.7">𝑙</ci><ci id="S3.T1.23.23.2.1.1.m1.1.1.8.cmml" xref="S3.T1.23.23.2.1.1.m1.1.1.8">𝑎</ci><ci id="S3.T1.23.23.2.1.1.m1.1.1.9.cmml" xref="S3.T1.23.23.2.1.1.m1.1.1.9">𝑡</ci><ci id="S3.T1.23.23.2.1.1.m1.1.1.10.cmml" xref="S3.T1.23.23.2.1.1.m1.1.1.10">𝑖</ci><ci id="S3.T1.23.23.2.1.1.m1.1.1.11.cmml" xref="S3.T1.23.23.2.1.1.m1.1.1.11">𝑜</ci><ci id="S3.T1.23.23.2.1.1.m1.1.1.12.cmml" xref="S3.T1.23.23.2.1.1.m1.1.1.12">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.23.23.2.1.1.m1.1c">translation</annotation><annotation encoding="application/x-llamapun" id="S3.T1.23.23.2.1.1.m1.1d">italic_t italic_r italic_a italic_n italic_s italic_l italic_a italic_t italic_i italic_o italic_n</annotation></semantics></math> network in each Coupling layer of the RealNVP model</p>
</td>
</tr>
<tr id="S3.T1.26.26" class="ltx_tr">
<th id="S3.T1.24.24.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;"><math id="S3.T1.24.24.1.m1.1" class="ltx_Math" alttext="history(x^{j})" display="inline"><semantics id="S3.T1.24.24.1.m1.1a"><mrow id="S3.T1.24.24.1.m1.1.1" xref="S3.T1.24.24.1.m1.1.1.cmml"><mi id="S3.T1.24.24.1.m1.1.1.3" xref="S3.T1.24.24.1.m1.1.1.3.cmml">h</mi><mo id="S3.T1.24.24.1.m1.1.1.2" xref="S3.T1.24.24.1.m1.1.1.2.cmml">⁢</mo><mi id="S3.T1.24.24.1.m1.1.1.4" xref="S3.T1.24.24.1.m1.1.1.4.cmml">i</mi><mo id="S3.T1.24.24.1.m1.1.1.2a" xref="S3.T1.24.24.1.m1.1.1.2.cmml">⁢</mo><mi id="S3.T1.24.24.1.m1.1.1.5" xref="S3.T1.24.24.1.m1.1.1.5.cmml">s</mi><mo id="S3.T1.24.24.1.m1.1.1.2b" xref="S3.T1.24.24.1.m1.1.1.2.cmml">⁢</mo><mi id="S3.T1.24.24.1.m1.1.1.6" xref="S3.T1.24.24.1.m1.1.1.6.cmml">t</mi><mo id="S3.T1.24.24.1.m1.1.1.2c" xref="S3.T1.24.24.1.m1.1.1.2.cmml">⁢</mo><mi id="S3.T1.24.24.1.m1.1.1.7" xref="S3.T1.24.24.1.m1.1.1.7.cmml">o</mi><mo id="S3.T1.24.24.1.m1.1.1.2d" xref="S3.T1.24.24.1.m1.1.1.2.cmml">⁢</mo><mi id="S3.T1.24.24.1.m1.1.1.8" xref="S3.T1.24.24.1.m1.1.1.8.cmml">r</mi><mo id="S3.T1.24.24.1.m1.1.1.2e" xref="S3.T1.24.24.1.m1.1.1.2.cmml">⁢</mo><mi id="S3.T1.24.24.1.m1.1.1.9" xref="S3.T1.24.24.1.m1.1.1.9.cmml">y</mi><mo id="S3.T1.24.24.1.m1.1.1.2f" xref="S3.T1.24.24.1.m1.1.1.2.cmml">⁢</mo><mrow id="S3.T1.24.24.1.m1.1.1.1.1" xref="S3.T1.24.24.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.T1.24.24.1.m1.1.1.1.1.2" xref="S3.T1.24.24.1.m1.1.1.1.1.1.cmml">(</mo><msup id="S3.T1.24.24.1.m1.1.1.1.1.1" xref="S3.T1.24.24.1.m1.1.1.1.1.1.cmml"><mi id="S3.T1.24.24.1.m1.1.1.1.1.1.2" xref="S3.T1.24.24.1.m1.1.1.1.1.1.2.cmml">x</mi><mi id="S3.T1.24.24.1.m1.1.1.1.1.1.3" xref="S3.T1.24.24.1.m1.1.1.1.1.1.3.cmml">j</mi></msup><mo stretchy="false" id="S3.T1.24.24.1.m1.1.1.1.1.3" xref="S3.T1.24.24.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.24.24.1.m1.1b"><apply id="S3.T1.24.24.1.m1.1.1.cmml" xref="S3.T1.24.24.1.m1.1.1"><times id="S3.T1.24.24.1.m1.1.1.2.cmml" xref="S3.T1.24.24.1.m1.1.1.2"></times><ci id="S3.T1.24.24.1.m1.1.1.3.cmml" xref="S3.T1.24.24.1.m1.1.1.3">ℎ</ci><ci id="S3.T1.24.24.1.m1.1.1.4.cmml" xref="S3.T1.24.24.1.m1.1.1.4">𝑖</ci><ci id="S3.T1.24.24.1.m1.1.1.5.cmml" xref="S3.T1.24.24.1.m1.1.1.5">𝑠</ci><ci id="S3.T1.24.24.1.m1.1.1.6.cmml" xref="S3.T1.24.24.1.m1.1.1.6">𝑡</ci><ci id="S3.T1.24.24.1.m1.1.1.7.cmml" xref="S3.T1.24.24.1.m1.1.1.7">𝑜</ci><ci id="S3.T1.24.24.1.m1.1.1.8.cmml" xref="S3.T1.24.24.1.m1.1.1.8">𝑟</ci><ci id="S3.T1.24.24.1.m1.1.1.9.cmml" xref="S3.T1.24.24.1.m1.1.1.9">𝑦</ci><apply id="S3.T1.24.24.1.m1.1.1.1.1.1.cmml" xref="S3.T1.24.24.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.T1.24.24.1.m1.1.1.1.1.1.1.cmml" xref="S3.T1.24.24.1.m1.1.1.1.1">superscript</csymbol><ci id="S3.T1.24.24.1.m1.1.1.1.1.1.2.cmml" xref="S3.T1.24.24.1.m1.1.1.1.1.1.2">𝑥</ci><ci id="S3.T1.24.24.1.m1.1.1.1.1.1.3.cmml" xref="S3.T1.24.24.1.m1.1.1.1.1.1.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.24.24.1.m1.1c">history(x^{j})</annotation><annotation encoding="application/x-llamapun" id="S3.T1.24.24.1.m1.1d">italic_h italic_i italic_s italic_t italic_o italic_r italic_y ( italic_x start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT )</annotation></semantics></math></th>
<td id="S3.T1.26.26.3" class="ltx_td ltx_align_justify ltx_border_t" style="width:193.5pt;padding-left:3.0pt;padding-right:3.0pt;">
<p id="S3.T1.26.26.3.2.2" class="ltx_p ltx_align_top">history data that are at the same period as <math id="S3.T1.25.25.2.1.1.m1.1" class="ltx_Math" alttext="x^{j}" display="inline"><semantics id="S3.T1.25.25.2.1.1.m1.1a"><msup id="S3.T1.25.25.2.1.1.m1.1.1" xref="S3.T1.25.25.2.1.1.m1.1.1.cmml"><mi id="S3.T1.25.25.2.1.1.m1.1.1.2" xref="S3.T1.25.25.2.1.1.m1.1.1.2.cmml">x</mi><mi id="S3.T1.25.25.2.1.1.m1.1.1.3" xref="S3.T1.25.25.2.1.1.m1.1.1.3.cmml">j</mi></msup><annotation-xml encoding="MathML-Content" id="S3.T1.25.25.2.1.1.m1.1b"><apply id="S3.T1.25.25.2.1.1.m1.1.1.cmml" xref="S3.T1.25.25.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.25.25.2.1.1.m1.1.1.1.cmml" xref="S3.T1.25.25.2.1.1.m1.1.1">superscript</csymbol><ci id="S3.T1.25.25.2.1.1.m1.1.1.2.cmml" xref="S3.T1.25.25.2.1.1.m1.1.1.2">𝑥</ci><ci id="S3.T1.25.25.2.1.1.m1.1.1.3.cmml" xref="S3.T1.25.25.2.1.1.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.25.25.2.1.1.m1.1c">x^{j}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.25.25.2.1.1.m1.1d">italic_x start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT</annotation></semantics></math>, where <math id="S3.T1.26.26.3.2.2.m2.2" class="ltx_Math" alttext="j\in[t_{0},\tau]" display="inline"><semantics id="S3.T1.26.26.3.2.2.m2.2a"><mrow id="S3.T1.26.26.3.2.2.m2.2.2" xref="S3.T1.26.26.3.2.2.m2.2.2.cmml"><mi id="S3.T1.26.26.3.2.2.m2.2.2.3" xref="S3.T1.26.26.3.2.2.m2.2.2.3.cmml">j</mi><mo id="S3.T1.26.26.3.2.2.m2.2.2.2" xref="S3.T1.26.26.3.2.2.m2.2.2.2.cmml">∈</mo><mrow id="S3.T1.26.26.3.2.2.m2.2.2.1.1" xref="S3.T1.26.26.3.2.2.m2.2.2.1.2.cmml"><mo stretchy="false" id="S3.T1.26.26.3.2.2.m2.2.2.1.1.2" xref="S3.T1.26.26.3.2.2.m2.2.2.1.2.cmml">[</mo><msub id="S3.T1.26.26.3.2.2.m2.2.2.1.1.1" xref="S3.T1.26.26.3.2.2.m2.2.2.1.1.1.cmml"><mi id="S3.T1.26.26.3.2.2.m2.2.2.1.1.1.2" xref="S3.T1.26.26.3.2.2.m2.2.2.1.1.1.2.cmml">t</mi><mn id="S3.T1.26.26.3.2.2.m2.2.2.1.1.1.3" xref="S3.T1.26.26.3.2.2.m2.2.2.1.1.1.3.cmml">0</mn></msub><mo id="S3.T1.26.26.3.2.2.m2.2.2.1.1.3" xref="S3.T1.26.26.3.2.2.m2.2.2.1.2.cmml">,</mo><mi id="S3.T1.26.26.3.2.2.m2.1.1" xref="S3.T1.26.26.3.2.2.m2.1.1.cmml">τ</mi><mo stretchy="false" id="S3.T1.26.26.3.2.2.m2.2.2.1.1.4" xref="S3.T1.26.26.3.2.2.m2.2.2.1.2.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.26.26.3.2.2.m2.2b"><apply id="S3.T1.26.26.3.2.2.m2.2.2.cmml" xref="S3.T1.26.26.3.2.2.m2.2.2"><in id="S3.T1.26.26.3.2.2.m2.2.2.2.cmml" xref="S3.T1.26.26.3.2.2.m2.2.2.2"></in><ci id="S3.T1.26.26.3.2.2.m2.2.2.3.cmml" xref="S3.T1.26.26.3.2.2.m2.2.2.3">𝑗</ci><interval closure="closed" id="S3.T1.26.26.3.2.2.m2.2.2.1.2.cmml" xref="S3.T1.26.26.3.2.2.m2.2.2.1.1"><apply id="S3.T1.26.26.3.2.2.m2.2.2.1.1.1.cmml" xref="S3.T1.26.26.3.2.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.T1.26.26.3.2.2.m2.2.2.1.1.1.1.cmml" xref="S3.T1.26.26.3.2.2.m2.2.2.1.1.1">subscript</csymbol><ci id="S3.T1.26.26.3.2.2.m2.2.2.1.1.1.2.cmml" xref="S3.T1.26.26.3.2.2.m2.2.2.1.1.1.2">𝑡</ci><cn type="integer" id="S3.T1.26.26.3.2.2.m2.2.2.1.1.1.3.cmml" xref="S3.T1.26.26.3.2.2.m2.2.2.1.1.1.3">0</cn></apply><ci id="S3.T1.26.26.3.2.2.m2.1.1.cmml" xref="S3.T1.26.26.3.2.2.m2.1.1">𝜏</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.26.26.3.2.2.m2.2c">j\in[t_{0},\tau]</annotation><annotation encoding="application/x-llamapun" id="S3.T1.26.26.3.2.2.m2.2d">italic_j ∈ [ italic_t start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_τ ]</annotation></semantics></math> is a detected anomalous time step</p>
</td>
</tr>
<tr id="S3.T1.27.27" class="ltx_tr">
<th id="S3.T1.27.27.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;"><math id="S3.T1.27.27.1.m1.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S3.T1.27.27.1.m1.1a"><mi id="S3.T1.27.27.1.m1.1.1" xref="S3.T1.27.27.1.m1.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S3.T1.27.27.1.m1.1b"><ci id="S3.T1.27.27.1.m1.1.1.cmml" xref="S3.T1.27.27.1.m1.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.27.27.1.m1.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="S3.T1.27.27.1.m1.1d">italic_θ</annotation></semantics></math></th>
<td id="S3.T1.27.27.2" class="ltx_td ltx_align_justify ltx_border_t" style="width:193.5pt;padding-left:3.0pt;padding-right:3.0pt;">
<p id="S3.T1.27.27.2.1" class="ltx_p ltx_align_top">trainable parameters in the model</p>
</td>
</tr>
<tr id="S3.T1.28.28" class="ltx_tr">
<th id="S3.T1.28.28.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_r ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;"><math id="S3.T1.28.28.1.m1.2" class="ltx_Math" alttext="\alpha,\beta" display="inline"><semantics id="S3.T1.28.28.1.m1.2a"><mrow id="S3.T1.28.28.1.m1.2.3.2" xref="S3.T1.28.28.1.m1.2.3.1.cmml"><mi id="S3.T1.28.28.1.m1.1.1" xref="S3.T1.28.28.1.m1.1.1.cmml">α</mi><mo id="S3.T1.28.28.1.m1.2.3.2.1" xref="S3.T1.28.28.1.m1.2.3.1.cmml">,</mo><mi id="S3.T1.28.28.1.m1.2.2" xref="S3.T1.28.28.1.m1.2.2.cmml">β</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.28.28.1.m1.2b"><list id="S3.T1.28.28.1.m1.2.3.1.cmml" xref="S3.T1.28.28.1.m1.2.3.2"><ci id="S3.T1.28.28.1.m1.1.1.cmml" xref="S3.T1.28.28.1.m1.1.1">𝛼</ci><ci id="S3.T1.28.28.1.m1.2.2.cmml" xref="S3.T1.28.28.1.m1.2.2">𝛽</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.28.28.1.m1.2c">\alpha,\beta</annotation><annotation encoding="application/x-llamapun" id="S3.T1.28.28.1.m1.2d">italic_α , italic_β</annotation></semantics></math></th>
<td id="S3.T1.28.28.2" class="ltx_td ltx_align_justify ltx_border_b ltx_border_t" style="width:193.5pt;padding-left:3.0pt;padding-right:3.0pt;">
<p id="S3.T1.28.28.2.1" class="ltx_p ltx_align_top">the fractions of anomalous time slices and road segments in the synthetic dataset</p>
</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE I: </span>List of Symbols</figcaption>
</figure>
<div id="S3.p2" class="ltx_para">
<p id="S3.p2.12" class="ltx_p">Let <math id="S3.p2.1.m1.1" class="ltx_Math" alttext="S" display="inline"><semantics id="S3.p2.1.m1.1a"><mi id="S3.p2.1.m1.1.1" xref="S3.p2.1.m1.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.p2.1.m1.1b"><ci id="S3.p2.1.m1.1.1.cmml" xref="S3.p2.1.m1.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.1.m1.1c">S</annotation><annotation encoding="application/x-llamapun" id="S3.p2.1.m1.1d">italic_S</annotation></semantics></math> denote the set of all road segments under consideration. Consider an arbitrary segment <math id="S3.p2.2.m2.1" class="ltx_Math" alttext="S_{i}\in S" display="inline"><semantics id="S3.p2.2.m2.1a"><mrow id="S3.p2.2.m2.1.1" xref="S3.p2.2.m2.1.1.cmml"><msub id="S3.p2.2.m2.1.1.2" xref="S3.p2.2.m2.1.1.2.cmml"><mi id="S3.p2.2.m2.1.1.2.2" xref="S3.p2.2.m2.1.1.2.2.cmml">S</mi><mi id="S3.p2.2.m2.1.1.2.3" xref="S3.p2.2.m2.1.1.2.3.cmml">i</mi></msub><mo id="S3.p2.2.m2.1.1.1" xref="S3.p2.2.m2.1.1.1.cmml">∈</mo><mi id="S3.p2.2.m2.1.1.3" xref="S3.p2.2.m2.1.1.3.cmml">S</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.2.m2.1b"><apply id="S3.p2.2.m2.1.1.cmml" xref="S3.p2.2.m2.1.1"><in id="S3.p2.2.m2.1.1.1.cmml" xref="S3.p2.2.m2.1.1.1"></in><apply id="S3.p2.2.m2.1.1.2.cmml" xref="S3.p2.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.p2.2.m2.1.1.2.1.cmml" xref="S3.p2.2.m2.1.1.2">subscript</csymbol><ci id="S3.p2.2.m2.1.1.2.2.cmml" xref="S3.p2.2.m2.1.1.2.2">𝑆</ci><ci id="S3.p2.2.m2.1.1.2.3.cmml" xref="S3.p2.2.m2.1.1.2.3">𝑖</ci></apply><ci id="S3.p2.2.m2.1.1.3.cmml" xref="S3.p2.2.m2.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.2.m2.1c">S_{i}\in S</annotation><annotation encoding="application/x-llamapun" id="S3.p2.2.m2.1d">italic_S start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ italic_S</annotation></semantics></math> on which (near) real-time speed is monitored continuously; we assume that the estimated harmonic mean speed on segment <math id="S3.p2.3.m3.1" class="ltx_Math" alttext="S_{i}" display="inline"><semantics id="S3.p2.3.m3.1a"><msub id="S3.p2.3.m3.1.1" xref="S3.p2.3.m3.1.1.cmml"><mi id="S3.p2.3.m3.1.1.2" xref="S3.p2.3.m3.1.1.2.cmml">S</mi><mi id="S3.p2.3.m3.1.1.3" xref="S3.p2.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p2.3.m3.1b"><apply id="S3.p2.3.m3.1.1.cmml" xref="S3.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.p2.3.m3.1.1.1.cmml" xref="S3.p2.3.m3.1.1">subscript</csymbol><ci id="S3.p2.3.m3.1.1.2.cmml" xref="S3.p2.3.m3.1.1.2">𝑆</ci><ci id="S3.p2.3.m3.1.1.3.cmml" xref="S3.p2.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.3.m3.1c">S_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.p2.3.m3.1d">italic_S start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is computed and stored at discrete times <math id="S3.p2.4.m4.4" class="ltx_Math" alttext="t\in\{1,2,...,T\}" display="inline"><semantics id="S3.p2.4.m4.4a"><mrow id="S3.p2.4.m4.4.5" xref="S3.p2.4.m4.4.5.cmml"><mi id="S3.p2.4.m4.4.5.2" xref="S3.p2.4.m4.4.5.2.cmml">t</mi><mo id="S3.p2.4.m4.4.5.1" xref="S3.p2.4.m4.4.5.1.cmml">∈</mo><mrow id="S3.p2.4.m4.4.5.3.2" xref="S3.p2.4.m4.4.5.3.1.cmml"><mo stretchy="false" id="S3.p2.4.m4.4.5.3.2.1" xref="S3.p2.4.m4.4.5.3.1.cmml">{</mo><mn id="S3.p2.4.m4.1.1" xref="S3.p2.4.m4.1.1.cmml">1</mn><mo id="S3.p2.4.m4.4.5.3.2.2" xref="S3.p2.4.m4.4.5.3.1.cmml">,</mo><mn id="S3.p2.4.m4.2.2" xref="S3.p2.4.m4.2.2.cmml">2</mn><mo id="S3.p2.4.m4.4.5.3.2.3" xref="S3.p2.4.m4.4.5.3.1.cmml">,</mo><mi mathvariant="normal" id="S3.p2.4.m4.3.3" xref="S3.p2.4.m4.3.3.cmml">…</mi><mo id="S3.p2.4.m4.4.5.3.2.4" xref="S3.p2.4.m4.4.5.3.1.cmml">,</mo><mi id="S3.p2.4.m4.4.4" xref="S3.p2.4.m4.4.4.cmml">T</mi><mo stretchy="false" id="S3.p2.4.m4.4.5.3.2.5" xref="S3.p2.4.m4.4.5.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.4.m4.4b"><apply id="S3.p2.4.m4.4.5.cmml" xref="S3.p2.4.m4.4.5"><in id="S3.p2.4.m4.4.5.1.cmml" xref="S3.p2.4.m4.4.5.1"></in><ci id="S3.p2.4.m4.4.5.2.cmml" xref="S3.p2.4.m4.4.5.2">𝑡</ci><set id="S3.p2.4.m4.4.5.3.1.cmml" xref="S3.p2.4.m4.4.5.3.2"><cn type="integer" id="S3.p2.4.m4.1.1.cmml" xref="S3.p2.4.m4.1.1">1</cn><cn type="integer" id="S3.p2.4.m4.2.2.cmml" xref="S3.p2.4.m4.2.2">2</cn><ci id="S3.p2.4.m4.3.3.cmml" xref="S3.p2.4.m4.3.3">…</ci><ci id="S3.p2.4.m4.4.4.cmml" xref="S3.p2.4.m4.4.4">𝑇</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.4.m4.4c">t\in\{1,2,...,T\}</annotation><annotation encoding="application/x-llamapun" id="S3.p2.4.m4.4d">italic_t ∈ { 1 , 2 , … , italic_T }</annotation></semantics></math>. We denote this observation at time <math id="S3.p2.5.m5.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.p2.5.m5.1a"><mi id="S3.p2.5.m5.1.1" xref="S3.p2.5.m5.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.p2.5.m5.1b"><ci id="S3.p2.5.m5.1.1.cmml" xref="S3.p2.5.m5.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.5.m5.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.p2.5.m5.1d">italic_t</annotation></semantics></math> by <math id="S3.p2.6.m6.1" class="ltx_Math" alttext="v_{i}^{t}" display="inline"><semantics id="S3.p2.6.m6.1a"><msubsup id="S3.p2.6.m6.1.1" xref="S3.p2.6.m6.1.1.cmml"><mi id="S3.p2.6.m6.1.1.2.2" xref="S3.p2.6.m6.1.1.2.2.cmml">v</mi><mi id="S3.p2.6.m6.1.1.2.3" xref="S3.p2.6.m6.1.1.2.3.cmml">i</mi><mi id="S3.p2.6.m6.1.1.3" xref="S3.p2.6.m6.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.p2.6.m6.1b"><apply id="S3.p2.6.m6.1.1.cmml" xref="S3.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.p2.6.m6.1.1.1.cmml" xref="S3.p2.6.m6.1.1">superscript</csymbol><apply id="S3.p2.6.m6.1.1.2.cmml" xref="S3.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.p2.6.m6.1.1.2.1.cmml" xref="S3.p2.6.m6.1.1">subscript</csymbol><ci id="S3.p2.6.m6.1.1.2.2.cmml" xref="S3.p2.6.m6.1.1.2.2">𝑣</ci><ci id="S3.p2.6.m6.1.1.2.3.cmml" xref="S3.p2.6.m6.1.1.2.3">𝑖</ci></apply><ci id="S3.p2.6.m6.1.1.3.cmml" xref="S3.p2.6.m6.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.6.m6.1c">v_{i}^{t}</annotation><annotation encoding="application/x-llamapun" id="S3.p2.6.m6.1d">italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math>. The free-flow speed <math id="S3.p2.7.m7.1" class="ltx_Math" alttext="\hat{v}_{i}" display="inline"><semantics id="S3.p2.7.m7.1a"><msub id="S3.p2.7.m7.1.1" xref="S3.p2.7.m7.1.1.cmml"><mover accent="true" id="S3.p2.7.m7.1.1.2" xref="S3.p2.7.m7.1.1.2.cmml"><mi id="S3.p2.7.m7.1.1.2.2" xref="S3.p2.7.m7.1.1.2.2.cmml">v</mi><mo id="S3.p2.7.m7.1.1.2.1" xref="S3.p2.7.m7.1.1.2.1.cmml">^</mo></mover><mi id="S3.p2.7.m7.1.1.3" xref="S3.p2.7.m7.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p2.7.m7.1b"><apply id="S3.p2.7.m7.1.1.cmml" xref="S3.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S3.p2.7.m7.1.1.1.cmml" xref="S3.p2.7.m7.1.1">subscript</csymbol><apply id="S3.p2.7.m7.1.1.2.cmml" xref="S3.p2.7.m7.1.1.2"><ci id="S3.p2.7.m7.1.1.2.1.cmml" xref="S3.p2.7.m7.1.1.2.1">^</ci><ci id="S3.p2.7.m7.1.1.2.2.cmml" xref="S3.p2.7.m7.1.1.2.2">𝑣</ci></apply><ci id="S3.p2.7.m7.1.1.3.cmml" xref="S3.p2.7.m7.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.7.m7.1c">\hat{v}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.p2.7.m7.1d">over^ start_ARG italic_v end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, an intrinsic property of segment <math id="S3.p2.8.m8.1" class="ltx_Math" alttext="S_{i}" display="inline"><semantics id="S3.p2.8.m8.1a"><msub id="S3.p2.8.m8.1.1" xref="S3.p2.8.m8.1.1.cmml"><mi id="S3.p2.8.m8.1.1.2" xref="S3.p2.8.m8.1.1.2.cmml">S</mi><mi id="S3.p2.8.m8.1.1.3" xref="S3.p2.8.m8.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p2.8.m8.1b"><apply id="S3.p2.8.m8.1.1.cmml" xref="S3.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S3.p2.8.m8.1.1.1.cmml" xref="S3.p2.8.m8.1.1">subscript</csymbol><ci id="S3.p2.8.m8.1.1.2.cmml" xref="S3.p2.8.m8.1.1.2">𝑆</ci><ci id="S3.p2.8.m8.1.1.3.cmml" xref="S3.p2.8.m8.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.8.m8.1c">S_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.p2.8.m8.1d">italic_S start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, is calculated based upon the 85th-percentile of the observed speeds on the segment <math id="S3.p2.9.m9.1" class="ltx_Math" alttext="S_{i}" display="inline"><semantics id="S3.p2.9.m9.1a"><msub id="S3.p2.9.m9.1.1" xref="S3.p2.9.m9.1.1.cmml"><mi id="S3.p2.9.m9.1.1.2" xref="S3.p2.9.m9.1.1.2.cmml">S</mi><mi id="S3.p2.9.m9.1.1.3" xref="S3.p2.9.m9.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p2.9.m9.1b"><apply id="S3.p2.9.m9.1.1.cmml" xref="S3.p2.9.m9.1.1"><csymbol cd="ambiguous" id="S3.p2.9.m9.1.1.1.cmml" xref="S3.p2.9.m9.1.1">subscript</csymbol><ci id="S3.p2.9.m9.1.1.2.cmml" xref="S3.p2.9.m9.1.1.2">𝑆</ci><ci id="S3.p2.9.m9.1.1.3.cmml" xref="S3.p2.9.m9.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.9.m9.1c">S_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.p2.9.m9.1d">italic_S start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> for all time periods <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>, <a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>. The historical average speed, denoted by <math id="S3.p2.10.m10.1" class="ltx_Math" alttext="\bar{v}_{i}^{t}" display="inline"><semantics id="S3.p2.10.m10.1a"><msubsup id="S3.p2.10.m10.1.1" xref="S3.p2.10.m10.1.1.cmml"><mover accent="true" id="S3.p2.10.m10.1.1.2.2" xref="S3.p2.10.m10.1.1.2.2.cmml"><mi id="S3.p2.10.m10.1.1.2.2.2" xref="S3.p2.10.m10.1.1.2.2.2.cmml">v</mi><mo id="S3.p2.10.m10.1.1.2.2.1" xref="S3.p2.10.m10.1.1.2.2.1.cmml">¯</mo></mover><mi id="S3.p2.10.m10.1.1.2.3" xref="S3.p2.10.m10.1.1.2.3.cmml">i</mi><mi id="S3.p2.10.m10.1.1.3" xref="S3.p2.10.m10.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.p2.10.m10.1b"><apply id="S3.p2.10.m10.1.1.cmml" xref="S3.p2.10.m10.1.1"><csymbol cd="ambiguous" id="S3.p2.10.m10.1.1.1.cmml" xref="S3.p2.10.m10.1.1">superscript</csymbol><apply id="S3.p2.10.m10.1.1.2.cmml" xref="S3.p2.10.m10.1.1"><csymbol cd="ambiguous" id="S3.p2.10.m10.1.1.2.1.cmml" xref="S3.p2.10.m10.1.1">subscript</csymbol><apply id="S3.p2.10.m10.1.1.2.2.cmml" xref="S3.p2.10.m10.1.1.2.2"><ci id="S3.p2.10.m10.1.1.2.2.1.cmml" xref="S3.p2.10.m10.1.1.2.2.1">¯</ci><ci id="S3.p2.10.m10.1.1.2.2.2.cmml" xref="S3.p2.10.m10.1.1.2.2.2">𝑣</ci></apply><ci id="S3.p2.10.m10.1.1.2.3.cmml" xref="S3.p2.10.m10.1.1.2.3">𝑖</ci></apply><ci id="S3.p2.10.m10.1.1.3.cmml" xref="S3.p2.10.m10.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.10.m10.1c">\bar{v}_{i}^{t}</annotation><annotation encoding="application/x-llamapun" id="S3.p2.10.m10.1d">over¯ start_ARG italic_v end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math>, signifies the regular traffic condition on <math id="S3.p2.11.m11.1" class="ltx_Math" alttext="S_{i}" display="inline"><semantics id="S3.p2.11.m11.1a"><msub id="S3.p2.11.m11.1.1" xref="S3.p2.11.m11.1.1.cmml"><mi id="S3.p2.11.m11.1.1.2" xref="S3.p2.11.m11.1.1.2.cmml">S</mi><mi id="S3.p2.11.m11.1.1.3" xref="S3.p2.11.m11.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p2.11.m11.1b"><apply id="S3.p2.11.m11.1.1.cmml" xref="S3.p2.11.m11.1.1"><csymbol cd="ambiguous" id="S3.p2.11.m11.1.1.1.cmml" xref="S3.p2.11.m11.1.1">subscript</csymbol><ci id="S3.p2.11.m11.1.1.2.cmml" xref="S3.p2.11.m11.1.1.2">𝑆</ci><ci id="S3.p2.11.m11.1.1.3.cmml" xref="S3.p2.11.m11.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.11.m11.1c">S_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.p2.11.m11.1d">italic_S start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, which is calculated by taking the harmonic average of speeds on <math id="S3.p2.12.m12.1" class="ltx_Math" alttext="S_{i}" display="inline"><semantics id="S3.p2.12.m12.1a"><msub id="S3.p2.12.m12.1.1" xref="S3.p2.12.m12.1.1.cmml"><mi id="S3.p2.12.m12.1.1.2" xref="S3.p2.12.m12.1.1.2.cmml">S</mi><mi id="S3.p2.12.m12.1.1.3" xref="S3.p2.12.m12.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p2.12.m12.1b"><apply id="S3.p2.12.m12.1.1.cmml" xref="S3.p2.12.m12.1.1"><csymbol cd="ambiguous" id="S3.p2.12.m12.1.1.1.cmml" xref="S3.p2.12.m12.1.1">subscript</csymbol><ci id="S3.p2.12.m12.1.1.2.cmml" xref="S3.p2.12.m12.1.1.2">𝑆</ci><ci id="S3.p2.12.m12.1.1.3.cmml" xref="S3.p2.12.m12.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.12.m12.1c">S_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.p2.12.m12.1d">italic_S start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> for each hour of day and for each day of the week. Then, the congestion rate is defined as
</p>
<table id="S3.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E5.m1.1" class="ltx_Math" alttext="x_{i}^{t}=\frac{\bar{v}_{i}^{t}-v_{i}^{t}}{\hat{v}_{i}}" display="block"><semantics id="S3.E5.m1.1a"><mrow id="S3.E5.m1.1.1" xref="S3.E5.m1.1.1.cmml"><msubsup id="S3.E5.m1.1.1.2" xref="S3.E5.m1.1.1.2.cmml"><mi id="S3.E5.m1.1.1.2.2.2" xref="S3.E5.m1.1.1.2.2.2.cmml">x</mi><mi id="S3.E5.m1.1.1.2.2.3" xref="S3.E5.m1.1.1.2.2.3.cmml">i</mi><mi id="S3.E5.m1.1.1.2.3" xref="S3.E5.m1.1.1.2.3.cmml">t</mi></msubsup><mo id="S3.E5.m1.1.1.1" xref="S3.E5.m1.1.1.1.cmml">=</mo><mfrac id="S3.E5.m1.1.1.3" xref="S3.E5.m1.1.1.3.cmml"><mrow id="S3.E5.m1.1.1.3.2" xref="S3.E5.m1.1.1.3.2.cmml"><msubsup id="S3.E5.m1.1.1.3.2.2" xref="S3.E5.m1.1.1.3.2.2.cmml"><mover accent="true" id="S3.E5.m1.1.1.3.2.2.2.2" xref="S3.E5.m1.1.1.3.2.2.2.2.cmml"><mi id="S3.E5.m1.1.1.3.2.2.2.2.2" xref="S3.E5.m1.1.1.3.2.2.2.2.2.cmml">v</mi><mo id="S3.E5.m1.1.1.3.2.2.2.2.1" xref="S3.E5.m1.1.1.3.2.2.2.2.1.cmml">¯</mo></mover><mi id="S3.E5.m1.1.1.3.2.2.2.3" xref="S3.E5.m1.1.1.3.2.2.2.3.cmml">i</mi><mi id="S3.E5.m1.1.1.3.2.2.3" xref="S3.E5.m1.1.1.3.2.2.3.cmml">t</mi></msubsup><mo id="S3.E5.m1.1.1.3.2.1" xref="S3.E5.m1.1.1.3.2.1.cmml">−</mo><msubsup id="S3.E5.m1.1.1.3.2.3" xref="S3.E5.m1.1.1.3.2.3.cmml"><mi id="S3.E5.m1.1.1.3.2.3.2.2" xref="S3.E5.m1.1.1.3.2.3.2.2.cmml">v</mi><mi id="S3.E5.m1.1.1.3.2.3.2.3" xref="S3.E5.m1.1.1.3.2.3.2.3.cmml">i</mi><mi id="S3.E5.m1.1.1.3.2.3.3" xref="S3.E5.m1.1.1.3.2.3.3.cmml">t</mi></msubsup></mrow><msub id="S3.E5.m1.1.1.3.3" xref="S3.E5.m1.1.1.3.3.cmml"><mover accent="true" id="S3.E5.m1.1.1.3.3.2" xref="S3.E5.m1.1.1.3.3.2.cmml"><mi id="S3.E5.m1.1.1.3.3.2.2" xref="S3.E5.m1.1.1.3.3.2.2.cmml">v</mi><mo id="S3.E5.m1.1.1.3.3.2.1" xref="S3.E5.m1.1.1.3.3.2.1.cmml">^</mo></mover><mi id="S3.E5.m1.1.1.3.3.3" xref="S3.E5.m1.1.1.3.3.3.cmml">i</mi></msub></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.1b"><apply id="S3.E5.m1.1.1.cmml" xref="S3.E5.m1.1.1"><eq id="S3.E5.m1.1.1.1.cmml" xref="S3.E5.m1.1.1.1"></eq><apply id="S3.E5.m1.1.1.2.cmml" xref="S3.E5.m1.1.1.2"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.2.1.cmml" xref="S3.E5.m1.1.1.2">superscript</csymbol><apply id="S3.E5.m1.1.1.2.2.cmml" xref="S3.E5.m1.1.1.2"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.2.2.1.cmml" xref="S3.E5.m1.1.1.2">subscript</csymbol><ci id="S3.E5.m1.1.1.2.2.2.cmml" xref="S3.E5.m1.1.1.2.2.2">𝑥</ci><ci id="S3.E5.m1.1.1.2.2.3.cmml" xref="S3.E5.m1.1.1.2.2.3">𝑖</ci></apply><ci id="S3.E5.m1.1.1.2.3.cmml" xref="S3.E5.m1.1.1.2.3">𝑡</ci></apply><apply id="S3.E5.m1.1.1.3.cmml" xref="S3.E5.m1.1.1.3"><divide id="S3.E5.m1.1.1.3.1.cmml" xref="S3.E5.m1.1.1.3"></divide><apply id="S3.E5.m1.1.1.3.2.cmml" xref="S3.E5.m1.1.1.3.2"><minus id="S3.E5.m1.1.1.3.2.1.cmml" xref="S3.E5.m1.1.1.3.2.1"></minus><apply id="S3.E5.m1.1.1.3.2.2.cmml" xref="S3.E5.m1.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.3.2.2.1.cmml" xref="S3.E5.m1.1.1.3.2.2">superscript</csymbol><apply id="S3.E5.m1.1.1.3.2.2.2.cmml" xref="S3.E5.m1.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.3.2.2.2.1.cmml" xref="S3.E5.m1.1.1.3.2.2">subscript</csymbol><apply id="S3.E5.m1.1.1.3.2.2.2.2.cmml" xref="S3.E5.m1.1.1.3.2.2.2.2"><ci id="S3.E5.m1.1.1.3.2.2.2.2.1.cmml" xref="S3.E5.m1.1.1.3.2.2.2.2.1">¯</ci><ci id="S3.E5.m1.1.1.3.2.2.2.2.2.cmml" xref="S3.E5.m1.1.1.3.2.2.2.2.2">𝑣</ci></apply><ci id="S3.E5.m1.1.1.3.2.2.2.3.cmml" xref="S3.E5.m1.1.1.3.2.2.2.3">𝑖</ci></apply><ci id="S3.E5.m1.1.1.3.2.2.3.cmml" xref="S3.E5.m1.1.1.3.2.2.3">𝑡</ci></apply><apply id="S3.E5.m1.1.1.3.2.3.cmml" xref="S3.E5.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.3.2.3.1.cmml" xref="S3.E5.m1.1.1.3.2.3">superscript</csymbol><apply id="S3.E5.m1.1.1.3.2.3.2.cmml" xref="S3.E5.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.3.2.3.2.1.cmml" xref="S3.E5.m1.1.1.3.2.3">subscript</csymbol><ci id="S3.E5.m1.1.1.3.2.3.2.2.cmml" xref="S3.E5.m1.1.1.3.2.3.2.2">𝑣</ci><ci id="S3.E5.m1.1.1.3.2.3.2.3.cmml" xref="S3.E5.m1.1.1.3.2.3.2.3">𝑖</ci></apply><ci id="S3.E5.m1.1.1.3.2.3.3.cmml" xref="S3.E5.m1.1.1.3.2.3.3">𝑡</ci></apply></apply><apply id="S3.E5.m1.1.1.3.3.cmml" xref="S3.E5.m1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.3.3.1.cmml" xref="S3.E5.m1.1.1.3.3">subscript</csymbol><apply id="S3.E5.m1.1.1.3.3.2.cmml" xref="S3.E5.m1.1.1.3.3.2"><ci id="S3.E5.m1.1.1.3.3.2.1.cmml" xref="S3.E5.m1.1.1.3.3.2.1">^</ci><ci id="S3.E5.m1.1.1.3.3.2.2.cmml" xref="S3.E5.m1.1.1.3.3.2.2">𝑣</ci></apply><ci id="S3.E5.m1.1.1.3.3.3.cmml" xref="S3.E5.m1.1.1.3.3.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.1c">x_{i}^{t}=\frac{\bar{v}_{i}^{t}-v_{i}^{t}}{\hat{v}_{i}}</annotation><annotation encoding="application/x-llamapun" id="S3.E5.m1.1d">italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT = divide start_ARG over¯ start_ARG italic_v end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT - italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT end_ARG start_ARG over^ start_ARG italic_v end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.p3" class="ltx_para">
<p id="S3.p3.15" class="ltx_p">The congestion rate of <math id="S3.p3.1.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S3.p3.1.m1.1a"><mi id="S3.p3.1.m1.1.1" xref="S3.p3.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.p3.1.m1.1b"><ci id="S3.p3.1.m1.1.1.cmml" xref="S3.p3.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="S3.p3.1.m1.1d">italic_N</annotation></semantics></math> roadway segments can be modeled as an <math id="S3.p3.2.m2.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S3.p3.2.m2.1a"><mi id="S3.p3.2.m2.1.1" xref="S3.p3.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.p3.2.m2.1b"><ci id="S3.p3.2.m2.1.1.cmml" xref="S3.p3.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.2.m2.1c">N</annotation><annotation encoding="application/x-llamapun" id="S3.p3.2.m2.1d">italic_N</annotation></semantics></math>-dimensional time series of length <math id="S3.p3.3.m3.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S3.p3.3.m3.1a"><mi id="S3.p3.3.m3.1.1" xref="S3.p3.3.m3.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.p3.3.m3.1b"><ci id="S3.p3.3.m3.1.1.cmml" xref="S3.p3.3.m3.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.3.m3.1c">T</annotation><annotation encoding="application/x-llamapun" id="S3.p3.3.m3.1d">italic_T</annotation></semantics></math>, denoted by <math id="S3.p3.4.m4.1" class="ltx_Math" alttext="X" display="inline"><semantics id="S3.p3.4.m4.1a"><mi id="S3.p3.4.m4.1.1" xref="S3.p3.4.m4.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S3.p3.4.m4.1b"><ci id="S3.p3.4.m4.1.1.cmml" xref="S3.p3.4.m4.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.4.m4.1c">X</annotation><annotation encoding="application/x-llamapun" id="S3.p3.4.m4.1d">italic_X</annotation></semantics></math>, i.e., <math id="S3.p3.5.m5.3" class="ltx_Math" alttext="X=\{x^{1},x^{2},\dots x^{T}\}" display="inline"><semantics id="S3.p3.5.m5.3a"><mrow id="S3.p3.5.m5.3.3" xref="S3.p3.5.m5.3.3.cmml"><mi id="S3.p3.5.m5.3.3.5" xref="S3.p3.5.m5.3.3.5.cmml">X</mi><mo id="S3.p3.5.m5.3.3.4" xref="S3.p3.5.m5.3.3.4.cmml">=</mo><mrow id="S3.p3.5.m5.3.3.3.3" xref="S3.p3.5.m5.3.3.3.4.cmml"><mo stretchy="false" id="S3.p3.5.m5.3.3.3.3.4" xref="S3.p3.5.m5.3.3.3.4.cmml">{</mo><msup id="S3.p3.5.m5.1.1.1.1.1" xref="S3.p3.5.m5.1.1.1.1.1.cmml"><mi id="S3.p3.5.m5.1.1.1.1.1.2" xref="S3.p3.5.m5.1.1.1.1.1.2.cmml">x</mi><mn id="S3.p3.5.m5.1.1.1.1.1.3" xref="S3.p3.5.m5.1.1.1.1.1.3.cmml">1</mn></msup><mo id="S3.p3.5.m5.3.3.3.3.5" xref="S3.p3.5.m5.3.3.3.4.cmml">,</mo><msup id="S3.p3.5.m5.2.2.2.2.2" xref="S3.p3.5.m5.2.2.2.2.2.cmml"><mi id="S3.p3.5.m5.2.2.2.2.2.2" xref="S3.p3.5.m5.2.2.2.2.2.2.cmml">x</mi><mn id="S3.p3.5.m5.2.2.2.2.2.3" xref="S3.p3.5.m5.2.2.2.2.2.3.cmml">2</mn></msup><mo id="S3.p3.5.m5.3.3.3.3.6" xref="S3.p3.5.m5.3.3.3.4.cmml">,</mo><mrow id="S3.p3.5.m5.3.3.3.3.3" xref="S3.p3.5.m5.3.3.3.3.3.cmml"><mi mathvariant="normal" id="S3.p3.5.m5.3.3.3.3.3.2" xref="S3.p3.5.m5.3.3.3.3.3.2.cmml">…</mi><mo id="S3.p3.5.m5.3.3.3.3.3.1" xref="S3.p3.5.m5.3.3.3.3.3.1.cmml">⁢</mo><msup id="S3.p3.5.m5.3.3.3.3.3.3" xref="S3.p3.5.m5.3.3.3.3.3.3.cmml"><mi id="S3.p3.5.m5.3.3.3.3.3.3.2" xref="S3.p3.5.m5.3.3.3.3.3.3.2.cmml">x</mi><mi id="S3.p3.5.m5.3.3.3.3.3.3.3" xref="S3.p3.5.m5.3.3.3.3.3.3.3.cmml">T</mi></msup></mrow><mo stretchy="false" id="S3.p3.5.m5.3.3.3.3.7" xref="S3.p3.5.m5.3.3.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.5.m5.3b"><apply id="S3.p3.5.m5.3.3.cmml" xref="S3.p3.5.m5.3.3"><eq id="S3.p3.5.m5.3.3.4.cmml" xref="S3.p3.5.m5.3.3.4"></eq><ci id="S3.p3.5.m5.3.3.5.cmml" xref="S3.p3.5.m5.3.3.5">𝑋</ci><set id="S3.p3.5.m5.3.3.3.4.cmml" xref="S3.p3.5.m5.3.3.3.3"><apply id="S3.p3.5.m5.1.1.1.1.1.cmml" xref="S3.p3.5.m5.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p3.5.m5.1.1.1.1.1.1.cmml" xref="S3.p3.5.m5.1.1.1.1.1">superscript</csymbol><ci id="S3.p3.5.m5.1.1.1.1.1.2.cmml" xref="S3.p3.5.m5.1.1.1.1.1.2">𝑥</ci><cn type="integer" id="S3.p3.5.m5.1.1.1.1.1.3.cmml" xref="S3.p3.5.m5.1.1.1.1.1.3">1</cn></apply><apply id="S3.p3.5.m5.2.2.2.2.2.cmml" xref="S3.p3.5.m5.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.p3.5.m5.2.2.2.2.2.1.cmml" xref="S3.p3.5.m5.2.2.2.2.2">superscript</csymbol><ci id="S3.p3.5.m5.2.2.2.2.2.2.cmml" xref="S3.p3.5.m5.2.2.2.2.2.2">𝑥</ci><cn type="integer" id="S3.p3.5.m5.2.2.2.2.2.3.cmml" xref="S3.p3.5.m5.2.2.2.2.2.3">2</cn></apply><apply id="S3.p3.5.m5.3.3.3.3.3.cmml" xref="S3.p3.5.m5.3.3.3.3.3"><times id="S3.p3.5.m5.3.3.3.3.3.1.cmml" xref="S3.p3.5.m5.3.3.3.3.3.1"></times><ci id="S3.p3.5.m5.3.3.3.3.3.2.cmml" xref="S3.p3.5.m5.3.3.3.3.3.2">…</ci><apply id="S3.p3.5.m5.3.3.3.3.3.3.cmml" xref="S3.p3.5.m5.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.p3.5.m5.3.3.3.3.3.3.1.cmml" xref="S3.p3.5.m5.3.3.3.3.3.3">superscript</csymbol><ci id="S3.p3.5.m5.3.3.3.3.3.3.2.cmml" xref="S3.p3.5.m5.3.3.3.3.3.3.2">𝑥</ci><ci id="S3.p3.5.m5.3.3.3.3.3.3.3.cmml" xref="S3.p3.5.m5.3.3.3.3.3.3.3">𝑇</ci></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.5.m5.3c">X=\{x^{1},x^{2},\dots x^{T}\}</annotation><annotation encoding="application/x-llamapun" id="S3.p3.5.m5.3d">italic_X = { italic_x start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT , italic_x start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT , … italic_x start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT }</annotation></semantics></math>, where <math id="S3.p3.6.m6.1" class="ltx_Math" alttext="x^{t}\in\mathbb{R}^{N}" display="inline"><semantics id="S3.p3.6.m6.1a"><mrow id="S3.p3.6.m6.1.1" xref="S3.p3.6.m6.1.1.cmml"><msup id="S3.p3.6.m6.1.1.2" xref="S3.p3.6.m6.1.1.2.cmml"><mi id="S3.p3.6.m6.1.1.2.2" xref="S3.p3.6.m6.1.1.2.2.cmml">x</mi><mi id="S3.p3.6.m6.1.1.2.3" xref="S3.p3.6.m6.1.1.2.3.cmml">t</mi></msup><mo id="S3.p3.6.m6.1.1.1" xref="S3.p3.6.m6.1.1.1.cmml">∈</mo><msup id="S3.p3.6.m6.1.1.3" xref="S3.p3.6.m6.1.1.3.cmml"><mi id="S3.p3.6.m6.1.1.3.2" xref="S3.p3.6.m6.1.1.3.2.cmml">ℝ</mi><mi id="S3.p3.6.m6.1.1.3.3" xref="S3.p3.6.m6.1.1.3.3.cmml">N</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.6.m6.1b"><apply id="S3.p3.6.m6.1.1.cmml" xref="S3.p3.6.m6.1.1"><in id="S3.p3.6.m6.1.1.1.cmml" xref="S3.p3.6.m6.1.1.1"></in><apply id="S3.p3.6.m6.1.1.2.cmml" xref="S3.p3.6.m6.1.1.2"><csymbol cd="ambiguous" id="S3.p3.6.m6.1.1.2.1.cmml" xref="S3.p3.6.m6.1.1.2">superscript</csymbol><ci id="S3.p3.6.m6.1.1.2.2.cmml" xref="S3.p3.6.m6.1.1.2.2">𝑥</ci><ci id="S3.p3.6.m6.1.1.2.3.cmml" xref="S3.p3.6.m6.1.1.2.3">𝑡</ci></apply><apply id="S3.p3.6.m6.1.1.3.cmml" xref="S3.p3.6.m6.1.1.3"><csymbol cd="ambiguous" id="S3.p3.6.m6.1.1.3.1.cmml" xref="S3.p3.6.m6.1.1.3">superscript</csymbol><ci id="S3.p3.6.m6.1.1.3.2.cmml" xref="S3.p3.6.m6.1.1.3.2">ℝ</ci><ci id="S3.p3.6.m6.1.1.3.3.cmml" xref="S3.p3.6.m6.1.1.3.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.6.m6.1c">x^{t}\in\mathbb{R}^{N}</annotation><annotation encoding="application/x-llamapun" id="S3.p3.6.m6.1d">italic_x start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT</annotation></semantics></math> is an <math id="S3.p3.7.m7.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S3.p3.7.m7.1a"><mi id="S3.p3.7.m7.1.1" xref="S3.p3.7.m7.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.p3.7.m7.1b"><ci id="S3.p3.7.m7.1.1.cmml" xref="S3.p3.7.m7.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.7.m7.1c">N</annotation><annotation encoding="application/x-llamapun" id="S3.p3.7.m7.1d">italic_N</annotation></semantics></math> dimensional vector representing a measurement at time <math id="S3.p3.8.m8.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.p3.8.m8.1a"><mi id="S3.p3.8.m8.1.1" xref="S3.p3.8.m8.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.p3.8.m8.1b"><ci id="S3.p3.8.m8.1.1.cmml" xref="S3.p3.8.m8.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.8.m8.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.p3.8.m8.1d">italic_t</annotation></semantics></math>. The congestion observation from the <math id="S3.p3.9.m9.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.p3.9.m9.1a"><mi id="S3.p3.9.m9.1.1" xref="S3.p3.9.m9.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.p3.9.m9.1b"><ci id="S3.p3.9.m9.1.1.cmml" xref="S3.p3.9.m9.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.9.m9.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.p3.9.m9.1d">italic_i</annotation></semantics></math>th segment at time <math id="S3.p3.10.m10.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.p3.10.m10.1a"><mi id="S3.p3.10.m10.1.1" xref="S3.p3.10.m10.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.p3.10.m10.1b"><ci id="S3.p3.10.m10.1.1.cmml" xref="S3.p3.10.m10.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.10.m10.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.p3.10.m10.1d">italic_t</annotation></semantics></math> is <math id="S3.p3.11.m11.1" class="ltx_Math" alttext="x^{t}_{i}" display="inline"><semantics id="S3.p3.11.m11.1a"><msubsup id="S3.p3.11.m11.1.1" xref="S3.p3.11.m11.1.1.cmml"><mi id="S3.p3.11.m11.1.1.2.2" xref="S3.p3.11.m11.1.1.2.2.cmml">x</mi><mi id="S3.p3.11.m11.1.1.3" xref="S3.p3.11.m11.1.1.3.cmml">i</mi><mi id="S3.p3.11.m11.1.1.2.3" xref="S3.p3.11.m11.1.1.2.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.p3.11.m11.1b"><apply id="S3.p3.11.m11.1.1.cmml" xref="S3.p3.11.m11.1.1"><csymbol cd="ambiguous" id="S3.p3.11.m11.1.1.1.cmml" xref="S3.p3.11.m11.1.1">subscript</csymbol><apply id="S3.p3.11.m11.1.1.2.cmml" xref="S3.p3.11.m11.1.1"><csymbol cd="ambiguous" id="S3.p3.11.m11.1.1.2.1.cmml" xref="S3.p3.11.m11.1.1">superscript</csymbol><ci id="S3.p3.11.m11.1.1.2.2.cmml" xref="S3.p3.11.m11.1.1.2.2">𝑥</ci><ci id="S3.p3.11.m11.1.1.2.3.cmml" xref="S3.p3.11.m11.1.1.2.3">𝑡</ci></apply><ci id="S3.p3.11.m11.1.1.3.cmml" xref="S3.p3.11.m11.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.11.m11.1c">x^{t}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.p3.11.m11.1d">italic_x start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>. At an arbitrary time <math id="S3.p3.12.m12.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.p3.12.m12.1a"><mi id="S3.p3.12.m12.1.1" xref="S3.p3.12.m12.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.p3.12.m12.1b"><ci id="S3.p3.12.m12.1.1.cmml" xref="S3.p3.12.m12.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.12.m12.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.p3.12.m12.1d">italic_t</annotation></semantics></math>, <math id="S3.p3.13.m13.1" class="ltx_Math" alttext="x^{t}" display="inline"><semantics id="S3.p3.13.m13.1a"><msup id="S3.p3.13.m13.1.1" xref="S3.p3.13.m13.1.1.cmml"><mi id="S3.p3.13.m13.1.1.2" xref="S3.p3.13.m13.1.1.2.cmml">x</mi><mi id="S3.p3.13.m13.1.1.3" xref="S3.p3.13.m13.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S3.p3.13.m13.1b"><apply id="S3.p3.13.m13.1.1.cmml" xref="S3.p3.13.m13.1.1"><csymbol cd="ambiguous" id="S3.p3.13.m13.1.1.1.cmml" xref="S3.p3.13.m13.1.1">superscript</csymbol><ci id="S3.p3.13.m13.1.1.2.cmml" xref="S3.p3.13.m13.1.1.2">𝑥</ci><ci id="S3.p3.13.m13.1.1.3.cmml" xref="S3.p3.13.m13.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.13.m13.1c">x^{t}</annotation><annotation encoding="application/x-llamapun" id="S3.p3.13.m13.1d">italic_x start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math> therefore denotes a snapshot of congestion at all roadway segments. Each time step can have additional features associated with it, e.g., day of the week and hour of the day. We denote such features for the <math id="S3.p3.14.m14.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.p3.14.m14.1a"><mi id="S3.p3.14.m14.1.1" xref="S3.p3.14.m14.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.p3.14.m14.1b"><ci id="S3.p3.14.m14.1.1.cmml" xref="S3.p3.14.m14.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.14.m14.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.p3.14.m14.1d">italic_t</annotation></semantics></math>-th time step be <math id="S3.p3.15.m15.1" class="ltx_Math" alttext="\lambda^{t}" display="inline"><semantics id="S3.p3.15.m15.1a"><msup id="S3.p3.15.m15.1.1" xref="S3.p3.15.m15.1.1.cmml"><mi id="S3.p3.15.m15.1.1.2" xref="S3.p3.15.m15.1.1.2.cmml">λ</mi><mi id="S3.p3.15.m15.1.1.3" xref="S3.p3.15.m15.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S3.p3.15.m15.1b"><apply id="S3.p3.15.m15.1.1.cmml" xref="S3.p3.15.m15.1.1"><csymbol cd="ambiguous" id="S3.p3.15.m15.1.1.1.cmml" xref="S3.p3.15.m15.1.1">superscript</csymbol><ci id="S3.p3.15.m15.1.1.2.cmml" xref="S3.p3.15.m15.1.1.2">𝜆</ci><ci id="S3.p3.15.m15.1.1.3.cmml" xref="S3.p3.15.m15.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.15.m15.1c">\lambda^{t}</annotation><annotation encoding="application/x-llamapun" id="S3.p3.15.m15.1d">italic_λ start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math>.
</p>
</div>
<div id="S3.p4" class="ltx_para">
<p id="S3.p4.1" class="ltx_p">The primary goal of our framework is to detect points in time at which anomalous congestion may occur. With the obtained detection results, the secondary target is to recognize the roadway segments most likely to have caused the abnormal observation at each timestamp. Figures <a href="#S3.F1" title="Figure 1 ‣ III-A Time Series Clustering ‣ III Methodology ‣ Generative Anomaly Detection for Time Series Datasets" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> and <a href="#S3.F2" title="Figure 2 ‣ III-B Timestamp-level Anomaly Detection ‣ III Methodology ‣ Generative Anomaly Detection for Time Series Datasets" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> together demonstrate a four step method we propose for fulfilling these targets: (1) time series clustering based on similarity measures; (2) unsupervised anomaly detection based on conditional RealNVP; (3) anomaly diagnosis at the road segment granularity based on non-parametric kernel density estimation; (4) auxiliary supervised anomaly detection based on multi-layer perceptron.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS1.5.1.1" class="ltx_text">III-A</span> </span><span id="S3.SS1.6.2" class="ltx_text ltx_font_italic">Time Series Clustering</span>
</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.2" class="ltx_p">In practice, <math id="S3.SS1.p1.1.m1.1" class="ltx_Math" alttext="X" display="inline"><semantics id="S3.SS1.p1.1.m1.1a"><mi id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">X</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.1d">italic_X</annotation></semantics></math> might be composed of thousands of dimensions with heterogeneous temporal patterns, semantic meanings, or underlying dependencies. It is computationally difficult to learn patterns or explicit probability distributions for extremely high-dimensional data. One way to alleviate this challenge is by identifying dimensions that are related in the feature space. To tackle this, we perform data-driven clustering to partition the given time series into separate groups based on similarity (where similarity is based on an appropriate distance in the feature space, e.g., the <math id="S3.SS1.p1.2.m2.1" class="ltx_Math" alttext="\ell 1" display="inline"><semantics id="S3.SS1.p1.2.m2.1a"><mrow id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml"><mi mathvariant="normal" id="S3.SS1.p1.2.m2.1.1.2" xref="S3.SS1.p1.2.m2.1.1.2.cmml">ℓ</mi><mo id="S3.SS1.p1.2.m2.1.1.1" xref="S3.SS1.p1.2.m2.1.1.1.cmml">⁢</mo><mn id="S3.SS1.p1.2.m2.1.1.3" xref="S3.SS1.p1.2.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><apply id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1"><times id="S3.SS1.p1.2.m2.1.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1.1"></times><ci id="S3.SS1.p1.2.m2.1.1.2.cmml" xref="S3.SS1.p1.2.m2.1.1.2">ℓ</ci><cn type="integer" id="S3.SS1.p1.2.m2.1.1.3.cmml" xref="S3.SS1.p1.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">\ell 1</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.2.m2.1d">roman_ℓ 1</annotation></semantics></math> norm). This step facilitates anomaly detection and diagnosis in two aspects. First, it ensures that learning the probability distribution over the input time series is tractable. Second, similarity in the feature space naturally associates semantic meaning to the clusters; e.g., we observe that different clusters correspond (roughly) to different types of roads such as highways and on-ramps. Learning an explicit distribution for a particular cluster therefore enables us to learn a distribution of traffic in a particular type of roadway.
</p>
</div>
<figure id="S3.F1" class="ltx_figure"><img src="/html/2206.14597/assets/images/clustering.png" id="S3.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="91" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Grouping the road segments into clusters.</figcaption>
</figure>
<div id="S3.SS1.p2" class="ltx_para">
<p id="S3.SS1.p2.6" class="ltx_p">Traditional clustering methods cannot be applied directly to time-series settings due to the temporal nature of the data. A general idea of time series clustering, as shown in Figure <a href="#S3.F1" title="Figure 1 ‣ III-A Time Series Clustering ‣ III Methodology ‣ Generative Anomaly Detection for Time Series Datasets" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, is to first convert temporal data to a <span id="S3.SS1.p2.6.1" class="ltx_text ltx_font_italic">flat</span> representation by computing a similarity or distance matrix; then, a standard clustering algorithm (e.g., KMeans <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>, DBSCAN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>) can be used to partition the flat representation. We leverage the commonly-used “Dynamic Time Warping” (DTW) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite> distance to measure pair-wise similarities between time series. Particularly, consider arbitrary road segments <math id="S3.SS1.p2.1.m1.1" class="ltx_Math" alttext="S_{i}" display="inline"><semantics id="S3.SS1.p2.1.m1.1a"><msub id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml"><mi id="S3.SS1.p2.1.m1.1.1.2" xref="S3.SS1.p2.1.m1.1.1.2.cmml">S</mi><mi id="S3.SS1.p2.1.m1.1.1.3" xref="S3.SS1.p2.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><apply id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p2.1.m1.1.1.2.cmml" xref="S3.SS1.p2.1.m1.1.1.2">𝑆</ci><ci id="S3.SS1.p2.1.m1.1.1.3.cmml" xref="S3.SS1.p2.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">S_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.1.m1.1d">italic_S start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and <math id="S3.SS1.p2.2.m2.1" class="ltx_Math" alttext="S_{j}" display="inline"><semantics id="S3.SS1.p2.2.m2.1a"><msub id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml"><mi id="S3.SS1.p2.2.m2.1.1.2" xref="S3.SS1.p2.2.m2.1.1.2.cmml">S</mi><mi id="S3.SS1.p2.2.m2.1.1.3" xref="S3.SS1.p2.2.m2.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><apply id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.1.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p2.2.m2.1.1.2.cmml" xref="S3.SS1.p2.2.m2.1.1.2">𝑆</ci><ci id="S3.SS1.p2.2.m2.1.1.3.cmml" xref="S3.SS1.p2.2.m2.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">S_{j}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.2.m2.1d">italic_S start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>. The DTW distance between the segments (in the feature space defined by congestion) can be calculated as the squared root of the sum of squared distances between every element in <math id="S3.SS1.p2.3.m3.3" class="ltx_Math" alttext="x^{t}_{i}\;\forall t\in\{1,\dots,T\}" display="inline"><semantics id="S3.SS1.p2.3.m3.3a"><mrow id="S3.SS1.p2.3.m3.3.4" xref="S3.SS1.p2.3.m3.3.4.cmml"><mrow id="S3.SS1.p2.3.m3.3.4.2" xref="S3.SS1.p2.3.m3.3.4.2.cmml"><msubsup id="S3.SS1.p2.3.m3.3.4.2.2" xref="S3.SS1.p2.3.m3.3.4.2.2.cmml"><mi id="S3.SS1.p2.3.m3.3.4.2.2.2.2" xref="S3.SS1.p2.3.m3.3.4.2.2.2.2.cmml">x</mi><mi id="S3.SS1.p2.3.m3.3.4.2.2.3" xref="S3.SS1.p2.3.m3.3.4.2.2.3.cmml">i</mi><mi id="S3.SS1.p2.3.m3.3.4.2.2.2.3" xref="S3.SS1.p2.3.m3.3.4.2.2.2.3.cmml">t</mi></msubsup><mo lspace="0.447em" id="S3.SS1.p2.3.m3.3.4.2.1" xref="S3.SS1.p2.3.m3.3.4.2.1.cmml">⁢</mo><mrow id="S3.SS1.p2.3.m3.3.4.2.3" xref="S3.SS1.p2.3.m3.3.4.2.3.cmml"><mo rspace="0.167em" id="S3.SS1.p2.3.m3.3.4.2.3.1" xref="S3.SS1.p2.3.m3.3.4.2.3.1.cmml">∀</mo><mi id="S3.SS1.p2.3.m3.3.4.2.3.2" xref="S3.SS1.p2.3.m3.3.4.2.3.2.cmml">t</mi></mrow></mrow><mo id="S3.SS1.p2.3.m3.3.4.1" xref="S3.SS1.p2.3.m3.3.4.1.cmml">∈</mo><mrow id="S3.SS1.p2.3.m3.3.4.3.2" xref="S3.SS1.p2.3.m3.3.4.3.1.cmml"><mo stretchy="false" id="S3.SS1.p2.3.m3.3.4.3.2.1" xref="S3.SS1.p2.3.m3.3.4.3.1.cmml">{</mo><mn id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml">1</mn><mo id="S3.SS1.p2.3.m3.3.4.3.2.2" xref="S3.SS1.p2.3.m3.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.p2.3.m3.2.2" xref="S3.SS1.p2.3.m3.2.2.cmml">…</mi><mo id="S3.SS1.p2.3.m3.3.4.3.2.3" xref="S3.SS1.p2.3.m3.3.4.3.1.cmml">,</mo><mi id="S3.SS1.p2.3.m3.3.3" xref="S3.SS1.p2.3.m3.3.3.cmml">T</mi><mo stretchy="false" id="S3.SS1.p2.3.m3.3.4.3.2.4" xref="S3.SS1.p2.3.m3.3.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.3b"><apply id="S3.SS1.p2.3.m3.3.4.cmml" xref="S3.SS1.p2.3.m3.3.4"><in id="S3.SS1.p2.3.m3.3.4.1.cmml" xref="S3.SS1.p2.3.m3.3.4.1"></in><apply id="S3.SS1.p2.3.m3.3.4.2.cmml" xref="S3.SS1.p2.3.m3.3.4.2"><times id="S3.SS1.p2.3.m3.3.4.2.1.cmml" xref="S3.SS1.p2.3.m3.3.4.2.1"></times><apply id="S3.SS1.p2.3.m3.3.4.2.2.cmml" xref="S3.SS1.p2.3.m3.3.4.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.3.4.2.2.1.cmml" xref="S3.SS1.p2.3.m3.3.4.2.2">subscript</csymbol><apply id="S3.SS1.p2.3.m3.3.4.2.2.2.cmml" xref="S3.SS1.p2.3.m3.3.4.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.3.4.2.2.2.1.cmml" xref="S3.SS1.p2.3.m3.3.4.2.2">superscript</csymbol><ci id="S3.SS1.p2.3.m3.3.4.2.2.2.2.cmml" xref="S3.SS1.p2.3.m3.3.4.2.2.2.2">𝑥</ci><ci id="S3.SS1.p2.3.m3.3.4.2.2.2.3.cmml" xref="S3.SS1.p2.3.m3.3.4.2.2.2.3">𝑡</ci></apply><ci id="S3.SS1.p2.3.m3.3.4.2.2.3.cmml" xref="S3.SS1.p2.3.m3.3.4.2.2.3">𝑖</ci></apply><apply id="S3.SS1.p2.3.m3.3.4.2.3.cmml" xref="S3.SS1.p2.3.m3.3.4.2.3"><csymbol cd="latexml" id="S3.SS1.p2.3.m3.3.4.2.3.1.cmml" xref="S3.SS1.p2.3.m3.3.4.2.3.1">for-all</csymbol><ci id="S3.SS1.p2.3.m3.3.4.2.3.2.cmml" xref="S3.SS1.p2.3.m3.3.4.2.3.2">𝑡</ci></apply></apply><set id="S3.SS1.p2.3.m3.3.4.3.1.cmml" xref="S3.SS1.p2.3.m3.3.4.3.2"><cn type="integer" id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1">1</cn><ci id="S3.SS1.p2.3.m3.2.2.cmml" xref="S3.SS1.p2.3.m3.2.2">…</ci><ci id="S3.SS1.p2.3.m3.3.3.cmml" xref="S3.SS1.p2.3.m3.3.3">𝑇</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.3c">x^{t}_{i}\;\forall t\in\{1,\dots,T\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.3.m3.3d">italic_x start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∀ italic_t ∈ { 1 , … , italic_T }</annotation></semantics></math> and its nearest point in <math id="S3.SS1.p2.4.m4.3" class="ltx_Math" alttext="x^{t}_{j}\;\forall t\in\{1,\dots,T\}" display="inline"><semantics id="S3.SS1.p2.4.m4.3a"><mrow id="S3.SS1.p2.4.m4.3.4" xref="S3.SS1.p2.4.m4.3.4.cmml"><mrow id="S3.SS1.p2.4.m4.3.4.2" xref="S3.SS1.p2.4.m4.3.4.2.cmml"><msubsup id="S3.SS1.p2.4.m4.3.4.2.2" xref="S3.SS1.p2.4.m4.3.4.2.2.cmml"><mi id="S3.SS1.p2.4.m4.3.4.2.2.2.2" xref="S3.SS1.p2.4.m4.3.4.2.2.2.2.cmml">x</mi><mi id="S3.SS1.p2.4.m4.3.4.2.2.3" xref="S3.SS1.p2.4.m4.3.4.2.2.3.cmml">j</mi><mi id="S3.SS1.p2.4.m4.3.4.2.2.2.3" xref="S3.SS1.p2.4.m4.3.4.2.2.2.3.cmml">t</mi></msubsup><mo lspace="0.447em" id="S3.SS1.p2.4.m4.3.4.2.1" xref="S3.SS1.p2.4.m4.3.4.2.1.cmml">⁢</mo><mrow id="S3.SS1.p2.4.m4.3.4.2.3" xref="S3.SS1.p2.4.m4.3.4.2.3.cmml"><mo rspace="0.167em" id="S3.SS1.p2.4.m4.3.4.2.3.1" xref="S3.SS1.p2.4.m4.3.4.2.3.1.cmml">∀</mo><mi id="S3.SS1.p2.4.m4.3.4.2.3.2" xref="S3.SS1.p2.4.m4.3.4.2.3.2.cmml">t</mi></mrow></mrow><mo id="S3.SS1.p2.4.m4.3.4.1" xref="S3.SS1.p2.4.m4.3.4.1.cmml">∈</mo><mrow id="S3.SS1.p2.4.m4.3.4.3.2" xref="S3.SS1.p2.4.m4.3.4.3.1.cmml"><mo stretchy="false" id="S3.SS1.p2.4.m4.3.4.3.2.1" xref="S3.SS1.p2.4.m4.3.4.3.1.cmml">{</mo><mn id="S3.SS1.p2.4.m4.1.1" xref="S3.SS1.p2.4.m4.1.1.cmml">1</mn><mo id="S3.SS1.p2.4.m4.3.4.3.2.2" xref="S3.SS1.p2.4.m4.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.p2.4.m4.2.2" xref="S3.SS1.p2.4.m4.2.2.cmml">…</mi><mo id="S3.SS1.p2.4.m4.3.4.3.2.3" xref="S3.SS1.p2.4.m4.3.4.3.1.cmml">,</mo><mi id="S3.SS1.p2.4.m4.3.3" xref="S3.SS1.p2.4.m4.3.3.cmml">T</mi><mo stretchy="false" id="S3.SS1.p2.4.m4.3.4.3.2.4" xref="S3.SS1.p2.4.m4.3.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m4.3b"><apply id="S3.SS1.p2.4.m4.3.4.cmml" xref="S3.SS1.p2.4.m4.3.4"><in id="S3.SS1.p2.4.m4.3.4.1.cmml" xref="S3.SS1.p2.4.m4.3.4.1"></in><apply id="S3.SS1.p2.4.m4.3.4.2.cmml" xref="S3.SS1.p2.4.m4.3.4.2"><times id="S3.SS1.p2.4.m4.3.4.2.1.cmml" xref="S3.SS1.p2.4.m4.3.4.2.1"></times><apply id="S3.SS1.p2.4.m4.3.4.2.2.cmml" xref="S3.SS1.p2.4.m4.3.4.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.3.4.2.2.1.cmml" xref="S3.SS1.p2.4.m4.3.4.2.2">subscript</csymbol><apply id="S3.SS1.p2.4.m4.3.4.2.2.2.cmml" xref="S3.SS1.p2.4.m4.3.4.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.3.4.2.2.2.1.cmml" xref="S3.SS1.p2.4.m4.3.4.2.2">superscript</csymbol><ci id="S3.SS1.p2.4.m4.3.4.2.2.2.2.cmml" xref="S3.SS1.p2.4.m4.3.4.2.2.2.2">𝑥</ci><ci id="S3.SS1.p2.4.m4.3.4.2.2.2.3.cmml" xref="S3.SS1.p2.4.m4.3.4.2.2.2.3">𝑡</ci></apply><ci id="S3.SS1.p2.4.m4.3.4.2.2.3.cmml" xref="S3.SS1.p2.4.m4.3.4.2.2.3">𝑗</ci></apply><apply id="S3.SS1.p2.4.m4.3.4.2.3.cmml" xref="S3.SS1.p2.4.m4.3.4.2.3"><csymbol cd="latexml" id="S3.SS1.p2.4.m4.3.4.2.3.1.cmml" xref="S3.SS1.p2.4.m4.3.4.2.3.1">for-all</csymbol><ci id="S3.SS1.p2.4.m4.3.4.2.3.2.cmml" xref="S3.SS1.p2.4.m4.3.4.2.3.2">𝑡</ci></apply></apply><set id="S3.SS1.p2.4.m4.3.4.3.1.cmml" xref="S3.SS1.p2.4.m4.3.4.3.2"><cn type="integer" id="S3.SS1.p2.4.m4.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1">1</cn><ci id="S3.SS1.p2.4.m4.2.2.cmml" xref="S3.SS1.p2.4.m4.2.2">…</ci><ci id="S3.SS1.p2.4.m4.3.3.cmml" xref="S3.SS1.p2.4.m4.3.3">𝑇</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m4.3c">x^{t}_{j}\;\forall t\in\{1,\dots,T\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.4.m4.3d">italic_x start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ∀ italic_t ∈ { 1 , … , italic_T }</annotation></semantics></math>. Intuitively, the distance reflects how similar was <span id="S3.SS1.p2.6.2" class="ltx_text ltx_font_italic">each</span> congestion value observed in segment <math id="S3.SS1.p2.5.m5.1" class="ltx_Math" alttext="S_{i}" display="inline"><semantics id="S3.SS1.p2.5.m5.1a"><msub id="S3.SS1.p2.5.m5.1.1" xref="S3.SS1.p2.5.m5.1.1.cmml"><mi id="S3.SS1.p2.5.m5.1.1.2" xref="S3.SS1.p2.5.m5.1.1.2.cmml">S</mi><mi id="S3.SS1.p2.5.m5.1.1.3" xref="S3.SS1.p2.5.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.5.m5.1b"><apply id="S3.SS1.p2.5.m5.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.5.m5.1.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1">subscript</csymbol><ci id="S3.SS1.p2.5.m5.1.1.2.cmml" xref="S3.SS1.p2.5.m5.1.1.2">𝑆</ci><ci id="S3.SS1.p2.5.m5.1.1.3.cmml" xref="S3.SS1.p2.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.5.m5.1c">S_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.5.m5.1d">italic_S start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> to <span id="S3.SS1.p2.6.3" class="ltx_text ltx_font_italic">any</span> congestion value observed in segment <math id="S3.SS1.p2.6.m6.1" class="ltx_Math" alttext="S_{j}" display="inline"><semantics id="S3.SS1.p2.6.m6.1a"><msub id="S3.SS1.p2.6.m6.1.1" xref="S3.SS1.p2.6.m6.1.1.cmml"><mi id="S3.SS1.p2.6.m6.1.1.2" xref="S3.SS1.p2.6.m6.1.1.2.cmml">S</mi><mi id="S3.SS1.p2.6.m6.1.1.3" xref="S3.SS1.p2.6.m6.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.6.m6.1b"><apply id="S3.SS1.p2.6.m6.1.1.cmml" xref="S3.SS1.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.6.m6.1.1.1.cmml" xref="S3.SS1.p2.6.m6.1.1">subscript</csymbol><ci id="S3.SS1.p2.6.m6.1.1.2.cmml" xref="S3.SS1.p2.6.m6.1.1.2">𝑆</ci><ci id="S3.SS1.p2.6.m6.1.1.3.cmml" xref="S3.SS1.p2.6.m6.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.6.m6.1c">S_{j}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.6.m6.1d">italic_S start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>, and then aggregates the similarities. Given the similarity measures, we use the OPTICS algorithm <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite> for clustering. The OPTICS algorithm is density-based, which does not require the number of clusters as a prerequisite. Given the clusters, we perform anomaly detection in each cluster independently.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS2.5.1.1" class="ltx_text">III-B</span> </span><span id="S3.SS2.6.2" class="ltx_text ltx_font_italic">Timestamp-level Anomaly Detection</span>
</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.4" class="ltx_p">We can perform density estimation on the raw data using RealNVP directly; recall that the normalizing flow approach allows us to perform tractable density estimation. However, our initial experiments proved otherwise as the flow model failed to capture contextual anomalies. This observation is not surprising; the transformations in RealNVP operate along the feature dimensions but discard the temporal correlation in the data. In contrast, recurrent neural networks with gated memory such as LSTM (long short-term memory networks) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>
have been proven to be powerful tools for modeling sequential data. This inspires us to explore the possibility of capturing “point” and “contextual” anomalies simultaneously by aggregating an LSTM-based Encoder-Decoder and a normalizing flow model. As LSTM requires three-dimensional inputs (the batch size, the number of time steps, and the number of features), we use overlapping sliding windows <math id="S3.SS2.p1.1.m1.2" class="ltx_Math" alttext="x^{\{1:\tau\}}" display="inline"><semantics id="S3.SS2.p1.1.m1.2a"><msup id="S3.SS2.p1.1.m1.2.3" xref="S3.SS2.p1.1.m1.2.3.cmml"><mi id="S3.SS2.p1.1.m1.2.3.2" xref="S3.SS2.p1.1.m1.2.3.2.cmml">x</mi><mrow id="S3.SS2.p1.1.m1.2.2.2.4" xref="S3.SS2.p1.1.m1.2.2.2.3.cmml"><mo stretchy="false" id="S3.SS2.p1.1.m1.2.2.2.4.1" xref="S3.SS2.p1.1.m1.2.2.2.3.1.cmml">{</mo><mn id="S3.SS2.p1.1.m1.1.1.1.1" xref="S3.SS2.p1.1.m1.1.1.1.1.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S3.SS2.p1.1.m1.2.2.2.4.2" xref="S3.SS2.p1.1.m1.2.2.2.3.1.cmml">:</mo><mi id="S3.SS2.p1.1.m1.2.2.2.2" xref="S3.SS2.p1.1.m1.2.2.2.2.cmml">τ</mi><mo stretchy="false" id="S3.SS2.p1.1.m1.2.2.2.4.3" xref="S3.SS2.p1.1.m1.2.2.2.3.1.cmml">}</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.2b"><apply id="S3.SS2.p1.1.m1.2.3.cmml" xref="S3.SS2.p1.1.m1.2.3"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.2.3.1.cmml" xref="S3.SS2.p1.1.m1.2.3">superscript</csymbol><ci id="S3.SS2.p1.1.m1.2.3.2.cmml" xref="S3.SS2.p1.1.m1.2.3.2">𝑥</ci><apply id="S3.SS2.p1.1.m1.2.2.2.3.cmml" xref="S3.SS2.p1.1.m1.2.2.2.4"><csymbol cd="latexml" id="S3.SS2.p1.1.m1.2.2.2.3.1.cmml" xref="S3.SS2.p1.1.m1.2.2.2.4.1">conditional-set</csymbol><cn type="integer" id="S3.SS2.p1.1.m1.1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1">1</cn><ci id="S3.SS2.p1.1.m1.2.2.2.2.cmml" xref="S3.SS2.p1.1.m1.2.2.2.2">𝜏</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.2c">x^{\{1:\tau\}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.1.m1.2d">italic_x start_POSTSUPERSCRIPT { 1 : italic_τ } end_POSTSUPERSCRIPT</annotation></semantics></math> of length <math id="S3.SS2.p1.2.m2.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="S3.SS2.p1.2.m2.1a"><mi id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><ci id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.2.m2.1d">italic_τ</annotation></semantics></math> as inputs, where each window is further divided into a context window <math id="S3.SS2.p1.3.m3.2" class="ltx_Math" alttext="x^{\{1:t_{0}-1\}}" display="inline"><semantics id="S3.SS2.p1.3.m3.2a"><msup id="S3.SS2.p1.3.m3.2.3" xref="S3.SS2.p1.3.m3.2.3.cmml"><mi id="S3.SS2.p1.3.m3.2.3.2" xref="S3.SS2.p1.3.m3.2.3.2.cmml">x</mi><mrow id="S3.SS2.p1.3.m3.2.2.2.2" xref="S3.SS2.p1.3.m3.2.2.2.3.cmml"><mo stretchy="false" id="S3.SS2.p1.3.m3.2.2.2.2.2" xref="S3.SS2.p1.3.m3.2.2.2.3.1.cmml">{</mo><mn id="S3.SS2.p1.3.m3.1.1.1.1" xref="S3.SS2.p1.3.m3.1.1.1.1.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S3.SS2.p1.3.m3.2.2.2.2.3" xref="S3.SS2.p1.3.m3.2.2.2.3.1.cmml">:</mo><mrow id="S3.SS2.p1.3.m3.2.2.2.2.1" xref="S3.SS2.p1.3.m3.2.2.2.2.1.cmml"><msub id="S3.SS2.p1.3.m3.2.2.2.2.1.2" xref="S3.SS2.p1.3.m3.2.2.2.2.1.2.cmml"><mi id="S3.SS2.p1.3.m3.2.2.2.2.1.2.2" xref="S3.SS2.p1.3.m3.2.2.2.2.1.2.2.cmml">t</mi><mn id="S3.SS2.p1.3.m3.2.2.2.2.1.2.3" xref="S3.SS2.p1.3.m3.2.2.2.2.1.2.3.cmml">0</mn></msub><mo id="S3.SS2.p1.3.m3.2.2.2.2.1.1" xref="S3.SS2.p1.3.m3.2.2.2.2.1.1.cmml">−</mo><mn id="S3.SS2.p1.3.m3.2.2.2.2.1.3" xref="S3.SS2.p1.3.m3.2.2.2.2.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.SS2.p1.3.m3.2.2.2.2.4" xref="S3.SS2.p1.3.m3.2.2.2.3.1.cmml">}</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.2b"><apply id="S3.SS2.p1.3.m3.2.3.cmml" xref="S3.SS2.p1.3.m3.2.3"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.2.3.1.cmml" xref="S3.SS2.p1.3.m3.2.3">superscript</csymbol><ci id="S3.SS2.p1.3.m3.2.3.2.cmml" xref="S3.SS2.p1.3.m3.2.3.2">𝑥</ci><apply id="S3.SS2.p1.3.m3.2.2.2.3.cmml" xref="S3.SS2.p1.3.m3.2.2.2.2"><csymbol cd="latexml" id="S3.SS2.p1.3.m3.2.2.2.3.1.cmml" xref="S3.SS2.p1.3.m3.2.2.2.2.2">conditional-set</csymbol><cn type="integer" id="S3.SS2.p1.3.m3.1.1.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1.1.1">1</cn><apply id="S3.SS2.p1.3.m3.2.2.2.2.1.cmml" xref="S3.SS2.p1.3.m3.2.2.2.2.1"><minus id="S3.SS2.p1.3.m3.2.2.2.2.1.1.cmml" xref="S3.SS2.p1.3.m3.2.2.2.2.1.1"></minus><apply id="S3.SS2.p1.3.m3.2.2.2.2.1.2.cmml" xref="S3.SS2.p1.3.m3.2.2.2.2.1.2"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.2.2.2.2.1.2.1.cmml" xref="S3.SS2.p1.3.m3.2.2.2.2.1.2">subscript</csymbol><ci id="S3.SS2.p1.3.m3.2.2.2.2.1.2.2.cmml" xref="S3.SS2.p1.3.m3.2.2.2.2.1.2.2">𝑡</ci><cn type="integer" id="S3.SS2.p1.3.m3.2.2.2.2.1.2.3.cmml" xref="S3.SS2.p1.3.m3.2.2.2.2.1.2.3">0</cn></apply><cn type="integer" id="S3.SS2.p1.3.m3.2.2.2.2.1.3.cmml" xref="S3.SS2.p1.3.m3.2.2.2.2.1.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.2c">x^{\{1:t_{0}-1\}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.3.m3.2d">italic_x start_POSTSUPERSCRIPT { 1 : italic_t start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT - 1 } end_POSTSUPERSCRIPT</annotation></semantics></math> and a prediction window <math id="S3.SS2.p1.4.m4.2" class="ltx_Math" alttext="x^{\{t_{0}:\tau\}}" display="inline"><semantics id="S3.SS2.p1.4.m4.2a"><msup id="S3.SS2.p1.4.m4.2.3" xref="S3.SS2.p1.4.m4.2.3.cmml"><mi id="S3.SS2.p1.4.m4.2.3.2" xref="S3.SS2.p1.4.m4.2.3.2.cmml">x</mi><mrow id="S3.SS2.p1.4.m4.2.2.2.2" xref="S3.SS2.p1.4.m4.2.2.2.3.cmml"><mo stretchy="false" id="S3.SS2.p1.4.m4.2.2.2.2.2" xref="S3.SS2.p1.4.m4.2.2.2.3.1.cmml">{</mo><msub id="S3.SS2.p1.4.m4.2.2.2.2.1" xref="S3.SS2.p1.4.m4.2.2.2.2.1.cmml"><mi id="S3.SS2.p1.4.m4.2.2.2.2.1.2" xref="S3.SS2.p1.4.m4.2.2.2.2.1.2.cmml">t</mi><mn id="S3.SS2.p1.4.m4.2.2.2.2.1.3" xref="S3.SS2.p1.4.m4.2.2.2.2.1.3.cmml">0</mn></msub><mo lspace="0.278em" rspace="0.278em" id="S3.SS2.p1.4.m4.2.2.2.2.3" xref="S3.SS2.p1.4.m4.2.2.2.3.1.cmml">:</mo><mi id="S3.SS2.p1.4.m4.1.1.1.1" xref="S3.SS2.p1.4.m4.1.1.1.1.cmml">τ</mi><mo stretchy="false" id="S3.SS2.p1.4.m4.2.2.2.2.4" xref="S3.SS2.p1.4.m4.2.2.2.3.1.cmml">}</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.2b"><apply id="S3.SS2.p1.4.m4.2.3.cmml" xref="S3.SS2.p1.4.m4.2.3"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.2.3.1.cmml" xref="S3.SS2.p1.4.m4.2.3">superscript</csymbol><ci id="S3.SS2.p1.4.m4.2.3.2.cmml" xref="S3.SS2.p1.4.m4.2.3.2">𝑥</ci><apply id="S3.SS2.p1.4.m4.2.2.2.3.cmml" xref="S3.SS2.p1.4.m4.2.2.2.2"><csymbol cd="latexml" id="S3.SS2.p1.4.m4.2.2.2.3.1.cmml" xref="S3.SS2.p1.4.m4.2.2.2.2.2">conditional-set</csymbol><apply id="S3.SS2.p1.4.m4.2.2.2.2.1.cmml" xref="S3.SS2.p1.4.m4.2.2.2.2.1"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.2.2.2.2.1.1.cmml" xref="S3.SS2.p1.4.m4.2.2.2.2.1">subscript</csymbol><ci id="S3.SS2.p1.4.m4.2.2.2.2.1.2.cmml" xref="S3.SS2.p1.4.m4.2.2.2.2.1.2">𝑡</ci><cn type="integer" id="S3.SS2.p1.4.m4.2.2.2.2.1.3.cmml" xref="S3.SS2.p1.4.m4.2.2.2.2.1.3">0</cn></apply><ci id="S3.SS2.p1.4.m4.1.1.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1.1.1">𝜏</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.2c">x^{\{t_{0}:\tau\}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.4.m4.2d">italic_x start_POSTSUPERSCRIPT { italic_t start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT : italic_τ } end_POSTSUPERSCRIPT</annotation></semantics></math> (see figure <a href="#S3.F2" title="Figure 2 ‣ III-B Timestamp-level Anomaly Detection ‣ III Methodology ‣ Generative Anomaly Detection for Time Series Datasets" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>). We explain the functioning of the LSTM below.
</p>
</div>
<figure id="S3.F2" class="ltx_figure"><img src="/html/2206.14597/assets/images/modelarch.png" id="S3.F2.g1" class="ltx_graphics ltx_centering ltx_img_square" width="598" height="644" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Anomaly detection, roadway segment-level anomaly diagnosis, and supervised anomaly classification.</figcaption>
</figure>
<section id="S3.SS2.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S3.SS2.SSS1.5.1.1" class="ltx_text">III-B</span>1 </span>LSTM Encoder-Decoder</h4>

<div id="S3.SS2.SSS1.p1" class="ltx_para">
<p id="S3.SS2.SSS1.p1.6" class="ltx_p">We use an LSTM-Encoder-Decoder structure that defines two separate components: an encoder and a decoder, each of which is composed of a stack of LSTM layers. During inference, the encoder first converts data <math id="S3.SS2.SSS1.p1.1.m1.2" class="ltx_Math" alttext="x^{\{1:t_{0}-1\}}" display="inline"><semantics id="S3.SS2.SSS1.p1.1.m1.2a"><msup id="S3.SS2.SSS1.p1.1.m1.2.3" xref="S3.SS2.SSS1.p1.1.m1.2.3.cmml"><mi id="S3.SS2.SSS1.p1.1.m1.2.3.2" xref="S3.SS2.SSS1.p1.1.m1.2.3.2.cmml">x</mi><mrow id="S3.SS2.SSS1.p1.1.m1.2.2.2.2" xref="S3.SS2.SSS1.p1.1.m1.2.2.2.3.cmml"><mo stretchy="false" id="S3.SS2.SSS1.p1.1.m1.2.2.2.2.2" xref="S3.SS2.SSS1.p1.1.m1.2.2.2.3.1.cmml">{</mo><mn id="S3.SS2.SSS1.p1.1.m1.1.1.1.1" xref="S3.SS2.SSS1.p1.1.m1.1.1.1.1.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S3.SS2.SSS1.p1.1.m1.2.2.2.2.3" xref="S3.SS2.SSS1.p1.1.m1.2.2.2.3.1.cmml">:</mo><mrow id="S3.SS2.SSS1.p1.1.m1.2.2.2.2.1" xref="S3.SS2.SSS1.p1.1.m1.2.2.2.2.1.cmml"><msub id="S3.SS2.SSS1.p1.1.m1.2.2.2.2.1.2" xref="S3.SS2.SSS1.p1.1.m1.2.2.2.2.1.2.cmml"><mi id="S3.SS2.SSS1.p1.1.m1.2.2.2.2.1.2.2" xref="S3.SS2.SSS1.p1.1.m1.2.2.2.2.1.2.2.cmml">t</mi><mn id="S3.SS2.SSS1.p1.1.m1.2.2.2.2.1.2.3" xref="S3.SS2.SSS1.p1.1.m1.2.2.2.2.1.2.3.cmml">0</mn></msub><mo id="S3.SS2.SSS1.p1.1.m1.2.2.2.2.1.1" xref="S3.SS2.SSS1.p1.1.m1.2.2.2.2.1.1.cmml">−</mo><mn id="S3.SS2.SSS1.p1.1.m1.2.2.2.2.1.3" xref="S3.SS2.SSS1.p1.1.m1.2.2.2.2.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.SS2.SSS1.p1.1.m1.2.2.2.2.4" xref="S3.SS2.SSS1.p1.1.m1.2.2.2.3.1.cmml">}</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.1.m1.2b"><apply id="S3.SS2.SSS1.p1.1.m1.2.3.cmml" xref="S3.SS2.SSS1.p1.1.m1.2.3"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.1.m1.2.3.1.cmml" xref="S3.SS2.SSS1.p1.1.m1.2.3">superscript</csymbol><ci id="S3.SS2.SSS1.p1.1.m1.2.3.2.cmml" xref="S3.SS2.SSS1.p1.1.m1.2.3.2">𝑥</ci><apply id="S3.SS2.SSS1.p1.1.m1.2.2.2.3.cmml" xref="S3.SS2.SSS1.p1.1.m1.2.2.2.2"><csymbol cd="latexml" id="S3.SS2.SSS1.p1.1.m1.2.2.2.3.1.cmml" xref="S3.SS2.SSS1.p1.1.m1.2.2.2.2.2">conditional-set</csymbol><cn type="integer" id="S3.SS2.SSS1.p1.1.m1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.1.1">1</cn><apply id="S3.SS2.SSS1.p1.1.m1.2.2.2.2.1.cmml" xref="S3.SS2.SSS1.p1.1.m1.2.2.2.2.1"><minus id="S3.SS2.SSS1.p1.1.m1.2.2.2.2.1.1.cmml" xref="S3.SS2.SSS1.p1.1.m1.2.2.2.2.1.1"></minus><apply id="S3.SS2.SSS1.p1.1.m1.2.2.2.2.1.2.cmml" xref="S3.SS2.SSS1.p1.1.m1.2.2.2.2.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.1.m1.2.2.2.2.1.2.1.cmml" xref="S3.SS2.SSS1.p1.1.m1.2.2.2.2.1.2">subscript</csymbol><ci id="S3.SS2.SSS1.p1.1.m1.2.2.2.2.1.2.2.cmml" xref="S3.SS2.SSS1.p1.1.m1.2.2.2.2.1.2.2">𝑡</ci><cn type="integer" id="S3.SS2.SSS1.p1.1.m1.2.2.2.2.1.2.3.cmml" xref="S3.SS2.SSS1.p1.1.m1.2.2.2.2.1.2.3">0</cn></apply><cn type="integer" id="S3.SS2.SSS1.p1.1.m1.2.2.2.2.1.3.cmml" xref="S3.SS2.SSS1.p1.1.m1.2.2.2.2.1.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.1.m1.2c">x^{\{1:t_{0}-1\}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.1.m1.2d">italic_x start_POSTSUPERSCRIPT { 1 : italic_t start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT - 1 } end_POSTSUPERSCRIPT</annotation></semantics></math> into a single fixed-length representation vector, <math id="S3.SS2.SSS1.p1.2.m2.2" class="ltx_Math" alttext="f_{\theta_{enc}}:x^{\{1:t_{0}-1\}}\rightarrow e" display="inline"><semantics id="S3.SS2.SSS1.p1.2.m2.2a"><mrow id="S3.SS2.SSS1.p1.2.m2.2.3" xref="S3.SS2.SSS1.p1.2.m2.2.3.cmml"><msub id="S3.SS2.SSS1.p1.2.m2.2.3.2" xref="S3.SS2.SSS1.p1.2.m2.2.3.2.cmml"><mi id="S3.SS2.SSS1.p1.2.m2.2.3.2.2" xref="S3.SS2.SSS1.p1.2.m2.2.3.2.2.cmml">f</mi><msub id="S3.SS2.SSS1.p1.2.m2.2.3.2.3" xref="S3.SS2.SSS1.p1.2.m2.2.3.2.3.cmml"><mi id="S3.SS2.SSS1.p1.2.m2.2.3.2.3.2" xref="S3.SS2.SSS1.p1.2.m2.2.3.2.3.2.cmml">θ</mi><mrow id="S3.SS2.SSS1.p1.2.m2.2.3.2.3.3" xref="S3.SS2.SSS1.p1.2.m2.2.3.2.3.3.cmml"><mi id="S3.SS2.SSS1.p1.2.m2.2.3.2.3.3.2" xref="S3.SS2.SSS1.p1.2.m2.2.3.2.3.3.2.cmml">e</mi><mo id="S3.SS2.SSS1.p1.2.m2.2.3.2.3.3.1" xref="S3.SS2.SSS1.p1.2.m2.2.3.2.3.3.1.cmml">⁢</mo><mi id="S3.SS2.SSS1.p1.2.m2.2.3.2.3.3.3" xref="S3.SS2.SSS1.p1.2.m2.2.3.2.3.3.3.cmml">n</mi><mo id="S3.SS2.SSS1.p1.2.m2.2.3.2.3.3.1a" xref="S3.SS2.SSS1.p1.2.m2.2.3.2.3.3.1.cmml">⁢</mo><mi id="S3.SS2.SSS1.p1.2.m2.2.3.2.3.3.4" xref="S3.SS2.SSS1.p1.2.m2.2.3.2.3.3.4.cmml">c</mi></mrow></msub></msub><mo lspace="0.278em" rspace="0.278em" id="S3.SS2.SSS1.p1.2.m2.2.3.1" xref="S3.SS2.SSS1.p1.2.m2.2.3.1.cmml">:</mo><mrow id="S3.SS2.SSS1.p1.2.m2.2.3.3" xref="S3.SS2.SSS1.p1.2.m2.2.3.3.cmml"><msup id="S3.SS2.SSS1.p1.2.m2.2.3.3.2" xref="S3.SS2.SSS1.p1.2.m2.2.3.3.2.cmml"><mi id="S3.SS2.SSS1.p1.2.m2.2.3.3.2.2" xref="S3.SS2.SSS1.p1.2.m2.2.3.3.2.2.cmml">x</mi><mrow id="S3.SS2.SSS1.p1.2.m2.2.2.2.2" xref="S3.SS2.SSS1.p1.2.m2.2.2.2.3.cmml"><mo stretchy="false" id="S3.SS2.SSS1.p1.2.m2.2.2.2.2.2" xref="S3.SS2.SSS1.p1.2.m2.2.2.2.3.1.cmml">{</mo><mn id="S3.SS2.SSS1.p1.2.m2.1.1.1.1" xref="S3.SS2.SSS1.p1.2.m2.1.1.1.1.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S3.SS2.SSS1.p1.2.m2.2.2.2.2.3" xref="S3.SS2.SSS1.p1.2.m2.2.2.2.3.1.cmml">:</mo><mrow id="S3.SS2.SSS1.p1.2.m2.2.2.2.2.1" xref="S3.SS2.SSS1.p1.2.m2.2.2.2.2.1.cmml"><msub id="S3.SS2.SSS1.p1.2.m2.2.2.2.2.1.2" xref="S3.SS2.SSS1.p1.2.m2.2.2.2.2.1.2.cmml"><mi id="S3.SS2.SSS1.p1.2.m2.2.2.2.2.1.2.2" xref="S3.SS2.SSS1.p1.2.m2.2.2.2.2.1.2.2.cmml">t</mi><mn id="S3.SS2.SSS1.p1.2.m2.2.2.2.2.1.2.3" xref="S3.SS2.SSS1.p1.2.m2.2.2.2.2.1.2.3.cmml">0</mn></msub><mo id="S3.SS2.SSS1.p1.2.m2.2.2.2.2.1.1" xref="S3.SS2.SSS1.p1.2.m2.2.2.2.2.1.1.cmml">−</mo><mn id="S3.SS2.SSS1.p1.2.m2.2.2.2.2.1.3" xref="S3.SS2.SSS1.p1.2.m2.2.2.2.2.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.SS2.SSS1.p1.2.m2.2.2.2.2.4" xref="S3.SS2.SSS1.p1.2.m2.2.2.2.3.1.cmml">}</mo></mrow></msup><mo stretchy="false" id="S3.SS2.SSS1.p1.2.m2.2.3.3.1" xref="S3.SS2.SSS1.p1.2.m2.2.3.3.1.cmml">→</mo><mi id="S3.SS2.SSS1.p1.2.m2.2.3.3.3" xref="S3.SS2.SSS1.p1.2.m2.2.3.3.3.cmml">e</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.2.m2.2b"><apply id="S3.SS2.SSS1.p1.2.m2.2.3.cmml" xref="S3.SS2.SSS1.p1.2.m2.2.3"><ci id="S3.SS2.SSS1.p1.2.m2.2.3.1.cmml" xref="S3.SS2.SSS1.p1.2.m2.2.3.1">:</ci><apply id="S3.SS2.SSS1.p1.2.m2.2.3.2.cmml" xref="S3.SS2.SSS1.p1.2.m2.2.3.2"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.2.m2.2.3.2.1.cmml" xref="S3.SS2.SSS1.p1.2.m2.2.3.2">subscript</csymbol><ci id="S3.SS2.SSS1.p1.2.m2.2.3.2.2.cmml" xref="S3.SS2.SSS1.p1.2.m2.2.3.2.2">𝑓</ci><apply id="S3.SS2.SSS1.p1.2.m2.2.3.2.3.cmml" xref="S3.SS2.SSS1.p1.2.m2.2.3.2.3"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.2.m2.2.3.2.3.1.cmml" xref="S3.SS2.SSS1.p1.2.m2.2.3.2.3">subscript</csymbol><ci id="S3.SS2.SSS1.p1.2.m2.2.3.2.3.2.cmml" xref="S3.SS2.SSS1.p1.2.m2.2.3.2.3.2">𝜃</ci><apply id="S3.SS2.SSS1.p1.2.m2.2.3.2.3.3.cmml" xref="S3.SS2.SSS1.p1.2.m2.2.3.2.3.3"><times id="S3.SS2.SSS1.p1.2.m2.2.3.2.3.3.1.cmml" xref="S3.SS2.SSS1.p1.2.m2.2.3.2.3.3.1"></times><ci id="S3.SS2.SSS1.p1.2.m2.2.3.2.3.3.2.cmml" xref="S3.SS2.SSS1.p1.2.m2.2.3.2.3.3.2">𝑒</ci><ci id="S3.SS2.SSS1.p1.2.m2.2.3.2.3.3.3.cmml" xref="S3.SS2.SSS1.p1.2.m2.2.3.2.3.3.3">𝑛</ci><ci id="S3.SS2.SSS1.p1.2.m2.2.3.2.3.3.4.cmml" xref="S3.SS2.SSS1.p1.2.m2.2.3.2.3.3.4">𝑐</ci></apply></apply></apply><apply id="S3.SS2.SSS1.p1.2.m2.2.3.3.cmml" xref="S3.SS2.SSS1.p1.2.m2.2.3.3"><ci id="S3.SS2.SSS1.p1.2.m2.2.3.3.1.cmml" xref="S3.SS2.SSS1.p1.2.m2.2.3.3.1">→</ci><apply id="S3.SS2.SSS1.p1.2.m2.2.3.3.2.cmml" xref="S3.SS2.SSS1.p1.2.m2.2.3.3.2"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.2.m2.2.3.3.2.1.cmml" xref="S3.SS2.SSS1.p1.2.m2.2.3.3.2">superscript</csymbol><ci id="S3.SS2.SSS1.p1.2.m2.2.3.3.2.2.cmml" xref="S3.SS2.SSS1.p1.2.m2.2.3.3.2.2">𝑥</ci><apply id="S3.SS2.SSS1.p1.2.m2.2.2.2.3.cmml" xref="S3.SS2.SSS1.p1.2.m2.2.2.2.2"><csymbol cd="latexml" id="S3.SS2.SSS1.p1.2.m2.2.2.2.3.1.cmml" xref="S3.SS2.SSS1.p1.2.m2.2.2.2.2.2">conditional-set</csymbol><cn type="integer" id="S3.SS2.SSS1.p1.2.m2.1.1.1.1.cmml" xref="S3.SS2.SSS1.p1.2.m2.1.1.1.1">1</cn><apply id="S3.SS2.SSS1.p1.2.m2.2.2.2.2.1.cmml" xref="S3.SS2.SSS1.p1.2.m2.2.2.2.2.1"><minus id="S3.SS2.SSS1.p1.2.m2.2.2.2.2.1.1.cmml" xref="S3.SS2.SSS1.p1.2.m2.2.2.2.2.1.1"></minus><apply id="S3.SS2.SSS1.p1.2.m2.2.2.2.2.1.2.cmml" xref="S3.SS2.SSS1.p1.2.m2.2.2.2.2.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.2.m2.2.2.2.2.1.2.1.cmml" xref="S3.SS2.SSS1.p1.2.m2.2.2.2.2.1.2">subscript</csymbol><ci id="S3.SS2.SSS1.p1.2.m2.2.2.2.2.1.2.2.cmml" xref="S3.SS2.SSS1.p1.2.m2.2.2.2.2.1.2.2">𝑡</ci><cn type="integer" id="S3.SS2.SSS1.p1.2.m2.2.2.2.2.1.2.3.cmml" xref="S3.SS2.SSS1.p1.2.m2.2.2.2.2.1.2.3">0</cn></apply><cn type="integer" id="S3.SS2.SSS1.p1.2.m2.2.2.2.2.1.3.cmml" xref="S3.SS2.SSS1.p1.2.m2.2.2.2.2.1.3">1</cn></apply></apply></apply><ci id="S3.SS2.SSS1.p1.2.m2.2.3.3.3.cmml" xref="S3.SS2.SSS1.p1.2.m2.2.3.3.3">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.2.m2.2c">f_{\theta_{enc}}:x^{\{1:t_{0}-1\}}\rightarrow e</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.2.m2.2d">italic_f start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT italic_e italic_n italic_c end_POSTSUBSCRIPT end_POSTSUBSCRIPT : italic_x start_POSTSUPERSCRIPT { 1 : italic_t start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT - 1 } end_POSTSUPERSCRIPT → italic_e</annotation></semantics></math>, given by the last hidden states of LSTM, that contains all the information needed for the input of a subsequent decoder. The encoder vector <math id="S3.SS2.SSS1.p1.3.m3.1" class="ltx_Math" alttext="e" display="inline"><semantics id="S3.SS2.SSS1.p1.3.m3.1a"><mi id="S3.SS2.SSS1.p1.3.m3.1.1" xref="S3.SS2.SSS1.p1.3.m3.1.1.cmml">e</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.3.m3.1b"><ci id="S3.SS2.SSS1.p1.3.m3.1.1.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.1">𝑒</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.3.m3.1c">e</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.3.m3.1d">italic_e</annotation></semantics></math> is then repeated <math id="S3.SS2.SSS1.p1.4.m4.1" class="ltx_Math" alttext="\tau-t_{0}+1" display="inline"><semantics id="S3.SS2.SSS1.p1.4.m4.1a"><mrow id="S3.SS2.SSS1.p1.4.m4.1.1" xref="S3.SS2.SSS1.p1.4.m4.1.1.cmml"><mrow id="S3.SS2.SSS1.p1.4.m4.1.1.2" xref="S3.SS2.SSS1.p1.4.m4.1.1.2.cmml"><mi id="S3.SS2.SSS1.p1.4.m4.1.1.2.2" xref="S3.SS2.SSS1.p1.4.m4.1.1.2.2.cmml">τ</mi><mo id="S3.SS2.SSS1.p1.4.m4.1.1.2.1" xref="S3.SS2.SSS1.p1.4.m4.1.1.2.1.cmml">−</mo><msub id="S3.SS2.SSS1.p1.4.m4.1.1.2.3" xref="S3.SS2.SSS1.p1.4.m4.1.1.2.3.cmml"><mi id="S3.SS2.SSS1.p1.4.m4.1.1.2.3.2" xref="S3.SS2.SSS1.p1.4.m4.1.1.2.3.2.cmml">t</mi><mn id="S3.SS2.SSS1.p1.4.m4.1.1.2.3.3" xref="S3.SS2.SSS1.p1.4.m4.1.1.2.3.3.cmml">0</mn></msub></mrow><mo id="S3.SS2.SSS1.p1.4.m4.1.1.1" xref="S3.SS2.SSS1.p1.4.m4.1.1.1.cmml">+</mo><mn id="S3.SS2.SSS1.p1.4.m4.1.1.3" xref="S3.SS2.SSS1.p1.4.m4.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.4.m4.1b"><apply id="S3.SS2.SSS1.p1.4.m4.1.1.cmml" xref="S3.SS2.SSS1.p1.4.m4.1.1"><plus id="S3.SS2.SSS1.p1.4.m4.1.1.1.cmml" xref="S3.SS2.SSS1.p1.4.m4.1.1.1"></plus><apply id="S3.SS2.SSS1.p1.4.m4.1.1.2.cmml" xref="S3.SS2.SSS1.p1.4.m4.1.1.2"><minus id="S3.SS2.SSS1.p1.4.m4.1.1.2.1.cmml" xref="S3.SS2.SSS1.p1.4.m4.1.1.2.1"></minus><ci id="S3.SS2.SSS1.p1.4.m4.1.1.2.2.cmml" xref="S3.SS2.SSS1.p1.4.m4.1.1.2.2">𝜏</ci><apply id="S3.SS2.SSS1.p1.4.m4.1.1.2.3.cmml" xref="S3.SS2.SSS1.p1.4.m4.1.1.2.3"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.4.m4.1.1.2.3.1.cmml" xref="S3.SS2.SSS1.p1.4.m4.1.1.2.3">subscript</csymbol><ci id="S3.SS2.SSS1.p1.4.m4.1.1.2.3.2.cmml" xref="S3.SS2.SSS1.p1.4.m4.1.1.2.3.2">𝑡</ci><cn type="integer" id="S3.SS2.SSS1.p1.4.m4.1.1.2.3.3.cmml" xref="S3.SS2.SSS1.p1.4.m4.1.1.2.3.3">0</cn></apply></apply><cn type="integer" id="S3.SS2.SSS1.p1.4.m4.1.1.3.cmml" xref="S3.SS2.SSS1.p1.4.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.4.m4.1c">\tau-t_{0}+1</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.4.m4.1d">italic_τ - italic_t start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT + 1</annotation></semantics></math> times and used to initialize the internal states of decoder LSTM cells. The decoder then generates the ultimate hidden states of the target sequence <math id="S3.SS2.SSS1.p1.5.m5.1" class="ltx_Math" alttext="x^{t_{0}:\tau}" display="inline"><semantics id="S3.SS2.SSS1.p1.5.m5.1a"><msup id="S3.SS2.SSS1.p1.5.m5.1.1" xref="S3.SS2.SSS1.p1.5.m5.1.1.cmml"><mi id="S3.SS2.SSS1.p1.5.m5.1.1.2" xref="S3.SS2.SSS1.p1.5.m5.1.1.2.cmml">x</mi><mrow id="S3.SS2.SSS1.p1.5.m5.1.1.3" xref="S3.SS2.SSS1.p1.5.m5.1.1.3.cmml"><msub id="S3.SS2.SSS1.p1.5.m5.1.1.3.2" xref="S3.SS2.SSS1.p1.5.m5.1.1.3.2.cmml"><mi id="S3.SS2.SSS1.p1.5.m5.1.1.3.2.2" xref="S3.SS2.SSS1.p1.5.m5.1.1.3.2.2.cmml">t</mi><mn id="S3.SS2.SSS1.p1.5.m5.1.1.3.2.3" xref="S3.SS2.SSS1.p1.5.m5.1.1.3.2.3.cmml">0</mn></msub><mo lspace="0.278em" rspace="0.278em" id="S3.SS2.SSS1.p1.5.m5.1.1.3.1" xref="S3.SS2.SSS1.p1.5.m5.1.1.3.1.cmml">:</mo><mi id="S3.SS2.SSS1.p1.5.m5.1.1.3.3" xref="S3.SS2.SSS1.p1.5.m5.1.1.3.3.cmml">τ</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.5.m5.1b"><apply id="S3.SS2.SSS1.p1.5.m5.1.1.cmml" xref="S3.SS2.SSS1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.5.m5.1.1.1.cmml" xref="S3.SS2.SSS1.p1.5.m5.1.1">superscript</csymbol><ci id="S3.SS2.SSS1.p1.5.m5.1.1.2.cmml" xref="S3.SS2.SSS1.p1.5.m5.1.1.2">𝑥</ci><apply id="S3.SS2.SSS1.p1.5.m5.1.1.3.cmml" xref="S3.SS2.SSS1.p1.5.m5.1.1.3"><ci id="S3.SS2.SSS1.p1.5.m5.1.1.3.1.cmml" xref="S3.SS2.SSS1.p1.5.m5.1.1.3.1">:</ci><apply id="S3.SS2.SSS1.p1.5.m5.1.1.3.2.cmml" xref="S3.SS2.SSS1.p1.5.m5.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.5.m5.1.1.3.2.1.cmml" xref="S3.SS2.SSS1.p1.5.m5.1.1.3.2">subscript</csymbol><ci id="S3.SS2.SSS1.p1.5.m5.1.1.3.2.2.cmml" xref="S3.SS2.SSS1.p1.5.m5.1.1.3.2.2">𝑡</ci><cn type="integer" id="S3.SS2.SSS1.p1.5.m5.1.1.3.2.3.cmml" xref="S3.SS2.SSS1.p1.5.m5.1.1.3.2.3">0</cn></apply><ci id="S3.SS2.SSS1.p1.5.m5.1.1.3.3.cmml" xref="S3.SS2.SSS1.p1.5.m5.1.1.3.3">𝜏</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.5.m5.1c">x^{t_{0}:\tau}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.5.m5.1d">italic_x start_POSTSUPERSCRIPT italic_t start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT : italic_τ end_POSTSUPERSCRIPT</annotation></semantics></math> in an autoregressive manner, i.e., <math id="S3.SS2.SSS1.p1.6.m6.1" class="ltx_Math" alttext="f_{\theta_{dec}}:e\rightarrow h^{t_{0}:\tau}" display="inline"><semantics id="S3.SS2.SSS1.p1.6.m6.1a"><mrow id="S3.SS2.SSS1.p1.6.m6.1.1" xref="S3.SS2.SSS1.p1.6.m6.1.1.cmml"><msub id="S3.SS2.SSS1.p1.6.m6.1.1.2" xref="S3.SS2.SSS1.p1.6.m6.1.1.2.cmml"><mi id="S3.SS2.SSS1.p1.6.m6.1.1.2.2" xref="S3.SS2.SSS1.p1.6.m6.1.1.2.2.cmml">f</mi><msub id="S3.SS2.SSS1.p1.6.m6.1.1.2.3" xref="S3.SS2.SSS1.p1.6.m6.1.1.2.3.cmml"><mi id="S3.SS2.SSS1.p1.6.m6.1.1.2.3.2" xref="S3.SS2.SSS1.p1.6.m6.1.1.2.3.2.cmml">θ</mi><mrow id="S3.SS2.SSS1.p1.6.m6.1.1.2.3.3" xref="S3.SS2.SSS1.p1.6.m6.1.1.2.3.3.cmml"><mi id="S3.SS2.SSS1.p1.6.m6.1.1.2.3.3.2" xref="S3.SS2.SSS1.p1.6.m6.1.1.2.3.3.2.cmml">d</mi><mo id="S3.SS2.SSS1.p1.6.m6.1.1.2.3.3.1" xref="S3.SS2.SSS1.p1.6.m6.1.1.2.3.3.1.cmml">⁢</mo><mi id="S3.SS2.SSS1.p1.6.m6.1.1.2.3.3.3" xref="S3.SS2.SSS1.p1.6.m6.1.1.2.3.3.3.cmml">e</mi><mo id="S3.SS2.SSS1.p1.6.m6.1.1.2.3.3.1a" xref="S3.SS2.SSS1.p1.6.m6.1.1.2.3.3.1.cmml">⁢</mo><mi id="S3.SS2.SSS1.p1.6.m6.1.1.2.3.3.4" xref="S3.SS2.SSS1.p1.6.m6.1.1.2.3.3.4.cmml">c</mi></mrow></msub></msub><mo lspace="0.278em" rspace="0.278em" id="S3.SS2.SSS1.p1.6.m6.1.1.1" xref="S3.SS2.SSS1.p1.6.m6.1.1.1.cmml">:</mo><mrow id="S3.SS2.SSS1.p1.6.m6.1.1.3" xref="S3.SS2.SSS1.p1.6.m6.1.1.3.cmml"><mi id="S3.SS2.SSS1.p1.6.m6.1.1.3.2" xref="S3.SS2.SSS1.p1.6.m6.1.1.3.2.cmml">e</mi><mo stretchy="false" id="S3.SS2.SSS1.p1.6.m6.1.1.3.1" xref="S3.SS2.SSS1.p1.6.m6.1.1.3.1.cmml">→</mo><msup id="S3.SS2.SSS1.p1.6.m6.1.1.3.3" xref="S3.SS2.SSS1.p1.6.m6.1.1.3.3.cmml"><mi id="S3.SS2.SSS1.p1.6.m6.1.1.3.3.2" xref="S3.SS2.SSS1.p1.6.m6.1.1.3.3.2.cmml">h</mi><mrow id="S3.SS2.SSS1.p1.6.m6.1.1.3.3.3" xref="S3.SS2.SSS1.p1.6.m6.1.1.3.3.3.cmml"><msub id="S3.SS2.SSS1.p1.6.m6.1.1.3.3.3.2" xref="S3.SS2.SSS1.p1.6.m6.1.1.3.3.3.2.cmml"><mi id="S3.SS2.SSS1.p1.6.m6.1.1.3.3.3.2.2" xref="S3.SS2.SSS1.p1.6.m6.1.1.3.3.3.2.2.cmml">t</mi><mn id="S3.SS2.SSS1.p1.6.m6.1.1.3.3.3.2.3" xref="S3.SS2.SSS1.p1.6.m6.1.1.3.3.3.2.3.cmml">0</mn></msub><mo lspace="0.278em" rspace="0.278em" id="S3.SS2.SSS1.p1.6.m6.1.1.3.3.3.1" xref="S3.SS2.SSS1.p1.6.m6.1.1.3.3.3.1.cmml">:</mo><mi id="S3.SS2.SSS1.p1.6.m6.1.1.3.3.3.3" xref="S3.SS2.SSS1.p1.6.m6.1.1.3.3.3.3.cmml">τ</mi></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.6.m6.1b"><apply id="S3.SS2.SSS1.p1.6.m6.1.1.cmml" xref="S3.SS2.SSS1.p1.6.m6.1.1"><ci id="S3.SS2.SSS1.p1.6.m6.1.1.1.cmml" xref="S3.SS2.SSS1.p1.6.m6.1.1.1">:</ci><apply id="S3.SS2.SSS1.p1.6.m6.1.1.2.cmml" xref="S3.SS2.SSS1.p1.6.m6.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.6.m6.1.1.2.1.cmml" xref="S3.SS2.SSS1.p1.6.m6.1.1.2">subscript</csymbol><ci id="S3.SS2.SSS1.p1.6.m6.1.1.2.2.cmml" xref="S3.SS2.SSS1.p1.6.m6.1.1.2.2">𝑓</ci><apply id="S3.SS2.SSS1.p1.6.m6.1.1.2.3.cmml" xref="S3.SS2.SSS1.p1.6.m6.1.1.2.3"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.6.m6.1.1.2.3.1.cmml" xref="S3.SS2.SSS1.p1.6.m6.1.1.2.3">subscript</csymbol><ci id="S3.SS2.SSS1.p1.6.m6.1.1.2.3.2.cmml" xref="S3.SS2.SSS1.p1.6.m6.1.1.2.3.2">𝜃</ci><apply id="S3.SS2.SSS1.p1.6.m6.1.1.2.3.3.cmml" xref="S3.SS2.SSS1.p1.6.m6.1.1.2.3.3"><times id="S3.SS2.SSS1.p1.6.m6.1.1.2.3.3.1.cmml" xref="S3.SS2.SSS1.p1.6.m6.1.1.2.3.3.1"></times><ci id="S3.SS2.SSS1.p1.6.m6.1.1.2.3.3.2.cmml" xref="S3.SS2.SSS1.p1.6.m6.1.1.2.3.3.2">𝑑</ci><ci id="S3.SS2.SSS1.p1.6.m6.1.1.2.3.3.3.cmml" xref="S3.SS2.SSS1.p1.6.m6.1.1.2.3.3.3">𝑒</ci><ci id="S3.SS2.SSS1.p1.6.m6.1.1.2.3.3.4.cmml" xref="S3.SS2.SSS1.p1.6.m6.1.1.2.3.3.4">𝑐</ci></apply></apply></apply><apply id="S3.SS2.SSS1.p1.6.m6.1.1.3.cmml" xref="S3.SS2.SSS1.p1.6.m6.1.1.3"><ci id="S3.SS2.SSS1.p1.6.m6.1.1.3.1.cmml" xref="S3.SS2.SSS1.p1.6.m6.1.1.3.1">→</ci><ci id="S3.SS2.SSS1.p1.6.m6.1.1.3.2.cmml" xref="S3.SS2.SSS1.p1.6.m6.1.1.3.2">𝑒</ci><apply id="S3.SS2.SSS1.p1.6.m6.1.1.3.3.cmml" xref="S3.SS2.SSS1.p1.6.m6.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.6.m6.1.1.3.3.1.cmml" xref="S3.SS2.SSS1.p1.6.m6.1.1.3.3">superscript</csymbol><ci id="S3.SS2.SSS1.p1.6.m6.1.1.3.3.2.cmml" xref="S3.SS2.SSS1.p1.6.m6.1.1.3.3.2">ℎ</ci><apply id="S3.SS2.SSS1.p1.6.m6.1.1.3.3.3.cmml" xref="S3.SS2.SSS1.p1.6.m6.1.1.3.3.3"><ci id="S3.SS2.SSS1.p1.6.m6.1.1.3.3.3.1.cmml" xref="S3.SS2.SSS1.p1.6.m6.1.1.3.3.3.1">:</ci><apply id="S3.SS2.SSS1.p1.6.m6.1.1.3.3.3.2.cmml" xref="S3.SS2.SSS1.p1.6.m6.1.1.3.3.3.2"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.6.m6.1.1.3.3.3.2.1.cmml" xref="S3.SS2.SSS1.p1.6.m6.1.1.3.3.3.2">subscript</csymbol><ci id="S3.SS2.SSS1.p1.6.m6.1.1.3.3.3.2.2.cmml" xref="S3.SS2.SSS1.p1.6.m6.1.1.3.3.3.2.2">𝑡</ci><cn type="integer" id="S3.SS2.SSS1.p1.6.m6.1.1.3.3.3.2.3.cmml" xref="S3.SS2.SSS1.p1.6.m6.1.1.3.3.3.2.3">0</cn></apply><ci id="S3.SS2.SSS1.p1.6.m6.1.1.3.3.3.3.cmml" xref="S3.SS2.SSS1.p1.6.m6.1.1.3.3.3.3">𝜏</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.6.m6.1c">f_{\theta_{dec}}:e\rightarrow h^{t_{0}:\tau}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.6.m6.1d">italic_f start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT italic_d italic_e italic_c end_POSTSUBSCRIPT end_POSTSUBSCRIPT : italic_e → italic_h start_POSTSUPERSCRIPT italic_t start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT : italic_τ end_POSTSUPERSCRIPT</annotation></semantics></math>.</p>
</div>
<div id="S3.SS2.SSS1.p2" class="ltx_para">
<p id="S3.SS2.SSS1.p2.1" class="ltx_p">With respect to anomaly detection, the autoregressive scheme enables RNN to propagate and leverage historical information. Also, the encoder-decoder structure prevents out-of-distribution data from being constructed from compressed historical information, which in turn ensures that the density is learned without too many outliers. Deterministic encoder-decoder models use mean squared error as anomaly score to measure the deviation between observations and predictions. However, this score may result in sub-optimal anomaly detection decisions due to two reasons. First, noise in data and randomness from the model’s parameters may interfere with the training procedures. Second, the decisions are concluded from a fixed-length of historical data, therefore lacking a global perspective. We bypass this issue by integrating the encoder-decoder structure with the normalizing flow (described below) and training the overall architecture by maximizing the log likelihood function (which is inherently probabilistic).</p>
</div>
<div id="S3.SS2.SSS1.p3" class="ltx_para">
<p id="S3.SS2.SSS1.p3.10" class="ltx_p">Consider an observation <math id="S3.SS2.SSS1.p3.1.m1.1" class="ltx_Math" alttext="x^{t}" display="inline"><semantics id="S3.SS2.SSS1.p3.1.m1.1a"><msup id="S3.SS2.SSS1.p3.1.m1.1.1" xref="S3.SS2.SSS1.p3.1.m1.1.1.cmml"><mi id="S3.SS2.SSS1.p3.1.m1.1.1.2" xref="S3.SS2.SSS1.p3.1.m1.1.1.2.cmml">x</mi><mi id="S3.SS2.SSS1.p3.1.m1.1.1.3" xref="S3.SS2.SSS1.p3.1.m1.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p3.1.m1.1b"><apply id="S3.SS2.SSS1.p3.1.m1.1.1.cmml" xref="S3.SS2.SSS1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p3.1.m1.1.1.1.cmml" xref="S3.SS2.SSS1.p3.1.m1.1.1">superscript</csymbol><ci id="S3.SS2.SSS1.p3.1.m1.1.1.2.cmml" xref="S3.SS2.SSS1.p3.1.m1.1.1.2">𝑥</ci><ci id="S3.SS2.SSS1.p3.1.m1.1.1.3.cmml" xref="S3.SS2.SSS1.p3.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p3.1.m1.1c">x^{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p3.1.m1.1d">italic_x start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math> where <math id="S3.SS2.SSS1.p3.2.m2.2" class="ltx_Math" alttext="t\in\{t_{0}:\tau\}" display="inline"><semantics id="S3.SS2.SSS1.p3.2.m2.2a"><mrow id="S3.SS2.SSS1.p3.2.m2.2.2" xref="S3.SS2.SSS1.p3.2.m2.2.2.cmml"><mi id="S3.SS2.SSS1.p3.2.m2.2.2.3" xref="S3.SS2.SSS1.p3.2.m2.2.2.3.cmml">t</mi><mo id="S3.SS2.SSS1.p3.2.m2.2.2.2" xref="S3.SS2.SSS1.p3.2.m2.2.2.2.cmml">∈</mo><mrow id="S3.SS2.SSS1.p3.2.m2.2.2.1.1" xref="S3.SS2.SSS1.p3.2.m2.2.2.1.2.cmml"><mo stretchy="false" id="S3.SS2.SSS1.p3.2.m2.2.2.1.1.2" xref="S3.SS2.SSS1.p3.2.m2.2.2.1.2.1.cmml">{</mo><msub id="S3.SS2.SSS1.p3.2.m2.2.2.1.1.1" xref="S3.SS2.SSS1.p3.2.m2.2.2.1.1.1.cmml"><mi id="S3.SS2.SSS1.p3.2.m2.2.2.1.1.1.2" xref="S3.SS2.SSS1.p3.2.m2.2.2.1.1.1.2.cmml">t</mi><mn id="S3.SS2.SSS1.p3.2.m2.2.2.1.1.1.3" xref="S3.SS2.SSS1.p3.2.m2.2.2.1.1.1.3.cmml">0</mn></msub><mo lspace="0.278em" rspace="0.278em" id="S3.SS2.SSS1.p3.2.m2.2.2.1.1.3" xref="S3.SS2.SSS1.p3.2.m2.2.2.1.2.1.cmml">:</mo><mi id="S3.SS2.SSS1.p3.2.m2.1.1" xref="S3.SS2.SSS1.p3.2.m2.1.1.cmml">τ</mi><mo stretchy="false" id="S3.SS2.SSS1.p3.2.m2.2.2.1.1.4" xref="S3.SS2.SSS1.p3.2.m2.2.2.1.2.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p3.2.m2.2b"><apply id="S3.SS2.SSS1.p3.2.m2.2.2.cmml" xref="S3.SS2.SSS1.p3.2.m2.2.2"><in id="S3.SS2.SSS1.p3.2.m2.2.2.2.cmml" xref="S3.SS2.SSS1.p3.2.m2.2.2.2"></in><ci id="S3.SS2.SSS1.p3.2.m2.2.2.3.cmml" xref="S3.SS2.SSS1.p3.2.m2.2.2.3">𝑡</ci><apply id="S3.SS2.SSS1.p3.2.m2.2.2.1.2.cmml" xref="S3.SS2.SSS1.p3.2.m2.2.2.1.1"><csymbol cd="latexml" id="S3.SS2.SSS1.p3.2.m2.2.2.1.2.1.cmml" xref="S3.SS2.SSS1.p3.2.m2.2.2.1.1.2">conditional-set</csymbol><apply id="S3.SS2.SSS1.p3.2.m2.2.2.1.1.1.cmml" xref="S3.SS2.SSS1.p3.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p3.2.m2.2.2.1.1.1.1.cmml" xref="S3.SS2.SSS1.p3.2.m2.2.2.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p3.2.m2.2.2.1.1.1.2.cmml" xref="S3.SS2.SSS1.p3.2.m2.2.2.1.1.1.2">𝑡</ci><cn type="integer" id="S3.SS2.SSS1.p3.2.m2.2.2.1.1.1.3.cmml" xref="S3.SS2.SSS1.p3.2.m2.2.2.1.1.1.3">0</cn></apply><ci id="S3.SS2.SSS1.p3.2.m2.1.1.cmml" xref="S3.SS2.SSS1.p3.2.m2.1.1">𝜏</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p3.2.m2.2c">t\in\{t_{0}:\tau\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p3.2.m2.2d">italic_t ∈ { italic_t start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT : italic_τ }</annotation></semantics></math>. Let the output of the last layer of the decoder for <math id="S3.SS2.SSS1.p3.3.m3.1" class="ltx_Math" alttext="x^{t}" display="inline"><semantics id="S3.SS2.SSS1.p3.3.m3.1a"><msup id="S3.SS2.SSS1.p3.3.m3.1.1" xref="S3.SS2.SSS1.p3.3.m3.1.1.cmml"><mi id="S3.SS2.SSS1.p3.3.m3.1.1.2" xref="S3.SS2.SSS1.p3.3.m3.1.1.2.cmml">x</mi><mi id="S3.SS2.SSS1.p3.3.m3.1.1.3" xref="S3.SS2.SSS1.p3.3.m3.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p3.3.m3.1b"><apply id="S3.SS2.SSS1.p3.3.m3.1.1.cmml" xref="S3.SS2.SSS1.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p3.3.m3.1.1.1.cmml" xref="S3.SS2.SSS1.p3.3.m3.1.1">superscript</csymbol><ci id="S3.SS2.SSS1.p3.3.m3.1.1.2.cmml" xref="S3.SS2.SSS1.p3.3.m3.1.1.2">𝑥</ci><ci id="S3.SS2.SSS1.p3.3.m3.1.1.3.cmml" xref="S3.SS2.SSS1.p3.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p3.3.m3.1c">x^{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p3.3.m3.1d">italic_x start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math> be denoted by <math id="S3.SS2.SSS1.p3.4.m4.1" class="ltx_Math" alttext="h^{t}" display="inline"><semantics id="S3.SS2.SSS1.p3.4.m4.1a"><msup id="S3.SS2.SSS1.p3.4.m4.1.1" xref="S3.SS2.SSS1.p3.4.m4.1.1.cmml"><mi id="S3.SS2.SSS1.p3.4.m4.1.1.2" xref="S3.SS2.SSS1.p3.4.m4.1.1.2.cmml">h</mi><mi id="S3.SS2.SSS1.p3.4.m4.1.1.3" xref="S3.SS2.SSS1.p3.4.m4.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p3.4.m4.1b"><apply id="S3.SS2.SSS1.p3.4.m4.1.1.cmml" xref="S3.SS2.SSS1.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p3.4.m4.1.1.1.cmml" xref="S3.SS2.SSS1.p3.4.m4.1.1">superscript</csymbol><ci id="S3.SS2.SSS1.p3.4.m4.1.1.2.cmml" xref="S3.SS2.SSS1.p3.4.m4.1.1.2">ℎ</ci><ci id="S3.SS2.SSS1.p3.4.m4.1.1.3.cmml" xref="S3.SS2.SSS1.p3.4.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p3.4.m4.1c">h^{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p3.4.m4.1d">italic_h start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math>. Intuitively, given <math id="S3.SS2.SSS1.p3.5.m5.1" class="ltx_Math" alttext="h^{t}" display="inline"><semantics id="S3.SS2.SSS1.p3.5.m5.1a"><msup id="S3.SS2.SSS1.p3.5.m5.1.1" xref="S3.SS2.SSS1.p3.5.m5.1.1.cmml"><mi id="S3.SS2.SSS1.p3.5.m5.1.1.2" xref="S3.SS2.SSS1.p3.5.m5.1.1.2.cmml">h</mi><mi id="S3.SS2.SSS1.p3.5.m5.1.1.3" xref="S3.SS2.SSS1.p3.5.m5.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p3.5.m5.1b"><apply id="S3.SS2.SSS1.p3.5.m5.1.1.cmml" xref="S3.SS2.SSS1.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p3.5.m5.1.1.1.cmml" xref="S3.SS2.SSS1.p3.5.m5.1.1">superscript</csymbol><ci id="S3.SS2.SSS1.p3.5.m5.1.1.2.cmml" xref="S3.SS2.SSS1.p3.5.m5.1.1.2">ℎ</ci><ci id="S3.SS2.SSS1.p3.5.m5.1.1.3.cmml" xref="S3.SS2.SSS1.p3.5.m5.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p3.5.m5.1c">h^{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p3.5.m5.1d">italic_h start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math>, which implicitly contains information summarized from previous time steps, our ultimate goal is to estimate the likelihood of <math id="S3.SS2.SSS1.p3.6.m6.1" class="ltx_Math" alttext="x^{t}" display="inline"><semantics id="S3.SS2.SSS1.p3.6.m6.1a"><msup id="S3.SS2.SSS1.p3.6.m6.1.1" xref="S3.SS2.SSS1.p3.6.m6.1.1.cmml"><mi id="S3.SS2.SSS1.p3.6.m6.1.1.2" xref="S3.SS2.SSS1.p3.6.m6.1.1.2.cmml">x</mi><mi id="S3.SS2.SSS1.p3.6.m6.1.1.3" xref="S3.SS2.SSS1.p3.6.m6.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p3.6.m6.1b"><apply id="S3.SS2.SSS1.p3.6.m6.1.1.cmml" xref="S3.SS2.SSS1.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p3.6.m6.1.1.1.cmml" xref="S3.SS2.SSS1.p3.6.m6.1.1">superscript</csymbol><ci id="S3.SS2.SSS1.p3.6.m6.1.1.2.cmml" xref="S3.SS2.SSS1.p3.6.m6.1.1.2">𝑥</ci><ci id="S3.SS2.SSS1.p3.6.m6.1.1.3.cmml" xref="S3.SS2.SSS1.p3.6.m6.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p3.6.m6.1c">x^{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p3.6.m6.1d">italic_x start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math> in the entire input space <math id="S3.SS2.SSS1.p3.7.m7.1" class="ltx_Math" alttext="\mathcal{X}" display="inline"><semantics id="S3.SS2.SSS1.p3.7.m7.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS1.p3.7.m7.1.1" xref="S3.SS2.SSS1.p3.7.m7.1.1.cmml">𝒳</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p3.7.m7.1b"><ci id="S3.SS2.SSS1.p3.7.m7.1.1.cmml" xref="S3.SS2.SSS1.p3.7.m7.1.1">𝒳</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p3.7.m7.1c">\mathcal{X}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p3.7.m7.1d">caligraphic_X</annotation></semantics></math>, i.e., <math id="S3.SS2.SSS1.p3.8.m8.1" class="ltx_Math" alttext="p(x^{t}|h^{t})" display="inline"><semantics id="S3.SS2.SSS1.p3.8.m8.1a"><mrow id="S3.SS2.SSS1.p3.8.m8.1.1" xref="S3.SS2.SSS1.p3.8.m8.1.1.cmml"><mi id="S3.SS2.SSS1.p3.8.m8.1.1.3" xref="S3.SS2.SSS1.p3.8.m8.1.1.3.cmml">p</mi><mo id="S3.SS2.SSS1.p3.8.m8.1.1.2" xref="S3.SS2.SSS1.p3.8.m8.1.1.2.cmml">⁢</mo><mrow id="S3.SS2.SSS1.p3.8.m8.1.1.1.1" xref="S3.SS2.SSS1.p3.8.m8.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.SSS1.p3.8.m8.1.1.1.1.2" xref="S3.SS2.SSS1.p3.8.m8.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.SSS1.p3.8.m8.1.1.1.1.1" xref="S3.SS2.SSS1.p3.8.m8.1.1.1.1.1.cmml"><msup id="S3.SS2.SSS1.p3.8.m8.1.1.1.1.1.2" xref="S3.SS2.SSS1.p3.8.m8.1.1.1.1.1.2.cmml"><mi id="S3.SS2.SSS1.p3.8.m8.1.1.1.1.1.2.2" xref="S3.SS2.SSS1.p3.8.m8.1.1.1.1.1.2.2.cmml">x</mi><mi id="S3.SS2.SSS1.p3.8.m8.1.1.1.1.1.2.3" xref="S3.SS2.SSS1.p3.8.m8.1.1.1.1.1.2.3.cmml">t</mi></msup><mo fence="false" id="S3.SS2.SSS1.p3.8.m8.1.1.1.1.1.1" xref="S3.SS2.SSS1.p3.8.m8.1.1.1.1.1.1.cmml">|</mo><msup id="S3.SS2.SSS1.p3.8.m8.1.1.1.1.1.3" xref="S3.SS2.SSS1.p3.8.m8.1.1.1.1.1.3.cmml"><mi id="S3.SS2.SSS1.p3.8.m8.1.1.1.1.1.3.2" xref="S3.SS2.SSS1.p3.8.m8.1.1.1.1.1.3.2.cmml">h</mi><mi id="S3.SS2.SSS1.p3.8.m8.1.1.1.1.1.3.3" xref="S3.SS2.SSS1.p3.8.m8.1.1.1.1.1.3.3.cmml">t</mi></msup></mrow><mo stretchy="false" id="S3.SS2.SSS1.p3.8.m8.1.1.1.1.3" xref="S3.SS2.SSS1.p3.8.m8.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p3.8.m8.1b"><apply id="S3.SS2.SSS1.p3.8.m8.1.1.cmml" xref="S3.SS2.SSS1.p3.8.m8.1.1"><times id="S3.SS2.SSS1.p3.8.m8.1.1.2.cmml" xref="S3.SS2.SSS1.p3.8.m8.1.1.2"></times><ci id="S3.SS2.SSS1.p3.8.m8.1.1.3.cmml" xref="S3.SS2.SSS1.p3.8.m8.1.1.3">𝑝</ci><apply id="S3.SS2.SSS1.p3.8.m8.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p3.8.m8.1.1.1.1"><csymbol cd="latexml" id="S3.SS2.SSS1.p3.8.m8.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p3.8.m8.1.1.1.1.1.1">conditional</csymbol><apply id="S3.SS2.SSS1.p3.8.m8.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS1.p3.8.m8.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p3.8.m8.1.1.1.1.1.2.1.cmml" xref="S3.SS2.SSS1.p3.8.m8.1.1.1.1.1.2">superscript</csymbol><ci id="S3.SS2.SSS1.p3.8.m8.1.1.1.1.1.2.2.cmml" xref="S3.SS2.SSS1.p3.8.m8.1.1.1.1.1.2.2">𝑥</ci><ci id="S3.SS2.SSS1.p3.8.m8.1.1.1.1.1.2.3.cmml" xref="S3.SS2.SSS1.p3.8.m8.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S3.SS2.SSS1.p3.8.m8.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS1.p3.8.m8.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p3.8.m8.1.1.1.1.1.3.1.cmml" xref="S3.SS2.SSS1.p3.8.m8.1.1.1.1.1.3">superscript</csymbol><ci id="S3.SS2.SSS1.p3.8.m8.1.1.1.1.1.3.2.cmml" xref="S3.SS2.SSS1.p3.8.m8.1.1.1.1.1.3.2">ℎ</ci><ci id="S3.SS2.SSS1.p3.8.m8.1.1.1.1.1.3.3.cmml" xref="S3.SS2.SSS1.p3.8.m8.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p3.8.m8.1c">p(x^{t}|h^{t})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p3.8.m8.1d">italic_p ( italic_x start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT | italic_h start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT )</annotation></semantics></math>. A low value implies the observation is either rare in the input space or deviates from contextual behavior. Our implementation of the LSTM Encoder-Decoder model is shown in figure <a href="#S3.F2" title="Figure 2 ‣ III-B Timestamp-level Anomaly Detection ‣ III Methodology ‣ Generative Anomaly Detection for Time Series Datasets" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. We include temporal features such as week-of-year, day-of-week, and hour-of-day with the encoder’s input to facilitate learning the seasonality and trend patterns of time series. Then, the likelihood of the observations from <math id="S3.SS2.SSS1.p3.9.m9.1" class="ltx_Math" alttext="t_{0}" display="inline"><semantics id="S3.SS2.SSS1.p3.9.m9.1a"><msub id="S3.SS2.SSS1.p3.9.m9.1.1" xref="S3.SS2.SSS1.p3.9.m9.1.1.cmml"><mi id="S3.SS2.SSS1.p3.9.m9.1.1.2" xref="S3.SS2.SSS1.p3.9.m9.1.1.2.cmml">t</mi><mn id="S3.SS2.SSS1.p3.9.m9.1.1.3" xref="S3.SS2.SSS1.p3.9.m9.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p3.9.m9.1b"><apply id="S3.SS2.SSS1.p3.9.m9.1.1.cmml" xref="S3.SS2.SSS1.p3.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p3.9.m9.1.1.1.cmml" xref="S3.SS2.SSS1.p3.9.m9.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p3.9.m9.1.1.2.cmml" xref="S3.SS2.SSS1.p3.9.m9.1.1.2">𝑡</ci><cn type="integer" id="S3.SS2.SSS1.p3.9.m9.1.1.3.cmml" xref="S3.SS2.SSS1.p3.9.m9.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p3.9.m9.1c">t_{0}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p3.9.m9.1d">italic_t start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> to <math id="S3.SS2.SSS1.p3.10.m10.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="S3.SS2.SSS1.p3.10.m10.1a"><mi id="S3.SS2.SSS1.p3.10.m10.1.1" xref="S3.SS2.SSS1.p3.10.m10.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p3.10.m10.1b"><ci id="S3.SS2.SSS1.p3.10.m10.1.1.cmml" xref="S3.SS2.SSS1.p3.10.m10.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p3.10.m10.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p3.10.m10.1d">italic_τ</annotation></semantics></math> can be represented as:</p>
</div>
<div id="S3.SS2.SSS1.p4" class="ltx_para">
<table id="A1.EGx4" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E6.m1.1" class="ltx_Math" alttext="\displaystyle p(x^{t_{0}:\tau}\mid x^{1:t_{0}-1},\lambda^{1:t_{0}-1},\theta_{enc},\theta_{dec})" display="inline"><semantics id="S3.E6.m1.1a"><mrow id="S3.E6.m1.1.1" xref="S3.E6.m1.1.1.cmml"><mi mathsize="90%" id="S3.E6.m1.1.1.3" xref="S3.E6.m1.1.1.3.cmml">p</mi><mo id="S3.E6.m1.1.1.2" xref="S3.E6.m1.1.1.2.cmml">⁢</mo><mrow id="S3.E6.m1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.cmml"><mo maxsize="90%" minsize="90%" id="S3.E6.m1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E6.m1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.cmml"><msup id="S3.E6.m1.1.1.1.1.1.6" xref="S3.E6.m1.1.1.1.1.1.6.cmml"><mi mathsize="90%" id="S3.E6.m1.1.1.1.1.1.6.2" xref="S3.E6.m1.1.1.1.1.1.6.2.cmml">x</mi><mrow id="S3.E6.m1.1.1.1.1.1.6.3" xref="S3.E6.m1.1.1.1.1.1.6.3.cmml"><msub id="S3.E6.m1.1.1.1.1.1.6.3.2" xref="S3.E6.m1.1.1.1.1.1.6.3.2.cmml"><mi mathsize="90%" id="S3.E6.m1.1.1.1.1.1.6.3.2.2" xref="S3.E6.m1.1.1.1.1.1.6.3.2.2.cmml">t</mi><mn mathsize="90%" id="S3.E6.m1.1.1.1.1.1.6.3.2.3" xref="S3.E6.m1.1.1.1.1.1.6.3.2.3.cmml">0</mn></msub><mo lspace="0.278em" mathsize="90%" rspace="0.278em" id="S3.E6.m1.1.1.1.1.1.6.3.1" xref="S3.E6.m1.1.1.1.1.1.6.3.1.cmml">:</mo><mi mathsize="90%" id="S3.E6.m1.1.1.1.1.1.6.3.3" xref="S3.E6.m1.1.1.1.1.1.6.3.3.cmml">τ</mi></mrow></msup><mo mathsize="90%" id="S3.E6.m1.1.1.1.1.1.5" xref="S3.E6.m1.1.1.1.1.1.5.cmml">∣</mo><mrow id="S3.E6.m1.1.1.1.1.1.4.4" xref="S3.E6.m1.1.1.1.1.1.4.5.cmml"><msup id="S3.E6.m1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.1.1.cmml"><mi mathsize="90%" id="S3.E6.m1.1.1.1.1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.1.1.1.1.2.cmml">x</mi><mrow id="S3.E6.m1.1.1.1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.1.1.1.1.3.cmml"><mn mathsize="90%" id="S3.E6.m1.1.1.1.1.1.1.1.1.3.2" xref="S3.E6.m1.1.1.1.1.1.1.1.1.3.2.cmml">1</mn><mo lspace="0.278em" mathsize="90%" rspace="0.278em" id="S3.E6.m1.1.1.1.1.1.1.1.1.3.1" xref="S3.E6.m1.1.1.1.1.1.1.1.1.3.1.cmml">:</mo><mrow id="S3.E6.m1.1.1.1.1.1.1.1.1.3.3" xref="S3.E6.m1.1.1.1.1.1.1.1.1.3.3.cmml"><msub id="S3.E6.m1.1.1.1.1.1.1.1.1.3.3.2" xref="S3.E6.m1.1.1.1.1.1.1.1.1.3.3.2.cmml"><mi mathsize="90%" id="S3.E6.m1.1.1.1.1.1.1.1.1.3.3.2.2" xref="S3.E6.m1.1.1.1.1.1.1.1.1.3.3.2.2.cmml">t</mi><mn mathsize="90%" id="S3.E6.m1.1.1.1.1.1.1.1.1.3.3.2.3" xref="S3.E6.m1.1.1.1.1.1.1.1.1.3.3.2.3.cmml">0</mn></msub><mo mathsize="90%" id="S3.E6.m1.1.1.1.1.1.1.1.1.3.3.1" xref="S3.E6.m1.1.1.1.1.1.1.1.1.3.3.1.cmml">−</mo><mn mathsize="90%" id="S3.E6.m1.1.1.1.1.1.1.1.1.3.3.3" xref="S3.E6.m1.1.1.1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></mrow></msup><mo mathsize="90%" id="S3.E6.m1.1.1.1.1.1.4.4.5" xref="S3.E6.m1.1.1.1.1.1.4.5.cmml">,</mo><msup id="S3.E6.m1.1.1.1.1.1.2.2.2" xref="S3.E6.m1.1.1.1.1.1.2.2.2.cmml"><mi mathsize="90%" id="S3.E6.m1.1.1.1.1.1.2.2.2.2" xref="S3.E6.m1.1.1.1.1.1.2.2.2.2.cmml">λ</mi><mrow id="S3.E6.m1.1.1.1.1.1.2.2.2.3" xref="S3.E6.m1.1.1.1.1.1.2.2.2.3.cmml"><mn mathsize="90%" id="S3.E6.m1.1.1.1.1.1.2.2.2.3.2" xref="S3.E6.m1.1.1.1.1.1.2.2.2.3.2.cmml">1</mn><mo lspace="0.278em" mathsize="90%" rspace="0.278em" id="S3.E6.m1.1.1.1.1.1.2.2.2.3.1" xref="S3.E6.m1.1.1.1.1.1.2.2.2.3.1.cmml">:</mo><mrow id="S3.E6.m1.1.1.1.1.1.2.2.2.3.3" xref="S3.E6.m1.1.1.1.1.1.2.2.2.3.3.cmml"><msub id="S3.E6.m1.1.1.1.1.1.2.2.2.3.3.2" xref="S3.E6.m1.1.1.1.1.1.2.2.2.3.3.2.cmml"><mi mathsize="90%" id="S3.E6.m1.1.1.1.1.1.2.2.2.3.3.2.2" xref="S3.E6.m1.1.1.1.1.1.2.2.2.3.3.2.2.cmml">t</mi><mn mathsize="90%" id="S3.E6.m1.1.1.1.1.1.2.2.2.3.3.2.3" xref="S3.E6.m1.1.1.1.1.1.2.2.2.3.3.2.3.cmml">0</mn></msub><mo mathsize="90%" id="S3.E6.m1.1.1.1.1.1.2.2.2.3.3.1" xref="S3.E6.m1.1.1.1.1.1.2.2.2.3.3.1.cmml">−</mo><mn mathsize="90%" id="S3.E6.m1.1.1.1.1.1.2.2.2.3.3.3" xref="S3.E6.m1.1.1.1.1.1.2.2.2.3.3.3.cmml">1</mn></mrow></mrow></msup><mo mathsize="90%" id="S3.E6.m1.1.1.1.1.1.4.4.6" xref="S3.E6.m1.1.1.1.1.1.4.5.cmml">,</mo><msub id="S3.E6.m1.1.1.1.1.1.3.3.3" xref="S3.E6.m1.1.1.1.1.1.3.3.3.cmml"><mi mathsize="90%" id="S3.E6.m1.1.1.1.1.1.3.3.3.2" xref="S3.E6.m1.1.1.1.1.1.3.3.3.2.cmml">θ</mi><mrow id="S3.E6.m1.1.1.1.1.1.3.3.3.3" xref="S3.E6.m1.1.1.1.1.1.3.3.3.3.cmml"><mi mathsize="90%" id="S3.E6.m1.1.1.1.1.1.3.3.3.3.2" xref="S3.E6.m1.1.1.1.1.1.3.3.3.3.2.cmml">e</mi><mo id="S3.E6.m1.1.1.1.1.1.3.3.3.3.1" xref="S3.E6.m1.1.1.1.1.1.3.3.3.3.1.cmml">⁢</mo><mi mathsize="90%" id="S3.E6.m1.1.1.1.1.1.3.3.3.3.3" xref="S3.E6.m1.1.1.1.1.1.3.3.3.3.3.cmml">n</mi><mo id="S3.E6.m1.1.1.1.1.1.3.3.3.3.1a" xref="S3.E6.m1.1.1.1.1.1.3.3.3.3.1.cmml">⁢</mo><mi mathsize="90%" id="S3.E6.m1.1.1.1.1.1.3.3.3.3.4" xref="S3.E6.m1.1.1.1.1.1.3.3.3.3.4.cmml">c</mi></mrow></msub><mo mathsize="90%" id="S3.E6.m1.1.1.1.1.1.4.4.7" xref="S3.E6.m1.1.1.1.1.1.4.5.cmml">,</mo><msub id="S3.E6.m1.1.1.1.1.1.4.4.4" xref="S3.E6.m1.1.1.1.1.1.4.4.4.cmml"><mi mathsize="90%" id="S3.E6.m1.1.1.1.1.1.4.4.4.2" xref="S3.E6.m1.1.1.1.1.1.4.4.4.2.cmml">θ</mi><mrow id="S3.E6.m1.1.1.1.1.1.4.4.4.3" xref="S3.E6.m1.1.1.1.1.1.4.4.4.3.cmml"><mi mathsize="90%" id="S3.E6.m1.1.1.1.1.1.4.4.4.3.2" xref="S3.E6.m1.1.1.1.1.1.4.4.4.3.2.cmml">d</mi><mo id="S3.E6.m1.1.1.1.1.1.4.4.4.3.1" xref="S3.E6.m1.1.1.1.1.1.4.4.4.3.1.cmml">⁢</mo><mi mathsize="90%" id="S3.E6.m1.1.1.1.1.1.4.4.4.3.3" xref="S3.E6.m1.1.1.1.1.1.4.4.4.3.3.cmml">e</mi><mo id="S3.E6.m1.1.1.1.1.1.4.4.4.3.1a" xref="S3.E6.m1.1.1.1.1.1.4.4.4.3.1.cmml">⁢</mo><mi mathsize="90%" id="S3.E6.m1.1.1.1.1.1.4.4.4.3.4" xref="S3.E6.m1.1.1.1.1.1.4.4.4.3.4.cmml">c</mi></mrow></msub></mrow></mrow><mo maxsize="90%" minsize="90%" id="S3.E6.m1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.1b"><apply id="S3.E6.m1.1.1.cmml" xref="S3.E6.m1.1.1"><times id="S3.E6.m1.1.1.2.cmml" xref="S3.E6.m1.1.1.2"></times><ci id="S3.E6.m1.1.1.3.cmml" xref="S3.E6.m1.1.1.3">𝑝</ci><apply id="S3.E6.m1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1"><csymbol cd="latexml" id="S3.E6.m1.1.1.1.1.1.5.cmml" xref="S3.E6.m1.1.1.1.1.1.5">conditional</csymbol><apply id="S3.E6.m1.1.1.1.1.1.6.cmml" xref="S3.E6.m1.1.1.1.1.1.6"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.6.1.cmml" xref="S3.E6.m1.1.1.1.1.1.6">superscript</csymbol><ci id="S3.E6.m1.1.1.1.1.1.6.2.cmml" xref="S3.E6.m1.1.1.1.1.1.6.2">𝑥</ci><apply id="S3.E6.m1.1.1.1.1.1.6.3.cmml" xref="S3.E6.m1.1.1.1.1.1.6.3"><ci id="S3.E6.m1.1.1.1.1.1.6.3.1.cmml" xref="S3.E6.m1.1.1.1.1.1.6.3.1">:</ci><apply id="S3.E6.m1.1.1.1.1.1.6.3.2.cmml" xref="S3.E6.m1.1.1.1.1.1.6.3.2"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.6.3.2.1.cmml" xref="S3.E6.m1.1.1.1.1.1.6.3.2">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.1.6.3.2.2.cmml" xref="S3.E6.m1.1.1.1.1.1.6.3.2.2">𝑡</ci><cn type="integer" id="S3.E6.m1.1.1.1.1.1.6.3.2.3.cmml" xref="S3.E6.m1.1.1.1.1.1.6.3.2.3">0</cn></apply><ci id="S3.E6.m1.1.1.1.1.1.6.3.3.cmml" xref="S3.E6.m1.1.1.1.1.1.6.3.3">𝜏</ci></apply></apply><list id="S3.E6.m1.1.1.1.1.1.4.5.cmml" xref="S3.E6.m1.1.1.1.1.1.4.4"><apply id="S3.E6.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.2">𝑥</ci><apply id="S3.E6.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.3"><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.3.1">:</ci><cn type="integer" id="S3.E6.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.3.2">1</cn><apply id="S3.E6.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.3.3"><minus id="S3.E6.m1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.3.3.1"></minus><apply id="S3.E6.m1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.1.1.1.3.3.2.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.3.3.2">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.3.3.2.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.3.3.2.2">𝑡</ci><cn type="integer" id="S3.E6.m1.1.1.1.1.1.1.1.1.3.3.2.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.3.3.2.3">0</cn></apply><cn type="integer" id="S3.E6.m1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply><apply id="S3.E6.m1.1.1.1.1.1.2.2.2.cmml" xref="S3.E6.m1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E6.m1.1.1.1.1.1.2.2.2">superscript</csymbol><ci id="S3.E6.m1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E6.m1.1.1.1.1.1.2.2.2.2">𝜆</ci><apply id="S3.E6.m1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E6.m1.1.1.1.1.1.2.2.2.3"><ci id="S3.E6.m1.1.1.1.1.1.2.2.2.3.1.cmml" xref="S3.E6.m1.1.1.1.1.1.2.2.2.3.1">:</ci><cn type="integer" id="S3.E6.m1.1.1.1.1.1.2.2.2.3.2.cmml" xref="S3.E6.m1.1.1.1.1.1.2.2.2.3.2">1</cn><apply id="S3.E6.m1.1.1.1.1.1.2.2.2.3.3.cmml" xref="S3.E6.m1.1.1.1.1.1.2.2.2.3.3"><minus id="S3.E6.m1.1.1.1.1.1.2.2.2.3.3.1.cmml" xref="S3.E6.m1.1.1.1.1.1.2.2.2.3.3.1"></minus><apply id="S3.E6.m1.1.1.1.1.1.2.2.2.3.3.2.cmml" xref="S3.E6.m1.1.1.1.1.1.2.2.2.3.3.2"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.2.2.2.3.3.2.1.cmml" xref="S3.E6.m1.1.1.1.1.1.2.2.2.3.3.2">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.1.2.2.2.3.3.2.2.cmml" xref="S3.E6.m1.1.1.1.1.1.2.2.2.3.3.2.2">𝑡</ci><cn type="integer" id="S3.E6.m1.1.1.1.1.1.2.2.2.3.3.2.3.cmml" xref="S3.E6.m1.1.1.1.1.1.2.2.2.3.3.2.3">0</cn></apply><cn type="integer" id="S3.E6.m1.1.1.1.1.1.2.2.2.3.3.3.cmml" xref="S3.E6.m1.1.1.1.1.1.2.2.2.3.3.3">1</cn></apply></apply></apply><apply id="S3.E6.m1.1.1.1.1.1.3.3.3.cmml" xref="S3.E6.m1.1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.3.3.3.1.cmml" xref="S3.E6.m1.1.1.1.1.1.3.3.3">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.1.3.3.3.2.cmml" xref="S3.E6.m1.1.1.1.1.1.3.3.3.2">𝜃</ci><apply id="S3.E6.m1.1.1.1.1.1.3.3.3.3.cmml" xref="S3.E6.m1.1.1.1.1.1.3.3.3.3"><times id="S3.E6.m1.1.1.1.1.1.3.3.3.3.1.cmml" xref="S3.E6.m1.1.1.1.1.1.3.3.3.3.1"></times><ci id="S3.E6.m1.1.1.1.1.1.3.3.3.3.2.cmml" xref="S3.E6.m1.1.1.1.1.1.3.3.3.3.2">𝑒</ci><ci id="S3.E6.m1.1.1.1.1.1.3.3.3.3.3.cmml" xref="S3.E6.m1.1.1.1.1.1.3.3.3.3.3">𝑛</ci><ci id="S3.E6.m1.1.1.1.1.1.3.3.3.3.4.cmml" xref="S3.E6.m1.1.1.1.1.1.3.3.3.3.4">𝑐</ci></apply></apply><apply id="S3.E6.m1.1.1.1.1.1.4.4.4.cmml" xref="S3.E6.m1.1.1.1.1.1.4.4.4"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.4.4.4.1.cmml" xref="S3.E6.m1.1.1.1.1.1.4.4.4">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.1.4.4.4.2.cmml" xref="S3.E6.m1.1.1.1.1.1.4.4.4.2">𝜃</ci><apply id="S3.E6.m1.1.1.1.1.1.4.4.4.3.cmml" xref="S3.E6.m1.1.1.1.1.1.4.4.4.3"><times id="S3.E6.m1.1.1.1.1.1.4.4.4.3.1.cmml" xref="S3.E6.m1.1.1.1.1.1.4.4.4.3.1"></times><ci id="S3.E6.m1.1.1.1.1.1.4.4.4.3.2.cmml" xref="S3.E6.m1.1.1.1.1.1.4.4.4.3.2">𝑑</ci><ci id="S3.E6.m1.1.1.1.1.1.4.4.4.3.3.cmml" xref="S3.E6.m1.1.1.1.1.1.4.4.4.3.3">𝑒</ci><ci id="S3.E6.m1.1.1.1.1.1.4.4.4.3.4.cmml" xref="S3.E6.m1.1.1.1.1.1.4.4.4.3.4">𝑐</ci></apply></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.1c">\displaystyle p(x^{t_{0}:\tau}\mid x^{1:t_{0}-1},\lambda^{1:t_{0}-1},\theta_{enc},\theta_{dec})</annotation><annotation encoding="application/x-llamapun" id="S3.E6.m1.1d">italic_p ( italic_x start_POSTSUPERSCRIPT italic_t start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT : italic_τ end_POSTSUPERSCRIPT ∣ italic_x start_POSTSUPERSCRIPT 1 : italic_t start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT - 1 end_POSTSUPERSCRIPT , italic_λ start_POSTSUPERSCRIPT 1 : italic_t start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT - 1 end_POSTSUPERSCRIPT , italic_θ start_POSTSUBSCRIPT italic_e italic_n italic_c end_POSTSUBSCRIPT , italic_θ start_POSTSUBSCRIPT italic_d italic_e italic_c end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E6.m2.1" class="ltx_Math" alttext="\displaystyle=\prod_{t=t_{0}}^{\tau}p(x^{t}|h^{t},\lambda^{t},\theta_{dec})" display="inline"><semantics id="S3.E6.m2.1a"><mrow id="S3.E6.m2.1.1" xref="S3.E6.m2.1.1.cmml"><mi id="S3.E6.m2.1.1.3" xref="S3.E6.m2.1.1.3.cmml"></mi><mo mathsize="90%" id="S3.E6.m2.1.1.2" xref="S3.E6.m2.1.1.2.cmml">=</mo><mrow id="S3.E6.m2.1.1.1" xref="S3.E6.m2.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E6.m2.1.1.1.2" xref="S3.E6.m2.1.1.1.2.cmml"><munderover id="S3.E6.m2.1.1.1.2a" xref="S3.E6.m2.1.1.1.2.cmml"><mo maxsize="90%" minsize="90%" movablelimits="false" stretchy="true" id="S3.E6.m2.1.1.1.2.2.2" xref="S3.E6.m2.1.1.1.2.2.2.cmml">∏</mo><mrow id="S3.E6.m2.1.1.1.2.2.3" xref="S3.E6.m2.1.1.1.2.2.3.cmml"><mi mathsize="90%" id="S3.E6.m2.1.1.1.2.2.3.2" xref="S3.E6.m2.1.1.1.2.2.3.2.cmml">t</mi><mo mathsize="90%" id="S3.E6.m2.1.1.1.2.2.3.1" xref="S3.E6.m2.1.1.1.2.2.3.1.cmml">=</mo><msub id="S3.E6.m2.1.1.1.2.2.3.3" xref="S3.E6.m2.1.1.1.2.2.3.3.cmml"><mi mathsize="90%" id="S3.E6.m2.1.1.1.2.2.3.3.2" xref="S3.E6.m2.1.1.1.2.2.3.3.2.cmml">t</mi><mn mathsize="90%" id="S3.E6.m2.1.1.1.2.2.3.3.3" xref="S3.E6.m2.1.1.1.2.2.3.3.3.cmml">0</mn></msub></mrow><mi mathsize="90%" id="S3.E6.m2.1.1.1.2.3" xref="S3.E6.m2.1.1.1.2.3.cmml">τ</mi></munderover></mstyle><mrow id="S3.E6.m2.1.1.1.1" xref="S3.E6.m2.1.1.1.1.cmml"><mi mathsize="90%" id="S3.E6.m2.1.1.1.1.3" xref="S3.E6.m2.1.1.1.1.3.cmml">p</mi><mo id="S3.E6.m2.1.1.1.1.2" xref="S3.E6.m2.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E6.m2.1.1.1.1.1.1" xref="S3.E6.m2.1.1.1.1.1.1.1.cmml"><mo maxsize="90%" minsize="90%" id="S3.E6.m2.1.1.1.1.1.1.2" xref="S3.E6.m2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E6.m2.1.1.1.1.1.1.1" xref="S3.E6.m2.1.1.1.1.1.1.1.cmml"><msup id="S3.E6.m2.1.1.1.1.1.1.1.5" xref="S3.E6.m2.1.1.1.1.1.1.1.5.cmml"><mi mathsize="90%" id="S3.E6.m2.1.1.1.1.1.1.1.5.2" xref="S3.E6.m2.1.1.1.1.1.1.1.5.2.cmml">x</mi><mi mathsize="90%" id="S3.E6.m2.1.1.1.1.1.1.1.5.3" xref="S3.E6.m2.1.1.1.1.1.1.1.5.3.cmml">t</mi></msup><mo fence="false" mathsize="90%" id="S3.E6.m2.1.1.1.1.1.1.1.4" xref="S3.E6.m2.1.1.1.1.1.1.1.4.cmml">|</mo><mrow id="S3.E6.m2.1.1.1.1.1.1.1.3.3" xref="S3.E6.m2.1.1.1.1.1.1.1.3.4.cmml"><msup id="S3.E6.m2.1.1.1.1.1.1.1.1.1.1" xref="S3.E6.m2.1.1.1.1.1.1.1.1.1.1.cmml"><mi mathsize="90%" id="S3.E6.m2.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E6.m2.1.1.1.1.1.1.1.1.1.1.2.cmml">h</mi><mi mathsize="90%" id="S3.E6.m2.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E6.m2.1.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msup><mo mathsize="90%" id="S3.E6.m2.1.1.1.1.1.1.1.3.3.4" xref="S3.E6.m2.1.1.1.1.1.1.1.3.4.cmml">,</mo><msup id="S3.E6.m2.1.1.1.1.1.1.1.2.2.2" xref="S3.E6.m2.1.1.1.1.1.1.1.2.2.2.cmml"><mi mathsize="90%" id="S3.E6.m2.1.1.1.1.1.1.1.2.2.2.2" xref="S3.E6.m2.1.1.1.1.1.1.1.2.2.2.2.cmml">λ</mi><mi mathsize="90%" id="S3.E6.m2.1.1.1.1.1.1.1.2.2.2.3" xref="S3.E6.m2.1.1.1.1.1.1.1.2.2.2.3.cmml">t</mi></msup><mo mathsize="90%" id="S3.E6.m2.1.1.1.1.1.1.1.3.3.5" xref="S3.E6.m2.1.1.1.1.1.1.1.3.4.cmml">,</mo><msub id="S3.E6.m2.1.1.1.1.1.1.1.3.3.3" xref="S3.E6.m2.1.1.1.1.1.1.1.3.3.3.cmml"><mi mathsize="90%" id="S3.E6.m2.1.1.1.1.1.1.1.3.3.3.2" xref="S3.E6.m2.1.1.1.1.1.1.1.3.3.3.2.cmml">θ</mi><mrow id="S3.E6.m2.1.1.1.1.1.1.1.3.3.3.3" xref="S3.E6.m2.1.1.1.1.1.1.1.3.3.3.3.cmml"><mi mathsize="90%" id="S3.E6.m2.1.1.1.1.1.1.1.3.3.3.3.2" xref="S3.E6.m2.1.1.1.1.1.1.1.3.3.3.3.2.cmml">d</mi><mo id="S3.E6.m2.1.1.1.1.1.1.1.3.3.3.3.1" xref="S3.E6.m2.1.1.1.1.1.1.1.3.3.3.3.1.cmml">⁢</mo><mi mathsize="90%" id="S3.E6.m2.1.1.1.1.1.1.1.3.3.3.3.3" xref="S3.E6.m2.1.1.1.1.1.1.1.3.3.3.3.3.cmml">e</mi><mo id="S3.E6.m2.1.1.1.1.1.1.1.3.3.3.3.1a" xref="S3.E6.m2.1.1.1.1.1.1.1.3.3.3.3.1.cmml">⁢</mo><mi mathsize="90%" id="S3.E6.m2.1.1.1.1.1.1.1.3.3.3.3.4" xref="S3.E6.m2.1.1.1.1.1.1.1.3.3.3.3.4.cmml">c</mi></mrow></msub></mrow></mrow><mo maxsize="90%" minsize="90%" id="S3.E6.m2.1.1.1.1.1.1.3" xref="S3.E6.m2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m2.1b"><apply id="S3.E6.m2.1.1.cmml" xref="S3.E6.m2.1.1"><eq id="S3.E6.m2.1.1.2.cmml" xref="S3.E6.m2.1.1.2"></eq><csymbol cd="latexml" id="S3.E6.m2.1.1.3.cmml" xref="S3.E6.m2.1.1.3">absent</csymbol><apply id="S3.E6.m2.1.1.1.cmml" xref="S3.E6.m2.1.1.1"><apply id="S3.E6.m2.1.1.1.2.cmml" xref="S3.E6.m2.1.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m2.1.1.1.2.1.cmml" xref="S3.E6.m2.1.1.1.2">superscript</csymbol><apply id="S3.E6.m2.1.1.1.2.2.cmml" xref="S3.E6.m2.1.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m2.1.1.1.2.2.1.cmml" xref="S3.E6.m2.1.1.1.2">subscript</csymbol><csymbol cd="latexml" id="S3.E6.m2.1.1.1.2.2.2.cmml" xref="S3.E6.m2.1.1.1.2.2.2">product</csymbol><apply id="S3.E6.m2.1.1.1.2.2.3.cmml" xref="S3.E6.m2.1.1.1.2.2.3"><eq id="S3.E6.m2.1.1.1.2.2.3.1.cmml" xref="S3.E6.m2.1.1.1.2.2.3.1"></eq><ci id="S3.E6.m2.1.1.1.2.2.3.2.cmml" xref="S3.E6.m2.1.1.1.2.2.3.2">𝑡</ci><apply id="S3.E6.m2.1.1.1.2.2.3.3.cmml" xref="S3.E6.m2.1.1.1.2.2.3.3"><csymbol cd="ambiguous" id="S3.E6.m2.1.1.1.2.2.3.3.1.cmml" xref="S3.E6.m2.1.1.1.2.2.3.3">subscript</csymbol><ci id="S3.E6.m2.1.1.1.2.2.3.3.2.cmml" xref="S3.E6.m2.1.1.1.2.2.3.3.2">𝑡</ci><cn type="integer" id="S3.E6.m2.1.1.1.2.2.3.3.3.cmml" xref="S3.E6.m2.1.1.1.2.2.3.3.3">0</cn></apply></apply></apply><ci id="S3.E6.m2.1.1.1.2.3.cmml" xref="S3.E6.m2.1.1.1.2.3">𝜏</ci></apply><apply id="S3.E6.m2.1.1.1.1.cmml" xref="S3.E6.m2.1.1.1.1"><times id="S3.E6.m2.1.1.1.1.2.cmml" xref="S3.E6.m2.1.1.1.1.2"></times><ci id="S3.E6.m2.1.1.1.1.3.cmml" xref="S3.E6.m2.1.1.1.1.3">𝑝</ci><apply id="S3.E6.m2.1.1.1.1.1.1.1.cmml" xref="S3.E6.m2.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E6.m2.1.1.1.1.1.1.1.4.cmml" xref="S3.E6.m2.1.1.1.1.1.1.1.4">conditional</csymbol><apply id="S3.E6.m2.1.1.1.1.1.1.1.5.cmml" xref="S3.E6.m2.1.1.1.1.1.1.1.5"><csymbol cd="ambiguous" id="S3.E6.m2.1.1.1.1.1.1.1.5.1.cmml" xref="S3.E6.m2.1.1.1.1.1.1.1.5">superscript</csymbol><ci id="S3.E6.m2.1.1.1.1.1.1.1.5.2.cmml" xref="S3.E6.m2.1.1.1.1.1.1.1.5.2">𝑥</ci><ci id="S3.E6.m2.1.1.1.1.1.1.1.5.3.cmml" xref="S3.E6.m2.1.1.1.1.1.1.1.5.3">𝑡</ci></apply><list id="S3.E6.m2.1.1.1.1.1.1.1.3.4.cmml" xref="S3.E6.m2.1.1.1.1.1.1.1.3.3"><apply id="S3.E6.m2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m2.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m2.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E6.m2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m2.1.1.1.1.1.1.1.1.1.1.2">ℎ</ci><ci id="S3.E6.m2.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m2.1.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S3.E6.m2.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E6.m2.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E6.m2.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E6.m2.1.1.1.1.1.1.1.2.2.2">superscript</csymbol><ci id="S3.E6.m2.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E6.m2.1.1.1.1.1.1.1.2.2.2.2">𝜆</ci><ci id="S3.E6.m2.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E6.m2.1.1.1.1.1.1.1.2.2.2.3">𝑡</ci></apply><apply id="S3.E6.m2.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E6.m2.1.1.1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E6.m2.1.1.1.1.1.1.1.3.3.3.1.cmml" xref="S3.E6.m2.1.1.1.1.1.1.1.3.3.3">subscript</csymbol><ci id="S3.E6.m2.1.1.1.1.1.1.1.3.3.3.2.cmml" xref="S3.E6.m2.1.1.1.1.1.1.1.3.3.3.2">𝜃</ci><apply id="S3.E6.m2.1.1.1.1.1.1.1.3.3.3.3.cmml" xref="S3.E6.m2.1.1.1.1.1.1.1.3.3.3.3"><times id="S3.E6.m2.1.1.1.1.1.1.1.3.3.3.3.1.cmml" xref="S3.E6.m2.1.1.1.1.1.1.1.3.3.3.3.1"></times><ci id="S3.E6.m2.1.1.1.1.1.1.1.3.3.3.3.2.cmml" xref="S3.E6.m2.1.1.1.1.1.1.1.3.3.3.3.2">𝑑</ci><ci id="S3.E6.m2.1.1.1.1.1.1.1.3.3.3.3.3.cmml" xref="S3.E6.m2.1.1.1.1.1.1.1.3.3.3.3.3">𝑒</ci><ci id="S3.E6.m2.1.1.1.1.1.1.1.3.3.3.3.4.cmml" xref="S3.E6.m2.1.1.1.1.1.1.1.3.3.3.3.4">𝑐</ci></apply></apply></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m2.1c">\displaystyle=\prod_{t=t_{0}}^{\tau}p(x^{t}|h^{t},\lambda^{t},\theta_{dec})</annotation><annotation encoding="application/x-llamapun" id="S3.E6.m2.1d">= ∏ start_POSTSUBSCRIPT italic_t = italic_t start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_τ end_POSTSUPERSCRIPT italic_p ( italic_x start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT | italic_h start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT , italic_λ start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT , italic_θ start_POSTSUBSCRIPT italic_d italic_e italic_c end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.SSS1.p4.2" class="ltx_p">where <math id="S3.SS2.SSS1.p4.1.m1.1" class="ltx_Math" alttext="h^{t}" display="inline"><semantics id="S3.SS2.SSS1.p4.1.m1.1a"><msup id="S3.SS2.SSS1.p4.1.m1.1.1" xref="S3.SS2.SSS1.p4.1.m1.1.1.cmml"><mi id="S3.SS2.SSS1.p4.1.m1.1.1.2" xref="S3.SS2.SSS1.p4.1.m1.1.1.2.cmml">h</mi><mi id="S3.SS2.SSS1.p4.1.m1.1.1.3" xref="S3.SS2.SSS1.p4.1.m1.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p4.1.m1.1b"><apply id="S3.SS2.SSS1.p4.1.m1.1.1.cmml" xref="S3.SS2.SSS1.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p4.1.m1.1.1.1.cmml" xref="S3.SS2.SSS1.p4.1.m1.1.1">superscript</csymbol><ci id="S3.SS2.SSS1.p4.1.m1.1.1.2.cmml" xref="S3.SS2.SSS1.p4.1.m1.1.1.2">ℎ</ci><ci id="S3.SS2.SSS1.p4.1.m1.1.1.3.cmml" xref="S3.SS2.SSS1.p4.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p4.1.m1.1c">h^{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p4.1.m1.1d">italic_h start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math> denotes the LSTM hidden at <math id="S3.SS2.SSS1.p4.2.m2.1" class="ltx_Math" alttext="x^{t}" display="inline"><semantics id="S3.SS2.SSS1.p4.2.m2.1a"><msup id="S3.SS2.SSS1.p4.2.m2.1.1" xref="S3.SS2.SSS1.p4.2.m2.1.1.cmml"><mi id="S3.SS2.SSS1.p4.2.m2.1.1.2" xref="S3.SS2.SSS1.p4.2.m2.1.1.2.cmml">x</mi><mi id="S3.SS2.SSS1.p4.2.m2.1.1.3" xref="S3.SS2.SSS1.p4.2.m2.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p4.2.m2.1b"><apply id="S3.SS2.SSS1.p4.2.m2.1.1.cmml" xref="S3.SS2.SSS1.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p4.2.m2.1.1.1.cmml" xref="S3.SS2.SSS1.p4.2.m2.1.1">superscript</csymbol><ci id="S3.SS2.SSS1.p4.2.m2.1.1.2.cmml" xref="S3.SS2.SSS1.p4.2.m2.1.1.2">𝑥</ci><ci id="S3.SS2.SSS1.p4.2.m2.1.1.3.cmml" xref="S3.SS2.SSS1.p4.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p4.2.m2.1c">x^{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p4.2.m2.1d">italic_x start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math> that is autoregressively derived from the previous step.
Next, we explain how to compute the density function mentioned in equation <a href="#S3.E6" title="6 ‣ III-B1 LSTM Encoder-Decoder ‣ III-B Timestamp-level Anomaly Detection ‣ III Methodology ‣ Generative Anomaly Detection for Time Series Datasets" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> using a conditional RealNVP flow model.</p>
</div>
</section>
<section id="S3.SS2.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S3.SS2.SSS2.5.1.1" class="ltx_text">III-B</span>2 </span>Conditional RealNVP</h4>

<div id="S3.SS2.SSS2.p1" class="ltx_para">
<p id="S3.SS2.SSS2.p1.10" class="ltx_p">Note that while the LSTM requires a three-dimensional input, such an input cannot directly fit into the flow model. As a result, we begin by flattening the time dimension. Recall that our goal is to learn a set of bijective functions that enable transformation between a simple distribution and the real-world data distribution, as mentioned in section <a href="#S2.SS2" title="II-B RealNVP ‣ II Background ‣ Generative Anomaly Detection for Time Series Datasets" class="ltx_ref"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">II-B</span></span></a>. We use a multivariate Gaussian distribution with a diagonal covariance matrix as the base distribution, which is a common choice for normalizing flow <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>. Let <math id="S3.SS2.SSS2.p1.1.m1.1" class="ltx_Math" alttext="y^{t}" display="inline"><semantics id="S3.SS2.SSS2.p1.1.m1.1a"><msup id="S3.SS2.SSS2.p1.1.m1.1.1" xref="S3.SS2.SSS2.p1.1.m1.1.1.cmml"><mi id="S3.SS2.SSS2.p1.1.m1.1.1.2" xref="S3.SS2.SSS2.p1.1.m1.1.1.2.cmml">y</mi><mi id="S3.SS2.SSS2.p1.1.m1.1.1.3" xref="S3.SS2.SSS2.p1.1.m1.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.1.m1.1b"><apply id="S3.SS2.SSS2.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.1.m1.1.1.1.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1">superscript</csymbol><ci id="S3.SS2.SSS2.p1.1.m1.1.1.2.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1.2">𝑦</ci><ci id="S3.SS2.SSS2.p1.1.m1.1.1.3.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.1.m1.1c">y^{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.1.m1.1d">italic_y start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math> denote an arbitrary latent representation learned as part of the transformation.
RealNVP partitions a given <math id="S3.SS2.SSS2.p1.2.m2.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S3.SS2.SSS2.p1.2.m2.1a"><mi id="S3.SS2.SSS2.p1.2.m2.1.1" xref="S3.SS2.SSS2.p1.2.m2.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.2.m2.1b"><ci id="S3.SS2.SSS2.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS2.p1.2.m2.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.2.m2.1c">x</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.2.m2.1d">italic_x</annotation></semantics></math> into two disjoint groups, one of which is unchanged and mapped to the <math id="S3.SS2.SSS2.p1.3.m3.1" class="ltx_Math" alttext="1:d" display="inline"><semantics id="S3.SS2.SSS2.p1.3.m3.1a"><mrow id="S3.SS2.SSS2.p1.3.m3.1.1" xref="S3.SS2.SSS2.p1.3.m3.1.1.cmml"><mn id="S3.SS2.SSS2.p1.3.m3.1.1.2" xref="S3.SS2.SSS2.p1.3.m3.1.1.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S3.SS2.SSS2.p1.3.m3.1.1.1" xref="S3.SS2.SSS2.p1.3.m3.1.1.1.cmml">:</mo><mi id="S3.SS2.SSS2.p1.3.m3.1.1.3" xref="S3.SS2.SSS2.p1.3.m3.1.1.3.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.3.m3.1b"><apply id="S3.SS2.SSS2.p1.3.m3.1.1.cmml" xref="S3.SS2.SSS2.p1.3.m3.1.1"><ci id="S3.SS2.SSS2.p1.3.m3.1.1.1.cmml" xref="S3.SS2.SSS2.p1.3.m3.1.1.1">:</ci><cn type="integer" id="S3.SS2.SSS2.p1.3.m3.1.1.2.cmml" xref="S3.SS2.SSS2.p1.3.m3.1.1.2">1</cn><ci id="S3.SS2.SSS2.p1.3.m3.1.1.3.cmml" xref="S3.SS2.SSS2.p1.3.m3.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.3.m3.1c">1:d</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.3.m3.1d">1 : italic_d</annotation></semantics></math> dimensions, while the other part of <math id="S3.SS2.SSS2.p1.4.m4.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S3.SS2.SSS2.p1.4.m4.1a"><mi id="S3.SS2.SSS2.p1.4.m4.1.1" xref="S3.SS2.SSS2.p1.4.m4.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.4.m4.1b"><ci id="S3.SS2.SSS2.p1.4.m4.1.1.cmml" xref="S3.SS2.SSS2.p1.4.m4.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.4.m4.1c">x</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.4.m4.1d">italic_x</annotation></semantics></math> undergoes a transformation and is mapped to <math id="S3.SS2.SSS2.p1.5.m5.1" class="ltx_Math" alttext="d+1:D" display="inline"><semantics id="S3.SS2.SSS2.p1.5.m5.1a"><mrow id="S3.SS2.SSS2.p1.5.m5.1.1" xref="S3.SS2.SSS2.p1.5.m5.1.1.cmml"><mrow id="S3.SS2.SSS2.p1.5.m5.1.1.2" xref="S3.SS2.SSS2.p1.5.m5.1.1.2.cmml"><mi id="S3.SS2.SSS2.p1.5.m5.1.1.2.2" xref="S3.SS2.SSS2.p1.5.m5.1.1.2.2.cmml">d</mi><mo id="S3.SS2.SSS2.p1.5.m5.1.1.2.1" xref="S3.SS2.SSS2.p1.5.m5.1.1.2.1.cmml">+</mo><mn id="S3.SS2.SSS2.p1.5.m5.1.1.2.3" xref="S3.SS2.SSS2.p1.5.m5.1.1.2.3.cmml">1</mn></mrow><mo lspace="0.278em" rspace="0.278em" id="S3.SS2.SSS2.p1.5.m5.1.1.1" xref="S3.SS2.SSS2.p1.5.m5.1.1.1.cmml">:</mo><mi id="S3.SS2.SSS2.p1.5.m5.1.1.3" xref="S3.SS2.SSS2.p1.5.m5.1.1.3.cmml">D</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.5.m5.1b"><apply id="S3.SS2.SSS2.p1.5.m5.1.1.cmml" xref="S3.SS2.SSS2.p1.5.m5.1.1"><ci id="S3.SS2.SSS2.p1.5.m5.1.1.1.cmml" xref="S3.SS2.SSS2.p1.5.m5.1.1.1">:</ci><apply id="S3.SS2.SSS2.p1.5.m5.1.1.2.cmml" xref="S3.SS2.SSS2.p1.5.m5.1.1.2"><plus id="S3.SS2.SSS2.p1.5.m5.1.1.2.1.cmml" xref="S3.SS2.SSS2.p1.5.m5.1.1.2.1"></plus><ci id="S3.SS2.SSS2.p1.5.m5.1.1.2.2.cmml" xref="S3.SS2.SSS2.p1.5.m5.1.1.2.2">𝑑</ci><cn type="integer" id="S3.SS2.SSS2.p1.5.m5.1.1.2.3.cmml" xref="S3.SS2.SSS2.p1.5.m5.1.1.2.3">1</cn></apply><ci id="S3.SS2.SSS2.p1.5.m5.1.1.3.cmml" xref="S3.SS2.SSS2.p1.5.m5.1.1.3">𝐷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.5.m5.1c">d+1:D</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.5.m5.1d">italic_d + 1 : italic_D</annotation></semantics></math> dimensions (see equation <a href="#S2.E2" title="2 ‣ II-B RealNVP ‣ II Background ‣ Generative Anomaly Detection for Time Series Datasets" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> in section <a href="#S2" title="II Background ‣ Generative Anomaly Detection for Time Series Datasets" class="ltx_ref"><span class="ltx_text ltx_ref_tag">II</span></a>).
To model the conditional distribution shown in equation <a href="#S3.E6" title="6 ‣ III-B1 LSTM Encoder-Decoder ‣ III-B Timestamp-level Anomaly Detection ‣ III Methodology ‣ Generative Anomaly Detection for Time Series Datasets" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>, we concatenate <math id="S3.SS2.SSS2.p1.6.m6.1" class="ltx_Math" alttext="h^{t}" display="inline"><semantics id="S3.SS2.SSS2.p1.6.m6.1a"><msup id="S3.SS2.SSS2.p1.6.m6.1.1" xref="S3.SS2.SSS2.p1.6.m6.1.1.cmml"><mi id="S3.SS2.SSS2.p1.6.m6.1.1.2" xref="S3.SS2.SSS2.p1.6.m6.1.1.2.cmml">h</mi><mi id="S3.SS2.SSS2.p1.6.m6.1.1.3" xref="S3.SS2.SSS2.p1.6.m6.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.6.m6.1b"><apply id="S3.SS2.SSS2.p1.6.m6.1.1.cmml" xref="S3.SS2.SSS2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.6.m6.1.1.1.cmml" xref="S3.SS2.SSS2.p1.6.m6.1.1">superscript</csymbol><ci id="S3.SS2.SSS2.p1.6.m6.1.1.2.cmml" xref="S3.SS2.SSS2.p1.6.m6.1.1.2">ℎ</ci><ci id="S3.SS2.SSS2.p1.6.m6.1.1.3.cmml" xref="S3.SS2.SSS2.p1.6.m6.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.6.m6.1c">h^{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.6.m6.1d">italic_h start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math> and <math id="S3.SS2.SSS2.p1.7.m7.1" class="ltx_Math" alttext="\lambda^{t}" display="inline"><semantics id="S3.SS2.SSS2.p1.7.m7.1a"><msup id="S3.SS2.SSS2.p1.7.m7.1.1" xref="S3.SS2.SSS2.p1.7.m7.1.1.cmml"><mi id="S3.SS2.SSS2.p1.7.m7.1.1.2" xref="S3.SS2.SSS2.p1.7.m7.1.1.2.cmml">λ</mi><mi id="S3.SS2.SSS2.p1.7.m7.1.1.3" xref="S3.SS2.SSS2.p1.7.m7.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.7.m7.1b"><apply id="S3.SS2.SSS2.p1.7.m7.1.1.cmml" xref="S3.SS2.SSS2.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.7.m7.1.1.1.cmml" xref="S3.SS2.SSS2.p1.7.m7.1.1">superscript</csymbol><ci id="S3.SS2.SSS2.p1.7.m7.1.1.2.cmml" xref="S3.SS2.SSS2.p1.7.m7.1.1.2">𝜆</ci><ci id="S3.SS2.SSS2.p1.7.m7.1.1.3.cmml" xref="S3.SS2.SSS2.p1.7.m7.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.7.m7.1c">\lambda^{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.7.m7.1d">italic_λ start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math> with the unchanged part of <math id="S3.SS2.SSS2.p1.8.m8.1" class="ltx_Math" alttext="y^{t}" display="inline"><semantics id="S3.SS2.SSS2.p1.8.m8.1a"><msup id="S3.SS2.SSS2.p1.8.m8.1.1" xref="S3.SS2.SSS2.p1.8.m8.1.1.cmml"><mi id="S3.SS2.SSS2.p1.8.m8.1.1.2" xref="S3.SS2.SSS2.p1.8.m8.1.1.2.cmml">y</mi><mi id="S3.SS2.SSS2.p1.8.m8.1.1.3" xref="S3.SS2.SSS2.p1.8.m8.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.8.m8.1b"><apply id="S3.SS2.SSS2.p1.8.m8.1.1.cmml" xref="S3.SS2.SSS2.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.8.m8.1.1.1.cmml" xref="S3.SS2.SSS2.p1.8.m8.1.1">superscript</csymbol><ci id="S3.SS2.SSS2.p1.8.m8.1.1.2.cmml" xref="S3.SS2.SSS2.p1.8.m8.1.1.2">𝑦</ci><ci id="S3.SS2.SSS2.p1.8.m8.1.1.3.cmml" xref="S3.SS2.SSS2.p1.8.m8.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.8.m8.1c">y^{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.8.m8.1d">italic_y start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math>, forming the inputs of <span id="S3.SS2.SSS2.p1.10.1" class="ltx_text ltx_font_italic">st-networks</span> in each coupling layer (see figure <a href="#S3.F2" title="Figure 2 ‣ III-B Timestamp-level Anomaly Detection ‣ III Methodology ‣ Generative Anomaly Detection for Time Series Datasets" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>). During the transformations, we use binary mask vectors to extract the changed and unchanged dimensions in <math id="S3.SS2.SSS2.p1.9.m9.1" class="ltx_Math" alttext="y^{t}" display="inline"><semantics id="S3.SS2.SSS2.p1.9.m9.1a"><msup id="S3.SS2.SSS2.p1.9.m9.1.1" xref="S3.SS2.SSS2.p1.9.m9.1.1.cmml"><mi id="S3.SS2.SSS2.p1.9.m9.1.1.2" xref="S3.SS2.SSS2.p1.9.m9.1.1.2.cmml">y</mi><mi id="S3.SS2.SSS2.p1.9.m9.1.1.3" xref="S3.SS2.SSS2.p1.9.m9.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.9.m9.1b"><apply id="S3.SS2.SSS2.p1.9.m9.1.1.cmml" xref="S3.SS2.SSS2.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.9.m9.1.1.1.cmml" xref="S3.SS2.SSS2.p1.9.m9.1.1">superscript</csymbol><ci id="S3.SS2.SSS2.p1.9.m9.1.1.2.cmml" xref="S3.SS2.SSS2.p1.9.m9.1.1.2">𝑦</ci><ci id="S3.SS2.SSS2.p1.9.m9.1.1.3.cmml" xref="S3.SS2.SSS2.p1.9.m9.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.9.m9.1c">y^{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.9.m9.1d">italic_y start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math>, where the unchanged dimensions are multiplied by ones and the other dimensions are multiplied by zeros. Note that the outputs of <span id="S3.SS2.SSS2.p1.10.2" class="ltx_text ltx_font_italic">st-networks</span> preserve the dimensions of <math id="S3.SS2.SSS2.p1.10.m10.1" class="ltx_Math" alttext="d+1:D" display="inline"><semantics id="S3.SS2.SSS2.p1.10.m10.1a"><mrow id="S3.SS2.SSS2.p1.10.m10.1.1" xref="S3.SS2.SSS2.p1.10.m10.1.1.cmml"><mrow id="S3.SS2.SSS2.p1.10.m10.1.1.2" xref="S3.SS2.SSS2.p1.10.m10.1.1.2.cmml"><mi id="S3.SS2.SSS2.p1.10.m10.1.1.2.2" xref="S3.SS2.SSS2.p1.10.m10.1.1.2.2.cmml">d</mi><mo id="S3.SS2.SSS2.p1.10.m10.1.1.2.1" xref="S3.SS2.SSS2.p1.10.m10.1.1.2.1.cmml">+</mo><mn id="S3.SS2.SSS2.p1.10.m10.1.1.2.3" xref="S3.SS2.SSS2.p1.10.m10.1.1.2.3.cmml">1</mn></mrow><mo lspace="0.278em" rspace="0.278em" id="S3.SS2.SSS2.p1.10.m10.1.1.1" xref="S3.SS2.SSS2.p1.10.m10.1.1.1.cmml">:</mo><mi id="S3.SS2.SSS2.p1.10.m10.1.1.3" xref="S3.SS2.SSS2.p1.10.m10.1.1.3.cmml">D</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.10.m10.1b"><apply id="S3.SS2.SSS2.p1.10.m10.1.1.cmml" xref="S3.SS2.SSS2.p1.10.m10.1.1"><ci id="S3.SS2.SSS2.p1.10.m10.1.1.1.cmml" xref="S3.SS2.SSS2.p1.10.m10.1.1.1">:</ci><apply id="S3.SS2.SSS2.p1.10.m10.1.1.2.cmml" xref="S3.SS2.SSS2.p1.10.m10.1.1.2"><plus id="S3.SS2.SSS2.p1.10.m10.1.1.2.1.cmml" xref="S3.SS2.SSS2.p1.10.m10.1.1.2.1"></plus><ci id="S3.SS2.SSS2.p1.10.m10.1.1.2.2.cmml" xref="S3.SS2.SSS2.p1.10.m10.1.1.2.2">𝑑</ci><cn type="integer" id="S3.SS2.SSS2.p1.10.m10.1.1.2.3.cmml" xref="S3.SS2.SSS2.p1.10.m10.1.1.2.3">1</cn></apply><ci id="S3.SS2.SSS2.p1.10.m10.1.1.3.cmml" xref="S3.SS2.SSS2.p1.10.m10.1.1.3">𝐷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.10.m10.1c">d+1:D</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.10.m10.1d">italic_d + 1 : italic_D</annotation></semantics></math> using the inverse mask vector so that we can compute corresponding values smoothly.</p>
</div>
<div id="S3.SS2.SSS2.p2" class="ltx_para">
<p id="S3.SS2.SSS2.p2.1" class="ltx_p">We stack <math id="S3.SS2.SSS2.p2.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS2.SSS2.p2.1.m1.1a"><mi id="S3.SS2.SSS2.p2.1.m1.1.1" xref="S3.SS2.SSS2.p2.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p2.1.m1.1b"><ci id="S3.SS2.SSS2.p2.1.m1.1.1.cmml" xref="S3.SS2.SSS2.p2.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p2.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p2.1.m1.1d">italic_K</annotation></semantics></math> coupling layers to ensure the flow models can perform adequate changeovers when modeling complicated distributions, corresponding to the second term in equation <a href="#S2.E3" title="3 ‣ II-B RealNVP ‣ II Background ‣ Generative Anomaly Detection for Time Series Datasets" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>. We also place a bijective batch normalization (BN) layer after every coupling layer. Our design is motivated by prior work by Dinh et.al <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>, who use BN layers to stabilize the training process. As the BN layer is essentially a linear function, it is invertible and the computation of the Jacobian is efficient.</p>
</div>
</section>
<section id="S3.SS2.SSS3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S3.SS2.SSS3.5.1.1" class="ltx_text">III-B</span>3 </span>Training and Inference</h4>

<div id="S3.SS2.SSS3.p1" class="ltx_para">
<p id="S3.SS2.SSS3.p1.1" class="ltx_p">The flow and encoder-decoder models are trained together via minimizing the below loss function with the Adam <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite> optimizer. Given a batch of sliding windows <math id="S3.SS2.SSS3.p1.1.m1.1" class="ltx_Math" alttext="B" display="inline"><semantics id="S3.SS2.SSS3.p1.1.m1.1a"><mi id="S3.SS2.SSS3.p1.1.m1.1.1" xref="S3.SS2.SSS3.p1.1.m1.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p1.1.m1.1b"><ci id="S3.SS2.SSS3.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS3.p1.1.m1.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p1.1.m1.1c">B</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS3.p1.1.m1.1d">italic_B</annotation></semantics></math>, according to the optimization objective <a href="#S2.E3" title="3 ‣ II-B RealNVP ‣ II Background ‣ Generative Anomaly Detection for Time Series Datasets" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> and equation <a href="#S3.E6" title="6 ‣ III-B1 LSTM Encoder-Decoder ‣ III-B Timestamp-level Anomaly Detection ‣ III Methodology ‣ Generative Anomaly Detection for Time Series Datasets" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>, the loss function is parameterized as:</p>
</div>
<div id="S3.SS2.SSS3.p2" class="ltx_para">
<table id="S3.E7" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E7.m1.4" class="ltx_Math" alttext="\mathcal{L}=-\frac{1}{|B|\cdot(\tau-t_{0}+1)}\sum_{x^{t_{0}:\tau}\in B}\sum_{t=t_{0}}^{\tau}\log{p_{X}}(x^{t}|h^{t},\lambda^{t};\theta)" display="block"><semantics id="S3.E7.m1.4a"><mrow id="S3.E7.m1.4.4" xref="S3.E7.m1.4.4.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S3.E7.m1.4.4.3" xref="S3.E7.m1.4.4.3.cmml">ℒ</mi><mo mathsize="90%" id="S3.E7.m1.4.4.2" xref="S3.E7.m1.4.4.2.cmml">=</mo><mrow id="S3.E7.m1.4.4.1" xref="S3.E7.m1.4.4.1.cmml"><mo mathsize="90%" id="S3.E7.m1.4.4.1a" xref="S3.E7.m1.4.4.1.cmml">−</mo><mrow id="S3.E7.m1.4.4.1.1" xref="S3.E7.m1.4.4.1.1.cmml"><mfrac id="S3.E7.m1.2.2" xref="S3.E7.m1.2.2.cmml"><mn mathsize="90%" id="S3.E7.m1.2.2.4" xref="S3.E7.m1.2.2.4.cmml">1</mn><mrow id="S3.E7.m1.2.2.2" xref="S3.E7.m1.2.2.2.cmml"><mrow id="S3.E7.m1.2.2.2.4.2" xref="S3.E7.m1.2.2.2.4.1.cmml"><mo maxsize="90%" minsize="90%" id="S3.E7.m1.2.2.2.4.2.1" xref="S3.E7.m1.2.2.2.4.1.1.cmml">|</mo><mi mathsize="90%" id="S3.E7.m1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.cmml">B</mi><mo maxsize="90%" minsize="90%" rspace="0.055em" id="S3.E7.m1.2.2.2.4.2.2" xref="S3.E7.m1.2.2.2.4.1.1.cmml">|</mo></mrow><mo mathsize="90%" rspace="0.222em" id="S3.E7.m1.2.2.2.3" xref="S3.E7.m1.2.2.2.3.cmml">⋅</mo><mrow id="S3.E7.m1.2.2.2.2.1" xref="S3.E7.m1.2.2.2.2.1.1.cmml"><mo maxsize="90%" minsize="90%" id="S3.E7.m1.2.2.2.2.1.2" xref="S3.E7.m1.2.2.2.2.1.1.cmml">(</mo><mrow id="S3.E7.m1.2.2.2.2.1.1" xref="S3.E7.m1.2.2.2.2.1.1.cmml"><mrow id="S3.E7.m1.2.2.2.2.1.1.2" xref="S3.E7.m1.2.2.2.2.1.1.2.cmml"><mi mathsize="90%" id="S3.E7.m1.2.2.2.2.1.1.2.2" xref="S3.E7.m1.2.2.2.2.1.1.2.2.cmml">τ</mi><mo mathsize="90%" id="S3.E7.m1.2.2.2.2.1.1.2.1" xref="S3.E7.m1.2.2.2.2.1.1.2.1.cmml">−</mo><msub id="S3.E7.m1.2.2.2.2.1.1.2.3" xref="S3.E7.m1.2.2.2.2.1.1.2.3.cmml"><mi mathsize="90%" id="S3.E7.m1.2.2.2.2.1.1.2.3.2" xref="S3.E7.m1.2.2.2.2.1.1.2.3.2.cmml">t</mi><mn mathsize="90%" id="S3.E7.m1.2.2.2.2.1.1.2.3.3" xref="S3.E7.m1.2.2.2.2.1.1.2.3.3.cmml">0</mn></msub></mrow><mo mathsize="90%" id="S3.E7.m1.2.2.2.2.1.1.1" xref="S3.E7.m1.2.2.2.2.1.1.1.cmml">+</mo><mn mathsize="90%" id="S3.E7.m1.2.2.2.2.1.1.3" xref="S3.E7.m1.2.2.2.2.1.1.3.cmml">1</mn></mrow><mo maxsize="90%" minsize="90%" id="S3.E7.m1.2.2.2.2.1.3" xref="S3.E7.m1.2.2.2.2.1.1.cmml">)</mo></mrow></mrow></mfrac><mo id="S3.E7.m1.4.4.1.1.2" xref="S3.E7.m1.4.4.1.1.2.cmml">⁢</mo><mrow id="S3.E7.m1.4.4.1.1.1" xref="S3.E7.m1.4.4.1.1.1.cmml"><munder id="S3.E7.m1.4.4.1.1.1.2" xref="S3.E7.m1.4.4.1.1.1.2.cmml"><mo maxsize="90%" minsize="90%" movablelimits="false" rspace="0em" stretchy="true" id="S3.E7.m1.4.4.1.1.1.2.2" xref="S3.E7.m1.4.4.1.1.1.2.2.cmml">∑</mo><mrow id="S3.E7.m1.4.4.1.1.1.2.3" xref="S3.E7.m1.4.4.1.1.1.2.3.cmml"><msup id="S3.E7.m1.4.4.1.1.1.2.3.2" xref="S3.E7.m1.4.4.1.1.1.2.3.2.cmml"><mi mathsize="90%" id="S3.E7.m1.4.4.1.1.1.2.3.2.2" xref="S3.E7.m1.4.4.1.1.1.2.3.2.2.cmml">x</mi><mrow id="S3.E7.m1.4.4.1.1.1.2.3.2.3" xref="S3.E7.m1.4.4.1.1.1.2.3.2.3.cmml"><msub id="S3.E7.m1.4.4.1.1.1.2.3.2.3.2" xref="S3.E7.m1.4.4.1.1.1.2.3.2.3.2.cmml"><mi mathsize="90%" id="S3.E7.m1.4.4.1.1.1.2.3.2.3.2.2" xref="S3.E7.m1.4.4.1.1.1.2.3.2.3.2.2.cmml">t</mi><mn mathsize="90%" id="S3.E7.m1.4.4.1.1.1.2.3.2.3.2.3" xref="S3.E7.m1.4.4.1.1.1.2.3.2.3.2.3.cmml">0</mn></msub><mo lspace="0.278em" mathsize="90%" rspace="0.278em" id="S3.E7.m1.4.4.1.1.1.2.3.2.3.1" xref="S3.E7.m1.4.4.1.1.1.2.3.2.3.1.cmml">:</mo><mi mathsize="90%" id="S3.E7.m1.4.4.1.1.1.2.3.2.3.3" xref="S3.E7.m1.4.4.1.1.1.2.3.2.3.3.cmml">τ</mi></mrow></msup><mo mathsize="90%" id="S3.E7.m1.4.4.1.1.1.2.3.1" xref="S3.E7.m1.4.4.1.1.1.2.3.1.cmml">∈</mo><mi mathsize="90%" id="S3.E7.m1.4.4.1.1.1.2.3.3" xref="S3.E7.m1.4.4.1.1.1.2.3.3.cmml">B</mi></mrow></munder><mrow id="S3.E7.m1.4.4.1.1.1.1" xref="S3.E7.m1.4.4.1.1.1.1.cmml"><munderover id="S3.E7.m1.4.4.1.1.1.1.2" xref="S3.E7.m1.4.4.1.1.1.1.2.cmml"><mo maxsize="90%" minsize="90%" movablelimits="false" stretchy="true" id="S3.E7.m1.4.4.1.1.1.1.2.2.2" xref="S3.E7.m1.4.4.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E7.m1.4.4.1.1.1.1.2.2.3" xref="S3.E7.m1.4.4.1.1.1.1.2.2.3.cmml"><mi mathsize="90%" id="S3.E7.m1.4.4.1.1.1.1.2.2.3.2" xref="S3.E7.m1.4.4.1.1.1.1.2.2.3.2.cmml">t</mi><mo mathsize="90%" id="S3.E7.m1.4.4.1.1.1.1.2.2.3.1" xref="S3.E7.m1.4.4.1.1.1.1.2.2.3.1.cmml">=</mo><msub id="S3.E7.m1.4.4.1.1.1.1.2.2.3.3" xref="S3.E7.m1.4.4.1.1.1.1.2.2.3.3.cmml"><mi mathsize="90%" id="S3.E7.m1.4.4.1.1.1.1.2.2.3.3.2" xref="S3.E7.m1.4.4.1.1.1.1.2.2.3.3.2.cmml">t</mi><mn mathsize="90%" id="S3.E7.m1.4.4.1.1.1.1.2.2.3.3.3" xref="S3.E7.m1.4.4.1.1.1.1.2.2.3.3.3.cmml">0</mn></msub></mrow><mi mathsize="90%" id="S3.E7.m1.4.4.1.1.1.1.2.3" xref="S3.E7.m1.4.4.1.1.1.1.2.3.cmml">τ</mi></munderover><mrow id="S3.E7.m1.4.4.1.1.1.1.1" xref="S3.E7.m1.4.4.1.1.1.1.1.cmml"><mrow id="S3.E7.m1.4.4.1.1.1.1.1.3" xref="S3.E7.m1.4.4.1.1.1.1.1.3.cmml"><mi mathsize="90%" id="S3.E7.m1.4.4.1.1.1.1.1.3.1" xref="S3.E7.m1.4.4.1.1.1.1.1.3.1.cmml">log</mi><mo lspace="0.167em" id="S3.E7.m1.4.4.1.1.1.1.1.3a" xref="S3.E7.m1.4.4.1.1.1.1.1.3.cmml">⁡</mo><msub id="S3.E7.m1.4.4.1.1.1.1.1.3.2" xref="S3.E7.m1.4.4.1.1.1.1.1.3.2.cmml"><mi mathsize="90%" id="S3.E7.m1.4.4.1.1.1.1.1.3.2.2" xref="S3.E7.m1.4.4.1.1.1.1.1.3.2.2.cmml">p</mi><mi mathsize="90%" id="S3.E7.m1.4.4.1.1.1.1.1.3.2.3" xref="S3.E7.m1.4.4.1.1.1.1.1.3.2.3.cmml">X</mi></msub></mrow><mo id="S3.E7.m1.4.4.1.1.1.1.1.2" xref="S3.E7.m1.4.4.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E7.m1.4.4.1.1.1.1.1.1.1" xref="S3.E7.m1.4.4.1.1.1.1.1.1.1.1.cmml"><mo maxsize="90%" minsize="90%" id="S3.E7.m1.4.4.1.1.1.1.1.1.1.2" xref="S3.E7.m1.4.4.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E7.m1.4.4.1.1.1.1.1.1.1.1" xref="S3.E7.m1.4.4.1.1.1.1.1.1.1.1.cmml"><msup id="S3.E7.m1.4.4.1.1.1.1.1.1.1.1.4" xref="S3.E7.m1.4.4.1.1.1.1.1.1.1.1.4.cmml"><mi mathsize="90%" id="S3.E7.m1.4.4.1.1.1.1.1.1.1.1.4.2" xref="S3.E7.m1.4.4.1.1.1.1.1.1.1.1.4.2.cmml">x</mi><mi mathsize="90%" id="S3.E7.m1.4.4.1.1.1.1.1.1.1.1.4.3" xref="S3.E7.m1.4.4.1.1.1.1.1.1.1.1.4.3.cmml">t</mi></msup><mo fence="false" mathsize="90%" id="S3.E7.m1.4.4.1.1.1.1.1.1.1.1.3" xref="S3.E7.m1.4.4.1.1.1.1.1.1.1.1.3.cmml">|</mo><mrow id="S3.E7.m1.4.4.1.1.1.1.1.1.1.1.2.2" xref="S3.E7.m1.4.4.1.1.1.1.1.1.1.1.2.3.cmml"><msup id="S3.E7.m1.4.4.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E7.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi mathsize="90%" id="S3.E7.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E7.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.cmml">h</mi><mi mathsize="90%" id="S3.E7.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E7.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msup><mo mathsize="90%" id="S3.E7.m1.4.4.1.1.1.1.1.1.1.1.2.2.3" xref="S3.E7.m1.4.4.1.1.1.1.1.1.1.1.2.3.cmml">,</mo><msup id="S3.E7.m1.4.4.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E7.m1.4.4.1.1.1.1.1.1.1.1.2.2.2.cmml"><mi mathsize="90%" id="S3.E7.m1.4.4.1.1.1.1.1.1.1.1.2.2.2.2" xref="S3.E7.m1.4.4.1.1.1.1.1.1.1.1.2.2.2.2.cmml">λ</mi><mi mathsize="90%" id="S3.E7.m1.4.4.1.1.1.1.1.1.1.1.2.2.2.3" xref="S3.E7.m1.4.4.1.1.1.1.1.1.1.1.2.2.2.3.cmml">t</mi></msup><mo mathsize="90%" id="S3.E7.m1.4.4.1.1.1.1.1.1.1.1.2.2.4" xref="S3.E7.m1.4.4.1.1.1.1.1.1.1.1.2.3.cmml">;</mo><mi mathsize="90%" id="S3.E7.m1.3.3" xref="S3.E7.m1.3.3.cmml">θ</mi></mrow></mrow><mo maxsize="90%" minsize="90%" id="S3.E7.m1.4.4.1.1.1.1.1.1.1.3" xref="S3.E7.m1.4.4.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.4b"><apply id="S3.E7.m1.4.4.cmml" xref="S3.E7.m1.4.4"><eq id="S3.E7.m1.4.4.2.cmml" xref="S3.E7.m1.4.4.2"></eq><ci id="S3.E7.m1.4.4.3.cmml" xref="S3.E7.m1.4.4.3">ℒ</ci><apply id="S3.E7.m1.4.4.1.cmml" xref="S3.E7.m1.4.4.1"><minus id="S3.E7.m1.4.4.1.2.cmml" xref="S3.E7.m1.4.4.1"></minus><apply id="S3.E7.m1.4.4.1.1.cmml" xref="S3.E7.m1.4.4.1.1"><times id="S3.E7.m1.4.4.1.1.2.cmml" xref="S3.E7.m1.4.4.1.1.2"></times><apply id="S3.E7.m1.2.2.cmml" xref="S3.E7.m1.2.2"><divide id="S3.E7.m1.2.2.3.cmml" xref="S3.E7.m1.2.2"></divide><cn type="integer" id="S3.E7.m1.2.2.4.cmml" xref="S3.E7.m1.2.2.4">1</cn><apply id="S3.E7.m1.2.2.2.cmml" xref="S3.E7.m1.2.2.2"><ci id="S3.E7.m1.2.2.2.3.cmml" xref="S3.E7.m1.2.2.2.3">⋅</ci><apply id="S3.E7.m1.2.2.2.4.1.cmml" xref="S3.E7.m1.2.2.2.4.2"><abs id="S3.E7.m1.2.2.2.4.1.1.cmml" xref="S3.E7.m1.2.2.2.4.2.1"></abs><ci id="S3.E7.m1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1">𝐵</ci></apply><apply id="S3.E7.m1.2.2.2.2.1.1.cmml" xref="S3.E7.m1.2.2.2.2.1"><plus id="S3.E7.m1.2.2.2.2.1.1.1.cmml" xref="S3.E7.m1.2.2.2.2.1.1.1"></plus><apply id="S3.E7.m1.2.2.2.2.1.1.2.cmml" xref="S3.E7.m1.2.2.2.2.1.1.2"><minus id="S3.E7.m1.2.2.2.2.1.1.2.1.cmml" xref="S3.E7.m1.2.2.2.2.1.1.2.1"></minus><ci id="S3.E7.m1.2.2.2.2.1.1.2.2.cmml" xref="S3.E7.m1.2.2.2.2.1.1.2.2">𝜏</ci><apply id="S3.E7.m1.2.2.2.2.1.1.2.3.cmml" xref="S3.E7.m1.2.2.2.2.1.1.2.3"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.2.2.1.1.2.3.1.cmml" xref="S3.E7.m1.2.2.2.2.1.1.2.3">subscript</csymbol><ci id="S3.E7.m1.2.2.2.2.1.1.2.3.2.cmml" xref="S3.E7.m1.2.2.2.2.1.1.2.3.2">𝑡</ci><cn type="integer" id="S3.E7.m1.2.2.2.2.1.1.2.3.3.cmml" xref="S3.E7.m1.2.2.2.2.1.1.2.3.3">0</cn></apply></apply><cn type="integer" id="S3.E7.m1.2.2.2.2.1.1.3.cmml" xref="S3.E7.m1.2.2.2.2.1.1.3">1</cn></apply></apply></apply><apply id="S3.E7.m1.4.4.1.1.1.cmml" xref="S3.E7.m1.4.4.1.1.1"><apply id="S3.E7.m1.4.4.1.1.1.2.cmml" xref="S3.E7.m1.4.4.1.1.1.2"><csymbol cd="ambiguous" id="S3.E7.m1.4.4.1.1.1.2.1.cmml" xref="S3.E7.m1.4.4.1.1.1.2">subscript</csymbol><sum id="S3.E7.m1.4.4.1.1.1.2.2.cmml" xref="S3.E7.m1.4.4.1.1.1.2.2"></sum><apply id="S3.E7.m1.4.4.1.1.1.2.3.cmml" xref="S3.E7.m1.4.4.1.1.1.2.3"><in id="S3.E7.m1.4.4.1.1.1.2.3.1.cmml" xref="S3.E7.m1.4.4.1.1.1.2.3.1"></in><apply id="S3.E7.m1.4.4.1.1.1.2.3.2.cmml" xref="S3.E7.m1.4.4.1.1.1.2.3.2"><csymbol cd="ambiguous" id="S3.E7.m1.4.4.1.1.1.2.3.2.1.cmml" xref="S3.E7.m1.4.4.1.1.1.2.3.2">superscript</csymbol><ci id="S3.E7.m1.4.4.1.1.1.2.3.2.2.cmml" xref="S3.E7.m1.4.4.1.1.1.2.3.2.2">𝑥</ci><apply id="S3.E7.m1.4.4.1.1.1.2.3.2.3.cmml" xref="S3.E7.m1.4.4.1.1.1.2.3.2.3"><ci id="S3.E7.m1.4.4.1.1.1.2.3.2.3.1.cmml" xref="S3.E7.m1.4.4.1.1.1.2.3.2.3.1">:</ci><apply id="S3.E7.m1.4.4.1.1.1.2.3.2.3.2.cmml" xref="S3.E7.m1.4.4.1.1.1.2.3.2.3.2"><csymbol cd="ambiguous" id="S3.E7.m1.4.4.1.1.1.2.3.2.3.2.1.cmml" xref="S3.E7.m1.4.4.1.1.1.2.3.2.3.2">subscript</csymbol><ci id="S3.E7.m1.4.4.1.1.1.2.3.2.3.2.2.cmml" xref="S3.E7.m1.4.4.1.1.1.2.3.2.3.2.2">𝑡</ci><cn type="integer" id="S3.E7.m1.4.4.1.1.1.2.3.2.3.2.3.cmml" xref="S3.E7.m1.4.4.1.1.1.2.3.2.3.2.3">0</cn></apply><ci id="S3.E7.m1.4.4.1.1.1.2.3.2.3.3.cmml" xref="S3.E7.m1.4.4.1.1.1.2.3.2.3.3">𝜏</ci></apply></apply><ci id="S3.E7.m1.4.4.1.1.1.2.3.3.cmml" xref="S3.E7.m1.4.4.1.1.1.2.3.3">𝐵</ci></apply></apply><apply id="S3.E7.m1.4.4.1.1.1.1.cmml" xref="S3.E7.m1.4.4.1.1.1.1"><apply id="S3.E7.m1.4.4.1.1.1.1.2.cmml" xref="S3.E7.m1.4.4.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E7.m1.4.4.1.1.1.1.2.1.cmml" xref="S3.E7.m1.4.4.1.1.1.1.2">superscript</csymbol><apply id="S3.E7.m1.4.4.1.1.1.1.2.2.cmml" xref="S3.E7.m1.4.4.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E7.m1.4.4.1.1.1.1.2.2.1.cmml" xref="S3.E7.m1.4.4.1.1.1.1.2">subscript</csymbol><sum id="S3.E7.m1.4.4.1.1.1.1.2.2.2.cmml" xref="S3.E7.m1.4.4.1.1.1.1.2.2.2"></sum><apply id="S3.E7.m1.4.4.1.1.1.1.2.2.3.cmml" xref="S3.E7.m1.4.4.1.1.1.1.2.2.3"><eq id="S3.E7.m1.4.4.1.1.1.1.2.2.3.1.cmml" xref="S3.E7.m1.4.4.1.1.1.1.2.2.3.1"></eq><ci id="S3.E7.m1.4.4.1.1.1.1.2.2.3.2.cmml" xref="S3.E7.m1.4.4.1.1.1.1.2.2.3.2">𝑡</ci><apply id="S3.E7.m1.4.4.1.1.1.1.2.2.3.3.cmml" xref="S3.E7.m1.4.4.1.1.1.1.2.2.3.3"><csymbol cd="ambiguous" id="S3.E7.m1.4.4.1.1.1.1.2.2.3.3.1.cmml" xref="S3.E7.m1.4.4.1.1.1.1.2.2.3.3">subscript</csymbol><ci id="S3.E7.m1.4.4.1.1.1.1.2.2.3.3.2.cmml" xref="S3.E7.m1.4.4.1.1.1.1.2.2.3.3.2">𝑡</ci><cn type="integer" id="S3.E7.m1.4.4.1.1.1.1.2.2.3.3.3.cmml" xref="S3.E7.m1.4.4.1.1.1.1.2.2.3.3.3">0</cn></apply></apply></apply><ci id="S3.E7.m1.4.4.1.1.1.1.2.3.cmml" xref="S3.E7.m1.4.4.1.1.1.1.2.3">𝜏</ci></apply><apply id="S3.E7.m1.4.4.1.1.1.1.1.cmml" xref="S3.E7.m1.4.4.1.1.1.1.1"><times id="S3.E7.m1.4.4.1.1.1.1.1.2.cmml" xref="S3.E7.m1.4.4.1.1.1.1.1.2"></times><apply id="S3.E7.m1.4.4.1.1.1.1.1.3.cmml" xref="S3.E7.m1.4.4.1.1.1.1.1.3"><log id="S3.E7.m1.4.4.1.1.1.1.1.3.1.cmml" xref="S3.E7.m1.4.4.1.1.1.1.1.3.1"></log><apply id="S3.E7.m1.4.4.1.1.1.1.1.3.2.cmml" xref="S3.E7.m1.4.4.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E7.m1.4.4.1.1.1.1.1.3.2.1.cmml" xref="S3.E7.m1.4.4.1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E7.m1.4.4.1.1.1.1.1.3.2.2.cmml" xref="S3.E7.m1.4.4.1.1.1.1.1.3.2.2">𝑝</ci><ci id="S3.E7.m1.4.4.1.1.1.1.1.3.2.3.cmml" xref="S3.E7.m1.4.4.1.1.1.1.1.3.2.3">𝑋</ci></apply></apply><apply id="S3.E7.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.4.4.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E7.m1.4.4.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.4.4.1.1.1.1.1.1.1.1.3">conditional</csymbol><apply id="S3.E7.m1.4.4.1.1.1.1.1.1.1.1.4.cmml" xref="S3.E7.m1.4.4.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E7.m1.4.4.1.1.1.1.1.1.1.1.4.1.cmml" xref="S3.E7.m1.4.4.1.1.1.1.1.1.1.1.4">superscript</csymbol><ci id="S3.E7.m1.4.4.1.1.1.1.1.1.1.1.4.2.cmml" xref="S3.E7.m1.4.4.1.1.1.1.1.1.1.1.4.2">𝑥</ci><ci id="S3.E7.m1.4.4.1.1.1.1.1.1.1.1.4.3.cmml" xref="S3.E7.m1.4.4.1.1.1.1.1.1.1.1.4.3">𝑡</ci></apply><list id="S3.E7.m1.4.4.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E7.m1.4.4.1.1.1.1.1.1.1.1.2.2"><apply id="S3.E7.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.4.4.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.4.4.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E7.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2">ℎ</ci><ci id="S3.E7.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S3.E7.m1.4.4.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E7.m1.4.4.1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E7.m1.4.4.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E7.m1.4.4.1.1.1.1.1.1.1.1.2.2.2">superscript</csymbol><ci id="S3.E7.m1.4.4.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E7.m1.4.4.1.1.1.1.1.1.1.1.2.2.2.2">𝜆</ci><ci id="S3.E7.m1.4.4.1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E7.m1.4.4.1.1.1.1.1.1.1.1.2.2.2.3">𝑡</ci></apply><ci id="S3.E7.m1.3.3.cmml" xref="S3.E7.m1.3.3">𝜃</ci></list></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.4c">\mathcal{L}=-\frac{1}{|B|\cdot(\tau-t_{0}+1)}\sum_{x^{t_{0}:\tau}\in B}\sum_{t=t_{0}}^{\tau}\log{p_{X}}(x^{t}|h^{t},\lambda^{t};\theta)</annotation><annotation encoding="application/x-llamapun" id="S3.E7.m1.4d">caligraphic_L = - divide start_ARG 1 end_ARG start_ARG | italic_B | ⋅ ( italic_τ - italic_t start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT + 1 ) end_ARG ∑ start_POSTSUBSCRIPT italic_x start_POSTSUPERSCRIPT italic_t start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT : italic_τ end_POSTSUPERSCRIPT ∈ italic_B end_POSTSUBSCRIPT ∑ start_POSTSUBSCRIPT italic_t = italic_t start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_τ end_POSTSUPERSCRIPT roman_log italic_p start_POSTSUBSCRIPT italic_X end_POSTSUBSCRIPT ( italic_x start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT | italic_h start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT , italic_λ start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT ; italic_θ )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.SSS3.p2.1" class="ltx_p">where <math id="S3.SS2.SSS3.p2.1.m1.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S3.SS2.SSS3.p2.1.m1.1a"><mi id="S3.SS2.SSS3.p2.1.m1.1.1" xref="S3.SS2.SSS3.p2.1.m1.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p2.1.m1.1b"><ci id="S3.SS2.SSS3.p2.1.m1.1.1.cmml" xref="S3.SS2.SSS3.p2.1.m1.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p2.1.m1.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS3.p2.1.m1.1d">italic_θ</annotation></semantics></math> denotes all trainable parameters in the workflow.</p>
</div>
<div id="S3.SS2.SSS3.p3" class="ltx_para">
<p id="S3.SS2.SSS3.p3.2" class="ltx_p">During inference, the procedure of anomaly detection is straightforward and computationally efficient after training. Given a sample <math id="S3.SS2.SSS3.p3.1.m1.1" class="ltx_Math" alttext="x^{t}" display="inline"><semantics id="S3.SS2.SSS3.p3.1.m1.1a"><msup id="S3.SS2.SSS3.p3.1.m1.1.1" xref="S3.SS2.SSS3.p3.1.m1.1.1.cmml"><mi id="S3.SS2.SSS3.p3.1.m1.1.1.2" xref="S3.SS2.SSS3.p3.1.m1.1.1.2.cmml">x</mi><mi id="S3.SS2.SSS3.p3.1.m1.1.1.3" xref="S3.SS2.SSS3.p3.1.m1.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p3.1.m1.1b"><apply id="S3.SS2.SSS3.p3.1.m1.1.1.cmml" xref="S3.SS2.SSS3.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p3.1.m1.1.1.1.cmml" xref="S3.SS2.SSS3.p3.1.m1.1.1">superscript</csymbol><ci id="S3.SS2.SSS3.p3.1.m1.1.1.2.cmml" xref="S3.SS2.SSS3.p3.1.m1.1.1.2">𝑥</ci><ci id="S3.SS2.SSS3.p3.1.m1.1.1.3.cmml" xref="S3.SS2.SSS3.p3.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p3.1.m1.1c">x^{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS3.p3.1.m1.1d">italic_x start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math>, we use the trained network to perform density estimation, and flag the point as an anomaly based on a exogenous threshold <math id="S3.SS2.SSS3.p3.2.m2.1" class="ltx_Math" alttext="\epsilon" display="inline"><semantics id="S3.SS2.SSS3.p3.2.m2.1a"><mi id="S3.SS2.SSS3.p3.2.m2.1.1" xref="S3.SS2.SSS3.p3.2.m2.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p3.2.m2.1b"><ci id="S3.SS2.SSS3.p3.2.m2.1.1.cmml" xref="S3.SS2.SSS3.p3.2.m2.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p3.2.m2.1c">\epsilon</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS3.p3.2.m2.1d">italic_ϵ</annotation></semantics></math>.</p>
</div>
</section>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS3.5.1.1" class="ltx_text">III-C</span> </span><span id="S3.SS3.6.2" class="ltx_text ltx_font_italic">Segment-level Anomaly Diagnosis</span>
</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.8" class="ltx_p">We now have a general architecture that can detect anomalies from real-time congestion data. However, note that an anomalous data point <math id="S3.SS3.p1.1.m1.1" class="ltx_Math" alttext="x^{t}" display="inline"><semantics id="S3.SS3.p1.1.m1.1a"><msup id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml"><mi id="S3.SS3.p1.1.m1.1.1.2" xref="S3.SS3.p1.1.m1.1.1.2.cmml">x</mi><mi id="S3.SS3.p1.1.m1.1.1.3" xref="S3.SS3.p1.1.m1.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><apply id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1">superscript</csymbol><ci id="S3.SS3.p1.1.m1.1.1.2.cmml" xref="S3.SS3.p1.1.m1.1.1.2">𝑥</ci><ci id="S3.SS3.p1.1.m1.1.1.3.cmml" xref="S3.SS3.p1.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">x^{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.1.m1.1d">italic_x start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math> (say) consists of <math id="S3.SS3.p1.2.m2.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S3.SS3.p1.2.m2.1a"><mi id="S3.SS3.p1.2.m2.1.1" xref="S3.SS3.p1.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.1b"><ci id="S3.SS3.p1.2.m2.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.1c">N</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.2.m2.1d">italic_N</annotation></semantics></math> dimensions, where each dimension corresponds to a road segment. This detection does not fully solve our problem; recall that our goal is to enable TMC operators focus their attention (e.g., secondary inspection of cameras and resource allocation) to a small subset of segments. However, <math id="S3.SS3.p1.3.m3.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S3.SS3.p1.3.m3.1a"><mi id="S3.SS3.p1.3.m3.1.1" xref="S3.SS3.p1.3.m3.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.3.m3.1b"><ci id="S3.SS3.p1.3.m3.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.3.m3.1c">N</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.3.m3.1d">italic_N</annotation></semantics></math> can still be large in practice. Now, given an anomalous time vector <math id="S3.SS3.p1.4.m4.1" class="ltx_Math" alttext="x^{t}" display="inline"><semantics id="S3.SS3.p1.4.m4.1a"><msup id="S3.SS3.p1.4.m4.1.1" xref="S3.SS3.p1.4.m4.1.1.cmml"><mi id="S3.SS3.p1.4.m4.1.1.2" xref="S3.SS3.p1.4.m4.1.1.2.cmml">x</mi><mi id="S3.SS3.p1.4.m4.1.1.3" xref="S3.SS3.p1.4.m4.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.4.m4.1b"><apply id="S3.SS3.p1.4.m4.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.4.m4.1.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1">superscript</csymbol><ci id="S3.SS3.p1.4.m4.1.1.2.cmml" xref="S3.SS3.p1.4.m4.1.1.2">𝑥</ci><ci id="S3.SS3.p1.4.m4.1.1.3.cmml" xref="S3.SS3.p1.4.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.4.m4.1c">x^{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.4.m4.1d">italic_x start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math>, we describe how to diagnose an anomaly down to the granularity of an individual segment.
Consider <math id="S3.SS3.p1.5.m5.1" class="ltx_math_unparsed" alttext="x^{t}=&lt;x_{1},x_{2},...,x_{n}&gt;" display="inline"><semantics id="S3.SS3.p1.5.m5.1a"><mrow id="S3.SS3.p1.5.m5.1b"><msup id="S3.SS3.p1.5.m5.1.2"><mi id="S3.SS3.p1.5.m5.1.2.2">x</mi><mi id="S3.SS3.p1.5.m5.1.2.3">t</mi></msup><mo rspace="0em" id="S3.SS3.p1.5.m5.1.3">=</mo><mo lspace="0em" id="S3.SS3.p1.5.m5.1.4">&lt;</mo><msub id="S3.SS3.p1.5.m5.1.5"><mi id="S3.SS3.p1.5.m5.1.5.2">x</mi><mn id="S3.SS3.p1.5.m5.1.5.3">1</mn></msub><mo id="S3.SS3.p1.5.m5.1.6">,</mo><msub id="S3.SS3.p1.5.m5.1.7"><mi id="S3.SS3.p1.5.m5.1.7.2">x</mi><mn id="S3.SS3.p1.5.m5.1.7.3">2</mn></msub><mo id="S3.SS3.p1.5.m5.1.8">,</mo><mi mathvariant="normal" id="S3.SS3.p1.5.m5.1.1">…</mi><mo id="S3.SS3.p1.5.m5.1.9">,</mo><msub id="S3.SS3.p1.5.m5.1.10"><mi id="S3.SS3.p1.5.m5.1.10.2">x</mi><mi id="S3.SS3.p1.5.m5.1.10.3">n</mi></msub><mo id="S3.SS3.p1.5.m5.1.11">&gt;</mo></mrow><annotation encoding="application/x-tex" id="S3.SS3.p1.5.m5.1c">x^{t}=&lt;x_{1},x_{2},...,x_{n}&gt;</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.5.m5.1d">italic_x start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT = &lt; italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_x start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_x start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT &gt;</annotation></semantics></math> is a detected anomalous vector, we investigate the data distribution at time <math id="S3.SS3.p1.6.m6.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS3.p1.6.m6.1a"><mi id="S3.SS3.p1.6.m6.1.1" xref="S3.SS3.p1.6.m6.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.6.m6.1b"><ci id="S3.SS3.p1.6.m6.1.1.cmml" xref="S3.SS3.p1.6.m6.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.6.m6.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.6.m6.1d">italic_t</annotation></semantics></math> by gathering historical data at the same period of <math id="S3.SS3.p1.7.m7.2" class="ltx_Math" alttext="[t-\frac{\sigma}{2},t+\frac{\sigma}{2}]" display="inline"><semantics id="S3.SS3.p1.7.m7.2a"><mrow id="S3.SS3.p1.7.m7.2.2.2" xref="S3.SS3.p1.7.m7.2.2.3.cmml"><mo stretchy="false" id="S3.SS3.p1.7.m7.2.2.2.3" xref="S3.SS3.p1.7.m7.2.2.3.cmml">[</mo><mrow id="S3.SS3.p1.7.m7.1.1.1.1" xref="S3.SS3.p1.7.m7.1.1.1.1.cmml"><mi id="S3.SS3.p1.7.m7.1.1.1.1.2" xref="S3.SS3.p1.7.m7.1.1.1.1.2.cmml">t</mi><mo id="S3.SS3.p1.7.m7.1.1.1.1.1" xref="S3.SS3.p1.7.m7.1.1.1.1.1.cmml">−</mo><mfrac id="S3.SS3.p1.7.m7.1.1.1.1.3" xref="S3.SS3.p1.7.m7.1.1.1.1.3.cmml"><mi id="S3.SS3.p1.7.m7.1.1.1.1.3.2" xref="S3.SS3.p1.7.m7.1.1.1.1.3.2.cmml">σ</mi><mn id="S3.SS3.p1.7.m7.1.1.1.1.3.3" xref="S3.SS3.p1.7.m7.1.1.1.1.3.3.cmml">2</mn></mfrac></mrow><mo id="S3.SS3.p1.7.m7.2.2.2.4" xref="S3.SS3.p1.7.m7.2.2.3.cmml">,</mo><mrow id="S3.SS3.p1.7.m7.2.2.2.2" xref="S3.SS3.p1.7.m7.2.2.2.2.cmml"><mi id="S3.SS3.p1.7.m7.2.2.2.2.2" xref="S3.SS3.p1.7.m7.2.2.2.2.2.cmml">t</mi><mo id="S3.SS3.p1.7.m7.2.2.2.2.1" xref="S3.SS3.p1.7.m7.2.2.2.2.1.cmml">+</mo><mfrac id="S3.SS3.p1.7.m7.2.2.2.2.3" xref="S3.SS3.p1.7.m7.2.2.2.2.3.cmml"><mi id="S3.SS3.p1.7.m7.2.2.2.2.3.2" xref="S3.SS3.p1.7.m7.2.2.2.2.3.2.cmml">σ</mi><mn id="S3.SS3.p1.7.m7.2.2.2.2.3.3" xref="S3.SS3.p1.7.m7.2.2.2.2.3.3.cmml">2</mn></mfrac></mrow><mo stretchy="false" id="S3.SS3.p1.7.m7.2.2.2.5" xref="S3.SS3.p1.7.m7.2.2.3.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.7.m7.2b"><interval closure="closed" id="S3.SS3.p1.7.m7.2.2.3.cmml" xref="S3.SS3.p1.7.m7.2.2.2"><apply id="S3.SS3.p1.7.m7.1.1.1.1.cmml" xref="S3.SS3.p1.7.m7.1.1.1.1"><minus id="S3.SS3.p1.7.m7.1.1.1.1.1.cmml" xref="S3.SS3.p1.7.m7.1.1.1.1.1"></minus><ci id="S3.SS3.p1.7.m7.1.1.1.1.2.cmml" xref="S3.SS3.p1.7.m7.1.1.1.1.2">𝑡</ci><apply id="S3.SS3.p1.7.m7.1.1.1.1.3.cmml" xref="S3.SS3.p1.7.m7.1.1.1.1.3"><divide id="S3.SS3.p1.7.m7.1.1.1.1.3.1.cmml" xref="S3.SS3.p1.7.m7.1.1.1.1.3"></divide><ci id="S3.SS3.p1.7.m7.1.1.1.1.3.2.cmml" xref="S3.SS3.p1.7.m7.1.1.1.1.3.2">𝜎</ci><cn type="integer" id="S3.SS3.p1.7.m7.1.1.1.1.3.3.cmml" xref="S3.SS3.p1.7.m7.1.1.1.1.3.3">2</cn></apply></apply><apply id="S3.SS3.p1.7.m7.2.2.2.2.cmml" xref="S3.SS3.p1.7.m7.2.2.2.2"><plus id="S3.SS3.p1.7.m7.2.2.2.2.1.cmml" xref="S3.SS3.p1.7.m7.2.2.2.2.1"></plus><ci id="S3.SS3.p1.7.m7.2.2.2.2.2.cmml" xref="S3.SS3.p1.7.m7.2.2.2.2.2">𝑡</ci><apply id="S3.SS3.p1.7.m7.2.2.2.2.3.cmml" xref="S3.SS3.p1.7.m7.2.2.2.2.3"><divide id="S3.SS3.p1.7.m7.2.2.2.2.3.1.cmml" xref="S3.SS3.p1.7.m7.2.2.2.2.3"></divide><ci id="S3.SS3.p1.7.m7.2.2.2.2.3.2.cmml" xref="S3.SS3.p1.7.m7.2.2.2.2.3.2">𝜎</ci><cn type="integer" id="S3.SS3.p1.7.m7.2.2.2.2.3.3.cmml" xref="S3.SS3.p1.7.m7.2.2.2.2.3.3">2</cn></apply></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.7.m7.2c">[t-\frac{\sigma}{2},t+\frac{\sigma}{2}]</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.7.m7.2d">[ italic_t - divide start_ARG italic_σ end_ARG start_ARG 2 end_ARG , italic_t + divide start_ARG italic_σ end_ARG start_ARG 2 end_ARG ]</annotation></semantics></math>, where <math id="S3.SS3.p1.8.m8.1" class="ltx_Math" alttext="\sigma" display="inline"><semantics id="S3.SS3.p1.8.m8.1a"><mi id="S3.SS3.p1.8.m8.1.1" xref="S3.SS3.p1.8.m8.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.8.m8.1b"><ci id="S3.SS3.p1.8.m8.1.1.cmml" xref="S3.SS3.p1.8.m8.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.8.m8.1c">\sigma</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.8.m8.1d">italic_σ</annotation></semantics></math> denotes a configurable window size. Then, we train a density estimation model with a Gaussian kernel for each time series and determine the density threshold using a split validation dataset.</p>
</div>
</section>
<section id="S3.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS4.5.1.1" class="ltx_text">III-D</span> </span><span id="S3.SS4.6.2" class="ltx_text ltx_font_italic">Supervised Anomaly Classification</span>
</h3>

<div id="S3.SS4.p1" class="ltx_para">
<p id="S3.SS4.p1.1" class="ltx_p">Given the normalizing flow model (that can perform exact density estimation and efficient sampling) and the LSTM-EncDec model (that can capture temporal correlations), we can generate labeled synthetic data to train supervised classifiers for anomaly detection. The procedure of generating MTS sequences are as follows: we first provide a warm-up sequence (an initial context window) as the input of the encoder to produce the decoder’s initial hidden states. Anomalies and normal samples are then sampled from a standard normal distribution and then transformed to the output space (with decoder hidden states as conditional inputs). Generated samples are reused as inputs of the next iteration until the desired time series length is reached. The samples can then be used to train a classifier. We use a multi-layer perceptron classifier in our analysis.</p>
</div>
</section>
<section id="S3.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS5.5.1.1" class="ltx_text">III-E</span> </span><span id="S3.SS5.6.2" class="ltx_text ltx_font_italic">Thresholding</span>
</h3>

<div id="S3.SS5.p1" class="ltx_para">
<p id="S3.SS5.p1.2" class="ltx_p">CondRealNVP and baseline methods label anomalies by comparing the computed anomaly score (probability density, reconstruction, or prediction errors) with a static or dynamic threshold. In this project, we examine a static thresholding method and a dynamic one. The static method iteratively searches anomaly scores of the first <math id="S3.SS5.p1.1.m1.1" class="ltx_Math" alttext="N\%" display="inline"><semantics id="S3.SS5.p1.1.m1.1a"><mrow id="S3.SS5.p1.1.m1.1.1" xref="S3.SS5.p1.1.m1.1.1.cmml"><mi id="S3.SS5.p1.1.m1.1.1.2" xref="S3.SS5.p1.1.m1.1.1.2.cmml">N</mi><mo id="S3.SS5.p1.1.m1.1.1.1" xref="S3.SS5.p1.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.1.m1.1b"><apply id="S3.SS5.p1.1.m1.1.1.cmml" xref="S3.SS5.p1.1.m1.1.1"><csymbol cd="latexml" id="S3.SS5.p1.1.m1.1.1.1.cmml" xref="S3.SS5.p1.1.m1.1.1.1">percent</csymbol><ci id="S3.SS5.p1.1.m1.1.1.2.cmml" xref="S3.SS5.p1.1.m1.1.1.2">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.1.m1.1c">N\%</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p1.1.m1.1d">italic_N %</annotation></semantics></math> data points of the testing dataset for a threshold that yields the maximum F1-Score. The computed threshold is then applied to anomaly scores of the remaining data. We utilize the SPOT <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite> algorithm for dynamic thresholding, which essentially combines the Peak Over Threshold (POT) algorithm with a streaming process. Specifically, POT is a statistical method that uses “extreme value theory” to fit the data distribution with a Generalized Pareto Distribution. SPOT algorithm begins with computing an initial threshold by performing a POT estimate on the first <math id="S3.SS5.p1.2.m2.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S3.SS5.p1.2.m2.1a"><mi id="S3.SS5.p1.2.m2.1.1" xref="S3.SS5.p1.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.2.m2.1b"><ci id="S3.SS5.p1.2.m2.1.1.cmml" xref="S3.SS5.p1.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.2.m2.1c">N</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p1.2.m2.1d">italic_N</annotation></semantics></math> data points. SPOT then (1) updates its model using incoming values that are smaller than the threshold; (2) and fits values greater than the threshold to a GPD to adjust the threshold.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">IV </span><span id="S4.1.1" class="ltx_text ltx_font_smallcaps">Evaluation</span>
</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">In this section, we first introduce a real-world traffic dataset and a public server machine dataset used to train and evaluate our approach. For the traffic dataset, we (1) report the anomaly detection and diagnosis performance on synthetic datasets in terms of Recall and F1-score; (2) present the correlations between inferenced anomaly scores with real traffic anomalies; (3) demonstrate the anomaly classification performance of the CondRealNVP-driven supervised classifier in terms of AUC score. For the server machine dataset, we present the timestamp-levle anomaly detection performance when integrating our approach with a dynamic thresholding method. A thorough comparison with several state-of-the-art anomaly detectors was also conducted to illustrate the effectiveness of our approach.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS1.5.1.1" class="ltx_text">IV-A</span> </span><span id="S4.SS1.6.2" class="ltx_text ltx_font_italic">Datasets</span>
</h3>

<section id="S4.SS1.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S4.SS1.SSS1.5.1.1" class="ltx_text">IV-A</span>1 </span>Traffic Data</h4>

<div id="S4.SS1.SSS1.p1" class="ltx_para">
<p id="S4.SS1.SSS1.p1.1" class="ltx_p">We use an INRIX<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span><a target="_blank" href="https://inrix.com/" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://inrix.com/</a></span></span></span> traffic mobility data collected for one year (2019) from the city of Nashville, Tennessee. This dataset contains estimated “real-time” harmonic mean flow speeds, free-flow (reference) speeds, and historical average speeds of 364 interstate road segments with a five-minute frequency. The congestion rate measurements are derived based on the equation <a href="#S3.E5" title="5 ‣ III Methodology ‣ Generative Anomaly Detection for Time Series Datasets" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>. We impute missing values at a specific road segment by interpolating observations from nearby segments. If nearby segments also contain missing values, we impute by using historical averages.</p>
</div>
<figure id="S4.T2" class="ltx_table">
<div id="S4.T2.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:156.4pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(92.0pt,-33.2pt) scale(1.73737224291538,1.73737224291538) ;">
<table id="S4.T2.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T2.1.1.1.1" class="ltx_tr">
<th id="S4.T2.1.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_t">Property</th>
<th id="S4.T2.1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Values</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T2.1.1.2.1" class="ltx_tr">
<th id="S4.T2.1.1.2.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t"># roadway segments</th>
<td id="S4.T2.1.1.2.1.2" class="ltx_td ltx_align_center ltx_border_t">364</td>
</tr>
<tr id="S4.T2.1.1.3.2" class="ltx_tr">
<th id="S4.T2.1.1.3.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row"># records/segments</th>
<td id="S4.T2.1.1.3.2.2" class="ltx_td ltx_align_center">104832</td>
</tr>
<tr id="S4.T2.1.1.4.3" class="ltx_tr">
<th id="S4.T2.1.1.4.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">collection period</th>
<td id="S4.T2.1.1.4.3.2" class="ltx_td ltx_align_center">2019-01-01 00:00 –2019-12-30 23:55</td>
</tr>
<tr id="S4.T2.1.1.5.4" class="ltx_tr">
<th id="S4.T2.1.1.5.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b">frequency</th>
<td id="S4.T2.1.1.5.4.2" class="ltx_td ltx_align_center ltx_border_b">5 minutes</td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE II: </span>Details of the traffic dataset collected from Nashville TN</figcaption>
</figure>
<div id="S4.SS1.SSS1.p2" class="ltx_para">
<p id="S4.SS1.SSS1.p2.6" class="ltx_p"><span id="S4.SS1.SSS1.p2.6.1" class="ltx_text ltx_font_italic">Synthetic Testing Data</span> Note that the real-world traffic data is unlabeled. To evaluate the efficacy of the proposed approach, we generate synthetic data. We use the actual congestion data from Oct-2019 to Dec-2019 to generate this dataset. First, we model the ground-truth MTS as a multivariate Gaussian distribution, whose parameters are learned from empirical observations. We sample from the multivariate Gaussian. Then, we randomly inject “point” and “contextual” anomalies at a fraction (<math id="S4.SS1.SSS1.p2.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.SS1.SSS1.p2.1.m1.1a"><mi id="S4.SS1.SSS1.p2.1.m1.1.1" xref="S4.SS1.SSS1.p2.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p2.1.m1.1b"><ci id="S4.SS1.SSS1.p2.1.m1.1.1.cmml" xref="S4.SS1.SSS1.p2.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p2.1.m1.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.p2.1.m1.1d">italic_α</annotation></semantics></math>) of half-hour length time slices and in a fraction (<math id="S4.SS1.SSS1.p2.2.m2.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S4.SS1.SSS1.p2.2.m2.1a"><mi id="S4.SS1.SSS1.p2.2.m2.1.1" xref="S4.SS1.SSS1.p2.2.m2.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p2.2.m2.1b"><ci id="S4.SS1.SSS1.p2.2.m2.1.1.cmml" xref="S4.SS1.SSS1.p2.2.m2.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p2.2.m2.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.p2.2.m2.1d">italic_β</annotation></semantics></math>) of road segments respectively, where <math id="S4.SS1.SSS1.p2.3.m3.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.SS1.SSS1.p2.3.m3.1a"><mi id="S4.SS1.SSS1.p2.3.m3.1.1" xref="S4.SS1.SSS1.p2.3.m3.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p2.3.m3.1b"><ci id="S4.SS1.SSS1.p2.3.m3.1.1.cmml" xref="S4.SS1.SSS1.p2.3.m3.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p2.3.m3.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.p2.3.m3.1d">italic_α</annotation></semantics></math> and <math id="S4.SS1.SSS1.p2.4.m4.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S4.SS1.SSS1.p2.4.m4.1a"><mi id="S4.SS1.SSS1.p2.4.m4.1.1" xref="S4.SS1.SSS1.p2.4.m4.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p2.4.m4.1b"><ci id="S4.SS1.SSS1.p2.4.m4.1.1.cmml" xref="S4.SS1.SSS1.p2.4.m4.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p2.4.m4.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.p2.4.m4.1d">italic_β</annotation></semantics></math> are hyper-parameters that control the temporal and spatial distribution of anomalies. The motivation of injecting anomalies in a temporal manner is that traffic congestions are not instantaneous events in practice. Point anomalies are created by perturbing the values obtained from the first step by a factor drawn from a uniform distribution <math id="S4.SS1.SSS1.p2.5.m5.2" class="ltx_Math" alttext="\mathcal{U}(-g,+g)" display="inline"><semantics id="S4.SS1.SSS1.p2.5.m5.2a"><mrow id="S4.SS1.SSS1.p2.5.m5.2.2" xref="S4.SS1.SSS1.p2.5.m5.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS1.p2.5.m5.2.2.4" xref="S4.SS1.SSS1.p2.5.m5.2.2.4.cmml">𝒰</mi><mo id="S4.SS1.SSS1.p2.5.m5.2.2.3" xref="S4.SS1.SSS1.p2.5.m5.2.2.3.cmml">⁢</mo><mrow id="S4.SS1.SSS1.p2.5.m5.2.2.2.2" xref="S4.SS1.SSS1.p2.5.m5.2.2.2.3.cmml"><mo stretchy="false" id="S4.SS1.SSS1.p2.5.m5.2.2.2.2.3" xref="S4.SS1.SSS1.p2.5.m5.2.2.2.3.cmml">(</mo><mrow id="S4.SS1.SSS1.p2.5.m5.1.1.1.1.1" xref="S4.SS1.SSS1.p2.5.m5.1.1.1.1.1.cmml"><mo id="S4.SS1.SSS1.p2.5.m5.1.1.1.1.1a" xref="S4.SS1.SSS1.p2.5.m5.1.1.1.1.1.cmml">−</mo><mi id="S4.SS1.SSS1.p2.5.m5.1.1.1.1.1.2" xref="S4.SS1.SSS1.p2.5.m5.1.1.1.1.1.2.cmml">g</mi></mrow><mo id="S4.SS1.SSS1.p2.5.m5.2.2.2.2.4" xref="S4.SS1.SSS1.p2.5.m5.2.2.2.3.cmml">,</mo><mrow id="S4.SS1.SSS1.p2.5.m5.2.2.2.2.2" xref="S4.SS1.SSS1.p2.5.m5.2.2.2.2.2.cmml"><mo id="S4.SS1.SSS1.p2.5.m5.2.2.2.2.2a" xref="S4.SS1.SSS1.p2.5.m5.2.2.2.2.2.cmml">+</mo><mi id="S4.SS1.SSS1.p2.5.m5.2.2.2.2.2.2" xref="S4.SS1.SSS1.p2.5.m5.2.2.2.2.2.2.cmml">g</mi></mrow><mo stretchy="false" id="S4.SS1.SSS1.p2.5.m5.2.2.2.2.5" xref="S4.SS1.SSS1.p2.5.m5.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p2.5.m5.2b"><apply id="S4.SS1.SSS1.p2.5.m5.2.2.cmml" xref="S4.SS1.SSS1.p2.5.m5.2.2"><times id="S4.SS1.SSS1.p2.5.m5.2.2.3.cmml" xref="S4.SS1.SSS1.p2.5.m5.2.2.3"></times><ci id="S4.SS1.SSS1.p2.5.m5.2.2.4.cmml" xref="S4.SS1.SSS1.p2.5.m5.2.2.4">𝒰</ci><interval closure="open" id="S4.SS1.SSS1.p2.5.m5.2.2.2.3.cmml" xref="S4.SS1.SSS1.p2.5.m5.2.2.2.2"><apply id="S4.SS1.SSS1.p2.5.m5.1.1.1.1.1.cmml" xref="S4.SS1.SSS1.p2.5.m5.1.1.1.1.1"><minus id="S4.SS1.SSS1.p2.5.m5.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS1.p2.5.m5.1.1.1.1.1"></minus><ci id="S4.SS1.SSS1.p2.5.m5.1.1.1.1.1.2.cmml" xref="S4.SS1.SSS1.p2.5.m5.1.1.1.1.1.2">𝑔</ci></apply><apply id="S4.SS1.SSS1.p2.5.m5.2.2.2.2.2.cmml" xref="S4.SS1.SSS1.p2.5.m5.2.2.2.2.2"><plus id="S4.SS1.SSS1.p2.5.m5.2.2.2.2.2.1.cmml" xref="S4.SS1.SSS1.p2.5.m5.2.2.2.2.2"></plus><ci id="S4.SS1.SSS1.p2.5.m5.2.2.2.2.2.2.cmml" xref="S4.SS1.SSS1.p2.5.m5.2.2.2.2.2.2">𝑔</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p2.5.m5.2c">\mathcal{U}(-g,+g)</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.p2.5.m5.2d">caligraphic_U ( - italic_g , + italic_g )</annotation></semantics></math>, where <math id="S4.SS1.SSS1.p2.6.m6.1" class="ltx_Math" alttext="g" display="inline"><semantics id="S4.SS1.SSS1.p2.6.m6.1a"><mi id="S4.SS1.SSS1.p2.6.m6.1.1" xref="S4.SS1.SSS1.p2.6.m6.1.1.cmml">g</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p2.6.m6.1b"><ci id="S4.SS1.SSS1.p2.6.m6.1.1.cmml" xref="S4.SS1.SSS1.p2.6.m6.1.1">𝑔</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p2.6.m6.1c">g</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.p2.6.m6.1d">italic_g</annotation></semantics></math> denotes the magnitude of congestion rate of the day. Contextual anomalies are introduced by flipping the time slices that have minimum and maximum hourly average values.</p>
</div>
</section>
<section id="S4.SS1.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S4.SS1.SSS2.5.1.1" class="ltx_text">IV-A</span>2 </span>Server Machine Data</h4>

<div id="S4.SS1.SSS2.p1" class="ltx_para">
<p id="S4.SS1.SSS2.p1.1" class="ltx_p">SMD (Server Machine Dataset) <span id="footnote2" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span> <a target="_blank" href="https://github.com/NetManAIOps/OmniAnomaly" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/NetManAIOps/OmniAnomaly</a></span></span></span> is a public 5-week-long dataset which was collected by OmniAnomaly <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite> authors from a large Internet company with a one-minute frequency. The dataset is divided into three groups based on the service hosted on machines. There are 28 machines in total and 38 KPIs are collected on each machine. The SMD dataset is divided into two subsets of equal size: the first half is the training set and the remaining is the testing set. Anomalies and their anomalous dimensions in SMD testing set have been labeled by domain experts based on incident reports. The details of the SMD dataset is summarized in Table <a href="#S4.T3" title="TABLE III ‣ IV-A2 Server Machine Data ‣ IV-A Datasets ‣ IV Evaluation ‣ Generative Anomaly Detection for Time Series Datasets" class="ltx_ref"><span class="ltx_text ltx_ref_tag">III</span></a>.</p>
</div>
<figure id="S4.T3" class="ltx_table">
<div id="S4.T3.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:221.4pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(75.8pt,-38.7pt) scale(1.53765647870383,1.53765647870383) ;">
<table id="S4.T3.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T3.1.1.1.1" class="ltx_tr">
<th id="S4.T3.1.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_t">Property</th>
<th id="S4.T3.1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Values</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T3.1.1.2.1" class="ltx_tr">
<th id="S4.T3.1.1.2.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t"># data files</th>
<td id="S4.T3.1.1.2.1.2" class="ltx_td ltx_align_center ltx_border_t">28</td>
</tr>
<tr id="S4.T3.1.1.3.2" class="ltx_tr">
<th id="S4.T3.1.1.3.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row"># dimensions</th>
<td id="S4.T3.1.1.3.2.2" class="ltx_td ltx_align_center">38</td>
</tr>
<tr id="S4.T3.1.1.4.3" class="ltx_tr">
<th id="S4.T3.1.1.4.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">frequency</th>
<td id="S4.T3.1.1.4.3.2" class="ltx_td ltx_align_center">1 minute</td>
</tr>
<tr id="S4.T3.1.1.5.4" class="ltx_tr">
<th id="S4.T3.1.1.5.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">training set size</th>
<td id="S4.T3.1.1.5.4.2" class="ltx_td ltx_align_center">708405</td>
</tr>
<tr id="S4.T3.1.1.6.5" class="ltx_tr">
<th id="S4.T3.1.1.6.5.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">testing set size</th>
<td id="S4.T3.1.1.6.5.2" class="ltx_td ltx_align_center">708420</td>
</tr>
<tr id="S4.T3.1.1.7.6" class="ltx_tr">
<th id="S4.T3.1.1.7.6.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">anomaly ratio(%)</th>
<td id="S4.T3.1.1.7.6.2" class="ltx_td ltx_align_center">4.16</td>
</tr>
<tr id="S4.T3.1.1.8.7" class="ltx_tr">
<th id="S4.T3.1.1.8.7.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b">KPIs</th>
<td id="S4.T3.1.1.8.7.2" class="ltx_td ltx_align_center ltx_border_b">CPU load, network usage, memory usage, etc.</td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE III: </span>Details of the SMD dataset</figcaption>
</figure>
</section>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS2.5.1.1" class="ltx_text">IV-B</span> </span><span id="S4.SS2.6.2" class="ltx_text ltx_font_italic">Baselines</span>
</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p">In terms of MTS anomaly detection, we compare our approach against prediction-based (e.g., AR, DeepLog-LSTM) and reconstruction-based (e.g., AE, VAE, EncDec-AD) anomaly detectors. These models are briefly described as the following:
</p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<ol id="S4.I1" class="ltx_enumerate">
<li id="S4.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span> 
<div id="S4.I1.i1.p1" class="ltx_para">
<p id="S4.I1.i1.p1.1" class="ltx_p">AR <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite> models use linear regression to calculate a sample’s deviance from the predicted value, which is then used as its outlier scores. This model is for multivariate time series. This model handles multivariate time series by various combination approaches. Specifically, this algorithm trains independent linear regression models for each dimension then computes the anomaly score for every sample based on the mean, maximization, or median of weighted deviance of each dimension;</p>
</div>
</li>
<li id="S4.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span> 
<div id="S4.I1.i2.p1" class="ltx_para">
<p id="S4.I1.i2.p1.1" class="ltx_p">AE <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite> is an autoencoder model based on MLP that compresses data using an encoder and decode it to retain original structure using a decoder. AE could be used to detect outlying objects in the data by calculating the reconstruction errors;</p>
</div>
</li>
<li id="S4.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span> 
<div id="S4.I1.i3.p1" class="ltx_para">
<p id="S4.I1.i3.p1.1" class="ltx_p">VAE is a variational autoencoder with MLP encoder and decoder;</p>
</div>
</li>
<li id="S4.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">4.</span> 
<div id="S4.I1.i4.p1" class="ltx_para">
<p id="S4.I1.i4.p1.1" class="ltx_p">EncDec-AD <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite> replaces MLP layers in AE with LSTM layers;</p>
</div>
</li>
<li id="S4.I1.i5" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">5.</span> 
<div id="S4.I1.i5.p1" class="ltx_para">
<p id="S4.I1.i5.p1.1" class="ltx_p">DeepLog-LSTM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite> is a deep neural network model that utilizes LSTM to model a system log as a natural language sequence. This allows DeepLog to automatically learn log patterns from normal execution, and detect anomalies when log patterns deviate from the model trained from log data under normal execution. TODS library <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite> only implements the Parameter Value anomaly detection model in DeepLog <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite> for time series data, which essentially realizes a stacked LSTM model.</p>
</div>
</li>
</ol>
<p id="S4.SS2.p2.1" class="ltx_p">As the baselines do not support anomaly diagnosis at the feature level, we adopt the same KDE-based method as in the proposed method when performing evaluation on the Inrix dataset.</p>
</div>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS3.5.1.1" class="ltx_text">IV-C</span> </span><span id="S4.SS3.6.2" class="ltx_text ltx_font_italic">Model Configurations</span>
</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.2" class="ltx_p">For experiments on the traffic dataset, we configure the encoder and decoder of LSTM-ED model to have 2 LSTM layers. The flow model consists of 10 interleaving bijection and Batch Normalization layers. For both dataset, the <math id="S4.SS3.p1.1.m1.1" class="ltx_Math" alttext="s_{net}" display="inline"><semantics id="S4.SS3.p1.1.m1.1a"><msub id="S4.SS3.p1.1.m1.1.1" xref="S4.SS3.p1.1.m1.1.1.cmml"><mi id="S4.SS3.p1.1.m1.1.1.2" xref="S4.SS3.p1.1.m1.1.1.2.cmml">s</mi><mrow id="S4.SS3.p1.1.m1.1.1.3" xref="S4.SS3.p1.1.m1.1.1.3.cmml"><mi id="S4.SS3.p1.1.m1.1.1.3.2" xref="S4.SS3.p1.1.m1.1.1.3.2.cmml">n</mi><mo id="S4.SS3.p1.1.m1.1.1.3.1" xref="S4.SS3.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.SS3.p1.1.m1.1.1.3.3" xref="S4.SS3.p1.1.m1.1.1.3.3.cmml">e</mi><mo id="S4.SS3.p1.1.m1.1.1.3.1a" xref="S4.SS3.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.SS3.p1.1.m1.1.1.3.4" xref="S4.SS3.p1.1.m1.1.1.3.4.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.1.m1.1b"><apply id="S4.SS3.p1.1.m1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.1.m1.1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS3.p1.1.m1.1.1.2.cmml" xref="S4.SS3.p1.1.m1.1.1.2">𝑠</ci><apply id="S4.SS3.p1.1.m1.1.1.3.cmml" xref="S4.SS3.p1.1.m1.1.1.3"><times id="S4.SS3.p1.1.m1.1.1.3.1.cmml" xref="S4.SS3.p1.1.m1.1.1.3.1"></times><ci id="S4.SS3.p1.1.m1.1.1.3.2.cmml" xref="S4.SS3.p1.1.m1.1.1.3.2">𝑛</ci><ci id="S4.SS3.p1.1.m1.1.1.3.3.cmml" xref="S4.SS3.p1.1.m1.1.1.3.3">𝑒</ci><ci id="S4.SS3.p1.1.m1.1.1.3.4.cmml" xref="S4.SS3.p1.1.m1.1.1.3.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.1.m1.1c">s_{net}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.1.m1.1d">italic_s start_POSTSUBSCRIPT italic_n italic_e italic_t end_POSTSUBSCRIPT</annotation></semantics></math> of the <span id="S4.SS3.p1.2.1" class="ltx_text ltx_font_italic">st-network</span> is activated with the Tanh function, and the <math id="S4.SS3.p1.2.m2.1" class="ltx_Math" alttext="t_{net}" display="inline"><semantics id="S4.SS3.p1.2.m2.1a"><msub id="S4.SS3.p1.2.m2.1.1" xref="S4.SS3.p1.2.m2.1.1.cmml"><mi id="S4.SS3.p1.2.m2.1.1.2" xref="S4.SS3.p1.2.m2.1.1.2.cmml">t</mi><mrow id="S4.SS3.p1.2.m2.1.1.3" xref="S4.SS3.p1.2.m2.1.1.3.cmml"><mi id="S4.SS3.p1.2.m2.1.1.3.2" xref="S4.SS3.p1.2.m2.1.1.3.2.cmml">n</mi><mo id="S4.SS3.p1.2.m2.1.1.3.1" xref="S4.SS3.p1.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S4.SS3.p1.2.m2.1.1.3.3" xref="S4.SS3.p1.2.m2.1.1.3.3.cmml">e</mi><mo id="S4.SS3.p1.2.m2.1.1.3.1a" xref="S4.SS3.p1.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S4.SS3.p1.2.m2.1.1.3.4" xref="S4.SS3.p1.2.m2.1.1.3.4.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.2.m2.1b"><apply id="S4.SS3.p1.2.m2.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.2.m2.1.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS3.p1.2.m2.1.1.2.cmml" xref="S4.SS3.p1.2.m2.1.1.2">𝑡</ci><apply id="S4.SS3.p1.2.m2.1.1.3.cmml" xref="S4.SS3.p1.2.m2.1.1.3"><times id="S4.SS3.p1.2.m2.1.1.3.1.cmml" xref="S4.SS3.p1.2.m2.1.1.3.1"></times><ci id="S4.SS3.p1.2.m2.1.1.3.2.cmml" xref="S4.SS3.p1.2.m2.1.1.3.2">𝑛</ci><ci id="S4.SS3.p1.2.m2.1.1.3.3.cmml" xref="S4.SS3.p1.2.m2.1.1.3.3">𝑒</ci><ci id="S4.SS3.p1.2.m2.1.1.3.4.cmml" xref="S4.SS3.p1.2.m2.1.1.3.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.2.m2.1c">t_{net}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.2.m2.1d">italic_t start_POSTSUBSCRIPT italic_n italic_e italic_t end_POSTSUBSCRIPT</annotation></semantics></math> uses the ReLU function <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>. The model is trained for a maximum of 300 epochs with a batch size of 64. Out of the training set, 30% is kept out as validation set for early stopping. We performed hyper-parameter tuning for experiments on both datasets. More detailed hyper-parameter settings of each model are reported in Appendix <a href="#A1" title="Appendix A Model Configurations ‣ Generative Anomaly Detection for Time Series Datasets" class="ltx_ref"><span class="ltx_text ltx_ref_tag">A</span></a>.</p>
</div>
<div id="S4.SS3.p2" class="ltx_para">
<p id="S4.SS3.p2.1" class="ltx_p">All experiments are run on a single Nvidia TITAN X GPU (12GB) and the code implementations are based on the Tensorflow Keras library version 2.4.0 and Tensorflow Probability 0.11.0. Our implementation can be found at <a target="_blank" href="https://github.com/scope-lab-vu/CondRealNVP" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/scope-lab-vu/CondRealNVP</a>.</p>
</div>
</section>
<section id="S4.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS4.5.1.1" class="ltx_text">IV-D</span> </span><span id="S4.SS4.6.2" class="ltx_text ltx_font_italic">Experiment Setup</span>
</h3>

<section id="S4.SS4.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S4.SS4.SSS1.5.1.1" class="ltx_text">IV-D</span>1 </span>Traffic Data</h4>

<div id="S4.SS4.SSS1.p1" class="ltx_para">
<p id="S4.SS4.SSS1.p1.1" class="ltx_p">The high dimensionality of the MTS make computing the DTW distance matrix (see section <a href="#S3.SS1" title="III-A Time Series Clustering ‣ III Methodology ‣ Generative Anomaly Detection for Time Series Datasets" class="ltx_ref"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">III-A</span></span></a>) time-consuming. Therefore, we sample 100 segments uniformly at random use one week of data from the segments to generate the cluster prototype. Then, we calculate the DTW distances between the remaining segments and centroids of initialized clusters and merge them into the nearest cluster.</p>
</div>
<div id="S4.SS4.SSS1.p2" class="ltx_para">
<p id="S4.SS4.SSS1.p2.4" class="ltx_p">Our model is trained with the congestion data from Jan-2019 to Sep-2019 and evaluated on synthetic data of the remaining months. We empirically configure the sliding window size to 72 (6 hours) and the moving step length to 12 (1 hour). Point and contextual anomalies are detected together for all experiments. We evaluate the anomaly detection performance from two perspectives: effectiveness (based on temporal parameter (<math id="S4.SS4.SSS1.p2.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.SS4.SSS1.p2.1.m1.1a"><mi id="S4.SS4.SSS1.p2.1.m1.1.1" xref="S4.SS4.SSS1.p2.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS1.p2.1.m1.1b"><ci id="S4.SS4.SSS1.p2.1.m1.1.1.cmml" xref="S4.SS4.SSS1.p2.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS1.p2.1.m1.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS1.p2.1.m1.1d">italic_α</annotation></semantics></math>) and sensitivity (based on spatial parameter (<math id="S4.SS4.SSS1.p2.2.m2.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S4.SS4.SSS1.p2.2.m2.1a"><mi id="S4.SS4.SSS1.p2.2.m2.1.1" xref="S4.SS4.SSS1.p2.2.m2.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS1.p2.2.m2.1b"><ci id="S4.SS4.SSS1.p2.2.m2.1.1.cmml" xref="S4.SS4.SSS1.p2.2.m2.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS1.p2.2.m2.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS1.p2.2.m2.1d">italic_β</annotation></semantics></math>). Effectiveness measures whether anomalies can be found in the case of high imbalance between anomalous and normal data. Sensitivity, on the other hand, evaluates situations in which only a portion of road segments are under anomalous congestion at a specific time, which challenges our approach to capture anomalies with high sensitivity. For each <math id="S4.SS4.SSS1.p2.3.m3.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.SS4.SSS1.p2.3.m3.1a"><mi id="S4.SS4.SSS1.p2.3.m3.1.1" xref="S4.SS4.SSS1.p2.3.m3.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS1.p2.3.m3.1b"><ci id="S4.SS4.SSS1.p2.3.m3.1.1.cmml" xref="S4.SS4.SSS1.p2.3.m3.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS1.p2.3.m3.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS1.p2.3.m3.1d">italic_α</annotation></semantics></math> and <math id="S4.SS4.SSS1.p2.4.m4.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S4.SS4.SSS1.p2.4.m4.1a"><mi id="S4.SS4.SSS1.p2.4.m4.1.1" xref="S4.SS4.SSS1.p2.4.m4.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS1.p2.4.m4.1b"><ci id="S4.SS4.SSS1.p2.4.m4.1.1.cmml" xref="S4.SS4.SSS1.p2.4.m4.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS1.p2.4.m4.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS1.p2.4.m4.1d">italic_β</annotation></semantics></math> pair, we generate the synthetic test set five times and calculate the average model performance.</p>
</div>
<div id="S4.SS4.SSS1.p3" class="ltx_para">
<p id="S4.SS4.SSS1.p3.1" class="ltx_p">For each individual cluster, we generate five one-month long datasets. Normal and anomolous data are sampled from the overall flow architecture. Then for each cluster, we train an MLP classifier with the binary cross-entropy loss and Adam optimizer. Trained MLP classifiers are evaluated on synthetic datasets using the area under the curve (AUC) score metric.</p>
</div>
</section>
<section id="S4.SS4.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S4.SS4.SSS2.5.1.1" class="ltx_text">IV-D</span>2 </span>Server Machine Data</h4>

<div id="S4.SS4.SSS2.p1" class="ltx_para">
<p id="S4.SS4.SSS2.p1.1" class="ltx_p">Given the SMD dataset has been divided into three groups, it is unnecessary to perform time-series clustering. We selected one machine from each group (machine-1-1, machine-2-1, machine-3-7) and trained three individual models. Timestamp-level anomaly detection is then evaluated. Unlike the static thresholding approach employed on the traffic dataset, we leverage the SPOT algorithm to decide the threshold of labeling anomalies. Each model is trained and evaluated five times. We compare the performance between CondRealNVP and baselines in terms of F1-Score and Recall.
</p>
</div>
</section>
</section>
<section id="S4.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS5.5.1.1" class="ltx_text">IV-E</span> </span><span id="S4.SS5.6.2" class="ltx_text ltx_font_italic">Results and Discussion for Traffic Data</span>
</h3>

<div id="S4.SS5.p1" class="ltx_para">
<p id="S4.SS5.p1.1" class="ltx_p"><span id="S4.SS5.p1.1.1" class="ltx_text ltx_font_bold">Clustering</span> The MTS clustering step groups the 364 road segments into eight clusters that include 55, 67, 68, 79, 10, 12, 62, and 11 road segments, respectively. We name the clusters using the letters <span id="S4.SS5.p1.1.2" class="ltx_text ltx_font_italic">A-H</span>. Empirical results show that roadways in the same cluster usually have similar functions or properties. For instance, Cluster A mainly covers Exit road segments. Cluster B involves the highways (e.g., I-65, I-40) that connect Nashville towards neighboring cities. Cluster C consists of road segments around on-ramps. Experimental results for individual clusters can be found in our Github repository.</p>
</div>
<div id="S4.SS5.p2" class="ltx_para">
<p id="S4.SS5.p2.7" class="ltx_p"><span id="S4.SS5.p2.7.1" class="ltx_text ltx_font_bold">Anomaly Detection</span> First, we compare CondRealNVP with baseline methods for anomaly detection from aspects of effectiveness and sensitivity. The former is achieved by configuring the fraction of abnormal time slices <math id="S4.SS5.p2.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.SS5.p2.1.m1.1a"><mi id="S4.SS5.p2.1.m1.1.1" xref="S4.SS5.p2.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p2.1.m1.1b"><ci id="S4.SS5.p2.1.m1.1.1.cmml" xref="S4.SS5.p2.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p2.1.m1.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p2.1.m1.1d">italic_α</annotation></semantics></math> to 5%, 3%, and 1%, and the latter is by setting the fraction of anomalous road segment <math id="S4.SS5.p2.2.m2.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S4.SS5.p2.2.m2.1a"><mi id="S4.SS5.p2.2.m2.1.1" xref="S4.SS5.p2.2.m2.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p2.2.m2.1b"><ci id="S4.SS5.p2.2.m2.1.1.cmml" xref="S4.SS5.p2.2.m2.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p2.2.m2.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p2.2.m2.1d">italic_β</annotation></semantics></math> to 100%, 50%, and 25%. We conducted controlled experiments and fixed <math id="S4.SS5.p2.3.m3.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S4.SS5.p2.3.m3.1a"><mi id="S4.SS5.p2.3.m3.1.1" xref="S4.SS5.p2.3.m3.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p2.3.m3.1b"><ci id="S4.SS5.p2.3.m3.1.1.cmml" xref="S4.SS5.p2.3.m3.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p2.3.m3.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p2.3.m3.1d">italic_β</annotation></semantics></math> to 50% when testing the effectiveness and configure <math id="S4.SS5.p2.4.m4.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.SS5.p2.4.m4.1a"><mi id="S4.SS5.p2.4.m4.1.1" xref="S4.SS5.p2.4.m4.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p2.4.m4.1b"><ci id="S4.SS5.p2.4.m4.1.1.cmml" xref="S4.SS5.p2.4.m4.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p2.4.m4.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p2.4.m4.1d">italic_α</annotation></semantics></math> as 5% for the sensitivity test. These settings ensure the sparsity of irregular traffic congestion in temporal and spatial. The effectiveness test results shown in Table <a href="#S4.T4" title="TABLE IV ‣ IV-E Results and Discussion for Traffic Data ‣ IV Evaluation ‣ Generative Anomaly Detection for Time Series Datasets" class="ltx_ref"><span class="ltx_text ltx_ref_tag">IV</span></a> reflect that CondRealNVP consistently outperforms other methods, with average improvements of 0.203–0.335 and 0.154–0.212 in terms of average Recall and F1-Score. There is a clear trend that the Recall and F1-Score degrade as the decreasing <math id="S4.SS5.p2.5.m5.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.SS5.p2.5.m5.1a"><mi id="S4.SS5.p2.5.m5.1.1" xref="S4.SS5.p2.5.m5.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p2.5.m5.1b"><ci id="S4.SS5.p2.5.m5.1.1.cmml" xref="S4.SS5.p2.5.m5.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p2.5.m5.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p2.5.m5.1d">italic_α</annotation></semantics></math>; however, our approach is relatively more robust and guarantee acceptable performance even in the case of <math id="S4.SS5.p2.6.m6.1" class="ltx_Math" alttext="\alpha=1\%" display="inline"><semantics id="S4.SS5.p2.6.m6.1a"><mrow id="S4.SS5.p2.6.m6.1.1" xref="S4.SS5.p2.6.m6.1.1.cmml"><mi id="S4.SS5.p2.6.m6.1.1.2" xref="S4.SS5.p2.6.m6.1.1.2.cmml">α</mi><mo id="S4.SS5.p2.6.m6.1.1.1" xref="S4.SS5.p2.6.m6.1.1.1.cmml">=</mo><mrow id="S4.SS5.p2.6.m6.1.1.3" xref="S4.SS5.p2.6.m6.1.1.3.cmml"><mn id="S4.SS5.p2.6.m6.1.1.3.2" xref="S4.SS5.p2.6.m6.1.1.3.2.cmml">1</mn><mo id="S4.SS5.p2.6.m6.1.1.3.1" xref="S4.SS5.p2.6.m6.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p2.6.m6.1b"><apply id="S4.SS5.p2.6.m6.1.1.cmml" xref="S4.SS5.p2.6.m6.1.1"><eq id="S4.SS5.p2.6.m6.1.1.1.cmml" xref="S4.SS5.p2.6.m6.1.1.1"></eq><ci id="S4.SS5.p2.6.m6.1.1.2.cmml" xref="S4.SS5.p2.6.m6.1.1.2">𝛼</ci><apply id="S4.SS5.p2.6.m6.1.1.3.cmml" xref="S4.SS5.p2.6.m6.1.1.3"><csymbol cd="latexml" id="S4.SS5.p2.6.m6.1.1.3.1.cmml" xref="S4.SS5.p2.6.m6.1.1.3.1">percent</csymbol><cn type="integer" id="S4.SS5.p2.6.m6.1.1.3.2.cmml" xref="S4.SS5.p2.6.m6.1.1.3.2">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p2.6.m6.1c">\alpha=1\%</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p2.6.m6.1d">italic_α = 1 %</annotation></semantics></math>. We also observe similar results in the sensitivity analysis. Except the situation where all road segments in a cluster suffer heavy congestion in a specific time slice (<math id="S4.SS5.p2.7.m7.1" class="ltx_Math" alttext="\beta=100\%" display="inline"><semantics id="S4.SS5.p2.7.m7.1a"><mrow id="S4.SS5.p2.7.m7.1.1" xref="S4.SS5.p2.7.m7.1.1.cmml"><mi id="S4.SS5.p2.7.m7.1.1.2" xref="S4.SS5.p2.7.m7.1.1.2.cmml">β</mi><mo id="S4.SS5.p2.7.m7.1.1.1" xref="S4.SS5.p2.7.m7.1.1.1.cmml">=</mo><mrow id="S4.SS5.p2.7.m7.1.1.3" xref="S4.SS5.p2.7.m7.1.1.3.cmml"><mn id="S4.SS5.p2.7.m7.1.1.3.2" xref="S4.SS5.p2.7.m7.1.1.3.2.cmml">100</mn><mo id="S4.SS5.p2.7.m7.1.1.3.1" xref="S4.SS5.p2.7.m7.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p2.7.m7.1b"><apply id="S4.SS5.p2.7.m7.1.1.cmml" xref="S4.SS5.p2.7.m7.1.1"><eq id="S4.SS5.p2.7.m7.1.1.1.cmml" xref="S4.SS5.p2.7.m7.1.1.1"></eq><ci id="S4.SS5.p2.7.m7.1.1.2.cmml" xref="S4.SS5.p2.7.m7.1.1.2">𝛽</ci><apply id="S4.SS5.p2.7.m7.1.1.3.cmml" xref="S4.SS5.p2.7.m7.1.1.3"><csymbol cd="latexml" id="S4.SS5.p2.7.m7.1.1.3.1.cmml" xref="S4.SS5.p2.7.m7.1.1.3.1">percent</csymbol><cn type="integer" id="S4.SS5.p2.7.m7.1.1.3.2.cmml" xref="S4.SS5.p2.7.m7.1.1.3.2">100</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p2.7.m7.1c">\beta=100\%</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p2.7.m7.1d">italic_β = 100 %</annotation></semantics></math>), we observe that the <span id="S4.SS5.p2.7.2" class="ltx_text ltx_font_italic">CondRealNVP</span> model comprehensively outperforms the other approaches.
</p>
</div>
<figure id="S4.T4" class="ltx_table">
<div id="S4.T4.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:390.3pt;height:271.1pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(91.5pt,-63.6pt) scale(1.88293844358037,1.88293844358037) ;">
<table id="S4.T4.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T4.1.1.2.1" class="ltx_tr">
<th id="S4.T4.1.1.2.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t">metrics</th>
<th id="S4.T4.1.1.2.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" colspan="3">Recall</th>
<th id="S4.T4.1.1.2.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" colspan="3">F1-Score</th>
</tr>
<tr id="S4.T4.1.1.1" class="ltx_tr">
<th id="S4.T4.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t">anomaly rate <math id="S4.T4.1.1.1.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.T4.1.1.1.1.m1.1a"><mi id="S4.T4.1.1.1.1.m1.1.1" xref="S4.T4.1.1.1.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.T4.1.1.1.1.m1.1b"><ci id="S4.T4.1.1.1.1.m1.1.1.cmml" xref="S4.T4.1.1.1.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.1.1.1.1.m1.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S4.T4.1.1.1.1.m1.1d">italic_α</annotation></semantics></math></th>
<th id="S4.T4.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">5%</th>
<th id="S4.T4.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">3%</th>
<th id="S4.T4.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">1%</th>
<th id="S4.T4.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">5%</th>
<th id="S4.T4.1.1.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">3%</th>
<th id="S4.T4.1.1.1.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">1%</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T4.1.1.3.1" class="ltx_tr">
<th id="S4.T4.1.1.3.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">AR</th>
<td id="S4.T4.1.1.3.1.2" class="ltx_td ltx_align_center ltx_border_t">0.376</td>
<td id="S4.T4.1.1.3.1.3" class="ltx_td ltx_align_center ltx_border_t">0.343</td>
<td id="S4.T4.1.1.3.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.265</td>
<td id="S4.T4.1.1.3.1.5" class="ltx_td ltx_align_center ltx_border_t">0.446</td>
<td id="S4.T4.1.1.3.1.6" class="ltx_td ltx_align_center ltx_border_t">0.401</td>
<td id="S4.T4.1.1.3.1.7" class="ltx_td ltx_align_center ltx_border_t">0.292</td>
</tr>
<tr id="S4.T4.1.1.4.2" class="ltx_tr">
<th id="S4.T4.1.1.4.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">AE</th>
<td id="S4.T4.1.1.4.2.2" class="ltx_td ltx_align_center">0.576</td>
<td id="S4.T4.1.1.4.2.3" class="ltx_td ltx_align_center">0.504</td>
<td id="S4.T4.1.1.4.2.4" class="ltx_td ltx_align_center ltx_border_r">0.359</td>
<td id="S4.T4.1.1.4.2.5" class="ltx_td ltx_align_center">0.475</td>
<td id="S4.T4.1.1.4.2.6" class="ltx_td ltx_align_center">0.421</td>
<td id="S4.T4.1.1.4.2.7" class="ltx_td ltx_align_center">0.295</td>
</tr>
<tr id="S4.T4.1.1.5.3" class="ltx_tr">
<th id="S4.T4.1.1.5.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">VAE</th>
<td id="S4.T4.1.1.5.3.2" class="ltx_td ltx_align_center">0.574</td>
<td id="S4.T4.1.1.5.3.3" class="ltx_td ltx_align_center">0.518</td>
<td id="S4.T4.1.1.5.3.4" class="ltx_td ltx_align_center ltx_border_r">0.362</td>
<td id="S4.T4.1.1.5.3.5" class="ltx_td ltx_align_center">0.490</td>
<td id="S4.T4.1.1.5.3.6" class="ltx_td ltx_align_center">0.435</td>
<td id="S4.T4.1.1.5.3.7" class="ltx_td ltx_align_center">0.307</td>
</tr>
<tr id="S4.T4.1.1.6.4" class="ltx_tr">
<th id="S4.T4.1.1.6.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">EncDec-AD</th>
<td id="S4.T4.1.1.6.4.2" class="ltx_td ltx_align_center">0.529</td>
<td id="S4.T4.1.1.6.4.3" class="ltx_td ltx_align_center">0.472</td>
<td id="S4.T4.1.1.6.4.4" class="ltx_td ltx_align_center ltx_border_r">0.358</td>
<td id="S4.T4.1.1.6.4.5" class="ltx_td ltx_align_center">0.466</td>
<td id="S4.T4.1.1.6.4.6" class="ltx_td ltx_align_center">0.401</td>
<td id="S4.T4.1.1.6.4.7" class="ltx_td ltx_align_center">0.272</td>
</tr>
<tr id="S4.T4.1.1.7.5" class="ltx_tr">
<th id="S4.T4.1.1.7.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">DeepLog-LSTM</th>
<td id="S4.T4.1.1.7.5.2" class="ltx_td ltx_align_center">0.411</td>
<td id="S4.T4.1.1.7.5.3" class="ltx_td ltx_align_center">0.345</td>
<td id="S4.T4.1.1.7.5.4" class="ltx_td ltx_align_center ltx_border_r">0.278</td>
<td id="S4.T4.1.1.7.5.5" class="ltx_td ltx_align_center">0.439</td>
<td id="S4.T4.1.1.7.5.6" class="ltx_td ltx_align_center">0.374</td>
<td id="S4.T4.1.1.7.5.7" class="ltx_td ltx_align_center">0.246</td>
</tr>
<tr id="S4.T4.1.1.8.6" class="ltx_tr">
<th id="S4.T4.1.1.8.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_r">CondRealNVP</th>
<td id="S4.T4.1.1.8.6.2" class="ltx_td ltx_align_center ltx_border_b"><span id="S4.T4.1.1.8.6.2.1" class="ltx_text ltx_font_bold">0.752</span></td>
<td id="S4.T4.1.1.8.6.3" class="ltx_td ltx_align_center ltx_border_b"><span id="S4.T4.1.1.8.6.3.1" class="ltx_text ltx_font_bold">0.710</span></td>
<td id="S4.T4.1.1.8.6.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S4.T4.1.1.8.6.4.1" class="ltx_text ltx_font_bold">0.604</span></td>
<td id="S4.T4.1.1.8.6.5" class="ltx_td ltx_align_center ltx_border_b"><span id="S4.T4.1.1.8.6.5.1" class="ltx_text ltx_font_bold">0.632</span></td>
<td id="S4.T4.1.1.8.6.6" class="ltx_td ltx_align_center ltx_border_b"><span id="S4.T4.1.1.8.6.6.1" class="ltx_text ltx_font_bold">0.583</span></td>
<td id="S4.T4.1.1.8.6.7" class="ltx_td ltx_align_center ltx_border_b"><span id="S4.T4.1.1.8.6.7.1" class="ltx_text ltx_font_bold">0.480</span></td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE IV: </span>Avg. Recall and F1-score of the effectiveness test across 8 clusters under different anomaly rates (<math id="S4.T4.3.m1.1" class="ltx_Math" alttext="\beta=50\%" display="inline"><semantics id="S4.T4.3.m1.1b"><mrow id="S4.T4.3.m1.1.1" xref="S4.T4.3.m1.1.1.cmml"><mi id="S4.T4.3.m1.1.1.2" xref="S4.T4.3.m1.1.1.2.cmml">β</mi><mo id="S4.T4.3.m1.1.1.1" xref="S4.T4.3.m1.1.1.1.cmml">=</mo><mrow id="S4.T4.3.m1.1.1.3" xref="S4.T4.3.m1.1.1.3.cmml"><mn id="S4.T4.3.m1.1.1.3.2" xref="S4.T4.3.m1.1.1.3.2.cmml">50</mn><mo id="S4.T4.3.m1.1.1.3.1" xref="S4.T4.3.m1.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.3.m1.1c"><apply id="S4.T4.3.m1.1.1.cmml" xref="S4.T4.3.m1.1.1"><eq id="S4.T4.3.m1.1.1.1.cmml" xref="S4.T4.3.m1.1.1.1"></eq><ci id="S4.T4.3.m1.1.1.2.cmml" xref="S4.T4.3.m1.1.1.2">𝛽</ci><apply id="S4.T4.3.m1.1.1.3.cmml" xref="S4.T4.3.m1.1.1.3"><csymbol cd="latexml" id="S4.T4.3.m1.1.1.3.1.cmml" xref="S4.T4.3.m1.1.1.3.1">percent</csymbol><cn type="integer" id="S4.T4.3.m1.1.1.3.2.cmml" xref="S4.T4.3.m1.1.1.3.2">50</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.3.m1.1d">\beta=50\%</annotation><annotation encoding="application/x-llamapun" id="S4.T4.3.m1.1e">italic_β = 50 %</annotation></semantics></math>). Best results are presented in bold.</figcaption>
</figure>
<figure id="S4.T5" class="ltx_table">
<div id="S4.T5.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:390.3pt;height:264.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(89.0pt,-60.4pt) scale(1.83922608571462,1.83922608571462) ;">
<table id="S4.T5.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T5.1.1.2.1" class="ltx_tr">
<th id="S4.T5.1.1.2.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t">metrics</th>
<th id="S4.T5.1.1.2.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" colspan="3">Recall</th>
<th id="S4.T5.1.1.2.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" colspan="3">F1-Score</th>
</tr>
<tr id="S4.T5.1.1.1" class="ltx_tr">
<th id="S4.T5.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t">road segments <math id="S4.T5.1.1.1.1.m1.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S4.T5.1.1.1.1.m1.1a"><mi id="S4.T5.1.1.1.1.m1.1.1" xref="S4.T5.1.1.1.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.T5.1.1.1.1.m1.1b"><ci id="S4.T5.1.1.1.1.m1.1.1.cmml" xref="S4.T5.1.1.1.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.1.1.1.1.m1.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S4.T5.1.1.1.1.m1.1d">italic_β</annotation></semantics></math></th>
<th id="S4.T5.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">100%</th>
<th id="S4.T5.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">50%</th>
<th id="S4.T5.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">25%</th>
<th id="S4.T5.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">100%</th>
<th id="S4.T5.1.1.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">50%</th>
<th id="S4.T5.1.1.1.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">25%</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T5.1.1.3.1" class="ltx_tr">
<th id="S4.T5.1.1.3.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">AR</th>
<td id="S4.T5.1.1.3.1.2" class="ltx_td ltx_align_center ltx_border_t">0.482</td>
<td id="S4.T5.1.1.3.1.3" class="ltx_td ltx_align_center ltx_border_t">0.376</td>
<td id="S4.T5.1.1.3.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.275</td>
<td id="S4.T5.1.1.3.1.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T5.1.1.3.1.5.1" class="ltx_text ltx_font_bold">0.580</span></td>
<td id="S4.T5.1.1.3.1.6" class="ltx_td ltx_align_center ltx_border_t">0.446</td>
<td id="S4.T5.1.1.3.1.7" class="ltx_td ltx_align_center ltx_border_t">0.241</td>
</tr>
<tr id="S4.T5.1.1.4.2" class="ltx_tr">
<th id="S4.T5.1.1.4.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">AE</th>
<td id="S4.T5.1.1.4.2.2" class="ltx_td ltx_align_center">0.446</td>
<td id="S4.T5.1.1.4.2.3" class="ltx_td ltx_align_center">0.576</td>
<td id="S4.T5.1.1.4.2.4" class="ltx_td ltx_align_center ltx_border_r">0.504</td>
<td id="S4.T5.1.1.4.2.5" class="ltx_td ltx_align_center">0.516</td>
<td id="S4.T5.1.1.4.2.6" class="ltx_td ltx_align_center">0.475</td>
<td id="S4.T5.1.1.4.2.7" class="ltx_td ltx_align_center">0.369</td>
</tr>
<tr id="S4.T5.1.1.5.3" class="ltx_tr">
<th id="S4.T5.1.1.5.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">VAE</th>
<td id="S4.T5.1.1.5.3.2" class="ltx_td ltx_align_center">0.459</td>
<td id="S4.T5.1.1.5.3.3" class="ltx_td ltx_align_center">0.574</td>
<td id="S4.T5.1.1.5.3.4" class="ltx_td ltx_align_center ltx_border_r">0.486</td>
<td id="S4.T5.1.1.5.3.5" class="ltx_td ltx_align_center">0.541</td>
<td id="S4.T5.1.1.5.3.6" class="ltx_td ltx_align_center">0.490</td>
<td id="S4.T5.1.1.5.3.7" class="ltx_td ltx_align_center">0.370</td>
</tr>
<tr id="S4.T5.1.1.6.4" class="ltx_tr">
<th id="S4.T5.1.1.6.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">EncDec-AD</th>
<td id="S4.T5.1.1.6.4.2" class="ltx_td ltx_align_center">0.468</td>
<td id="S4.T5.1.1.6.4.3" class="ltx_td ltx_align_center">0.529</td>
<td id="S4.T5.1.1.6.4.4" class="ltx_td ltx_align_center ltx_border_r">0.462</td>
<td id="S4.T5.1.1.6.4.5" class="ltx_td ltx_align_center">0.519</td>
<td id="S4.T5.1.1.6.4.6" class="ltx_td ltx_align_center">0.466</td>
<td id="S4.T5.1.1.6.4.7" class="ltx_td ltx_align_center">0.342</td>
</tr>
<tr id="S4.T5.1.1.7.5" class="ltx_tr">
<th id="S4.T5.1.1.7.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">DeepLog-LSTM</th>
<td id="S4.T5.1.1.7.5.2" class="ltx_td ltx_align_center">0.429</td>
<td id="S4.T5.1.1.7.5.3" class="ltx_td ltx_align_center">0.411</td>
<td id="S4.T5.1.1.7.5.4" class="ltx_td ltx_align_center ltx_border_r">0.359</td>
<td id="S4.T5.1.1.7.5.5" class="ltx_td ltx_align_center">0.530</td>
<td id="S4.T5.1.1.7.5.6" class="ltx_td ltx_align_center">0.439</td>
<td id="S4.T5.1.1.7.5.7" class="ltx_td ltx_align_center">0.288</td>
</tr>
<tr id="S4.T5.1.1.8.6" class="ltx_tr">
<th id="S4.T5.1.1.8.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_r">CondRealNVP</th>
<td id="S4.T5.1.1.8.6.2" class="ltx_td ltx_align_center ltx_border_b"><span id="S4.T5.1.1.8.6.2.1" class="ltx_text ltx_font_bold">0.530</span></td>
<td id="S4.T5.1.1.8.6.3" class="ltx_td ltx_align_center ltx_border_b"><span id="S4.T5.1.1.8.6.3.1" class="ltx_text ltx_font_bold">0.752</span></td>
<td id="S4.T5.1.1.8.6.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S4.T5.1.1.8.6.4.1" class="ltx_text ltx_font_bold">0.648</span></td>
<td id="S4.T5.1.1.8.6.5" class="ltx_td ltx_align_center ltx_border_b">0.575</td>
<td id="S4.T5.1.1.8.6.6" class="ltx_td ltx_align_center ltx_border_b"><span id="S4.T5.1.1.8.6.6.1" class="ltx_text ltx_font_bold">0.632</span></td>
<td id="S4.T5.1.1.8.6.7" class="ltx_td ltx_align_center ltx_border_b"><span id="S4.T5.1.1.8.6.7.1" class="ltx_text ltx_font_bold">0.484</span></td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE V: </span>Avg. Recall and F1-Score of sensitivity test under different ratios of anomalous road segments (<math id="S4.T5.3.m1.1" class="ltx_Math" alttext="\alpha=5\%" display="inline"><semantics id="S4.T5.3.m1.1b"><mrow id="S4.T5.3.m1.1.1" xref="S4.T5.3.m1.1.1.cmml"><mi id="S4.T5.3.m1.1.1.2" xref="S4.T5.3.m1.1.1.2.cmml">α</mi><mo id="S4.T5.3.m1.1.1.1" xref="S4.T5.3.m1.1.1.1.cmml">=</mo><mrow id="S4.T5.3.m1.1.1.3" xref="S4.T5.3.m1.1.1.3.cmml"><mn id="S4.T5.3.m1.1.1.3.2" xref="S4.T5.3.m1.1.1.3.2.cmml">5</mn><mo id="S4.T5.3.m1.1.1.3.1" xref="S4.T5.3.m1.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.T5.3.m1.1c"><apply id="S4.T5.3.m1.1.1.cmml" xref="S4.T5.3.m1.1.1"><eq id="S4.T5.3.m1.1.1.1.cmml" xref="S4.T5.3.m1.1.1.1"></eq><ci id="S4.T5.3.m1.1.1.2.cmml" xref="S4.T5.3.m1.1.1.2">𝛼</ci><apply id="S4.T5.3.m1.1.1.3.cmml" xref="S4.T5.3.m1.1.1.3"><csymbol cd="latexml" id="S4.T5.3.m1.1.1.3.1.cmml" xref="S4.T5.3.m1.1.1.3.1">percent</csymbol><cn type="integer" id="S4.T5.3.m1.1.1.3.2.cmml" xref="S4.T5.3.m1.1.1.3.2">5</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.3.m1.1d">\alpha=5\%</annotation><annotation encoding="application/x-llamapun" id="S4.T5.3.m1.1e">italic_α = 5 %</annotation></semantics></math>).</figcaption>
</figure>
<div id="S4.SS5.p3" class="ltx_para">
<p id="S4.SS5.p3.1" class="ltx_p"><span id="S4.SS5.p3.1.1" class="ltx_text ltx_font_bold">Segment-Level Detection</span> Given cluster level anomaly detection, we now evaluate the accuracy of performing segment level detection. We present the experimental results in Table <a href="#S4.T6" title="TABLE VI ‣ IV-E Results and Discussion for Traffic Data ‣ IV Evaluation ‣ Generative Anomaly Detection for Time Series Datasets" class="ltx_ref"><span class="ltx_text ltx_ref_tag">VI</span></a>. It can be seen that the overall trend coincides with what we observed in the sensitivity test. Specifically, CondRealNVP obtains 0.102–0.184 and 0.031–0.078 improvement regarding Recall and F1-Score compared with baseline methods. Finally, recall that anomaly detection for traffic centers is intended in near real-time. On average, for each cluster, inference (including the time taken to train KDE models) takes around 34 milliseconds, which is an acceptable latency in practice.
</p>
</div>
<figure id="S4.T6" class="ltx_table">
<div id="S4.T6.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:390.3pt;height:264.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(89.0pt,-60.4pt) scale(1.83922608571462,1.83922608571462) ;">
<table id="S4.T6.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T6.1.1.2.1" class="ltx_tr">
<th id="S4.T6.1.1.2.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t">metrics</th>
<th id="S4.T6.1.1.2.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" colspan="3">Recall</th>
<th id="S4.T6.1.1.2.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" colspan="3">F1-Score</th>
</tr>
<tr id="S4.T6.1.1.1" class="ltx_tr">
<th id="S4.T6.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t">road segments <math id="S4.T6.1.1.1.1.m1.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S4.T6.1.1.1.1.m1.1a"><mi id="S4.T6.1.1.1.1.m1.1.1" xref="S4.T6.1.1.1.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.T6.1.1.1.1.m1.1b"><ci id="S4.T6.1.1.1.1.m1.1.1.cmml" xref="S4.T6.1.1.1.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.1.1.1.1.m1.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S4.T6.1.1.1.1.m1.1d">italic_β</annotation></semantics></math></th>
<th id="S4.T6.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">100%</th>
<th id="S4.T6.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">50%</th>
<th id="S4.T6.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">25%</th>
<th id="S4.T6.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">100%</th>
<th id="S4.T6.1.1.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">50%</th>
<th id="S4.T6.1.1.1.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">25%</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T6.1.1.3.1" class="ltx_tr">
<th id="S4.T6.1.1.3.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">AR</th>
<td id="S4.T6.1.1.3.1.2" class="ltx_td ltx_align_center ltx_border_t">0.459</td>
<td id="S4.T6.1.1.3.1.3" class="ltx_td ltx_align_center ltx_border_t">0.238</td>
<td id="S4.T6.1.1.3.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.126</td>
<td id="S4.T6.1.1.3.1.5" class="ltx_td ltx_align_center ltx_border_t">0.570</td>
<td id="S4.T6.1.1.3.1.6" class="ltx_td ltx_align_center ltx_border_t">0.341</td>
<td id="S4.T6.1.1.3.1.7" class="ltx_td ltx_align_center ltx_border_t">0.178</td>
</tr>
<tr id="S4.T6.1.1.4.2" class="ltx_tr">
<th id="S4.T6.1.1.4.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">AE</th>
<td id="S4.T6.1.1.4.2.2" class="ltx_td ltx_align_center">0.401</td>
<td id="S4.T6.1.1.4.2.3" class="ltx_td ltx_align_center">0.322</td>
<td id="S4.T6.1.1.4.2.4" class="ltx_td ltx_align_center ltx_border_r">0.210</td>
<td id="S4.T6.1.1.4.2.5" class="ltx_td ltx_align_center">0.491</td>
<td id="S4.T6.1.1.4.2.6" class="ltx_td ltx_align_center">0.345</td>
<td id="S4.T6.1.1.4.2.7" class="ltx_td ltx_align_center">0.221</td>
</tr>
<tr id="S4.T6.1.1.5.3" class="ltx_tr">
<th id="S4.T6.1.1.5.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">VAE</th>
<td id="S4.T6.1.1.5.3.2" class="ltx_td ltx_align_center">0.422</td>
<td id="S4.T6.1.1.5.3.3" class="ltx_td ltx_align_center">0.333</td>
<td id="S4.T6.1.1.5.3.4" class="ltx_td ltx_align_center ltx_border_r">0.211</td>
<td id="S4.T6.1.1.5.3.5" class="ltx_td ltx_align_center">0.517</td>
<td id="S4.T6.1.1.5.3.6" class="ltx_td ltx_align_center">0.352</td>
<td id="S4.T6.1.1.5.3.7" class="ltx_td ltx_align_center">0.218</td>
</tr>
<tr id="S4.T6.1.1.6.4" class="ltx_tr">
<th id="S4.T6.1.1.6.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">EncDec-AD</th>
<td id="S4.T6.1.1.6.4.2" class="ltx_td ltx_align_center">0.427</td>
<td id="S4.T6.1.1.6.4.3" class="ltx_td ltx_align_center">0.300</td>
<td id="S4.T6.1.1.6.4.4" class="ltx_td ltx_align_center ltx_border_r">0.192</td>
<td id="S4.T6.1.1.6.4.5" class="ltx_td ltx_align_center">0.507</td>
<td id="S4.T6.1.1.6.4.6" class="ltx_td ltx_align_center">0.341</td>
<td id="S4.T6.1.1.6.4.7" class="ltx_td ltx_align_center">0.211</td>
</tr>
<tr id="S4.T6.1.1.7.5" class="ltx_tr">
<th id="S4.T6.1.1.7.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">DeepLog-LSTM</th>
<td id="S4.T6.1.1.7.5.2" class="ltx_td ltx_align_center">0.395</td>
<td id="S4.T6.1.1.7.5.3" class="ltx_td ltx_align_center">0.242</td>
<td id="S4.T6.1.1.7.5.4" class="ltx_td ltx_align_center ltx_border_r">0.156</td>
<td id="S4.T6.1.1.7.5.5" class="ltx_td ltx_align_center">0.514</td>
<td id="S4.T6.1.1.7.5.6" class="ltx_td ltx_align_center">0.333</td>
<td id="S4.T6.1.1.7.5.7" class="ltx_td ltx_align_center">0.199</td>
</tr>
<tr id="S4.T6.1.1.8.6" class="ltx_tr">
<th id="S4.T6.1.1.8.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_r">CondRealNVP</th>
<td id="S4.T6.1.1.8.6.2" class="ltx_td ltx_align_center ltx_border_b"><span id="S4.T6.1.1.8.6.2.1" class="ltx_text ltx_font_bold">0.520</span></td>
<td id="S4.T6.1.1.8.6.3" class="ltx_td ltx_align_center ltx_border_b"><span id="S4.T6.1.1.8.6.3.1" class="ltx_text ltx_font_bold">0.508</span></td>
<td id="S4.T6.1.1.8.6.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S4.T6.1.1.8.6.4.1" class="ltx_text ltx_font_bold">0.282</span></td>
<td id="S4.T6.1.1.8.6.5" class="ltx_td ltx_align_center ltx_border_b"><span id="S4.T6.1.1.8.6.5.1" class="ltx_text ltx_font_bold">0.572</span></td>
<td id="S4.T6.1.1.8.6.6" class="ltx_td ltx_align_center ltx_border_b"><span id="S4.T6.1.1.8.6.6.1" class="ltx_text ltx_font_bold">0.420</span></td>
<td id="S4.T6.1.1.8.6.7" class="ltx_td ltx_align_center ltx_border_b"><span id="S4.T6.1.1.8.6.7.1" class="ltx_text ltx_font_bold">0.245</span></td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE VI: </span>Avg. Recall and F1-Score for segment-level anomaly diagnosis with <math id="S4.T6.3.m1.1" class="ltx_Math" alttext="\alpha=5\%" display="inline"><semantics id="S4.T6.3.m1.1b"><mrow id="S4.T6.3.m1.1.1" xref="S4.T6.3.m1.1.1.cmml"><mi id="S4.T6.3.m1.1.1.2" xref="S4.T6.3.m1.1.1.2.cmml">α</mi><mo id="S4.T6.3.m1.1.1.1" xref="S4.T6.3.m1.1.1.1.cmml">=</mo><mrow id="S4.T6.3.m1.1.1.3" xref="S4.T6.3.m1.1.1.3.cmml"><mn id="S4.T6.3.m1.1.1.3.2" xref="S4.T6.3.m1.1.1.3.2.cmml">5</mn><mo id="S4.T6.3.m1.1.1.3.1" xref="S4.T6.3.m1.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.T6.3.m1.1c"><apply id="S4.T6.3.m1.1.1.cmml" xref="S4.T6.3.m1.1.1"><eq id="S4.T6.3.m1.1.1.1.cmml" xref="S4.T6.3.m1.1.1.1"></eq><ci id="S4.T6.3.m1.1.1.2.cmml" xref="S4.T6.3.m1.1.1.2">𝛼</ci><apply id="S4.T6.3.m1.1.1.3.cmml" xref="S4.T6.3.m1.1.1.3"><csymbol cd="latexml" id="S4.T6.3.m1.1.1.3.1.cmml" xref="S4.T6.3.m1.1.1.3.1">percent</csymbol><cn type="integer" id="S4.T6.3.m1.1.1.3.2.cmml" xref="S4.T6.3.m1.1.1.3.2">5</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.3.m1.1d">\alpha=5\%</annotation><annotation encoding="application/x-llamapun" id="S4.T6.3.m1.1e">italic_α = 5 %</annotation></semantics></math>.</figcaption>
</figure>
<div id="S4.SS5.p4" class="ltx_para">
<p id="S4.SS5.p4.1" class="ltx_p"><span id="S4.SS5.p4.1.1" class="ltx_text ltx_font_bold">Visualization of real-world traffic anomaly</span> We also show a case study on real-world data to evaluate our approach. We use real congestion data from cluster G for weekdays between Oct. 31st and Nov. 29th in Q4 2019, which is not seen during training. Figure <a href="#S4.F3" title="Figure 3 ‣ IV-E Results and Discussion for Traffic Data ‣ IV Evaluation ‣ Generative Anomaly Detection for Time Series Datasets" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> shows (a) the 85th percentile congestion rate (average in 15 minutes) for all segments in the cluster and (b) the corresponding average anomaly score assigned by CondRealNVP. We select the period between 5 AM and 10 AM, which generally covers rush hours of the roadway (e.g., interstates 65) in Cluster G. The 85th percentile congestion intensity indicates the extent of congestion in the cluster, implying that only 15% road segments are under heavier congestion states than presented. It can be seen that anomalous congestion occurred at 10/31, 11/07, 14, 18, and 22 with an apparent cascading pattern. As expected, our approach successfully discovers the peak hours and assigns notable anomaly scores from early stages.</p>
</div>
<figure id="S4.F3" class="ltx_figure">
<div class="ltx_flex_figure">

<div class="ltx_flex_cell 
                  ltx_flex_size_1">
<figure id="S4.F3.1" class="ltx_figure ltx_flex_size_1 ltx_align_center"><img src="/html/2206.14597/assets/images/congestion_rate.png" id="S4.F3.1.g1" class="ltx_graphics ltx_img_landscape" width="598" height="118" alt="Refer to caption">
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell 
                  ltx_flex_size_1">
<figure id="S4.F3.2" class="ltx_figure ltx_flex_size_1 ltx_align_center"><img src="/html/2206.14597/assets/images/anomaly_score.png" id="S4.F3.2.g1" class="ltx_graphics ltx_img_landscape" width="598" height="118" alt="Refer to caption">
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Visualization of real-world traffic anomalies and anomaly scores. The top figure shows the 85th percentile congestion rate (average in 15 minutes). The bottom figure shows the average anomaly scores per 15 minutes. Boxes highlight the most noticeable periods that are likely under abnormal congestion. Heatmaps show the results of Cluster G from 5 AM to 10 AM (rush hours) for 22 working days. Our method sensitively captures the time periods when recurring congestion occurred.</figcaption>
</figure>
<div id="S4.SS5.p5" class="ltx_para">
<p id="S4.SS5.p5.3" class="ltx_p"><span id="S4.SS5.p5.3.1" class="ltx_text ltx_font_bold">Supervised Classification</span> Finally, we evaluate the efficacy of learning a classifiers in a supervised setting using samples drawn from CondRealNVP. The classifiers are evaluated on five synthetic testing datasets, as we conducted in the previous section, with <math id="S4.SS5.p5.1.m1.1" class="ltx_Math" alttext="\alpha=5\%" display="inline"><semantics id="S4.SS5.p5.1.m1.1a"><mrow id="S4.SS5.p5.1.m1.1.1" xref="S4.SS5.p5.1.m1.1.1.cmml"><mi id="S4.SS5.p5.1.m1.1.1.2" xref="S4.SS5.p5.1.m1.1.1.2.cmml">α</mi><mo id="S4.SS5.p5.1.m1.1.1.1" xref="S4.SS5.p5.1.m1.1.1.1.cmml">=</mo><mrow id="S4.SS5.p5.1.m1.1.1.3" xref="S4.SS5.p5.1.m1.1.1.3.cmml"><mn id="S4.SS5.p5.1.m1.1.1.3.2" xref="S4.SS5.p5.1.m1.1.1.3.2.cmml">5</mn><mo id="S4.SS5.p5.1.m1.1.1.3.1" xref="S4.SS5.p5.1.m1.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p5.1.m1.1b"><apply id="S4.SS5.p5.1.m1.1.1.cmml" xref="S4.SS5.p5.1.m1.1.1"><eq id="S4.SS5.p5.1.m1.1.1.1.cmml" xref="S4.SS5.p5.1.m1.1.1.1"></eq><ci id="S4.SS5.p5.1.m1.1.1.2.cmml" xref="S4.SS5.p5.1.m1.1.1.2">𝛼</ci><apply id="S4.SS5.p5.1.m1.1.1.3.cmml" xref="S4.SS5.p5.1.m1.1.1.3"><csymbol cd="latexml" id="S4.SS5.p5.1.m1.1.1.3.1.cmml" xref="S4.SS5.p5.1.m1.1.1.3.1">percent</csymbol><cn type="integer" id="S4.SS5.p5.1.m1.1.1.3.2.cmml" xref="S4.SS5.p5.1.m1.1.1.3.2">5</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p5.1.m1.1c">\alpha=5\%</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p5.1.m1.1d">italic_α = 5 %</annotation></semantics></math> and <math id="S4.SS5.p5.2.m2.1" class="ltx_Math" alttext="\beta=50\%" display="inline"><semantics id="S4.SS5.p5.2.m2.1a"><mrow id="S4.SS5.p5.2.m2.1.1" xref="S4.SS5.p5.2.m2.1.1.cmml"><mi id="S4.SS5.p5.2.m2.1.1.2" xref="S4.SS5.p5.2.m2.1.1.2.cmml">β</mi><mo id="S4.SS5.p5.2.m2.1.1.1" xref="S4.SS5.p5.2.m2.1.1.1.cmml">=</mo><mrow id="S4.SS5.p5.2.m2.1.1.3" xref="S4.SS5.p5.2.m2.1.1.3.cmml"><mn id="S4.SS5.p5.2.m2.1.1.3.2" xref="S4.SS5.p5.2.m2.1.1.3.2.cmml">50</mn><mo id="S4.SS5.p5.2.m2.1.1.3.1" xref="S4.SS5.p5.2.m2.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p5.2.m2.1b"><apply id="S4.SS5.p5.2.m2.1.1.cmml" xref="S4.SS5.p5.2.m2.1.1"><eq id="S4.SS5.p5.2.m2.1.1.1.cmml" xref="S4.SS5.p5.2.m2.1.1.1"></eq><ci id="S4.SS5.p5.2.m2.1.1.2.cmml" xref="S4.SS5.p5.2.m2.1.1.2">𝛽</ci><apply id="S4.SS5.p5.2.m2.1.1.3.cmml" xref="S4.SS5.p5.2.m2.1.1.3"><csymbol cd="latexml" id="S4.SS5.p5.2.m2.1.1.3.1.cmml" xref="S4.SS5.p5.2.m2.1.1.3.1">percent</csymbol><cn type="integer" id="S4.SS5.p5.2.m2.1.1.3.2.cmml" xref="S4.SS5.p5.2.m2.1.1.3.2">50</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p5.2.m2.1c">\beta=50\%</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p5.2.m2.1d">italic_β = 50 %</annotation></semantics></math>. We report the average AUC score in Figure <a href="#S4.F4" title="Figure 4 ‣ IV-E Results and Discussion for Traffic Data ‣ IV Evaluation ‣ Generative Anomaly Detection for Time Series Datasets" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>. One can see that classifiers have acceptable discrimination capability (AUC score <math id="S4.SS5.p5.3.m3.1" class="ltx_Math" alttext="\geq" display="inline"><semantics id="S4.SS5.p5.3.m3.1a"><mo id="S4.SS5.p5.3.m3.1.1" xref="S4.SS5.p5.3.m3.1.1.cmml">≥</mo><annotation-xml encoding="MathML-Content" id="S4.SS5.p5.3.m3.1b"><geq id="S4.SS5.p5.3.m3.1.1.cmml" xref="S4.SS5.p5.3.m3.1.1"></geq></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p5.3.m3.1c">\geq</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p5.3.m3.1d">≥</annotation></semantics></math> 0.7) in 6 of the 8 clusters. The relatively lower AUC scores in clusters A (off-ramp/Exit segments) and C (on-ramp segments) are probably due to the extremely low volume of abnormal congestion data in such clusters.</p>
</div>
<figure id="S4.F4" class="ltx_figure"><img src="/html/2206.14597/assets/images/auc.png" id="S4.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="299" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Average AUC score for the MLPClassifiers on 5 synthetic testing datasets. Boxplot shows the performance variation of MLPClassifiers trained on 5 datasets drawn from CondRealNVP.</figcaption>
</figure>
</section>
<section id="S4.SS6" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS6.5.1.1" class="ltx_text">IV-F</span> </span><span id="S4.SS6.6.2" class="ltx_text ltx_font_italic">Results and Discussion for Server Machine Data</span>
</h3>

<div id="S4.SS6.p1" class="ltx_para">
<p id="S4.SS6.p1.1" class="ltx_p">Figure <a href="#S4.F5" title="Figure 5 ‣ IV-F Results and Discussion for Server Machine Data ‣ IV Evaluation ‣ Generative Anomaly Detection for Time Series Datasets" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> indicates that CondRealNVP outperforms baselines by 0.068-0.239 on average over three selected machines in terms of F1-Score. The Recall of CondRealNVP, as shown in figure <a href="#S4.F6" title="Figure 6 ‣ IV-F Results and Discussion for Server Machine Data ‣ IV Evaluation ‣ Generative Anomaly Detection for Time Series Datasets" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>, is slightly lower than LSTM-AE on machine-2-1 but greater than baselines in other cases. Overall, CondRealNVP obtains an average of 0.050-0.323 higher recall over three selected machines.</p>
</div>
<figure id="S4.F5" class="ltx_figure"><img src="/html/2206.14597/assets/images/smd_f1.png" id="S4.F5.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="298" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Average F1-Score and standard deviation over five runs on the SMD dataset</figcaption>
</figure>
<figure id="S4.F6" class="ltx_figure"><img src="/html/2206.14597/assets/images/smd_recall.png" id="S4.F6.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="294" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>Average Recall and standard deviation over five runs on the SMD dataset</figcaption>
</figure>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">V </span><span id="S5.1.1" class="ltx_text ltx_font_smallcaps">Related Work</span>
</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">Existing research on anomaly detection and diagnosis for surface transportation systems can be broadly classified into three classes according to the means of measuring deviations between normal samples and anomalies: <span id="S5.p1.1.1" class="ltx_text ltx_font_italic">reconstruction-based</span>, <span id="S5.p1.1.2" class="ltx_text ltx_font_italic">prediction-based</span>, and <span id="S5.p1.1.3" class="ltx_text ltx_font_italic">density-based</span> approaches. We review and investigate the advantages and weaknesses of each strategy and eventually propose CondRealNVP that combines the ideas of prediction-based and density-based approaches.</p>
</div>
<div id="S5.p2" class="ltx_para">
<p id="S5.p2.1" class="ltx_p"><span id="S5.p2.1.1" class="ltx_text ltx_font_bold">Reconstruction-based approaches</span> leverage the notion that normal samples can be better restructured from a compressed latent space than anomalies. The reconstruction error is used as anomaly score to indicate the deviation of anomalous samples from regular values. AutoEncoder and many of its variants have been the main foundation of this class of methods. Malhotra et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite> first introduced the LSTM encoder-decoder schema for time-series anomaly detection, known as EncDec-AD. Hu et.al <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite> combines AutoEncoder with graph convolutional networks to detect anomalies that lead to unexpected travel time in a set of directed weighted graphs. Madarash et.al <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite> leverage LSTM predicted maneuver labels to reduce the number of false-positive alarms when using LSTM AutoEncoder for anomaly detection on driving modality data. A major limitation of these studies is that the detectors have to be built in a semi-supervised manner, training with unpolluted data only. This does not meet the unsupervised setting of our problem. Under the unsupervised setting, Chevrot et.al <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite> introduced <span id="S5.p2.1.2" class="ltx_text ltx_font_italic">Contextual AutoEncoder</span> to detect anomalies in En-Route trajectories. They improved the regular LSTM-based AutoEncoder using multiple decoders, where each focus on a specific flight phase (e.g. climbing, cruising, or descending). However, as shown in the study <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite>, a common issue with AutoEncoder-based methods is that the L2 optimization objective enforces models to learn a generic summarization of underlying regularities of the training dataset, even for outliers, leading to severe over-fitting. Variational AutoEncoder eliminates this problem by introducing an additional Kullback-Leibler divergence loss term. People therefore combined LSTM with VAE for multi-modal temporal anomaly detection in various domains <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>, <a href="#bib.bib31" title="" class="ltx_ref">31</a>, <a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite>.</p>
</div>
<div id="S5.p3" class="ltx_para">
<p id="S5.p3.1" class="ltx_p"><span id="S5.p3.1.1" class="ltx_text ltx_font_bold">Prediction models</span> can naturally be used as anomaly detector, relying on the fact that normal samples are more predictable than anomalies. As the boosting of the complexity and dimension of realistic MTS data, memory-gated RNN models, such as LSTM and GRU, have been widely used on MTS forecasting and anomaly detection tasks due to their prominent capability in modeling long-term sequential dependencies. Malhotra et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite> first proposed LSTM-AD that uses stacked LSTM networks for MTS anomaly detection. Similar models are employed in DeepLog <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite> for system log analysis. Channel-wise LSTM models are adopted by Hundman et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite> for spacecraft anomaly detection. In terms of transportation systems, LSTM networks are applied on sensor data for traffic density estimation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite> and speed forecasting <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib36" title="" class="ltx_ref">36</a>]</cite>. Chen et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite> leveraged stacked LSTM networks to predict traffic conditions with aids of four categories of traffic relevant online open data, including web map, social media, local events, and weather. Abduljabbar et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib38" title="" class="ltx_ref">38</a>]</cite> compared the performance of bidirectional LSTM (BiLSTM) and regular LSTM models for freeway traffic forecasting using simulation data. They highlight the superior performance of BiLSTM for multiple prediction horizons. Basak et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib39" title="" class="ltx_ref">39</a>]</cite> analyzed the cascade effects of traffic congestion using a citywide ensemble of intersection level connected LSTM models and demonstrated a Timed Failure Propagation Graph-based diagnostics mechanism in  <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite>. The major drawback of these attempts is that the forecasting accuracy is likely to be affected by anomalies when training models with polluted datasets <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib41" title="" class="ltx_ref">41</a>]</cite>, leading to unreliable anomaly detection results. In this case, the encoder-decoder structure was embedded in LSTM networks, known as sequence-to-sequence (Seq2Seq) prediction models. Loganathan et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib42" title="" class="ltx_ref">42</a>]</cite> leveraged the Seq2Seq encoder-decoder model to detect anomalous packets in TCP traffic. A more sophisticated Seq2Seq model with attention mechanism and bidirectional LSTM networks is introduced in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib43" title="" class="ltx_ref">43</a>]</cite> for short-term passenger flow prediction.</p>
</div>
<div id="S5.p4" class="ltx_para">
<p id="S5.p4.1" class="ltx_p"><span id="S5.p4.1.1" class="ltx_text ltx_font_bold">Density-based approaches</span> intend to extract the underlying distribution of ground-truth data. The principle of detecting anomalies is that the density around a normal sample is similar to that around its neighbors. Chiang et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib44" title="" class="ltx_ref">44</a>]</cite> designed a two-step congestion cascades identification strategy, where they used a non-parametric Kernel Density Estimation function to compute anomaly score for road segments in the first step. Congested cascades are then formed by unifying both attribute coherence and spatio-temporal closeness of detected congested segments. Normalizing flows, as a class of recent probability density estimation technique, has been used for anomaly detection in transportation systems. Dias et al.  <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib45" title="" class="ltx_ref">45</a>]</cite> employed RealNVP and masked autoregressive flow for trajectory anomaly detection, in which a trajectory is defined as a sequence of GPS points generated by a moving object on a monitoring system. Their experimental results show that flow models outperform classical density-based methods including LOF <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib46" title="" class="ltx_ref">46</a>]</cite> and a Gaussian mixture model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib47" title="" class="ltx_ref">47</a>]</cite>. A remarkable benefit of density-based anomaly detection approaches is they do not need labeled training data <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib48" title="" class="ltx_ref">48</a>]</cite>. However, since they only focus on the underlying data distribution, they cannot capture the sequential correlation in a time series.</p>
</div>
<div id="S5.p5" class="ltx_para">
<p id="S5.p5.1" class="ltx_p">In addition to the natural limitations of the above studies, none of the existing work comprehensively addresses the scalability and spatial-temporal correlation challenges of anomaly detection and diagnosis for large traffic congestion datasets. In contrast, our presented work clusters road segments based on temporal similarity measures to decompose the problem scale. For an individual cluster, we employ the Encoder-Decoder-based LSTM model to extract sequential dependency and eliminate the interference of anomalies to the training process. A powerful conditional normalizing flow model then estimates the probability density of ground-truth congestion data. Real-time road segment-level anomaly diagnosis is also realized in our framework using fast kernel density estimation.</p>
</div>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">VI </span><span id="S6.1.1" class="ltx_text ltx_font_smallcaps">Conclusion</span>
</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">In this paper, we present an end-to-end framework to address the problem of multivariate time series anomaly detection and real-time anomaly diagnosis. In the framework, we identify similarity between uni-variate time series and use a conditional normalizing flow model for MTS that combines an LSTM Encoder-Decoder network with a RealNVP model for density-based anomaly detection. Then, we provide a KDE-based real-time anomaly diagnosis to locate anomalous features. Extensive experiments conducted on a real-world traffic dataset and a public server machine dataset manifest that our approach outperforms several state-of-art methods for both anomaly detection and anomaly diagnosis.</p>
</div>
<div id="S6.p2" class="ltx_para">
<p id="S6.p2.1" class="ltx_p">In the future, for traffic anomaly detection, we plan to investigate the impact of more time-independent features, such as weather, holiday, events, etc. on anomaly detection performance. For machine KPI anomaly detection, we plan to improve the scalability of our approach to avoid training one model for every machine. In addition, we want to integrate attention mechanism with the LSTM networks to differentiate the importance of features and time steps when deriving anomaly score at a particular time. Finally, it is worth to explore other normalizing flow models, such as MAF, Glow, etc.</p>
</div>
</section>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Model Configurations</h2>

<div id="A1.p1" class="ltx_para">
<p id="A1.p1.1" class="ltx_p">In this section, we document the model configurations of CondRealNVP when executing on the traffic and server machine datasets. For Clusters A-D and G of the traffic data, encoder LSTM layers consist of 128 and 64 hidden units (and the opposite for the decoder) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>. The hidden size is changed to 64 and 32 for cluster E-F and H. The <span id="A1.p1.1.1" class="ltx_text ltx_font_italic">st-network</span> of every bijection layer is formed with 2 MLP layers (128 hidden dimensions for clusters A-D, G, and 32 for clusters E-F, H). We configure the context window size to 6 hours and 1 hour length for the prediction window. The moving step length is set to 1 hour. We summarize the hyper-parameter configurations of CondRealNVP when applying on the SMD dataset in Table <a href="#A1.T7" title="TABLE VII ‣ Appendix A Model Configurations ‣ Generative Anomaly Detection for Time Series Datasets" class="ltx_ref"><span class="ltx_text ltx_ref_tag">VII</span></a>.</p>
</div>
<figure id="A1.T7" class="ltx_table">
<table id="A1.T7.1" class="ltx_tabular ltx_centering ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="A1.T7.1.1.1" class="ltx_tr">
<td id="A1.T7.1.1.1.1" class="ltx_td ltx_border_r"></td>
<td id="A1.T7.1.1.1.2" class="ltx_td ltx_align_left ltx_border_r">machine-1-1</td>
<td id="A1.T7.1.1.1.3" class="ltx_td ltx_align_left ltx_border_r">machine-2-1</td>
<td id="A1.T7.1.1.1.4" class="ltx_td ltx_align_left">machine-3-7</td>
</tr>
<tr id="A1.T7.1.2.2" class="ltx_tr">
<td id="A1.T7.1.2.2.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">window</td>
<td id="A1.T7.1.2.2.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">360</td>
<td id="A1.T7.1.2.2.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">1320</td>
<td id="A1.T7.1.2.2.4" class="ltx_td ltx_align_left ltx_border_t">720</td>
</tr>
<tr id="A1.T7.1.3.3" class="ltx_tr">
<td id="A1.T7.1.3.3.1" class="ltx_td ltx_align_left ltx_border_r">steps</td>
<td id="A1.T7.1.3.3.2" class="ltx_td ltx_align_left ltx_border_r">50</td>
<td id="A1.T7.1.3.3.3" class="ltx_td ltx_align_left ltx_border_r">20</td>
<td id="A1.T7.1.3.3.4" class="ltx_td ltx_align_left">50</td>
</tr>
<tr id="A1.T7.1.4.4" class="ltx_tr">
<td id="A1.T7.1.4.4.1" class="ltx_td ltx_align_left ltx_border_r"># bijection blocks</td>
<td id="A1.T7.1.4.4.2" class="ltx_td ltx_align_left ltx_border_r">15</td>
<td id="A1.T7.1.4.4.3" class="ltx_td ltx_align_left ltx_border_r">5</td>
<td id="A1.T7.1.4.4.4" class="ltx_td ltx_align_left">20</td>
</tr>
<tr id="A1.T7.1.5.5" class="ltx_tr">
<td id="A1.T7.1.5.5.1" class="ltx_td ltx_align_left ltx_border_r"># RNN units of LSTM-ED layers</td>
<td id="A1.T7.1.5.5.2" class="ltx_td ltx_align_left ltx_border_r">32</td>
<td id="A1.T7.1.5.5.3" class="ltx_td ltx_align_left ltx_border_r">32</td>
<td id="A1.T7.1.5.5.4" class="ltx_td ltx_align_left">128</td>
</tr>
<tr id="A1.T7.1.6.6" class="ltx_tr">
<td id="A1.T7.1.6.6.1" class="ltx_td ltx_align_left ltx_border_r"># RNN layers of LSTM-ED</td>
<td id="A1.T7.1.6.6.2" class="ltx_td ltx_align_left ltx_border_r">2</td>
<td id="A1.T7.1.6.6.3" class="ltx_td ltx_align_left ltx_border_r">1</td>
<td id="A1.T7.1.6.6.4" class="ltx_td ltx_align_left">1</td>
</tr>
<tr id="A1.T7.1.7.7" class="ltx_tr">
<td id="A1.T7.1.7.7.1" class="ltx_td ltx_align_left ltx_border_r"># units of <span id="A1.T7.1.7.7.1.1" class="ltx_text ltx_font_italic">st_layers</span>
</td>
<td id="A1.T7.1.7.7.2" class="ltx_td ltx_align_left ltx_border_r">32</td>
<td id="A1.T7.1.7.7.3" class="ltx_td ltx_align_left ltx_border_r">128</td>
<td id="A1.T7.1.7.7.4" class="ltx_td ltx_align_left">32</td>
</tr>
<tr id="A1.T7.1.8.8" class="ltx_tr">
<td id="A1.T7.1.8.8.1" class="ltx_td ltx_align_left ltx_border_r"># <span id="A1.T7.1.8.8.1.1" class="ltx_text ltx_font_italic">st_layer</span>
</td>
<td id="A1.T7.1.8.8.2" class="ltx_td ltx_align_left ltx_border_r">2</td>
<td id="A1.T7.1.8.8.3" class="ltx_td ltx_align_left ltx_border_r">1</td>
<td id="A1.T7.1.8.8.4" class="ltx_td ltx_align_left">1</td>
</tr>
<tr id="A1.T7.1.9.9" class="ltx_tr">
<td id="A1.T7.1.9.9.1" class="ltx_td ltx_align_left ltx_border_r">learning rate</td>
<td id="A1.T7.1.9.9.2" class="ltx_td ltx_align_left ltx_border_r">1e-4</td>
<td id="A1.T7.1.9.9.3" class="ltx_td ltx_align_left ltx_border_r">1e-3</td>
<td id="A1.T7.1.9.9.4" class="ltx_td ltx_align_left">1e-4</td>
</tr>
<tr id="A1.T7.1.10.10" class="ltx_tr">
<td id="A1.T7.1.10.10.1" class="ltx_td ltx_align_left ltx_border_r">batch size</td>
<td id="A1.T7.1.10.10.2" class="ltx_td ltx_align_left ltx_border_r">128</td>
<td id="A1.T7.1.10.10.3" class="ltx_td ltx_align_left ltx_border_r">128</td>
<td id="A1.T7.1.10.10.4" class="ltx_td ltx_align_left">64</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE VII: </span>Hyper-parameter settings of CondRealNVP when executing on SMD datset</figcaption>
</figure>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
Y. Senarath, A. Mukhopadhyay, S. Vazirizade, H. Purohit, S. Nannapaneni, and
A. Dubey, “Practitioner-centric approach for early incident detection using
crowdsourced data for emergency services,” in <em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">IEEE International
Conference on Data Mining</em>, 2021, pp. 1318–1323.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
G. Pettet, H. Baxter, S. M. Vazirizade, H. Purohit, M. Ma, A. Mukhopadhyay, and
A. Dubey, “Designing decision support systems for emergency response:
Challenges and opportunities,” <em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2202.11268</em>, 2022.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
M. Wilbur, A. Dubey, B. Leão, and S. Bhattacharjee, “A decentralized
approach for real time anomaly detection in transportation networks,” in
<em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">IEEE International Conference on Smart Computing</em>, 2019, pp. 274–282.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
F. Harrou, A. Zeroual, and Y. Sun, “Traffic congestion monitoring using an
improved knn strategy,” <em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">Measurement</em>, vol. 156, p. 107534, 2020.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
P. Mercader and J. Haddad, “Automatic incident detection on freeways based on
bluetooth traffic monitoring,” <em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">Accident Analysis &amp; Prevention</em>, vol.
146, p. 105703, 2020.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
H. Z. Moayedi and M. Masnadi-Shirazi, “Arima model for network traffic
prediction and anomaly detection,” in <em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">2008 International Symposium on
Information Technology</em>, vol. 4, 2008, pp. 1–6.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
D. Rezende and S. Mohamed, “Variational inference with normalizing flows,” in
<em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, 2015, pp. 1530–1538.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
L. Dinh, J. Sohl-Dickstein, and S. Bengio, “Density estimation using real
nvp,” <em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1605.08803</em>, 2016.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
I. Kobyzev, S. Prince, and M. Brubaker, “Normalizing flows: An introduction
and review of current methods,” <em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Pattern Analysis
and Machine Intelligence</em>, 2020.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
K. K. Dixon, C.-H. Wu, W. Sarasua, and J. Daniel, “Posted and free-flow speeds
for rural multilane highways in georgia,” <em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">Journal of Transportation
Engineering</em>, vol. 125, no. 6, pp. 487–494, 1999.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
H. Park, A. Haghani, and M. Hamedi, “Quantifying non-recurring congestion
impact on secondary incidents using probe vehicle data,” Tech. Rep., 2013.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
A. Pankaj, “A comprehensive study on the estimation of freeway travel time
index and the effect of traffic data quality,” Ph.D. dissertation, The
University of Wisconsin-Milwaukee, 2019.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
S. Lloyd, “Least squares quantization in pcm,” <em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">IEEE transactions on
information theory</em>, vol. 28, no. 2, pp. 129–137, 1982.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
E. Schubert, J. Sander, M. Ester, H. P. Kriegel, and X. Xu, “Dbscan revisited,
revisited: why and how you should (still) use dbscan,” <em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">ACM
Transactions on Database Systems (TODS)</em>, vol. 42, no. 3, pp. 1–21, 2017.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
D. J. Berndt and J. Clifford, “Using dynamic time warping to find patterns in
time series.” in <em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">KDD workshop</em>, vol. 10, no. 16.   Seattle, WA, USA:, 1994, pp. 359–370.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
M. Ankerst, M. M. Breunig, H.-P. Kriegel, and J. Sander, “Optics: Ordering
points to identify the clustering structure,” <em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">ACM Sigmod record</em>,
vol. 28, no. 2, pp. 49–60, 1999.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
S. Hochreiter and J. Schmidhuber, “Long short-term memory,” <em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">Neural
computation</em>, vol. 9, no. 8, pp. 1735–1780, 1997.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
D. P. Kingma and J. Ba, “Adam: A method for stochastic optimization,”
<em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1412.6980</em>, 2014.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
A. Siffer, P.-A. Fouque, A. Termier, and C. Largouet, “Anomaly detection in
streams with extreme value theory,” in <em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 23rd ACM
SIGKDD International Conference on Knowledge Discovery and Data Mining</em>,
2017, pp. 1067–1075.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
Y. Su, Y. Zhao, C. Niu, R. Liu, W. Sun, and D. Pei, “Robust anomaly detection
for multivariate time series through stochastic recurrent neural network,”
in <em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 25th ACM SIGKDD international conference on
knowledge discovery &amp; data mining</em>, 2019, pp. 2828–2837.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
K.-H. Lai, D. Zha, G. Wang, J. Xu, Y. Zhao, D. Kumar, Y. Chen, P. Zumkhawaka,
M. Wan, D. Martinez <em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">et al.</em>, “Tods: An automated time series outlier
detection system,” <em id="bib.bib21.2.2" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2009.09822</em>, 2020.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
S. Hawkins, H. He, G. Williams, and R. Baxter, “Outlier detection using
replicator neural networks,” in <em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">International Conference on Data
Warehousing and Knowledge Discovery</em>.   Springer, 2002, pp. 170–180.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
P. Malhotra, A. Ramakrishnan, G. Anand, L. Vig, P. Agarwal, and G. Shroff,
“Lstm-based encoder-decoder for multi-sensor anomaly detection,”
<em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1607.00148</em>, 2016.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
M. Du, F. Li, G. Zheng, and V. Srikumar, “Deeplog: Anomaly detection and
diagnosis from system logs through deep learning,” in <em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">Proceedings of
the 2017 ACM SIGSAC conference on computer and communications security</em>,
2017, pp. 1285–1298.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
I. Goodfellow, Y. Bengio, and A. Courville, <em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">Deep learning</em>.   MIT press, 2016.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
Y. Hu, A. Qu, and D. Work, “Graph convolutional networks for traffic
anomaly,” <em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2012.13637</em>, 2020.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
C. Madarash-Hill and J. Hill, “Enhancing access to ieee conference
proceedings: a case study in the application of ieee xplore full text and
table of contents enhancements,” <em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">Science &amp; Technology Libraries</em>,
vol. 24, no. 3-4, pp. 389–399, 2004.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
A. Chevrot, A. Vernotte, and B. Legeard, “Cae: Contextual auto-encoder for
multivariate time-series anomaly detection in air transportation,”
<em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">Computers &amp; Security</em>, p. 102652, 2022.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
G. Pang, C. Shen, L. Cao, and A. V. D. Hengel, “Deep learning for anomaly
detection: A review,” <em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">ACM Computing Surveys (CSUR)</em>, vol. 54, no. 2,
pp. 1–38, 2021.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
C. Zhang, S. Li, H. Zhang, and Y. Chen, “Velc: A new variational autoencoder
based model for time series anomaly detection,” <em id="bib.bib30.1.1" class="ltx_emph ltx_font_italic">arXiv preprint
arXiv:1907.01702</em>, 2019.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
D. Park, Y. Hoshi, and C. C. Kemp, “A multimodal anomaly detector for
robot-assisted feeding using an lstm-based variational autoencoder,”
<em id="bib.bib31.1.1" class="ltx_emph ltx_font_italic">IEEE Robotics and Automation Letters</em>, vol. 3, no. 3, pp. 1544–1551,
2018.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
S. Lin, R. Clark, R. Birke, S. Schönborn, N. Trigoni, and S. Roberts,
“Anomaly detection for time series using vae-lstm hybrid model,” in
<em id="bib.bib32.1.1" class="ltx_emph ltx_font_italic">ICASSP 2020-2020 IEEE International Conference on Acoustics, Speech and
Signal Processing</em>, 2020, pp. 4322–4326.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
P. Malhotra, L. Vig, G. Shroff, and P. Agarwal, “Long short term memory
networks for anomaly detection in time series,” in <em id="bib.bib33.1.1" class="ltx_emph ltx_font_italic">Proceedings</em>,
vol. 89, 2015, pp. 89–94.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
K. Hundman, V. Constantinou, C. Laporte, I. Colwell, and T. Soderstrom,
“Detecting spacecraft anomalies using lstms and nonparametric dynamic
thresholding,” in <em id="bib.bib34.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 24th ACM SIGKDD international
conference on knowledge discovery &amp; data mining</em>, 2018, pp. 387–395.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock">
D. Nam, R. Lavanya, R. Jayakrishnan, I. Yang, and W. H. Jeon, “A deep learning
approach for estimating traffic density using data obtained from connected
and autonomous probes,” <em id="bib.bib35.1.1" class="ltx_emph ltx_font_italic">Sensors</em>, vol. 20, no. 17, p. 4824, 2020.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock">
Z. Zhao, W. Chen, X. Wu, P. C. Chen, and J. Liu, “Lstm network: a deep
learning approach for short-term traffic forecast,” <em id="bib.bib36.1.1" class="ltx_emph ltx_font_italic">Intelligent
Transport Systems</em>, vol. 11, no. 2, pp. 68–75, 2017.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock">
Y.-y. Chen, Y. Lv, Z. Li, and F.-Y. Wang, “Long short-term memory model for
traffic congestion prediction with online open data,” in <em id="bib.bib37.1.1" class="ltx_emph ltx_font_italic">2016 IEEE
19th International Conference on Intelligent Transportation Systems</em>, 2016,
pp. 132–137.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock">
R. L. Abduljabbar, H. Dia, and P.-W. Tsai, “Development and evaluation of
bidirectional lstm freeway traffic forecasting models using simulation
data,” <em id="bib.bib38.1.1" class="ltx_emph ltx_font_italic">Scientific reports</em>, vol. 11, no. 1, pp. 1–16, 2021.

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock">
S. Basak, A. Dubey, and L. Bruno, “Analyzing the cascading effect of traffic
congestion using lstm networks,” in <em id="bib.bib39.1.1" class="ltx_emph ltx_font_italic">2019 IEEE International Conference
on Big Data (Big Data)</em>, 2019, pp. 2144–2153.

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock">
S. Basak, A. Ayman, A. Laszka, A. Dubey, and B. Leao, “Data-driven detection
of anomalies and cascading failures in traffic networks,” in <em id="bib.bib40.1.1" class="ltx_emph ltx_font_italic">Annual
Conference of the PHM Society 2019</em>, vol. 11, no. 1, 2019.

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock">
W. Wu, L. He, W. Lin, Y. Su, Y. Cui, C. Maple, and S. A. Jarvis, “Developing
an unsupervised real-time anomaly detection scheme for time series with
multi-seasonality,” <em id="bib.bib41.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Knowledge and Data
Engineering</em>, 2020.

</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[42]</span>
<span class="ltx_bibblock">
G. Loganathan, J. Samarabandu, and X. Wang, “Sequence to sequence pattern
learning algorithm for real-time anomaly detection in network traffic,” in
<em id="bib.bib42.1.1" class="ltx_emph ltx_font_italic">2018 IEEE Canadian Conference on Electrical &amp; Computer Engineering
(CCECE)</em>.   IEEE, 2018, pp. 1–4.

</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[43]</span>
<span class="ltx_bibblock">
S. Hao, D.-H. Lee, and D. Zhao, “Sequence to sequence learning with attention
mechanism for short-term passenger flow prediction in large-scale metro
system,” <em id="bib.bib43.1.1" class="ltx_emph ltx_font_italic">Transportation Research Part C: Emerging Technologies</em>, vol.
107, pp. 287–300, 2019.

</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[44]</span>
<span class="ltx_bibblock">
M.-F. Chiang, E.-P. Lim, W.-C. Lee, and A. T. Kwee, “Btci: A new framework for
identifying congestion cascades using bus trajectory data,” in <em id="bib.bib44.1.1" class="ltx_emph ltx_font_italic">2017
IEEE International Conference on Big Data (Big Data)</em>.   IEEE, 2017, pp. 1133–1142.

</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[45]</span>
<span class="ltx_bibblock">
M. L. Dias, C. L. C. Mattos, T. L. da Silva, J. A. F. de Macedo, and W. C.
Silva, “Anomaly detection in trajectory data with normalizing flows,” in
<em id="bib.bib45.1.1" class="ltx_emph ltx_font_italic">2020 International Joint Conference on Neural Networks (IJCNN)</em>.   IEEE, 2020, pp. 1–8.

</span>
</li>
<li id="bib.bib46" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[46]</span>
<span class="ltx_bibblock">
M. M. Breunig, H.-P. Kriegel, R. T. Ng, and J. Sander, “Lof: identifying
density-based local outliers,” in <em id="bib.bib46.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 2000 ACM SIGMOD
international conference on Management of data</em>, 2000, pp. 93–104.

</span>
</li>
<li id="bib.bib47" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[47]</span>
<span class="ltx_bibblock">
D. A. Reynolds, “Gaussian mixture models.” <em id="bib.bib47.1.1" class="ltx_emph ltx_font_italic">Encyclopedia of biometrics</em>,
vol. 741, no. 659-663, 2009.

</span>
</li>
<li id="bib.bib48" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[48]</span>
<span class="ltx_bibblock">
V. Hodge and J. Austin, “A survey of outlier detection methodologies,”
<em id="bib.bib48.1.1" class="ltx_emph ltx_font_italic">Artificial intelligence review</em>, vol. 22, no. 2, pp. 85–126, 2004.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2206.14596" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2206.14597" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2206.14597">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2206.14597" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2206.14598" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Sat Dec 24 18:52:46 2022 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span style="font-size:70%;position:relative; bottom:2.2pt;">A</span>T<span style="position:relative; bottom:-0.4ex;">E</span></span><span class="ltx_font_smallcaps">xml</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="[LOGO]"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
