<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>[2205.04725] Weakly-supervised segmentation ofreferring expressions</title><meta property="og:description" content="Visual grounding localizes regions (boxes or segments) in the image
corresponding to given referring expressions. In this work we address image
segmentation from referring expressions, a problem that has so far only be…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Weakly-supervised segmentation ofreferring expressions">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Weakly-supervised segmentation ofreferring expressions">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2205.04725">

<!--Generated on Sun Jun  5 19:50:51 2022 by LaTeXML (version 0.8.6) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="keywords" lang="en" content="Weakly-supervised learning,  referring expression segmentation,  visual
grounding,  vision and language.
">

<script>
  function detectColorScheme(){
    var theme="dark";
    var current_theme = localStorage.getItem("halloween_theme");
    if(current_theme){
      if(current_theme == "light"){
        theme = "light";
      } }
    else if(!window.matchMedia) { return false; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("halloween_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("halloween_theme", "dark"); }
      else {
        localStorage.setItem("halloween_theme", "light"); } }
    else {
        localStorage.setItem("halloween_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv.0.7.5.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.1.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Weakly-supervised segmentation of
<br class="ltx_break">referring expressions</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Robin Strudel
</span><span class="ltx_author_notes">Inria, Ecole normale supérieure, CNRS,
<br class="ltx_break">PSL Research University, 75005
Paris, France.
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Ivan Laptev
</span><span class="ltx_author_notes">Inria, Ecole normale supérieure, CNRS,
<br class="ltx_break">PSL Research University, 75005
Paris, France.
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Cordelia Schmid
</span><span class="ltx_author_notes">Inria, Ecole normale supérieure, CNRS,
<br class="ltx_break">PSL Research University, 75005
Paris, France.
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id1.id1" class="ltx_p">Visual grounding localizes regions (boxes or segments) in the image
corresponding to given referring expressions. In this work we address image
segmentation from referring expressions, a problem that has so far only been
addressed in a fully-supervised setting. A fully-supervised setup, however,
requires pixel-wise supervision and is hard to scale given the expense of manual
annotation. We therefore introduce a new task of weakly-supervised image
segmentation from referring expressions and propose Text grounded semantic
SEGgmentation (TSEG) that learns segmentation masks directly from image-level
referring expressions without pixel-level annotations. Our transformer-based
method computes patch-text similarities and guides the classification objective
during training with a new multi-label patch assignment mechanism. The resulting
visual grounding model segments image regions corresponding to given natural
language expressions. Our approach TSEG demonstrates promising results for
weakly-supervised referring expression segmentation on the challenging
<span id="id1.id1.1" class="ltx_text">PhraseCut</span> and <span id="id1.id1.2" class="ltx_text">RefCOCO</span> datasets. TSEG also shows competitive
performance when evaluated in a zero-shot setting for semantic segmentation on
Pascal VOC.</p>
</div>
<div class="ltx_keywords">
<h6 class="ltx_title ltx_title_keywords">Keywords: </h6>Weakly-supervised learning, referring expression segmentation, visual
grounding, vision and language.

</div>
<figure id="S0.F1" class="ltx_figure"><img src="/html/2205.04725/assets/x1.png" id="S0.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="829" height="379" alt="">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S0.F1.4.1.1" class="ltx_text" style="font-size:90%;">Figure 1</span>: </span><span id="S0.F1.5.2" class="ltx_text" style="font-size:90%;">Given an image and a set of referring expressions such as <span id="S0.F1.5.2.1" class="ltx_text ltx_font_italic">man sitting
on grass</span> and <span id="S0.F1.5.2.2" class="ltx_text ltx_font_italic">wooden stairway</span>, TSEG segments the image regions corresponding to the input expressions. Here we show results of our approach TSEG for a test image of the PhraseCut dataset.
Contrary to other existing methods, TSEG only uses image-level referring expressions during training and hence does not require pixel-wise supervision.

</span></figcaption>
</figure>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Image segmentation is a key component for a wide range of applications including
virtual presence, virtual try on, movie post production and autonomous driving.
Powered by modern neural networks and supervised learning, image segmentation
has been significantly advanced by recent
work <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>, <a href="#bib.bib42" title="" class="ltx_ref">42</a>, <a href="#bib.bib53" title="" class="ltx_ref">53</a>]</cite>. While most of this work
addresses semantic segmentation, the more general problem of visual grounding
beyond segmentation of pre-defined object classes remains open. Moreover, the
majority of existing method assume full supervision and require costly
pixel-wise manual labeling of training images which prevents scalability.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Manual supervision has been recognized as a bottleneck in many vision tasks
including object detection <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib30" title="" class="ltx_ref">30</a>, <a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite> and
segmentation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib18" title="" class="ltx_ref">18</a>, <a href="#bib.bib68" title="" class="ltx_ref">68</a>]</cite>, text-image and text-video
matching <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib44" title="" class="ltx_ref">44</a>, <a href="#bib.bib47" title="" class="ltx_ref">47</a>]</cite> and human action
recognition <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>. To this end,
self-supervised methods explore regularities in images and videos and learn
transferable visual representations without manual
supervision <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>, <a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>. Other weakly-supervised
methods exploit partial and possibly noisy supervision that is either
readily-available or less costly to
annotate <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib44" title="" class="ltx_ref">44</a>]</cite>. In particular, weakly-supervised
methods for image segmentation avoid the costly pixel-wise annotation and limit
supervision to image-level labels <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib18" title="" class="ltx_ref">18</a>, <a href="#bib.bib68" title="" class="ltx_ref">68</a>]</cite>. Such
methods, however, remain restricted to predefined sets of classes.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">A referring expression is a short text describing a visual entity such
as <span id="S1.p3.1.1" class="ltx_text ltx_font_italic">man sitting on grass</span> or <span id="S1.p3.1.2" class="ltx_text ltx_font_italic">wooden stairway</span>, see Fig. <a href="#S0.F1" title="Figure 1 ‣ Weakly-supervised segmentation of referring expressions" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. The task of referring expression segmentation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>, <a href="#bib.bib64" title="" class="ltx_ref">64</a>]</cite>
generalizes image segmentation from pre-defined object classes to free-form
text. Given an input image and text queries (referring expressions), one should
generate image segments for each referring expression. This enables
segmentation using compositional referring expressions such as <span id="S1.p3.1.3" class="ltx_text ltx_font_italic">man
sitting on grass</span> and <span id="S1.p3.1.4" class="ltx_text ltx_font_italic">wooden stairway</span>.
Despite the promise of scalability, existing approaches to referring expression
segmentation require pixel-wise annotation and, hence, remain limited by the
size of existing datasets.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">Our work aims to advance image segmentation beyond limitations imposed by the
pre-defined sets of object classes and the costly pixel-wise manual annotations.
Towards this goal, we propose and address the new task of <span id="S1.p4.1.1" class="ltx_text ltx_font_italic">weakly-supervised
referring expression segmentation</span>. As this task comprises difficulties of the
weakly-supervised segmentation and referring expression segmentation, it
introduces new challenges. In particular, existing weakly-supervised methods
for image segmentation typically rely on the completeness of image-level labels,
i.e., the absence of a car in the annotation implies its absence in the image.
This completeness assumption does not hold for referring expression
segmentation. Furthermore, the vocabulary is open and compositional.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">To address the above challenges and to learn segmentation from text-based
image-level supervision, we introduce a new global weighted pooling mechanism
denoted as Multi-label Patch Assignment (MPA). Our method for Text grounded
semantic SEGgmentation (TSEG) incorporates MPA and extends the recent
transformer-based Segmenter architecture <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib53" title="" class="ltx_ref">53</a>]</cite> to referring
expression segmentation. We validate our method and demonstrate its encouraging
results for the task of weakly-supervised referring expression segmentation on
the challenging PhraseCut <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib59" title="" class="ltx_ref">59</a>]</cite> and RefCOCO <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib65" title="" class="ltx_ref">65</a>]</cite> datasets. We also evaluate TSEG
in a zero-shot setting for semantic segmentation and obtain competitive performance on the Pascal VOC dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>.</p>
</div>
<div id="S1.p6" class="ltx_para">
<p id="S1.p6.1" class="ltx_p">In summary, our work makes the following three contributions. (i) We introduce
the new task of weakly-supervised referring expression segmentation and propose
an evaluation based on the PhraseCut and RefCOCO datasets. (ii) We propose
TSEG, a new method addressing weakly-supervised referring expression
segmentation with a multi-label patch assignment score. (iii) We demonstrate
advantages of TSEG through a number of ablations and experimental comparisons on
the challenging PhraseCut and RefCOCO datasets. Furthermore, we demonstrate
competitive results for zero shot semantic segmentation on PASCAL VOC.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>

<div id="S2.p1" class="ltx_para ltx_noindent">
<p id="S2.p1.1" class="ltx_p"><span id="S2.p1.1.1" class="ltx_text ltx_font_bold">Weakly-supervised semantic segmentation.</span> Given an image as
input, the goal of semantic segmentation is to identify and localize classes
present in the image, e.g. annotate each pixel of the input image with a class
label. Weakly-supervised Semantic Segmentation (WSS) has been introduced by
<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib68" title="" class="ltx_ref">68</a>]</cite> and trains models using only image labels as supervision.
Zhou <span id="S2.p1.1.2" class="ltx_text ltx_font_italic">et al.</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib68" title="" class="ltx_ref">68</a>]</cite> use Class Activation Maps (CAMs) of a Fully
Convolutional Network (FCN) combined with Global Average Pooling (GAP) to obtain
segmentation maps with a pooling mechanism. As CAMs tend to focus on most
discriminative object parts <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib57" title="" class="ltx_ref">57</a>]</cite>, recent methods deploy more elaborate
multi-stage approaches using pixel affinity <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>, <a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>, saliency
estimation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>, <a href="#bib.bib18" title="" class="ltx_ref">18</a>, <a href="#bib.bib27" title="" class="ltx_ref">27</a>, <a href="#bib.bib35" title="" class="ltx_ref">35</a>, <a href="#bib.bib56" title="" class="ltx_ref">56</a>, <a href="#bib.bib66" title="" class="ltx_ref">66</a>]</cite> or seed and
expand strategies <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>, <a href="#bib.bib33" title="" class="ltx_ref">33</a>, <a href="#bib.bib57" title="" class="ltx_ref">57</a>]</cite>.</p>
</div>
<div id="S2.p2" class="ltx_para">
<p id="S2.p2.1" class="ltx_p">While these methods provide improved segmentation, they require multiple
standalone and often expensive networks such as saliency
detectors <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>, <a href="#bib.bib27" title="" class="ltx_ref">27</a>, <a href="#bib.bib66" title="" class="ltx_ref">66</a>]</cite> or segmentation networks based on
pixel-level affinity <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>, <a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>. Single-stage methods have been
developed based on multiple instance learning (MIL) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib46" title="" class="ltx_ref">46</a>]</cite> or
expectation-maximization (EM) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib45" title="" class="ltx_ref">45</a>]</cite> approaches where masks are
inferred from intermediate predictions. Single-stage methods have been
overlooked given their inferior accuracy until the work of Araslanov <span id="S2.p2.1.1" class="ltx_text ltx_font_italic">et
al.</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite> that proposed an efficient single-stage method
addressing the limitations of CAMs. Araslanov <span id="S2.p2.1.2" class="ltx_text ltx_font_italic">et al.</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>
introduces a global weighted pooling (GWP) mechanism which we extend in this
work with a new multi-label patch assignment mechanism (MPA). In contrast to
prior work on weakly-supervised semantic segmentation, TSEG is a single-stage
method that scales to the challenging task of referring expression segmentation.
<br class="ltx_break"></p>
</div>
<div id="S2.p3" class="ltx_para ltx_noindent">
<p id="S2.p3.1" class="ltx_p"><span id="S2.p3.1.1" class="ltx_text ltx_font_bold">Referring expression segmentation.</span>
Given an image and a referring expression, the goal of referring expression
segmentation is to annotate the input image with a binary mask localizing the
referring expression. A fully-supervised method <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite> proposed to first
combine features of a CNN with a LSTM and then decode them with
a FCN. To improve segmentation masks, <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib64" title="" class="ltx_ref">64</a>]</cite> uses a two-stage method based
on Mask-RCNN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite> features combined with a LSTM. To overcome the
limitation of FCN to model global context and learn richer cross-modal
features, <span id="S2.p3.1.2" class="ltx_text ltx_font_italic">state-of-the-art</span> approaches <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>, <a href="#bib.bib25" title="" class="ltx_ref">25</a>, <a href="#bib.bib63" title="" class="ltx_ref">63</a>]</cite> use a
decoding scheme based on cross-modal attention. Despite their effectiveness,
these methods are fully-supervised which limits their scalability. Several
weakly-supervised approaches tackle detection tasks such as referring expression
comprehension <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib21" title="" class="ltx_ref">21</a>, <a href="#bib.bib40" title="" class="ltx_ref">40</a>, <a href="#bib.bib41" title="" class="ltx_ref">41</a>, <a href="#bib.bib60" title="" class="ltx_ref">60</a>]</cite> by enforcing
visual consistency <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>, learning language reconstruction
<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite> or with a contrastive-learning objective <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>. These
methods rely on an off-the-shelf object detector, Faster-RCNN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib49" title="" class="ltx_ref">49</a>]</cite>, to
generate region proposals and are thus limited by the object detector accuracy.
None of these weakly-supervised methods address the problem of referring
expression segmentation which is the focus of our work. TSEG is a novel
approach that tackles weakly-supervised referring expression segmentation based
on the computation of patch-text similarities with a new multi-label patch assignment mechanism (MPA). 
<br class="ltx_break"></p>
</div>
<div id="S2.p4" class="ltx_para ltx_noindent">
<p id="S2.p4.1" class="ltx_p"><span id="S2.p4.1.1" class="ltx_text ltx_font_bold">Transformers for vision and language.</span> Transformers
<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib55" title="" class="ltx_ref">55</a>]</cite> are now state of the art in many natural language processing
(NLP) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite> and computer vision
<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>, <a href="#bib.bib15" title="" class="ltx_ref">15</a>, <a href="#bib.bib42" title="" class="ltx_ref">42</a>, <a href="#bib.bib53" title="" class="ltx_ref">53</a>]</cite> tasks. Such methods capture
long-range dependencies among tokens (patches or words) with an attention
mechanism and achieve impressive results in the context of vision-language
pre-training at scale with methods such as CLIP <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib47" title="" class="ltx_ref">47</a>]</cite>, VisualBERT
<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib38" title="" class="ltx_ref">38</a>]</cite>, DALL-E <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib48" title="" class="ltx_ref">48</a>]</cite> or ALIGN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite>. Specific to referring
expressions, MDETR <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite> recently proposed a method for visual
grounding based on a cross-modal transformer decoder trained on a
fully-supervised visual grounding task. Several methods perform zero-shot
semantic segmentation with pre-trained fully supervision
models <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>, <a href="#bib.bib62" title="" class="ltx_ref">62</a>, <a href="#bib.bib67" title="" class="ltx_ref">67</a>, <a href="#bib.bib69" title="" class="ltx_ref">69</a>]</cite>. Most similar to our
work, GroupViT <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib61" title="" class="ltx_ref">61</a>]</cite> relies on a large dataset of 30M image-text pairs to
learn segmentation masks from text supervision, but the objective function and
model architecture are different.</p>
</div>
<div id="S2.p5" class="ltx_para">
<p id="S2.p5.1" class="ltx_p">Our TSEG approach aims to learn patch-text associations while using only image-level
annotations with referring expression. TSEG
builds on CLIP <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib47" title="" class="ltx_ref">47</a>]</cite> and uses separate encoders for different
modalities with a cross-modal late-interaction mechanism. Its segmentation
module builds on Segmenter <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib53" title="" class="ltx_ref">53</a>]</cite> which shows that interpolating patch
features output by a Vision Transformer (ViT) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite> is a simple and
effective way to perform semantic segmentation. Here, we extend this work to
perform cross-modal segmentation. TSEG leverages a novel patch-text interaction
mechanism to compute both image-text matching scores and pixel-level
text-grounded segmentation maps in a single forward pass.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Method</h2>

<figure id="S3.F2" class="ltx_figure"><img src="/html/2205.04725/assets/x2.png" id="S3.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="830" height="344" alt="">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S3.F2.2.1.1" class="ltx_text" style="font-size:90%;">Figure 2</span>: </span><span id="S3.F2.3.2" class="ltx_text" style="font-size:90%;">Overview of our approach TSEG. (Left) Image patches and referring
expressions are mapped with transformers to patch and text embeddings and then compared
by computing patch-text cosine similarity scores.
(Right - Training) Our global pooling mechanism with multi-label patch assignment (MPA) reduces
patch-text similarity scores to image-level labels to train the model for referring expression classification.
(Right - Inference) Sequences of patch scores (columns) are rearranged into 2D masks and bilinearly interpolated to obtain pixel-level referring expression masks.
</span></figcaption>
</figure>
<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">TSEG takes as input an image and a number of referring expressions and outputs
a confidence score (Fig. <a href="#S3.F2" title="Figure 2 ‣ 3 Method ‣ Weakly-supervised segmentation of referring expressions" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, top-right) along with a
segmentation mask (Fig. <a href="#S3.F2" title="Figure 2 ‣ 3 Method ‣ Weakly-supervised segmentation of referring expressions" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, bottom-right) for each referring
expression. During training no segmentation masks are available and image-level
labels are used to train referring expression segmentation
(Fig. <a href="#S3.F2" title="Figure 2 ‣ 3 Method ‣ Weakly-supervised segmentation of referring expressions" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, top-right). TSEG is based on image patch-text matching
(Fig. <a href="#S3.F2" title="Figure 2 ‣ 3 Method ‣ Weakly-supervised segmentation of referring expressions" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> left). An image encoder maps the input image to a
sequence of patch tokens and a text encoder maps each input referring expression
to a single text token. The tokens are then projected to a common embedding
space and patch-text cosine similarities are computed as described in Section
<a href="#S3.SS1" title="3.1 Patch-text similarity matrix ‣ 3 Method ‣ Weakly-supervised segmentation of referring expressions" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.1</span></a>. To obtain an image-level score for each referring
expression, the patch-text similarity matrix is summarized along the patch
dimension. To do so, we introduce a novel multi-label patch assignment (MPA)
mechanism described in Section <a href="#S3.SS2" title="3.2 Global Pooling Mechanisms ‣ 3 Method ‣ Weakly-supervised segmentation of referring expressions" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.2</span></a>. The model is then
trained end-to-end to predict the corresponding image-text pairs as described in
Section <a href="#S3.SS3" title="3.3 Training and inference ‣ 3 Method ‣ Weakly-supervised segmentation of referring expressions" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.3</span></a>. At inference, the patch-text matrix is simply
interpolated for patches to obtain pixel-level masks as described in Section
<a href="#S3.SS3" title="3.3 Training and inference ‣ 3 Method ‣ Weakly-supervised segmentation of referring expressions" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.3</span></a>. The choice of an appropriate global pooling mechanism is
important to learn accurate segmentation maps as illustrated in Figure
<a href="#S3.F3" title="Figure 3 ‣ 3.2 Global Pooling Mechanisms ‣ 3 Method ‣ Weakly-supervised segmentation of referring expressions" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>. We evaluate its impact in Section
<a href="#S4" title="4 Experiments ‣ Weakly-supervised segmentation of referring expressions" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> and show that the novel multi-label patch assignment
mechanism outperforms existing ones by a significant margin.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Patch-text similarity matrix</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.7" class="ltx_p">In this section we describe how to compute the similarity matrix between patches
of an image and several referring expressions. We consider an image represented
by <math id="S3.SS1.p1.1.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S3.SS1.p1.1.m1.1a"><mi id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.1d">italic_N</annotation></semantics></math> patches <math id="S3.SS1.p1.2.m2.3" class="ltx_Math" alttext="p_{1},...,p_{N}" display="inline"><semantics id="S3.SS1.p1.2.m2.3a"><mrow id="S3.SS1.p1.2.m2.3.3.2" xref="S3.SS1.p1.2.m2.3.3.3.cmml"><msub id="S3.SS1.p1.2.m2.2.2.1.1" xref="S3.SS1.p1.2.m2.2.2.1.1.cmml"><mi id="S3.SS1.p1.2.m2.2.2.1.1.2" xref="S3.SS1.p1.2.m2.2.2.1.1.2.cmml">p</mi><mn id="S3.SS1.p1.2.m2.2.2.1.1.3" xref="S3.SS1.p1.2.m2.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p1.2.m2.3.3.2.3" xref="S3.SS1.p1.2.m2.3.3.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml">…</mi><mo id="S3.SS1.p1.2.m2.3.3.2.4" xref="S3.SS1.p1.2.m2.3.3.3.cmml">,</mo><msub id="S3.SS1.p1.2.m2.3.3.2.2" xref="S3.SS1.p1.2.m2.3.3.2.2.cmml"><mi id="S3.SS1.p1.2.m2.3.3.2.2.2" xref="S3.SS1.p1.2.m2.3.3.2.2.2.cmml">p</mi><mi id="S3.SS1.p1.2.m2.3.3.2.2.3" xref="S3.SS1.p1.2.m2.3.3.2.2.3.cmml">N</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.3b"><list id="S3.SS1.p1.2.m2.3.3.3.cmml" xref="S3.SS1.p1.2.m2.3.3.2"><apply id="S3.SS1.p1.2.m2.2.2.1.1.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.2.2.1.1.1.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1">subscript</csymbol><ci id="S3.SS1.p1.2.m2.2.2.1.1.2.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1.2">𝑝</ci><cn type="integer" id="S3.SS1.p1.2.m2.2.2.1.1.3.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1.3">1</cn></apply><ci id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">…</ci><apply id="S3.SS1.p1.2.m2.3.3.2.2.cmml" xref="S3.SS1.p1.2.m2.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.3.3.2.2.1.cmml" xref="S3.SS1.p1.2.m2.3.3.2.2">subscript</csymbol><ci id="S3.SS1.p1.2.m2.3.3.2.2.2.cmml" xref="S3.SS1.p1.2.m2.3.3.2.2.2">𝑝</ci><ci id="S3.SS1.p1.2.m2.3.3.2.2.3.cmml" xref="S3.SS1.p1.2.m2.3.3.2.2.3">𝑁</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.3c">p_{1},...,p_{N}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.2.m2.3d">italic_p start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_p start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT</annotation></semantics></math> and a set of <math id="S3.SS1.p1.3.m3.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S3.SS1.p1.3.m3.1a"><mi id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><ci id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">L</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.3.m3.1d">italic_L</annotation></semantics></math> referring expressions
<math id="S3.SS1.p1.4.m4.3" class="ltx_Math" alttext="t_{1},...,t_{L}" display="inline"><semantics id="S3.SS1.p1.4.m4.3a"><mrow id="S3.SS1.p1.4.m4.3.3.2" xref="S3.SS1.p1.4.m4.3.3.3.cmml"><msub id="S3.SS1.p1.4.m4.2.2.1.1" xref="S3.SS1.p1.4.m4.2.2.1.1.cmml"><mi id="S3.SS1.p1.4.m4.2.2.1.1.2" xref="S3.SS1.p1.4.m4.2.2.1.1.2.cmml">t</mi><mn id="S3.SS1.p1.4.m4.2.2.1.1.3" xref="S3.SS1.p1.4.m4.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p1.4.m4.3.3.2.3" xref="S3.SS1.p1.4.m4.3.3.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml">…</mi><mo id="S3.SS1.p1.4.m4.3.3.2.4" xref="S3.SS1.p1.4.m4.3.3.3.cmml">,</mo><msub id="S3.SS1.p1.4.m4.3.3.2.2" xref="S3.SS1.p1.4.m4.3.3.2.2.cmml"><mi id="S3.SS1.p1.4.m4.3.3.2.2.2" xref="S3.SS1.p1.4.m4.3.3.2.2.2.cmml">t</mi><mi id="S3.SS1.p1.4.m4.3.3.2.2.3" xref="S3.SS1.p1.4.m4.3.3.2.2.3.cmml">L</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.3b"><list id="S3.SS1.p1.4.m4.3.3.3.cmml" xref="S3.SS1.p1.4.m4.3.3.2"><apply id="S3.SS1.p1.4.m4.2.2.1.1.cmml" xref="S3.SS1.p1.4.m4.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.2.2.1.1.1.cmml" xref="S3.SS1.p1.4.m4.2.2.1.1">subscript</csymbol><ci id="S3.SS1.p1.4.m4.2.2.1.1.2.cmml" xref="S3.SS1.p1.4.m4.2.2.1.1.2">𝑡</ci><cn type="integer" id="S3.SS1.p1.4.m4.2.2.1.1.3.cmml" xref="S3.SS1.p1.4.m4.2.2.1.1.3">1</cn></apply><ci id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">…</ci><apply id="S3.SS1.p1.4.m4.3.3.2.2.cmml" xref="S3.SS1.p1.4.m4.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.3.3.2.2.1.cmml" xref="S3.SS1.p1.4.m4.3.3.2.2">subscript</csymbol><ci id="S3.SS1.p1.4.m4.3.3.2.2.2.cmml" xref="S3.SS1.p1.4.m4.3.3.2.2.2">𝑡</ci><ci id="S3.SS1.p1.4.m4.3.3.2.2.3.cmml" xref="S3.SS1.p1.4.m4.3.3.2.2.3">𝐿</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.3c">t_{1},...,t_{L}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.4.m4.3d">italic_t start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_t start_POSTSUBSCRIPT italic_L end_POSTSUBSCRIPT</annotation></semantics></math>. Patches are encoded by tokens <math id="S3.SS1.p1.5.m5.3" class="ltx_Math" alttext="(\mathbf{x}_{1},...,\mathbf{x}_{N})" display="inline"><semantics id="S3.SS1.p1.5.m5.3a"><mrow id="S3.SS1.p1.5.m5.3.3.2" xref="S3.SS1.p1.5.m5.3.3.3.cmml"><mo stretchy="false" id="S3.SS1.p1.5.m5.3.3.2.3" xref="S3.SS1.p1.5.m5.3.3.3.cmml">(</mo><msub id="S3.SS1.p1.5.m5.2.2.1.1" xref="S3.SS1.p1.5.m5.2.2.1.1.cmml"><mi id="S3.SS1.p1.5.m5.2.2.1.1.2" xref="S3.SS1.p1.5.m5.2.2.1.1.2.cmml">𝐱</mi><mn id="S3.SS1.p1.5.m5.2.2.1.1.3" xref="S3.SS1.p1.5.m5.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p1.5.m5.3.3.2.4" xref="S3.SS1.p1.5.m5.3.3.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml">…</mi><mo id="S3.SS1.p1.5.m5.3.3.2.5" xref="S3.SS1.p1.5.m5.3.3.3.cmml">,</mo><msub id="S3.SS1.p1.5.m5.3.3.2.2" xref="S3.SS1.p1.5.m5.3.3.2.2.cmml"><mi id="S3.SS1.p1.5.m5.3.3.2.2.2" xref="S3.SS1.p1.5.m5.3.3.2.2.2.cmml">𝐱</mi><mi id="S3.SS1.p1.5.m5.3.3.2.2.3" xref="S3.SS1.p1.5.m5.3.3.2.2.3.cmml">N</mi></msub><mo stretchy="false" id="S3.SS1.p1.5.m5.3.3.2.6" xref="S3.SS1.p1.5.m5.3.3.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.3b"><vector id="S3.SS1.p1.5.m5.3.3.3.cmml" xref="S3.SS1.p1.5.m5.3.3.2"><apply id="S3.SS1.p1.5.m5.2.2.1.1.cmml" xref="S3.SS1.p1.5.m5.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.2.2.1.1.1.cmml" xref="S3.SS1.p1.5.m5.2.2.1.1">subscript</csymbol><ci id="S3.SS1.p1.5.m5.2.2.1.1.2.cmml" xref="S3.SS1.p1.5.m5.2.2.1.1.2">𝐱</ci><cn type="integer" id="S3.SS1.p1.5.m5.2.2.1.1.3.cmml" xref="S3.SS1.p1.5.m5.2.2.1.1.3">1</cn></apply><ci id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1">…</ci><apply id="S3.SS1.p1.5.m5.3.3.2.2.cmml" xref="S3.SS1.p1.5.m5.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.3.3.2.2.1.cmml" xref="S3.SS1.p1.5.m5.3.3.2.2">subscript</csymbol><ci id="S3.SS1.p1.5.m5.3.3.2.2.2.cmml" xref="S3.SS1.p1.5.m5.3.3.2.2.2">𝐱</ci><ci id="S3.SS1.p1.5.m5.3.3.2.2.3.cmml" xref="S3.SS1.p1.5.m5.3.3.2.2.3">𝑁</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.3c">(\mathbf{x}_{1},...,\mathbf{x}_{N})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.5.m5.3d">( bold_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , bold_x start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT )</annotation></semantics></math>,
each referring expression consists of several words and is encoded by one token
<math id="S3.SS1.p1.6.m6.3" class="ltx_Math" alttext="(\mathbf{y}_{1},...,\mathbf{y}_{L})" display="inline"><semantics id="S3.SS1.p1.6.m6.3a"><mrow id="S3.SS1.p1.6.m6.3.3.2" xref="S3.SS1.p1.6.m6.3.3.3.cmml"><mo stretchy="false" id="S3.SS1.p1.6.m6.3.3.2.3" xref="S3.SS1.p1.6.m6.3.3.3.cmml">(</mo><msub id="S3.SS1.p1.6.m6.2.2.1.1" xref="S3.SS1.p1.6.m6.2.2.1.1.cmml"><mi id="S3.SS1.p1.6.m6.2.2.1.1.2" xref="S3.SS1.p1.6.m6.2.2.1.1.2.cmml">𝐲</mi><mn id="S3.SS1.p1.6.m6.2.2.1.1.3" xref="S3.SS1.p1.6.m6.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p1.6.m6.3.3.2.4" xref="S3.SS1.p1.6.m6.3.3.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml">…</mi><mo id="S3.SS1.p1.6.m6.3.3.2.5" xref="S3.SS1.p1.6.m6.3.3.3.cmml">,</mo><msub id="S3.SS1.p1.6.m6.3.3.2.2" xref="S3.SS1.p1.6.m6.3.3.2.2.cmml"><mi id="S3.SS1.p1.6.m6.3.3.2.2.2" xref="S3.SS1.p1.6.m6.3.3.2.2.2.cmml">𝐲</mi><mi id="S3.SS1.p1.6.m6.3.3.2.2.3" xref="S3.SS1.p1.6.m6.3.3.2.2.3.cmml">L</mi></msub><mo stretchy="false" id="S3.SS1.p1.6.m6.3.3.2.6" xref="S3.SS1.p1.6.m6.3.3.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.3b"><vector id="S3.SS1.p1.6.m6.3.3.3.cmml" xref="S3.SS1.p1.6.m6.3.3.2"><apply id="S3.SS1.p1.6.m6.2.2.1.1.cmml" xref="S3.SS1.p1.6.m6.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.2.2.1.1.1.cmml" xref="S3.SS1.p1.6.m6.2.2.1.1">subscript</csymbol><ci id="S3.SS1.p1.6.m6.2.2.1.1.2.cmml" xref="S3.SS1.p1.6.m6.2.2.1.1.2">𝐲</ci><cn type="integer" id="S3.SS1.p1.6.m6.2.2.1.1.3.cmml" xref="S3.SS1.p1.6.m6.2.2.1.1.3">1</cn></apply><ci id="S3.SS1.p1.6.m6.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1">…</ci><apply id="S3.SS1.p1.6.m6.3.3.2.2.cmml" xref="S3.SS1.p1.6.m6.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.3.3.2.2.1.cmml" xref="S3.SS1.p1.6.m6.3.3.2.2">subscript</csymbol><ci id="S3.SS1.p1.6.m6.3.3.2.2.2.cmml" xref="S3.SS1.p1.6.m6.3.3.2.2.2">𝐲</ci><ci id="S3.SS1.p1.6.m6.3.3.2.2.3.cmml" xref="S3.SS1.p1.6.m6.3.3.2.2.3">𝐿</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.3c">(\mathbf{y}_{1},...,\mathbf{y}_{L})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.6.m6.3d">( bold_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , bold_y start_POSTSUBSCRIPT italic_L end_POSTSUBSCRIPT )</annotation></semantics></math>. The resulting similarity matrix is
<math id="S3.SS1.p1.7.m7.3" class="ltx_Math" alttext="\mathbf{S}=(\mathbf{x}_{i}\cdot\mathbf{y}_{j})_{i,j}\in\mathbb{R}^{N\times L}" display="inline"><semantics id="S3.SS1.p1.7.m7.3a"><mrow id="S3.SS1.p1.7.m7.3.3" xref="S3.SS1.p1.7.m7.3.3.cmml"><mi id="S3.SS1.p1.7.m7.3.3.3" xref="S3.SS1.p1.7.m7.3.3.3.cmml">𝐒</mi><mo id="S3.SS1.p1.7.m7.3.3.4" xref="S3.SS1.p1.7.m7.3.3.4.cmml">=</mo><msub id="S3.SS1.p1.7.m7.3.3.1" xref="S3.SS1.p1.7.m7.3.3.1.cmml"><mrow id="S3.SS1.p1.7.m7.3.3.1.1.1" xref="S3.SS1.p1.7.m7.3.3.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.p1.7.m7.3.3.1.1.1.2" xref="S3.SS1.p1.7.m7.3.3.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p1.7.m7.3.3.1.1.1.1" xref="S3.SS1.p1.7.m7.3.3.1.1.1.1.cmml"><msub id="S3.SS1.p1.7.m7.3.3.1.1.1.1.2" xref="S3.SS1.p1.7.m7.3.3.1.1.1.1.2.cmml"><mi id="S3.SS1.p1.7.m7.3.3.1.1.1.1.2.2" xref="S3.SS1.p1.7.m7.3.3.1.1.1.1.2.2.cmml">𝐱</mi><mi id="S3.SS1.p1.7.m7.3.3.1.1.1.1.2.3" xref="S3.SS1.p1.7.m7.3.3.1.1.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS1.p1.7.m7.3.3.1.1.1.1.1" xref="S3.SS1.p1.7.m7.3.3.1.1.1.1.1.cmml">⋅</mo><msub id="S3.SS1.p1.7.m7.3.3.1.1.1.1.3" xref="S3.SS1.p1.7.m7.3.3.1.1.1.1.3.cmml"><mi id="S3.SS1.p1.7.m7.3.3.1.1.1.1.3.2" xref="S3.SS1.p1.7.m7.3.3.1.1.1.1.3.2.cmml">𝐲</mi><mi id="S3.SS1.p1.7.m7.3.3.1.1.1.1.3.3" xref="S3.SS1.p1.7.m7.3.3.1.1.1.1.3.3.cmml">j</mi></msub></mrow><mo stretchy="false" id="S3.SS1.p1.7.m7.3.3.1.1.1.3" xref="S3.SS1.p1.7.m7.3.3.1.1.1.1.cmml">)</mo></mrow><mrow id="S3.SS1.p1.7.m7.2.2.2.4" xref="S3.SS1.p1.7.m7.2.2.2.3.cmml"><mi id="S3.SS1.p1.7.m7.1.1.1.1" xref="S3.SS1.p1.7.m7.1.1.1.1.cmml">i</mi><mo id="S3.SS1.p1.7.m7.2.2.2.4.1" xref="S3.SS1.p1.7.m7.2.2.2.3.cmml">,</mo><mi id="S3.SS1.p1.7.m7.2.2.2.2" xref="S3.SS1.p1.7.m7.2.2.2.2.cmml">j</mi></mrow></msub><mo id="S3.SS1.p1.7.m7.3.3.5" xref="S3.SS1.p1.7.m7.3.3.5.cmml">∈</mo><msup id="S3.SS1.p1.7.m7.3.3.6" xref="S3.SS1.p1.7.m7.3.3.6.cmml"><mi id="S3.SS1.p1.7.m7.3.3.6.2" xref="S3.SS1.p1.7.m7.3.3.6.2.cmml">ℝ</mi><mrow id="S3.SS1.p1.7.m7.3.3.6.3" xref="S3.SS1.p1.7.m7.3.3.6.3.cmml"><mi id="S3.SS1.p1.7.m7.3.3.6.3.2" xref="S3.SS1.p1.7.m7.3.3.6.3.2.cmml">N</mi><mo id="S3.SS1.p1.7.m7.3.3.6.3.1" xref="S3.SS1.p1.7.m7.3.3.6.3.1.cmml">×</mo><mi id="S3.SS1.p1.7.m7.3.3.6.3.3" xref="S3.SS1.p1.7.m7.3.3.6.3.3.cmml">L</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m7.3b"><apply id="S3.SS1.p1.7.m7.3.3.cmml" xref="S3.SS1.p1.7.m7.3.3"><and id="S3.SS1.p1.7.m7.3.3a.cmml" xref="S3.SS1.p1.7.m7.3.3"></and><apply id="S3.SS1.p1.7.m7.3.3b.cmml" xref="S3.SS1.p1.7.m7.3.3"><eq id="S3.SS1.p1.7.m7.3.3.4.cmml" xref="S3.SS1.p1.7.m7.3.3.4"></eq><ci id="S3.SS1.p1.7.m7.3.3.3.cmml" xref="S3.SS1.p1.7.m7.3.3.3">𝐒</ci><apply id="S3.SS1.p1.7.m7.3.3.1.cmml" xref="S3.SS1.p1.7.m7.3.3.1"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m7.3.3.1.2.cmml" xref="S3.SS1.p1.7.m7.3.3.1">subscript</csymbol><apply id="S3.SS1.p1.7.m7.3.3.1.1.1.1.cmml" xref="S3.SS1.p1.7.m7.3.3.1.1.1"><ci id="S3.SS1.p1.7.m7.3.3.1.1.1.1.1.cmml" xref="S3.SS1.p1.7.m7.3.3.1.1.1.1.1">⋅</ci><apply id="S3.SS1.p1.7.m7.3.3.1.1.1.1.2.cmml" xref="S3.SS1.p1.7.m7.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m7.3.3.1.1.1.1.2.1.cmml" xref="S3.SS1.p1.7.m7.3.3.1.1.1.1.2">subscript</csymbol><ci id="S3.SS1.p1.7.m7.3.3.1.1.1.1.2.2.cmml" xref="S3.SS1.p1.7.m7.3.3.1.1.1.1.2.2">𝐱</ci><ci id="S3.SS1.p1.7.m7.3.3.1.1.1.1.2.3.cmml" xref="S3.SS1.p1.7.m7.3.3.1.1.1.1.2.3">𝑖</ci></apply><apply id="S3.SS1.p1.7.m7.3.3.1.1.1.1.3.cmml" xref="S3.SS1.p1.7.m7.3.3.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m7.3.3.1.1.1.1.3.1.cmml" xref="S3.SS1.p1.7.m7.3.3.1.1.1.1.3">subscript</csymbol><ci id="S3.SS1.p1.7.m7.3.3.1.1.1.1.3.2.cmml" xref="S3.SS1.p1.7.m7.3.3.1.1.1.1.3.2">𝐲</ci><ci id="S3.SS1.p1.7.m7.3.3.1.1.1.1.3.3.cmml" xref="S3.SS1.p1.7.m7.3.3.1.1.1.1.3.3">𝑗</ci></apply></apply><list id="S3.SS1.p1.7.m7.2.2.2.3.cmml" xref="S3.SS1.p1.7.m7.2.2.2.4"><ci id="S3.SS1.p1.7.m7.1.1.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1.1.1">𝑖</ci><ci id="S3.SS1.p1.7.m7.2.2.2.2.cmml" xref="S3.SS1.p1.7.m7.2.2.2.2">𝑗</ci></list></apply></apply><apply id="S3.SS1.p1.7.m7.3.3c.cmml" xref="S3.SS1.p1.7.m7.3.3"><in id="S3.SS1.p1.7.m7.3.3.5.cmml" xref="S3.SS1.p1.7.m7.3.3.5"></in><share href="#S3.SS1.p1.7.m7.3.3.1.cmml" id="S3.SS1.p1.7.m7.3.3d.cmml" xref="S3.SS1.p1.7.m7.3.3"></share><apply id="S3.SS1.p1.7.m7.3.3.6.cmml" xref="S3.SS1.p1.7.m7.3.3.6"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m7.3.3.6.1.cmml" xref="S3.SS1.p1.7.m7.3.3.6">superscript</csymbol><ci id="S3.SS1.p1.7.m7.3.3.6.2.cmml" xref="S3.SS1.p1.7.m7.3.3.6.2">ℝ</ci><apply id="S3.SS1.p1.7.m7.3.3.6.3.cmml" xref="S3.SS1.p1.7.m7.3.3.6.3"><times id="S3.SS1.p1.7.m7.3.3.6.3.1.cmml" xref="S3.SS1.p1.7.m7.3.3.6.3.1"></times><ci id="S3.SS1.p1.7.m7.3.3.6.3.2.cmml" xref="S3.SS1.p1.7.m7.3.3.6.3.2">𝑁</ci><ci id="S3.SS1.p1.7.m7.3.3.6.3.3.cmml" xref="S3.SS1.p1.7.m7.3.3.6.3.3">𝐿</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m7.3c">\mathbf{S}=(\mathbf{x}_{i}\cdot\mathbf{y}_{j})_{i,j}\in\mathbb{R}^{N\times L}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.7.m7.3d">bold_S = ( bold_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ⋅ bold_y start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_N × italic_L end_POSTSUPERSCRIPT</annotation></semantics></math>.
See Figure <a href="#S3.F2" title="Figure 2 ‣ 3 Method ‣ Weakly-supervised segmentation of referring expressions" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> left.
<br class="ltx_break"></p>
</div>
<div id="S3.SS1.p2" class="ltx_para ltx_noindent">
<p id="S3.SS1.p2.6" class="ltx_p"><span id="S3.SS1.p2.6.1" class="ltx_text ltx_font_bold">Image encoder.</span> An image <math id="S3.SS1.p2.1.m1.1" class="ltx_Math" alttext="I\in\mathbb{R}^{H\times W\times C}" display="inline"><semantics id="S3.SS1.p2.1.m1.1a"><mrow id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml"><mi id="S3.SS1.p2.1.m1.1.1.2" xref="S3.SS1.p2.1.m1.1.1.2.cmml">I</mi><mo id="S3.SS1.p2.1.m1.1.1.1" xref="S3.SS1.p2.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS1.p2.1.m1.1.1.3" xref="S3.SS1.p2.1.m1.1.1.3.cmml"><mi id="S3.SS1.p2.1.m1.1.1.3.2" xref="S3.SS1.p2.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p2.1.m1.1.1.3.3" xref="S3.SS1.p2.1.m1.1.1.3.3.cmml"><mi id="S3.SS1.p2.1.m1.1.1.3.3.2" xref="S3.SS1.p2.1.m1.1.1.3.3.2.cmml">H</mi><mo id="S3.SS1.p2.1.m1.1.1.3.3.1" xref="S3.SS1.p2.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.SS1.p2.1.m1.1.1.3.3.3" xref="S3.SS1.p2.1.m1.1.1.3.3.3.cmml">W</mi><mo id="S3.SS1.p2.1.m1.1.1.3.3.1a" xref="S3.SS1.p2.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.SS1.p2.1.m1.1.1.3.3.4" xref="S3.SS1.p2.1.m1.1.1.3.3.4.cmml">C</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><apply id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1"><in id="S3.SS1.p2.1.m1.1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1.1"></in><ci id="S3.SS1.p2.1.m1.1.1.2.cmml" xref="S3.SS1.p2.1.m1.1.1.2">𝐼</ci><apply id="S3.SS1.p2.1.m1.1.1.3.cmml" xref="S3.SS1.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.1.1.3.1.cmml" xref="S3.SS1.p2.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS1.p2.1.m1.1.1.3.2.cmml" xref="S3.SS1.p2.1.m1.1.1.3.2">ℝ</ci><apply id="S3.SS1.p2.1.m1.1.1.3.3.cmml" xref="S3.SS1.p2.1.m1.1.1.3.3"><times id="S3.SS1.p2.1.m1.1.1.3.3.1.cmml" xref="S3.SS1.p2.1.m1.1.1.3.3.1"></times><ci id="S3.SS1.p2.1.m1.1.1.3.3.2.cmml" xref="S3.SS1.p2.1.m1.1.1.3.3.2">𝐻</ci><ci id="S3.SS1.p2.1.m1.1.1.3.3.3.cmml" xref="S3.SS1.p2.1.m1.1.1.3.3.3">𝑊</ci><ci id="S3.SS1.p2.1.m1.1.1.3.3.4.cmml" xref="S3.SS1.p2.1.m1.1.1.3.3.4">𝐶</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">I\in\mathbb{R}^{H\times W\times C}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.1.m1.1d">italic_I ∈ blackboard_R start_POSTSUPERSCRIPT italic_H × italic_W × italic_C end_POSTSUPERSCRIPT</annotation></semantics></math> is split into a
sequence of patches of size <math id="S3.SS1.p2.2.m2.2" class="ltx_Math" alttext="(P,P)" display="inline"><semantics id="S3.SS1.p2.2.m2.2a"><mrow id="S3.SS1.p2.2.m2.2.3.2" xref="S3.SS1.p2.2.m2.2.3.1.cmml"><mo stretchy="false" id="S3.SS1.p2.2.m2.2.3.2.1" xref="S3.SS1.p2.2.m2.2.3.1.cmml">(</mo><mi id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml">P</mi><mo id="S3.SS1.p2.2.m2.2.3.2.2" xref="S3.SS1.p2.2.m2.2.3.1.cmml">,</mo><mi id="S3.SS1.p2.2.m2.2.2" xref="S3.SS1.p2.2.m2.2.2.cmml">P</mi><mo stretchy="false" id="S3.SS1.p2.2.m2.2.3.2.3" xref="S3.SS1.p2.2.m2.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.2b"><interval closure="open" id="S3.SS1.p2.2.m2.2.3.1.cmml" xref="S3.SS1.p2.2.m2.2.3.2"><ci id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1">𝑃</ci><ci id="S3.SS1.p2.2.m2.2.2.cmml" xref="S3.SS1.p2.2.m2.2.2">𝑃</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.2c">(P,P)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.2.m2.2d">( italic_P , italic_P )</annotation></semantics></math>. Each image patch is then linearly
projected and a position embedding is added to produce a sequence of patch
tokens
<math id="S3.SS1.p2.3.m3.3" class="ltx_Math" alttext="(p_{1},...,p_{N})\in\mathbb{R}^{N\times D_{I}}" display="inline"><semantics id="S3.SS1.p2.3.m3.3a"><mrow id="S3.SS1.p2.3.m3.3.3" xref="S3.SS1.p2.3.m3.3.3.cmml"><mrow id="S3.SS1.p2.3.m3.3.3.2.2" xref="S3.SS1.p2.3.m3.3.3.2.3.cmml"><mo stretchy="false" id="S3.SS1.p2.3.m3.3.3.2.2.3" xref="S3.SS1.p2.3.m3.3.3.2.3.cmml">(</mo><msub id="S3.SS1.p2.3.m3.2.2.1.1.1" xref="S3.SS1.p2.3.m3.2.2.1.1.1.cmml"><mi id="S3.SS1.p2.3.m3.2.2.1.1.1.2" xref="S3.SS1.p2.3.m3.2.2.1.1.1.2.cmml">p</mi><mn id="S3.SS1.p2.3.m3.2.2.1.1.1.3" xref="S3.SS1.p2.3.m3.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p2.3.m3.3.3.2.2.4" xref="S3.SS1.p2.3.m3.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml">…</mi><mo id="S3.SS1.p2.3.m3.3.3.2.2.5" xref="S3.SS1.p2.3.m3.3.3.2.3.cmml">,</mo><msub id="S3.SS1.p2.3.m3.3.3.2.2.2" xref="S3.SS1.p2.3.m3.3.3.2.2.2.cmml"><mi id="S3.SS1.p2.3.m3.3.3.2.2.2.2" xref="S3.SS1.p2.3.m3.3.3.2.2.2.2.cmml">p</mi><mi id="S3.SS1.p2.3.m3.3.3.2.2.2.3" xref="S3.SS1.p2.3.m3.3.3.2.2.2.3.cmml">N</mi></msub><mo stretchy="false" id="S3.SS1.p2.3.m3.3.3.2.2.6" xref="S3.SS1.p2.3.m3.3.3.2.3.cmml">)</mo></mrow><mo id="S3.SS1.p2.3.m3.3.3.3" xref="S3.SS1.p2.3.m3.3.3.3.cmml">∈</mo><msup id="S3.SS1.p2.3.m3.3.3.4" xref="S3.SS1.p2.3.m3.3.3.4.cmml"><mi id="S3.SS1.p2.3.m3.3.3.4.2" xref="S3.SS1.p2.3.m3.3.3.4.2.cmml">ℝ</mi><mrow id="S3.SS1.p2.3.m3.3.3.4.3" xref="S3.SS1.p2.3.m3.3.3.4.3.cmml"><mi id="S3.SS1.p2.3.m3.3.3.4.3.2" xref="S3.SS1.p2.3.m3.3.3.4.3.2.cmml">N</mi><mo id="S3.SS1.p2.3.m3.3.3.4.3.1" xref="S3.SS1.p2.3.m3.3.3.4.3.1.cmml">×</mo><msub id="S3.SS1.p2.3.m3.3.3.4.3.3" xref="S3.SS1.p2.3.m3.3.3.4.3.3.cmml"><mi id="S3.SS1.p2.3.m3.3.3.4.3.3.2" xref="S3.SS1.p2.3.m3.3.3.4.3.3.2.cmml">D</mi><mi id="S3.SS1.p2.3.m3.3.3.4.3.3.3" xref="S3.SS1.p2.3.m3.3.3.4.3.3.3.cmml">I</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.3b"><apply id="S3.SS1.p2.3.m3.3.3.cmml" xref="S3.SS1.p2.3.m3.3.3"><in id="S3.SS1.p2.3.m3.3.3.3.cmml" xref="S3.SS1.p2.3.m3.3.3.3"></in><vector id="S3.SS1.p2.3.m3.3.3.2.3.cmml" xref="S3.SS1.p2.3.m3.3.3.2.2"><apply id="S3.SS1.p2.3.m3.2.2.1.1.1.cmml" xref="S3.SS1.p2.3.m3.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.2.2.1.1.1.1.cmml" xref="S3.SS1.p2.3.m3.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.p2.3.m3.2.2.1.1.1.2.cmml" xref="S3.SS1.p2.3.m3.2.2.1.1.1.2">𝑝</ci><cn type="integer" id="S3.SS1.p2.3.m3.2.2.1.1.1.3.cmml" xref="S3.SS1.p2.3.m3.2.2.1.1.1.3">1</cn></apply><ci id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1">…</ci><apply id="S3.SS1.p2.3.m3.3.3.2.2.2.cmml" xref="S3.SS1.p2.3.m3.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.3.3.2.2.2.1.cmml" xref="S3.SS1.p2.3.m3.3.3.2.2.2">subscript</csymbol><ci id="S3.SS1.p2.3.m3.3.3.2.2.2.2.cmml" xref="S3.SS1.p2.3.m3.3.3.2.2.2.2">𝑝</ci><ci id="S3.SS1.p2.3.m3.3.3.2.2.2.3.cmml" xref="S3.SS1.p2.3.m3.3.3.2.2.2.3">𝑁</ci></apply></vector><apply id="S3.SS1.p2.3.m3.3.3.4.cmml" xref="S3.SS1.p2.3.m3.3.3.4"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.3.3.4.1.cmml" xref="S3.SS1.p2.3.m3.3.3.4">superscript</csymbol><ci id="S3.SS1.p2.3.m3.3.3.4.2.cmml" xref="S3.SS1.p2.3.m3.3.3.4.2">ℝ</ci><apply id="S3.SS1.p2.3.m3.3.3.4.3.cmml" xref="S3.SS1.p2.3.m3.3.3.4.3"><times id="S3.SS1.p2.3.m3.3.3.4.3.1.cmml" xref="S3.SS1.p2.3.m3.3.3.4.3.1"></times><ci id="S3.SS1.p2.3.m3.3.3.4.3.2.cmml" xref="S3.SS1.p2.3.m3.3.3.4.3.2">𝑁</ci><apply id="S3.SS1.p2.3.m3.3.3.4.3.3.cmml" xref="S3.SS1.p2.3.m3.3.3.4.3.3"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.3.3.4.3.3.1.cmml" xref="S3.SS1.p2.3.m3.3.3.4.3.3">subscript</csymbol><ci id="S3.SS1.p2.3.m3.3.3.4.3.3.2.cmml" xref="S3.SS1.p2.3.m3.3.3.4.3.3.2">𝐷</ci><ci id="S3.SS1.p2.3.m3.3.3.4.3.3.3.cmml" xref="S3.SS1.p2.3.m3.3.3.4.3.3.3">𝐼</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.3c">(p_{1},...,p_{N})\in\mathbb{R}^{N\times D_{I}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.3.m3.3d">( italic_p start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_p start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ) ∈ blackboard_R start_POSTSUPERSCRIPT italic_N × italic_D start_POSTSUBSCRIPT italic_I end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>
where <math id="S3.SS1.p2.4.m4.1" class="ltx_Math" alttext="N=HW/P^{2}" display="inline"><semantics id="S3.SS1.p2.4.m4.1a"><mrow id="S3.SS1.p2.4.m4.1.1" xref="S3.SS1.p2.4.m4.1.1.cmml"><mi id="S3.SS1.p2.4.m4.1.1.2" xref="S3.SS1.p2.4.m4.1.1.2.cmml">N</mi><mo id="S3.SS1.p2.4.m4.1.1.1" xref="S3.SS1.p2.4.m4.1.1.1.cmml">=</mo><mrow id="S3.SS1.p2.4.m4.1.1.3" xref="S3.SS1.p2.4.m4.1.1.3.cmml"><mrow id="S3.SS1.p2.4.m4.1.1.3.2" xref="S3.SS1.p2.4.m4.1.1.3.2.cmml"><mi id="S3.SS1.p2.4.m4.1.1.3.2.2" xref="S3.SS1.p2.4.m4.1.1.3.2.2.cmml">H</mi><mo id="S3.SS1.p2.4.m4.1.1.3.2.1" xref="S3.SS1.p2.4.m4.1.1.3.2.1.cmml">⁢</mo><mi id="S3.SS1.p2.4.m4.1.1.3.2.3" xref="S3.SS1.p2.4.m4.1.1.3.2.3.cmml">W</mi></mrow><mo id="S3.SS1.p2.4.m4.1.1.3.1" xref="S3.SS1.p2.4.m4.1.1.3.1.cmml">/</mo><msup id="S3.SS1.p2.4.m4.1.1.3.3" xref="S3.SS1.p2.4.m4.1.1.3.3.cmml"><mi id="S3.SS1.p2.4.m4.1.1.3.3.2" xref="S3.SS1.p2.4.m4.1.1.3.3.2.cmml">P</mi><mn id="S3.SS1.p2.4.m4.1.1.3.3.3" xref="S3.SS1.p2.4.m4.1.1.3.3.3.cmml">2</mn></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m4.1b"><apply id="S3.SS1.p2.4.m4.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1"><eq id="S3.SS1.p2.4.m4.1.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1.1"></eq><ci id="S3.SS1.p2.4.m4.1.1.2.cmml" xref="S3.SS1.p2.4.m4.1.1.2">𝑁</ci><apply id="S3.SS1.p2.4.m4.1.1.3.cmml" xref="S3.SS1.p2.4.m4.1.1.3"><divide id="S3.SS1.p2.4.m4.1.1.3.1.cmml" xref="S3.SS1.p2.4.m4.1.1.3.1"></divide><apply id="S3.SS1.p2.4.m4.1.1.3.2.cmml" xref="S3.SS1.p2.4.m4.1.1.3.2"><times id="S3.SS1.p2.4.m4.1.1.3.2.1.cmml" xref="S3.SS1.p2.4.m4.1.1.3.2.1"></times><ci id="S3.SS1.p2.4.m4.1.1.3.2.2.cmml" xref="S3.SS1.p2.4.m4.1.1.3.2.2">𝐻</ci><ci id="S3.SS1.p2.4.m4.1.1.3.2.3.cmml" xref="S3.SS1.p2.4.m4.1.1.3.2.3">𝑊</ci></apply><apply id="S3.SS1.p2.4.m4.1.1.3.3.cmml" xref="S3.SS1.p2.4.m4.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.1.1.3.3.1.cmml" xref="S3.SS1.p2.4.m4.1.1.3.3">superscript</csymbol><ci id="S3.SS1.p2.4.m4.1.1.3.3.2.cmml" xref="S3.SS1.p2.4.m4.1.1.3.3.2">𝑃</ci><cn type="integer" id="S3.SS1.p2.4.m4.1.1.3.3.3.cmml" xref="S3.SS1.p2.4.m4.1.1.3.3.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m4.1c">N=HW/P^{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.4.m4.1d">italic_N = italic_H italic_W / italic_P start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math> is the number of patches, <math id="S3.SS1.p2.5.m5.1" class="ltx_Math" alttext="D_{I}" display="inline"><semantics id="S3.SS1.p2.5.m5.1a"><msub id="S3.SS1.p2.5.m5.1.1" xref="S3.SS1.p2.5.m5.1.1.cmml"><mi id="S3.SS1.p2.5.m5.1.1.2" xref="S3.SS1.p2.5.m5.1.1.2.cmml">D</mi><mi id="S3.SS1.p2.5.m5.1.1.3" xref="S3.SS1.p2.5.m5.1.1.3.cmml">I</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.5.m5.1b"><apply id="S3.SS1.p2.5.m5.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.5.m5.1.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1">subscript</csymbol><ci id="S3.SS1.p2.5.m5.1.1.2.cmml" xref="S3.SS1.p2.5.m5.1.1.2">𝐷</ci><ci id="S3.SS1.p2.5.m5.1.1.3.cmml" xref="S3.SS1.p2.5.m5.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.5.m5.1c">D_{I}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.5.m5.1d">italic_D start_POSTSUBSCRIPT italic_I end_POSTSUBSCRIPT</annotation></semantics></math> is the number of features.
A transformer encoder maps the input
sequence to a sequence of contextualized patch tokens
<math id="S3.SS1.p2.6.m6.3" class="ltx_Math" alttext="(\mathbf{x}_{1},...,\mathbf{x}_{N})\in\mathbb{R}^{N\times D_{I}}" display="inline"><semantics id="S3.SS1.p2.6.m6.3a"><mrow id="S3.SS1.p2.6.m6.3.3" xref="S3.SS1.p2.6.m6.3.3.cmml"><mrow id="S3.SS1.p2.6.m6.3.3.2.2" xref="S3.SS1.p2.6.m6.3.3.2.3.cmml"><mo stretchy="false" id="S3.SS1.p2.6.m6.3.3.2.2.3" xref="S3.SS1.p2.6.m6.3.3.2.3.cmml">(</mo><msub id="S3.SS1.p2.6.m6.2.2.1.1.1" xref="S3.SS1.p2.6.m6.2.2.1.1.1.cmml"><mi id="S3.SS1.p2.6.m6.2.2.1.1.1.2" xref="S3.SS1.p2.6.m6.2.2.1.1.1.2.cmml">𝐱</mi><mn id="S3.SS1.p2.6.m6.2.2.1.1.1.3" xref="S3.SS1.p2.6.m6.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p2.6.m6.3.3.2.2.4" xref="S3.SS1.p2.6.m6.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.p2.6.m6.1.1" xref="S3.SS1.p2.6.m6.1.1.cmml">…</mi><mo id="S3.SS1.p2.6.m6.3.3.2.2.5" xref="S3.SS1.p2.6.m6.3.3.2.3.cmml">,</mo><msub id="S3.SS1.p2.6.m6.3.3.2.2.2" xref="S3.SS1.p2.6.m6.3.3.2.2.2.cmml"><mi id="S3.SS1.p2.6.m6.3.3.2.2.2.2" xref="S3.SS1.p2.6.m6.3.3.2.2.2.2.cmml">𝐱</mi><mi id="S3.SS1.p2.6.m6.3.3.2.2.2.3" xref="S3.SS1.p2.6.m6.3.3.2.2.2.3.cmml">N</mi></msub><mo stretchy="false" id="S3.SS1.p2.6.m6.3.3.2.2.6" xref="S3.SS1.p2.6.m6.3.3.2.3.cmml">)</mo></mrow><mo id="S3.SS1.p2.6.m6.3.3.3" xref="S3.SS1.p2.6.m6.3.3.3.cmml">∈</mo><msup id="S3.SS1.p2.6.m6.3.3.4" xref="S3.SS1.p2.6.m6.3.3.4.cmml"><mi id="S3.SS1.p2.6.m6.3.3.4.2" xref="S3.SS1.p2.6.m6.3.3.4.2.cmml">ℝ</mi><mrow id="S3.SS1.p2.6.m6.3.3.4.3" xref="S3.SS1.p2.6.m6.3.3.4.3.cmml"><mi id="S3.SS1.p2.6.m6.3.3.4.3.2" xref="S3.SS1.p2.6.m6.3.3.4.3.2.cmml">N</mi><mo id="S3.SS1.p2.6.m6.3.3.4.3.1" xref="S3.SS1.p2.6.m6.3.3.4.3.1.cmml">×</mo><msub id="S3.SS1.p2.6.m6.3.3.4.3.3" xref="S3.SS1.p2.6.m6.3.3.4.3.3.cmml"><mi id="S3.SS1.p2.6.m6.3.3.4.3.3.2" xref="S3.SS1.p2.6.m6.3.3.4.3.3.2.cmml">D</mi><mi id="S3.SS1.p2.6.m6.3.3.4.3.3.3" xref="S3.SS1.p2.6.m6.3.3.4.3.3.3.cmml">I</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.6.m6.3b"><apply id="S3.SS1.p2.6.m6.3.3.cmml" xref="S3.SS1.p2.6.m6.3.3"><in id="S3.SS1.p2.6.m6.3.3.3.cmml" xref="S3.SS1.p2.6.m6.3.3.3"></in><vector id="S3.SS1.p2.6.m6.3.3.2.3.cmml" xref="S3.SS1.p2.6.m6.3.3.2.2"><apply id="S3.SS1.p2.6.m6.2.2.1.1.1.cmml" xref="S3.SS1.p2.6.m6.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.6.m6.2.2.1.1.1.1.cmml" xref="S3.SS1.p2.6.m6.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.p2.6.m6.2.2.1.1.1.2.cmml" xref="S3.SS1.p2.6.m6.2.2.1.1.1.2">𝐱</ci><cn type="integer" id="S3.SS1.p2.6.m6.2.2.1.1.1.3.cmml" xref="S3.SS1.p2.6.m6.2.2.1.1.1.3">1</cn></apply><ci id="S3.SS1.p2.6.m6.1.1.cmml" xref="S3.SS1.p2.6.m6.1.1">…</ci><apply id="S3.SS1.p2.6.m6.3.3.2.2.2.cmml" xref="S3.SS1.p2.6.m6.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.6.m6.3.3.2.2.2.1.cmml" xref="S3.SS1.p2.6.m6.3.3.2.2.2">subscript</csymbol><ci id="S3.SS1.p2.6.m6.3.3.2.2.2.2.cmml" xref="S3.SS1.p2.6.m6.3.3.2.2.2.2">𝐱</ci><ci id="S3.SS1.p2.6.m6.3.3.2.2.2.3.cmml" xref="S3.SS1.p2.6.m6.3.3.2.2.2.3">𝑁</ci></apply></vector><apply id="S3.SS1.p2.6.m6.3.3.4.cmml" xref="S3.SS1.p2.6.m6.3.3.4"><csymbol cd="ambiguous" id="S3.SS1.p2.6.m6.3.3.4.1.cmml" xref="S3.SS1.p2.6.m6.3.3.4">superscript</csymbol><ci id="S3.SS1.p2.6.m6.3.3.4.2.cmml" xref="S3.SS1.p2.6.m6.3.3.4.2">ℝ</ci><apply id="S3.SS1.p2.6.m6.3.3.4.3.cmml" xref="S3.SS1.p2.6.m6.3.3.4.3"><times id="S3.SS1.p2.6.m6.3.3.4.3.1.cmml" xref="S3.SS1.p2.6.m6.3.3.4.3.1"></times><ci id="S3.SS1.p2.6.m6.3.3.4.3.2.cmml" xref="S3.SS1.p2.6.m6.3.3.4.3.2">𝑁</ci><apply id="S3.SS1.p2.6.m6.3.3.4.3.3.cmml" xref="S3.SS1.p2.6.m6.3.3.4.3.3"><csymbol cd="ambiguous" id="S3.SS1.p2.6.m6.3.3.4.3.3.1.cmml" xref="S3.SS1.p2.6.m6.3.3.4.3.3">subscript</csymbol><ci id="S3.SS1.p2.6.m6.3.3.4.3.3.2.cmml" xref="S3.SS1.p2.6.m6.3.3.4.3.3.2">𝐷</ci><ci id="S3.SS1.p2.6.m6.3.3.4.3.3.3.cmml" xref="S3.SS1.p2.6.m6.3.3.4.3.3.3">𝐼</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.6.m6.3c">(\mathbf{x}_{1},...,\mathbf{x}_{N})\in\mathbb{R}^{N\times D_{I}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.6.m6.3d">( bold_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , bold_x start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ) ∈ blackboard_R start_POSTSUPERSCRIPT italic_N × italic_D start_POSTSUBSCRIPT italic_I end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>.
See more details in Section <a href="#S4.SS2" title="4.2 Implementation details ‣ 4 Experiments ‣ Weakly-supervised segmentation of referring expressions" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.2</span></a>.</p>
</div>
<div id="S3.SS1.p3" class="ltx_para ltx_noindent">
<p id="S3.SS1.p3.4" class="ltx_p"><span id="S3.SS1.p3.4.1" class="ltx_text ltx_font_bold">Text encoder.</span> For each referring expression <math id="S3.SS1.p3.1.m1.1" class="ltx_Math" alttext="t_{j}" display="inline"><semantics id="S3.SS1.p3.1.m1.1a"><msub id="S3.SS1.p3.1.m1.1.1" xref="S3.SS1.p3.1.m1.1.1.cmml"><mi id="S3.SS1.p3.1.m1.1.1.2" xref="S3.SS1.p3.1.m1.1.1.2.cmml">t</mi><mi id="S3.SS1.p3.1.m1.1.1.3" xref="S3.SS1.p3.1.m1.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.1b"><apply id="S3.SS1.p3.1.m1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.1.m1.1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p3.1.m1.1.1.2.cmml" xref="S3.SS1.p3.1.m1.1.1.2">𝑡</ci><ci id="S3.SS1.p3.1.m1.1.1.3.cmml" xref="S3.SS1.p3.1.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.1c">t_{j}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.1.m1.1d">italic_t start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>, which can
consist of multiple words, we extract one token <math id="S3.SS1.p3.2.m2.1" class="ltx_Math" alttext="\mathbf{y}_{j}" display="inline"><semantics id="S3.SS1.p3.2.m2.1a"><msub id="S3.SS1.p3.2.m2.1.1" xref="S3.SS1.p3.2.m2.1.1.cmml"><mi id="S3.SS1.p3.2.m2.1.1.2" xref="S3.SS1.p3.2.m2.1.1.2.cmml">𝐲</mi><mi id="S3.SS1.p3.2.m2.1.1.3" xref="S3.SS1.p3.2.m2.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.2.m2.1b"><apply id="S3.SS1.p3.2.m2.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.2.m2.1.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p3.2.m2.1.1.2.cmml" xref="S3.SS1.p3.2.m2.1.1.2">𝐲</ci><ci id="S3.SS1.p3.2.m2.1.1.3.cmml" xref="S3.SS1.p3.2.m2.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.2.m2.1c">\mathbf{y}_{j}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.2.m2.1d">bold_y start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>. To do so the text
<math id="S3.SS1.p3.3.m3.1" class="ltx_Math" alttext="t_{j}" display="inline"><semantics id="S3.SS1.p3.3.m3.1a"><msub id="S3.SS1.p3.3.m3.1.1" xref="S3.SS1.p3.3.m3.1.1.cmml"><mi id="S3.SS1.p3.3.m3.1.1.2" xref="S3.SS1.p3.3.m3.1.1.2.cmml">t</mi><mi id="S3.SS1.p3.3.m3.1.1.3" xref="S3.SS1.p3.3.m3.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.3.m3.1b"><apply id="S3.SS1.p3.3.m3.1.1.cmml" xref="S3.SS1.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.3.m3.1.1.1.cmml" xref="S3.SS1.p3.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.p3.3.m3.1.1.2.cmml" xref="S3.SS1.p3.3.m3.1.1.2">𝑡</ci><ci id="S3.SS1.p3.3.m3.1.1.3.cmml" xref="S3.SS1.p3.3.m3.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.3.m3.1c">t_{j}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.3.m3.1d">italic_t start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> is tokenized into words using lower-case byte pair encoding (BPE)
<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib51" title="" class="ltx_ref">51</a>]</cite> and [BOS], [EOS] tokens are added to the beginning and the end of
the sequence. A sequence of position embedding is added and a transformer
encoder maps the input sequence to a sequence of contextualized word tokens from
which the [BOS] token is extracted to serve as a global text representation
<math id="S3.SS1.p3.4.m4.1" class="ltx_Math" alttext="\mathbf{y}_{j}\in\mathbb{R}^{D_{T}}" display="inline"><semantics id="S3.SS1.p3.4.m4.1a"><mrow id="S3.SS1.p3.4.m4.1.1" xref="S3.SS1.p3.4.m4.1.1.cmml"><msub id="S3.SS1.p3.4.m4.1.1.2" xref="S3.SS1.p3.4.m4.1.1.2.cmml"><mi id="S3.SS1.p3.4.m4.1.1.2.2" xref="S3.SS1.p3.4.m4.1.1.2.2.cmml">𝐲</mi><mi id="S3.SS1.p3.4.m4.1.1.2.3" xref="S3.SS1.p3.4.m4.1.1.2.3.cmml">j</mi></msub><mo id="S3.SS1.p3.4.m4.1.1.1" xref="S3.SS1.p3.4.m4.1.1.1.cmml">∈</mo><msup id="S3.SS1.p3.4.m4.1.1.3" xref="S3.SS1.p3.4.m4.1.1.3.cmml"><mi id="S3.SS1.p3.4.m4.1.1.3.2" xref="S3.SS1.p3.4.m4.1.1.3.2.cmml">ℝ</mi><msub id="S3.SS1.p3.4.m4.1.1.3.3" xref="S3.SS1.p3.4.m4.1.1.3.3.cmml"><mi id="S3.SS1.p3.4.m4.1.1.3.3.2" xref="S3.SS1.p3.4.m4.1.1.3.3.2.cmml">D</mi><mi id="S3.SS1.p3.4.m4.1.1.3.3.3" xref="S3.SS1.p3.4.m4.1.1.3.3.3.cmml">T</mi></msub></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.4.m4.1b"><apply id="S3.SS1.p3.4.m4.1.1.cmml" xref="S3.SS1.p3.4.m4.1.1"><in id="S3.SS1.p3.4.m4.1.1.1.cmml" xref="S3.SS1.p3.4.m4.1.1.1"></in><apply id="S3.SS1.p3.4.m4.1.1.2.cmml" xref="S3.SS1.p3.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p3.4.m4.1.1.2.1.cmml" xref="S3.SS1.p3.4.m4.1.1.2">subscript</csymbol><ci id="S3.SS1.p3.4.m4.1.1.2.2.cmml" xref="S3.SS1.p3.4.m4.1.1.2.2">𝐲</ci><ci id="S3.SS1.p3.4.m4.1.1.2.3.cmml" xref="S3.SS1.p3.4.m4.1.1.2.3">𝑗</ci></apply><apply id="S3.SS1.p3.4.m4.1.1.3.cmml" xref="S3.SS1.p3.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p3.4.m4.1.1.3.1.cmml" xref="S3.SS1.p3.4.m4.1.1.3">superscript</csymbol><ci id="S3.SS1.p3.4.m4.1.1.3.2.cmml" xref="S3.SS1.p3.4.m4.1.1.3.2">ℝ</ci><apply id="S3.SS1.p3.4.m4.1.1.3.3.cmml" xref="S3.SS1.p3.4.m4.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS1.p3.4.m4.1.1.3.3.1.cmml" xref="S3.SS1.p3.4.m4.1.1.3.3">subscript</csymbol><ci id="S3.SS1.p3.4.m4.1.1.3.3.2.cmml" xref="S3.SS1.p3.4.m4.1.1.3.3.2">𝐷</ci><ci id="S3.SS1.p3.4.m4.1.1.3.3.3.cmml" xref="S3.SS1.p3.4.m4.1.1.3.3.3">𝑇</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.4.m4.1c">\mathbf{y}_{j}\in\mathbb{R}^{D_{T}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.4.m4.1d">bold_y start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_D start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>.</p>
</div>
<div id="S3.SS1.p4" class="ltx_para ltx_noindent">
<p id="S3.SS1.p4.3" class="ltx_p"><span id="S3.SS1.p4.3.1" class="ltx_text ltx_font_bold">Patch-text similarity scores.</span> The visual and textual tokens
are linearly projected to a multi-modal common embedding space and
<math id="S3.SS1.p4.1.m1.1" class="ltx_Math" alttext="L^{2}" display="inline"><semantics id="S3.SS1.p4.1.m1.1a"><msup id="S3.SS1.p4.1.m1.1.1" xref="S3.SS1.p4.1.m1.1.1.cmml"><mi id="S3.SS1.p4.1.m1.1.1.2" xref="S3.SS1.p4.1.m1.1.1.2.cmml">L</mi><mn id="S3.SS1.p4.1.m1.1.1.3" xref="S3.SS1.p4.1.m1.1.1.3.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.1.m1.1b"><apply id="S3.SS1.p4.1.m1.1.1.cmml" xref="S3.SS1.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.1.m1.1.1.1.cmml" xref="S3.SS1.p4.1.m1.1.1">superscript</csymbol><ci id="S3.SS1.p4.1.m1.1.1.2.cmml" xref="S3.SS1.p4.1.m1.1.1.2">𝐿</ci><cn type="integer" id="S3.SS1.p4.1.m1.1.1.3.cmml" xref="S3.SS1.p4.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.1.m1.1c">L^{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.1.m1.1d">italic_L start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math>-normalized. From the patch tokens <math id="S3.SS1.p4.2.m2.3" class="ltx_Math" alttext="(\mathbf{x}_{1},...,\mathbf{x}_{N})" display="inline"><semantics id="S3.SS1.p4.2.m2.3a"><mrow id="S3.SS1.p4.2.m2.3.3.2" xref="S3.SS1.p4.2.m2.3.3.3.cmml"><mo stretchy="false" id="S3.SS1.p4.2.m2.3.3.2.3" xref="S3.SS1.p4.2.m2.3.3.3.cmml">(</mo><msub id="S3.SS1.p4.2.m2.2.2.1.1" xref="S3.SS1.p4.2.m2.2.2.1.1.cmml"><mi id="S3.SS1.p4.2.m2.2.2.1.1.2" xref="S3.SS1.p4.2.m2.2.2.1.1.2.cmml">𝐱</mi><mn id="S3.SS1.p4.2.m2.2.2.1.1.3" xref="S3.SS1.p4.2.m2.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p4.2.m2.3.3.2.4" xref="S3.SS1.p4.2.m2.3.3.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.p4.2.m2.1.1" xref="S3.SS1.p4.2.m2.1.1.cmml">…</mi><mo id="S3.SS1.p4.2.m2.3.3.2.5" xref="S3.SS1.p4.2.m2.3.3.3.cmml">,</mo><msub id="S3.SS1.p4.2.m2.3.3.2.2" xref="S3.SS1.p4.2.m2.3.3.2.2.cmml"><mi id="S3.SS1.p4.2.m2.3.3.2.2.2" xref="S3.SS1.p4.2.m2.3.3.2.2.2.cmml">𝐱</mi><mi id="S3.SS1.p4.2.m2.3.3.2.2.3" xref="S3.SS1.p4.2.m2.3.3.2.2.3.cmml">N</mi></msub><mo stretchy="false" id="S3.SS1.p4.2.m2.3.3.2.6" xref="S3.SS1.p4.2.m2.3.3.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.2.m2.3b"><vector id="S3.SS1.p4.2.m2.3.3.3.cmml" xref="S3.SS1.p4.2.m2.3.3.2"><apply id="S3.SS1.p4.2.m2.2.2.1.1.cmml" xref="S3.SS1.p4.2.m2.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.2.m2.2.2.1.1.1.cmml" xref="S3.SS1.p4.2.m2.2.2.1.1">subscript</csymbol><ci id="S3.SS1.p4.2.m2.2.2.1.1.2.cmml" xref="S3.SS1.p4.2.m2.2.2.1.1.2">𝐱</ci><cn type="integer" id="S3.SS1.p4.2.m2.2.2.1.1.3.cmml" xref="S3.SS1.p4.2.m2.2.2.1.1.3">1</cn></apply><ci id="S3.SS1.p4.2.m2.1.1.cmml" xref="S3.SS1.p4.2.m2.1.1">…</ci><apply id="S3.SS1.p4.2.m2.3.3.2.2.cmml" xref="S3.SS1.p4.2.m2.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS1.p4.2.m2.3.3.2.2.1.cmml" xref="S3.SS1.p4.2.m2.3.3.2.2">subscript</csymbol><ci id="S3.SS1.p4.2.m2.3.3.2.2.2.cmml" xref="S3.SS1.p4.2.m2.3.3.2.2.2">𝐱</ci><ci id="S3.SS1.p4.2.m2.3.3.2.2.3.cmml" xref="S3.SS1.p4.2.m2.3.3.2.2.3">𝑁</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.2.m2.3c">(\mathbf{x}_{1},...,\mathbf{x}_{N})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.2.m2.3d">( bold_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , bold_x start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT )</annotation></semantics></math> and the global text tokens
<math id="S3.SS1.p4.3.m3.3" class="ltx_Math" alttext="(\mathbf{y}_{1},...,\mathbf{y}_{L})" display="inline"><semantics id="S3.SS1.p4.3.m3.3a"><mrow id="S3.SS1.p4.3.m3.3.3.2" xref="S3.SS1.p4.3.m3.3.3.3.cmml"><mo stretchy="false" id="S3.SS1.p4.3.m3.3.3.2.3" xref="S3.SS1.p4.3.m3.3.3.3.cmml">(</mo><msub id="S3.SS1.p4.3.m3.2.2.1.1" xref="S3.SS1.p4.3.m3.2.2.1.1.cmml"><mi id="S3.SS1.p4.3.m3.2.2.1.1.2" xref="S3.SS1.p4.3.m3.2.2.1.1.2.cmml">𝐲</mi><mn id="S3.SS1.p4.3.m3.2.2.1.1.3" xref="S3.SS1.p4.3.m3.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p4.3.m3.3.3.2.4" xref="S3.SS1.p4.3.m3.3.3.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.p4.3.m3.1.1" xref="S3.SS1.p4.3.m3.1.1.cmml">…</mi><mo id="S3.SS1.p4.3.m3.3.3.2.5" xref="S3.SS1.p4.3.m3.3.3.3.cmml">,</mo><msub id="S3.SS1.p4.3.m3.3.3.2.2" xref="S3.SS1.p4.3.m3.3.3.2.2.cmml"><mi id="S3.SS1.p4.3.m3.3.3.2.2.2" xref="S3.SS1.p4.3.m3.3.3.2.2.2.cmml">𝐲</mi><mi id="S3.SS1.p4.3.m3.3.3.2.2.3" xref="S3.SS1.p4.3.m3.3.3.2.2.3.cmml">L</mi></msub><mo stretchy="false" id="S3.SS1.p4.3.m3.3.3.2.6" xref="S3.SS1.p4.3.m3.3.3.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.3.m3.3b"><vector id="S3.SS1.p4.3.m3.3.3.3.cmml" xref="S3.SS1.p4.3.m3.3.3.2"><apply id="S3.SS1.p4.3.m3.2.2.1.1.cmml" xref="S3.SS1.p4.3.m3.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.3.m3.2.2.1.1.1.cmml" xref="S3.SS1.p4.3.m3.2.2.1.1">subscript</csymbol><ci id="S3.SS1.p4.3.m3.2.2.1.1.2.cmml" xref="S3.SS1.p4.3.m3.2.2.1.1.2">𝐲</ci><cn type="integer" id="S3.SS1.p4.3.m3.2.2.1.1.3.cmml" xref="S3.SS1.p4.3.m3.2.2.1.1.3">1</cn></apply><ci id="S3.SS1.p4.3.m3.1.1.cmml" xref="S3.SS1.p4.3.m3.1.1">…</ci><apply id="S3.SS1.p4.3.m3.3.3.2.2.cmml" xref="S3.SS1.p4.3.m3.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS1.p4.3.m3.3.3.2.2.1.cmml" xref="S3.SS1.p4.3.m3.3.3.2.2">subscript</csymbol><ci id="S3.SS1.p4.3.m3.3.3.2.2.2.cmml" xref="S3.SS1.p4.3.m3.3.3.2.2.2">𝐲</ci><ci id="S3.SS1.p4.3.m3.3.3.2.2.3.cmml" xref="S3.SS1.p4.3.m3.3.3.2.2.3">𝐿</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.3.m3.3c">(\mathbf{y}_{1},...,\mathbf{y}_{L})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.3.m3.3d">( bold_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , bold_y start_POSTSUBSCRIPT italic_L end_POSTSUBSCRIPT )</annotation></semantics></math>, we compute patch-text cosine similarities as
the scalar product and obtain the similarity matrix</p>
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.7" class="ltx_Math" alttext="\mathbf{S}=(s_{i,j})_{i,j}=(\mathbf{x}_{i}\cdot\mathbf{y}_{j})_{i,j}," display="block"><semantics id="S3.E1.m1.7a"><mrow id="S3.E1.m1.7.7.1" xref="S3.E1.m1.7.7.1.1.cmml"><mrow id="S3.E1.m1.7.7.1.1" xref="S3.E1.m1.7.7.1.1.cmml"><mi id="S3.E1.m1.7.7.1.1.4" xref="S3.E1.m1.7.7.1.1.4.cmml">𝐒</mi><mo id="S3.E1.m1.7.7.1.1.5" xref="S3.E1.m1.7.7.1.1.5.cmml">=</mo><msub id="S3.E1.m1.7.7.1.1.1" xref="S3.E1.m1.7.7.1.1.1.cmml"><mrow id="S3.E1.m1.7.7.1.1.1.1.1" xref="S3.E1.m1.7.7.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.7.7.1.1.1.1.1.2" xref="S3.E1.m1.7.7.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E1.m1.7.7.1.1.1.1.1.1" xref="S3.E1.m1.7.7.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.7.7.1.1.1.1.1.1.2" xref="S3.E1.m1.7.7.1.1.1.1.1.1.2.cmml">s</mi><mrow id="S3.E1.m1.2.2.2.4" xref="S3.E1.m1.2.2.2.3.cmml"><mi id="S3.E1.m1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml">i</mi><mo id="S3.E1.m1.2.2.2.4.1" xref="S3.E1.m1.2.2.2.3.cmml">,</mo><mi id="S3.E1.m1.2.2.2.2" xref="S3.E1.m1.2.2.2.2.cmml">j</mi></mrow></msub><mo stretchy="false" id="S3.E1.m1.7.7.1.1.1.1.1.3" xref="S3.E1.m1.7.7.1.1.1.1.1.1.cmml">)</mo></mrow><mrow id="S3.E1.m1.4.4.2.4" xref="S3.E1.m1.4.4.2.3.cmml"><mi id="S3.E1.m1.3.3.1.1" xref="S3.E1.m1.3.3.1.1.cmml">i</mi><mo id="S3.E1.m1.4.4.2.4.1" xref="S3.E1.m1.4.4.2.3.cmml">,</mo><mi id="S3.E1.m1.4.4.2.2" xref="S3.E1.m1.4.4.2.2.cmml">j</mi></mrow></msub><mo id="S3.E1.m1.7.7.1.1.6" xref="S3.E1.m1.7.7.1.1.6.cmml">=</mo><msub id="S3.E1.m1.7.7.1.1.2" xref="S3.E1.m1.7.7.1.1.2.cmml"><mrow id="S3.E1.m1.7.7.1.1.2.1.1" xref="S3.E1.m1.7.7.1.1.2.1.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.7.7.1.1.2.1.1.2" xref="S3.E1.m1.7.7.1.1.2.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.7.7.1.1.2.1.1.1" xref="S3.E1.m1.7.7.1.1.2.1.1.1.cmml"><msub id="S3.E1.m1.7.7.1.1.2.1.1.1.2" xref="S3.E1.m1.7.7.1.1.2.1.1.1.2.cmml"><mi id="S3.E1.m1.7.7.1.1.2.1.1.1.2.2" xref="S3.E1.m1.7.7.1.1.2.1.1.1.2.2.cmml">𝐱</mi><mi id="S3.E1.m1.7.7.1.1.2.1.1.1.2.3" xref="S3.E1.m1.7.7.1.1.2.1.1.1.2.3.cmml">i</mi></msub><mo id="S3.E1.m1.7.7.1.1.2.1.1.1.1" xref="S3.E1.m1.7.7.1.1.2.1.1.1.1.cmml">⋅</mo><msub id="S3.E1.m1.7.7.1.1.2.1.1.1.3" xref="S3.E1.m1.7.7.1.1.2.1.1.1.3.cmml"><mi id="S3.E1.m1.7.7.1.1.2.1.1.1.3.2" xref="S3.E1.m1.7.7.1.1.2.1.1.1.3.2.cmml">𝐲</mi><mi id="S3.E1.m1.7.7.1.1.2.1.1.1.3.3" xref="S3.E1.m1.7.7.1.1.2.1.1.1.3.3.cmml">j</mi></msub></mrow><mo stretchy="false" id="S3.E1.m1.7.7.1.1.2.1.1.3" xref="S3.E1.m1.7.7.1.1.2.1.1.1.cmml">)</mo></mrow><mrow id="S3.E1.m1.6.6.2.4" xref="S3.E1.m1.6.6.2.3.cmml"><mi id="S3.E1.m1.5.5.1.1" xref="S3.E1.m1.5.5.1.1.cmml">i</mi><mo id="S3.E1.m1.6.6.2.4.1" xref="S3.E1.m1.6.6.2.3.cmml">,</mo><mi id="S3.E1.m1.6.6.2.2" xref="S3.E1.m1.6.6.2.2.cmml">j</mi></mrow></msub></mrow><mo id="S3.E1.m1.7.7.1.2" xref="S3.E1.m1.7.7.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.7b"><apply id="S3.E1.m1.7.7.1.1.cmml" xref="S3.E1.m1.7.7.1"><and id="S3.E1.m1.7.7.1.1a.cmml" xref="S3.E1.m1.7.7.1"></and><apply id="S3.E1.m1.7.7.1.1b.cmml" xref="S3.E1.m1.7.7.1"><eq id="S3.E1.m1.7.7.1.1.5.cmml" xref="S3.E1.m1.7.7.1.1.5"></eq><ci id="S3.E1.m1.7.7.1.1.4.cmml" xref="S3.E1.m1.7.7.1.1.4">𝐒</ci><apply id="S3.E1.m1.7.7.1.1.1.cmml" xref="S3.E1.m1.7.7.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.7.7.1.1.1.2.cmml" xref="S3.E1.m1.7.7.1.1.1">subscript</csymbol><apply id="S3.E1.m1.7.7.1.1.1.1.1.1.cmml" xref="S3.E1.m1.7.7.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.7.7.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.7.7.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.7.7.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.7.7.1.1.1.1.1.1.2">𝑠</ci><list id="S3.E1.m1.2.2.2.3.cmml" xref="S3.E1.m1.2.2.2.4"><ci id="S3.E1.m1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1">𝑖</ci><ci id="S3.E1.m1.2.2.2.2.cmml" xref="S3.E1.m1.2.2.2.2">𝑗</ci></list></apply><list id="S3.E1.m1.4.4.2.3.cmml" xref="S3.E1.m1.4.4.2.4"><ci id="S3.E1.m1.3.3.1.1.cmml" xref="S3.E1.m1.3.3.1.1">𝑖</ci><ci id="S3.E1.m1.4.4.2.2.cmml" xref="S3.E1.m1.4.4.2.2">𝑗</ci></list></apply></apply><apply id="S3.E1.m1.7.7.1.1c.cmml" xref="S3.E1.m1.7.7.1"><eq id="S3.E1.m1.7.7.1.1.6.cmml" xref="S3.E1.m1.7.7.1.1.6"></eq><share href="#S3.E1.m1.7.7.1.1.1.cmml" id="S3.E1.m1.7.7.1.1d.cmml" xref="S3.E1.m1.7.7.1"></share><apply id="S3.E1.m1.7.7.1.1.2.cmml" xref="S3.E1.m1.7.7.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.7.7.1.1.2.2.cmml" xref="S3.E1.m1.7.7.1.1.2">subscript</csymbol><apply id="S3.E1.m1.7.7.1.1.2.1.1.1.cmml" xref="S3.E1.m1.7.7.1.1.2.1.1"><ci id="S3.E1.m1.7.7.1.1.2.1.1.1.1.cmml" xref="S3.E1.m1.7.7.1.1.2.1.1.1.1">⋅</ci><apply id="S3.E1.m1.7.7.1.1.2.1.1.1.2.cmml" xref="S3.E1.m1.7.7.1.1.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.7.7.1.1.2.1.1.1.2.1.cmml" xref="S3.E1.m1.7.7.1.1.2.1.1.1.2">subscript</csymbol><ci id="S3.E1.m1.7.7.1.1.2.1.1.1.2.2.cmml" xref="S3.E1.m1.7.7.1.1.2.1.1.1.2.2">𝐱</ci><ci id="S3.E1.m1.7.7.1.1.2.1.1.1.2.3.cmml" xref="S3.E1.m1.7.7.1.1.2.1.1.1.2.3">𝑖</ci></apply><apply id="S3.E1.m1.7.7.1.1.2.1.1.1.3.cmml" xref="S3.E1.m1.7.7.1.1.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.7.7.1.1.2.1.1.1.3.1.cmml" xref="S3.E1.m1.7.7.1.1.2.1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.7.7.1.1.2.1.1.1.3.2.cmml" xref="S3.E1.m1.7.7.1.1.2.1.1.1.3.2">𝐲</ci><ci id="S3.E1.m1.7.7.1.1.2.1.1.1.3.3.cmml" xref="S3.E1.m1.7.7.1.1.2.1.1.1.3.3">𝑗</ci></apply></apply><list id="S3.E1.m1.6.6.2.3.cmml" xref="S3.E1.m1.6.6.2.4"><ci id="S3.E1.m1.5.5.1.1.cmml" xref="S3.E1.m1.5.5.1.1">𝑖</ci><ci id="S3.E1.m1.6.6.2.2.cmml" xref="S3.E1.m1.6.6.2.2">𝑗</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.7c">\mathbf{S}=(s_{i,j})_{i,j}=(\mathbf{x}_{i}\cdot\mathbf{y}_{j})_{i,j},</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.7d">bold_S = ( italic_s start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT ) start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT = ( bold_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ⋅ bold_y start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr>
</table>
<p id="S3.SS1.p4.6" class="ltx_p">with <math id="S3.SS1.p4.4.m1.1" class="ltx_Math" alttext="\mathbf{S}\in\mathbb{R}^{N\times L}" display="inline"><semantics id="S3.SS1.p4.4.m1.1a"><mrow id="S3.SS1.p4.4.m1.1.1" xref="S3.SS1.p4.4.m1.1.1.cmml"><mi id="S3.SS1.p4.4.m1.1.1.2" xref="S3.SS1.p4.4.m1.1.1.2.cmml">𝐒</mi><mo id="S3.SS1.p4.4.m1.1.1.1" xref="S3.SS1.p4.4.m1.1.1.1.cmml">∈</mo><msup id="S3.SS1.p4.4.m1.1.1.3" xref="S3.SS1.p4.4.m1.1.1.3.cmml"><mi id="S3.SS1.p4.4.m1.1.1.3.2" xref="S3.SS1.p4.4.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p4.4.m1.1.1.3.3" xref="S3.SS1.p4.4.m1.1.1.3.3.cmml"><mi id="S3.SS1.p4.4.m1.1.1.3.3.2" xref="S3.SS1.p4.4.m1.1.1.3.3.2.cmml">N</mi><mo id="S3.SS1.p4.4.m1.1.1.3.3.1" xref="S3.SS1.p4.4.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.SS1.p4.4.m1.1.1.3.3.3" xref="S3.SS1.p4.4.m1.1.1.3.3.3.cmml">L</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.4.m1.1b"><apply id="S3.SS1.p4.4.m1.1.1.cmml" xref="S3.SS1.p4.4.m1.1.1"><in id="S3.SS1.p4.4.m1.1.1.1.cmml" xref="S3.SS1.p4.4.m1.1.1.1"></in><ci id="S3.SS1.p4.4.m1.1.1.2.cmml" xref="S3.SS1.p4.4.m1.1.1.2">𝐒</ci><apply id="S3.SS1.p4.4.m1.1.1.3.cmml" xref="S3.SS1.p4.4.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p4.4.m1.1.1.3.1.cmml" xref="S3.SS1.p4.4.m1.1.1.3">superscript</csymbol><ci id="S3.SS1.p4.4.m1.1.1.3.2.cmml" xref="S3.SS1.p4.4.m1.1.1.3.2">ℝ</ci><apply id="S3.SS1.p4.4.m1.1.1.3.3.cmml" xref="S3.SS1.p4.4.m1.1.1.3.3"><times id="S3.SS1.p4.4.m1.1.1.3.3.1.cmml" xref="S3.SS1.p4.4.m1.1.1.3.3.1"></times><ci id="S3.SS1.p4.4.m1.1.1.3.3.2.cmml" xref="S3.SS1.p4.4.m1.1.1.3.3.2">𝑁</ci><ci id="S3.SS1.p4.4.m1.1.1.3.3.3.cmml" xref="S3.SS1.p4.4.m1.1.1.3.3.3">𝐿</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.4.m1.1c">\mathbf{S}\in\mathbb{R}^{N\times L}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.4.m1.1d">bold_S ∈ blackboard_R start_POSTSUPERSCRIPT italic_N × italic_L end_POSTSUPERSCRIPT</annotation></semantics></math>.
The similarities are in the range <math id="S3.SS1.p4.5.m2.2" class="ltx_Math" alttext="[-1,1]" display="inline"><semantics id="S3.SS1.p4.5.m2.2a"><mrow id="S3.SS1.p4.5.m2.2.2.1" xref="S3.SS1.p4.5.m2.2.2.2.cmml"><mo stretchy="false" id="S3.SS1.p4.5.m2.2.2.1.2" xref="S3.SS1.p4.5.m2.2.2.2.cmml">[</mo><mrow id="S3.SS1.p4.5.m2.2.2.1.1" xref="S3.SS1.p4.5.m2.2.2.1.1.cmml"><mo id="S3.SS1.p4.5.m2.2.2.1.1.1" xref="S3.SS1.p4.5.m2.2.2.1.1.1.cmml">-</mo><mn id="S3.SS1.p4.5.m2.2.2.1.1.2" xref="S3.SS1.p4.5.m2.2.2.1.1.2.cmml">1</mn></mrow><mo id="S3.SS1.p4.5.m2.2.2.1.3" xref="S3.SS1.p4.5.m2.2.2.2.cmml">,</mo><mn id="S3.SS1.p4.5.m2.1.1" xref="S3.SS1.p4.5.m2.1.1.cmml">1</mn><mo stretchy="false" id="S3.SS1.p4.5.m2.2.2.1.4" xref="S3.SS1.p4.5.m2.2.2.2.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.5.m2.2b"><interval closure="closed" id="S3.SS1.p4.5.m2.2.2.2.cmml" xref="S3.SS1.p4.5.m2.2.2.1"><apply id="S3.SS1.p4.5.m2.2.2.1.1.cmml" xref="S3.SS1.p4.5.m2.2.2.1.1"><minus id="S3.SS1.p4.5.m2.2.2.1.1.1.cmml" xref="S3.SS1.p4.5.m2.2.2.1.1.1"></minus><cn type="integer" id="S3.SS1.p4.5.m2.2.2.1.1.2.cmml" xref="S3.SS1.p4.5.m2.2.2.1.1.2">1</cn></apply><cn type="integer" id="S3.SS1.p4.5.m2.1.1.cmml" xref="S3.SS1.p4.5.m2.1.1">1</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.5.m2.2c">[-1,1]</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.5.m2.2d">[ - 1 , 1 ]</annotation></semantics></math> and scaled with a
learnable temperature parameter <math id="S3.SS1.p4.6.m3.1" class="ltx_Math" alttext="\tau&gt;0" display="inline"><semantics id="S3.SS1.p4.6.m3.1a"><mrow id="S3.SS1.p4.6.m3.1.1" xref="S3.SS1.p4.6.m3.1.1.cmml"><mi id="S3.SS1.p4.6.m3.1.1.2" xref="S3.SS1.p4.6.m3.1.1.2.cmml">τ</mi><mo id="S3.SS1.p4.6.m3.1.1.1" xref="S3.SS1.p4.6.m3.1.1.1.cmml">&gt;</mo><mn id="S3.SS1.p4.6.m3.1.1.3" xref="S3.SS1.p4.6.m3.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.6.m3.1b"><apply id="S3.SS1.p4.6.m3.1.1.cmml" xref="S3.SS1.p4.6.m3.1.1"><gt id="S3.SS1.p4.6.m3.1.1.1.cmml" xref="S3.SS1.p4.6.m3.1.1.1"></gt><ci id="S3.SS1.p4.6.m3.1.1.2.cmml" xref="S3.SS1.p4.6.m3.1.1.2">𝜏</ci><cn type="integer" id="S3.SS1.p4.6.m3.1.1.3.cmml" xref="S3.SS1.p4.6.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.6.m3.1c">\tau&gt;0</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.6.m3.1d">italic_τ &gt; 0</annotation></semantics></math> controlling their range.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Global Pooling Mechanisms</h3>

<figure id="S3.F3" class="ltx_figure"><img src="/html/2205.04725/assets/x3.png" id="S3.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="832" height="217" alt="">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S3.F3.2.1.1" class="ltx_text" style="font-size:90%;">Figure 3</span>: </span><span id="S3.F3.3.2" class="ltx_text" style="font-size:90%;">(Left)
A patch assignment mechanism computes masks from patch-text similarities, the
masks are used as weights in the global weighed pooling. (Center) SPA:
assignment with a softmax on text channels, softly enforcing a single label
per patch. (Right) MPA: assignment with a sigmoid, generalizing to multiple labels per patch.
</span></figcaption>
</figure>
<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.3" class="ltx_p">To leverage image-level text supervision, we need to map the matrix
<math id="S3.SS2.p1.1.m1.1" class="ltx_Math" alttext="\mathbf{S}\in\mathbb{R}^{N\times L}" display="inline"><semantics id="S3.SS2.p1.1.m1.1a"><mrow id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml"><mi id="S3.SS2.p1.1.m1.1.1.2" xref="S3.SS2.p1.1.m1.1.1.2.cmml">𝐒</mi><mo id="S3.SS2.p1.1.m1.1.1.1" xref="S3.SS2.p1.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS2.p1.1.m1.1.1.3" xref="S3.SS2.p1.1.m1.1.1.3.cmml"><mi id="S3.SS2.p1.1.m1.1.1.3.2" xref="S3.SS2.p1.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.p1.1.m1.1.1.3.3" xref="S3.SS2.p1.1.m1.1.1.3.3.cmml"><mi id="S3.SS2.p1.1.m1.1.1.3.3.2" xref="S3.SS2.p1.1.m1.1.1.3.3.2.cmml">N</mi><mo id="S3.SS2.p1.1.m1.1.1.3.3.1" xref="S3.SS2.p1.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.SS2.p1.1.m1.1.1.3.3.3" xref="S3.SS2.p1.1.m1.1.1.3.3.3.cmml">L</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><apply id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1"><in id="S3.SS2.p1.1.m1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1.1"></in><ci id="S3.SS2.p1.1.m1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.1.1.2">𝐒</ci><apply id="S3.SS2.p1.1.m1.1.1.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.1.1.3.1.cmml" xref="S3.SS2.p1.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS2.p1.1.m1.1.1.3.2.cmml" xref="S3.SS2.p1.1.m1.1.1.3.2">ℝ</ci><apply id="S3.SS2.p1.1.m1.1.1.3.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3.3"><times id="S3.SS2.p1.1.m1.1.1.3.3.1.cmml" xref="S3.SS2.p1.1.m1.1.1.3.3.1"></times><ci id="S3.SS2.p1.1.m1.1.1.3.3.2.cmml" xref="S3.SS2.p1.1.m1.1.1.3.3.2">𝑁</ci><ci id="S3.SS2.p1.1.m1.1.1.3.3.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3.3.3">𝐿</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">\mathbf{S}\in\mathbb{R}^{N\times L}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.1.m1.1d">bold_S ∈ blackboard_R start_POSTSUPERSCRIPT italic_N × italic_L end_POSTSUPERSCRIPT</annotation></semantics></math> of patch-text similarities to an image-level
score for each referring expression, i.e., <math id="S3.SS2.p1.2.m2.1" class="ltx_Math" alttext="\mathbf{z}\in\mathbb{R}^{L}" display="inline"><semantics id="S3.SS2.p1.2.m2.1a"><mrow id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml"><mi id="S3.SS2.p1.2.m2.1.1.2" xref="S3.SS2.p1.2.m2.1.1.2.cmml">𝐳</mi><mo id="S3.SS2.p1.2.m2.1.1.1" xref="S3.SS2.p1.2.m2.1.1.1.cmml">∈</mo><msup id="S3.SS2.p1.2.m2.1.1.3" xref="S3.SS2.p1.2.m2.1.1.3.cmml"><mi id="S3.SS2.p1.2.m2.1.1.3.2" xref="S3.SS2.p1.2.m2.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS2.p1.2.m2.1.1.3.3" xref="S3.SS2.p1.2.m2.1.1.3.3.cmml">L</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><apply id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1"><in id="S3.SS2.p1.2.m2.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1.1"></in><ci id="S3.SS2.p1.2.m2.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2">𝐳</ci><apply id="S3.SS2.p1.2.m2.1.1.3.cmml" xref="S3.SS2.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.3.1.cmml" xref="S3.SS2.p1.2.m2.1.1.3">superscript</csymbol><ci id="S3.SS2.p1.2.m2.1.1.3.2.cmml" xref="S3.SS2.p1.2.m2.1.1.3.2">ℝ</ci><ci id="S3.SS2.p1.2.m2.1.1.3.3.cmml" xref="S3.SS2.p1.2.m2.1.1.3.3">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">\mathbf{z}\in\mathbb{R}^{L}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.2.m2.1d">bold_z ∈ blackboard_R start_POSTSUPERSCRIPT italic_L end_POSTSUPERSCRIPT</annotation></semantics></math>. The
score vector <math id="S3.SS2.p1.3.m3.1" class="ltx_Math" alttext="\mathbf{z}" display="inline"><semantics id="S3.SS2.p1.3.m3.1a"><mi id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml">𝐳</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><ci id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">𝐳</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">\mathbf{z}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.3.m3.1d">bold_z</annotation></semantics></math> allows us to compute a classification loss using ground
truth referring expressions. Note that we cannot compute per-pixel losses given
the lack of pixel-wise supervision in weakly-supervised settings.
<br class="ltx_break"></p>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.1" class="ltx_p"><span id="S3.SS2.p2.1.1" class="ltx_text ltx_font_bold">Global average and max pooling (GAP-GMP).</span>
A straightforward way of pooling is global average pooling (GAP), where we
average the similarities for a given referring expression over all patches of an
image:</p>
</div>
<div id="S3.SS2.p3" class="ltx_para">
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.3" class="ltx_Math" alttext="z^{GAP}_{j}=\frac{1}{N}\sum_{i=1}^{N}s_{i,j}." display="block"><semantics id="S3.E2.m1.3a"><mrow id="S3.E2.m1.3.3.1" xref="S3.E2.m1.3.3.1.1.cmml"><mrow id="S3.E2.m1.3.3.1.1" xref="S3.E2.m1.3.3.1.1.cmml"><msubsup id="S3.E2.m1.3.3.1.1.2" xref="S3.E2.m1.3.3.1.1.2.cmml"><mi id="S3.E2.m1.3.3.1.1.2.2.2" xref="S3.E2.m1.3.3.1.1.2.2.2.cmml">z</mi><mi id="S3.E2.m1.3.3.1.1.2.3" xref="S3.E2.m1.3.3.1.1.2.3.cmml">j</mi><mrow id="S3.E2.m1.3.3.1.1.2.2.3" xref="S3.E2.m1.3.3.1.1.2.2.3.cmml"><mi id="S3.E2.m1.3.3.1.1.2.2.3.2" xref="S3.E2.m1.3.3.1.1.2.2.3.2.cmml">G</mi><mo id="S3.E2.m1.3.3.1.1.2.2.3.1" xref="S3.E2.m1.3.3.1.1.2.2.3.1.cmml">⁢</mo><mi id="S3.E2.m1.3.3.1.1.2.2.3.3" xref="S3.E2.m1.3.3.1.1.2.2.3.3.cmml">A</mi><mo id="S3.E2.m1.3.3.1.1.2.2.3.1a" xref="S3.E2.m1.3.3.1.1.2.2.3.1.cmml">⁢</mo><mi id="S3.E2.m1.3.3.1.1.2.2.3.4" xref="S3.E2.m1.3.3.1.1.2.2.3.4.cmml">P</mi></mrow></msubsup><mo id="S3.E2.m1.3.3.1.1.1" xref="S3.E2.m1.3.3.1.1.1.cmml">=</mo><mrow id="S3.E2.m1.3.3.1.1.3" xref="S3.E2.m1.3.3.1.1.3.cmml"><mfrac id="S3.E2.m1.3.3.1.1.3.2" xref="S3.E2.m1.3.3.1.1.3.2.cmml"><mn id="S3.E2.m1.3.3.1.1.3.2.2" xref="S3.E2.m1.3.3.1.1.3.2.2.cmml">1</mn><mi id="S3.E2.m1.3.3.1.1.3.2.3" xref="S3.E2.m1.3.3.1.1.3.2.3.cmml">N</mi></mfrac><mo id="S3.E2.m1.3.3.1.1.3.1" xref="S3.E2.m1.3.3.1.1.3.1.cmml">⁢</mo><mrow id="S3.E2.m1.3.3.1.1.3.3" xref="S3.E2.m1.3.3.1.1.3.3.cmml"><munderover id="S3.E2.m1.3.3.1.1.3.3.1" xref="S3.E2.m1.3.3.1.1.3.3.1.cmml"><mo largeop="true" movablelimits="false" symmetric="true" id="S3.E2.m1.3.3.1.1.3.3.1.2.2" xref="S3.E2.m1.3.3.1.1.3.3.1.2.2.cmml">∑</mo><mrow id="S3.E2.m1.3.3.1.1.3.3.1.2.3" xref="S3.E2.m1.3.3.1.1.3.3.1.2.3.cmml"><mi id="S3.E2.m1.3.3.1.1.3.3.1.2.3.2" xref="S3.E2.m1.3.3.1.1.3.3.1.2.3.2.cmml">i</mi><mo id="S3.E2.m1.3.3.1.1.3.3.1.2.3.1" xref="S3.E2.m1.3.3.1.1.3.3.1.2.3.1.cmml">=</mo><mn id="S3.E2.m1.3.3.1.1.3.3.1.2.3.3" xref="S3.E2.m1.3.3.1.1.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E2.m1.3.3.1.1.3.3.1.3" xref="S3.E2.m1.3.3.1.1.3.3.1.3.cmml">N</mi></munderover><msub id="S3.E2.m1.3.3.1.1.3.3.2" xref="S3.E2.m1.3.3.1.1.3.3.2.cmml"><mi id="S3.E2.m1.3.3.1.1.3.3.2.2" xref="S3.E2.m1.3.3.1.1.3.3.2.2.cmml">s</mi><mrow id="S3.E2.m1.2.2.2.4" xref="S3.E2.m1.2.2.2.3.cmml"><mi id="S3.E2.m1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml">i</mi><mo id="S3.E2.m1.2.2.2.4.1" xref="S3.E2.m1.2.2.2.3.cmml">,</mo><mi id="S3.E2.m1.2.2.2.2" xref="S3.E2.m1.2.2.2.2.cmml">j</mi></mrow></msub></mrow></mrow></mrow><mo id="S3.E2.m1.3.3.1.2" xref="S3.E2.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.3b"><apply id="S3.E2.m1.3.3.1.1.cmml" xref="S3.E2.m1.3.3.1"><eq id="S3.E2.m1.3.3.1.1.1.cmml" xref="S3.E2.m1.3.3.1.1.1"></eq><apply id="S3.E2.m1.3.3.1.1.2.cmml" xref="S3.E2.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.2.1.cmml" xref="S3.E2.m1.3.3.1.1.2">subscript</csymbol><apply id="S3.E2.m1.3.3.1.1.2.2.cmml" xref="S3.E2.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.2.2.1.cmml" xref="S3.E2.m1.3.3.1.1.2">superscript</csymbol><ci id="S3.E2.m1.3.3.1.1.2.2.2.cmml" xref="S3.E2.m1.3.3.1.1.2.2.2">𝑧</ci><apply id="S3.E2.m1.3.3.1.1.2.2.3.cmml" xref="S3.E2.m1.3.3.1.1.2.2.3"><times id="S3.E2.m1.3.3.1.1.2.2.3.1.cmml" xref="S3.E2.m1.3.3.1.1.2.2.3.1"></times><ci id="S3.E2.m1.3.3.1.1.2.2.3.2.cmml" xref="S3.E2.m1.3.3.1.1.2.2.3.2">𝐺</ci><ci id="S3.E2.m1.3.3.1.1.2.2.3.3.cmml" xref="S3.E2.m1.3.3.1.1.2.2.3.3">𝐴</ci><ci id="S3.E2.m1.3.3.1.1.2.2.3.4.cmml" xref="S3.E2.m1.3.3.1.1.2.2.3.4">𝑃</ci></apply></apply><ci id="S3.E2.m1.3.3.1.1.2.3.cmml" xref="S3.E2.m1.3.3.1.1.2.3">𝑗</ci></apply><apply id="S3.E2.m1.3.3.1.1.3.cmml" xref="S3.E2.m1.3.3.1.1.3"><times id="S3.E2.m1.3.3.1.1.3.1.cmml" xref="S3.E2.m1.3.3.1.1.3.1"></times><apply id="S3.E2.m1.3.3.1.1.3.2.cmml" xref="S3.E2.m1.3.3.1.1.3.2"><divide id="S3.E2.m1.3.3.1.1.3.2.1.cmml" xref="S3.E2.m1.3.3.1.1.3.2"></divide><cn type="integer" id="S3.E2.m1.3.3.1.1.3.2.2.cmml" xref="S3.E2.m1.3.3.1.1.3.2.2">1</cn><ci id="S3.E2.m1.3.3.1.1.3.2.3.cmml" xref="S3.E2.m1.3.3.1.1.3.2.3">𝑁</ci></apply><apply id="S3.E2.m1.3.3.1.1.3.3.cmml" xref="S3.E2.m1.3.3.1.1.3.3"><apply id="S3.E2.m1.3.3.1.1.3.3.1.cmml" xref="S3.E2.m1.3.3.1.1.3.3.1"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.3.3.1.1.cmml" xref="S3.E2.m1.3.3.1.1.3.3.1">superscript</csymbol><apply id="S3.E2.m1.3.3.1.1.3.3.1.2.cmml" xref="S3.E2.m1.3.3.1.1.3.3.1"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.3.3.1.2.1.cmml" xref="S3.E2.m1.3.3.1.1.3.3.1">subscript</csymbol><sum id="S3.E2.m1.3.3.1.1.3.3.1.2.2.cmml" xref="S3.E2.m1.3.3.1.1.3.3.1.2.2"></sum><apply id="S3.E2.m1.3.3.1.1.3.3.1.2.3.cmml" xref="S3.E2.m1.3.3.1.1.3.3.1.2.3"><eq id="S3.E2.m1.3.3.1.1.3.3.1.2.3.1.cmml" xref="S3.E2.m1.3.3.1.1.3.3.1.2.3.1"></eq><ci id="S3.E2.m1.3.3.1.1.3.3.1.2.3.2.cmml" xref="S3.E2.m1.3.3.1.1.3.3.1.2.3.2">𝑖</ci><cn type="integer" id="S3.E2.m1.3.3.1.1.3.3.1.2.3.3.cmml" xref="S3.E2.m1.3.3.1.1.3.3.1.2.3.3">1</cn></apply></apply><ci id="S3.E2.m1.3.3.1.1.3.3.1.3.cmml" xref="S3.E2.m1.3.3.1.1.3.3.1.3">𝑁</ci></apply><apply id="S3.E2.m1.3.3.1.1.3.3.2.cmml" xref="S3.E2.m1.3.3.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.3.3.2.1.cmml" xref="S3.E2.m1.3.3.1.1.3.3.2">subscript</csymbol><ci id="S3.E2.m1.3.3.1.1.3.3.2.2.cmml" xref="S3.E2.m1.3.3.1.1.3.3.2.2">𝑠</ci><list id="S3.E2.m1.2.2.2.3.cmml" xref="S3.E2.m1.2.2.2.4"><ci id="S3.E2.m1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1">𝑖</ci><ci id="S3.E2.m1.2.2.2.2.cmml" xref="S3.E2.m1.2.2.2.2">𝑗</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.3c">z^{GAP}_{j}=\frac{1}{N}\sum_{i=1}^{N}s_{i,j}.</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m1.3d">italic_z start_POSTSUPERSCRIPT italic_G italic_A italic_P end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT = divide start_ARG 1 end_ARG start_ARG italic_N end_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT italic_s start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr>
</table>
<p id="S3.SS2.p3.1" class="ltx_p">This score is expected to be high if the referring expression is contained in
the image. However, the score is dependent on the object size and results in low
scores for small objects. An alternative to GAP is global max pooling (GMP):</p>
<table id="S3.E3" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E3.m1.3" class="ltx_Math" alttext="z^{GMP}_{j}=\max_{i}(s_{i,j})." display="block"><semantics id="S3.E3.m1.3a"><mrow id="S3.E3.m1.3.3.1" xref="S3.E3.m1.3.3.1.1.cmml"><mrow id="S3.E3.m1.3.3.1.1" xref="S3.E3.m1.3.3.1.1.cmml"><msubsup id="S3.E3.m1.3.3.1.1.4" xref="S3.E3.m1.3.3.1.1.4.cmml"><mi id="S3.E3.m1.3.3.1.1.4.2.2" xref="S3.E3.m1.3.3.1.1.4.2.2.cmml">z</mi><mi id="S3.E3.m1.3.3.1.1.4.3" xref="S3.E3.m1.3.3.1.1.4.3.cmml">j</mi><mrow id="S3.E3.m1.3.3.1.1.4.2.3" xref="S3.E3.m1.3.3.1.1.4.2.3.cmml"><mi id="S3.E3.m1.3.3.1.1.4.2.3.2" xref="S3.E3.m1.3.3.1.1.4.2.3.2.cmml">G</mi><mo id="S3.E3.m1.3.3.1.1.4.2.3.1" xref="S3.E3.m1.3.3.1.1.4.2.3.1.cmml">⁢</mo><mi id="S3.E3.m1.3.3.1.1.4.2.3.3" xref="S3.E3.m1.3.3.1.1.4.2.3.3.cmml">M</mi><mo id="S3.E3.m1.3.3.1.1.4.2.3.1a" xref="S3.E3.m1.3.3.1.1.4.2.3.1.cmml">⁢</mo><mi id="S3.E3.m1.3.3.1.1.4.2.3.4" xref="S3.E3.m1.3.3.1.1.4.2.3.4.cmml">P</mi></mrow></msubsup><mo id="S3.E3.m1.3.3.1.1.3" xref="S3.E3.m1.3.3.1.1.3.cmml">=</mo><mrow id="S3.E3.m1.3.3.1.1.2.2" xref="S3.E3.m1.3.3.1.1.2.3.cmml"><munder id="S3.E3.m1.3.3.1.1.1.1.1" xref="S3.E3.m1.3.3.1.1.1.1.1.cmml"><mi id="S3.E3.m1.3.3.1.1.1.1.1.2" xref="S3.E3.m1.3.3.1.1.1.1.1.2.cmml">max</mi><mi id="S3.E3.m1.3.3.1.1.1.1.1.3" xref="S3.E3.m1.3.3.1.1.1.1.1.3.cmml">i</mi></munder><mo id="S3.E3.m1.3.3.1.1.2.2a" xref="S3.E3.m1.3.3.1.1.2.3.cmml">⁡</mo><mrow id="S3.E3.m1.3.3.1.1.2.2.2" xref="S3.E3.m1.3.3.1.1.2.3.cmml"><mo stretchy="false" id="S3.E3.m1.3.3.1.1.2.2.2.2" xref="S3.E3.m1.3.3.1.1.2.3.cmml">(</mo><msub id="S3.E3.m1.3.3.1.1.2.2.2.1" xref="S3.E3.m1.3.3.1.1.2.2.2.1.cmml"><mi id="S3.E3.m1.3.3.1.1.2.2.2.1.2" xref="S3.E3.m1.3.3.1.1.2.2.2.1.2.cmml">s</mi><mrow id="S3.E3.m1.2.2.2.4" xref="S3.E3.m1.2.2.2.3.cmml"><mi id="S3.E3.m1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.cmml">i</mi><mo id="S3.E3.m1.2.2.2.4.1" xref="S3.E3.m1.2.2.2.3.cmml">,</mo><mi id="S3.E3.m1.2.2.2.2" xref="S3.E3.m1.2.2.2.2.cmml">j</mi></mrow></msub><mo stretchy="false" id="S3.E3.m1.3.3.1.1.2.2.2.3" xref="S3.E3.m1.3.3.1.1.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E3.m1.3.3.1.2" xref="S3.E3.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.3b"><apply id="S3.E3.m1.3.3.1.1.cmml" xref="S3.E3.m1.3.3.1"><eq id="S3.E3.m1.3.3.1.1.3.cmml" xref="S3.E3.m1.3.3.1.1.3"></eq><apply id="S3.E3.m1.3.3.1.1.4.cmml" xref="S3.E3.m1.3.3.1.1.4"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.1.1.4.1.cmml" xref="S3.E3.m1.3.3.1.1.4">subscript</csymbol><apply id="S3.E3.m1.3.3.1.1.4.2.cmml" xref="S3.E3.m1.3.3.1.1.4"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.1.1.4.2.1.cmml" xref="S3.E3.m1.3.3.1.1.4">superscript</csymbol><ci id="S3.E3.m1.3.3.1.1.4.2.2.cmml" xref="S3.E3.m1.3.3.1.1.4.2.2">𝑧</ci><apply id="S3.E3.m1.3.3.1.1.4.2.3.cmml" xref="S3.E3.m1.3.3.1.1.4.2.3"><times id="S3.E3.m1.3.3.1.1.4.2.3.1.cmml" xref="S3.E3.m1.3.3.1.1.4.2.3.1"></times><ci id="S3.E3.m1.3.3.1.1.4.2.3.2.cmml" xref="S3.E3.m1.3.3.1.1.4.2.3.2">𝐺</ci><ci id="S3.E3.m1.3.3.1.1.4.2.3.3.cmml" xref="S3.E3.m1.3.3.1.1.4.2.3.3">𝑀</ci><ci id="S3.E3.m1.3.3.1.1.4.2.3.4.cmml" xref="S3.E3.m1.3.3.1.1.4.2.3.4">𝑃</ci></apply></apply><ci id="S3.E3.m1.3.3.1.1.4.3.cmml" xref="S3.E3.m1.3.3.1.1.4.3">𝑗</ci></apply><apply id="S3.E3.m1.3.3.1.1.2.3.cmml" xref="S3.E3.m1.3.3.1.1.2.2"><apply id="S3.E3.m1.3.3.1.1.1.1.1.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1">subscript</csymbol><max id="S3.E3.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.2"></max><ci id="S3.E3.m1.3.3.1.1.1.1.1.3.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E3.m1.3.3.1.1.2.2.2.1.cmml" xref="S3.E3.m1.3.3.1.1.2.2.2.1"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.1.1.2.2.2.1.1.cmml" xref="S3.E3.m1.3.3.1.1.2.2.2.1">subscript</csymbol><ci id="S3.E3.m1.3.3.1.1.2.2.2.1.2.cmml" xref="S3.E3.m1.3.3.1.1.2.2.2.1.2">𝑠</ci><list id="S3.E3.m1.2.2.2.3.cmml" xref="S3.E3.m1.2.2.2.4"><ci id="S3.E3.m1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1">𝑖</ci><ci id="S3.E3.m1.2.2.2.2.cmml" xref="S3.E3.m1.2.2.2.2">𝑗</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.3c">z^{GMP}_{j}=\max_{i}(s_{i,j}).</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m1.3d">italic_z start_POSTSUPERSCRIPT italic_G italic_M italic_P end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT = roman_max start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr>
</table>
<p id="S3.SS2.p3.2" class="ltx_p">The max operation in GMP decreases the influence of the object
size, however it tends to focus on most discriminative regions of a class
<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib57" title="" class="ltx_ref">57</a>]</cite>.
<br class="ltx_break"></p>
</div>
<div id="S3.SS2.p4" class="ltx_para">
<p id="S3.SS2.p4.3" class="ltx_p"><span id="S3.SS2.p4.3.1" class="ltx_text ltx_font_bold">Global weighted pooling (GWP).</span>
To address the shortcomings of GAP and GMP, we follow <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite> and
make use of weighted pooling. Global weighted pooling replaces the constant
patch weights <math id="S3.SS2.p4.1.m1.1" class="ltx_Math" alttext="1/N" display="inline"><semantics id="S3.SS2.p4.1.m1.1a"><mrow id="S3.SS2.p4.1.m1.1.1" xref="S3.SS2.p4.1.m1.1.1.cmml"><mn id="S3.SS2.p4.1.m1.1.1.2" xref="S3.SS2.p4.1.m1.1.1.2.cmml">1</mn><mo id="S3.SS2.p4.1.m1.1.1.1" xref="S3.SS2.p4.1.m1.1.1.1.cmml">/</mo><mi id="S3.SS2.p4.1.m1.1.1.3" xref="S3.SS2.p4.1.m1.1.1.3.cmml">N</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.1.m1.1b"><apply id="S3.SS2.p4.1.m1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1"><divide id="S3.SS2.p4.1.m1.1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1.1"></divide><cn type="integer" id="S3.SS2.p4.1.m1.1.1.2.cmml" xref="S3.SS2.p4.1.m1.1.1.2">1</cn><ci id="S3.SS2.p4.1.m1.1.1.3.cmml" xref="S3.SS2.p4.1.m1.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.1.m1.1c">1/N</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.1.m1.1d">1 / italic_N</annotation></semantics></math> in the sum of <math id="S3.SS2.p4.2.m2.1" class="ltx_Math" alttext="GAP" display="inline"><semantics id="S3.SS2.p4.2.m2.1a"><mrow id="S3.SS2.p4.2.m2.1.1" xref="S3.SS2.p4.2.m2.1.1.cmml"><mi id="S3.SS2.p4.2.m2.1.1.2" xref="S3.SS2.p4.2.m2.1.1.2.cmml">G</mi><mo id="S3.SS2.p4.2.m2.1.1.1" xref="S3.SS2.p4.2.m2.1.1.1.cmml">⁢</mo><mi id="S3.SS2.p4.2.m2.1.1.3" xref="S3.SS2.p4.2.m2.1.1.3.cmml">A</mi><mo id="S3.SS2.p4.2.m2.1.1.1a" xref="S3.SS2.p4.2.m2.1.1.1.cmml">⁢</mo><mi id="S3.SS2.p4.2.m2.1.1.4" xref="S3.SS2.p4.2.m2.1.1.4.cmml">P</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.2.m2.1b"><apply id="S3.SS2.p4.2.m2.1.1.cmml" xref="S3.SS2.p4.2.m2.1.1"><times id="S3.SS2.p4.2.m2.1.1.1.cmml" xref="S3.SS2.p4.2.m2.1.1.1"></times><ci id="S3.SS2.p4.2.m2.1.1.2.cmml" xref="S3.SS2.p4.2.m2.1.1.2">𝐺</ci><ci id="S3.SS2.p4.2.m2.1.1.3.cmml" xref="S3.SS2.p4.2.m2.1.1.3">𝐴</ci><ci id="S3.SS2.p4.2.m2.1.1.4.cmml" xref="S3.SS2.p4.2.m2.1.1.4">𝑃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.2.m2.1c">GAP</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.2.m2.1d">italic_G italic_A italic_P</annotation></semantics></math> by weights
<math id="S3.SS2.p4.3.m3.5" class="ltx_Math" alttext="\mathbf{W}=(w_{i,j})_{i,j}\in\mathbb{R}^{N\times L}" display="inline"><semantics id="S3.SS2.p4.3.m3.5a"><mrow id="S3.SS2.p4.3.m3.5.5" xref="S3.SS2.p4.3.m3.5.5.cmml"><mi id="S3.SS2.p4.3.m3.5.5.3" xref="S3.SS2.p4.3.m3.5.5.3.cmml">𝐖</mi><mo id="S3.SS2.p4.3.m3.5.5.4" xref="S3.SS2.p4.3.m3.5.5.4.cmml">=</mo><msub id="S3.SS2.p4.3.m3.5.5.1" xref="S3.SS2.p4.3.m3.5.5.1.cmml"><mrow id="S3.SS2.p4.3.m3.5.5.1.1.1" xref="S3.SS2.p4.3.m3.5.5.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p4.3.m3.5.5.1.1.1.2" xref="S3.SS2.p4.3.m3.5.5.1.1.1.1.cmml">(</mo><msub id="S3.SS2.p4.3.m3.5.5.1.1.1.1" xref="S3.SS2.p4.3.m3.5.5.1.1.1.1.cmml"><mi id="S3.SS2.p4.3.m3.5.5.1.1.1.1.2" xref="S3.SS2.p4.3.m3.5.5.1.1.1.1.2.cmml">w</mi><mrow id="S3.SS2.p4.3.m3.2.2.2.4" xref="S3.SS2.p4.3.m3.2.2.2.3.cmml"><mi id="S3.SS2.p4.3.m3.1.1.1.1" xref="S3.SS2.p4.3.m3.1.1.1.1.cmml">i</mi><mo id="S3.SS2.p4.3.m3.2.2.2.4.1" xref="S3.SS2.p4.3.m3.2.2.2.3.cmml">,</mo><mi id="S3.SS2.p4.3.m3.2.2.2.2" xref="S3.SS2.p4.3.m3.2.2.2.2.cmml">j</mi></mrow></msub><mo stretchy="false" id="S3.SS2.p4.3.m3.5.5.1.1.1.3" xref="S3.SS2.p4.3.m3.5.5.1.1.1.1.cmml">)</mo></mrow><mrow id="S3.SS2.p4.3.m3.4.4.2.4" xref="S3.SS2.p4.3.m3.4.4.2.3.cmml"><mi id="S3.SS2.p4.3.m3.3.3.1.1" xref="S3.SS2.p4.3.m3.3.3.1.1.cmml">i</mi><mo id="S3.SS2.p4.3.m3.4.4.2.4.1" xref="S3.SS2.p4.3.m3.4.4.2.3.cmml">,</mo><mi id="S3.SS2.p4.3.m3.4.4.2.2" xref="S3.SS2.p4.3.m3.4.4.2.2.cmml">j</mi></mrow></msub><mo id="S3.SS2.p4.3.m3.5.5.5" xref="S3.SS2.p4.3.m3.5.5.5.cmml">∈</mo><msup id="S3.SS2.p4.3.m3.5.5.6" xref="S3.SS2.p4.3.m3.5.5.6.cmml"><mi id="S3.SS2.p4.3.m3.5.5.6.2" xref="S3.SS2.p4.3.m3.5.5.6.2.cmml">ℝ</mi><mrow id="S3.SS2.p4.3.m3.5.5.6.3" xref="S3.SS2.p4.3.m3.5.5.6.3.cmml"><mi id="S3.SS2.p4.3.m3.5.5.6.3.2" xref="S3.SS2.p4.3.m3.5.5.6.3.2.cmml">N</mi><mo id="S3.SS2.p4.3.m3.5.5.6.3.1" xref="S3.SS2.p4.3.m3.5.5.6.3.1.cmml">×</mo><mi id="S3.SS2.p4.3.m3.5.5.6.3.3" xref="S3.SS2.p4.3.m3.5.5.6.3.3.cmml">L</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.3.m3.5b"><apply id="S3.SS2.p4.3.m3.5.5.cmml" xref="S3.SS2.p4.3.m3.5.5"><and id="S3.SS2.p4.3.m3.5.5a.cmml" xref="S3.SS2.p4.3.m3.5.5"></and><apply id="S3.SS2.p4.3.m3.5.5b.cmml" xref="S3.SS2.p4.3.m3.5.5"><eq id="S3.SS2.p4.3.m3.5.5.4.cmml" xref="S3.SS2.p4.3.m3.5.5.4"></eq><ci id="S3.SS2.p4.3.m3.5.5.3.cmml" xref="S3.SS2.p4.3.m3.5.5.3">𝐖</ci><apply id="S3.SS2.p4.3.m3.5.5.1.cmml" xref="S3.SS2.p4.3.m3.5.5.1"><csymbol cd="ambiguous" id="S3.SS2.p4.3.m3.5.5.1.2.cmml" xref="S3.SS2.p4.3.m3.5.5.1">subscript</csymbol><apply id="S3.SS2.p4.3.m3.5.5.1.1.1.1.cmml" xref="S3.SS2.p4.3.m3.5.5.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.3.m3.5.5.1.1.1.1.1.cmml" xref="S3.SS2.p4.3.m3.5.5.1.1.1">subscript</csymbol><ci id="S3.SS2.p4.3.m3.5.5.1.1.1.1.2.cmml" xref="S3.SS2.p4.3.m3.5.5.1.1.1.1.2">𝑤</ci><list id="S3.SS2.p4.3.m3.2.2.2.3.cmml" xref="S3.SS2.p4.3.m3.2.2.2.4"><ci id="S3.SS2.p4.3.m3.1.1.1.1.cmml" xref="S3.SS2.p4.3.m3.1.1.1.1">𝑖</ci><ci id="S3.SS2.p4.3.m3.2.2.2.2.cmml" xref="S3.SS2.p4.3.m3.2.2.2.2">𝑗</ci></list></apply><list id="S3.SS2.p4.3.m3.4.4.2.3.cmml" xref="S3.SS2.p4.3.m3.4.4.2.4"><ci id="S3.SS2.p4.3.m3.3.3.1.1.cmml" xref="S3.SS2.p4.3.m3.3.3.1.1">𝑖</ci><ci id="S3.SS2.p4.3.m3.4.4.2.2.cmml" xref="S3.SS2.p4.3.m3.4.4.2.2">𝑗</ci></list></apply></apply><apply id="S3.SS2.p4.3.m3.5.5c.cmml" xref="S3.SS2.p4.3.m3.5.5"><in id="S3.SS2.p4.3.m3.5.5.5.cmml" xref="S3.SS2.p4.3.m3.5.5.5"></in><share href="#S3.SS2.p4.3.m3.5.5.1.cmml" id="S3.SS2.p4.3.m3.5.5d.cmml" xref="S3.SS2.p4.3.m3.5.5"></share><apply id="S3.SS2.p4.3.m3.5.5.6.cmml" xref="S3.SS2.p4.3.m3.5.5.6"><csymbol cd="ambiguous" id="S3.SS2.p4.3.m3.5.5.6.1.cmml" xref="S3.SS2.p4.3.m3.5.5.6">superscript</csymbol><ci id="S3.SS2.p4.3.m3.5.5.6.2.cmml" xref="S3.SS2.p4.3.m3.5.5.6.2">ℝ</ci><apply id="S3.SS2.p4.3.m3.5.5.6.3.cmml" xref="S3.SS2.p4.3.m3.5.5.6.3"><times id="S3.SS2.p4.3.m3.5.5.6.3.1.cmml" xref="S3.SS2.p4.3.m3.5.5.6.3.1"></times><ci id="S3.SS2.p4.3.m3.5.5.6.3.2.cmml" xref="S3.SS2.p4.3.m3.5.5.6.3.2">𝑁</ci><ci id="S3.SS2.p4.3.m3.5.5.6.3.3.cmml" xref="S3.SS2.p4.3.m3.5.5.6.3.3">𝐿</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.3.m3.5c">\mathbf{W}=(w_{i,j})_{i,j}\in\mathbb{R}^{N\times L}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.3.m3.5d">bold_W = ( italic_w start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT ) start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_N × italic_L end_POSTSUPERSCRIPT</annotation></semantics></math>. The final score of a
referring expression is then the weighted average of similarities:</p>
<table id="S3.E4" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E4.m1.5" class="ltx_Math" alttext="z_{j}^{GWP}=\sum_{i=1}^{N}w_{i,j}s_{i,j}," display="block"><semantics id="S3.E4.m1.5a"><mrow id="S3.E4.m1.5.5.1" xref="S3.E4.m1.5.5.1.1.cmml"><mrow id="S3.E4.m1.5.5.1.1" xref="S3.E4.m1.5.5.1.1.cmml"><msubsup id="S3.E4.m1.5.5.1.1.2" xref="S3.E4.m1.5.5.1.1.2.cmml"><mi id="S3.E4.m1.5.5.1.1.2.2.2" xref="S3.E4.m1.5.5.1.1.2.2.2.cmml">z</mi><mi id="S3.E4.m1.5.5.1.1.2.2.3" xref="S3.E4.m1.5.5.1.1.2.2.3.cmml">j</mi><mrow id="S3.E4.m1.5.5.1.1.2.3" xref="S3.E4.m1.5.5.1.1.2.3.cmml"><mi id="S3.E4.m1.5.5.1.1.2.3.2" xref="S3.E4.m1.5.5.1.1.2.3.2.cmml">G</mi><mo id="S3.E4.m1.5.5.1.1.2.3.1" xref="S3.E4.m1.5.5.1.1.2.3.1.cmml">⁢</mo><mi id="S3.E4.m1.5.5.1.1.2.3.3" xref="S3.E4.m1.5.5.1.1.2.3.3.cmml">W</mi><mo id="S3.E4.m1.5.5.1.1.2.3.1a" xref="S3.E4.m1.5.5.1.1.2.3.1.cmml">⁢</mo><mi id="S3.E4.m1.5.5.1.1.2.3.4" xref="S3.E4.m1.5.5.1.1.2.3.4.cmml">P</mi></mrow></msubsup><mo id="S3.E4.m1.5.5.1.1.1" xref="S3.E4.m1.5.5.1.1.1.cmml">=</mo><mrow id="S3.E4.m1.5.5.1.1.3" xref="S3.E4.m1.5.5.1.1.3.cmml"><munderover id="S3.E4.m1.5.5.1.1.3.1" xref="S3.E4.m1.5.5.1.1.3.1.cmml"><mo largeop="true" movablelimits="false" symmetric="true" id="S3.E4.m1.5.5.1.1.3.1.2.2" xref="S3.E4.m1.5.5.1.1.3.1.2.2.cmml">∑</mo><mrow id="S3.E4.m1.5.5.1.1.3.1.2.3" xref="S3.E4.m1.5.5.1.1.3.1.2.3.cmml"><mi id="S3.E4.m1.5.5.1.1.3.1.2.3.2" xref="S3.E4.m1.5.5.1.1.3.1.2.3.2.cmml">i</mi><mo id="S3.E4.m1.5.5.1.1.3.1.2.3.1" xref="S3.E4.m1.5.5.1.1.3.1.2.3.1.cmml">=</mo><mn id="S3.E4.m1.5.5.1.1.3.1.2.3.3" xref="S3.E4.m1.5.5.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E4.m1.5.5.1.1.3.1.3" xref="S3.E4.m1.5.5.1.1.3.1.3.cmml">N</mi></munderover><mrow id="S3.E4.m1.5.5.1.1.3.2" xref="S3.E4.m1.5.5.1.1.3.2.cmml"><msub id="S3.E4.m1.5.5.1.1.3.2.2" xref="S3.E4.m1.5.5.1.1.3.2.2.cmml"><mi id="S3.E4.m1.5.5.1.1.3.2.2.2" xref="S3.E4.m1.5.5.1.1.3.2.2.2.cmml">w</mi><mrow id="S3.E4.m1.2.2.2.4" xref="S3.E4.m1.2.2.2.3.cmml"><mi id="S3.E4.m1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml">i</mi><mo id="S3.E4.m1.2.2.2.4.1" xref="S3.E4.m1.2.2.2.3.cmml">,</mo><mi id="S3.E4.m1.2.2.2.2" xref="S3.E4.m1.2.2.2.2.cmml">j</mi></mrow></msub><mo id="S3.E4.m1.5.5.1.1.3.2.1" xref="S3.E4.m1.5.5.1.1.3.2.1.cmml">⁢</mo><msub id="S3.E4.m1.5.5.1.1.3.2.3" xref="S3.E4.m1.5.5.1.1.3.2.3.cmml"><mi id="S3.E4.m1.5.5.1.1.3.2.3.2" xref="S3.E4.m1.5.5.1.1.3.2.3.2.cmml">s</mi><mrow id="S3.E4.m1.4.4.2.4" xref="S3.E4.m1.4.4.2.3.cmml"><mi id="S3.E4.m1.3.3.1.1" xref="S3.E4.m1.3.3.1.1.cmml">i</mi><mo id="S3.E4.m1.4.4.2.4.1" xref="S3.E4.m1.4.4.2.3.cmml">,</mo><mi id="S3.E4.m1.4.4.2.2" xref="S3.E4.m1.4.4.2.2.cmml">j</mi></mrow></msub></mrow></mrow></mrow><mo id="S3.E4.m1.5.5.1.2" xref="S3.E4.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.5b"><apply id="S3.E4.m1.5.5.1.1.cmml" xref="S3.E4.m1.5.5.1"><eq id="S3.E4.m1.5.5.1.1.1.cmml" xref="S3.E4.m1.5.5.1.1.1"></eq><apply id="S3.E4.m1.5.5.1.1.2.cmml" xref="S3.E4.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.1.1.2.1.cmml" xref="S3.E4.m1.5.5.1.1.2">superscript</csymbol><apply id="S3.E4.m1.5.5.1.1.2.2.cmml" xref="S3.E4.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.1.1.2.2.1.cmml" xref="S3.E4.m1.5.5.1.1.2">subscript</csymbol><ci id="S3.E4.m1.5.5.1.1.2.2.2.cmml" xref="S3.E4.m1.5.5.1.1.2.2.2">𝑧</ci><ci id="S3.E4.m1.5.5.1.1.2.2.3.cmml" xref="S3.E4.m1.5.5.1.1.2.2.3">𝑗</ci></apply><apply id="S3.E4.m1.5.5.1.1.2.3.cmml" xref="S3.E4.m1.5.5.1.1.2.3"><times id="S3.E4.m1.5.5.1.1.2.3.1.cmml" xref="S3.E4.m1.5.5.1.1.2.3.1"></times><ci id="S3.E4.m1.5.5.1.1.2.3.2.cmml" xref="S3.E4.m1.5.5.1.1.2.3.2">𝐺</ci><ci id="S3.E4.m1.5.5.1.1.2.3.3.cmml" xref="S3.E4.m1.5.5.1.1.2.3.3">𝑊</ci><ci id="S3.E4.m1.5.5.1.1.2.3.4.cmml" xref="S3.E4.m1.5.5.1.1.2.3.4">𝑃</ci></apply></apply><apply id="S3.E4.m1.5.5.1.1.3.cmml" xref="S3.E4.m1.5.5.1.1.3"><apply id="S3.E4.m1.5.5.1.1.3.1.cmml" xref="S3.E4.m1.5.5.1.1.3.1"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.1.1.3.1.1.cmml" xref="S3.E4.m1.5.5.1.1.3.1">superscript</csymbol><apply id="S3.E4.m1.5.5.1.1.3.1.2.cmml" xref="S3.E4.m1.5.5.1.1.3.1"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.1.1.3.1.2.1.cmml" xref="S3.E4.m1.5.5.1.1.3.1">subscript</csymbol><sum id="S3.E4.m1.5.5.1.1.3.1.2.2.cmml" xref="S3.E4.m1.5.5.1.1.3.1.2.2"></sum><apply id="S3.E4.m1.5.5.1.1.3.1.2.3.cmml" xref="S3.E4.m1.5.5.1.1.3.1.2.3"><eq id="S3.E4.m1.5.5.1.1.3.1.2.3.1.cmml" xref="S3.E4.m1.5.5.1.1.3.1.2.3.1"></eq><ci id="S3.E4.m1.5.5.1.1.3.1.2.3.2.cmml" xref="S3.E4.m1.5.5.1.1.3.1.2.3.2">𝑖</ci><cn type="integer" id="S3.E4.m1.5.5.1.1.3.1.2.3.3.cmml" xref="S3.E4.m1.5.5.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S3.E4.m1.5.5.1.1.3.1.3.cmml" xref="S3.E4.m1.5.5.1.1.3.1.3">𝑁</ci></apply><apply id="S3.E4.m1.5.5.1.1.3.2.cmml" xref="S3.E4.m1.5.5.1.1.3.2"><times id="S3.E4.m1.5.5.1.1.3.2.1.cmml" xref="S3.E4.m1.5.5.1.1.3.2.1"></times><apply id="S3.E4.m1.5.5.1.1.3.2.2.cmml" xref="S3.E4.m1.5.5.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.1.1.3.2.2.1.cmml" xref="S3.E4.m1.5.5.1.1.3.2.2">subscript</csymbol><ci id="S3.E4.m1.5.5.1.1.3.2.2.2.cmml" xref="S3.E4.m1.5.5.1.1.3.2.2.2">𝑤</ci><list id="S3.E4.m1.2.2.2.3.cmml" xref="S3.E4.m1.2.2.2.4"><ci id="S3.E4.m1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1">𝑖</ci><ci id="S3.E4.m1.2.2.2.2.cmml" xref="S3.E4.m1.2.2.2.2">𝑗</ci></list></apply><apply id="S3.E4.m1.5.5.1.1.3.2.3.cmml" xref="S3.E4.m1.5.5.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.1.1.3.2.3.1.cmml" xref="S3.E4.m1.5.5.1.1.3.2.3">subscript</csymbol><ci id="S3.E4.m1.5.5.1.1.3.2.3.2.cmml" xref="S3.E4.m1.5.5.1.1.3.2.3.2">𝑠</ci><list id="S3.E4.m1.4.4.2.3.cmml" xref="S3.E4.m1.4.4.2.4"><ci id="S3.E4.m1.3.3.1.1.cmml" xref="S3.E4.m1.3.3.1.1">𝑖</ci><ci id="S3.E4.m1.4.4.2.2.cmml" xref="S3.E4.m1.4.4.2.2">𝑗</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.5c">z_{j}^{GWP}=\sum_{i=1}^{N}w_{i,j}s_{i,j},</annotation><annotation encoding="application/x-llamapun" id="S3.E4.m1.5d">italic_z start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_G italic_W italic_P end_POSTSUPERSCRIPT = ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT italic_w start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT italic_s start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr>
</table>
<p id="S3.SS2.p4.13" class="ltx_p">as illustrated in Figure <a href="#S3.F3" title="Figure 3 ‣ 3.2 Global Pooling Mechanisms ‣ 3 Method ‣ Weakly-supervised segmentation of referring expressions" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> left.
In practice, <math id="S3.SS2.p4.4.m1.1" class="ltx_Math" alttext="\mathbf{W}" display="inline"><semantics id="S3.SS2.p4.4.m1.1a"><mi id="S3.SS2.p4.4.m1.1.1" xref="S3.SS2.p4.4.m1.1.1.cmml">𝐖</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.4.m1.1b"><ci id="S3.SS2.p4.4.m1.1.1.cmml" xref="S3.SS2.p4.4.m1.1.1">𝐖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.4.m1.1c">\mathbf{W}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.4.m1.1d">bold_W</annotation></semantics></math> is defined in terms of spatially normalized mask scores
<math id="S3.SS2.p4.5.m2.5" class="ltx_Math" alttext="\mathbf{M}=(m_{i,j})_{i,j}\in\mathbb{R}^{N\times L}" display="inline"><semantics id="S3.SS2.p4.5.m2.5a"><mrow id="S3.SS2.p4.5.m2.5.5" xref="S3.SS2.p4.5.m2.5.5.cmml"><mi id="S3.SS2.p4.5.m2.5.5.3" xref="S3.SS2.p4.5.m2.5.5.3.cmml">𝐌</mi><mo id="S3.SS2.p4.5.m2.5.5.4" xref="S3.SS2.p4.5.m2.5.5.4.cmml">=</mo><msub id="S3.SS2.p4.5.m2.5.5.1" xref="S3.SS2.p4.5.m2.5.5.1.cmml"><mrow id="S3.SS2.p4.5.m2.5.5.1.1.1" xref="S3.SS2.p4.5.m2.5.5.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p4.5.m2.5.5.1.1.1.2" xref="S3.SS2.p4.5.m2.5.5.1.1.1.1.cmml">(</mo><msub id="S3.SS2.p4.5.m2.5.5.1.1.1.1" xref="S3.SS2.p4.5.m2.5.5.1.1.1.1.cmml"><mi id="S3.SS2.p4.5.m2.5.5.1.1.1.1.2" xref="S3.SS2.p4.5.m2.5.5.1.1.1.1.2.cmml">m</mi><mrow id="S3.SS2.p4.5.m2.2.2.2.4" xref="S3.SS2.p4.5.m2.2.2.2.3.cmml"><mi id="S3.SS2.p4.5.m2.1.1.1.1" xref="S3.SS2.p4.5.m2.1.1.1.1.cmml">i</mi><mo id="S3.SS2.p4.5.m2.2.2.2.4.1" xref="S3.SS2.p4.5.m2.2.2.2.3.cmml">,</mo><mi id="S3.SS2.p4.5.m2.2.2.2.2" xref="S3.SS2.p4.5.m2.2.2.2.2.cmml">j</mi></mrow></msub><mo stretchy="false" id="S3.SS2.p4.5.m2.5.5.1.1.1.3" xref="S3.SS2.p4.5.m2.5.5.1.1.1.1.cmml">)</mo></mrow><mrow id="S3.SS2.p4.5.m2.4.4.2.4" xref="S3.SS2.p4.5.m2.4.4.2.3.cmml"><mi id="S3.SS2.p4.5.m2.3.3.1.1" xref="S3.SS2.p4.5.m2.3.3.1.1.cmml">i</mi><mo id="S3.SS2.p4.5.m2.4.4.2.4.1" xref="S3.SS2.p4.5.m2.4.4.2.3.cmml">,</mo><mi id="S3.SS2.p4.5.m2.4.4.2.2" xref="S3.SS2.p4.5.m2.4.4.2.2.cmml">j</mi></mrow></msub><mo id="S3.SS2.p4.5.m2.5.5.5" xref="S3.SS2.p4.5.m2.5.5.5.cmml">∈</mo><msup id="S3.SS2.p4.5.m2.5.5.6" xref="S3.SS2.p4.5.m2.5.5.6.cmml"><mi id="S3.SS2.p4.5.m2.5.5.6.2" xref="S3.SS2.p4.5.m2.5.5.6.2.cmml">ℝ</mi><mrow id="S3.SS2.p4.5.m2.5.5.6.3" xref="S3.SS2.p4.5.m2.5.5.6.3.cmml"><mi id="S3.SS2.p4.5.m2.5.5.6.3.2" xref="S3.SS2.p4.5.m2.5.5.6.3.2.cmml">N</mi><mo id="S3.SS2.p4.5.m2.5.5.6.3.1" xref="S3.SS2.p4.5.m2.5.5.6.3.1.cmml">×</mo><mi id="S3.SS2.p4.5.m2.5.5.6.3.3" xref="S3.SS2.p4.5.m2.5.5.6.3.3.cmml">L</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.5.m2.5b"><apply id="S3.SS2.p4.5.m2.5.5.cmml" xref="S3.SS2.p4.5.m2.5.5"><and id="S3.SS2.p4.5.m2.5.5a.cmml" xref="S3.SS2.p4.5.m2.5.5"></and><apply id="S3.SS2.p4.5.m2.5.5b.cmml" xref="S3.SS2.p4.5.m2.5.5"><eq id="S3.SS2.p4.5.m2.5.5.4.cmml" xref="S3.SS2.p4.5.m2.5.5.4"></eq><ci id="S3.SS2.p4.5.m2.5.5.3.cmml" xref="S3.SS2.p4.5.m2.5.5.3">𝐌</ci><apply id="S3.SS2.p4.5.m2.5.5.1.cmml" xref="S3.SS2.p4.5.m2.5.5.1"><csymbol cd="ambiguous" id="S3.SS2.p4.5.m2.5.5.1.2.cmml" xref="S3.SS2.p4.5.m2.5.5.1">subscript</csymbol><apply id="S3.SS2.p4.5.m2.5.5.1.1.1.1.cmml" xref="S3.SS2.p4.5.m2.5.5.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.5.m2.5.5.1.1.1.1.1.cmml" xref="S3.SS2.p4.5.m2.5.5.1.1.1">subscript</csymbol><ci id="S3.SS2.p4.5.m2.5.5.1.1.1.1.2.cmml" xref="S3.SS2.p4.5.m2.5.5.1.1.1.1.2">𝑚</ci><list id="S3.SS2.p4.5.m2.2.2.2.3.cmml" xref="S3.SS2.p4.5.m2.2.2.2.4"><ci id="S3.SS2.p4.5.m2.1.1.1.1.cmml" xref="S3.SS2.p4.5.m2.1.1.1.1">𝑖</ci><ci id="S3.SS2.p4.5.m2.2.2.2.2.cmml" xref="S3.SS2.p4.5.m2.2.2.2.2">𝑗</ci></list></apply><list id="S3.SS2.p4.5.m2.4.4.2.3.cmml" xref="S3.SS2.p4.5.m2.4.4.2.4"><ci id="S3.SS2.p4.5.m2.3.3.1.1.cmml" xref="S3.SS2.p4.5.m2.3.3.1.1">𝑖</ci><ci id="S3.SS2.p4.5.m2.4.4.2.2.cmml" xref="S3.SS2.p4.5.m2.4.4.2.2">𝑗</ci></list></apply></apply><apply id="S3.SS2.p4.5.m2.5.5c.cmml" xref="S3.SS2.p4.5.m2.5.5"><in id="S3.SS2.p4.5.m2.5.5.5.cmml" xref="S3.SS2.p4.5.m2.5.5.5"></in><share href="#S3.SS2.p4.5.m2.5.5.1.cmml" id="S3.SS2.p4.5.m2.5.5d.cmml" xref="S3.SS2.p4.5.m2.5.5"></share><apply id="S3.SS2.p4.5.m2.5.5.6.cmml" xref="S3.SS2.p4.5.m2.5.5.6"><csymbol cd="ambiguous" id="S3.SS2.p4.5.m2.5.5.6.1.cmml" xref="S3.SS2.p4.5.m2.5.5.6">superscript</csymbol><ci id="S3.SS2.p4.5.m2.5.5.6.2.cmml" xref="S3.SS2.p4.5.m2.5.5.6.2">ℝ</ci><apply id="S3.SS2.p4.5.m2.5.5.6.3.cmml" xref="S3.SS2.p4.5.m2.5.5.6.3"><times id="S3.SS2.p4.5.m2.5.5.6.3.1.cmml" xref="S3.SS2.p4.5.m2.5.5.6.3.1"></times><ci id="S3.SS2.p4.5.m2.5.5.6.3.2.cmml" xref="S3.SS2.p4.5.m2.5.5.6.3.2">𝑁</ci><ci id="S3.SS2.p4.5.m2.5.5.6.3.3.cmml" xref="S3.SS2.p4.5.m2.5.5.6.3.3">𝐿</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.5.m2.5c">\mathbf{M}=(m_{i,j})_{i,j}\in\mathbb{R}^{N\times L}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.5.m2.5d">bold_M = ( italic_m start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT ) start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_N × italic_L end_POSTSUPERSCRIPT</annotation></semantics></math>,
based on <math id="S3.SS2.p4.6.m3.7" class="ltx_Math" alttext="w_{i,j}=m_{i,j}/(\sum_{i}m_{i,j}+\varepsilon)" display="inline"><semantics id="S3.SS2.p4.6.m3.7a"><mrow id="S3.SS2.p4.6.m3.7.7" xref="S3.SS2.p4.6.m3.7.7.cmml"><msub id="S3.SS2.p4.6.m3.7.7.3" xref="S3.SS2.p4.6.m3.7.7.3.cmml"><mi id="S3.SS2.p4.6.m3.7.7.3.2" xref="S3.SS2.p4.6.m3.7.7.3.2.cmml">w</mi><mrow id="S3.SS2.p4.6.m3.2.2.2.4" xref="S3.SS2.p4.6.m3.2.2.2.3.cmml"><mi id="S3.SS2.p4.6.m3.1.1.1.1" xref="S3.SS2.p4.6.m3.1.1.1.1.cmml">i</mi><mo id="S3.SS2.p4.6.m3.2.2.2.4.1" xref="S3.SS2.p4.6.m3.2.2.2.3.cmml">,</mo><mi id="S3.SS2.p4.6.m3.2.2.2.2" xref="S3.SS2.p4.6.m3.2.2.2.2.cmml">j</mi></mrow></msub><mo id="S3.SS2.p4.6.m3.7.7.2" xref="S3.SS2.p4.6.m3.7.7.2.cmml">=</mo><mrow id="S3.SS2.p4.6.m3.7.7.1" xref="S3.SS2.p4.6.m3.7.7.1.cmml"><msub id="S3.SS2.p4.6.m3.7.7.1.3" xref="S3.SS2.p4.6.m3.7.7.1.3.cmml"><mi id="S3.SS2.p4.6.m3.7.7.1.3.2" xref="S3.SS2.p4.6.m3.7.7.1.3.2.cmml">m</mi><mrow id="S3.SS2.p4.6.m3.4.4.2.4" xref="S3.SS2.p4.6.m3.4.4.2.3.cmml"><mi id="S3.SS2.p4.6.m3.3.3.1.1" xref="S3.SS2.p4.6.m3.3.3.1.1.cmml">i</mi><mo id="S3.SS2.p4.6.m3.4.4.2.4.1" xref="S3.SS2.p4.6.m3.4.4.2.3.cmml">,</mo><mi id="S3.SS2.p4.6.m3.4.4.2.2" xref="S3.SS2.p4.6.m3.4.4.2.2.cmml">j</mi></mrow></msub><mo id="S3.SS2.p4.6.m3.7.7.1.2" xref="S3.SS2.p4.6.m3.7.7.1.2.cmml">/</mo><mrow id="S3.SS2.p4.6.m3.7.7.1.1.1" xref="S3.SS2.p4.6.m3.7.7.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p4.6.m3.7.7.1.1.1.2" xref="S3.SS2.p4.6.m3.7.7.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.p4.6.m3.7.7.1.1.1.1" xref="S3.SS2.p4.6.m3.7.7.1.1.1.1.cmml"><mrow id="S3.SS2.p4.6.m3.7.7.1.1.1.1.2" xref="S3.SS2.p4.6.m3.7.7.1.1.1.1.2.cmml"><msub id="S3.SS2.p4.6.m3.7.7.1.1.1.1.2.1" xref="S3.SS2.p4.6.m3.7.7.1.1.1.1.2.1.cmml"><mo largeop="true" symmetric="true" id="S3.SS2.p4.6.m3.7.7.1.1.1.1.2.1.2" xref="S3.SS2.p4.6.m3.7.7.1.1.1.1.2.1.2.cmml">∑</mo><mi id="S3.SS2.p4.6.m3.7.7.1.1.1.1.2.1.3" xref="S3.SS2.p4.6.m3.7.7.1.1.1.1.2.1.3.cmml">i</mi></msub><msub id="S3.SS2.p4.6.m3.7.7.1.1.1.1.2.2" xref="S3.SS2.p4.6.m3.7.7.1.1.1.1.2.2.cmml"><mi id="S3.SS2.p4.6.m3.7.7.1.1.1.1.2.2.2" xref="S3.SS2.p4.6.m3.7.7.1.1.1.1.2.2.2.cmml">m</mi><mrow id="S3.SS2.p4.6.m3.6.6.2.4" xref="S3.SS2.p4.6.m3.6.6.2.3.cmml"><mi id="S3.SS2.p4.6.m3.5.5.1.1" xref="S3.SS2.p4.6.m3.5.5.1.1.cmml">i</mi><mo id="S3.SS2.p4.6.m3.6.6.2.4.1" xref="S3.SS2.p4.6.m3.6.6.2.3.cmml">,</mo><mi id="S3.SS2.p4.6.m3.6.6.2.2" xref="S3.SS2.p4.6.m3.6.6.2.2.cmml">j</mi></mrow></msub></mrow><mo id="S3.SS2.p4.6.m3.7.7.1.1.1.1.1" xref="S3.SS2.p4.6.m3.7.7.1.1.1.1.1.cmml">+</mo><mi id="S3.SS2.p4.6.m3.7.7.1.1.1.1.3" xref="S3.SS2.p4.6.m3.7.7.1.1.1.1.3.cmml">ε</mi></mrow><mo stretchy="false" id="S3.SS2.p4.6.m3.7.7.1.1.1.3" xref="S3.SS2.p4.6.m3.7.7.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.6.m3.7b"><apply id="S3.SS2.p4.6.m3.7.7.cmml" xref="S3.SS2.p4.6.m3.7.7"><eq id="S3.SS2.p4.6.m3.7.7.2.cmml" xref="S3.SS2.p4.6.m3.7.7.2"></eq><apply id="S3.SS2.p4.6.m3.7.7.3.cmml" xref="S3.SS2.p4.6.m3.7.7.3"><csymbol cd="ambiguous" id="S3.SS2.p4.6.m3.7.7.3.1.cmml" xref="S3.SS2.p4.6.m3.7.7.3">subscript</csymbol><ci id="S3.SS2.p4.6.m3.7.7.3.2.cmml" xref="S3.SS2.p4.6.m3.7.7.3.2">𝑤</ci><list id="S3.SS2.p4.6.m3.2.2.2.3.cmml" xref="S3.SS2.p4.6.m3.2.2.2.4"><ci id="S3.SS2.p4.6.m3.1.1.1.1.cmml" xref="S3.SS2.p4.6.m3.1.1.1.1">𝑖</ci><ci id="S3.SS2.p4.6.m3.2.2.2.2.cmml" xref="S3.SS2.p4.6.m3.2.2.2.2">𝑗</ci></list></apply><apply id="S3.SS2.p4.6.m3.7.7.1.cmml" xref="S3.SS2.p4.6.m3.7.7.1"><divide id="S3.SS2.p4.6.m3.7.7.1.2.cmml" xref="S3.SS2.p4.6.m3.7.7.1.2"></divide><apply id="S3.SS2.p4.6.m3.7.7.1.3.cmml" xref="S3.SS2.p4.6.m3.7.7.1.3"><csymbol cd="ambiguous" id="S3.SS2.p4.6.m3.7.7.1.3.1.cmml" xref="S3.SS2.p4.6.m3.7.7.1.3">subscript</csymbol><ci id="S3.SS2.p4.6.m3.7.7.1.3.2.cmml" xref="S3.SS2.p4.6.m3.7.7.1.3.2">𝑚</ci><list id="S3.SS2.p4.6.m3.4.4.2.3.cmml" xref="S3.SS2.p4.6.m3.4.4.2.4"><ci id="S3.SS2.p4.6.m3.3.3.1.1.cmml" xref="S3.SS2.p4.6.m3.3.3.1.1">𝑖</ci><ci id="S3.SS2.p4.6.m3.4.4.2.2.cmml" xref="S3.SS2.p4.6.m3.4.4.2.2">𝑗</ci></list></apply><apply id="S3.SS2.p4.6.m3.7.7.1.1.1.1.cmml" xref="S3.SS2.p4.6.m3.7.7.1.1.1"><plus id="S3.SS2.p4.6.m3.7.7.1.1.1.1.1.cmml" xref="S3.SS2.p4.6.m3.7.7.1.1.1.1.1"></plus><apply id="S3.SS2.p4.6.m3.7.7.1.1.1.1.2.cmml" xref="S3.SS2.p4.6.m3.7.7.1.1.1.1.2"><apply id="S3.SS2.p4.6.m3.7.7.1.1.1.1.2.1.cmml" xref="S3.SS2.p4.6.m3.7.7.1.1.1.1.2.1"><csymbol cd="ambiguous" id="S3.SS2.p4.6.m3.7.7.1.1.1.1.2.1.1.cmml" xref="S3.SS2.p4.6.m3.7.7.1.1.1.1.2.1">subscript</csymbol><sum id="S3.SS2.p4.6.m3.7.7.1.1.1.1.2.1.2.cmml" xref="S3.SS2.p4.6.m3.7.7.1.1.1.1.2.1.2"></sum><ci id="S3.SS2.p4.6.m3.7.7.1.1.1.1.2.1.3.cmml" xref="S3.SS2.p4.6.m3.7.7.1.1.1.1.2.1.3">𝑖</ci></apply><apply id="S3.SS2.p4.6.m3.7.7.1.1.1.1.2.2.cmml" xref="S3.SS2.p4.6.m3.7.7.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.p4.6.m3.7.7.1.1.1.1.2.2.1.cmml" xref="S3.SS2.p4.6.m3.7.7.1.1.1.1.2.2">subscript</csymbol><ci id="S3.SS2.p4.6.m3.7.7.1.1.1.1.2.2.2.cmml" xref="S3.SS2.p4.6.m3.7.7.1.1.1.1.2.2.2">𝑚</ci><list id="S3.SS2.p4.6.m3.6.6.2.3.cmml" xref="S3.SS2.p4.6.m3.6.6.2.4"><ci id="S3.SS2.p4.6.m3.5.5.1.1.cmml" xref="S3.SS2.p4.6.m3.5.5.1.1">𝑖</ci><ci id="S3.SS2.p4.6.m3.6.6.2.2.cmml" xref="S3.SS2.p4.6.m3.6.6.2.2">𝑗</ci></list></apply></apply><ci id="S3.SS2.p4.6.m3.7.7.1.1.1.1.3.cmml" xref="S3.SS2.p4.6.m3.7.7.1.1.1.1.3">𝜀</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.6.m3.7c">w_{i,j}=m_{i,j}/(\sum_{i}m_{i,j}+\varepsilon)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.6.m3.7d">italic_w start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT = italic_m start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT / ( ∑ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_m start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT + italic_ε )</annotation></semantics></math>
where <math id="S3.SS2.p4.7.m4.1" class="ltx_Math" alttext="\varepsilon&gt;0" display="inline"><semantics id="S3.SS2.p4.7.m4.1a"><mrow id="S3.SS2.p4.7.m4.1.1" xref="S3.SS2.p4.7.m4.1.1.cmml"><mi id="S3.SS2.p4.7.m4.1.1.2" xref="S3.SS2.p4.7.m4.1.1.2.cmml">ε</mi><mo id="S3.SS2.p4.7.m4.1.1.1" xref="S3.SS2.p4.7.m4.1.1.1.cmml">&gt;</mo><mn id="S3.SS2.p4.7.m4.1.1.3" xref="S3.SS2.p4.7.m4.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.7.m4.1b"><apply id="S3.SS2.p4.7.m4.1.1.cmml" xref="S3.SS2.p4.7.m4.1.1"><gt id="S3.SS2.p4.7.m4.1.1.1.cmml" xref="S3.SS2.p4.7.m4.1.1.1"></gt><ci id="S3.SS2.p4.7.m4.1.1.2.cmml" xref="S3.SS2.p4.7.m4.1.1.2">𝜀</ci><cn type="integer" id="S3.SS2.p4.7.m4.1.1.3.cmml" xref="S3.SS2.p4.7.m4.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.7.m4.1c">\varepsilon&gt;0</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.7.m4.1d">italic_ε &gt; 0</annotation></semantics></math> allows for <math id="S3.SS2.p4.8.m5.2" class="ltx_Math" alttext="\sum_{i}w_{i,j}=0" display="inline"><semantics id="S3.SS2.p4.8.m5.2a"><mrow id="S3.SS2.p4.8.m5.2.3" xref="S3.SS2.p4.8.m5.2.3.cmml"><mrow id="S3.SS2.p4.8.m5.2.3.2" xref="S3.SS2.p4.8.m5.2.3.2.cmml"><msub id="S3.SS2.p4.8.m5.2.3.2.1" xref="S3.SS2.p4.8.m5.2.3.2.1.cmml"><mo largeop="true" symmetric="true" id="S3.SS2.p4.8.m5.2.3.2.1.2" xref="S3.SS2.p4.8.m5.2.3.2.1.2.cmml">∑</mo><mi id="S3.SS2.p4.8.m5.2.3.2.1.3" xref="S3.SS2.p4.8.m5.2.3.2.1.3.cmml">i</mi></msub><msub id="S3.SS2.p4.8.m5.2.3.2.2" xref="S3.SS2.p4.8.m5.2.3.2.2.cmml"><mi id="S3.SS2.p4.8.m5.2.3.2.2.2" xref="S3.SS2.p4.8.m5.2.3.2.2.2.cmml">w</mi><mrow id="S3.SS2.p4.8.m5.2.2.2.4" xref="S3.SS2.p4.8.m5.2.2.2.3.cmml"><mi id="S3.SS2.p4.8.m5.1.1.1.1" xref="S3.SS2.p4.8.m5.1.1.1.1.cmml">i</mi><mo id="S3.SS2.p4.8.m5.2.2.2.4.1" xref="S3.SS2.p4.8.m5.2.2.2.3.cmml">,</mo><mi id="S3.SS2.p4.8.m5.2.2.2.2" xref="S3.SS2.p4.8.m5.2.2.2.2.cmml">j</mi></mrow></msub></mrow><mo id="S3.SS2.p4.8.m5.2.3.1" xref="S3.SS2.p4.8.m5.2.3.1.cmml">=</mo><mn id="S3.SS2.p4.8.m5.2.3.3" xref="S3.SS2.p4.8.m5.2.3.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.8.m5.2b"><apply id="S3.SS2.p4.8.m5.2.3.cmml" xref="S3.SS2.p4.8.m5.2.3"><eq id="S3.SS2.p4.8.m5.2.3.1.cmml" xref="S3.SS2.p4.8.m5.2.3.1"></eq><apply id="S3.SS2.p4.8.m5.2.3.2.cmml" xref="S3.SS2.p4.8.m5.2.3.2"><apply id="S3.SS2.p4.8.m5.2.3.2.1.cmml" xref="S3.SS2.p4.8.m5.2.3.2.1"><csymbol cd="ambiguous" id="S3.SS2.p4.8.m5.2.3.2.1.1.cmml" xref="S3.SS2.p4.8.m5.2.3.2.1">subscript</csymbol><sum id="S3.SS2.p4.8.m5.2.3.2.1.2.cmml" xref="S3.SS2.p4.8.m5.2.3.2.1.2"></sum><ci id="S3.SS2.p4.8.m5.2.3.2.1.3.cmml" xref="S3.SS2.p4.8.m5.2.3.2.1.3">𝑖</ci></apply><apply id="S3.SS2.p4.8.m5.2.3.2.2.cmml" xref="S3.SS2.p4.8.m5.2.3.2.2"><csymbol cd="ambiguous" id="S3.SS2.p4.8.m5.2.3.2.2.1.cmml" xref="S3.SS2.p4.8.m5.2.3.2.2">subscript</csymbol><ci id="S3.SS2.p4.8.m5.2.3.2.2.2.cmml" xref="S3.SS2.p4.8.m5.2.3.2.2.2">𝑤</ci><list id="S3.SS2.p4.8.m5.2.2.2.3.cmml" xref="S3.SS2.p4.8.m5.2.2.2.4"><ci id="S3.SS2.p4.8.m5.1.1.1.1.cmml" xref="S3.SS2.p4.8.m5.1.1.1.1">𝑖</ci><ci id="S3.SS2.p4.8.m5.2.2.2.2.cmml" xref="S3.SS2.p4.8.m5.2.2.2.2">𝑗</ci></list></apply></apply><cn type="integer" id="S3.SS2.p4.8.m5.2.3.3.cmml" xref="S3.SS2.p4.8.m5.2.3.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.8.m5.2c">\sum_{i}w_{i,j}=0</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.8.m5.2d">∑ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_w start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT = 0</annotation></semantics></math> when mask scores are below
a threshold. GAP is a particular case of GWP where <math id="S3.SS2.p4.9.m6.2" class="ltx_Math" alttext="m_{i,j}=1" display="inline"><semantics id="S3.SS2.p4.9.m6.2a"><mrow id="S3.SS2.p4.9.m6.2.3" xref="S3.SS2.p4.9.m6.2.3.cmml"><msub id="S3.SS2.p4.9.m6.2.3.2" xref="S3.SS2.p4.9.m6.2.3.2.cmml"><mi id="S3.SS2.p4.9.m6.2.3.2.2" xref="S3.SS2.p4.9.m6.2.3.2.2.cmml">m</mi><mrow id="S3.SS2.p4.9.m6.2.2.2.4" xref="S3.SS2.p4.9.m6.2.2.2.3.cmml"><mi id="S3.SS2.p4.9.m6.1.1.1.1" xref="S3.SS2.p4.9.m6.1.1.1.1.cmml">i</mi><mo id="S3.SS2.p4.9.m6.2.2.2.4.1" xref="S3.SS2.p4.9.m6.2.2.2.3.cmml">,</mo><mi id="S3.SS2.p4.9.m6.2.2.2.2" xref="S3.SS2.p4.9.m6.2.2.2.2.cmml">j</mi></mrow></msub><mo id="S3.SS2.p4.9.m6.2.3.1" xref="S3.SS2.p4.9.m6.2.3.1.cmml">=</mo><mn id="S3.SS2.p4.9.m6.2.3.3" xref="S3.SS2.p4.9.m6.2.3.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.9.m6.2b"><apply id="S3.SS2.p4.9.m6.2.3.cmml" xref="S3.SS2.p4.9.m6.2.3"><eq id="S3.SS2.p4.9.m6.2.3.1.cmml" xref="S3.SS2.p4.9.m6.2.3.1"></eq><apply id="S3.SS2.p4.9.m6.2.3.2.cmml" xref="S3.SS2.p4.9.m6.2.3.2"><csymbol cd="ambiguous" id="S3.SS2.p4.9.m6.2.3.2.1.cmml" xref="S3.SS2.p4.9.m6.2.3.2">subscript</csymbol><ci id="S3.SS2.p4.9.m6.2.3.2.2.cmml" xref="S3.SS2.p4.9.m6.2.3.2.2">𝑚</ci><list id="S3.SS2.p4.9.m6.2.2.2.3.cmml" xref="S3.SS2.p4.9.m6.2.2.2.4"><ci id="S3.SS2.p4.9.m6.1.1.1.1.cmml" xref="S3.SS2.p4.9.m6.1.1.1.1">𝑖</ci><ci id="S3.SS2.p4.9.m6.2.2.2.2.cmml" xref="S3.SS2.p4.9.m6.2.2.2.2">𝑗</ci></list></apply><cn type="integer" id="S3.SS2.p4.9.m6.2.3.3.cmml" xref="S3.SS2.p4.9.m6.2.3.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.9.m6.2c">m_{i,j}=1</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.9.m6.2d">italic_m start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT = 1</annotation></semantics></math> for all <math id="S3.SS2.p4.10.m7.2" class="ltx_Math" alttext="i,j" display="inline"><semantics id="S3.SS2.p4.10.m7.2a"><mrow id="S3.SS2.p4.10.m7.2.3.2" xref="S3.SS2.p4.10.m7.2.3.1.cmml"><mi id="S3.SS2.p4.10.m7.1.1" xref="S3.SS2.p4.10.m7.1.1.cmml">i</mi><mo id="S3.SS2.p4.10.m7.2.3.2.1" xref="S3.SS2.p4.10.m7.2.3.1.cmml">,</mo><mi id="S3.SS2.p4.10.m7.2.2" xref="S3.SS2.p4.10.m7.2.2.cmml">j</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.10.m7.2b"><list id="S3.SS2.p4.10.m7.2.3.1.cmml" xref="S3.SS2.p4.10.m7.2.3.2"><ci id="S3.SS2.p4.10.m7.1.1.cmml" xref="S3.SS2.p4.10.m7.1.1">𝑖</ci><ci id="S3.SS2.p4.10.m7.2.2.cmml" xref="S3.SS2.p4.10.m7.2.2">𝑗</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.10.m7.2c">i,j</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.10.m7.2d">italic_i , italic_j</annotation></semantics></math> and
<math id="S3.SS2.p4.11.m8.1" class="ltx_Math" alttext="\varepsilon=0" display="inline"><semantics id="S3.SS2.p4.11.m8.1a"><mrow id="S3.SS2.p4.11.m8.1.1" xref="S3.SS2.p4.11.m8.1.1.cmml"><mi id="S3.SS2.p4.11.m8.1.1.2" xref="S3.SS2.p4.11.m8.1.1.2.cmml">ε</mi><mo id="S3.SS2.p4.11.m8.1.1.1" xref="S3.SS2.p4.11.m8.1.1.1.cmml">=</mo><mn id="S3.SS2.p4.11.m8.1.1.3" xref="S3.SS2.p4.11.m8.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.11.m8.1b"><apply id="S3.SS2.p4.11.m8.1.1.cmml" xref="S3.SS2.p4.11.m8.1.1"><eq id="S3.SS2.p4.11.m8.1.1.1.cmml" xref="S3.SS2.p4.11.m8.1.1.1"></eq><ci id="S3.SS2.p4.11.m8.1.1.2.cmml" xref="S3.SS2.p4.11.m8.1.1.2">𝜀</ci><cn type="integer" id="S3.SS2.p4.11.m8.1.1.3.cmml" xref="S3.SS2.p4.11.m8.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.11.m8.1c">\varepsilon=0</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.11.m8.1d">italic_ε = 0</annotation></semantics></math>.
We next describe two methods to compute masks <math id="S3.SS2.p4.12.m9.1" class="ltx_Math" alttext="\mathbf{M}" display="inline"><semantics id="S3.SS2.p4.12.m9.1a"><mi id="S3.SS2.p4.12.m9.1.1" xref="S3.SS2.p4.12.m9.1.1.cmml">𝐌</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.12.m9.1b"><ci id="S3.SS2.p4.12.m9.1.1.cmml" xref="S3.SS2.p4.12.m9.1.1">𝐌</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.12.m9.1c">\mathbf{M}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.12.m9.1d">bold_M</annotation></semantics></math> from the similarity matrix <math id="S3.SS2.p4.13.m10.1" class="ltx_Math" alttext="\mathbf{S}" display="inline"><semantics id="S3.SS2.p4.13.m10.1a"><mi id="S3.SS2.p4.13.m10.1.1" xref="S3.SS2.p4.13.m10.1.1.cmml">𝐒</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.13.m10.1b"><ci id="S3.SS2.p4.13.m10.1.1.cmml" xref="S3.SS2.p4.13.m10.1.1">𝐒</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.13.m10.1c">\mathbf{S}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.13.m10.1d">bold_S</annotation></semantics></math>.
<br class="ltx_break"></p>
</div>
<div id="S3.SS2.p5" class="ltx_para ltx_noindent">
<p id="S3.SS2.p5.2" class="ltx_p"><span id="S3.SS2.p5.2.1" class="ltx_text ltx_font_bold">Masks by single-label patch assignment
(SPA) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>.</span> We aim at assigning patches to the relevant referring
expression. To do so, we apply a softmax operation over all referring
expressions <math id="S3.SS2.p5.1.m1.3" class="ltx_Math" alttext="(\mathbf{y}_{1},...,\mathbf{y}_{L})" display="inline"><semantics id="S3.SS2.p5.1.m1.3a"><mrow id="S3.SS2.p5.1.m1.3.3.2" xref="S3.SS2.p5.1.m1.3.3.3.cmml"><mo stretchy="false" id="S3.SS2.p5.1.m1.3.3.2.3" xref="S3.SS2.p5.1.m1.3.3.3.cmml">(</mo><msub id="S3.SS2.p5.1.m1.2.2.1.1" xref="S3.SS2.p5.1.m1.2.2.1.1.cmml"><mi id="S3.SS2.p5.1.m1.2.2.1.1.2" xref="S3.SS2.p5.1.m1.2.2.1.1.2.cmml">𝐲</mi><mn id="S3.SS2.p5.1.m1.2.2.1.1.3" xref="S3.SS2.p5.1.m1.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.SS2.p5.1.m1.3.3.2.4" xref="S3.SS2.p5.1.m1.3.3.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.p5.1.m1.1.1" xref="S3.SS2.p5.1.m1.1.1.cmml">…</mi><mo id="S3.SS2.p5.1.m1.3.3.2.5" xref="S3.SS2.p5.1.m1.3.3.3.cmml">,</mo><msub id="S3.SS2.p5.1.m1.3.3.2.2" xref="S3.SS2.p5.1.m1.3.3.2.2.cmml"><mi id="S3.SS2.p5.1.m1.3.3.2.2.2" xref="S3.SS2.p5.1.m1.3.3.2.2.2.cmml">𝐲</mi><mi id="S3.SS2.p5.1.m1.3.3.2.2.3" xref="S3.SS2.p5.1.m1.3.3.2.2.3.cmml">L</mi></msub><mo stretchy="false" id="S3.SS2.p5.1.m1.3.3.2.6" xref="S3.SS2.p5.1.m1.3.3.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.1.m1.3b"><vector id="S3.SS2.p5.1.m1.3.3.3.cmml" xref="S3.SS2.p5.1.m1.3.3.2"><apply id="S3.SS2.p5.1.m1.2.2.1.1.cmml" xref="S3.SS2.p5.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p5.1.m1.2.2.1.1.1.cmml" xref="S3.SS2.p5.1.m1.2.2.1.1">subscript</csymbol><ci id="S3.SS2.p5.1.m1.2.2.1.1.2.cmml" xref="S3.SS2.p5.1.m1.2.2.1.1.2">𝐲</ci><cn type="integer" id="S3.SS2.p5.1.m1.2.2.1.1.3.cmml" xref="S3.SS2.p5.1.m1.2.2.1.1.3">1</cn></apply><ci id="S3.SS2.p5.1.m1.1.1.cmml" xref="S3.SS2.p5.1.m1.1.1">…</ci><apply id="S3.SS2.p5.1.m1.3.3.2.2.cmml" xref="S3.SS2.p5.1.m1.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS2.p5.1.m1.3.3.2.2.1.cmml" xref="S3.SS2.p5.1.m1.3.3.2.2">subscript</csymbol><ci id="S3.SS2.p5.1.m1.3.3.2.2.2.cmml" xref="S3.SS2.p5.1.m1.3.3.2.2.2">𝐲</ci><ci id="S3.SS2.p5.1.m1.3.3.2.2.3.cmml" xref="S3.SS2.p5.1.m1.3.3.2.2.3">𝐿</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.1.m1.3c">(\mathbf{y}_{1},...,\mathbf{y}_{L})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p5.1.m1.3d">( bold_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , bold_y start_POSTSUBSCRIPT italic_L end_POSTSUBSCRIPT )</annotation></semantics></math> for each patch <math id="S3.SS2.p5.2.m2.1" class="ltx_Math" alttext="\mathbf{x}_{i}" display="inline"><semantics id="S3.SS2.p5.2.m2.1a"><msub id="S3.SS2.p5.2.m2.1.1" xref="S3.SS2.p5.2.m2.1.1.cmml"><mi id="S3.SS2.p5.2.m2.1.1.2" xref="S3.SS2.p5.2.m2.1.1.2.cmml">𝐱</mi><mi id="S3.SS2.p5.2.m2.1.1.3" xref="S3.SS2.p5.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.2.m2.1b"><apply id="S3.SS2.p5.2.m2.1.1.cmml" xref="S3.SS2.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p5.2.m2.1.1.1.cmml" xref="S3.SS2.p5.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p5.2.m2.1.1.2.cmml" xref="S3.SS2.p5.2.m2.1.1.2">𝐱</ci><ci id="S3.SS2.p5.2.m2.1.1.3.cmml" xref="S3.SS2.p5.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.2.m2.1c">\mathbf{x}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p5.2.m2.1d">bold_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>:</p>
<table id="S3.E5" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E5.m1.7" class="ltx_Math" alttext="m_{i,j}^{SPA}=\frac{e^{s_{i,j}}}{e^{s_{bg}}+\sum_{j=1}^{L}e^{s_{i,j}}}." display="block"><semantics id="S3.E5.m1.7a"><mrow id="S3.E5.m1.7.7.1" xref="S3.E5.m1.7.7.1.1.cmml"><mrow id="S3.E5.m1.7.7.1.1" xref="S3.E5.m1.7.7.1.1.cmml"><msubsup id="S3.E5.m1.7.7.1.1.2" xref="S3.E5.m1.7.7.1.1.2.cmml"><mi id="S3.E5.m1.7.7.1.1.2.2.2" xref="S3.E5.m1.7.7.1.1.2.2.2.cmml">m</mi><mrow id="S3.E5.m1.2.2.2.4" xref="S3.E5.m1.2.2.2.3.cmml"><mi id="S3.E5.m1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.cmml">i</mi><mo id="S3.E5.m1.2.2.2.4.1" xref="S3.E5.m1.2.2.2.3.cmml">,</mo><mi id="S3.E5.m1.2.2.2.2" xref="S3.E5.m1.2.2.2.2.cmml">j</mi></mrow><mrow id="S3.E5.m1.7.7.1.1.2.3" xref="S3.E5.m1.7.7.1.1.2.3.cmml"><mi id="S3.E5.m1.7.7.1.1.2.3.2" xref="S3.E5.m1.7.7.1.1.2.3.2.cmml">S</mi><mo id="S3.E5.m1.7.7.1.1.2.3.1" xref="S3.E5.m1.7.7.1.1.2.3.1.cmml">⁢</mo><mi id="S3.E5.m1.7.7.1.1.2.3.3" xref="S3.E5.m1.7.7.1.1.2.3.3.cmml">P</mi><mo id="S3.E5.m1.7.7.1.1.2.3.1a" xref="S3.E5.m1.7.7.1.1.2.3.1.cmml">⁢</mo><mi id="S3.E5.m1.7.7.1.1.2.3.4" xref="S3.E5.m1.7.7.1.1.2.3.4.cmml">A</mi></mrow></msubsup><mo id="S3.E5.m1.7.7.1.1.1" xref="S3.E5.m1.7.7.1.1.1.cmml">=</mo><mfrac id="S3.E5.m1.6.6" xref="S3.E5.m1.6.6.cmml"><msup id="S3.E5.m1.4.4.2" xref="S3.E5.m1.4.4.2.cmml"><mi id="S3.E5.m1.4.4.2.4" xref="S3.E5.m1.4.4.2.4.cmml">e</mi><msub id="S3.E5.m1.4.4.2.2.2" xref="S3.E5.m1.4.4.2.2.2.cmml"><mi id="S3.E5.m1.4.4.2.2.2.4" xref="S3.E5.m1.4.4.2.2.2.4.cmml">s</mi><mrow id="S3.E5.m1.4.4.2.2.2.2.2.4" xref="S3.E5.m1.4.4.2.2.2.2.2.3.cmml"><mi id="S3.E5.m1.3.3.1.1.1.1.1.1" xref="S3.E5.m1.3.3.1.1.1.1.1.1.cmml">i</mi><mo id="S3.E5.m1.4.4.2.2.2.2.2.4.1" xref="S3.E5.m1.4.4.2.2.2.2.2.3.cmml">,</mo><mi id="S3.E5.m1.4.4.2.2.2.2.2.2" xref="S3.E5.m1.4.4.2.2.2.2.2.2.cmml">j</mi></mrow></msub></msup><mrow id="S3.E5.m1.6.6.4" xref="S3.E5.m1.6.6.4.cmml"><msup id="S3.E5.m1.6.6.4.4" xref="S3.E5.m1.6.6.4.4.cmml"><mi id="S3.E5.m1.6.6.4.4.2" xref="S3.E5.m1.6.6.4.4.2.cmml">e</mi><msub id="S3.E5.m1.6.6.4.4.3" xref="S3.E5.m1.6.6.4.4.3.cmml"><mi id="S3.E5.m1.6.6.4.4.3.2" xref="S3.E5.m1.6.6.4.4.3.2.cmml">s</mi><mrow id="S3.E5.m1.6.6.4.4.3.3" xref="S3.E5.m1.6.6.4.4.3.3.cmml"><mi id="S3.E5.m1.6.6.4.4.3.3.2" xref="S3.E5.m1.6.6.4.4.3.3.2.cmml">b</mi><mo id="S3.E5.m1.6.6.4.4.3.3.1" xref="S3.E5.m1.6.6.4.4.3.3.1.cmml">⁢</mo><mi id="S3.E5.m1.6.6.4.4.3.3.3" xref="S3.E5.m1.6.6.4.4.3.3.3.cmml">g</mi></mrow></msub></msup><mo id="S3.E5.m1.6.6.4.3" xref="S3.E5.m1.6.6.4.3.cmml">+</mo><mrow id="S3.E5.m1.6.6.4.5" xref="S3.E5.m1.6.6.4.5.cmml"><msubsup id="S3.E5.m1.6.6.4.5.1" xref="S3.E5.m1.6.6.4.5.1.cmml"><mo largeop="true" symmetric="true" id="S3.E5.m1.6.6.4.5.1.2.2" xref="S3.E5.m1.6.6.4.5.1.2.2.cmml">∑</mo><mrow id="S3.E5.m1.6.6.4.5.1.2.3" xref="S3.E5.m1.6.6.4.5.1.2.3.cmml"><mi id="S3.E5.m1.6.6.4.5.1.2.3.2" xref="S3.E5.m1.6.6.4.5.1.2.3.2.cmml">j</mi><mo id="S3.E5.m1.6.6.4.5.1.2.3.1" xref="S3.E5.m1.6.6.4.5.1.2.3.1.cmml">=</mo><mn id="S3.E5.m1.6.6.4.5.1.2.3.3" xref="S3.E5.m1.6.6.4.5.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E5.m1.6.6.4.5.1.3" xref="S3.E5.m1.6.6.4.5.1.3.cmml">L</mi></msubsup><msup id="S3.E5.m1.6.6.4.5.2" xref="S3.E5.m1.6.6.4.5.2.cmml"><mi id="S3.E5.m1.6.6.4.5.2.2" xref="S3.E5.m1.6.6.4.5.2.2.cmml">e</mi><msub id="S3.E5.m1.6.6.4.2.2" xref="S3.E5.m1.6.6.4.2.2.cmml"><mi id="S3.E5.m1.6.6.4.2.2.4" xref="S3.E5.m1.6.6.4.2.2.4.cmml">s</mi><mrow id="S3.E5.m1.6.6.4.2.2.2.2.4" xref="S3.E5.m1.6.6.4.2.2.2.2.3.cmml"><mi id="S3.E5.m1.5.5.3.1.1.1.1.1" xref="S3.E5.m1.5.5.3.1.1.1.1.1.cmml">i</mi><mo id="S3.E5.m1.6.6.4.2.2.2.2.4.1" xref="S3.E5.m1.6.6.4.2.2.2.2.3.cmml">,</mo><mi id="S3.E5.m1.6.6.4.2.2.2.2.2" xref="S3.E5.m1.6.6.4.2.2.2.2.2.cmml">j</mi></mrow></msub></msup></mrow></mrow></mfrac></mrow><mo id="S3.E5.m1.7.7.1.2" xref="S3.E5.m1.7.7.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.7b"><apply id="S3.E5.m1.7.7.1.1.cmml" xref="S3.E5.m1.7.7.1"><eq id="S3.E5.m1.7.7.1.1.1.cmml" xref="S3.E5.m1.7.7.1.1.1"></eq><apply id="S3.E5.m1.7.7.1.1.2.cmml" xref="S3.E5.m1.7.7.1.1.2"><csymbol cd="ambiguous" id="S3.E5.m1.7.7.1.1.2.1.cmml" xref="S3.E5.m1.7.7.1.1.2">superscript</csymbol><apply id="S3.E5.m1.7.7.1.1.2.2.cmml" xref="S3.E5.m1.7.7.1.1.2"><csymbol cd="ambiguous" id="S3.E5.m1.7.7.1.1.2.2.1.cmml" xref="S3.E5.m1.7.7.1.1.2">subscript</csymbol><ci id="S3.E5.m1.7.7.1.1.2.2.2.cmml" xref="S3.E5.m1.7.7.1.1.2.2.2">𝑚</ci><list id="S3.E5.m1.2.2.2.3.cmml" xref="S3.E5.m1.2.2.2.4"><ci id="S3.E5.m1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1">𝑖</ci><ci id="S3.E5.m1.2.2.2.2.cmml" xref="S3.E5.m1.2.2.2.2">𝑗</ci></list></apply><apply id="S3.E5.m1.7.7.1.1.2.3.cmml" xref="S3.E5.m1.7.7.1.1.2.3"><times id="S3.E5.m1.7.7.1.1.2.3.1.cmml" xref="S3.E5.m1.7.7.1.1.2.3.1"></times><ci id="S3.E5.m1.7.7.1.1.2.3.2.cmml" xref="S3.E5.m1.7.7.1.1.2.3.2">𝑆</ci><ci id="S3.E5.m1.7.7.1.1.2.3.3.cmml" xref="S3.E5.m1.7.7.1.1.2.3.3">𝑃</ci><ci id="S3.E5.m1.7.7.1.1.2.3.4.cmml" xref="S3.E5.m1.7.7.1.1.2.3.4">𝐴</ci></apply></apply><apply id="S3.E5.m1.6.6.cmml" xref="S3.E5.m1.6.6"><divide id="S3.E5.m1.6.6.5.cmml" xref="S3.E5.m1.6.6"></divide><apply id="S3.E5.m1.4.4.2.cmml" xref="S3.E5.m1.4.4.2"><csymbol cd="ambiguous" id="S3.E5.m1.4.4.2.3.cmml" xref="S3.E5.m1.4.4.2">superscript</csymbol><ci id="S3.E5.m1.4.4.2.4.cmml" xref="S3.E5.m1.4.4.2.4">𝑒</ci><apply id="S3.E5.m1.4.4.2.2.2.cmml" xref="S3.E5.m1.4.4.2.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.4.4.2.2.2.3.cmml" xref="S3.E5.m1.4.4.2.2.2">subscript</csymbol><ci id="S3.E5.m1.4.4.2.2.2.4.cmml" xref="S3.E5.m1.4.4.2.2.2.4">𝑠</ci><list id="S3.E5.m1.4.4.2.2.2.2.2.3.cmml" xref="S3.E5.m1.4.4.2.2.2.2.2.4"><ci id="S3.E5.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.1">𝑖</ci><ci id="S3.E5.m1.4.4.2.2.2.2.2.2.cmml" xref="S3.E5.m1.4.4.2.2.2.2.2.2">𝑗</ci></list></apply></apply><apply id="S3.E5.m1.6.6.4.cmml" xref="S3.E5.m1.6.6.4"><plus id="S3.E5.m1.6.6.4.3.cmml" xref="S3.E5.m1.6.6.4.3"></plus><apply id="S3.E5.m1.6.6.4.4.cmml" xref="S3.E5.m1.6.6.4.4"><csymbol cd="ambiguous" id="S3.E5.m1.6.6.4.4.1.cmml" xref="S3.E5.m1.6.6.4.4">superscript</csymbol><ci id="S3.E5.m1.6.6.4.4.2.cmml" xref="S3.E5.m1.6.6.4.4.2">𝑒</ci><apply id="S3.E5.m1.6.6.4.4.3.cmml" xref="S3.E5.m1.6.6.4.4.3"><csymbol cd="ambiguous" id="S3.E5.m1.6.6.4.4.3.1.cmml" xref="S3.E5.m1.6.6.4.4.3">subscript</csymbol><ci id="S3.E5.m1.6.6.4.4.3.2.cmml" xref="S3.E5.m1.6.6.4.4.3.2">𝑠</ci><apply id="S3.E5.m1.6.6.4.4.3.3.cmml" xref="S3.E5.m1.6.6.4.4.3.3"><times id="S3.E5.m1.6.6.4.4.3.3.1.cmml" xref="S3.E5.m1.6.6.4.4.3.3.1"></times><ci id="S3.E5.m1.6.6.4.4.3.3.2.cmml" xref="S3.E5.m1.6.6.4.4.3.3.2">𝑏</ci><ci id="S3.E5.m1.6.6.4.4.3.3.3.cmml" xref="S3.E5.m1.6.6.4.4.3.3.3">𝑔</ci></apply></apply></apply><apply id="S3.E5.m1.6.6.4.5.cmml" xref="S3.E5.m1.6.6.4.5"><apply id="S3.E5.m1.6.6.4.5.1.cmml" xref="S3.E5.m1.6.6.4.5.1"><csymbol cd="ambiguous" id="S3.E5.m1.6.6.4.5.1.1.cmml" xref="S3.E5.m1.6.6.4.5.1">superscript</csymbol><apply id="S3.E5.m1.6.6.4.5.1.2.cmml" xref="S3.E5.m1.6.6.4.5.1"><csymbol cd="ambiguous" id="S3.E5.m1.6.6.4.5.1.2.1.cmml" xref="S3.E5.m1.6.6.4.5.1">subscript</csymbol><sum id="S3.E5.m1.6.6.4.5.1.2.2.cmml" xref="S3.E5.m1.6.6.4.5.1.2.2"></sum><apply id="S3.E5.m1.6.6.4.5.1.2.3.cmml" xref="S3.E5.m1.6.6.4.5.1.2.3"><eq id="S3.E5.m1.6.6.4.5.1.2.3.1.cmml" xref="S3.E5.m1.6.6.4.5.1.2.3.1"></eq><ci id="S3.E5.m1.6.6.4.5.1.2.3.2.cmml" xref="S3.E5.m1.6.6.4.5.1.2.3.2">𝑗</ci><cn type="integer" id="S3.E5.m1.6.6.4.5.1.2.3.3.cmml" xref="S3.E5.m1.6.6.4.5.1.2.3.3">1</cn></apply></apply><ci id="S3.E5.m1.6.6.4.5.1.3.cmml" xref="S3.E5.m1.6.6.4.5.1.3">𝐿</ci></apply><apply id="S3.E5.m1.6.6.4.5.2.cmml" xref="S3.E5.m1.6.6.4.5.2"><csymbol cd="ambiguous" id="S3.E5.m1.6.6.4.5.2.1.cmml" xref="S3.E5.m1.6.6.4.5.2">superscript</csymbol><ci id="S3.E5.m1.6.6.4.5.2.2.cmml" xref="S3.E5.m1.6.6.4.5.2.2">𝑒</ci><apply id="S3.E5.m1.6.6.4.2.2.cmml" xref="S3.E5.m1.6.6.4.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.6.6.4.2.2.3.cmml" xref="S3.E5.m1.6.6.4.2.2">subscript</csymbol><ci id="S3.E5.m1.6.6.4.2.2.4.cmml" xref="S3.E5.m1.6.6.4.2.2.4">𝑠</ci><list id="S3.E5.m1.6.6.4.2.2.2.2.3.cmml" xref="S3.E5.m1.6.6.4.2.2.2.2.4"><ci id="S3.E5.m1.5.5.3.1.1.1.1.1.cmml" xref="S3.E5.m1.5.5.3.1.1.1.1.1">𝑖</ci><ci id="S3.E5.m1.6.6.4.2.2.2.2.2.cmml" xref="S3.E5.m1.6.6.4.2.2.2.2.2">𝑗</ci></list></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.7c">m_{i,j}^{SPA}=\frac{e^{s_{i,j}}}{e^{s_{bg}}+\sum_{j=1}^{L}e^{s_{i,j}}}.</annotation><annotation encoding="application/x-llamapun" id="S3.E5.m1.7d">italic_m start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_S italic_P italic_A end_POSTSUPERSCRIPT = divide start_ARG italic_e start_POSTSUPERSCRIPT italic_s start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT end_POSTSUPERSCRIPT end_ARG start_ARG italic_e start_POSTSUPERSCRIPT italic_s start_POSTSUBSCRIPT italic_b italic_g end_POSTSUBSCRIPT end_POSTSUPERSCRIPT + ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_L end_POSTSUPERSCRIPT italic_e start_POSTSUPERSCRIPT italic_s start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT end_POSTSUPERSCRIPT end_ARG .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr>
</table>
<p id="S3.SS2.p5.8" class="ltx_p">We add a background column <math id="S3.SS2.p5.3.m1.3" class="ltx_Math" alttext="(s_{i,0})_{i}" display="inline"><semantics id="S3.SS2.p5.3.m1.3a"><msub id="S3.SS2.p5.3.m1.3.3" xref="S3.SS2.p5.3.m1.3.3.cmml"><mrow id="S3.SS2.p5.3.m1.3.3.1.1" xref="S3.SS2.p5.3.m1.3.3.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p5.3.m1.3.3.1.1.2" xref="S3.SS2.p5.3.m1.3.3.1.1.1.cmml">(</mo><msub id="S3.SS2.p5.3.m1.3.3.1.1.1" xref="S3.SS2.p5.3.m1.3.3.1.1.1.cmml"><mi id="S3.SS2.p5.3.m1.3.3.1.1.1.2" xref="S3.SS2.p5.3.m1.3.3.1.1.1.2.cmml">s</mi><mrow id="S3.SS2.p5.3.m1.2.2.2.4" xref="S3.SS2.p5.3.m1.2.2.2.3.cmml"><mi id="S3.SS2.p5.3.m1.1.1.1.1" xref="S3.SS2.p5.3.m1.1.1.1.1.cmml">i</mi><mo id="S3.SS2.p5.3.m1.2.2.2.4.1" xref="S3.SS2.p5.3.m1.2.2.2.3.cmml">,</mo><mn id="S3.SS2.p5.3.m1.2.2.2.2" xref="S3.SS2.p5.3.m1.2.2.2.2.cmml">0</mn></mrow></msub><mo stretchy="false" id="S3.SS2.p5.3.m1.3.3.1.1.3" xref="S3.SS2.p5.3.m1.3.3.1.1.1.cmml">)</mo></mrow><mi id="S3.SS2.p5.3.m1.3.3.3" xref="S3.SS2.p5.3.m1.3.3.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.3.m1.3b"><apply id="S3.SS2.p5.3.m1.3.3.cmml" xref="S3.SS2.p5.3.m1.3.3"><csymbol cd="ambiguous" id="S3.SS2.p5.3.m1.3.3.2.cmml" xref="S3.SS2.p5.3.m1.3.3">subscript</csymbol><apply id="S3.SS2.p5.3.m1.3.3.1.1.1.cmml" xref="S3.SS2.p5.3.m1.3.3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p5.3.m1.3.3.1.1.1.1.cmml" xref="S3.SS2.p5.3.m1.3.3.1.1">subscript</csymbol><ci id="S3.SS2.p5.3.m1.3.3.1.1.1.2.cmml" xref="S3.SS2.p5.3.m1.3.3.1.1.1.2">𝑠</ci><list id="S3.SS2.p5.3.m1.2.2.2.3.cmml" xref="S3.SS2.p5.3.m1.2.2.2.4"><ci id="S3.SS2.p5.3.m1.1.1.1.1.cmml" xref="S3.SS2.p5.3.m1.1.1.1.1">𝑖</ci><cn type="integer" id="S3.SS2.p5.3.m1.2.2.2.2.cmml" xref="S3.SS2.p5.3.m1.2.2.2.2">0</cn></list></apply><ci id="S3.SS2.p5.3.m1.3.3.3.cmml" xref="S3.SS2.p5.3.m1.3.3.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.3.m1.3c">(s_{i,0})_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p5.3.m1.3d">( italic_s start_POSTSUBSCRIPT italic_i , 0 end_POSTSUBSCRIPT ) start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and assign it a constant equal to
<math id="S3.SS2.p5.4.m2.1" class="ltx_Math" alttext="s_{bg}=0" display="inline"><semantics id="S3.SS2.p5.4.m2.1a"><mrow id="S3.SS2.p5.4.m2.1.1" xref="S3.SS2.p5.4.m2.1.1.cmml"><msub id="S3.SS2.p5.4.m2.1.1.2" xref="S3.SS2.p5.4.m2.1.1.2.cmml"><mi id="S3.SS2.p5.4.m2.1.1.2.2" xref="S3.SS2.p5.4.m2.1.1.2.2.cmml">s</mi><mrow id="S3.SS2.p5.4.m2.1.1.2.3" xref="S3.SS2.p5.4.m2.1.1.2.3.cmml"><mi id="S3.SS2.p5.4.m2.1.1.2.3.2" xref="S3.SS2.p5.4.m2.1.1.2.3.2.cmml">b</mi><mo id="S3.SS2.p5.4.m2.1.1.2.3.1" xref="S3.SS2.p5.4.m2.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p5.4.m2.1.1.2.3.3" xref="S3.SS2.p5.4.m2.1.1.2.3.3.cmml">g</mi></mrow></msub><mo id="S3.SS2.p5.4.m2.1.1.1" xref="S3.SS2.p5.4.m2.1.1.1.cmml">=</mo><mn id="S3.SS2.p5.4.m2.1.1.3" xref="S3.SS2.p5.4.m2.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.4.m2.1b"><apply id="S3.SS2.p5.4.m2.1.1.cmml" xref="S3.SS2.p5.4.m2.1.1"><eq id="S3.SS2.p5.4.m2.1.1.1.cmml" xref="S3.SS2.p5.4.m2.1.1.1"></eq><apply id="S3.SS2.p5.4.m2.1.1.2.cmml" xref="S3.SS2.p5.4.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p5.4.m2.1.1.2.1.cmml" xref="S3.SS2.p5.4.m2.1.1.2">subscript</csymbol><ci id="S3.SS2.p5.4.m2.1.1.2.2.cmml" xref="S3.SS2.p5.4.m2.1.1.2.2">𝑠</ci><apply id="S3.SS2.p5.4.m2.1.1.2.3.cmml" xref="S3.SS2.p5.4.m2.1.1.2.3"><times id="S3.SS2.p5.4.m2.1.1.2.3.1.cmml" xref="S3.SS2.p5.4.m2.1.1.2.3.1"></times><ci id="S3.SS2.p5.4.m2.1.1.2.3.2.cmml" xref="S3.SS2.p5.4.m2.1.1.2.3.2">𝑏</ci><ci id="S3.SS2.p5.4.m2.1.1.2.3.3.cmml" xref="S3.SS2.p5.4.m2.1.1.2.3.3">𝑔</ci></apply></apply><cn type="integer" id="S3.SS2.p5.4.m2.1.1.3.cmml" xref="S3.SS2.p5.4.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.4.m2.1c">s_{bg}=0</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p5.4.m2.1d">italic_s start_POSTSUBSCRIPT italic_b italic_g end_POSTSUBSCRIPT = 0</annotation></semantics></math> for all patches <math id="S3.SS2.p5.5.m3.1" class="ltx_Math" alttext="\mathbf{x}_{i}" display="inline"><semantics id="S3.SS2.p5.5.m3.1a"><msub id="S3.SS2.p5.5.m3.1.1" xref="S3.SS2.p5.5.m3.1.1.cmml"><mi id="S3.SS2.p5.5.m3.1.1.2" xref="S3.SS2.p5.5.m3.1.1.2.cmml">𝐱</mi><mi id="S3.SS2.p5.5.m3.1.1.3" xref="S3.SS2.p5.5.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.5.m3.1b"><apply id="S3.SS2.p5.5.m3.1.1.cmml" xref="S3.SS2.p5.5.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p5.5.m3.1.1.1.cmml" xref="S3.SS2.p5.5.m3.1.1">subscript</csymbol><ci id="S3.SS2.p5.5.m3.1.1.2.cmml" xref="S3.SS2.p5.5.m3.1.1.2">𝐱</ci><ci id="S3.SS2.p5.5.m3.1.1.3.cmml" xref="S3.SS2.p5.5.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.5.m3.1c">\mathbf{x}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p5.5.m3.1d">bold_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>. This allows to assign patches with
low scores <math id="S3.SS2.p5.6.m4.2" class="ltx_Math" alttext="s_{i,j}&lt;0" display="inline"><semantics id="S3.SS2.p5.6.m4.2a"><mrow id="S3.SS2.p5.6.m4.2.3" xref="S3.SS2.p5.6.m4.2.3.cmml"><msub id="S3.SS2.p5.6.m4.2.3.2" xref="S3.SS2.p5.6.m4.2.3.2.cmml"><mi id="S3.SS2.p5.6.m4.2.3.2.2" xref="S3.SS2.p5.6.m4.2.3.2.2.cmml">s</mi><mrow id="S3.SS2.p5.6.m4.2.2.2.4" xref="S3.SS2.p5.6.m4.2.2.2.3.cmml"><mi id="S3.SS2.p5.6.m4.1.1.1.1" xref="S3.SS2.p5.6.m4.1.1.1.1.cmml">i</mi><mo id="S3.SS2.p5.6.m4.2.2.2.4.1" xref="S3.SS2.p5.6.m4.2.2.2.3.cmml">,</mo><mi id="S3.SS2.p5.6.m4.2.2.2.2" xref="S3.SS2.p5.6.m4.2.2.2.2.cmml">j</mi></mrow></msub><mo id="S3.SS2.p5.6.m4.2.3.1" xref="S3.SS2.p5.6.m4.2.3.1.cmml">&lt;</mo><mn id="S3.SS2.p5.6.m4.2.3.3" xref="S3.SS2.p5.6.m4.2.3.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.6.m4.2b"><apply id="S3.SS2.p5.6.m4.2.3.cmml" xref="S3.SS2.p5.6.m4.2.3"><lt id="S3.SS2.p5.6.m4.2.3.1.cmml" xref="S3.SS2.p5.6.m4.2.3.1"></lt><apply id="S3.SS2.p5.6.m4.2.3.2.cmml" xref="S3.SS2.p5.6.m4.2.3.2"><csymbol cd="ambiguous" id="S3.SS2.p5.6.m4.2.3.2.1.cmml" xref="S3.SS2.p5.6.m4.2.3.2">subscript</csymbol><ci id="S3.SS2.p5.6.m4.2.3.2.2.cmml" xref="S3.SS2.p5.6.m4.2.3.2.2">𝑠</ci><list id="S3.SS2.p5.6.m4.2.2.2.3.cmml" xref="S3.SS2.p5.6.m4.2.2.2.4"><ci id="S3.SS2.p5.6.m4.1.1.1.1.cmml" xref="S3.SS2.p5.6.m4.1.1.1.1">𝑖</ci><ci id="S3.SS2.p5.6.m4.2.2.2.2.cmml" xref="S3.SS2.p5.6.m4.2.2.2.2">𝑗</ci></list></apply><cn type="integer" id="S3.SS2.p5.6.m4.2.3.3.cmml" xref="S3.SS2.p5.6.m4.2.3.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.6.m4.2c">s_{i,j}&lt;0</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p5.6.m4.2d">italic_s start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT &lt; 0</annotation></semantics></math> to the background. The masks are then soft
assignments with <math id="S3.SS2.p5.7.m5.2" class="ltx_Math" alttext="\sum_{j=0}^{L}m_{i,j}=1" display="inline"><semantics id="S3.SS2.p5.7.m5.2a"><mrow id="S3.SS2.p5.7.m5.2.3" xref="S3.SS2.p5.7.m5.2.3.cmml"><mrow id="S3.SS2.p5.7.m5.2.3.2" xref="S3.SS2.p5.7.m5.2.3.2.cmml"><msubsup id="S3.SS2.p5.7.m5.2.3.2.1" xref="S3.SS2.p5.7.m5.2.3.2.1.cmml"><mo largeop="true" symmetric="true" id="S3.SS2.p5.7.m5.2.3.2.1.2.2" xref="S3.SS2.p5.7.m5.2.3.2.1.2.2.cmml">∑</mo><mrow id="S3.SS2.p5.7.m5.2.3.2.1.2.3" xref="S3.SS2.p5.7.m5.2.3.2.1.2.3.cmml"><mi id="S3.SS2.p5.7.m5.2.3.2.1.2.3.2" xref="S3.SS2.p5.7.m5.2.3.2.1.2.3.2.cmml">j</mi><mo id="S3.SS2.p5.7.m5.2.3.2.1.2.3.1" xref="S3.SS2.p5.7.m5.2.3.2.1.2.3.1.cmml">=</mo><mn id="S3.SS2.p5.7.m5.2.3.2.1.2.3.3" xref="S3.SS2.p5.7.m5.2.3.2.1.2.3.3.cmml">0</mn></mrow><mi id="S3.SS2.p5.7.m5.2.3.2.1.3" xref="S3.SS2.p5.7.m5.2.3.2.1.3.cmml">L</mi></msubsup><msub id="S3.SS2.p5.7.m5.2.3.2.2" xref="S3.SS2.p5.7.m5.2.3.2.2.cmml"><mi id="S3.SS2.p5.7.m5.2.3.2.2.2" xref="S3.SS2.p5.7.m5.2.3.2.2.2.cmml">m</mi><mrow id="S3.SS2.p5.7.m5.2.2.2.4" xref="S3.SS2.p5.7.m5.2.2.2.3.cmml"><mi id="S3.SS2.p5.7.m5.1.1.1.1" xref="S3.SS2.p5.7.m5.1.1.1.1.cmml">i</mi><mo id="S3.SS2.p5.7.m5.2.2.2.4.1" xref="S3.SS2.p5.7.m5.2.2.2.3.cmml">,</mo><mi id="S3.SS2.p5.7.m5.2.2.2.2" xref="S3.SS2.p5.7.m5.2.2.2.2.cmml">j</mi></mrow></msub></mrow><mo id="S3.SS2.p5.7.m5.2.3.1" xref="S3.SS2.p5.7.m5.2.3.1.cmml">=</mo><mn id="S3.SS2.p5.7.m5.2.3.3" xref="S3.SS2.p5.7.m5.2.3.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.7.m5.2b"><apply id="S3.SS2.p5.7.m5.2.3.cmml" xref="S3.SS2.p5.7.m5.2.3"><eq id="S3.SS2.p5.7.m5.2.3.1.cmml" xref="S3.SS2.p5.7.m5.2.3.1"></eq><apply id="S3.SS2.p5.7.m5.2.3.2.cmml" xref="S3.SS2.p5.7.m5.2.3.2"><apply id="S3.SS2.p5.7.m5.2.3.2.1.cmml" xref="S3.SS2.p5.7.m5.2.3.2.1"><csymbol cd="ambiguous" id="S3.SS2.p5.7.m5.2.3.2.1.1.cmml" xref="S3.SS2.p5.7.m5.2.3.2.1">superscript</csymbol><apply id="S3.SS2.p5.7.m5.2.3.2.1.2.cmml" xref="S3.SS2.p5.7.m5.2.3.2.1"><csymbol cd="ambiguous" id="S3.SS2.p5.7.m5.2.3.2.1.2.1.cmml" xref="S3.SS2.p5.7.m5.2.3.2.1">subscript</csymbol><sum id="S3.SS2.p5.7.m5.2.3.2.1.2.2.cmml" xref="S3.SS2.p5.7.m5.2.3.2.1.2.2"></sum><apply id="S3.SS2.p5.7.m5.2.3.2.1.2.3.cmml" xref="S3.SS2.p5.7.m5.2.3.2.1.2.3"><eq id="S3.SS2.p5.7.m5.2.3.2.1.2.3.1.cmml" xref="S3.SS2.p5.7.m5.2.3.2.1.2.3.1"></eq><ci id="S3.SS2.p5.7.m5.2.3.2.1.2.3.2.cmml" xref="S3.SS2.p5.7.m5.2.3.2.1.2.3.2">𝑗</ci><cn type="integer" id="S3.SS2.p5.7.m5.2.3.2.1.2.3.3.cmml" xref="S3.SS2.p5.7.m5.2.3.2.1.2.3.3">0</cn></apply></apply><ci id="S3.SS2.p5.7.m5.2.3.2.1.3.cmml" xref="S3.SS2.p5.7.m5.2.3.2.1.3">𝐿</ci></apply><apply id="S3.SS2.p5.7.m5.2.3.2.2.cmml" xref="S3.SS2.p5.7.m5.2.3.2.2"><csymbol cd="ambiguous" id="S3.SS2.p5.7.m5.2.3.2.2.1.cmml" xref="S3.SS2.p5.7.m5.2.3.2.2">subscript</csymbol><ci id="S3.SS2.p5.7.m5.2.3.2.2.2.cmml" xref="S3.SS2.p5.7.m5.2.3.2.2.2">𝑚</ci><list id="S3.SS2.p5.7.m5.2.2.2.3.cmml" xref="S3.SS2.p5.7.m5.2.2.2.4"><ci id="S3.SS2.p5.7.m5.1.1.1.1.cmml" xref="S3.SS2.p5.7.m5.1.1.1.1">𝑖</ci><ci id="S3.SS2.p5.7.m5.2.2.2.2.cmml" xref="S3.SS2.p5.7.m5.2.2.2.2">𝑗</ci></list></apply></apply><cn type="integer" id="S3.SS2.p5.7.m5.2.3.3.cmml" xref="S3.SS2.p5.7.m5.2.3.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.7.m5.2c">\sum_{j=0}^{L}m_{i,j}=1</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p5.7.m5.2d">∑ start_POSTSUBSCRIPT italic_j = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_L end_POSTSUPERSCRIPT italic_m start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT = 1</annotation></semantics></math> for any patch <math id="S3.SS2.p5.8.m6.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS2.p5.8.m6.1a"><mi id="S3.SS2.p5.8.m6.1.1" xref="S3.SS2.p5.8.m6.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.8.m6.1b"><ci id="S3.SS2.p5.8.m6.1.1.cmml" xref="S3.SS2.p5.8.m6.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.8.m6.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p5.8.m6.1d">italic_i</annotation></semantics></math>. This patch
assignment can be viewed as multi-class classification which is typical for
semantic segmentation where one pixel is matched to a <span id="S3.SS2.p5.8.1" class="ltx_text ltx_font_italic">single label</span> as proposed
by <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>.</p>
</div>
<div id="S3.SS2.p6" class="ltx_para">
<p id="S3.SS2.p6.1" class="ltx_p">This single-label patch assignment (SPA) is illustrated in Figure
<a href="#S3.F3" title="Figure 3 ‣ 3.2 Global Pooling Mechanisms ‣ 3 Method ‣ Weakly-supervised segmentation of referring expressions" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> center. The softmax operation over referring
expressions softly enforces the correspondence of a patch to one expression.
However, this definition is problematic for referring expression segmentation
where the masks of several expressions can overlap. We illustrate this in Figure
<a href="#S3.F3" title="Figure 3 ‣ 3.2 Global Pooling Mechanisms ‣ 3 Method ‣ Weakly-supervised segmentation of referring expressions" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> center where pixels corresponding to <span id="S3.SS2.p6.1.1" class="ltx_text ltx_font_italic">jumping man</span>
and <span id="S3.SS2.p6.1.2" class="ltx_text ltx_font_italic">legs</span> have lower mask weights on the overlapping region. Such lower mask
weights result in decreased image-level scores for both of the expressions.
<br class="ltx_break"></p>
</div>
<div id="S3.SS2.p7" class="ltx_para ltx_noindent">
<p id="S3.SS2.p7.2" class="ltx_p"><span id="S3.SS2.p7.2.1" class="ltx_text ltx_font_bold">Masks by multi-label patch assignment (MPA).</span> We propose
multi-label patch assignment (MPA) that overcomes the above limitations of SPA.
For each patch <math id="S3.SS2.p7.1.m1.1" class="ltx_Math" alttext="\mathbf{x}_{i}" display="inline"><semantics id="S3.SS2.p7.1.m1.1a"><msub id="S3.SS2.p7.1.m1.1.1" xref="S3.SS2.p7.1.m1.1.1.cmml"><mi id="S3.SS2.p7.1.m1.1.1.2" xref="S3.SS2.p7.1.m1.1.1.2.cmml">𝐱</mi><mi id="S3.SS2.p7.1.m1.1.1.3" xref="S3.SS2.p7.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p7.1.m1.1b"><apply id="S3.SS2.p7.1.m1.1.1.cmml" xref="S3.SS2.p7.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p7.1.m1.1.1.1.cmml" xref="S3.SS2.p7.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p7.1.m1.1.1.2.cmml" xref="S3.SS2.p7.1.m1.1.1.2">𝐱</ci><ci id="S3.SS2.p7.1.m1.1.1.3.cmml" xref="S3.SS2.p7.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p7.1.m1.1c">\mathbf{x}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p7.1.m1.1d">bold_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, we rely on binary classification between a
referring expression <math id="S3.SS2.p7.2.m2.1" class="ltx_Math" alttext="\mathbf{y}_{j}" display="inline"><semantics id="S3.SS2.p7.2.m2.1a"><msub id="S3.SS2.p7.2.m2.1.1" xref="S3.SS2.p7.2.m2.1.1.cmml"><mi id="S3.SS2.p7.2.m2.1.1.2" xref="S3.SS2.p7.2.m2.1.1.2.cmml">𝐲</mi><mi id="S3.SS2.p7.2.m2.1.1.3" xref="S3.SS2.p7.2.m2.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p7.2.m2.1b"><apply id="S3.SS2.p7.2.m2.1.1.cmml" xref="S3.SS2.p7.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p7.2.m2.1.1.1.cmml" xref="S3.SS2.p7.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p7.2.m2.1.1.2.cmml" xref="S3.SS2.p7.2.m2.1.1.2">𝐲</ci><ci id="S3.SS2.p7.2.m2.1.1.3.cmml" xref="S3.SS2.p7.2.m2.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p7.2.m2.1c">\mathbf{y}_{j}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p7.2.m2.1d">bold_y start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> and the background based on:</p>
</div>
<div id="S3.SS2.p8" class="ltx_para">
<table id="S3.E6" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E6.m1.7" class="ltx_Math" alttext="m_{i,j}^{MPA}=\frac{e^{s_{i,j}}}{e^{s_{bg}}+e^{s_{i,j}}}." display="block"><semantics id="S3.E6.m1.7a"><mrow id="S3.E6.m1.7.7.1" xref="S3.E6.m1.7.7.1.1.cmml"><mrow id="S3.E6.m1.7.7.1.1" xref="S3.E6.m1.7.7.1.1.cmml"><msubsup id="S3.E6.m1.7.7.1.1.2" xref="S3.E6.m1.7.7.1.1.2.cmml"><mi id="S3.E6.m1.7.7.1.1.2.2.2" xref="S3.E6.m1.7.7.1.1.2.2.2.cmml">m</mi><mrow id="S3.E6.m1.2.2.2.4" xref="S3.E6.m1.2.2.2.3.cmml"><mi id="S3.E6.m1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.cmml">i</mi><mo id="S3.E6.m1.2.2.2.4.1" xref="S3.E6.m1.2.2.2.3.cmml">,</mo><mi id="S3.E6.m1.2.2.2.2" xref="S3.E6.m1.2.2.2.2.cmml">j</mi></mrow><mrow id="S3.E6.m1.7.7.1.1.2.3" xref="S3.E6.m1.7.7.1.1.2.3.cmml"><mi id="S3.E6.m1.7.7.1.1.2.3.2" xref="S3.E6.m1.7.7.1.1.2.3.2.cmml">M</mi><mo id="S3.E6.m1.7.7.1.1.2.3.1" xref="S3.E6.m1.7.7.1.1.2.3.1.cmml">⁢</mo><mi id="S3.E6.m1.7.7.1.1.2.3.3" xref="S3.E6.m1.7.7.1.1.2.3.3.cmml">P</mi><mo id="S3.E6.m1.7.7.1.1.2.3.1a" xref="S3.E6.m1.7.7.1.1.2.3.1.cmml">⁢</mo><mi id="S3.E6.m1.7.7.1.1.2.3.4" xref="S3.E6.m1.7.7.1.1.2.3.4.cmml">A</mi></mrow></msubsup><mo id="S3.E6.m1.7.7.1.1.1" xref="S3.E6.m1.7.7.1.1.1.cmml">=</mo><mfrac id="S3.E6.m1.6.6" xref="S3.E6.m1.6.6.cmml"><msup id="S3.E6.m1.4.4.2" xref="S3.E6.m1.4.4.2.cmml"><mi id="S3.E6.m1.4.4.2.4" xref="S3.E6.m1.4.4.2.4.cmml">e</mi><msub id="S3.E6.m1.4.4.2.2.2" xref="S3.E6.m1.4.4.2.2.2.cmml"><mi id="S3.E6.m1.4.4.2.2.2.4" xref="S3.E6.m1.4.4.2.2.2.4.cmml">s</mi><mrow id="S3.E6.m1.4.4.2.2.2.2.2.4" xref="S3.E6.m1.4.4.2.2.2.2.2.3.cmml"><mi id="S3.E6.m1.3.3.1.1.1.1.1.1" xref="S3.E6.m1.3.3.1.1.1.1.1.1.cmml">i</mi><mo id="S3.E6.m1.4.4.2.2.2.2.2.4.1" xref="S3.E6.m1.4.4.2.2.2.2.2.3.cmml">,</mo><mi id="S3.E6.m1.4.4.2.2.2.2.2.2" xref="S3.E6.m1.4.4.2.2.2.2.2.2.cmml">j</mi></mrow></msub></msup><mrow id="S3.E6.m1.6.6.4" xref="S3.E6.m1.6.6.4.cmml"><msup id="S3.E6.m1.6.6.4.4" xref="S3.E6.m1.6.6.4.4.cmml"><mi id="S3.E6.m1.6.6.4.4.2" xref="S3.E6.m1.6.6.4.4.2.cmml">e</mi><msub id="S3.E6.m1.6.6.4.4.3" xref="S3.E6.m1.6.6.4.4.3.cmml"><mi id="S3.E6.m1.6.6.4.4.3.2" xref="S3.E6.m1.6.6.4.4.3.2.cmml">s</mi><mrow id="S3.E6.m1.6.6.4.4.3.3" xref="S3.E6.m1.6.6.4.4.3.3.cmml"><mi id="S3.E6.m1.6.6.4.4.3.3.2" xref="S3.E6.m1.6.6.4.4.3.3.2.cmml">b</mi><mo id="S3.E6.m1.6.6.4.4.3.3.1" xref="S3.E6.m1.6.6.4.4.3.3.1.cmml">⁢</mo><mi id="S3.E6.m1.6.6.4.4.3.3.3" xref="S3.E6.m1.6.6.4.4.3.3.3.cmml">g</mi></mrow></msub></msup><mo id="S3.E6.m1.6.6.4.3" xref="S3.E6.m1.6.6.4.3.cmml">+</mo><msup id="S3.E6.m1.6.6.4.5" xref="S3.E6.m1.6.6.4.5.cmml"><mi id="S3.E6.m1.6.6.4.5.2" xref="S3.E6.m1.6.6.4.5.2.cmml">e</mi><msub id="S3.E6.m1.6.6.4.2.2" xref="S3.E6.m1.6.6.4.2.2.cmml"><mi id="S3.E6.m1.6.6.4.2.2.4" xref="S3.E6.m1.6.6.4.2.2.4.cmml">s</mi><mrow id="S3.E6.m1.6.6.4.2.2.2.2.4" xref="S3.E6.m1.6.6.4.2.2.2.2.3.cmml"><mi id="S3.E6.m1.5.5.3.1.1.1.1.1" xref="S3.E6.m1.5.5.3.1.1.1.1.1.cmml">i</mi><mo id="S3.E6.m1.6.6.4.2.2.2.2.4.1" xref="S3.E6.m1.6.6.4.2.2.2.2.3.cmml">,</mo><mi id="S3.E6.m1.6.6.4.2.2.2.2.2" xref="S3.E6.m1.6.6.4.2.2.2.2.2.cmml">j</mi></mrow></msub></msup></mrow></mfrac></mrow><mo id="S3.E6.m1.7.7.1.2" xref="S3.E6.m1.7.7.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.7b"><apply id="S3.E6.m1.7.7.1.1.cmml" xref="S3.E6.m1.7.7.1"><eq id="S3.E6.m1.7.7.1.1.1.cmml" xref="S3.E6.m1.7.7.1.1.1"></eq><apply id="S3.E6.m1.7.7.1.1.2.cmml" xref="S3.E6.m1.7.7.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.7.7.1.1.2.1.cmml" xref="S3.E6.m1.7.7.1.1.2">superscript</csymbol><apply id="S3.E6.m1.7.7.1.1.2.2.cmml" xref="S3.E6.m1.7.7.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.7.7.1.1.2.2.1.cmml" xref="S3.E6.m1.7.7.1.1.2">subscript</csymbol><ci id="S3.E6.m1.7.7.1.1.2.2.2.cmml" xref="S3.E6.m1.7.7.1.1.2.2.2">𝑚</ci><list id="S3.E6.m1.2.2.2.3.cmml" xref="S3.E6.m1.2.2.2.4"><ci id="S3.E6.m1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1">𝑖</ci><ci id="S3.E6.m1.2.2.2.2.cmml" xref="S3.E6.m1.2.2.2.2">𝑗</ci></list></apply><apply id="S3.E6.m1.7.7.1.1.2.3.cmml" xref="S3.E6.m1.7.7.1.1.2.3"><times id="S3.E6.m1.7.7.1.1.2.3.1.cmml" xref="S3.E6.m1.7.7.1.1.2.3.1"></times><ci id="S3.E6.m1.7.7.1.1.2.3.2.cmml" xref="S3.E6.m1.7.7.1.1.2.3.2">𝑀</ci><ci id="S3.E6.m1.7.7.1.1.2.3.3.cmml" xref="S3.E6.m1.7.7.1.1.2.3.3">𝑃</ci><ci id="S3.E6.m1.7.7.1.1.2.3.4.cmml" xref="S3.E6.m1.7.7.1.1.2.3.4">𝐴</ci></apply></apply><apply id="S3.E6.m1.6.6.cmml" xref="S3.E6.m1.6.6"><divide id="S3.E6.m1.6.6.5.cmml" xref="S3.E6.m1.6.6"></divide><apply id="S3.E6.m1.4.4.2.cmml" xref="S3.E6.m1.4.4.2"><csymbol cd="ambiguous" id="S3.E6.m1.4.4.2.3.cmml" xref="S3.E6.m1.4.4.2">superscript</csymbol><ci id="S3.E6.m1.4.4.2.4.cmml" xref="S3.E6.m1.4.4.2.4">𝑒</ci><apply id="S3.E6.m1.4.4.2.2.2.cmml" xref="S3.E6.m1.4.4.2.2.2"><csymbol cd="ambiguous" id="S3.E6.m1.4.4.2.2.2.3.cmml" xref="S3.E6.m1.4.4.2.2.2">subscript</csymbol><ci id="S3.E6.m1.4.4.2.2.2.4.cmml" xref="S3.E6.m1.4.4.2.2.2.4">𝑠</ci><list id="S3.E6.m1.4.4.2.2.2.2.2.3.cmml" xref="S3.E6.m1.4.4.2.2.2.2.2.4"><ci id="S3.E6.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1">𝑖</ci><ci id="S3.E6.m1.4.4.2.2.2.2.2.2.cmml" xref="S3.E6.m1.4.4.2.2.2.2.2.2">𝑗</ci></list></apply></apply><apply id="S3.E6.m1.6.6.4.cmml" xref="S3.E6.m1.6.6.4"><plus id="S3.E6.m1.6.6.4.3.cmml" xref="S3.E6.m1.6.6.4.3"></plus><apply id="S3.E6.m1.6.6.4.4.cmml" xref="S3.E6.m1.6.6.4.4"><csymbol cd="ambiguous" id="S3.E6.m1.6.6.4.4.1.cmml" xref="S3.E6.m1.6.6.4.4">superscript</csymbol><ci id="S3.E6.m1.6.6.4.4.2.cmml" xref="S3.E6.m1.6.6.4.4.2">𝑒</ci><apply id="S3.E6.m1.6.6.4.4.3.cmml" xref="S3.E6.m1.6.6.4.4.3"><csymbol cd="ambiguous" id="S3.E6.m1.6.6.4.4.3.1.cmml" xref="S3.E6.m1.6.6.4.4.3">subscript</csymbol><ci id="S3.E6.m1.6.6.4.4.3.2.cmml" xref="S3.E6.m1.6.6.4.4.3.2">𝑠</ci><apply id="S3.E6.m1.6.6.4.4.3.3.cmml" xref="S3.E6.m1.6.6.4.4.3.3"><times id="S3.E6.m1.6.6.4.4.3.3.1.cmml" xref="S3.E6.m1.6.6.4.4.3.3.1"></times><ci id="S3.E6.m1.6.6.4.4.3.3.2.cmml" xref="S3.E6.m1.6.6.4.4.3.3.2">𝑏</ci><ci id="S3.E6.m1.6.6.4.4.3.3.3.cmml" xref="S3.E6.m1.6.6.4.4.3.3.3">𝑔</ci></apply></apply></apply><apply id="S3.E6.m1.6.6.4.5.cmml" xref="S3.E6.m1.6.6.4.5"><csymbol cd="ambiguous" id="S3.E6.m1.6.6.4.5.1.cmml" xref="S3.E6.m1.6.6.4.5">superscript</csymbol><ci id="S3.E6.m1.6.6.4.5.2.cmml" xref="S3.E6.m1.6.6.4.5.2">𝑒</ci><apply id="S3.E6.m1.6.6.4.2.2.cmml" xref="S3.E6.m1.6.6.4.2.2"><csymbol cd="ambiguous" id="S3.E6.m1.6.6.4.2.2.3.cmml" xref="S3.E6.m1.6.6.4.2.2">subscript</csymbol><ci id="S3.E6.m1.6.6.4.2.2.4.cmml" xref="S3.E6.m1.6.6.4.2.2.4">𝑠</ci><list id="S3.E6.m1.6.6.4.2.2.2.2.3.cmml" xref="S3.E6.m1.6.6.4.2.2.2.2.4"><ci id="S3.E6.m1.5.5.3.1.1.1.1.1.cmml" xref="S3.E6.m1.5.5.3.1.1.1.1.1">𝑖</ci><ci id="S3.E6.m1.6.6.4.2.2.2.2.2.cmml" xref="S3.E6.m1.6.6.4.2.2.2.2.2">𝑗</ci></list></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.7c">m_{i,j}^{MPA}=\frac{e^{s_{i,j}}}{e^{s_{bg}}+e^{s_{i,j}}}.</annotation><annotation encoding="application/x-llamapun" id="S3.E6.m1.7d">italic_m start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_M italic_P italic_A end_POSTSUPERSCRIPT = divide start_ARG italic_e start_POSTSUPERSCRIPT italic_s start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT end_POSTSUPERSCRIPT end_ARG start_ARG italic_e start_POSTSUPERSCRIPT italic_s start_POSTSUBSCRIPT italic_b italic_g end_POSTSUBSCRIPT end_POSTSUPERSCRIPT + italic_e start_POSTSUPERSCRIPT italic_s start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT end_POSTSUPERSCRIPT end_ARG .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr>
</table>
<p id="S3.SS2.p8.1" class="ltx_p">In this case, each patch can be assigned to multiple referring expressions, see
Figure <a href="#S3.F3" title="Figure 3 ‣ 3.2 Global Pooling Mechanisms ‣ 3 Method ‣ Weakly-supervised segmentation of referring expressions" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> right. The masks are not mutually exclusive and
each referring expression can be assigned a score <math id="S3.SS2.p8.1.m1.4" class="ltx_Math" alttext="m_{i,j}^{MPA}\in[0,1]" display="inline"><semantics id="S3.SS2.p8.1.m1.4a"><mrow id="S3.SS2.p8.1.m1.4.5" xref="S3.SS2.p8.1.m1.4.5.cmml"><msubsup id="S3.SS2.p8.1.m1.4.5.2" xref="S3.SS2.p8.1.m1.4.5.2.cmml"><mi id="S3.SS2.p8.1.m1.4.5.2.2.2" xref="S3.SS2.p8.1.m1.4.5.2.2.2.cmml">m</mi><mrow id="S3.SS2.p8.1.m1.2.2.2.4" xref="S3.SS2.p8.1.m1.2.2.2.3.cmml"><mi id="S3.SS2.p8.1.m1.1.1.1.1" xref="S3.SS2.p8.1.m1.1.1.1.1.cmml">i</mi><mo id="S3.SS2.p8.1.m1.2.2.2.4.1" xref="S3.SS2.p8.1.m1.2.2.2.3.cmml">,</mo><mi id="S3.SS2.p8.1.m1.2.2.2.2" xref="S3.SS2.p8.1.m1.2.2.2.2.cmml">j</mi></mrow><mrow id="S3.SS2.p8.1.m1.4.5.2.3" xref="S3.SS2.p8.1.m1.4.5.2.3.cmml"><mi id="S3.SS2.p8.1.m1.4.5.2.3.2" xref="S3.SS2.p8.1.m1.4.5.2.3.2.cmml">M</mi><mo id="S3.SS2.p8.1.m1.4.5.2.3.1" xref="S3.SS2.p8.1.m1.4.5.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p8.1.m1.4.5.2.3.3" xref="S3.SS2.p8.1.m1.4.5.2.3.3.cmml">P</mi><mo id="S3.SS2.p8.1.m1.4.5.2.3.1a" xref="S3.SS2.p8.1.m1.4.5.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p8.1.m1.4.5.2.3.4" xref="S3.SS2.p8.1.m1.4.5.2.3.4.cmml">A</mi></mrow></msubsup><mo id="S3.SS2.p8.1.m1.4.5.1" xref="S3.SS2.p8.1.m1.4.5.1.cmml">∈</mo><mrow id="S3.SS2.p8.1.m1.4.5.3.2" xref="S3.SS2.p8.1.m1.4.5.3.1.cmml"><mo stretchy="false" id="S3.SS2.p8.1.m1.4.5.3.2.1" xref="S3.SS2.p8.1.m1.4.5.3.1.cmml">[</mo><mn id="S3.SS2.p8.1.m1.3.3" xref="S3.SS2.p8.1.m1.3.3.cmml">0</mn><mo id="S3.SS2.p8.1.m1.4.5.3.2.2" xref="S3.SS2.p8.1.m1.4.5.3.1.cmml">,</mo><mn id="S3.SS2.p8.1.m1.4.4" xref="S3.SS2.p8.1.m1.4.4.cmml">1</mn><mo stretchy="false" id="S3.SS2.p8.1.m1.4.5.3.2.3" xref="S3.SS2.p8.1.m1.4.5.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p8.1.m1.4b"><apply id="S3.SS2.p8.1.m1.4.5.cmml" xref="S3.SS2.p8.1.m1.4.5"><in id="S3.SS2.p8.1.m1.4.5.1.cmml" xref="S3.SS2.p8.1.m1.4.5.1"></in><apply id="S3.SS2.p8.1.m1.4.5.2.cmml" xref="S3.SS2.p8.1.m1.4.5.2"><csymbol cd="ambiguous" id="S3.SS2.p8.1.m1.4.5.2.1.cmml" xref="S3.SS2.p8.1.m1.4.5.2">superscript</csymbol><apply id="S3.SS2.p8.1.m1.4.5.2.2.cmml" xref="S3.SS2.p8.1.m1.4.5.2"><csymbol cd="ambiguous" id="S3.SS2.p8.1.m1.4.5.2.2.1.cmml" xref="S3.SS2.p8.1.m1.4.5.2">subscript</csymbol><ci id="S3.SS2.p8.1.m1.4.5.2.2.2.cmml" xref="S3.SS2.p8.1.m1.4.5.2.2.2">𝑚</ci><list id="S3.SS2.p8.1.m1.2.2.2.3.cmml" xref="S3.SS2.p8.1.m1.2.2.2.4"><ci id="S3.SS2.p8.1.m1.1.1.1.1.cmml" xref="S3.SS2.p8.1.m1.1.1.1.1">𝑖</ci><ci id="S3.SS2.p8.1.m1.2.2.2.2.cmml" xref="S3.SS2.p8.1.m1.2.2.2.2">𝑗</ci></list></apply><apply id="S3.SS2.p8.1.m1.4.5.2.3.cmml" xref="S3.SS2.p8.1.m1.4.5.2.3"><times id="S3.SS2.p8.1.m1.4.5.2.3.1.cmml" xref="S3.SS2.p8.1.m1.4.5.2.3.1"></times><ci id="S3.SS2.p8.1.m1.4.5.2.3.2.cmml" xref="S3.SS2.p8.1.m1.4.5.2.3.2">𝑀</ci><ci id="S3.SS2.p8.1.m1.4.5.2.3.3.cmml" xref="S3.SS2.p8.1.m1.4.5.2.3.3">𝑃</ci><ci id="S3.SS2.p8.1.m1.4.5.2.3.4.cmml" xref="S3.SS2.p8.1.m1.4.5.2.3.4">𝐴</ci></apply></apply><interval closure="closed" id="S3.SS2.p8.1.m1.4.5.3.1.cmml" xref="S3.SS2.p8.1.m1.4.5.3.2"><cn type="integer" id="S3.SS2.p8.1.m1.3.3.cmml" xref="S3.SS2.p8.1.m1.3.3">0</cn><cn type="integer" id="S3.SS2.p8.1.m1.4.4.cmml" xref="S3.SS2.p8.1.m1.4.4">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p8.1.m1.4c">m_{i,j}^{MPA}\in[0,1]</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p8.1.m1.4d">italic_m start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_M italic_P italic_A end_POSTSUPERSCRIPT ∈ [ 0 , 1 ]</annotation></semantics></math>
without softmax imposed constraints. Patch assignment is viewed as a multi-label
classification problem, this property is highly beneficial when performing
weakly-supervised referring expression segmentation, as shown in Section
<a href="#S4" title="4 Experiments ‣ Weakly-supervised segmentation of referring expressions" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>.
<br class="ltx_break"></p>
</div>
<div id="S3.SS2.p9" class="ltx_para ltx_noindent">
<p id="S3.SS2.p9.3" class="ltx_p"><span id="S3.SS2.p9.3.1" class="ltx_text ltx_font_bold">Image-text scores.</span>
We compute GWP scores <math id="S3.SS2.p9.1.m1.1" class="ltx_Math" alttext="\mathbf{z}^{GWP}" display="inline"><semantics id="S3.SS2.p9.1.m1.1a"><msup id="S3.SS2.p9.1.m1.1.1" xref="S3.SS2.p9.1.m1.1.1.cmml"><mi id="S3.SS2.p9.1.m1.1.1.2" xref="S3.SS2.p9.1.m1.1.1.2.cmml">𝐳</mi><mrow id="S3.SS2.p9.1.m1.1.1.3" xref="S3.SS2.p9.1.m1.1.1.3.cmml"><mi id="S3.SS2.p9.1.m1.1.1.3.2" xref="S3.SS2.p9.1.m1.1.1.3.2.cmml">G</mi><mo id="S3.SS2.p9.1.m1.1.1.3.1" xref="S3.SS2.p9.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p9.1.m1.1.1.3.3" xref="S3.SS2.p9.1.m1.1.1.3.3.cmml">W</mi><mo id="S3.SS2.p9.1.m1.1.1.3.1a" xref="S3.SS2.p9.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p9.1.m1.1.1.3.4" xref="S3.SS2.p9.1.m1.1.1.3.4.cmml">P</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p9.1.m1.1b"><apply id="S3.SS2.p9.1.m1.1.1.cmml" xref="S3.SS2.p9.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p9.1.m1.1.1.1.cmml" xref="S3.SS2.p9.1.m1.1.1">superscript</csymbol><ci id="S3.SS2.p9.1.m1.1.1.2.cmml" xref="S3.SS2.p9.1.m1.1.1.2">𝐳</ci><apply id="S3.SS2.p9.1.m1.1.1.3.cmml" xref="S3.SS2.p9.1.m1.1.1.3"><times id="S3.SS2.p9.1.m1.1.1.3.1.cmml" xref="S3.SS2.p9.1.m1.1.1.3.1"></times><ci id="S3.SS2.p9.1.m1.1.1.3.2.cmml" xref="S3.SS2.p9.1.m1.1.1.3.2">𝐺</ci><ci id="S3.SS2.p9.1.m1.1.1.3.3.cmml" xref="S3.SS2.p9.1.m1.1.1.3.3">𝑊</ci><ci id="S3.SS2.p9.1.m1.1.1.3.4.cmml" xref="S3.SS2.p9.1.m1.1.1.3.4">𝑃</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p9.1.m1.1c">\mathbf{z}^{GWP}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p9.1.m1.1d">bold_z start_POSTSUPERSCRIPT italic_G italic_W italic_P end_POSTSUPERSCRIPT</annotation></semantics></math> with (<a href="#S3.E4" title="(4) ‣ 3.2 Global Pooling Mechanisms ‣ 3 Method ‣ Weakly-supervised segmentation of referring expressions" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>) using the masks
<math id="S3.SS2.p9.2.m2.1" class="ltx_Math" alttext="\mathbf{M}" display="inline"><semantics id="S3.SS2.p9.2.m2.1a"><mi id="S3.SS2.p9.2.m2.1.1" xref="S3.SS2.p9.2.m2.1.1.cmml">𝐌</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p9.2.m2.1b"><ci id="S3.SS2.p9.2.m2.1.1.cmml" xref="S3.SS2.p9.2.m2.1.1">𝐌</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p9.2.m2.1c">\mathbf{M}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p9.2.m2.1d">bold_M</annotation></semantics></math> defined according to one of the assignment mechanism defined in
(<a href="#S3.E5" title="(5) ‣ 3.2 Global Pooling Mechanisms ‣ 3 Method ‣ Weakly-supervised segmentation of referring expressions" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>),(<a href="#S3.E6" title="(6) ‣ 3.2 Global Pooling Mechanisms ‣ 3 Method ‣ Weakly-supervised segmentation of referring expressions" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>). Then, we compute mask size scores
<math id="S3.SS2.p9.3.m3.1" class="ltx_Math" alttext="\mathbf{z}^{size}" display="inline"><semantics id="S3.SS2.p9.3.m3.1a"><msup id="S3.SS2.p9.3.m3.1.1" xref="S3.SS2.p9.3.m3.1.1.cmml"><mi id="S3.SS2.p9.3.m3.1.1.2" xref="S3.SS2.p9.3.m3.1.1.2.cmml">𝐳</mi><mrow id="S3.SS2.p9.3.m3.1.1.3" xref="S3.SS2.p9.3.m3.1.1.3.cmml"><mi id="S3.SS2.p9.3.m3.1.1.3.2" xref="S3.SS2.p9.3.m3.1.1.3.2.cmml">s</mi><mo id="S3.SS2.p9.3.m3.1.1.3.1" xref="S3.SS2.p9.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p9.3.m3.1.1.3.3" xref="S3.SS2.p9.3.m3.1.1.3.3.cmml">i</mi><mo id="S3.SS2.p9.3.m3.1.1.3.1a" xref="S3.SS2.p9.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p9.3.m3.1.1.3.4" xref="S3.SS2.p9.3.m3.1.1.3.4.cmml">z</mi><mo id="S3.SS2.p9.3.m3.1.1.3.1b" xref="S3.SS2.p9.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p9.3.m3.1.1.3.5" xref="S3.SS2.p9.3.m3.1.1.3.5.cmml">e</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p9.3.m3.1b"><apply id="S3.SS2.p9.3.m3.1.1.cmml" xref="S3.SS2.p9.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p9.3.m3.1.1.1.cmml" xref="S3.SS2.p9.3.m3.1.1">superscript</csymbol><ci id="S3.SS2.p9.3.m3.1.1.2.cmml" xref="S3.SS2.p9.3.m3.1.1.2">𝐳</ci><apply id="S3.SS2.p9.3.m3.1.1.3.cmml" xref="S3.SS2.p9.3.m3.1.1.3"><times id="S3.SS2.p9.3.m3.1.1.3.1.cmml" xref="S3.SS2.p9.3.m3.1.1.3.1"></times><ci id="S3.SS2.p9.3.m3.1.1.3.2.cmml" xref="S3.SS2.p9.3.m3.1.1.3.2">𝑠</ci><ci id="S3.SS2.p9.3.m3.1.1.3.3.cmml" xref="S3.SS2.p9.3.m3.1.1.3.3">𝑖</ci><ci id="S3.SS2.p9.3.m3.1.1.3.4.cmml" xref="S3.SS2.p9.3.m3.1.1.3.4">𝑧</ci><ci id="S3.SS2.p9.3.m3.1.1.3.5.cmml" xref="S3.SS2.p9.3.m3.1.1.3.5">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p9.3.m3.1c">\mathbf{z}^{size}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p9.3.m3.1d">bold_z start_POSTSUPERSCRIPT italic_s italic_i italic_z italic_e end_POSTSUPERSCRIPT</annotation></semantics></math> as</p>
<table id="S3.E7" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E7.m1.2" class="ltx_Math" alttext="z^{size}_{j}=(1-\mkern 1.5mu\overline{\mkern-1.5mum\mkern-1.5mu}\mkern 1.5mu_{%
j})^{p}\log(\lambda+\mkern 1.5mu\overline{\mkern-1.5mum_{j}\mkern-1.5mu}\mkern
1%
.5mu)," display="block"><semantics id="S3.E7.m1.2a"><mrow id="S3.E7.m1.2.2.1" xref="S3.E7.m1.2.2.1.1.cmml"><mrow id="S3.E7.m1.2.2.1.1" xref="S3.E7.m1.2.2.1.1.cmml"><msubsup id="S3.E7.m1.2.2.1.1.4" xref="S3.E7.m1.2.2.1.1.4.cmml"><mi id="S3.E7.m1.2.2.1.1.4.2.2" xref="S3.E7.m1.2.2.1.1.4.2.2.cmml">z</mi><mi id="S3.E7.m1.2.2.1.1.4.3" xref="S3.E7.m1.2.2.1.1.4.3.cmml">j</mi><mrow id="S3.E7.m1.2.2.1.1.4.2.3" xref="S3.E7.m1.2.2.1.1.4.2.3.cmml"><mi id="S3.E7.m1.2.2.1.1.4.2.3.2" xref="S3.E7.m1.2.2.1.1.4.2.3.2.cmml">s</mi><mo id="S3.E7.m1.2.2.1.1.4.2.3.1" xref="S3.E7.m1.2.2.1.1.4.2.3.1.cmml">⁢</mo><mi id="S3.E7.m1.2.2.1.1.4.2.3.3" xref="S3.E7.m1.2.2.1.1.4.2.3.3.cmml">i</mi><mo id="S3.E7.m1.2.2.1.1.4.2.3.1a" xref="S3.E7.m1.2.2.1.1.4.2.3.1.cmml">⁢</mo><mi id="S3.E7.m1.2.2.1.1.4.2.3.4" xref="S3.E7.m1.2.2.1.1.4.2.3.4.cmml">z</mi><mo id="S3.E7.m1.2.2.1.1.4.2.3.1b" xref="S3.E7.m1.2.2.1.1.4.2.3.1.cmml">⁢</mo><mi id="S3.E7.m1.2.2.1.1.4.2.3.5" xref="S3.E7.m1.2.2.1.1.4.2.3.5.cmml">e</mi></mrow></msubsup><mo id="S3.E7.m1.2.2.1.1.3" xref="S3.E7.m1.2.2.1.1.3.cmml">=</mo><mrow id="S3.E7.m1.2.2.1.1.2" xref="S3.E7.m1.2.2.1.1.2.cmml"><msup id="S3.E7.m1.2.2.1.1.1.1" xref="S3.E7.m1.2.2.1.1.1.1.cmml"><mrow id="S3.E7.m1.2.2.1.1.1.1.1.1" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E7.m1.2.2.1.1.1.1.1.1.2" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E7.m1.2.2.1.1.1.1.1.1.1" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.cmml"><mn id="S3.E7.m1.2.2.1.1.1.1.1.1.1.2" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.2.cmml">1</mn><mo rspace="3.3pt" id="S3.E7.m1.2.2.1.1.1.1.1.1.1.1" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.cmml">-</mo><msub id="S3.E7.m1.2.2.1.1.1.1.1.1.1.3" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.3.cmml"><mpadded width="+0.8pt" id="S3.E7.m1.2.2.1.1.1.1.1.1.1.3.2" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.3.2.cmml"><mover accent="true" id="S3.E7.m1.2.2.1.1.1.1.1.1.1.3.2a" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.3.2.cmml"><mpadded lspace="-0.8pt" width="-1.6pt" id="S3.E7.m1.2.2.1.1.1.1.1.1.1.3.2.2" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.3.2.2.cmml"><mi id="S3.E7.m1.2.2.1.1.1.1.1.1.1.3.2.2a" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.3.2.2.cmml">m</mi></mpadded><mo id="S3.E7.m1.2.2.1.1.1.1.1.1.1.3.2.1" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.3.2.1.cmml">¯</mo></mover></mpadded><mi id="S3.E7.m1.2.2.1.1.1.1.1.1.1.3.3" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.3.3.cmml">j</mi></msub></mrow><mo stretchy="false" id="S3.E7.m1.2.2.1.1.1.1.1.1.3" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow><mi id="S3.E7.m1.2.2.1.1.1.1.3" xref="S3.E7.m1.2.2.1.1.1.1.3.cmml">p</mi></msup><mo id="S3.E7.m1.2.2.1.1.2.3" xref="S3.E7.m1.2.2.1.1.2.3.cmml">⁢</mo><mrow id="S3.E7.m1.2.2.1.1.2.2.1" xref="S3.E7.m1.2.2.1.1.2.2.2.cmml"><mi id="S3.E7.m1.1.1" xref="S3.E7.m1.1.1.cmml">log</mi><mo id="S3.E7.m1.2.2.1.1.2.2.1a" xref="S3.E7.m1.2.2.1.1.2.2.2.cmml">⁡</mo><mrow id="S3.E7.m1.2.2.1.1.2.2.1.1" xref="S3.E7.m1.2.2.1.1.2.2.2.cmml"><mo stretchy="false" id="S3.E7.m1.2.2.1.1.2.2.1.1.2" xref="S3.E7.m1.2.2.1.1.2.2.2.cmml">(</mo><mrow id="S3.E7.m1.2.2.1.1.2.2.1.1.1" xref="S3.E7.m1.2.2.1.1.2.2.1.1.1.cmml"><mi id="S3.E7.m1.2.2.1.1.2.2.1.1.1.2" xref="S3.E7.m1.2.2.1.1.2.2.1.1.1.2.cmml">λ</mi><mo rspace="3.3pt" id="S3.E7.m1.2.2.1.1.2.2.1.1.1.1" xref="S3.E7.m1.2.2.1.1.2.2.1.1.1.1.cmml">+</mo><mpadded width="+0.8pt" id="S3.E7.m1.2.2.1.1.2.2.1.1.1.3" xref="S3.E7.m1.2.2.1.1.2.2.1.1.1.3.cmml"><mover accent="true" id="S3.E7.m1.2.2.1.1.2.2.1.1.1.3a" xref="S3.E7.m1.2.2.1.1.2.2.1.1.1.3.cmml"><mpadded width="-0.8pt" id="S3.E7.m1.2.2.1.1.2.2.1.1.1.3.2" xref="S3.E7.m1.2.2.1.1.2.2.1.1.1.3.2.cmml"><msub id="S3.E7.m1.2.2.1.1.2.2.1.1.1.3.2a" xref="S3.E7.m1.2.2.1.1.2.2.1.1.1.3.2.cmml"><mpadded lspace="-0.8pt" width="-0.8pt" id="S3.E7.m1.2.2.1.1.2.2.1.1.1.3.2.2" xref="S3.E7.m1.2.2.1.1.2.2.1.1.1.3.2.2.cmml"><mi id="S3.E7.m1.2.2.1.1.2.2.1.1.1.3.2.2a" xref="S3.E7.m1.2.2.1.1.2.2.1.1.1.3.2.2.cmml">m</mi></mpadded><mi id="S3.E7.m1.2.2.1.1.2.2.1.1.1.3.2.3" xref="S3.E7.m1.2.2.1.1.2.2.1.1.1.3.2.3.cmml">j</mi></msub></mpadded><mo id="S3.E7.m1.2.2.1.1.2.2.1.1.1.3.1" xref="S3.E7.m1.2.2.1.1.2.2.1.1.1.3.1.cmml">¯</mo></mover></mpadded></mrow><mo stretchy="false" id="S3.E7.m1.2.2.1.1.2.2.1.1.3" xref="S3.E7.m1.2.2.1.1.2.2.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E7.m1.2.2.1.2" xref="S3.E7.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.2b"><apply id="S3.E7.m1.2.2.1.1.cmml" xref="S3.E7.m1.2.2.1"><eq id="S3.E7.m1.2.2.1.1.3.cmml" xref="S3.E7.m1.2.2.1.1.3"></eq><apply id="S3.E7.m1.2.2.1.1.4.cmml" xref="S3.E7.m1.2.2.1.1.4"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.1.1.4.1.cmml" xref="S3.E7.m1.2.2.1.1.4">subscript</csymbol><apply id="S3.E7.m1.2.2.1.1.4.2.cmml" xref="S3.E7.m1.2.2.1.1.4"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.1.1.4.2.1.cmml" xref="S3.E7.m1.2.2.1.1.4">superscript</csymbol><ci id="S3.E7.m1.2.2.1.1.4.2.2.cmml" xref="S3.E7.m1.2.2.1.1.4.2.2">𝑧</ci><apply id="S3.E7.m1.2.2.1.1.4.2.3.cmml" xref="S3.E7.m1.2.2.1.1.4.2.3"><times id="S3.E7.m1.2.2.1.1.4.2.3.1.cmml" xref="S3.E7.m1.2.2.1.1.4.2.3.1"></times><ci id="S3.E7.m1.2.2.1.1.4.2.3.2.cmml" xref="S3.E7.m1.2.2.1.1.4.2.3.2">𝑠</ci><ci id="S3.E7.m1.2.2.1.1.4.2.3.3.cmml" xref="S3.E7.m1.2.2.1.1.4.2.3.3">𝑖</ci><ci id="S3.E7.m1.2.2.1.1.4.2.3.4.cmml" xref="S3.E7.m1.2.2.1.1.4.2.3.4">𝑧</ci><ci id="S3.E7.m1.2.2.1.1.4.2.3.5.cmml" xref="S3.E7.m1.2.2.1.1.4.2.3.5">𝑒</ci></apply></apply><ci id="S3.E7.m1.2.2.1.1.4.3.cmml" xref="S3.E7.m1.2.2.1.1.4.3">𝑗</ci></apply><apply id="S3.E7.m1.2.2.1.1.2.cmml" xref="S3.E7.m1.2.2.1.1.2"><times id="S3.E7.m1.2.2.1.1.2.3.cmml" xref="S3.E7.m1.2.2.1.1.2.3"></times><apply id="S3.E7.m1.2.2.1.1.1.1.cmml" xref="S3.E7.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.1.1.1.1.2.cmml" xref="S3.E7.m1.2.2.1.1.1.1">superscript</csymbol><apply id="S3.E7.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.2.2.1.1.1.1.1.1"><minus id="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.1"></minus><cn type="integer" id="S3.E7.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.2">1</cn><apply id="S3.E7.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.3">subscript</csymbol><apply id="S3.E7.m1.2.2.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.3.2"><ci id="S3.E7.m1.2.2.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.3.2.1">¯</ci><ci id="S3.E7.m1.2.2.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.3.2.2">𝑚</ci></apply><ci id="S3.E7.m1.2.2.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.3.3">𝑗</ci></apply></apply><ci id="S3.E7.m1.2.2.1.1.1.1.3.cmml" xref="S3.E7.m1.2.2.1.1.1.1.3">𝑝</ci></apply><apply id="S3.E7.m1.2.2.1.1.2.2.2.cmml" xref="S3.E7.m1.2.2.1.1.2.2.1"><log id="S3.E7.m1.1.1.cmml" xref="S3.E7.m1.1.1"></log><apply id="S3.E7.m1.2.2.1.1.2.2.1.1.1.cmml" xref="S3.E7.m1.2.2.1.1.2.2.1.1.1"><plus id="S3.E7.m1.2.2.1.1.2.2.1.1.1.1.cmml" xref="S3.E7.m1.2.2.1.1.2.2.1.1.1.1"></plus><ci id="S3.E7.m1.2.2.1.1.2.2.1.1.1.2.cmml" xref="S3.E7.m1.2.2.1.1.2.2.1.1.1.2">𝜆</ci><apply id="S3.E7.m1.2.2.1.1.2.2.1.1.1.3.cmml" xref="S3.E7.m1.2.2.1.1.2.2.1.1.1.3"><ci id="S3.E7.m1.2.2.1.1.2.2.1.1.1.3.1.cmml" xref="S3.E7.m1.2.2.1.1.2.2.1.1.1.3.1">¯</ci><apply id="S3.E7.m1.2.2.1.1.2.2.1.1.1.3.2.cmml" xref="S3.E7.m1.2.2.1.1.2.2.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.1.1.2.2.1.1.1.3.2.1.cmml" xref="S3.E7.m1.2.2.1.1.2.2.1.1.1.3.2">subscript</csymbol><ci id="S3.E7.m1.2.2.1.1.2.2.1.1.1.3.2.2.cmml" xref="S3.E7.m1.2.2.1.1.2.2.1.1.1.3.2.2">𝑚</ci><ci id="S3.E7.m1.2.2.1.1.2.2.1.1.1.3.2.3.cmml" xref="S3.E7.m1.2.2.1.1.2.2.1.1.1.3.2.3">𝑗</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.2c">z^{size}_{j}=(1-\mkern 1.5mu\overline{\mkern-1.5mum\mkern-1.5mu}\mkern 1.5mu_{%
j})^{p}\log(\lambda+\mkern 1.5mu\overline{\mkern-1.5mum_{j}\mkern-1.5mu}\mkern
1%
.5mu),</annotation><annotation encoding="application/x-llamapun" id="S3.E7.m1.2d">italic_z start_POSTSUPERSCRIPT italic_s italic_i italic_z italic_e end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT = ( 1 - over¯ start_ARG italic_m end_ARG start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT roman_log ( italic_λ + over¯ start_ARG italic_m start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_ARG ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr>
</table>
<p id="S3.SS2.p9.11" class="ltx_p">with <math id="S3.SS2.p9.4.m1.2" class="ltx_Math" alttext="\mkern 1.5mu\overline{\mkern-1.5mum_{j}\mkern-1.5mu}\mkern 1.5mu=\frac{1}{N}%
\sum_{i=1}^{N}m_{i,j}" display="inline"><semantics id="S3.SS2.p9.4.m1.2a"><mrow id="S3.SS2.p9.4.m1.2.3" xref="S3.SS2.p9.4.m1.2.3.cmml"><mpadded lspace="0.8pt" width="+1.6pt" id="S3.SS2.p9.4.m1.2.3.2" xref="S3.SS2.p9.4.m1.2.3.2.cmml"><mover accent="true" id="S3.SS2.p9.4.m1.2.3.2a" xref="S3.SS2.p9.4.m1.2.3.2.cmml"><mpadded width="-0.8pt" id="S3.SS2.p9.4.m1.2.3.2.2" xref="S3.SS2.p9.4.m1.2.3.2.2.cmml"><msub id="S3.SS2.p9.4.m1.2.3.2.2a" xref="S3.SS2.p9.4.m1.2.3.2.2.cmml"><mpadded lspace="-0.8pt" width="-0.8pt" id="S3.SS2.p9.4.m1.2.3.2.2.2" xref="S3.SS2.p9.4.m1.2.3.2.2.2.cmml"><mi id="S3.SS2.p9.4.m1.2.3.2.2.2a" xref="S3.SS2.p9.4.m1.2.3.2.2.2.cmml">m</mi></mpadded><mi id="S3.SS2.p9.4.m1.2.3.2.2.3" xref="S3.SS2.p9.4.m1.2.3.2.2.3.cmml">j</mi></msub></mpadded><mo id="S3.SS2.p9.4.m1.2.3.2.1" xref="S3.SS2.p9.4.m1.2.3.2.1.cmml">¯</mo></mover></mpadded><mo id="S3.SS2.p9.4.m1.2.3.1" xref="S3.SS2.p9.4.m1.2.3.1.cmml">=</mo><mrow id="S3.SS2.p9.4.m1.2.3.3" xref="S3.SS2.p9.4.m1.2.3.3.cmml"><mfrac id="S3.SS2.p9.4.m1.2.3.3.2" xref="S3.SS2.p9.4.m1.2.3.3.2.cmml"><mn id="S3.SS2.p9.4.m1.2.3.3.2.2" xref="S3.SS2.p9.4.m1.2.3.3.2.2.cmml">1</mn><mi id="S3.SS2.p9.4.m1.2.3.3.2.3" xref="S3.SS2.p9.4.m1.2.3.3.2.3.cmml">N</mi></mfrac><mo id="S3.SS2.p9.4.m1.2.3.3.1" xref="S3.SS2.p9.4.m1.2.3.3.1.cmml">⁢</mo><mrow id="S3.SS2.p9.4.m1.2.3.3.3" xref="S3.SS2.p9.4.m1.2.3.3.3.cmml"><msubsup id="S3.SS2.p9.4.m1.2.3.3.3.1" xref="S3.SS2.p9.4.m1.2.3.3.3.1.cmml"><mo largeop="true" symmetric="true" id="S3.SS2.p9.4.m1.2.3.3.3.1.2.2" xref="S3.SS2.p9.4.m1.2.3.3.3.1.2.2.cmml">∑</mo><mrow id="S3.SS2.p9.4.m1.2.3.3.3.1.2.3" xref="S3.SS2.p9.4.m1.2.3.3.3.1.2.3.cmml"><mi id="S3.SS2.p9.4.m1.2.3.3.3.1.2.3.2" xref="S3.SS2.p9.4.m1.2.3.3.3.1.2.3.2.cmml">i</mi><mo id="S3.SS2.p9.4.m1.2.3.3.3.1.2.3.1" xref="S3.SS2.p9.4.m1.2.3.3.3.1.2.3.1.cmml">=</mo><mn id="S3.SS2.p9.4.m1.2.3.3.3.1.2.3.3" xref="S3.SS2.p9.4.m1.2.3.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.SS2.p9.4.m1.2.3.3.3.1.3" xref="S3.SS2.p9.4.m1.2.3.3.3.1.3.cmml">N</mi></msubsup><msub id="S3.SS2.p9.4.m1.2.3.3.3.2" xref="S3.SS2.p9.4.m1.2.3.3.3.2.cmml"><mi id="S3.SS2.p9.4.m1.2.3.3.3.2.2" xref="S3.SS2.p9.4.m1.2.3.3.3.2.2.cmml">m</mi><mrow id="S3.SS2.p9.4.m1.2.2.2.4" xref="S3.SS2.p9.4.m1.2.2.2.3.cmml"><mi id="S3.SS2.p9.4.m1.1.1.1.1" xref="S3.SS2.p9.4.m1.1.1.1.1.cmml">i</mi><mo id="S3.SS2.p9.4.m1.2.2.2.4.1" xref="S3.SS2.p9.4.m1.2.2.2.3.cmml">,</mo><mi id="S3.SS2.p9.4.m1.2.2.2.2" xref="S3.SS2.p9.4.m1.2.2.2.2.cmml">j</mi></mrow></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p9.4.m1.2b"><apply id="S3.SS2.p9.4.m1.2.3.cmml" xref="S3.SS2.p9.4.m1.2.3"><eq id="S3.SS2.p9.4.m1.2.3.1.cmml" xref="S3.SS2.p9.4.m1.2.3.1"></eq><apply id="S3.SS2.p9.4.m1.2.3.2.cmml" xref="S3.SS2.p9.4.m1.2.3.2"><ci id="S3.SS2.p9.4.m1.2.3.2.1.cmml" xref="S3.SS2.p9.4.m1.2.3.2.1">¯</ci><apply id="S3.SS2.p9.4.m1.2.3.2.2.cmml" xref="S3.SS2.p9.4.m1.2.3.2.2"><csymbol cd="ambiguous" id="S3.SS2.p9.4.m1.2.3.2.2.1.cmml" xref="S3.SS2.p9.4.m1.2.3.2.2">subscript</csymbol><ci id="S3.SS2.p9.4.m1.2.3.2.2.2.cmml" xref="S3.SS2.p9.4.m1.2.3.2.2.2">𝑚</ci><ci id="S3.SS2.p9.4.m1.2.3.2.2.3.cmml" xref="S3.SS2.p9.4.m1.2.3.2.2.3">𝑗</ci></apply></apply><apply id="S3.SS2.p9.4.m1.2.3.3.cmml" xref="S3.SS2.p9.4.m1.2.3.3"><times id="S3.SS2.p9.4.m1.2.3.3.1.cmml" xref="S3.SS2.p9.4.m1.2.3.3.1"></times><apply id="S3.SS2.p9.4.m1.2.3.3.2.cmml" xref="S3.SS2.p9.4.m1.2.3.3.2"><divide id="S3.SS2.p9.4.m1.2.3.3.2.1.cmml" xref="S3.SS2.p9.4.m1.2.3.3.2"></divide><cn type="integer" id="S3.SS2.p9.4.m1.2.3.3.2.2.cmml" xref="S3.SS2.p9.4.m1.2.3.3.2.2">1</cn><ci id="S3.SS2.p9.4.m1.2.3.3.2.3.cmml" xref="S3.SS2.p9.4.m1.2.3.3.2.3">𝑁</ci></apply><apply id="S3.SS2.p9.4.m1.2.3.3.3.cmml" xref="S3.SS2.p9.4.m1.2.3.3.3"><apply id="S3.SS2.p9.4.m1.2.3.3.3.1.cmml" xref="S3.SS2.p9.4.m1.2.3.3.3.1"><csymbol cd="ambiguous" id="S3.SS2.p9.4.m1.2.3.3.3.1.1.cmml" xref="S3.SS2.p9.4.m1.2.3.3.3.1">superscript</csymbol><apply id="S3.SS2.p9.4.m1.2.3.3.3.1.2.cmml" xref="S3.SS2.p9.4.m1.2.3.3.3.1"><csymbol cd="ambiguous" id="S3.SS2.p9.4.m1.2.3.3.3.1.2.1.cmml" xref="S3.SS2.p9.4.m1.2.3.3.3.1">subscript</csymbol><sum id="S3.SS2.p9.4.m1.2.3.3.3.1.2.2.cmml" xref="S3.SS2.p9.4.m1.2.3.3.3.1.2.2"></sum><apply id="S3.SS2.p9.4.m1.2.3.3.3.1.2.3.cmml" xref="S3.SS2.p9.4.m1.2.3.3.3.1.2.3"><eq id="S3.SS2.p9.4.m1.2.3.3.3.1.2.3.1.cmml" xref="S3.SS2.p9.4.m1.2.3.3.3.1.2.3.1"></eq><ci id="S3.SS2.p9.4.m1.2.3.3.3.1.2.3.2.cmml" xref="S3.SS2.p9.4.m1.2.3.3.3.1.2.3.2">𝑖</ci><cn type="integer" id="S3.SS2.p9.4.m1.2.3.3.3.1.2.3.3.cmml" xref="S3.SS2.p9.4.m1.2.3.3.3.1.2.3.3">1</cn></apply></apply><ci id="S3.SS2.p9.4.m1.2.3.3.3.1.3.cmml" xref="S3.SS2.p9.4.m1.2.3.3.3.1.3">𝑁</ci></apply><apply id="S3.SS2.p9.4.m1.2.3.3.3.2.cmml" xref="S3.SS2.p9.4.m1.2.3.3.3.2"><csymbol cd="ambiguous" id="S3.SS2.p9.4.m1.2.3.3.3.2.1.cmml" xref="S3.SS2.p9.4.m1.2.3.3.3.2">subscript</csymbol><ci id="S3.SS2.p9.4.m1.2.3.3.3.2.2.cmml" xref="S3.SS2.p9.4.m1.2.3.3.3.2.2">𝑚</ci><list id="S3.SS2.p9.4.m1.2.2.2.3.cmml" xref="S3.SS2.p9.4.m1.2.2.2.4"><ci id="S3.SS2.p9.4.m1.1.1.1.1.cmml" xref="S3.SS2.p9.4.m1.1.1.1.1">𝑖</ci><ci id="S3.SS2.p9.4.m1.2.2.2.2.cmml" xref="S3.SS2.p9.4.m1.2.2.2.2">𝑗</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p9.4.m1.2c">\mkern 1.5mu\overline{\mkern-1.5mum_{j}\mkern-1.5mu}\mkern 1.5mu=\frac{1}{N}%
\sum_{i=1}^{N}m_{i,j}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p9.4.m1.2d">over¯ start_ARG italic_m start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_ARG = divide start_ARG 1 end_ARG start_ARG italic_N end_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT italic_m start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT</annotation></semantics></math>. This <math id="S3.SS2.p9.5.m2.1" class="ltx_Math" alttext="\mathbf{z}^{size}" display="inline"><semantics id="S3.SS2.p9.5.m2.1a"><msup id="S3.SS2.p9.5.m2.1.1" xref="S3.SS2.p9.5.m2.1.1.cmml"><mi id="S3.SS2.p9.5.m2.1.1.2" xref="S3.SS2.p9.5.m2.1.1.2.cmml">𝐳</mi><mrow id="S3.SS2.p9.5.m2.1.1.3" xref="S3.SS2.p9.5.m2.1.1.3.cmml"><mi id="S3.SS2.p9.5.m2.1.1.3.2" xref="S3.SS2.p9.5.m2.1.1.3.2.cmml">s</mi><mo id="S3.SS2.p9.5.m2.1.1.3.1" xref="S3.SS2.p9.5.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p9.5.m2.1.1.3.3" xref="S3.SS2.p9.5.m2.1.1.3.3.cmml">i</mi><mo id="S3.SS2.p9.5.m2.1.1.3.1a" xref="S3.SS2.p9.5.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p9.5.m2.1.1.3.4" xref="S3.SS2.p9.5.m2.1.1.3.4.cmml">z</mi><mo id="S3.SS2.p9.5.m2.1.1.3.1b" xref="S3.SS2.p9.5.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p9.5.m2.1.1.3.5" xref="S3.SS2.p9.5.m2.1.1.3.5.cmml">e</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p9.5.m2.1b"><apply id="S3.SS2.p9.5.m2.1.1.cmml" xref="S3.SS2.p9.5.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p9.5.m2.1.1.1.cmml" xref="S3.SS2.p9.5.m2.1.1">superscript</csymbol><ci id="S3.SS2.p9.5.m2.1.1.2.cmml" xref="S3.SS2.p9.5.m2.1.1.2">𝐳</ci><apply id="S3.SS2.p9.5.m2.1.1.3.cmml" xref="S3.SS2.p9.5.m2.1.1.3"><times id="S3.SS2.p9.5.m2.1.1.3.1.cmml" xref="S3.SS2.p9.5.m2.1.1.3.1"></times><ci id="S3.SS2.p9.5.m2.1.1.3.2.cmml" xref="S3.SS2.p9.5.m2.1.1.3.2">𝑠</ci><ci id="S3.SS2.p9.5.m2.1.1.3.3.cmml" xref="S3.SS2.p9.5.m2.1.1.3.3">𝑖</ci><ci id="S3.SS2.p9.5.m2.1.1.3.4.cmml" xref="S3.SS2.p9.5.m2.1.1.3.4">𝑧</ci><ci id="S3.SS2.p9.5.m2.1.1.3.5.cmml" xref="S3.SS2.p9.5.m2.1.1.3.5">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p9.5.m2.1c">\mathbf{z}^{size}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p9.5.m2.1d">bold_z start_POSTSUPERSCRIPT italic_s italic_i italic_z italic_e end_POSTSUPERSCRIPT</annotation></semantics></math>
is a size-penalty term introduced by <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite> to enforce mask
completeness, e.g. <math id="S3.SS2.p9.6.m3.1" class="ltx_Math" alttext="z_{j}^{size}&lt;0" display="inline"><semantics id="S3.SS2.p9.6.m3.1a"><mrow id="S3.SS2.p9.6.m3.1.1" xref="S3.SS2.p9.6.m3.1.1.cmml"><msubsup id="S3.SS2.p9.6.m3.1.1.2" xref="S3.SS2.p9.6.m3.1.1.2.cmml"><mi id="S3.SS2.p9.6.m3.1.1.2.2.2" xref="S3.SS2.p9.6.m3.1.1.2.2.2.cmml">z</mi><mi id="S3.SS2.p9.6.m3.1.1.2.2.3" xref="S3.SS2.p9.6.m3.1.1.2.2.3.cmml">j</mi><mrow id="S3.SS2.p9.6.m3.1.1.2.3" xref="S3.SS2.p9.6.m3.1.1.2.3.cmml"><mi id="S3.SS2.p9.6.m3.1.1.2.3.2" xref="S3.SS2.p9.6.m3.1.1.2.3.2.cmml">s</mi><mo id="S3.SS2.p9.6.m3.1.1.2.3.1" xref="S3.SS2.p9.6.m3.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p9.6.m3.1.1.2.3.3" xref="S3.SS2.p9.6.m3.1.1.2.3.3.cmml">i</mi><mo id="S3.SS2.p9.6.m3.1.1.2.3.1a" xref="S3.SS2.p9.6.m3.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p9.6.m3.1.1.2.3.4" xref="S3.SS2.p9.6.m3.1.1.2.3.4.cmml">z</mi><mo id="S3.SS2.p9.6.m3.1.1.2.3.1b" xref="S3.SS2.p9.6.m3.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p9.6.m3.1.1.2.3.5" xref="S3.SS2.p9.6.m3.1.1.2.3.5.cmml">e</mi></mrow></msubsup><mo id="S3.SS2.p9.6.m3.1.1.1" xref="S3.SS2.p9.6.m3.1.1.1.cmml">&lt;</mo><mn id="S3.SS2.p9.6.m3.1.1.3" xref="S3.SS2.p9.6.m3.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p9.6.m3.1b"><apply id="S3.SS2.p9.6.m3.1.1.cmml" xref="S3.SS2.p9.6.m3.1.1"><lt id="S3.SS2.p9.6.m3.1.1.1.cmml" xref="S3.SS2.p9.6.m3.1.1.1"></lt><apply id="S3.SS2.p9.6.m3.1.1.2.cmml" xref="S3.SS2.p9.6.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p9.6.m3.1.1.2.1.cmml" xref="S3.SS2.p9.6.m3.1.1.2">superscript</csymbol><apply id="S3.SS2.p9.6.m3.1.1.2.2.cmml" xref="S3.SS2.p9.6.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p9.6.m3.1.1.2.2.1.cmml" xref="S3.SS2.p9.6.m3.1.1.2">subscript</csymbol><ci id="S3.SS2.p9.6.m3.1.1.2.2.2.cmml" xref="S3.SS2.p9.6.m3.1.1.2.2.2">𝑧</ci><ci id="S3.SS2.p9.6.m3.1.1.2.2.3.cmml" xref="S3.SS2.p9.6.m3.1.1.2.2.3">𝑗</ci></apply><apply id="S3.SS2.p9.6.m3.1.1.2.3.cmml" xref="S3.SS2.p9.6.m3.1.1.2.3"><times id="S3.SS2.p9.6.m3.1.1.2.3.1.cmml" xref="S3.SS2.p9.6.m3.1.1.2.3.1"></times><ci id="S3.SS2.p9.6.m3.1.1.2.3.2.cmml" xref="S3.SS2.p9.6.m3.1.1.2.3.2">𝑠</ci><ci id="S3.SS2.p9.6.m3.1.1.2.3.3.cmml" xref="S3.SS2.p9.6.m3.1.1.2.3.3">𝑖</ci><ci id="S3.SS2.p9.6.m3.1.1.2.3.4.cmml" xref="S3.SS2.p9.6.m3.1.1.2.3.4">𝑧</ci><ci id="S3.SS2.p9.6.m3.1.1.2.3.5.cmml" xref="S3.SS2.p9.6.m3.1.1.2.3.5">𝑒</ci></apply></apply><cn type="integer" id="S3.SS2.p9.6.m3.1.1.3.cmml" xref="S3.SS2.p9.6.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p9.6.m3.1c">z_{j}^{size}&lt;0</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p9.6.m3.1d">italic_z start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_s italic_i italic_z italic_e end_POSTSUPERSCRIPT &lt; 0</annotation></semantics></math> for small masks. The magnitude of this
penalty is controlled by <math id="S3.SS2.p9.7.m4.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S3.SS2.p9.7.m4.1a"><mi id="S3.SS2.p9.7.m4.1.1" xref="S3.SS2.p9.7.m4.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p9.7.m4.1b"><ci id="S3.SS2.p9.7.m4.1.1.cmml" xref="S3.SS2.p9.7.m4.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p9.7.m4.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p9.7.m4.1d">italic_λ</annotation></semantics></math>. Due to the normalization, <math id="S3.SS2.p9.8.m5.1" class="ltx_Math" alttext="\mathbf{W}" display="inline"><semantics id="S3.SS2.p9.8.m5.1a"><mi id="S3.SS2.p9.8.m5.1.1" xref="S3.SS2.p9.8.m5.1.1.cmml">𝐖</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p9.8.m5.1b"><ci id="S3.SS2.p9.8.m5.1.1.cmml" xref="S3.SS2.p9.8.m5.1.1">𝐖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p9.8.m5.1c">\mathbf{W}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p9.8.m5.1d">bold_W</annotation></semantics></math> used in
GWP is invariant to the masks size <math id="S3.SS2.p9.9.m6.1" class="ltx_Math" alttext="\mathbf{M}" display="inline"><semantics id="S3.SS2.p9.9.m6.1a"><mi id="S3.SS2.p9.9.m6.1.1" xref="S3.SS2.p9.9.m6.1.1.cmml">𝐌</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p9.9.m6.1b"><ci id="S3.SS2.p9.9.m6.1.1.cmml" xref="S3.SS2.p9.9.m6.1.1">𝐌</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p9.9.m6.1c">\mathbf{M}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p9.9.m6.1d">bold_M</annotation></semantics></math> and <math id="S3.SS2.p9.10.m7.1" class="ltx_Math" alttext="\mathbf{z}^{size}" display="inline"><semantics id="S3.SS2.p9.10.m7.1a"><msup id="S3.SS2.p9.10.m7.1.1" xref="S3.SS2.p9.10.m7.1.1.cmml"><mi id="S3.SS2.p9.10.m7.1.1.2" xref="S3.SS2.p9.10.m7.1.1.2.cmml">𝐳</mi><mrow id="S3.SS2.p9.10.m7.1.1.3" xref="S3.SS2.p9.10.m7.1.1.3.cmml"><mi id="S3.SS2.p9.10.m7.1.1.3.2" xref="S3.SS2.p9.10.m7.1.1.3.2.cmml">s</mi><mo id="S3.SS2.p9.10.m7.1.1.3.1" xref="S3.SS2.p9.10.m7.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p9.10.m7.1.1.3.3" xref="S3.SS2.p9.10.m7.1.1.3.3.cmml">i</mi><mo id="S3.SS2.p9.10.m7.1.1.3.1a" xref="S3.SS2.p9.10.m7.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p9.10.m7.1.1.3.4" xref="S3.SS2.p9.10.m7.1.1.3.4.cmml">z</mi><mo id="S3.SS2.p9.10.m7.1.1.3.1b" xref="S3.SS2.p9.10.m7.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p9.10.m7.1.1.3.5" xref="S3.SS2.p9.10.m7.1.1.3.5.cmml">e</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p9.10.m7.1b"><apply id="S3.SS2.p9.10.m7.1.1.cmml" xref="S3.SS2.p9.10.m7.1.1"><csymbol cd="ambiguous" id="S3.SS2.p9.10.m7.1.1.1.cmml" xref="S3.SS2.p9.10.m7.1.1">superscript</csymbol><ci id="S3.SS2.p9.10.m7.1.1.2.cmml" xref="S3.SS2.p9.10.m7.1.1.2">𝐳</ci><apply id="S3.SS2.p9.10.m7.1.1.3.cmml" xref="S3.SS2.p9.10.m7.1.1.3"><times id="S3.SS2.p9.10.m7.1.1.3.1.cmml" xref="S3.SS2.p9.10.m7.1.1.3.1"></times><ci id="S3.SS2.p9.10.m7.1.1.3.2.cmml" xref="S3.SS2.p9.10.m7.1.1.3.2">𝑠</ci><ci id="S3.SS2.p9.10.m7.1.1.3.3.cmml" xref="S3.SS2.p9.10.m7.1.1.3.3">𝑖</ci><ci id="S3.SS2.p9.10.m7.1.1.3.4.cmml" xref="S3.SS2.p9.10.m7.1.1.3.4">𝑧</ci><ci id="S3.SS2.p9.10.m7.1.1.3.5.cmml" xref="S3.SS2.p9.10.m7.1.1.3.5">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p9.10.m7.1c">\mathbf{z}^{size}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p9.10.m7.1d">bold_z start_POSTSUPERSCRIPT italic_s italic_i italic_z italic_e end_POSTSUPERSCRIPT</annotation></semantics></math> enforces masks
to be complete. The final score defining the presence of a referring expression
<math id="S3.SS2.p9.11.m8.1" class="ltx_Math" alttext="t_{j}" display="inline"><semantics id="S3.SS2.p9.11.m8.1a"><msub id="S3.SS2.p9.11.m8.1.1" xref="S3.SS2.p9.11.m8.1.1.cmml"><mi id="S3.SS2.p9.11.m8.1.1.2" xref="S3.SS2.p9.11.m8.1.1.2.cmml">t</mi><mi id="S3.SS2.p9.11.m8.1.1.3" xref="S3.SS2.p9.11.m8.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p9.11.m8.1b"><apply id="S3.SS2.p9.11.m8.1.1.cmml" xref="S3.SS2.p9.11.m8.1.1"><csymbol cd="ambiguous" id="S3.SS2.p9.11.m8.1.1.1.cmml" xref="S3.SS2.p9.11.m8.1.1">subscript</csymbol><ci id="S3.SS2.p9.11.m8.1.1.2.cmml" xref="S3.SS2.p9.11.m8.1.1.2">𝑡</ci><ci id="S3.SS2.p9.11.m8.1.1.3.cmml" xref="S3.SS2.p9.11.m8.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p9.11.m8.1c">t_{j}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p9.11.m8.1d">italic_t start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> in the image is defined as the sum:</p>
<table id="S3.E8" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E8.m1.1" class="ltx_Math" alttext="z_{j}=z^{GWP}_{j}+z^{size}_{j}." display="block"><semantics id="S3.E8.m1.1a"><mrow id="S3.E8.m1.1.1.1" xref="S3.E8.m1.1.1.1.1.cmml"><mrow id="S3.E8.m1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.cmml"><msub id="S3.E8.m1.1.1.1.1.2" xref="S3.E8.m1.1.1.1.1.2.cmml"><mi id="S3.E8.m1.1.1.1.1.2.2" xref="S3.E8.m1.1.1.1.1.2.2.cmml">z</mi><mi id="S3.E8.m1.1.1.1.1.2.3" xref="S3.E8.m1.1.1.1.1.2.3.cmml">j</mi></msub><mo id="S3.E8.m1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E8.m1.1.1.1.1.3" xref="S3.E8.m1.1.1.1.1.3.cmml"><msubsup id="S3.E8.m1.1.1.1.1.3.2" xref="S3.E8.m1.1.1.1.1.3.2.cmml"><mi id="S3.E8.m1.1.1.1.1.3.2.2.2" xref="S3.E8.m1.1.1.1.1.3.2.2.2.cmml">z</mi><mi id="S3.E8.m1.1.1.1.1.3.2.3" xref="S3.E8.m1.1.1.1.1.3.2.3.cmml">j</mi><mrow id="S3.E8.m1.1.1.1.1.3.2.2.3" xref="S3.E8.m1.1.1.1.1.3.2.2.3.cmml"><mi id="S3.E8.m1.1.1.1.1.3.2.2.3.2" xref="S3.E8.m1.1.1.1.1.3.2.2.3.2.cmml">G</mi><mo id="S3.E8.m1.1.1.1.1.3.2.2.3.1" xref="S3.E8.m1.1.1.1.1.3.2.2.3.1.cmml">⁢</mo><mi id="S3.E8.m1.1.1.1.1.3.2.2.3.3" xref="S3.E8.m1.1.1.1.1.3.2.2.3.3.cmml">W</mi><mo id="S3.E8.m1.1.1.1.1.3.2.2.3.1a" xref="S3.E8.m1.1.1.1.1.3.2.2.3.1.cmml">⁢</mo><mi id="S3.E8.m1.1.1.1.1.3.2.2.3.4" xref="S3.E8.m1.1.1.1.1.3.2.2.3.4.cmml">P</mi></mrow></msubsup><mo id="S3.E8.m1.1.1.1.1.3.1" xref="S3.E8.m1.1.1.1.1.3.1.cmml">+</mo><msubsup id="S3.E8.m1.1.1.1.1.3.3" xref="S3.E8.m1.1.1.1.1.3.3.cmml"><mi id="S3.E8.m1.1.1.1.1.3.3.2.2" xref="S3.E8.m1.1.1.1.1.3.3.2.2.cmml">z</mi><mi id="S3.E8.m1.1.1.1.1.3.3.3" xref="S3.E8.m1.1.1.1.1.3.3.3.cmml">j</mi><mrow id="S3.E8.m1.1.1.1.1.3.3.2.3" xref="S3.E8.m1.1.1.1.1.3.3.2.3.cmml"><mi id="S3.E8.m1.1.1.1.1.3.3.2.3.2" xref="S3.E8.m1.1.1.1.1.3.3.2.3.2.cmml">s</mi><mo id="S3.E8.m1.1.1.1.1.3.3.2.3.1" xref="S3.E8.m1.1.1.1.1.3.3.2.3.1.cmml">⁢</mo><mi id="S3.E8.m1.1.1.1.1.3.3.2.3.3" xref="S3.E8.m1.1.1.1.1.3.3.2.3.3.cmml">i</mi><mo id="S3.E8.m1.1.1.1.1.3.3.2.3.1a" xref="S3.E8.m1.1.1.1.1.3.3.2.3.1.cmml">⁢</mo><mi id="S3.E8.m1.1.1.1.1.3.3.2.3.4" xref="S3.E8.m1.1.1.1.1.3.3.2.3.4.cmml">z</mi><mo id="S3.E8.m1.1.1.1.1.3.3.2.3.1b" xref="S3.E8.m1.1.1.1.1.3.3.2.3.1.cmml">⁢</mo><mi id="S3.E8.m1.1.1.1.1.3.3.2.3.5" xref="S3.E8.m1.1.1.1.1.3.3.2.3.5.cmml">e</mi></mrow></msubsup></mrow></mrow><mo id="S3.E8.m1.1.1.1.2" xref="S3.E8.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m1.1b"><apply id="S3.E8.m1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1"><eq id="S3.E8.m1.1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1.1"></eq><apply id="S3.E8.m1.1.1.1.1.2.cmml" xref="S3.E8.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.2.1.cmml" xref="S3.E8.m1.1.1.1.1.2">subscript</csymbol><ci id="S3.E8.m1.1.1.1.1.2.2.cmml" xref="S3.E8.m1.1.1.1.1.2.2">𝑧</ci><ci id="S3.E8.m1.1.1.1.1.2.3.cmml" xref="S3.E8.m1.1.1.1.1.2.3">𝑗</ci></apply><apply id="S3.E8.m1.1.1.1.1.3.cmml" xref="S3.E8.m1.1.1.1.1.3"><plus id="S3.E8.m1.1.1.1.1.3.1.cmml" xref="S3.E8.m1.1.1.1.1.3.1"></plus><apply id="S3.E8.m1.1.1.1.1.3.2.cmml" xref="S3.E8.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.3.2.1.cmml" xref="S3.E8.m1.1.1.1.1.3.2">subscript</csymbol><apply id="S3.E8.m1.1.1.1.1.3.2.2.cmml" xref="S3.E8.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.3.2.2.1.cmml" xref="S3.E8.m1.1.1.1.1.3.2">superscript</csymbol><ci id="S3.E8.m1.1.1.1.1.3.2.2.2.cmml" xref="S3.E8.m1.1.1.1.1.3.2.2.2">𝑧</ci><apply id="S3.E8.m1.1.1.1.1.3.2.2.3.cmml" xref="S3.E8.m1.1.1.1.1.3.2.2.3"><times id="S3.E8.m1.1.1.1.1.3.2.2.3.1.cmml" xref="S3.E8.m1.1.1.1.1.3.2.2.3.1"></times><ci id="S3.E8.m1.1.1.1.1.3.2.2.3.2.cmml" xref="S3.E8.m1.1.1.1.1.3.2.2.3.2">𝐺</ci><ci id="S3.E8.m1.1.1.1.1.3.2.2.3.3.cmml" xref="S3.E8.m1.1.1.1.1.3.2.2.3.3">𝑊</ci><ci id="S3.E8.m1.1.1.1.1.3.2.2.3.4.cmml" xref="S3.E8.m1.1.1.1.1.3.2.2.3.4">𝑃</ci></apply></apply><ci id="S3.E8.m1.1.1.1.1.3.2.3.cmml" xref="S3.E8.m1.1.1.1.1.3.2.3">𝑗</ci></apply><apply id="S3.E8.m1.1.1.1.1.3.3.cmml" xref="S3.E8.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.3.3.1.cmml" xref="S3.E8.m1.1.1.1.1.3.3">subscript</csymbol><apply id="S3.E8.m1.1.1.1.1.3.3.2.cmml" xref="S3.E8.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.3.3.2.1.cmml" xref="S3.E8.m1.1.1.1.1.3.3">superscript</csymbol><ci id="S3.E8.m1.1.1.1.1.3.3.2.2.cmml" xref="S3.E8.m1.1.1.1.1.3.3.2.2">𝑧</ci><apply id="S3.E8.m1.1.1.1.1.3.3.2.3.cmml" xref="S3.E8.m1.1.1.1.1.3.3.2.3"><times id="S3.E8.m1.1.1.1.1.3.3.2.3.1.cmml" xref="S3.E8.m1.1.1.1.1.3.3.2.3.1"></times><ci id="S3.E8.m1.1.1.1.1.3.3.2.3.2.cmml" xref="S3.E8.m1.1.1.1.1.3.3.2.3.2">𝑠</ci><ci id="S3.E8.m1.1.1.1.1.3.3.2.3.3.cmml" xref="S3.E8.m1.1.1.1.1.3.3.2.3.3">𝑖</ci><ci id="S3.E8.m1.1.1.1.1.3.3.2.3.4.cmml" xref="S3.E8.m1.1.1.1.1.3.3.2.3.4">𝑧</ci><ci id="S3.E8.m1.1.1.1.1.3.3.2.3.5.cmml" xref="S3.E8.m1.1.1.1.1.3.3.2.3.5">𝑒</ci></apply></apply><ci id="S3.E8.m1.1.1.1.1.3.3.3.cmml" xref="S3.E8.m1.1.1.1.1.3.3.3">𝑗</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.1c">z_{j}=z^{GWP}_{j}+z^{size}_{j}.</annotation><annotation encoding="application/x-llamapun" id="S3.E8.m1.1d">italic_z start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT = italic_z start_POSTSUPERSCRIPT italic_G italic_W italic_P end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT + italic_z start_POSTSUPERSCRIPT italic_s italic_i italic_z italic_e end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr>
</table>
</div>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Training and inference</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.1" class="ltx_p">In the following we describe our weakly supervised and fully supervised training
procedure. Furthermore, we present the approach used for inference.</p>
</div>
<div id="S3.SS3.p2" class="ltx_para ltx_noindent">
<p id="S3.SS3.p2.3" class="ltx_p"><span id="S3.SS3.p2.3.1" class="ltx_text ltx_font_bold">Weakly-supervised learning.</span> Weakly-supervised segmentation is
usually addressed on datasets with a fixed number of classes. To handle the more
general case where visual entities in the image are defined by referring
expressions we use referring expressions of samples in a mini-batch as positive
and negative examples. Given a mini-batch containing (image, referring
expression) pairs, the model has to predict the subset of referring expressions
present in each image. For each image, we extract image-text scores
<math id="S3.SS3.p2.1.m1.1" class="ltx_Math" alttext="\mathbf{z}\in\mathbb{R}^{L}" display="inline"><semantics id="S3.SS3.p2.1.m1.1a"><mrow id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml"><mi id="S3.SS3.p2.1.m1.1.1.2" xref="S3.SS3.p2.1.m1.1.1.2.cmml">𝐳</mi><mo id="S3.SS3.p2.1.m1.1.1.1" xref="S3.SS3.p2.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS3.p2.1.m1.1.1.3" xref="S3.SS3.p2.1.m1.1.1.3.cmml"><mi id="S3.SS3.p2.1.m1.1.1.3.2" xref="S3.SS3.p2.1.m1.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS3.p2.1.m1.1.1.3.3" xref="S3.SS3.p2.1.m1.1.1.3.3.cmml">L</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.1b"><apply id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1"><in id="S3.SS3.p2.1.m1.1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1.1"></in><ci id="S3.SS3.p2.1.m1.1.1.2.cmml" xref="S3.SS3.p2.1.m1.1.1.2">𝐳</ci><apply id="S3.SS3.p2.1.m1.1.1.3.cmml" xref="S3.SS3.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p2.1.m1.1.1.3.1.cmml" xref="S3.SS3.p2.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS3.p2.1.m1.1.1.3.2.cmml" xref="S3.SS3.p2.1.m1.1.1.3.2">ℝ</ci><ci id="S3.SS3.p2.1.m1.1.1.3.3.cmml" xref="S3.SS3.p2.1.m1.1.1.3.3">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.1c">\mathbf{z}\in\mathbb{R}^{L}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.1.m1.1d">bold_z ∈ blackboard_R start_POSTSUPERSCRIPT italic_L end_POSTSUPERSCRIPT</annotation></semantics></math> from the similarity matrix <math id="S3.SS3.p2.2.m2.1" class="ltx_Math" alttext="\mathbf{S}" display="inline"><semantics id="S3.SS3.p2.2.m2.1a"><mi id="S3.SS3.p2.2.m2.1.1" xref="S3.SS3.p2.2.m2.1.1.cmml">𝐒</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m2.1b"><ci id="S3.SS3.p2.2.m2.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1">𝐒</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.m2.1c">\mathbf{S}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.2.m2.1d">bold_S</annotation></semantics></math> using one of
the pooling mechanism described in the previous section. Finally, we optimize
over the scores to match ground truth pairings <math id="S3.SS3.p2.3.m3.1" class="ltx_Math" alttext="\mkern 1.5mu\overline{\mkern-1.5mu\mathbf{z}\mkern-1.5mu}\mkern 1.5mu" display="inline"><semantics id="S3.SS3.p2.3.m3.1a"><mpadded lspace="0.8pt" width="+1.6pt" id="S3.SS3.p2.3.m3.1.1" xref="S3.SS3.p2.3.m3.1.1.cmml"><mover accent="true" id="S3.SS3.p2.3.m3.1.1a" xref="S3.SS3.p2.3.m3.1.1.cmml"><mpadded lspace="-0.8pt" width="-1.6pt" id="S3.SS3.p2.3.m3.1.1.2" xref="S3.SS3.p2.3.m3.1.1.2.cmml"><mi id="S3.SS3.p2.3.m3.1.1.2a" xref="S3.SS3.p2.3.m3.1.1.2.cmml">𝐳</mi></mpadded><mo id="S3.SS3.p2.3.m3.1.1.1" xref="S3.SS3.p2.3.m3.1.1.1.cmml">¯</mo></mover></mpadded><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.3.m3.1b"><apply id="S3.SS3.p2.3.m3.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1"><ci id="S3.SS3.p2.3.m3.1.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1.1">¯</ci><ci id="S3.SS3.p2.3.m3.1.1.2.cmml" xref="S3.SS3.p2.3.m3.1.1.2">𝐳</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.3.m3.1c">\mkern 1.5mu\overline{\mkern-1.5mu\mathbf{z}\mkern-1.5mu}\mkern 1.5mu</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.3.m3.1d">over¯ start_ARG bold_z end_ARG</annotation></semantics></math> with the
multi-label soft-margin loss function <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib58" title="" class="ltx_ref">58</a>]</cite> as a
classification loss,</p>
<table id="S7.EGx1" class="ltx_equationgroup ltx_eqn_eqnarray ltx_eqn_table">

<tbody id="S3.Ex1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.Ex1.m1.5" class="ltx_Math" alttext="\displaystyle\mathcal{L}_{cls}(\mathbf{z},\mkern 1.5mu\overline{\mkern-1.5mu%
\mathbf{z}\mkern-1.5mu}\mkern 1.5mu)=\sum_{j=1}^{L}-\mkern 1.5mu\overline{%
\mkern-1.5muz\mkern-1.5mu}\mkern 1.5mu_{j}\log\left(\sigma(z_{j})\right)-(1-%
\mkern 1.5mu\overline{\mkern-1.5muz\mkern-1.5mu}\mkern 1.5mu_{j})\log\left(%
\sigma(-z_{j})\right)," display="inline"><semantics id="S3.Ex1.m1.5a"><mrow id="S3.Ex1.m1.5.5.1" xref="S3.Ex1.m1.5.5.1.1.cmml"><mrow id="S3.Ex1.m1.5.5.1.1" xref="S3.Ex1.m1.5.5.1.1.cmml"><mrow id="S3.Ex1.m1.5.5.1.1.5" xref="S3.Ex1.m1.5.5.1.1.5.cmml"><msub id="S3.Ex1.m1.5.5.1.1.5.2" xref="S3.Ex1.m1.5.5.1.1.5.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.Ex1.m1.5.5.1.1.5.2.2" xref="S3.Ex1.m1.5.5.1.1.5.2.2.cmml">ℒ</mi><mrow id="S3.Ex1.m1.5.5.1.1.5.2.3" xref="S3.Ex1.m1.5.5.1.1.5.2.3.cmml"><mi id="S3.Ex1.m1.5.5.1.1.5.2.3.2" xref="S3.Ex1.m1.5.5.1.1.5.2.3.2.cmml">c</mi><mo id="S3.Ex1.m1.5.5.1.1.5.2.3.1" xref="S3.Ex1.m1.5.5.1.1.5.2.3.1.cmml">⁢</mo><mi id="S3.Ex1.m1.5.5.1.1.5.2.3.3" xref="S3.Ex1.m1.5.5.1.1.5.2.3.3.cmml">l</mi><mo id="S3.Ex1.m1.5.5.1.1.5.2.3.1a" xref="S3.Ex1.m1.5.5.1.1.5.2.3.1.cmml">⁢</mo><mi id="S3.Ex1.m1.5.5.1.1.5.2.3.4" xref="S3.Ex1.m1.5.5.1.1.5.2.3.4.cmml">s</mi></mrow></msub><mo id="S3.Ex1.m1.5.5.1.1.5.1" xref="S3.Ex1.m1.5.5.1.1.5.1.cmml">⁢</mo><mrow id="S3.Ex1.m1.5.5.1.1.5.3.2" xref="S3.Ex1.m1.5.5.1.1.5.3.1.cmml"><mo stretchy="false" id="S3.Ex1.m1.5.5.1.1.5.3.2.1" xref="S3.Ex1.m1.5.5.1.1.5.3.1.cmml">(</mo><mi id="S3.Ex1.m1.1.1" xref="S3.Ex1.m1.1.1.cmml">𝐳</mi><mo rspace="3.3pt" id="S3.Ex1.m1.5.5.1.1.5.3.2.2" xref="S3.Ex1.m1.5.5.1.1.5.3.1.cmml">,</mo><mpadded width="+0.8pt" id="S3.Ex1.m1.2.2" xref="S3.Ex1.m1.2.2.cmml"><mover accent="true" id="S3.Ex1.m1.2.2a" xref="S3.Ex1.m1.2.2.cmml"><mpadded lspace="-0.8pt" width="-1.6pt" id="S3.Ex1.m1.2.2.2" xref="S3.Ex1.m1.2.2.2.cmml"><mi id="S3.Ex1.m1.2.2.2a" xref="S3.Ex1.m1.2.2.2.cmml">𝐳</mi></mpadded><mo id="S3.Ex1.m1.2.2.1" xref="S3.Ex1.m1.2.2.1.cmml">¯</mo></mover></mpadded><mo stretchy="false" id="S3.Ex1.m1.5.5.1.1.5.3.2.3" xref="S3.Ex1.m1.5.5.1.1.5.3.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex1.m1.5.5.1.1.4" xref="S3.Ex1.m1.5.5.1.1.4.cmml">=</mo><mrow id="S3.Ex1.m1.5.5.1.1.3" xref="S3.Ex1.m1.5.5.1.1.3.cmml"><mstyle displaystyle="true" id="S3.Ex1.m1.5.5.1.1.3.5" xref="S3.Ex1.m1.5.5.1.1.3.5.cmml"><munderover id="S3.Ex1.m1.5.5.1.1.3.5a" xref="S3.Ex1.m1.5.5.1.1.3.5.cmml"><mo largeop="true" movablelimits="false" symmetric="true" id="S3.Ex1.m1.5.5.1.1.3.5.2.2" xref="S3.Ex1.m1.5.5.1.1.3.5.2.2.cmml">∑</mo><mrow id="S3.Ex1.m1.5.5.1.1.3.5.2.3" xref="S3.Ex1.m1.5.5.1.1.3.5.2.3.cmml"><mi id="S3.Ex1.m1.5.5.1.1.3.5.2.3.2" xref="S3.Ex1.m1.5.5.1.1.3.5.2.3.2.cmml">j</mi><mo id="S3.Ex1.m1.5.5.1.1.3.5.2.3.1" xref="S3.Ex1.m1.5.5.1.1.3.5.2.3.1.cmml">=</mo><mn id="S3.Ex1.m1.5.5.1.1.3.5.2.3.3" xref="S3.Ex1.m1.5.5.1.1.3.5.2.3.3.cmml">1</mn></mrow><mi id="S3.Ex1.m1.5.5.1.1.3.5.3" xref="S3.Ex1.m1.5.5.1.1.3.5.3.cmml">L</mi></munderover></mstyle><mo rspace="3.3pt" id="S3.Ex1.m1.5.5.1.1.3.4" xref="S3.Ex1.m1.5.5.1.1.3.4.cmml">-</mo><mrow id="S3.Ex1.m1.5.5.1.1.1.1" xref="S3.Ex1.m1.5.5.1.1.1.1.cmml"><msub id="S3.Ex1.m1.5.5.1.1.1.1.3" xref="S3.Ex1.m1.5.5.1.1.1.1.3.cmml"><mpadded width="+0.8pt" id="S3.Ex1.m1.5.5.1.1.1.1.3.2" xref="S3.Ex1.m1.5.5.1.1.1.1.3.2.cmml"><mover accent="true" id="S3.Ex1.m1.5.5.1.1.1.1.3.2a" xref="S3.Ex1.m1.5.5.1.1.1.1.3.2.cmml"><mpadded lspace="-0.8pt" width="-1.6pt" id="S3.Ex1.m1.5.5.1.1.1.1.3.2.2" xref="S3.Ex1.m1.5.5.1.1.1.1.3.2.2.cmml"><mi id="S3.Ex1.m1.5.5.1.1.1.1.3.2.2a" xref="S3.Ex1.m1.5.5.1.1.1.1.3.2.2.cmml">z</mi></mpadded><mo id="S3.Ex1.m1.5.5.1.1.1.1.3.2.1" xref="S3.Ex1.m1.5.5.1.1.1.1.3.2.1.cmml">¯</mo></mover></mpadded><mi id="S3.Ex1.m1.5.5.1.1.1.1.3.3" xref="S3.Ex1.m1.5.5.1.1.1.1.3.3.cmml">j</mi></msub><mo id="S3.Ex1.m1.5.5.1.1.1.1.2" xref="S3.Ex1.m1.5.5.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.Ex1.m1.5.5.1.1.1.1.1.1" xref="S3.Ex1.m1.5.5.1.1.1.1.1.2.cmml"><mi id="S3.Ex1.m1.3.3" xref="S3.Ex1.m1.3.3.cmml">log</mi><mo id="S3.Ex1.m1.5.5.1.1.1.1.1.1a" xref="S3.Ex1.m1.5.5.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S3.Ex1.m1.5.5.1.1.1.1.1.1.1" xref="S3.Ex1.m1.5.5.1.1.1.1.1.2.cmml"><mo id="S3.Ex1.m1.5.5.1.1.1.1.1.1.1.2" xref="S3.Ex1.m1.5.5.1.1.1.1.1.2.cmml">(</mo><mrow id="S3.Ex1.m1.5.5.1.1.1.1.1.1.1.1" xref="S3.Ex1.m1.5.5.1.1.1.1.1.1.1.1.cmml"><mi id="S3.Ex1.m1.5.5.1.1.1.1.1.1.1.1.3" xref="S3.Ex1.m1.5.5.1.1.1.1.1.1.1.1.3.cmml">σ</mi><mo id="S3.Ex1.m1.5.5.1.1.1.1.1.1.1.1.2" xref="S3.Ex1.m1.5.5.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.Ex1.m1.5.5.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.Ex1.m1.5.5.1.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.Ex1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.Ex1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2.cmml">z</mi><mi id="S3.Ex1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.Ex1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo stretchy="false" id="S3.Ex1.m1.5.5.1.1.1.1.1.1.1.1.1.1.3" xref="S3.Ex1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex1.m1.5.5.1.1.1.1.1.1.1.3" xref="S3.Ex1.m1.5.5.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo rspace="3.3pt" id="S3.Ex1.m1.5.5.1.1.3.4a" xref="S3.Ex1.m1.5.5.1.1.3.4.cmml">-</mo><mrow id="S3.Ex1.m1.5.5.1.1.3.3" xref="S3.Ex1.m1.5.5.1.1.3.3.cmml"><mrow id="S3.Ex1.m1.5.5.1.1.2.2.1.1" xref="S3.Ex1.m1.5.5.1.1.2.2.1.1.1.cmml"><mo stretchy="false" id="S3.Ex1.m1.5.5.1.1.2.2.1.1.2" xref="S3.Ex1.m1.5.5.1.1.2.2.1.1.1.cmml">(</mo><mrow id="S3.Ex1.m1.5.5.1.1.2.2.1.1.1" xref="S3.Ex1.m1.5.5.1.1.2.2.1.1.1.cmml"><mn id="S3.Ex1.m1.5.5.1.1.2.2.1.1.1.2" xref="S3.Ex1.m1.5.5.1.1.2.2.1.1.1.2.cmml">1</mn><mo rspace="3.3pt" id="S3.Ex1.m1.5.5.1.1.2.2.1.1.1.1" xref="S3.Ex1.m1.5.5.1.1.2.2.1.1.1.1.cmml">-</mo><msub id="S3.Ex1.m1.5.5.1.1.2.2.1.1.1.3" xref="S3.Ex1.m1.5.5.1.1.2.2.1.1.1.3.cmml"><mpadded width="+0.8pt" id="S3.Ex1.m1.5.5.1.1.2.2.1.1.1.3.2" xref="S3.Ex1.m1.5.5.1.1.2.2.1.1.1.3.2.cmml"><mover accent="true" id="S3.Ex1.m1.5.5.1.1.2.2.1.1.1.3.2a" xref="S3.Ex1.m1.5.5.1.1.2.2.1.1.1.3.2.cmml"><mpadded lspace="-0.8pt" width="-1.6pt" id="S3.Ex1.m1.5.5.1.1.2.2.1.1.1.3.2.2" xref="S3.Ex1.m1.5.5.1.1.2.2.1.1.1.3.2.2.cmml"><mi id="S3.Ex1.m1.5.5.1.1.2.2.1.1.1.3.2.2a" xref="S3.Ex1.m1.5.5.1.1.2.2.1.1.1.3.2.2.cmml">z</mi></mpadded><mo id="S3.Ex1.m1.5.5.1.1.2.2.1.1.1.3.2.1" xref="S3.Ex1.m1.5.5.1.1.2.2.1.1.1.3.2.1.cmml">¯</mo></mover></mpadded><mi id="S3.Ex1.m1.5.5.1.1.2.2.1.1.1.3.3" xref="S3.Ex1.m1.5.5.1.1.2.2.1.1.1.3.3.cmml">j</mi></msub></mrow><mo stretchy="false" id="S3.Ex1.m1.5.5.1.1.2.2.1.1.3" xref="S3.Ex1.m1.5.5.1.1.2.2.1.1.1.cmml">)</mo></mrow><mo id="S3.Ex1.m1.5.5.1.1.3.3.3" xref="S3.Ex1.m1.5.5.1.1.3.3.3.cmml">⁢</mo><mrow id="S3.Ex1.m1.5.5.1.1.3.3.2.1" xref="S3.Ex1.m1.5.5.1.1.3.3.2.2.cmml"><mi id="S3.Ex1.m1.4.4" xref="S3.Ex1.m1.4.4.cmml">log</mi><mo id="S3.Ex1.m1.5.5.1.1.3.3.2.1a" xref="S3.Ex1.m1.5.5.1.1.3.3.2.2.cmml">⁡</mo><mrow id="S3.Ex1.m1.5.5.1.1.3.3.2.1.1" xref="S3.Ex1.m1.5.5.1.1.3.3.2.2.cmml"><mo id="S3.Ex1.m1.5.5.1.1.3.3.2.1.1.2" xref="S3.Ex1.m1.5.5.1.1.3.3.2.2.cmml">(</mo><mrow id="S3.Ex1.m1.5.5.1.1.3.3.2.1.1.1" xref="S3.Ex1.m1.5.5.1.1.3.3.2.1.1.1.cmml"><mi id="S3.Ex1.m1.5.5.1.1.3.3.2.1.1.1.3" xref="S3.Ex1.m1.5.5.1.1.3.3.2.1.1.1.3.cmml">σ</mi><mo id="S3.Ex1.m1.5.5.1.1.3.3.2.1.1.1.2" xref="S3.Ex1.m1.5.5.1.1.3.3.2.1.1.1.2.cmml">⁢</mo><mrow id="S3.Ex1.m1.5.5.1.1.3.3.2.1.1.1.1.1" xref="S3.Ex1.m1.5.5.1.1.3.3.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.Ex1.m1.5.5.1.1.3.3.2.1.1.1.1.1.2" xref="S3.Ex1.m1.5.5.1.1.3.3.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex1.m1.5.5.1.1.3.3.2.1.1.1.1.1.1" xref="S3.Ex1.m1.5.5.1.1.3.3.2.1.1.1.1.1.1.cmml"><mo id="S3.Ex1.m1.5.5.1.1.3.3.2.1.1.1.1.1.1.1" xref="S3.Ex1.m1.5.5.1.1.3.3.2.1.1.1.1.1.1.1.cmml">-</mo><msub id="S3.Ex1.m1.5.5.1.1.3.3.2.1.1.1.1.1.1.2" xref="S3.Ex1.m1.5.5.1.1.3.3.2.1.1.1.1.1.1.2.cmml"><mi id="S3.Ex1.m1.5.5.1.1.3.3.2.1.1.1.1.1.1.2.2" xref="S3.Ex1.m1.5.5.1.1.3.3.2.1.1.1.1.1.1.2.2.cmml">z</mi><mi id="S3.Ex1.m1.5.5.1.1.3.3.2.1.1.1.1.1.1.2.3" xref="S3.Ex1.m1.5.5.1.1.3.3.2.1.1.1.1.1.1.2.3.cmml">j</mi></msub></mrow><mo stretchy="false" id="S3.Ex1.m1.5.5.1.1.3.3.2.1.1.1.1.1.3" xref="S3.Ex1.m1.5.5.1.1.3.3.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex1.m1.5.5.1.1.3.3.2.1.1.3" xref="S3.Ex1.m1.5.5.1.1.3.3.2.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S3.Ex1.m1.5.5.1.2" xref="S3.Ex1.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1.m1.5b"><apply id="S3.Ex1.m1.5.5.1.1.cmml" xref="S3.Ex1.m1.5.5.1"><eq id="S3.Ex1.m1.5.5.1.1.4.cmml" xref="S3.Ex1.m1.5.5.1.1.4"></eq><apply id="S3.Ex1.m1.5.5.1.1.5.cmml" xref="S3.Ex1.m1.5.5.1.1.5"><times id="S3.Ex1.m1.5.5.1.1.5.1.cmml" xref="S3.Ex1.m1.5.5.1.1.5.1"></times><apply id="S3.Ex1.m1.5.5.1.1.5.2.cmml" xref="S3.Ex1.m1.5.5.1.1.5.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.5.5.1.1.5.2.1.cmml" xref="S3.Ex1.m1.5.5.1.1.5.2">subscript</csymbol><ci id="S3.Ex1.m1.5.5.1.1.5.2.2.cmml" xref="S3.Ex1.m1.5.5.1.1.5.2.2">ℒ</ci><apply id="S3.Ex1.m1.5.5.1.1.5.2.3.cmml" xref="S3.Ex1.m1.5.5.1.1.5.2.3"><times id="S3.Ex1.m1.5.5.1.1.5.2.3.1.cmml" xref="S3.Ex1.m1.5.5.1.1.5.2.3.1"></times><ci id="S3.Ex1.m1.5.5.1.1.5.2.3.2.cmml" xref="S3.Ex1.m1.5.5.1.1.5.2.3.2">𝑐</ci><ci id="S3.Ex1.m1.5.5.1.1.5.2.3.3.cmml" xref="S3.Ex1.m1.5.5.1.1.5.2.3.3">𝑙</ci><ci id="S3.Ex1.m1.5.5.1.1.5.2.3.4.cmml" xref="S3.Ex1.m1.5.5.1.1.5.2.3.4">𝑠</ci></apply></apply><interval closure="open" id="S3.Ex1.m1.5.5.1.1.5.3.1.cmml" xref="S3.Ex1.m1.5.5.1.1.5.3.2"><ci id="S3.Ex1.m1.1.1.cmml" xref="S3.Ex1.m1.1.1">𝐳</ci><apply id="S3.Ex1.m1.2.2.cmml" xref="S3.Ex1.m1.2.2"><ci id="S3.Ex1.m1.2.2.1.cmml" xref="S3.Ex1.m1.2.2.1">¯</ci><ci id="S3.Ex1.m1.2.2.2.cmml" xref="S3.Ex1.m1.2.2.2">𝐳</ci></apply></interval></apply><apply id="S3.Ex1.m1.5.5.1.1.3.cmml" xref="S3.Ex1.m1.5.5.1.1.3"><minus id="S3.Ex1.m1.5.5.1.1.3.4.cmml" xref="S3.Ex1.m1.5.5.1.1.3.4"></minus><apply id="S3.Ex1.m1.5.5.1.1.3.5.cmml" xref="S3.Ex1.m1.5.5.1.1.3.5"><csymbol cd="ambiguous" id="S3.Ex1.m1.5.5.1.1.3.5.1.cmml" xref="S3.Ex1.m1.5.5.1.1.3.5">superscript</csymbol><apply id="S3.Ex1.m1.5.5.1.1.3.5.2.cmml" xref="S3.Ex1.m1.5.5.1.1.3.5"><csymbol cd="ambiguous" id="S3.Ex1.m1.5.5.1.1.3.5.2.1.cmml" xref="S3.Ex1.m1.5.5.1.1.3.5">subscript</csymbol><sum id="S3.Ex1.m1.5.5.1.1.3.5.2.2.cmml" xref="S3.Ex1.m1.5.5.1.1.3.5.2.2"></sum><apply id="S3.Ex1.m1.5.5.1.1.3.5.2.3.cmml" xref="S3.Ex1.m1.5.5.1.1.3.5.2.3"><eq id="S3.Ex1.m1.5.5.1.1.3.5.2.3.1.cmml" xref="S3.Ex1.m1.5.5.1.1.3.5.2.3.1"></eq><ci id="S3.Ex1.m1.5.5.1.1.3.5.2.3.2.cmml" xref="S3.Ex1.m1.5.5.1.1.3.5.2.3.2">𝑗</ci><cn type="integer" id="S3.Ex1.m1.5.5.1.1.3.5.2.3.3.cmml" xref="S3.Ex1.m1.5.5.1.1.3.5.2.3.3">1</cn></apply></apply><ci id="S3.Ex1.m1.5.5.1.1.3.5.3.cmml" xref="S3.Ex1.m1.5.5.1.1.3.5.3">𝐿</ci></apply><apply id="S3.Ex1.m1.5.5.1.1.1.1.cmml" xref="S3.Ex1.m1.5.5.1.1.1.1"><times id="S3.Ex1.m1.5.5.1.1.1.1.2.cmml" xref="S3.Ex1.m1.5.5.1.1.1.1.2"></times><apply id="S3.Ex1.m1.5.5.1.1.1.1.3.cmml" xref="S3.Ex1.m1.5.5.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.5.5.1.1.1.1.3.1.cmml" xref="S3.Ex1.m1.5.5.1.1.1.1.3">subscript</csymbol><apply id="S3.Ex1.m1.5.5.1.1.1.1.3.2.cmml" xref="S3.Ex1.m1.5.5.1.1.1.1.3.2"><ci id="S3.Ex1.m1.5.5.1.1.1.1.3.2.1.cmml" xref="S3.Ex1.m1.5.5.1.1.1.1.3.2.1">¯</ci><ci id="S3.Ex1.m1.5.5.1.1.1.1.3.2.2.cmml" xref="S3.Ex1.m1.5.5.1.1.1.1.3.2.2">𝑧</ci></apply><ci id="S3.Ex1.m1.5.5.1.1.1.1.3.3.cmml" xref="S3.Ex1.m1.5.5.1.1.1.1.3.3">𝑗</ci></apply><apply id="S3.Ex1.m1.5.5.1.1.1.1.1.2.cmml" xref="S3.Ex1.m1.5.5.1.1.1.1.1.1"><log id="S3.Ex1.m1.3.3.cmml" xref="S3.Ex1.m1.3.3"></log><apply id="S3.Ex1.m1.5.5.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.5.5.1.1.1.1.1.1.1.1"><times id="S3.Ex1.m1.5.5.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex1.m1.5.5.1.1.1.1.1.1.1.1.2"></times><ci id="S3.Ex1.m1.5.5.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex1.m1.5.5.1.1.1.1.1.1.1.1.3">𝜎</ci><apply id="S3.Ex1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.5.5.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.5.5.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.Ex1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2">𝑧</ci><ci id="S3.Ex1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3">𝑗</ci></apply></apply></apply></apply><apply id="S3.Ex1.m1.5.5.1.1.3.3.cmml" xref="S3.Ex1.m1.5.5.1.1.3.3"><times id="S3.Ex1.m1.5.5.1.1.3.3.3.cmml" xref="S3.Ex1.m1.5.5.1.1.3.3.3"></times><apply id="S3.Ex1.m1.5.5.1.1.2.2.1.1.1.cmml" xref="S3.Ex1.m1.5.5.1.1.2.2.1.1"><minus id="S3.Ex1.m1.5.5.1.1.2.2.1.1.1.1.cmml" xref="S3.Ex1.m1.5.5.1.1.2.2.1.1.1.1"></minus><cn type="integer" id="S3.Ex1.m1.5.5.1.1.2.2.1.1.1.2.cmml" xref="S3.Ex1.m1.5.5.1.1.2.2.1.1.1.2">1</cn><apply id="S3.Ex1.m1.5.5.1.1.2.2.1.1.1.3.cmml" xref="S3.Ex1.m1.5.5.1.1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.5.5.1.1.2.2.1.1.1.3.1.cmml" xref="S3.Ex1.m1.5.5.1.1.2.2.1.1.1.3">subscript</csymbol><apply id="S3.Ex1.m1.5.5.1.1.2.2.1.1.1.3.2.cmml" xref="S3.Ex1.m1.5.5.1.1.2.2.1.1.1.3.2"><ci id="S3.Ex1.m1.5.5.1.1.2.2.1.1.1.3.2.1.cmml" xref="S3.Ex1.m1.5.5.1.1.2.2.1.1.1.3.2.1">¯</ci><ci id="S3.Ex1.m1.5.5.1.1.2.2.1.1.1.3.2.2.cmml" xref="S3.Ex1.m1.5.5.1.1.2.2.1.1.1.3.2.2">𝑧</ci></apply><ci id="S3.Ex1.m1.5.5.1.1.2.2.1.1.1.3.3.cmml" xref="S3.Ex1.m1.5.5.1.1.2.2.1.1.1.3.3">𝑗</ci></apply></apply><apply id="S3.Ex1.m1.5.5.1.1.3.3.2.2.cmml" xref="S3.Ex1.m1.5.5.1.1.3.3.2.1"><log id="S3.Ex1.m1.4.4.cmml" xref="S3.Ex1.m1.4.4"></log><apply id="S3.Ex1.m1.5.5.1.1.3.3.2.1.1.1.cmml" xref="S3.Ex1.m1.5.5.1.1.3.3.2.1.1.1"><times id="S3.Ex1.m1.5.5.1.1.3.3.2.1.1.1.2.cmml" xref="S3.Ex1.m1.5.5.1.1.3.3.2.1.1.1.2"></times><ci id="S3.Ex1.m1.5.5.1.1.3.3.2.1.1.1.3.cmml" xref="S3.Ex1.m1.5.5.1.1.3.3.2.1.1.1.3">𝜎</ci><apply id="S3.Ex1.m1.5.5.1.1.3.3.2.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.5.5.1.1.3.3.2.1.1.1.1.1"><minus id="S3.Ex1.m1.5.5.1.1.3.3.2.1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.5.5.1.1.3.3.2.1.1.1.1.1.1.1"></minus><apply id="S3.Ex1.m1.5.5.1.1.3.3.2.1.1.1.1.1.1.2.cmml" xref="S3.Ex1.m1.5.5.1.1.3.3.2.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.5.5.1.1.3.3.2.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex1.m1.5.5.1.1.3.3.2.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.Ex1.m1.5.5.1.1.3.3.2.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex1.m1.5.5.1.1.3.3.2.1.1.1.1.1.1.2.2">𝑧</ci><ci id="S3.Ex1.m1.5.5.1.1.3.3.2.1.1.1.1.1.1.2.3.cmml" xref="S3.Ex1.m1.5.5.1.1.3.3.2.1.1.1.1.1.1.2.3">𝑗</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1.m1.5c">\displaystyle\mathcal{L}_{cls}(\mathbf{z},\mkern 1.5mu\overline{\mkern-1.5mu%
\mathbf{z}\mkern-1.5mu}\mkern 1.5mu)=\sum_{j=1}^{L}-\mkern 1.5mu\overline{%
\mkern-1.5muz\mkern-1.5mu}\mkern 1.5mu_{j}\log\left(\sigma(z_{j})\right)-(1-%
\mkern 1.5mu\overline{\mkern-1.5muz\mkern-1.5mu}\mkern 1.5mu_{j})\log\left(%
\sigma(-z_{j})\right),</annotation><annotation encoding="application/x-llamapun" id="S3.Ex1.m1.5d">caligraphic_L start_POSTSUBSCRIPT italic_c italic_l italic_s end_POSTSUBSCRIPT ( bold_z , over¯ start_ARG bold_z end_ARG ) = ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_L end_POSTSUPERSCRIPT - over¯ start_ARG italic_z end_ARG start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT roman_log ( italic_σ ( italic_z start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) ) - ( 1 - over¯ start_ARG italic_z end_ARG start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) roman_log ( italic_σ ( - italic_z start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.SS3.p2.6" class="ltx_p">where <math id="S3.SS3.p2.4.m1.3" class="ltx_Math" alttext="\sigma(x)=1/(1+\exp(-x))" display="inline"><semantics id="S3.SS3.p2.4.m1.3a"><mrow id="S3.SS3.p2.4.m1.3.3" xref="S3.SS3.p2.4.m1.3.3.cmml"><mrow id="S3.SS3.p2.4.m1.3.3.3" xref="S3.SS3.p2.4.m1.3.3.3.cmml"><mi id="S3.SS3.p2.4.m1.3.3.3.2" xref="S3.SS3.p2.4.m1.3.3.3.2.cmml">σ</mi><mo id="S3.SS3.p2.4.m1.3.3.3.1" xref="S3.SS3.p2.4.m1.3.3.3.1.cmml">⁢</mo><mrow id="S3.SS3.p2.4.m1.3.3.3.3.2" xref="S3.SS3.p2.4.m1.3.3.3.cmml"><mo stretchy="false" id="S3.SS3.p2.4.m1.3.3.3.3.2.1" xref="S3.SS3.p2.4.m1.3.3.3.cmml">(</mo><mi id="S3.SS3.p2.4.m1.1.1" xref="S3.SS3.p2.4.m1.1.1.cmml">x</mi><mo stretchy="false" id="S3.SS3.p2.4.m1.3.3.3.3.2.2" xref="S3.SS3.p2.4.m1.3.3.3.cmml">)</mo></mrow></mrow><mo id="S3.SS3.p2.4.m1.3.3.2" xref="S3.SS3.p2.4.m1.3.3.2.cmml">=</mo><mrow id="S3.SS3.p2.4.m1.3.3.1" xref="S3.SS3.p2.4.m1.3.3.1.cmml"><mn id="S3.SS3.p2.4.m1.3.3.1.3" xref="S3.SS3.p2.4.m1.3.3.1.3.cmml">1</mn><mo id="S3.SS3.p2.4.m1.3.3.1.2" xref="S3.SS3.p2.4.m1.3.3.1.2.cmml">/</mo><mrow id="S3.SS3.p2.4.m1.3.3.1.1.1" xref="S3.SS3.p2.4.m1.3.3.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.p2.4.m1.3.3.1.1.1.2" xref="S3.SS3.p2.4.m1.3.3.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.p2.4.m1.3.3.1.1.1.1" xref="S3.SS3.p2.4.m1.3.3.1.1.1.1.cmml"><mn id="S3.SS3.p2.4.m1.3.3.1.1.1.1.3" xref="S3.SS3.p2.4.m1.3.3.1.1.1.1.3.cmml">1</mn><mo id="S3.SS3.p2.4.m1.3.3.1.1.1.1.2" xref="S3.SS3.p2.4.m1.3.3.1.1.1.1.2.cmml">+</mo><mrow id="S3.SS3.p2.4.m1.3.3.1.1.1.1.1.1" xref="S3.SS3.p2.4.m1.3.3.1.1.1.1.1.2.cmml"><mi id="S3.SS3.p2.4.m1.2.2" xref="S3.SS3.p2.4.m1.2.2.cmml">exp</mi><mo id="S3.SS3.p2.4.m1.3.3.1.1.1.1.1.1a" xref="S3.SS3.p2.4.m1.3.3.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S3.SS3.p2.4.m1.3.3.1.1.1.1.1.1.1" xref="S3.SS3.p2.4.m1.3.3.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS3.p2.4.m1.3.3.1.1.1.1.1.1.1.2" xref="S3.SS3.p2.4.m1.3.3.1.1.1.1.1.2.cmml">(</mo><mrow id="S3.SS3.p2.4.m1.3.3.1.1.1.1.1.1.1.1" xref="S3.SS3.p2.4.m1.3.3.1.1.1.1.1.1.1.1.cmml"><mo id="S3.SS3.p2.4.m1.3.3.1.1.1.1.1.1.1.1.1" xref="S3.SS3.p2.4.m1.3.3.1.1.1.1.1.1.1.1.1.cmml">-</mo><mi id="S3.SS3.p2.4.m1.3.3.1.1.1.1.1.1.1.1.2" xref="S3.SS3.p2.4.m1.3.3.1.1.1.1.1.1.1.1.2.cmml">x</mi></mrow><mo stretchy="false" id="S3.SS3.p2.4.m1.3.3.1.1.1.1.1.1.1.3" xref="S3.SS3.p2.4.m1.3.3.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S3.SS3.p2.4.m1.3.3.1.1.1.3" xref="S3.SS3.p2.4.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.4.m1.3b"><apply id="S3.SS3.p2.4.m1.3.3.cmml" xref="S3.SS3.p2.4.m1.3.3"><eq id="S3.SS3.p2.4.m1.3.3.2.cmml" xref="S3.SS3.p2.4.m1.3.3.2"></eq><apply id="S3.SS3.p2.4.m1.3.3.3.cmml" xref="S3.SS3.p2.4.m1.3.3.3"><times id="S3.SS3.p2.4.m1.3.3.3.1.cmml" xref="S3.SS3.p2.4.m1.3.3.3.1"></times><ci id="S3.SS3.p2.4.m1.3.3.3.2.cmml" xref="S3.SS3.p2.4.m1.3.3.3.2">𝜎</ci><ci id="S3.SS3.p2.4.m1.1.1.cmml" xref="S3.SS3.p2.4.m1.1.1">𝑥</ci></apply><apply id="S3.SS3.p2.4.m1.3.3.1.cmml" xref="S3.SS3.p2.4.m1.3.3.1"><divide id="S3.SS3.p2.4.m1.3.3.1.2.cmml" xref="S3.SS3.p2.4.m1.3.3.1.2"></divide><cn type="integer" id="S3.SS3.p2.4.m1.3.3.1.3.cmml" xref="S3.SS3.p2.4.m1.3.3.1.3">1</cn><apply id="S3.SS3.p2.4.m1.3.3.1.1.1.1.cmml" xref="S3.SS3.p2.4.m1.3.3.1.1.1"><plus id="S3.SS3.p2.4.m1.3.3.1.1.1.1.2.cmml" xref="S3.SS3.p2.4.m1.3.3.1.1.1.1.2"></plus><cn type="integer" id="S3.SS3.p2.4.m1.3.3.1.1.1.1.3.cmml" xref="S3.SS3.p2.4.m1.3.3.1.1.1.1.3">1</cn><apply id="S3.SS3.p2.4.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.SS3.p2.4.m1.3.3.1.1.1.1.1.1"><exp id="S3.SS3.p2.4.m1.2.2.cmml" xref="S3.SS3.p2.4.m1.2.2"></exp><apply id="S3.SS3.p2.4.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p2.4.m1.3.3.1.1.1.1.1.1.1.1"><minus id="S3.SS3.p2.4.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p2.4.m1.3.3.1.1.1.1.1.1.1.1.1"></minus><ci id="S3.SS3.p2.4.m1.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS3.p2.4.m1.3.3.1.1.1.1.1.1.1.1.2">𝑥</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.4.m1.3c">\sigma(x)=1/(1+\exp(-x))</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.4.m1.3d">italic_σ ( italic_x ) = 1 / ( 1 + roman_exp ( - italic_x ) )</annotation></semantics></math> is the sigmoid function. The loss encourages <math id="S3.SS3.p2.5.m2.1" class="ltx_Math" alttext="z_{j}&gt;0" display="inline"><semantics id="S3.SS3.p2.5.m2.1a"><mrow id="S3.SS3.p2.5.m2.1.1" xref="S3.SS3.p2.5.m2.1.1.cmml"><msub id="S3.SS3.p2.5.m2.1.1.2" xref="S3.SS3.p2.5.m2.1.1.2.cmml"><mi id="S3.SS3.p2.5.m2.1.1.2.2" xref="S3.SS3.p2.5.m2.1.1.2.2.cmml">z</mi><mi id="S3.SS3.p2.5.m2.1.1.2.3" xref="S3.SS3.p2.5.m2.1.1.2.3.cmml">j</mi></msub><mo id="S3.SS3.p2.5.m2.1.1.1" xref="S3.SS3.p2.5.m2.1.1.1.cmml">&gt;</mo><mn id="S3.SS3.p2.5.m2.1.1.3" xref="S3.SS3.p2.5.m2.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.5.m2.1b"><apply id="S3.SS3.p2.5.m2.1.1.cmml" xref="S3.SS3.p2.5.m2.1.1"><gt id="S3.SS3.p2.5.m2.1.1.1.cmml" xref="S3.SS3.p2.5.m2.1.1.1"></gt><apply id="S3.SS3.p2.5.m2.1.1.2.cmml" xref="S3.SS3.p2.5.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p2.5.m2.1.1.2.1.cmml" xref="S3.SS3.p2.5.m2.1.1.2">subscript</csymbol><ci id="S3.SS3.p2.5.m2.1.1.2.2.cmml" xref="S3.SS3.p2.5.m2.1.1.2.2">𝑧</ci><ci id="S3.SS3.p2.5.m2.1.1.2.3.cmml" xref="S3.SS3.p2.5.m2.1.1.2.3">𝑗</ci></apply><cn type="integer" id="S3.SS3.p2.5.m2.1.1.3.cmml" xref="S3.SS3.p2.5.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.5.m2.1c">z_{j}&gt;0</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.5.m2.1d">italic_z start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT &gt; 0</annotation></semantics></math> for positive image-text pairs and
<math id="S3.SS3.p2.6.m3.1" class="ltx_Math" alttext="z_{j}&lt;0" display="inline"><semantics id="S3.SS3.p2.6.m3.1a"><mrow id="S3.SS3.p2.6.m3.1.1" xref="S3.SS3.p2.6.m3.1.1.cmml"><msub id="S3.SS3.p2.6.m3.1.1.2" xref="S3.SS3.p2.6.m3.1.1.2.cmml"><mi id="S3.SS3.p2.6.m3.1.1.2.2" xref="S3.SS3.p2.6.m3.1.1.2.2.cmml">z</mi><mi id="S3.SS3.p2.6.m3.1.1.2.3" xref="S3.SS3.p2.6.m3.1.1.2.3.cmml">j</mi></msub><mo id="S3.SS3.p2.6.m3.1.1.1" xref="S3.SS3.p2.6.m3.1.1.1.cmml">&lt;</mo><mn id="S3.SS3.p2.6.m3.1.1.3" xref="S3.SS3.p2.6.m3.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.6.m3.1b"><apply id="S3.SS3.p2.6.m3.1.1.cmml" xref="S3.SS3.p2.6.m3.1.1"><lt id="S3.SS3.p2.6.m3.1.1.1.cmml" xref="S3.SS3.p2.6.m3.1.1.1"></lt><apply id="S3.SS3.p2.6.m3.1.1.2.cmml" xref="S3.SS3.p2.6.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p2.6.m3.1.1.2.1.cmml" xref="S3.SS3.p2.6.m3.1.1.2">subscript</csymbol><ci id="S3.SS3.p2.6.m3.1.1.2.2.cmml" xref="S3.SS3.p2.6.m3.1.1.2.2">𝑧</ci><ci id="S3.SS3.p2.6.m3.1.1.2.3.cmml" xref="S3.SS3.p2.6.m3.1.1.2.3">𝑗</ci></apply><cn type="integer" id="S3.SS3.p2.6.m3.1.1.3.cmml" xref="S3.SS3.p2.6.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.6.m3.1c">z_{j}&lt;0</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.6.m3.1d">italic_z start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT &lt; 0</annotation></semantics></math> for negative pairs.</p>
</div>
<div id="S3.SS3.p3" class="ltx_para ltx_noindent">
<p id="S3.SS3.p3.5" class="ltx_p"><span id="S3.SS3.p3.5.1" class="ltx_text ltx_font_bold">Fully-supervised learning.</span> In the fully-supervised case,
segmentation is learned from a dataset of images annotated with referring
expressions and their corresponding segmentation masks. Only positive referring
expressions <math id="S3.SS3.p3.1.m1.3" class="ltx_Math" alttext="(\textbf{y}_{1},...,\textbf{y}_{L})" display="inline"><semantics id="S3.SS3.p3.1.m1.3a"><mrow id="S3.SS3.p3.1.m1.3.3.2" xref="S3.SS3.p3.1.m1.3.3.3.cmml"><mo stretchy="false" id="S3.SS3.p3.1.m1.3.3.2.3" xref="S3.SS3.p3.1.m1.3.3.3.cmml">(</mo><msub id="S3.SS3.p3.1.m1.2.2.1.1" xref="S3.SS3.p3.1.m1.2.2.1.1.cmml"><mtext id="S3.SS3.p3.1.m1.2.2.1.1.2" xref="S3.SS3.p3.1.m1.2.2.1.1.2a.cmml">𝐲</mtext><mn id="S3.SS3.p3.1.m1.2.2.1.1.3" xref="S3.SS3.p3.1.m1.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.SS3.p3.1.m1.3.3.2.4" xref="S3.SS3.p3.1.m1.3.3.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS3.p3.1.m1.1.1" xref="S3.SS3.p3.1.m1.1.1.cmml">…</mi><mo id="S3.SS3.p3.1.m1.3.3.2.5" xref="S3.SS3.p3.1.m1.3.3.3.cmml">,</mo><msub id="S3.SS3.p3.1.m1.3.3.2.2" xref="S3.SS3.p3.1.m1.3.3.2.2.cmml"><mtext id="S3.SS3.p3.1.m1.3.3.2.2.2" xref="S3.SS3.p3.1.m1.3.3.2.2.2a.cmml">𝐲</mtext><mi id="S3.SS3.p3.1.m1.3.3.2.2.3" xref="S3.SS3.p3.1.m1.3.3.2.2.3.cmml">L</mi></msub><mo stretchy="false" id="S3.SS3.p3.1.m1.3.3.2.6" xref="S3.SS3.p3.1.m1.3.3.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.1.m1.3b"><vector id="S3.SS3.p3.1.m1.3.3.3.cmml" xref="S3.SS3.p3.1.m1.3.3.2"><apply id="S3.SS3.p3.1.m1.2.2.1.1.cmml" xref="S3.SS3.p3.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.1.m1.2.2.1.1.1.cmml" xref="S3.SS3.p3.1.m1.2.2.1.1">subscript</csymbol><ci id="S3.SS3.p3.1.m1.2.2.1.1.2a.cmml" xref="S3.SS3.p3.1.m1.2.2.1.1.2"><mtext id="S3.SS3.p3.1.m1.2.2.1.1.2.cmml" xref="S3.SS3.p3.1.m1.2.2.1.1.2">𝐲</mtext></ci><cn type="integer" id="S3.SS3.p3.1.m1.2.2.1.1.3.cmml" xref="S3.SS3.p3.1.m1.2.2.1.1.3">1</cn></apply><ci id="S3.SS3.p3.1.m1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1">…</ci><apply id="S3.SS3.p3.1.m1.3.3.2.2.cmml" xref="S3.SS3.p3.1.m1.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS3.p3.1.m1.3.3.2.2.1.cmml" xref="S3.SS3.p3.1.m1.3.3.2.2">subscript</csymbol><ci id="S3.SS3.p3.1.m1.3.3.2.2.2a.cmml" xref="S3.SS3.p3.1.m1.3.3.2.2.2"><mtext id="S3.SS3.p3.1.m1.3.3.2.2.2.cmml" xref="S3.SS3.p3.1.m1.3.3.2.2.2">𝐲</mtext></ci><ci id="S3.SS3.p3.1.m1.3.3.2.2.3.cmml" xref="S3.SS3.p3.1.m1.3.3.2.2.3">𝐿</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.1.m1.3c">(\textbf{y}_{1},...,\textbf{y}_{L})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.1.m1.3d">( y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , y start_POSTSUBSCRIPT italic_L end_POSTSUBSCRIPT )</annotation></semantics></math> are passed to the text encoder and the similarity
matrix <math id="S3.SS3.p3.2.m2.1" class="ltx_Math" alttext="\mathbf{S}" display="inline"><semantics id="S3.SS3.p3.2.m2.1a"><mi id="S3.SS3.p3.2.m2.1.1" xref="S3.SS3.p3.2.m2.1.1.cmml">𝐒</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.2.m2.1b"><ci id="S3.SS3.p3.2.m2.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1">𝐒</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.2.m2.1c">\mathbf{S}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.2.m2.1d">bold_S</annotation></semantics></math> is bilinearly interpolated to obtain pixel-level similarities
of shape <math id="S3.SS3.p3.3.m3.1" class="ltx_Math" alttext="\mathbb{R}^{H\times W\times L}" display="inline"><semantics id="S3.SS3.p3.3.m3.1a"><msup id="S3.SS3.p3.3.m3.1.1" xref="S3.SS3.p3.3.m3.1.1.cmml"><mi id="S3.SS3.p3.3.m3.1.1.2" xref="S3.SS3.p3.3.m3.1.1.2.cmml">ℝ</mi><mrow id="S3.SS3.p3.3.m3.1.1.3" xref="S3.SS3.p3.3.m3.1.1.3.cmml"><mi id="S3.SS3.p3.3.m3.1.1.3.2" xref="S3.SS3.p3.3.m3.1.1.3.2.cmml">H</mi><mo id="S3.SS3.p3.3.m3.1.1.3.1" xref="S3.SS3.p3.3.m3.1.1.3.1.cmml">×</mo><mi id="S3.SS3.p3.3.m3.1.1.3.3" xref="S3.SS3.p3.3.m3.1.1.3.3.cmml">W</mi><mo id="S3.SS3.p3.3.m3.1.1.3.1a" xref="S3.SS3.p3.3.m3.1.1.3.1.cmml">×</mo><mi id="S3.SS3.p3.3.m3.1.1.3.4" xref="S3.SS3.p3.3.m3.1.1.3.4.cmml">L</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.3.m3.1b"><apply id="S3.SS3.p3.3.m3.1.1.cmml" xref="S3.SS3.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.3.m3.1.1.1.cmml" xref="S3.SS3.p3.3.m3.1.1">superscript</csymbol><ci id="S3.SS3.p3.3.m3.1.1.2.cmml" xref="S3.SS3.p3.3.m3.1.1.2">ℝ</ci><apply id="S3.SS3.p3.3.m3.1.1.3.cmml" xref="S3.SS3.p3.3.m3.1.1.3"><times id="S3.SS3.p3.3.m3.1.1.3.1.cmml" xref="S3.SS3.p3.3.m3.1.1.3.1"></times><ci id="S3.SS3.p3.3.m3.1.1.3.2.cmml" xref="S3.SS3.p3.3.m3.1.1.3.2">𝐻</ci><ci id="S3.SS3.p3.3.m3.1.1.3.3.cmml" xref="S3.SS3.p3.3.m3.1.1.3.3">𝑊</ci><ci id="S3.SS3.p3.3.m3.1.1.3.4.cmml" xref="S3.SS3.p3.3.m3.1.1.3.4">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.3.m3.1c">\mathbb{R}^{H\times W\times L}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.3.m3.1d">blackboard_R start_POSTSUPERSCRIPT italic_H × italic_W × italic_L end_POSTSUPERSCRIPT</annotation></semantics></math>. Then, we minimize the Dice loss
between the sigmoid of the pixel-level similarities <math id="S3.SS3.p3.4.m4.1" class="ltx_Math" alttext="\mathbf{M}=\sigma(\mathbf{S})" display="inline"><semantics id="S3.SS3.p3.4.m4.1a"><mrow id="S3.SS3.p3.4.m4.1.2" xref="S3.SS3.p3.4.m4.1.2.cmml"><mi id="S3.SS3.p3.4.m4.1.2.2" xref="S3.SS3.p3.4.m4.1.2.2.cmml">𝐌</mi><mo id="S3.SS3.p3.4.m4.1.2.1" xref="S3.SS3.p3.4.m4.1.2.1.cmml">=</mo><mrow id="S3.SS3.p3.4.m4.1.2.3" xref="S3.SS3.p3.4.m4.1.2.3.cmml"><mi id="S3.SS3.p3.4.m4.1.2.3.2" xref="S3.SS3.p3.4.m4.1.2.3.2.cmml">σ</mi><mo id="S3.SS3.p3.4.m4.1.2.3.1" xref="S3.SS3.p3.4.m4.1.2.3.1.cmml">⁢</mo><mrow id="S3.SS3.p3.4.m4.1.2.3.3.2" xref="S3.SS3.p3.4.m4.1.2.3.cmml"><mo stretchy="false" id="S3.SS3.p3.4.m4.1.2.3.3.2.1" xref="S3.SS3.p3.4.m4.1.2.3.cmml">(</mo><mi id="S3.SS3.p3.4.m4.1.1" xref="S3.SS3.p3.4.m4.1.1.cmml">𝐒</mi><mo stretchy="false" id="S3.SS3.p3.4.m4.1.2.3.3.2.2" xref="S3.SS3.p3.4.m4.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.4.m4.1b"><apply id="S3.SS3.p3.4.m4.1.2.cmml" xref="S3.SS3.p3.4.m4.1.2"><eq id="S3.SS3.p3.4.m4.1.2.1.cmml" xref="S3.SS3.p3.4.m4.1.2.1"></eq><ci id="S3.SS3.p3.4.m4.1.2.2.cmml" xref="S3.SS3.p3.4.m4.1.2.2">𝐌</ci><apply id="S3.SS3.p3.4.m4.1.2.3.cmml" xref="S3.SS3.p3.4.m4.1.2.3"><times id="S3.SS3.p3.4.m4.1.2.3.1.cmml" xref="S3.SS3.p3.4.m4.1.2.3.1"></times><ci id="S3.SS3.p3.4.m4.1.2.3.2.cmml" xref="S3.SS3.p3.4.m4.1.2.3.2">𝜎</ci><ci id="S3.SS3.p3.4.m4.1.1.cmml" xref="S3.SS3.p3.4.m4.1.1">𝐒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.4.m4.1c">\mathbf{M}=\sigma(\mathbf{S})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.4.m4.1d">bold_M = italic_σ ( bold_S )</annotation></semantics></math>
and the ground truth masks <math id="S3.SS3.p3.5.m5.1" class="ltx_Math" alttext="\mkern 1.5mu\overline{\mkern-1.5mu\mathbf{M}\mkern-1.5mu}\mkern 1.5mu" display="inline"><semantics id="S3.SS3.p3.5.m5.1a"><mpadded lspace="0.8pt" width="+1.6pt" id="S3.SS3.p3.5.m5.1.1" xref="S3.SS3.p3.5.m5.1.1.cmml"><mover accent="true" id="S3.SS3.p3.5.m5.1.1a" xref="S3.SS3.p3.5.m5.1.1.cmml"><mpadded lspace="-0.8pt" width="-1.6pt" id="S3.SS3.p3.5.m5.1.1.2" xref="S3.SS3.p3.5.m5.1.1.2.cmml"><mi id="S3.SS3.p3.5.m5.1.1.2a" xref="S3.SS3.p3.5.m5.1.1.2.cmml">𝐌</mi></mpadded><mo id="S3.SS3.p3.5.m5.1.1.1" xref="S3.SS3.p3.5.m5.1.1.1.cmml">¯</mo></mover></mpadded><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.5.m5.1b"><apply id="S3.SS3.p3.5.m5.1.1.cmml" xref="S3.SS3.p3.5.m5.1.1"><ci id="S3.SS3.p3.5.m5.1.1.1.cmml" xref="S3.SS3.p3.5.m5.1.1.1">¯</ci><ci id="S3.SS3.p3.5.m5.1.1.2.cmml" xref="S3.SS3.p3.5.m5.1.1.2">𝐌</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.5.m5.1c">\mkern 1.5mu\overline{\mkern-1.5mu\mathbf{M}\mkern-1.5mu}\mkern 1.5mu</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.5.m5.1d">over¯ start_ARG bold_M end_ARG</annotation></semantics></math>:</p>
<table id="S3.E9" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E9.m1.6" class="ltx_Math" alttext="\mathcal{L}_{dice}(\mathbf{M},\mkern 1.5mu\overline{\mkern-1.5mu\mathbf{M}%
\mkern-1.5mu}\mkern 1.5mu)=1-2\frac{|\mathbf{M}\cap\mkern 1.5mu\overline{%
\mkern-1.5mu\mathbf{M}\mkern-1.5mu}\mkern 1.5mu|}{|\mathbf{M}|+|\mkern 1.5mu%
\overline{\mkern-1.5mu\mathbf{M}\mkern-1.5mu}\mkern 1.5mu|}," display="block"><semantics id="S3.E9.m1.6a"><mrow id="S3.E9.m1.6.6.1" xref="S3.E9.m1.6.6.1.1.cmml"><mrow id="S3.E9.m1.6.6.1.1" xref="S3.E9.m1.6.6.1.1.cmml"><mrow id="S3.E9.m1.6.6.1.1.2" xref="S3.E9.m1.6.6.1.1.2.cmml"><msub id="S3.E9.m1.6.6.1.1.2.2" xref="S3.E9.m1.6.6.1.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E9.m1.6.6.1.1.2.2.2" xref="S3.E9.m1.6.6.1.1.2.2.2.cmml">ℒ</mi><mrow id="S3.E9.m1.6.6.1.1.2.2.3" xref="S3.E9.m1.6.6.1.1.2.2.3.cmml"><mi id="S3.E9.m1.6.6.1.1.2.2.3.2" xref="S3.E9.m1.6.6.1.1.2.2.3.2.cmml">d</mi><mo id="S3.E9.m1.6.6.1.1.2.2.3.1" xref="S3.E9.m1.6.6.1.1.2.2.3.1.cmml">⁢</mo><mi id="S3.E9.m1.6.6.1.1.2.2.3.3" xref="S3.E9.m1.6.6.1.1.2.2.3.3.cmml">i</mi><mo id="S3.E9.m1.6.6.1.1.2.2.3.1a" xref="S3.E9.m1.6.6.1.1.2.2.3.1.cmml">⁢</mo><mi id="S3.E9.m1.6.6.1.1.2.2.3.4" xref="S3.E9.m1.6.6.1.1.2.2.3.4.cmml">c</mi><mo id="S3.E9.m1.6.6.1.1.2.2.3.1b" xref="S3.E9.m1.6.6.1.1.2.2.3.1.cmml">⁢</mo><mi id="S3.E9.m1.6.6.1.1.2.2.3.5" xref="S3.E9.m1.6.6.1.1.2.2.3.5.cmml">e</mi></mrow></msub><mo id="S3.E9.m1.6.6.1.1.2.1" xref="S3.E9.m1.6.6.1.1.2.1.cmml">⁢</mo><mrow id="S3.E9.m1.6.6.1.1.2.3.2" xref="S3.E9.m1.6.6.1.1.2.3.1.cmml"><mo stretchy="false" id="S3.E9.m1.6.6.1.1.2.3.2.1" xref="S3.E9.m1.6.6.1.1.2.3.1.cmml">(</mo><mi id="S3.E9.m1.4.4" xref="S3.E9.m1.4.4.cmml">𝐌</mi><mo rspace="3.3pt" id="S3.E9.m1.6.6.1.1.2.3.2.2" xref="S3.E9.m1.6.6.1.1.2.3.1.cmml">,</mo><mpadded width="+0.8pt" id="S3.E9.m1.5.5" xref="S3.E9.m1.5.5.cmml"><mover accent="true" id="S3.E9.m1.5.5a" xref="S3.E9.m1.5.5.cmml"><mpadded lspace="-0.8pt" width="-1.6pt" id="S3.E9.m1.5.5.2" xref="S3.E9.m1.5.5.2.cmml"><mi id="S3.E9.m1.5.5.2a" xref="S3.E9.m1.5.5.2.cmml">𝐌</mi></mpadded><mo id="S3.E9.m1.5.5.1" xref="S3.E9.m1.5.5.1.cmml">¯</mo></mover></mpadded><mo stretchy="false" id="S3.E9.m1.6.6.1.1.2.3.2.3" xref="S3.E9.m1.6.6.1.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E9.m1.6.6.1.1.1" xref="S3.E9.m1.6.6.1.1.1.cmml">=</mo><mrow id="S3.E9.m1.6.6.1.1.3" xref="S3.E9.m1.6.6.1.1.3.cmml"><mn id="S3.E9.m1.6.6.1.1.3.2" xref="S3.E9.m1.6.6.1.1.3.2.cmml">1</mn><mo id="S3.E9.m1.6.6.1.1.3.1" xref="S3.E9.m1.6.6.1.1.3.1.cmml">-</mo><mrow id="S3.E9.m1.6.6.1.1.3.3" xref="S3.E9.m1.6.6.1.1.3.3.cmml"><mn id="S3.E9.m1.6.6.1.1.3.3.2" xref="S3.E9.m1.6.6.1.1.3.3.2.cmml">2</mn><mo id="S3.E9.m1.6.6.1.1.3.3.1" xref="S3.E9.m1.6.6.1.1.3.3.1.cmml">⁢</mo><mfrac id="S3.E9.m1.3.3" xref="S3.E9.m1.3.3.cmml"><mrow id="S3.E9.m1.1.1.1.1" xref="S3.E9.m1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E9.m1.1.1.1.1.2" xref="S3.E9.m1.1.1.1.2.1.cmml">|</mo><mrow id="S3.E9.m1.1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.1.cmml"><mi id="S3.E9.m1.1.1.1.1.1.2" xref="S3.E9.m1.1.1.1.1.1.2.cmml">𝐌</mi><mo rspace="3.3pt" id="S3.E9.m1.1.1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.1.1.cmml">∩</mo><mpadded width="+0.8pt" id="S3.E9.m1.1.1.1.1.1.3" xref="S3.E9.m1.1.1.1.1.1.3.cmml"><mover accent="true" id="S3.E9.m1.1.1.1.1.1.3a" xref="S3.E9.m1.1.1.1.1.1.3.cmml"><mpadded lspace="-0.8pt" width="-1.6pt" id="S3.E9.m1.1.1.1.1.1.3.2" xref="S3.E9.m1.1.1.1.1.1.3.2.cmml"><mi id="S3.E9.m1.1.1.1.1.1.3.2a" xref="S3.E9.m1.1.1.1.1.1.3.2.cmml">𝐌</mi></mpadded><mo id="S3.E9.m1.1.1.1.1.1.3.1" xref="S3.E9.m1.1.1.1.1.1.3.1.cmml">¯</mo></mover></mpadded></mrow><mo stretchy="false" id="S3.E9.m1.1.1.1.1.3" xref="S3.E9.m1.1.1.1.2.1.cmml">|</mo></mrow><mrow id="S3.E9.m1.3.3.3" xref="S3.E9.m1.3.3.3.cmml"><mrow id="S3.E9.m1.3.3.3.4.2" xref="S3.E9.m1.3.3.3.4.1.cmml"><mo stretchy="false" id="S3.E9.m1.3.3.3.4.2.1" xref="S3.E9.m1.3.3.3.4.1.1.cmml">|</mo><mi id="S3.E9.m1.2.2.2.1" xref="S3.E9.m1.2.2.2.1.cmml">𝐌</mi><mo stretchy="false" id="S3.E9.m1.3.3.3.4.2.2" xref="S3.E9.m1.3.3.3.4.1.1.cmml">|</mo></mrow><mo id="S3.E9.m1.3.3.3.3" xref="S3.E9.m1.3.3.3.3.cmml">+</mo><mrow id="S3.E9.m1.3.3.3.5.2" xref="S3.E9.m1.3.3.3.5.1.cmml"><mo rspace="3.3pt" stretchy="false" id="S3.E9.m1.3.3.3.5.2.1" xref="S3.E9.m1.3.3.3.5.1.1.cmml">|</mo><mpadded width="+0.8pt" id="S3.E9.m1.3.3.3.2" xref="S3.E9.m1.3.3.3.2.cmml"><mover accent="true" id="S3.E9.m1.3.3.3.2a" xref="S3.E9.m1.3.3.3.2.cmml"><mpadded lspace="-0.8pt" width="-1.6pt" id="S3.E9.m1.3.3.3.2.2" xref="S3.E9.m1.3.3.3.2.2.cmml"><mi id="S3.E9.m1.3.3.3.2.2a" xref="S3.E9.m1.3.3.3.2.2.cmml">𝐌</mi></mpadded><mo id="S3.E9.m1.3.3.3.2.1" xref="S3.E9.m1.3.3.3.2.1.cmml">¯</mo></mover></mpadded><mo stretchy="false" id="S3.E9.m1.3.3.3.5.2.2" xref="S3.E9.m1.3.3.3.5.1.1.cmml">|</mo></mrow></mrow></mfrac></mrow></mrow></mrow><mo id="S3.E9.m1.6.6.1.2" xref="S3.E9.m1.6.6.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E9.m1.6b"><apply id="S3.E9.m1.6.6.1.1.cmml" xref="S3.E9.m1.6.6.1"><eq id="S3.E9.m1.6.6.1.1.1.cmml" xref="S3.E9.m1.6.6.1.1.1"></eq><apply id="S3.E9.m1.6.6.1.1.2.cmml" xref="S3.E9.m1.6.6.1.1.2"><times id="S3.E9.m1.6.6.1.1.2.1.cmml" xref="S3.E9.m1.6.6.1.1.2.1"></times><apply id="S3.E9.m1.6.6.1.1.2.2.cmml" xref="S3.E9.m1.6.6.1.1.2.2"><csymbol cd="ambiguous" id="S3.E9.m1.6.6.1.1.2.2.1.cmml" xref="S3.E9.m1.6.6.1.1.2.2">subscript</csymbol><ci id="S3.E9.m1.6.6.1.1.2.2.2.cmml" xref="S3.E9.m1.6.6.1.1.2.2.2">ℒ</ci><apply id="S3.E9.m1.6.6.1.1.2.2.3.cmml" xref="S3.E9.m1.6.6.1.1.2.2.3"><times id="S3.E9.m1.6.6.1.1.2.2.3.1.cmml" xref="S3.E9.m1.6.6.1.1.2.2.3.1"></times><ci id="S3.E9.m1.6.6.1.1.2.2.3.2.cmml" xref="S3.E9.m1.6.6.1.1.2.2.3.2">𝑑</ci><ci id="S3.E9.m1.6.6.1.1.2.2.3.3.cmml" xref="S3.E9.m1.6.6.1.1.2.2.3.3">𝑖</ci><ci id="S3.E9.m1.6.6.1.1.2.2.3.4.cmml" xref="S3.E9.m1.6.6.1.1.2.2.3.4">𝑐</ci><ci id="S3.E9.m1.6.6.1.1.2.2.3.5.cmml" xref="S3.E9.m1.6.6.1.1.2.2.3.5">𝑒</ci></apply></apply><interval closure="open" id="S3.E9.m1.6.6.1.1.2.3.1.cmml" xref="S3.E9.m1.6.6.1.1.2.3.2"><ci id="S3.E9.m1.4.4.cmml" xref="S3.E9.m1.4.4">𝐌</ci><apply id="S3.E9.m1.5.5.cmml" xref="S3.E9.m1.5.5"><ci id="S3.E9.m1.5.5.1.cmml" xref="S3.E9.m1.5.5.1">¯</ci><ci id="S3.E9.m1.5.5.2.cmml" xref="S3.E9.m1.5.5.2">𝐌</ci></apply></interval></apply><apply id="S3.E9.m1.6.6.1.1.3.cmml" xref="S3.E9.m1.6.6.1.1.3"><minus id="S3.E9.m1.6.6.1.1.3.1.cmml" xref="S3.E9.m1.6.6.1.1.3.1"></minus><cn type="integer" id="S3.E9.m1.6.6.1.1.3.2.cmml" xref="S3.E9.m1.6.6.1.1.3.2">1</cn><apply id="S3.E9.m1.6.6.1.1.3.3.cmml" xref="S3.E9.m1.6.6.1.1.3.3"><times id="S3.E9.m1.6.6.1.1.3.3.1.cmml" xref="S3.E9.m1.6.6.1.1.3.3.1"></times><cn type="integer" id="S3.E9.m1.6.6.1.1.3.3.2.cmml" xref="S3.E9.m1.6.6.1.1.3.3.2">2</cn><apply id="S3.E9.m1.3.3.cmml" xref="S3.E9.m1.3.3"><divide id="S3.E9.m1.3.3.4.cmml" xref="S3.E9.m1.3.3"></divide><apply id="S3.E9.m1.1.1.1.2.cmml" xref="S3.E9.m1.1.1.1.1"><abs id="S3.E9.m1.1.1.1.2.1.cmml" xref="S3.E9.m1.1.1.1.1.2"></abs><apply id="S3.E9.m1.1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1.1"><intersect id="S3.E9.m1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1"></intersect><ci id="S3.E9.m1.1.1.1.1.1.2.cmml" xref="S3.E9.m1.1.1.1.1.1.2">𝐌</ci><apply id="S3.E9.m1.1.1.1.1.1.3.cmml" xref="S3.E9.m1.1.1.1.1.1.3"><ci id="S3.E9.m1.1.1.1.1.1.3.1.cmml" xref="S3.E9.m1.1.1.1.1.1.3.1">¯</ci><ci id="S3.E9.m1.1.1.1.1.1.3.2.cmml" xref="S3.E9.m1.1.1.1.1.1.3.2">𝐌</ci></apply></apply></apply><apply id="S3.E9.m1.3.3.3.cmml" xref="S3.E9.m1.3.3.3"><plus id="S3.E9.m1.3.3.3.3.cmml" xref="S3.E9.m1.3.3.3.3"></plus><apply id="S3.E9.m1.3.3.3.4.1.cmml" xref="S3.E9.m1.3.3.3.4.2"><abs id="S3.E9.m1.3.3.3.4.1.1.cmml" xref="S3.E9.m1.3.3.3.4.2.1"></abs><ci id="S3.E9.m1.2.2.2.1.cmml" xref="S3.E9.m1.2.2.2.1">𝐌</ci></apply><apply id="S3.E9.m1.3.3.3.5.1.cmml" xref="S3.E9.m1.3.3.3.5.2"><abs id="S3.E9.m1.3.3.3.5.1.1.cmml" xref="S3.E9.m1.3.3.3.5.2.1"></abs><apply id="S3.E9.m1.3.3.3.2.cmml" xref="S3.E9.m1.3.3.3.2"><ci id="S3.E9.m1.3.3.3.2.1.cmml" xref="S3.E9.m1.3.3.3.2.1">¯</ci><ci id="S3.E9.m1.3.3.3.2.2.cmml" xref="S3.E9.m1.3.3.3.2.2">𝐌</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9.m1.6c">\mathcal{L}_{dice}(\mathbf{M},\mkern 1.5mu\overline{\mkern-1.5mu\mathbf{M}%
\mkern-1.5mu}\mkern 1.5mu)=1-2\frac{|\mathbf{M}\cap\mkern 1.5mu\overline{%
\mkern-1.5mu\mathbf{M}\mkern-1.5mu}\mkern 1.5mu|}{|\mathbf{M}|+|\mkern 1.5mu%
\overline{\mkern-1.5mu\mathbf{M}\mkern-1.5mu}\mkern 1.5mu|},</annotation><annotation encoding="application/x-llamapun" id="S3.E9.m1.6d">caligraphic_L start_POSTSUBSCRIPT italic_d italic_i italic_c italic_e end_POSTSUBSCRIPT ( bold_M , over¯ start_ARG bold_M end_ARG ) = 1 - 2 divide start_ARG | bold_M ∩ over¯ start_ARG bold_M end_ARG | end_ARG start_ARG | bold_M | + | over¯ start_ARG bold_M end_ARG | end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr>
</table>
<p id="S3.SS3.p3.7" class="ltx_p">where <math id="S3.SS3.p3.6.m1.5" class="ltx_Math" alttext="|\mathbf{M}|=\sum_{i,j}m_{i,j}" display="inline"><semantics id="S3.SS3.p3.6.m1.5a"><mrow id="S3.SS3.p3.6.m1.5.6" xref="S3.SS3.p3.6.m1.5.6.cmml"><mrow id="S3.SS3.p3.6.m1.5.6.2.2" xref="S3.SS3.p3.6.m1.5.6.2.1.cmml"><mo stretchy="false" id="S3.SS3.p3.6.m1.5.6.2.2.1" xref="S3.SS3.p3.6.m1.5.6.2.1.1.cmml">|</mo><mi id="S3.SS3.p3.6.m1.5.5" xref="S3.SS3.p3.6.m1.5.5.cmml">𝐌</mi><mo stretchy="false" id="S3.SS3.p3.6.m1.5.6.2.2.2" xref="S3.SS3.p3.6.m1.5.6.2.1.1.cmml">|</mo></mrow><mo id="S3.SS3.p3.6.m1.5.6.1" xref="S3.SS3.p3.6.m1.5.6.1.cmml">=</mo><mrow id="S3.SS3.p3.6.m1.5.6.3" xref="S3.SS3.p3.6.m1.5.6.3.cmml"><msub id="S3.SS3.p3.6.m1.5.6.3.1" xref="S3.SS3.p3.6.m1.5.6.3.1.cmml"><mo largeop="true" symmetric="true" id="S3.SS3.p3.6.m1.5.6.3.1.2" xref="S3.SS3.p3.6.m1.5.6.3.1.2.cmml">∑</mo><mrow id="S3.SS3.p3.6.m1.2.2.2.4" xref="S3.SS3.p3.6.m1.2.2.2.3.cmml"><mi id="S3.SS3.p3.6.m1.1.1.1.1" xref="S3.SS3.p3.6.m1.1.1.1.1.cmml">i</mi><mo id="S3.SS3.p3.6.m1.2.2.2.4.1" xref="S3.SS3.p3.6.m1.2.2.2.3.cmml">,</mo><mi id="S3.SS3.p3.6.m1.2.2.2.2" xref="S3.SS3.p3.6.m1.2.2.2.2.cmml">j</mi></mrow></msub><msub id="S3.SS3.p3.6.m1.5.6.3.2" xref="S3.SS3.p3.6.m1.5.6.3.2.cmml"><mi id="S3.SS3.p3.6.m1.5.6.3.2.2" xref="S3.SS3.p3.6.m1.5.6.3.2.2.cmml">m</mi><mrow id="S3.SS3.p3.6.m1.4.4.2.4" xref="S3.SS3.p3.6.m1.4.4.2.3.cmml"><mi id="S3.SS3.p3.6.m1.3.3.1.1" xref="S3.SS3.p3.6.m1.3.3.1.1.cmml">i</mi><mo id="S3.SS3.p3.6.m1.4.4.2.4.1" xref="S3.SS3.p3.6.m1.4.4.2.3.cmml">,</mo><mi id="S3.SS3.p3.6.m1.4.4.2.2" xref="S3.SS3.p3.6.m1.4.4.2.2.cmml">j</mi></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.6.m1.5b"><apply id="S3.SS3.p3.6.m1.5.6.cmml" xref="S3.SS3.p3.6.m1.5.6"><eq id="S3.SS3.p3.6.m1.5.6.1.cmml" xref="S3.SS3.p3.6.m1.5.6.1"></eq><apply id="S3.SS3.p3.6.m1.5.6.2.1.cmml" xref="S3.SS3.p3.6.m1.5.6.2.2"><abs id="S3.SS3.p3.6.m1.5.6.2.1.1.cmml" xref="S3.SS3.p3.6.m1.5.6.2.2.1"></abs><ci id="S3.SS3.p3.6.m1.5.5.cmml" xref="S3.SS3.p3.6.m1.5.5">𝐌</ci></apply><apply id="S3.SS3.p3.6.m1.5.6.3.cmml" xref="S3.SS3.p3.6.m1.5.6.3"><apply id="S3.SS3.p3.6.m1.5.6.3.1.cmml" xref="S3.SS3.p3.6.m1.5.6.3.1"><csymbol cd="ambiguous" id="S3.SS3.p3.6.m1.5.6.3.1.1.cmml" xref="S3.SS3.p3.6.m1.5.6.3.1">subscript</csymbol><sum id="S3.SS3.p3.6.m1.5.6.3.1.2.cmml" xref="S3.SS3.p3.6.m1.5.6.3.1.2"></sum><list id="S3.SS3.p3.6.m1.2.2.2.3.cmml" xref="S3.SS3.p3.6.m1.2.2.2.4"><ci id="S3.SS3.p3.6.m1.1.1.1.1.cmml" xref="S3.SS3.p3.6.m1.1.1.1.1">𝑖</ci><ci id="S3.SS3.p3.6.m1.2.2.2.2.cmml" xref="S3.SS3.p3.6.m1.2.2.2.2">𝑗</ci></list></apply><apply id="S3.SS3.p3.6.m1.5.6.3.2.cmml" xref="S3.SS3.p3.6.m1.5.6.3.2"><csymbol cd="ambiguous" id="S3.SS3.p3.6.m1.5.6.3.2.1.cmml" xref="S3.SS3.p3.6.m1.5.6.3.2">subscript</csymbol><ci id="S3.SS3.p3.6.m1.5.6.3.2.2.cmml" xref="S3.SS3.p3.6.m1.5.6.3.2.2">𝑚</ci><list id="S3.SS3.p3.6.m1.4.4.2.3.cmml" xref="S3.SS3.p3.6.m1.4.4.2.4"><ci id="S3.SS3.p3.6.m1.3.3.1.1.cmml" xref="S3.SS3.p3.6.m1.3.3.1.1">𝑖</ci><ci id="S3.SS3.p3.6.m1.4.4.2.2.cmml" xref="S3.SS3.p3.6.m1.4.4.2.2">𝑗</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.6.m1.5c">|\mathbf{M}|=\sum_{i,j}m_{i,j}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.6.m1.5d">| bold_M | = ∑ start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT italic_m start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT</annotation></semantics></math> and <math id="S3.SS3.p3.7.m2.7" class="ltx_Math" alttext="\mathbf{M}\cap\mkern 1.5mu\overline{\mkern-1.5mu\mathbf{M}\mkern-1.5mu}\mkern 1%
.5mu=(m_{i,j}\mkern 1.5mu\overline{\mkern-1.5mum\mkern-1.5mu}\mkern 1.5mu_{i,j%
})_{i,j}" display="inline"><semantics id="S3.SS3.p3.7.m2.7a"><mrow id="S3.SS3.p3.7.m2.7.7" xref="S3.SS3.p3.7.m2.7.7.cmml"><mrow id="S3.SS3.p3.7.m2.7.7.3" xref="S3.SS3.p3.7.m2.7.7.3.cmml"><mi id="S3.SS3.p3.7.m2.7.7.3.2" xref="S3.SS3.p3.7.m2.7.7.3.2.cmml">𝐌</mi><mo rspace="3.3pt" id="S3.SS3.p3.7.m2.7.7.3.1" xref="S3.SS3.p3.7.m2.7.7.3.1.cmml">∩</mo><mpadded width="+0.8pt" id="S3.SS3.p3.7.m2.7.7.3.3" xref="S3.SS3.p3.7.m2.7.7.3.3.cmml"><mover accent="true" id="S3.SS3.p3.7.m2.7.7.3.3a" xref="S3.SS3.p3.7.m2.7.7.3.3.cmml"><mpadded lspace="-0.8pt" width="-1.6pt" id="S3.SS3.p3.7.m2.7.7.3.3.2" xref="S3.SS3.p3.7.m2.7.7.3.3.2.cmml"><mi id="S3.SS3.p3.7.m2.7.7.3.3.2a" xref="S3.SS3.p3.7.m2.7.7.3.3.2.cmml">𝐌</mi></mpadded><mo id="S3.SS3.p3.7.m2.7.7.3.3.1" xref="S3.SS3.p3.7.m2.7.7.3.3.1.cmml">¯</mo></mover></mpadded></mrow><mo id="S3.SS3.p3.7.m2.7.7.2" xref="S3.SS3.p3.7.m2.7.7.2.cmml">=</mo><msub id="S3.SS3.p3.7.m2.7.7.1" xref="S3.SS3.p3.7.m2.7.7.1.cmml"><mrow id="S3.SS3.p3.7.m2.7.7.1.1.1" xref="S3.SS3.p3.7.m2.7.7.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.p3.7.m2.7.7.1.1.1.2" xref="S3.SS3.p3.7.m2.7.7.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.p3.7.m2.7.7.1.1.1.1" xref="S3.SS3.p3.7.m2.7.7.1.1.1.1.cmml"><mpadded width="+0.8pt" id="S3.SS3.p3.7.m2.7.7.1.1.1.1.2" xref="S3.SS3.p3.7.m2.7.7.1.1.1.1.2.cmml"><msub id="S3.SS3.p3.7.m2.7.7.1.1.1.1.2a" xref="S3.SS3.p3.7.m2.7.7.1.1.1.1.2.cmml"><mi id="S3.SS3.p3.7.m2.7.7.1.1.1.1.2.2" xref="S3.SS3.p3.7.m2.7.7.1.1.1.1.2.2.cmml">m</mi><mrow id="S3.SS3.p3.7.m2.2.2.2.4" xref="S3.SS3.p3.7.m2.2.2.2.3.cmml"><mi id="S3.SS3.p3.7.m2.1.1.1.1" xref="S3.SS3.p3.7.m2.1.1.1.1.cmml">i</mi><mo id="S3.SS3.p3.7.m2.2.2.2.4.1" xref="S3.SS3.p3.7.m2.2.2.2.3.cmml">,</mo><mi id="S3.SS3.p3.7.m2.2.2.2.2" xref="S3.SS3.p3.7.m2.2.2.2.2.cmml">j</mi></mrow></msub></mpadded><mo id="S3.SS3.p3.7.m2.7.7.1.1.1.1.1" xref="S3.SS3.p3.7.m2.7.7.1.1.1.1.1.cmml">⁢</mo><msub id="S3.SS3.p3.7.m2.7.7.1.1.1.1.3" xref="S3.SS3.p3.7.m2.7.7.1.1.1.1.3.cmml"><mpadded width="+0.8pt" id="S3.SS3.p3.7.m2.7.7.1.1.1.1.3.2" xref="S3.SS3.p3.7.m2.7.7.1.1.1.1.3.2.cmml"><mover accent="true" id="S3.SS3.p3.7.m2.7.7.1.1.1.1.3.2a" xref="S3.SS3.p3.7.m2.7.7.1.1.1.1.3.2.cmml"><mpadded lspace="-0.8pt" width="-1.6pt" id="S3.SS3.p3.7.m2.7.7.1.1.1.1.3.2.2" xref="S3.SS3.p3.7.m2.7.7.1.1.1.1.3.2.2.cmml"><mi id="S3.SS3.p3.7.m2.7.7.1.1.1.1.3.2.2a" xref="S3.SS3.p3.7.m2.7.7.1.1.1.1.3.2.2.cmml">m</mi></mpadded><mo id="S3.SS3.p3.7.m2.7.7.1.1.1.1.3.2.1" xref="S3.SS3.p3.7.m2.7.7.1.1.1.1.3.2.1.cmml">¯</mo></mover></mpadded><mrow id="S3.SS3.p3.7.m2.4.4.2.4" xref="S3.SS3.p3.7.m2.4.4.2.3.cmml"><mi id="S3.SS3.p3.7.m2.3.3.1.1" xref="S3.SS3.p3.7.m2.3.3.1.1.cmml">i</mi><mo id="S3.SS3.p3.7.m2.4.4.2.4.1" xref="S3.SS3.p3.7.m2.4.4.2.3.cmml">,</mo><mi id="S3.SS3.p3.7.m2.4.4.2.2" xref="S3.SS3.p3.7.m2.4.4.2.2.cmml">j</mi></mrow></msub></mrow><mo stretchy="false" id="S3.SS3.p3.7.m2.7.7.1.1.1.3" xref="S3.SS3.p3.7.m2.7.7.1.1.1.1.cmml">)</mo></mrow><mrow id="S3.SS3.p3.7.m2.6.6.2.4" xref="S3.SS3.p3.7.m2.6.6.2.3.cmml"><mi id="S3.SS3.p3.7.m2.5.5.1.1" xref="S3.SS3.p3.7.m2.5.5.1.1.cmml">i</mi><mo id="S3.SS3.p3.7.m2.6.6.2.4.1" xref="S3.SS3.p3.7.m2.6.6.2.3.cmml">,</mo><mi id="S3.SS3.p3.7.m2.6.6.2.2" xref="S3.SS3.p3.7.m2.6.6.2.2.cmml">j</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.7.m2.7b"><apply id="S3.SS3.p3.7.m2.7.7.cmml" xref="S3.SS3.p3.7.m2.7.7"><eq id="S3.SS3.p3.7.m2.7.7.2.cmml" xref="S3.SS3.p3.7.m2.7.7.2"></eq><apply id="S3.SS3.p3.7.m2.7.7.3.cmml" xref="S3.SS3.p3.7.m2.7.7.3"><intersect id="S3.SS3.p3.7.m2.7.7.3.1.cmml" xref="S3.SS3.p3.7.m2.7.7.3.1"></intersect><ci id="S3.SS3.p3.7.m2.7.7.3.2.cmml" xref="S3.SS3.p3.7.m2.7.7.3.2">𝐌</ci><apply id="S3.SS3.p3.7.m2.7.7.3.3.cmml" xref="S3.SS3.p3.7.m2.7.7.3.3"><ci id="S3.SS3.p3.7.m2.7.7.3.3.1.cmml" xref="S3.SS3.p3.7.m2.7.7.3.3.1">¯</ci><ci id="S3.SS3.p3.7.m2.7.7.3.3.2.cmml" xref="S3.SS3.p3.7.m2.7.7.3.3.2">𝐌</ci></apply></apply><apply id="S3.SS3.p3.7.m2.7.7.1.cmml" xref="S3.SS3.p3.7.m2.7.7.1"><csymbol cd="ambiguous" id="S3.SS3.p3.7.m2.7.7.1.2.cmml" xref="S3.SS3.p3.7.m2.7.7.1">subscript</csymbol><apply id="S3.SS3.p3.7.m2.7.7.1.1.1.1.cmml" xref="S3.SS3.p3.7.m2.7.7.1.1.1"><times id="S3.SS3.p3.7.m2.7.7.1.1.1.1.1.cmml" xref="S3.SS3.p3.7.m2.7.7.1.1.1.1.1"></times><apply id="S3.SS3.p3.7.m2.7.7.1.1.1.1.2.cmml" xref="S3.SS3.p3.7.m2.7.7.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p3.7.m2.7.7.1.1.1.1.2.1.cmml" xref="S3.SS3.p3.7.m2.7.7.1.1.1.1.2">subscript</csymbol><ci id="S3.SS3.p3.7.m2.7.7.1.1.1.1.2.2.cmml" xref="S3.SS3.p3.7.m2.7.7.1.1.1.1.2.2">𝑚</ci><list id="S3.SS3.p3.7.m2.2.2.2.3.cmml" xref="S3.SS3.p3.7.m2.2.2.2.4"><ci id="S3.SS3.p3.7.m2.1.1.1.1.cmml" xref="S3.SS3.p3.7.m2.1.1.1.1">𝑖</ci><ci id="S3.SS3.p3.7.m2.2.2.2.2.cmml" xref="S3.SS3.p3.7.m2.2.2.2.2">𝑗</ci></list></apply><apply id="S3.SS3.p3.7.m2.7.7.1.1.1.1.3.cmml" xref="S3.SS3.p3.7.m2.7.7.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p3.7.m2.7.7.1.1.1.1.3.1.cmml" xref="S3.SS3.p3.7.m2.7.7.1.1.1.1.3">subscript</csymbol><apply id="S3.SS3.p3.7.m2.7.7.1.1.1.1.3.2.cmml" xref="S3.SS3.p3.7.m2.7.7.1.1.1.1.3.2"><ci id="S3.SS3.p3.7.m2.7.7.1.1.1.1.3.2.1.cmml" xref="S3.SS3.p3.7.m2.7.7.1.1.1.1.3.2.1">¯</ci><ci id="S3.SS3.p3.7.m2.7.7.1.1.1.1.3.2.2.cmml" xref="S3.SS3.p3.7.m2.7.7.1.1.1.1.3.2.2">𝑚</ci></apply><list id="S3.SS3.p3.7.m2.4.4.2.3.cmml" xref="S3.SS3.p3.7.m2.4.4.2.4"><ci id="S3.SS3.p3.7.m2.3.3.1.1.cmml" xref="S3.SS3.p3.7.m2.3.3.1.1">𝑖</ci><ci id="S3.SS3.p3.7.m2.4.4.2.2.cmml" xref="S3.SS3.p3.7.m2.4.4.2.2">𝑗</ci></list></apply></apply><list id="S3.SS3.p3.7.m2.6.6.2.3.cmml" xref="S3.SS3.p3.7.m2.6.6.2.4"><ci id="S3.SS3.p3.7.m2.5.5.1.1.cmml" xref="S3.SS3.p3.7.m2.5.5.1.1">𝑖</ci><ci id="S3.SS3.p3.7.m2.6.6.2.2.cmml" xref="S3.SS3.p3.7.m2.6.6.2.2">𝑗</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.7.m2.7c">\mathbf{M}\cap\mkern 1.5mu\overline{\mkern-1.5mu\mathbf{M}\mkern-1.5mu}\mkern 1%
.5mu=(m_{i,j}\mkern 1.5mu\overline{\mkern-1.5mum\mkern-1.5mu}\mkern 1.5mu_{i,j%
})_{i,j}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.7.m2.7d">bold_M ∩ over¯ start_ARG bold_M end_ARG = ( italic_m start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT over¯ start_ARG italic_m end_ARG start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT ) start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
<div id="S3.SS3.p4" class="ltx_para ltx_noindent">
<p id="S3.SS3.p4.5" class="ltx_p"><span id="S3.SS3.p4.5.1" class="ltx_text ltx_font_bold">Inference.</span> To produce segmentation masks, we reshape the
patch-text masks <math id="S3.SS3.p4.1.m1.1" class="ltx_Math" alttext="\mathbf{M}\in\mathbb{R}^{N\times L}" display="inline"><semantics id="S3.SS3.p4.1.m1.1a"><mrow id="S3.SS3.p4.1.m1.1.1" xref="S3.SS3.p4.1.m1.1.1.cmml"><mi id="S3.SS3.p4.1.m1.1.1.2" xref="S3.SS3.p4.1.m1.1.1.2.cmml">𝐌</mi><mo id="S3.SS3.p4.1.m1.1.1.1" xref="S3.SS3.p4.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS3.p4.1.m1.1.1.3" xref="S3.SS3.p4.1.m1.1.1.3.cmml"><mi id="S3.SS3.p4.1.m1.1.1.3.2" xref="S3.SS3.p4.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS3.p4.1.m1.1.1.3.3" xref="S3.SS3.p4.1.m1.1.1.3.3.cmml"><mi id="S3.SS3.p4.1.m1.1.1.3.3.2" xref="S3.SS3.p4.1.m1.1.1.3.3.2.cmml">N</mi><mo id="S3.SS3.p4.1.m1.1.1.3.3.1" xref="S3.SS3.p4.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.SS3.p4.1.m1.1.1.3.3.3" xref="S3.SS3.p4.1.m1.1.1.3.3.3.cmml">L</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.1.m1.1b"><apply id="S3.SS3.p4.1.m1.1.1.cmml" xref="S3.SS3.p4.1.m1.1.1"><in id="S3.SS3.p4.1.m1.1.1.1.cmml" xref="S3.SS3.p4.1.m1.1.1.1"></in><ci id="S3.SS3.p4.1.m1.1.1.2.cmml" xref="S3.SS3.p4.1.m1.1.1.2">𝐌</ci><apply id="S3.SS3.p4.1.m1.1.1.3.cmml" xref="S3.SS3.p4.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p4.1.m1.1.1.3.1.cmml" xref="S3.SS3.p4.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS3.p4.1.m1.1.1.3.2.cmml" xref="S3.SS3.p4.1.m1.1.1.3.2">ℝ</ci><apply id="S3.SS3.p4.1.m1.1.1.3.3.cmml" xref="S3.SS3.p4.1.m1.1.1.3.3"><times id="S3.SS3.p4.1.m1.1.1.3.3.1.cmml" xref="S3.SS3.p4.1.m1.1.1.3.3.1"></times><ci id="S3.SS3.p4.1.m1.1.1.3.3.2.cmml" xref="S3.SS3.p4.1.m1.1.1.3.3.2">𝑁</ci><ci id="S3.SS3.p4.1.m1.1.1.3.3.3.cmml" xref="S3.SS3.p4.1.m1.1.1.3.3.3">𝐿</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.1.m1.1c">\mathbf{M}\in\mathbb{R}^{N\times L}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.1.m1.1d">bold_M ∈ blackboard_R start_POSTSUPERSCRIPT italic_N × italic_L end_POSTSUPERSCRIPT</annotation></semantics></math> into a 2D map and
bilinearly interpolate it to the original image size to obtain pixel-level masks
of shape <math id="S3.SS3.p4.2.m2.1" class="ltx_Math" alttext="\mathbb{R}^{H\times W\times L}" display="inline"><semantics id="S3.SS3.p4.2.m2.1a"><msup id="S3.SS3.p4.2.m2.1.1" xref="S3.SS3.p4.2.m2.1.1.cmml"><mi id="S3.SS3.p4.2.m2.1.1.2" xref="S3.SS3.p4.2.m2.1.1.2.cmml">ℝ</mi><mrow id="S3.SS3.p4.2.m2.1.1.3" xref="S3.SS3.p4.2.m2.1.1.3.cmml"><mi id="S3.SS3.p4.2.m2.1.1.3.2" xref="S3.SS3.p4.2.m2.1.1.3.2.cmml">H</mi><mo id="S3.SS3.p4.2.m2.1.1.3.1" xref="S3.SS3.p4.2.m2.1.1.3.1.cmml">×</mo><mi id="S3.SS3.p4.2.m2.1.1.3.3" xref="S3.SS3.p4.2.m2.1.1.3.3.cmml">W</mi><mo id="S3.SS3.p4.2.m2.1.1.3.1a" xref="S3.SS3.p4.2.m2.1.1.3.1.cmml">×</mo><mi id="S3.SS3.p4.2.m2.1.1.3.4" xref="S3.SS3.p4.2.m2.1.1.3.4.cmml">L</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.2.m2.1b"><apply id="S3.SS3.p4.2.m2.1.1.cmml" xref="S3.SS3.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.2.m2.1.1.1.cmml" xref="S3.SS3.p4.2.m2.1.1">superscript</csymbol><ci id="S3.SS3.p4.2.m2.1.1.2.cmml" xref="S3.SS3.p4.2.m2.1.1.2">ℝ</ci><apply id="S3.SS3.p4.2.m2.1.1.3.cmml" xref="S3.SS3.p4.2.m2.1.1.3"><times id="S3.SS3.p4.2.m2.1.1.3.1.cmml" xref="S3.SS3.p4.2.m2.1.1.3.1"></times><ci id="S3.SS3.p4.2.m2.1.1.3.2.cmml" xref="S3.SS3.p4.2.m2.1.1.3.2">𝐻</ci><ci id="S3.SS3.p4.2.m2.1.1.3.3.cmml" xref="S3.SS3.p4.2.m2.1.1.3.3">𝑊</ci><ci id="S3.SS3.p4.2.m2.1.1.3.4.cmml" xref="S3.SS3.p4.2.m2.1.1.3.4">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.2.m2.1c">\mathbb{R}^{H\times W\times L}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.2.m2.1d">blackboard_R start_POSTSUPERSCRIPT italic_H × italic_W × italic_L end_POSTSUPERSCRIPT</annotation></semantics></math>. For SPA, pixel annotations are
obtained by adding a background mask to <math id="S3.SS3.p4.3.m3.1" class="ltx_Math" alttext="\mathbf{M}" display="inline"><semantics id="S3.SS3.p4.3.m3.1a"><mi id="S3.SS3.p4.3.m3.1.1" xref="S3.SS3.p4.3.m3.1.1.cmml">𝐌</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.3.m3.1b"><ci id="S3.SS3.p4.3.m3.1.1.cmml" xref="S3.SS3.p4.3.m3.1.1">𝐌</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.3.m3.1c">\mathbf{M}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.3.m3.1d">bold_M</annotation></semantics></math> and applying an argmax over
the refering expressions. For MPA, we threshold the values of <math id="S3.SS3.p4.4.m4.1" class="ltx_Math" alttext="\mathbf{M}" display="inline"><semantics id="S3.SS3.p4.4.m4.1a"><mi id="S3.SS3.p4.4.m4.1.1" xref="S3.SS3.p4.4.m4.1.1.cmml">𝐌</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.4.m4.1b"><ci id="S3.SS3.p4.4.m4.1.1.cmml" xref="S3.SS3.p4.4.m4.1.1">𝐌</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.4.m4.1c">\mathbf{M}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.4.m4.1d">bold_M</annotation></semantics></math> using
the background score. For GAP and GMP, we follow the standard approach
from <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite> to compute the masks <math id="S3.SS3.p4.5.m5.1" class="ltx_Math" alttext="\mathbf{M}" display="inline"><semantics id="S3.SS3.p4.5.m5.1a"><mi id="S3.SS3.p4.5.m5.1.1" xref="S3.SS3.p4.5.m5.1.1.cmml">𝐌</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.5.m5.1b"><ci id="S3.SS3.p4.5.m5.1.1.cmml" xref="S3.SS3.p4.5.m5.1.1">𝐌</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.5.m5.1c">\mathbf{M}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.5.m5.1d">bold_M</annotation></semantics></math>. Directly interpolating
patch-level similarity scores to generate segmentation maps has been proven
effective by Segmenter <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib53" title="" class="ltx_ref">53</a>]</cite> in the context of semantic segmentation.
Our decoding scheme is an extension of Segmenter linear decoding where the set
of fixed class embeddings is replaced by text embeddings.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">In this section we first outline datasets and implementation details in
Sections <a href="#S4.SS1" title="4.1 Datasets and metrics ‣ 4 Experiments ‣ Weakly-supervised segmentation of referring expressions" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.1</span></a> and <a href="#S4.SS2" title="4.2 Implementation details ‣ 4 Experiments ‣ Weakly-supervised segmentation of referring expressions" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.2</span></a>. We then validate our
implementation of two <span id="S4.p1.1.1" class="ltx_text ltx_font_italic">state-of the-art</span> methods for weakly-supervised
semantic segmentation in Section <a href="#S4.SS3" title="4.3 State-of-the-art methods for weakly-supervised semantic segmentation ‣ 4 Experiments ‣ Weakly-supervised segmentation of referring expressions" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.3</span></a> . Next, we ablate
different parameters of the proposed TSEG method for the task of referring
expression segmentation in Section <a href="#S4.SS4" title="4.4 TSEG ablations ‣ 4 Experiments ‣ Weakly-supervised segmentation of referring expressions" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.4</span></a>. Finally, we
compare TSEG to methods introduced in Section <a href="#S4.SS3" title="4.3 State-of-the-art methods for weakly-supervised semantic segmentation ‣ 4 Experiments ‣ Weakly-supervised segmentation of referring expressions" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.3</span></a> on referring
expression datasets in Section <a href="#S4.SS5" title="4.5 Weakly supervised referring expression segmentation ‣ 4 Experiments ‣ Weakly-supervised segmentation of referring expressions" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.5</span></a>.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Datasets and metrics</h3>

<div id="S4.SS1.p1" class="ltx_para ltx_noindent">
<p id="S4.SS1.p1.1" class="ltx_p"><span id="S4.SS1.p1.1.1" class="ltx_text ltx_font_bold">Pascal VOC 2012.</span> Pascal <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite> is an
established benchmark for weakly-supervised semantic segmentation. Following
standard practice <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>, <a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite>, we augment the
original training data with additional images from <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite>. The
dataset contains 10.5K images for training and 1.5K images for validation.
<br class="ltx_break"></p>
</div>
<div id="S4.SS1.p2" class="ltx_para ltx_noindent">
<p id="S4.SS1.p2.1" class="ltx_p"><span id="S4.SS1.p2.1.1" class="ltx_text ltx_font_bold">PhraseCut.</span> PhraseCut <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib59" title="" class="ltx_ref">59</a>]</cite> is the largest referring
expression segmentation dataset with 77K images annotated with 345K referring
expressions from Visual Genome <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite>. The expressions comprise a wide
vocabulary of objects, attributes and relations.
The
dataset is split into 72K images, 310K expressions for training and 3K images,
14K expressions for validation.
<br class="ltx_break"></p>
</div>
<div id="S4.SS1.p3" class="ltx_para ltx_noindent">
<p id="S4.SS1.p3.1" class="ltx_p"><span id="S4.SS1.p3.1.1" class="ltx_text ltx_font_bold">RefCOCO.</span> RefCOCO and RefCOCO+ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib65" title="" class="ltx_ref">65</a>]</cite> are the two most
commonly used datasets for referring expression segmentation and comprehension.
RefCOCO has 20K images and 142K referring expressions for 50K objects while
RefCOCO+ contains 20k images and 142K expressions for 50K objects. RefCOCO+ is
a harder dataset where words related to the absolute location of the objects are
forbidden. RefCOCOg is a dataset of 27K images with 105K expressions referring
to 55K objects. Compared to RefCOCO(+), RefCOCOg has longer sentences and richer
vocabulary.
<br class="ltx_break"></p>
</div>
<div id="S4.SS1.p4" class="ltx_para ltx_noindent">
<p id="S4.SS1.p4.1" class="ltx_p"><span id="S4.SS1.p4.1.1" class="ltx_text ltx_font_bold">Metrics.</span> We follow previous work and report mean Intersection
over Union (mIoU) for all Pascal classes. For referring expression segmentation
we use standard metrics where mIoU is the IoU averaged over all image-region
pairs resulting in a balanced evaluation for small and large
objects <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib65" title="" class="ltx_ref">65</a>, <a href="#bib.bib59" title="" class="ltx_ref">59</a>]</cite>.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Implementation details</h3>

<div id="S4.SS2.p1" class="ltx_para ltx_noindent">
<p id="S4.SS2.p1.1" class="ltx_p"><span id="S4.SS2.p1.1.1" class="ltx_text ltx_font_bold">Initialization.</span> Our TSEG model contains an image encoder
initialized with an ImageNet pre-trained Vision
Transformer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>, <a href="#bib.bib52" title="" class="ltx_ref">52</a>]</cite> and a text encoder initialized with a
pre-trained BERT model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>. We use ViT-S/16 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib52" title="" class="ltx_ref">52</a>]</cite> and
BERT-Small <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib54" title="" class="ltx_ref">54</a>]</cite> which are both expressive models achieving strong
performance on vision and language tasks, while remaining fast and compact. Our
model has a total number of 42M parameters. Following <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>, <a href="#bib.bib53" title="" class="ltx_ref">53</a>]</cite>, we
bilinearly interpolate ViT position embeddings when using an image resolution
that differs from its pre-training.
<br class="ltx_break"></p>
</div>
<div id="S4.SS2.p2" class="ltx_para ltx_noindent">
<p id="S4.SS2.p2.5" class="ltx_p"><span id="S4.SS2.p2.5.1" class="ltx_text ltx_font_bold">Optimization.</span>
For weakly-supervised learning, we use SGD optimizer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib50" title="" class="ltx_ref">50</a>]</cite> with a
base learning rate <math id="S4.SS2.p2.1.m1.1" class="ltx_Math" alttext="\gamma_{0}" display="inline"><semantics id="S4.SS2.p2.1.m1.1a"><msub id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml"><mi id="S4.SS2.p2.1.m1.1.1.2" xref="S4.SS2.p2.1.m1.1.1.2.cmml">γ</mi><mn id="S4.SS2.p2.1.m1.1.1.3" xref="S4.SS2.p2.1.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b"><apply id="S4.SS2.p2.1.m1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.1.m1.1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1">subscript</csymbol><ci id="S4.SS2.p2.1.m1.1.1.2.cmml" xref="S4.SS2.p2.1.m1.1.1.2">𝛾</ci><cn type="integer" id="S4.SS2.p2.1.m1.1.1.3.cmml" xref="S4.SS2.p2.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.1c">\gamma_{0}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.1.m1.1d">italic_γ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math>, and set weight decay to <math id="S4.SS2.p2.2.m2.1" class="ltx_Math" alttext="10^{-4}" display="inline"><semantics id="S4.SS2.p2.2.m2.1a"><msup id="S4.SS2.p2.2.m2.1.1" xref="S4.SS2.p2.2.m2.1.1.cmml"><mn id="S4.SS2.p2.2.m2.1.1.2" xref="S4.SS2.p2.2.m2.1.1.2.cmml">10</mn><mrow id="S4.SS2.p2.2.m2.1.1.3" xref="S4.SS2.p2.2.m2.1.1.3.cmml"><mo id="S4.SS2.p2.2.m2.1.1.3.1" xref="S4.SS2.p2.2.m2.1.1.3.1.cmml">-</mo><mn id="S4.SS2.p2.2.m2.1.1.3.2" xref="S4.SS2.p2.2.m2.1.1.3.2.cmml">4</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.2.m2.1b"><apply id="S4.SS2.p2.2.m2.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.2.m2.1.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1">superscript</csymbol><cn type="integer" id="S4.SS2.p2.2.m2.1.1.2.cmml" xref="S4.SS2.p2.2.m2.1.1.2">10</cn><apply id="S4.SS2.p2.2.m2.1.1.3.cmml" xref="S4.SS2.p2.2.m2.1.1.3"><minus id="S4.SS2.p2.2.m2.1.1.3.1.cmml" xref="S4.SS2.p2.2.m2.1.1.3.1"></minus><cn type="integer" id="S4.SS2.p2.2.m2.1.1.3.2.cmml" xref="S4.SS2.p2.2.m2.1.1.3.2">4</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.2.m2.1c">10^{-4}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.2.m2.1d">10 start_POSTSUPERSCRIPT - 4 end_POSTSUPERSCRIPT</annotation></semantics></math>. Following
DeepLab <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>, we adopt the poly learning rate decay
<math id="S4.SS2.p2.3.m3.1" class="ltx_Math" alttext="\gamma=\gamma_{0}(1-\frac{n_{iter}}{n_{total}})^{0.9}" display="inline"><semantics id="S4.SS2.p2.3.m3.1a"><mrow id="S4.SS2.p2.3.m3.1.1" xref="S4.SS2.p2.3.m3.1.1.cmml"><mi id="S4.SS2.p2.3.m3.1.1.3" xref="S4.SS2.p2.3.m3.1.1.3.cmml">γ</mi><mo id="S4.SS2.p2.3.m3.1.1.2" xref="S4.SS2.p2.3.m3.1.1.2.cmml">=</mo><mrow id="S4.SS2.p2.3.m3.1.1.1" xref="S4.SS2.p2.3.m3.1.1.1.cmml"><msub id="S4.SS2.p2.3.m3.1.1.1.3" xref="S4.SS2.p2.3.m3.1.1.1.3.cmml"><mi id="S4.SS2.p2.3.m3.1.1.1.3.2" xref="S4.SS2.p2.3.m3.1.1.1.3.2.cmml">γ</mi><mn id="S4.SS2.p2.3.m3.1.1.1.3.3" xref="S4.SS2.p2.3.m3.1.1.1.3.3.cmml">0</mn></msub><mo id="S4.SS2.p2.3.m3.1.1.1.2" xref="S4.SS2.p2.3.m3.1.1.1.2.cmml">⁢</mo><msup id="S4.SS2.p2.3.m3.1.1.1.1" xref="S4.SS2.p2.3.m3.1.1.1.1.cmml"><mrow id="S4.SS2.p2.3.m3.1.1.1.1.1.1" xref="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS2.p2.3.m3.1.1.1.1.1.1.2" xref="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.p2.3.m3.1.1.1.1.1.1.1" xref="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.cmml"><mn id="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.2" xref="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.1" xref="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.1.cmml">-</mo><mfrac id="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.3" xref="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.3.cmml"><msub id="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.3.2" xref="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.3.2.cmml"><mi id="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.3.2.2" xref="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.3.2.2.cmml">n</mi><mrow id="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.3.2.3" xref="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.3.2.3.cmml"><mi id="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.3.2.3.2" xref="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.3.2.3.2.cmml">i</mi><mo id="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.3.2.3.1" xref="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.3.2.3.3" xref="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.3.2.3.3.cmml">t</mi><mo id="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.3.2.3.1a" xref="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.3.2.3.4" xref="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.3.2.3.4.cmml">e</mi><mo id="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.3.2.3.1b" xref="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.3.2.3.5" xref="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.3.2.3.5.cmml">r</mi></mrow></msub><msub id="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.3.3" xref="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.3.3.cmml"><mi id="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.3.3.2" xref="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.3.3.2.cmml">n</mi><mrow id="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.3.3.3" xref="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.3.3.3.cmml"><mi id="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.3.3.3.2" xref="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.3.3.3.2.cmml">t</mi><mo id="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.3.3.3.1" xref="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.3.3.3.1.cmml">⁢</mo><mi id="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.3.3.3.3" xref="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.3.3.3.3.cmml">o</mi><mo id="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.3.3.3.1a" xref="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.3.3.3.1.cmml">⁢</mo><mi id="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.3.3.3.4" xref="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.3.3.3.4.cmml">t</mi><mo id="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.3.3.3.1b" xref="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.3.3.3.1.cmml">⁢</mo><mi id="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.3.3.3.5" xref="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.3.3.3.5.cmml">a</mi><mo id="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.3.3.3.1c" xref="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.3.3.3.1.cmml">⁢</mo><mi id="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.3.3.3.6" xref="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.3.3.3.6.cmml">l</mi></mrow></msub></mfrac></mrow><mo stretchy="false" id="S4.SS2.p2.3.m3.1.1.1.1.1.1.3" xref="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="S4.SS2.p2.3.m3.1.1.1.1.3" xref="S4.SS2.p2.3.m3.1.1.1.1.3.cmml">0.9</mn></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.3.m3.1b"><apply id="S4.SS2.p2.3.m3.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1"><eq id="S4.SS2.p2.3.m3.1.1.2.cmml" xref="S4.SS2.p2.3.m3.1.1.2"></eq><ci id="S4.SS2.p2.3.m3.1.1.3.cmml" xref="S4.SS2.p2.3.m3.1.1.3">𝛾</ci><apply id="S4.SS2.p2.3.m3.1.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1.1"><times id="S4.SS2.p2.3.m3.1.1.1.2.cmml" xref="S4.SS2.p2.3.m3.1.1.1.2"></times><apply id="S4.SS2.p2.3.m3.1.1.1.3.cmml" xref="S4.SS2.p2.3.m3.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p2.3.m3.1.1.1.3.1.cmml" xref="S4.SS2.p2.3.m3.1.1.1.3">subscript</csymbol><ci id="S4.SS2.p2.3.m3.1.1.1.3.2.cmml" xref="S4.SS2.p2.3.m3.1.1.1.3.2">𝛾</ci><cn type="integer" id="S4.SS2.p2.3.m3.1.1.1.3.3.cmml" xref="S4.SS2.p2.3.m3.1.1.1.3.3">0</cn></apply><apply id="S4.SS2.p2.3.m3.1.1.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.3.m3.1.1.1.1.2.cmml" xref="S4.SS2.p2.3.m3.1.1.1.1">superscript</csymbol><apply id="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1.1.1.1.1"><minus id="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.1"></minus><cn type="integer" id="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.2.cmml" xref="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.2">1</cn><apply id="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.3.cmml" xref="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.3"><divide id="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.3.1.cmml" xref="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.3"></divide><apply id="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.3.2.cmml" xref="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.3.2.1.cmml" xref="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.3.2.2.cmml" xref="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.3.2.2">𝑛</ci><apply id="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.3.2.3.cmml" xref="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.3.2.3"><times id="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.3.2.3.1.cmml" xref="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.3.2.3.1"></times><ci id="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.3.2.3.2.cmml" xref="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.3.2.3.2">𝑖</ci><ci id="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.3.2.3.3.cmml" xref="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.3.2.3.3">𝑡</ci><ci id="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.3.2.3.4.cmml" xref="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.3.2.3.4">𝑒</ci><ci id="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.3.2.3.5.cmml" xref="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.3.2.3.5">𝑟</ci></apply></apply><apply id="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.3.3.cmml" xref="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.3.3.1.cmml" xref="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.3.3.2.cmml" xref="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.3.3.2">𝑛</ci><apply id="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.3.3.3.cmml" xref="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.3.3.3"><times id="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.3.3.3.1.cmml" xref="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.3.3.3.1"></times><ci id="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.3.3.3.2.cmml" xref="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.3.3.3.2">𝑡</ci><ci id="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.3.3.3.3.cmml" xref="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.3.3.3.3">𝑜</ci><ci id="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.3.3.3.4.cmml" xref="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.3.3.3.4">𝑡</ci><ci id="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.3.3.3.5.cmml" xref="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.3.3.3.5">𝑎</ci><ci id="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.3.3.3.6.cmml" xref="S4.SS2.p2.3.m3.1.1.1.1.1.1.1.3.3.3.6">𝑙</ci></apply></apply></apply></apply><cn type="float" id="S4.SS2.p2.3.m3.1.1.1.1.3.cmml" xref="S4.SS2.p2.3.m3.1.1.1.1.3">0.9</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.3.m3.1c">\gamma=\gamma_{0}(1-\frac{n_{iter}}{n_{total}})^{0.9}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.3.m3.1d">italic_γ = italic_γ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( 1 - divide start_ARG italic_n start_POSTSUBSCRIPT italic_i italic_t italic_e italic_r end_POSTSUBSCRIPT end_ARG start_ARG italic_n start_POSTSUBSCRIPT italic_t italic_o italic_t italic_a italic_l end_POSTSUBSCRIPT end_ARG ) start_POSTSUPERSCRIPT 0.9 end_POSTSUPERSCRIPT</annotation></semantics></math>. We use a stochastic
drop path rate <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite> of 0.1 following standard practices to train
transformers <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>, <a href="#bib.bib15" title="" class="ltx_ref">15</a>, <a href="#bib.bib52" title="" class="ltx_ref">52</a>]</cite>. For Pascal, PhraseCut and
RefCOCO, we set the base learning rate <math id="S4.SS2.p2.4.m4.1" class="ltx_Math" alttext="\gamma_{0}=10^{-3}" display="inline"><semantics id="S4.SS2.p2.4.m4.1a"><mrow id="S4.SS2.p2.4.m4.1.1" xref="S4.SS2.p2.4.m4.1.1.cmml"><msub id="S4.SS2.p2.4.m4.1.1.2" xref="S4.SS2.p2.4.m4.1.1.2.cmml"><mi id="S4.SS2.p2.4.m4.1.1.2.2" xref="S4.SS2.p2.4.m4.1.1.2.2.cmml">γ</mi><mn id="S4.SS2.p2.4.m4.1.1.2.3" xref="S4.SS2.p2.4.m4.1.1.2.3.cmml">0</mn></msub><mo id="S4.SS2.p2.4.m4.1.1.1" xref="S4.SS2.p2.4.m4.1.1.1.cmml">=</mo><msup id="S4.SS2.p2.4.m4.1.1.3" xref="S4.SS2.p2.4.m4.1.1.3.cmml"><mn id="S4.SS2.p2.4.m4.1.1.3.2" xref="S4.SS2.p2.4.m4.1.1.3.2.cmml">10</mn><mrow id="S4.SS2.p2.4.m4.1.1.3.3" xref="S4.SS2.p2.4.m4.1.1.3.3.cmml"><mo id="S4.SS2.p2.4.m4.1.1.3.3.1" xref="S4.SS2.p2.4.m4.1.1.3.3.1.cmml">-</mo><mn id="S4.SS2.p2.4.m4.1.1.3.3.2" xref="S4.SS2.p2.4.m4.1.1.3.3.2.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.4.m4.1b"><apply id="S4.SS2.p2.4.m4.1.1.cmml" xref="S4.SS2.p2.4.m4.1.1"><eq id="S4.SS2.p2.4.m4.1.1.1.cmml" xref="S4.SS2.p2.4.m4.1.1.1"></eq><apply id="S4.SS2.p2.4.m4.1.1.2.cmml" xref="S4.SS2.p2.4.m4.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p2.4.m4.1.1.2.1.cmml" xref="S4.SS2.p2.4.m4.1.1.2">subscript</csymbol><ci id="S4.SS2.p2.4.m4.1.1.2.2.cmml" xref="S4.SS2.p2.4.m4.1.1.2.2">𝛾</ci><cn type="integer" id="S4.SS2.p2.4.m4.1.1.2.3.cmml" xref="S4.SS2.p2.4.m4.1.1.2.3">0</cn></apply><apply id="S4.SS2.p2.4.m4.1.1.3.cmml" xref="S4.SS2.p2.4.m4.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p2.4.m4.1.1.3.1.cmml" xref="S4.SS2.p2.4.m4.1.1.3">superscript</csymbol><cn type="integer" id="S4.SS2.p2.4.m4.1.1.3.2.cmml" xref="S4.SS2.p2.4.m4.1.1.3.2">10</cn><apply id="S4.SS2.p2.4.m4.1.1.3.3.cmml" xref="S4.SS2.p2.4.m4.1.1.3.3"><minus id="S4.SS2.p2.4.m4.1.1.3.3.1.cmml" xref="S4.SS2.p2.4.m4.1.1.3.3.1"></minus><cn type="integer" id="S4.SS2.p2.4.m4.1.1.3.3.2.cmml" xref="S4.SS2.p2.4.m4.1.1.3.3.2">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.4.m4.1c">\gamma_{0}=10^{-3}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.4.m4.1d">italic_γ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT = 10 start_POSTSUPERSCRIPT - 3 end_POSTSUPERSCRIPT</annotation></semantics></math>. We found this
learning scheme to be stable resulting in good results for all three datasets.
Regarding training iterations and the batch size, we use 16K iterations and
batches of size 16 for Pascal, 80K iterations and batches of size 32 for
RefCOCO, and 120K iterations with batches of size 32 for PhraseCut.
When training on referring expressions, we randomly sample three positive
expressions per image on average. The resolution of images at train time is set
to <math id="S4.SS2.p2.5.m5.1" class="ltx_Math" alttext="384\times 384" display="inline"><semantics id="S4.SS2.p2.5.m5.1a"><mrow id="S4.SS2.p2.5.m5.1.1" xref="S4.SS2.p2.5.m5.1.1.cmml"><mn id="S4.SS2.p2.5.m5.1.1.2" xref="S4.SS2.p2.5.m5.1.1.2.cmml">384</mn><mo id="S4.SS2.p2.5.m5.1.1.1" xref="S4.SS2.p2.5.m5.1.1.1.cmml">×</mo><mn id="S4.SS2.p2.5.m5.1.1.3" xref="S4.SS2.p2.5.m5.1.1.3.cmml">384</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.5.m5.1b"><apply id="S4.SS2.p2.5.m5.1.1.cmml" xref="S4.SS2.p2.5.m5.1.1"><times id="S4.SS2.p2.5.m5.1.1.1.cmml" xref="S4.SS2.p2.5.m5.1.1.1"></times><cn type="integer" id="S4.SS2.p2.5.m5.1.1.2.cmml" xref="S4.SS2.p2.5.m5.1.1.2">384</cn><cn type="integer" id="S4.SS2.p2.5.m5.1.1.3.cmml" xref="S4.SS2.p2.5.m5.1.1.3">384</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.5.m5.1c">384\times 384</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.5.m5.1d">384 × 384</annotation></semantics></math> and following standard practices we use random rescaling,
horizontal flipping and random cropping.</p>
</div>
<div id="S4.SS2.p3" class="ltx_para">
<p id="S4.SS2.p3.3" class="ltx_p">For the fully-supervised setup we use AdamW <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>, <a href="#bib.bib43" title="" class="ltx_ref">43</a>]</cite>
optimizer and set the base learning rate <math id="S4.SS2.p3.1.m1.1" class="ltx_Math" alttext="\gamma_{0}" display="inline"><semantics id="S4.SS2.p3.1.m1.1a"><msub id="S4.SS2.p3.1.m1.1.1" xref="S4.SS2.p3.1.m1.1.1.cmml"><mi id="S4.SS2.p3.1.m1.1.1.2" xref="S4.SS2.p3.1.m1.1.1.2.cmml">γ</mi><mn id="S4.SS2.p3.1.m1.1.1.3" xref="S4.SS2.p3.1.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.1.m1.1b"><apply id="S4.SS2.p3.1.m1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.1.m1.1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1">subscript</csymbol><ci id="S4.SS2.p3.1.m1.1.1.2.cmml" xref="S4.SS2.p3.1.m1.1.1.2">𝛾</ci><cn type="integer" id="S4.SS2.p3.1.m1.1.1.3.cmml" xref="S4.SS2.p3.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.1.m1.1c">\gamma_{0}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.1.m1.1d">italic_γ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> to <math id="S4.SS2.p3.2.m2.1" class="ltx_Math" alttext="5\times 10^{-5}" display="inline"><semantics id="S4.SS2.p3.2.m2.1a"><mrow id="S4.SS2.p3.2.m2.1.1" xref="S4.SS2.p3.2.m2.1.1.cmml"><mn id="S4.SS2.p3.2.m2.1.1.2" xref="S4.SS2.p3.2.m2.1.1.2.cmml">5</mn><mo id="S4.SS2.p3.2.m2.1.1.1" xref="S4.SS2.p3.2.m2.1.1.1.cmml">×</mo><msup id="S4.SS2.p3.2.m2.1.1.3" xref="S4.SS2.p3.2.m2.1.1.3.cmml"><mn id="S4.SS2.p3.2.m2.1.1.3.2" xref="S4.SS2.p3.2.m2.1.1.3.2.cmml">10</mn><mrow id="S4.SS2.p3.2.m2.1.1.3.3" xref="S4.SS2.p3.2.m2.1.1.3.3.cmml"><mo id="S4.SS2.p3.2.m2.1.1.3.3.1" xref="S4.SS2.p3.2.m2.1.1.3.3.1.cmml">-</mo><mn id="S4.SS2.p3.2.m2.1.1.3.3.2" xref="S4.SS2.p3.2.m2.1.1.3.3.2.cmml">5</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.2.m2.1b"><apply id="S4.SS2.p3.2.m2.1.1.cmml" xref="S4.SS2.p3.2.m2.1.1"><times id="S4.SS2.p3.2.m2.1.1.1.cmml" xref="S4.SS2.p3.2.m2.1.1.1"></times><cn type="integer" id="S4.SS2.p3.2.m2.1.1.2.cmml" xref="S4.SS2.p3.2.m2.1.1.2">5</cn><apply id="S4.SS2.p3.2.m2.1.1.3.cmml" xref="S4.SS2.p3.2.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p3.2.m2.1.1.3.1.cmml" xref="S4.SS2.p3.2.m2.1.1.3">superscript</csymbol><cn type="integer" id="S4.SS2.p3.2.m2.1.1.3.2.cmml" xref="S4.SS2.p3.2.m2.1.1.3.2">10</cn><apply id="S4.SS2.p3.2.m2.1.1.3.3.cmml" xref="S4.SS2.p3.2.m2.1.1.3.3"><minus id="S4.SS2.p3.2.m2.1.1.3.3.1.cmml" xref="S4.SS2.p3.2.m2.1.1.3.3.1"></minus><cn type="integer" id="S4.SS2.p3.2.m2.1.1.3.3.2.cmml" xref="S4.SS2.p3.2.m2.1.1.3.3.2">5</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.2.m2.1c">5\times 10^{-5}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.2.m2.1d">5 × 10 start_POSTSUPERSCRIPT - 5 end_POSTSUPERSCRIPT</annotation></semantics></math>. We
set the batch size to 16 for all datasets and use the same number of iterations
as for weakly-supervised setups. The resolution of images at train time is
<math id="S4.SS2.p3.3.m3.1" class="ltx_Math" alttext="512\times 512" display="inline"><semantics id="S4.SS2.p3.3.m3.1a"><mrow id="S4.SS2.p3.3.m3.1.1" xref="S4.SS2.p3.3.m3.1.1.cmml"><mn id="S4.SS2.p3.3.m3.1.1.2" xref="S4.SS2.p3.3.m3.1.1.2.cmml">512</mn><mo id="S4.SS2.p3.3.m3.1.1.1" xref="S4.SS2.p3.3.m3.1.1.1.cmml">×</mo><mn id="S4.SS2.p3.3.m3.1.1.3" xref="S4.SS2.p3.3.m3.1.1.3.cmml">512</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.3.m3.1b"><apply id="S4.SS2.p3.3.m3.1.1.cmml" xref="S4.SS2.p3.3.m3.1.1"><times id="S4.SS2.p3.3.m3.1.1.1.cmml" xref="S4.SS2.p3.3.m3.1.1.1"></times><cn type="integer" id="S4.SS2.p3.3.m3.1.1.2.cmml" xref="S4.SS2.p3.3.m3.1.1.2">512</cn><cn type="integer" id="S4.SS2.p3.3.m3.1.1.3.cmml" xref="S4.SS2.p3.3.m3.1.1.3">512</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.3.m3.1c">512\times 512</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.3.m3.1d">512 × 512</annotation></semantics></math>.</p>
</div>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>State-of-the-art methods for weakly-supervised semantic segmentation</h3>

<figure id="S4.T1" class="ltx_table">
<table id="S4.T1.2" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T1.2.1.1" class="ltx_tr">
<th id="S4.T1.2.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S4.T1.2.1.1.1.1" class="ltx_text" style="font-size:90%;">Method</span></th>
<th id="S4.T1.2.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S4.T1.2.1.1.2.1" class="ltx_text" style="font-size:90%;">Image encoder</span></th>
<th id="S4.T1.2.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:3.0pt;padding-right:3.0pt;" colspan="2"><span id="S4.T1.2.1.1.3.1" class="ltx_text" style="font-size:90%;">Class encoding</span></th>
<th id="S4.T1.2.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S4.T1.2.1.1.4.1" class="ltx_text" style="font-size:90%;">mIoU</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T1.2.2.1" class="ltx_tr">
<th id="S4.T1.2.2.1.1" class="ltx_td ltx_th ltx_th_row" style="padding-left:3.0pt;padding-right:3.0pt;"></th>
<th id="S4.T1.2.2.1.2" class="ltx_td ltx_th ltx_th_column ltx_th_row" style="padding-left:3.0pt;padding-right:3.0pt;"></th>
<th id="S4.T1.2.2.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S4.T1.2.2.1.3.1" class="ltx_text" style="font-size:90%;">Vector</span></th>
<th id="S4.T1.2.2.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S4.T1.2.2.1.4.1" class="ltx_text" style="font-size:90%;">Language model</span></th>
<td id="S4.T1.2.2.1.5" class="ltx_td" style="padding-left:3.0pt;padding-right:3.0pt;"></td>
</tr>
<tr id="S4.T1.2.3.2" class="ltx_tr">
<th id="S4.T1.2.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">
<span id="S4.T1.2.3.2.1.1" class="ltx_text" style="font-size:90%;">GAP </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T1.2.3.2.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib2" title="" class="ltx_ref">2</a><span id="S4.T1.2.3.2.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</th>
<th id="S4.T1.2.3.2.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S4.T1.2.3.2.2.1" class="ltx_text" style="font-size:90%;">WideResNet38</span></th>
<td id="S4.T1.2.3.2.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S4.T1.2.3.2.3.1" class="ltx_text" style="font-size:90%;">✓</span></td>
<td id="S4.T1.2.3.2.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S4.T1.2.3.2.4.1" class="ltx_text" style="font-size:90%;">✗</span></td>
<td id="S4.T1.2.3.2.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S4.T1.2.3.2.5.1" class="ltx_text" style="font-size:90%;">48.0</span></td>
</tr>
<tr id="S4.T1.2.4.3" class="ltx_tr">
<th id="S4.T1.2.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:3.0pt;padding-right:3.0pt;">
<span id="S4.T1.2.4.3.1.1" class="ltx_text" style="font-size:90%;">GAP </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T1.2.4.3.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib2" title="" class="ltx_ref">2</a><span id="S4.T1.2.4.3.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite><sup id="S4.T1.2.4.3.1.4" class="ltx_sup"><span id="S4.T1.2.4.3.1.4.1" class="ltx_text" style="font-size:90%;">†</span></sup>
</th>
<th id="S4.T1.2.4.3.2" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S4.T1.2.4.3.2.1" class="ltx_text" style="font-size:90%;">WideResNet38</span></th>
<td id="S4.T1.2.4.3.3" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S4.T1.2.4.3.3.1" class="ltx_text" style="font-size:90%;">✗</span></td>
<td id="S4.T1.2.4.3.4" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S4.T1.2.4.3.4.1" class="ltx_text" style="font-size:90%;">✓</span></td>
<td id="S4.T1.2.4.3.5" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S4.T1.2.4.3.5.1" class="ltx_text" style="font-size:90%;">46.8</span></td>
</tr>
<tr id="S4.T1.2.5.4" class="ltx_tr">
<th id="S4.T1.2.5.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:3.0pt;padding-right:3.0pt;">
<span id="S4.T1.2.5.4.1.1" class="ltx_text" style="font-size:90%;">GAP </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T1.2.5.4.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib2" title="" class="ltx_ref">2</a><span id="S4.T1.2.5.4.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite><sup id="S4.T1.2.5.4.1.4" class="ltx_sup"><span id="S4.T1.2.5.4.1.4.1" class="ltx_text" style="font-size:90%;">†</span></sup>
</th>
<th id="S4.T1.2.5.4.2" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S4.T1.2.5.4.2.1" class="ltx_text" style="font-size:90%;">ViT-S/16</span></th>
<td id="S4.T1.2.5.4.3" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S4.T1.2.5.4.3.1" class="ltx_text" style="font-size:90%;">✗</span></td>
<td id="S4.T1.2.5.4.4" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S4.T1.2.5.4.4.1" class="ltx_text" style="font-size:90%;">✓</span></td>
<td id="S4.T1.2.5.4.5" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S4.T1.2.5.4.5.1" class="ltx_text" style="font-size:90%;">50.2</span></td>
</tr>
<tr id="S4.T1.2.6.5" class="ltx_tr">
<th id="S4.T1.2.6.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">
<span id="S4.T1.2.6.5.1.1" class="ltx_text" style="font-size:90%;">GMP </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T1.2.6.5.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib68" title="" class="ltx_ref">68</a><span id="S4.T1.2.6.5.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite><sup id="S4.T1.2.6.5.1.4" class="ltx_sup"><span id="S4.T1.2.6.5.1.4.1" class="ltx_text" style="font-size:90%;">†</span></sup>
</th>
<th id="S4.T1.2.6.5.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S4.T1.2.6.5.2.1" class="ltx_text" style="font-size:90%;">WideResNet38</span></th>
<td id="S4.T1.2.6.5.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S4.T1.2.6.5.3.1" class="ltx_text" style="font-size:90%;">✗</span></td>
<td id="S4.T1.2.6.5.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S4.T1.2.6.5.4.1" class="ltx_text" style="font-size:90%;">✓</span></td>
<td id="S4.T1.2.6.5.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S4.T1.2.6.5.5.1" class="ltx_text" style="font-size:90%;">44.3</span></td>
</tr>
<tr id="S4.T1.2.7.6" class="ltx_tr">
<th id="S4.T1.2.7.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:3.0pt;padding-right:3.0pt;">
<span id="S4.T1.2.7.6.1.1" class="ltx_text" style="font-size:90%;">GMP </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T1.2.7.6.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib68" title="" class="ltx_ref">68</a><span id="S4.T1.2.7.6.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite><sup id="S4.T1.2.7.6.1.4" class="ltx_sup"><span id="S4.T1.2.7.6.1.4.1" class="ltx_text" style="font-size:90%;">†</span></sup>
</th>
<th id="S4.T1.2.7.6.2" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S4.T1.2.7.6.2.1" class="ltx_text" style="font-size:90%;">ViT-S/16</span></th>
<td id="S4.T1.2.7.6.3" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S4.T1.2.7.6.3.1" class="ltx_text" style="font-size:90%;">✗</span></td>
<td id="S4.T1.2.7.6.4" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S4.T1.2.7.6.4.1" class="ltx_text" style="font-size:90%;">✓</span></td>
<td id="S4.T1.2.7.6.5" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S4.T1.2.7.6.5.1" class="ltx_text" style="font-size:90%;">48.1</span></td>
</tr>
<tr id="S4.T1.2.8.7" class="ltx_tr">
<th id="S4.T1.2.8.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">
<span id="S4.T1.2.8.7.1.1" class="ltx_text" style="font-size:90%;">SPA </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T1.2.8.7.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib3" title="" class="ltx_ref">3</a><span id="S4.T1.2.8.7.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</th>
<th id="S4.T1.2.8.7.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S4.T1.2.8.7.2.1" class="ltx_text" style="font-size:90%;">WideResNet38</span></th>
<td id="S4.T1.2.8.7.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S4.T1.2.8.7.3.1" class="ltx_text" style="font-size:90%;">✓</span></td>
<td id="S4.T1.2.8.7.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S4.T1.2.8.7.4.1" class="ltx_text" style="font-size:90%;">✗</span></td>
<td id="S4.T1.2.8.7.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S4.T1.2.8.7.5.1" class="ltx_text" style="font-size:90%;">62.7</span></td>
</tr>
<tr id="S4.T1.2.9.8" class="ltx_tr">
<th id="S4.T1.2.9.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:3.0pt;padding-right:3.0pt;">
<span id="S4.T1.2.9.8.1.1" class="ltx_text" style="font-size:90%;">SPA </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T1.2.9.8.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib3" title="" class="ltx_ref">3</a><span id="S4.T1.2.9.8.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite><sup id="S4.T1.2.9.8.1.4" class="ltx_sup"><span id="S4.T1.2.9.8.1.4.1" class="ltx_text" style="font-size:90%;">†</span></sup>
</th>
<th id="S4.T1.2.9.8.2" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S4.T1.2.9.8.2.1" class="ltx_text" style="font-size:90%;">WideResNet38</span></th>
<td id="S4.T1.2.9.8.3" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S4.T1.2.9.8.3.1" class="ltx_text" style="font-size:90%;">✗</span></td>
<td id="S4.T1.2.9.8.4" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S4.T1.2.9.8.4.1" class="ltx_text" style="font-size:90%;">✓</span></td>
<td id="S4.T1.2.9.8.5" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S4.T1.2.9.8.5.1" class="ltx_text" style="font-size:90%;">62.4</span></td>
</tr>
<tr id="S4.T1.2.10.9" class="ltx_tr">
<th id="S4.T1.2.10.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" style="padding-left:3.0pt;padding-right:3.0pt;">
<span id="S4.T1.2.10.9.1.1" class="ltx_text" style="font-size:90%;">SPA </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T1.2.10.9.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib3" title="" class="ltx_ref">3</a><span id="S4.T1.2.10.9.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite><sup id="S4.T1.2.10.9.1.4" class="ltx_sup"><span id="S4.T1.2.10.9.1.4.1" class="ltx_text" style="font-size:90%;">†</span></sup>
</th>
<th id="S4.T1.2.10.9.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S4.T1.2.10.9.2.1" class="ltx_text" style="font-size:90%;">ViT-S/16</span></th>
<td id="S4.T1.2.10.9.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S4.T1.2.10.9.3.1" class="ltx_text" style="font-size:90%;">✗</span></td>
<td id="S4.T1.2.10.9.4" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S4.T1.2.10.9.4.1" class="ltx_text" style="font-size:90%;">✓</span></td>
<td id="S4.T1.2.10.9.5" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S4.T1.2.10.9.5.1" class="ltx_text ltx_font_bold" style="font-size:90%;">66.4</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 1: </span>State-of-the-art single-stage methods for weakly-supervised semantic
segmentation on the Pascal VOC validation set. <sup id="S4.T1.7.1" class="ltx_sup">†</sup>  denotes our implementation. Multi-scale processing and CRF are used for inference.</figcaption>
</figure>
<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.1" class="ltx_p">As we are the first to propose an approach for weakly-supervised learning for
referring expression segmentation, we implemented state-of-the-art methods for
weakly-supervised semantic segmentation to use as baselines. We use three
single-stage methods presented in Section <a href="#S3.SS2" title="3.2 Global Pooling Mechanisms ‣ 3 Method ‣ Weakly-supervised segmentation of referring expressions" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.2</span></a>, namely GMP
<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib68" title="" class="ltx_ref">68</a>]</cite>, the seminal work GAP <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>, and the more recent
state-of-the-art approach SPA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>. SPA performs close to the best
two-stage weakly-supervised methods, DRS <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite> and EPS <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib36" title="" class="ltx_ref">36</a>]</cite>, two
more complex methods relying on off-the-shelf saliency detectors, which is not
the focus of our work.
<br class="ltx_break"></p>
</div>
<div id="S4.SS3.p2" class="ltx_para">
<p id="S4.SS3.p2.1" class="ltx_p">Table <a href="#S4.T1" title="Table 1 ‣ 4.3 State-of-the-art methods for weakly-supervised semantic segmentation ‣ 4 Experiments ‣ Weakly-supervised segmentation of referring expressions" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> reports the performance on the Pascal VOC 2012 dataset. With a language model as
class encoding as shown in Figure <a href="#S3.F2" title="Figure 2 ‣ 3 Method ‣ Weakly-supervised segmentation of referring expressions" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, we obtain similar
performances as GAP <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite> and SPA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite> using the same
WideResNet38 backbone. By using the more recent ViT-S/16 backbone with SPA,
we obtain 66.4% mIoU, a 4% gain over WideResNet38. We also report results
with GMP <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib68" title="" class="ltx_ref">68</a>]</cite> for which we did not find methods reporting results on
Pascal VOC 2012. The GMP results are below the GAP results and again the
ViT-S/16 backbone gives improved results. In the following sections we use
ViT-S/16 as the image encoder, BERT-Small as the text encoder and GAP, GMP and
SPA as a point of comparison to our proposed TSEG method. The models can
directly be used to perform referring expression segmentation by replacing the
class label given as input to the language model by referring expressions.</p>
</div>
</section>
<section id="S4.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>TSEG ablations</h3>

<figure id="S4.T2" class="ltx_table">
<div class="ltx_flex_figure ltx_flex_table">

<div class="ltx_flex_cell 
                  ltx_flex_size_1">
<figure id="S4.F3.sf1" class="ltx_figure ltx_flex_size_1 ltx_align_center"><span id="S4.F3.sf1.1" class="ltx_inline-para ltx_minipage ltx_align_middle" style="width:216.8pt;">
<span id="S4.F3.sf1.1.p1" class="ltx_para ltx_align_center">
<span id="S4.F3.sf1.1.p1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<span class="ltx_thead">
<span id="S4.F3.sf1.1.p1.1.1" class="ltx_tr">
<span id="S4.F3.sf1.1.p1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t" style="padding:0.4pt 5.0pt;"><math id="S4.F3.sf1.1.p1.1.1.1.m1.1" class="ltx_Math" alttext="\lambda~{}\downarrow~{}p~{}\rightarrow" display="inline"><semantics id="S4.F3.sf1.1.p1.1.1.1.m1.1a"><mrow id="S4.F3.sf1.1.p1.1.1.1.m1.1.1" xref="S4.F3.sf1.1.p1.1.1.1.m1.1.1.cmml"><mpadded width="+2.7pt" id="S4.F3.sf1.1.p1.1.1.1.m1.1.1.2" xref="S4.F3.sf1.1.p1.1.1.1.m1.1.1.2.cmml"><mi mathsize="80%" id="S4.F3.sf1.1.p1.1.1.1.m1.1.1.2a" xref="S4.F3.sf1.1.p1.1.1.1.m1.1.1.2.cmml">λ</mi></mpadded><mo mathsize="80%" rspace="5.2pt" stretchy="false" id="S4.F3.sf1.1.p1.1.1.1.m1.1.1.3" xref="S4.F3.sf1.1.p1.1.1.1.m1.1.1.3.cmml">↓</mo><mpadded width="+2.7pt" id="S4.F3.sf1.1.p1.1.1.1.m1.1.1.4" xref="S4.F3.sf1.1.p1.1.1.1.m1.1.1.4.cmml"><mi mathsize="80%" id="S4.F3.sf1.1.p1.1.1.1.m1.1.1.4a" xref="S4.F3.sf1.1.p1.1.1.1.m1.1.1.4.cmml">p</mi></mpadded><mo mathsize="80%" stretchy="false" id="S4.F3.sf1.1.p1.1.1.1.m1.1.1.5" xref="S4.F3.sf1.1.p1.1.1.1.m1.1.1.5.cmml">→</mo><mi id="S4.F3.sf1.1.p1.1.1.1.m1.1.1.6" xref="S4.F3.sf1.1.p1.1.1.1.m1.1.1.6.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S4.F3.sf1.1.p1.1.1.1.m1.1b"><apply id="S4.F3.sf1.1.p1.1.1.1.m1.1.1.cmml" xref="S4.F3.sf1.1.p1.1.1.1.m1.1.1"><and id="S4.F3.sf1.1.p1.1.1.1.m1.1.1a.cmml" xref="S4.F3.sf1.1.p1.1.1.1.m1.1.1"></and><apply id="S4.F3.sf1.1.p1.1.1.1.m1.1.1b.cmml" xref="S4.F3.sf1.1.p1.1.1.1.m1.1.1"><ci id="S4.F3.sf1.1.p1.1.1.1.m1.1.1.3.cmml" xref="S4.F3.sf1.1.p1.1.1.1.m1.1.1.3">↓</ci><ci id="S4.F3.sf1.1.p1.1.1.1.m1.1.1.2.cmml" xref="S4.F3.sf1.1.p1.1.1.1.m1.1.1.2">𝜆</ci><ci id="S4.F3.sf1.1.p1.1.1.1.m1.1.1.4.cmml" xref="S4.F3.sf1.1.p1.1.1.1.m1.1.1.4">𝑝</ci></apply><apply id="S4.F3.sf1.1.p1.1.1.1.m1.1.1c.cmml" xref="S4.F3.sf1.1.p1.1.1.1.m1.1.1"><ci id="S4.F3.sf1.1.p1.1.1.1.m1.1.1.5.cmml" xref="S4.F3.sf1.1.p1.1.1.1.m1.1.1.5">→</ci><share href="#S4.F3.sf1.1.p1.1.1.1.m1.1.1.4.cmml" id="S4.F3.sf1.1.p1.1.1.1.m1.1.1d.cmml" xref="S4.F3.sf1.1.p1.1.1.1.m1.1.1"></share><csymbol cd="latexml" id="S4.F3.sf1.1.p1.1.1.1.m1.1.1.6.cmml" xref="S4.F3.sf1.1.p1.1.1.1.m1.1.1.6">absent</csymbol></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F3.sf1.1.p1.1.1.1.m1.1c">\lambda~{}\downarrow~{}p~{}\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S4.F3.sf1.1.p1.1.1.1.m1.1d">italic_λ ↓ italic_p →</annotation></semantics></math></span>
<span id="S4.F3.sf1.1.p1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding:0.4pt 5.0pt;"><span id="S4.F3.sf1.1.p1.1.1.2.1" class="ltx_text" style="font-size:80%;">0</span></span>
<span id="S4.F3.sf1.1.p1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding:0.4pt 5.0pt;"><span id="S4.F3.sf1.1.p1.1.1.3.1" class="ltx_text" style="font-size:80%;">1</span></span>
<span id="S4.F3.sf1.1.p1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding:0.4pt 5.0pt;"><span id="S4.F3.sf1.1.p1.1.1.4.1" class="ltx_text" style="font-size:80%;">3</span></span>
<span id="S4.F3.sf1.1.p1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding:0.4pt 5.0pt;"><span id="S4.F3.sf1.1.p1.1.1.5.1" class="ltx_text" style="font-size:80%;">5</span></span></span>
</span>
<span class="ltx_tbody">
<span id="S4.F3.sf1.1.p1.1.2.1" class="ltx_tr">
<span id="S4.F3.sf1.1.p1.1.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding:0.4pt 5.0pt;"><span id="S4.F3.sf1.1.p1.1.2.1.1.1" class="ltx_text" style="font-size:80%;">0.0</span></span>
<span id="S4.F3.sf1.1.p1.1.2.1.2" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.4pt 5.0pt;"><span id="S4.F3.sf1.1.p1.1.2.1.2.1" class="ltx_text" style="font-size:80%;">26.8</span></span>
<span id="S4.F3.sf1.1.p1.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.4pt 5.0pt;"><span id="S4.F3.sf1.1.p1.1.2.1.3.1" class="ltx_text" style="font-size:80%;">27.4</span></span>
<span id="S4.F3.sf1.1.p1.1.2.1.4" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.4pt 5.0pt;"><span id="S4.F3.sf1.1.p1.1.2.1.4.1" class="ltx_text" style="font-size:80%;">27.9</span></span>
<span id="S4.F3.sf1.1.p1.1.2.1.5" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.4pt 5.0pt;"><span id="S4.F3.sf1.1.p1.1.2.1.5.1" class="ltx_text" style="font-size:80%;">27.7</span></span></span>
<span id="S4.F3.sf1.1.p1.1.3.2" class="ltx_tr">
<span id="S4.F3.sf1.1.p1.1.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding:0.4pt 5.0pt;"><span id="S4.F3.sf1.1.p1.1.3.2.1.1" class="ltx_text" style="font-size:80%;">0.01</span></span>
<span id="S4.F3.sf1.1.p1.1.3.2.2" class="ltx_td ltx_align_center" style="padding:0.4pt 5.0pt;"><span id="S4.F3.sf1.1.p1.1.3.2.2.1" class="ltx_text" style="font-size:80%;">26.8</span></span>
<span id="S4.F3.sf1.1.p1.1.3.2.3" class="ltx_td ltx_align_center" style="padding:0.4pt 5.0pt;"><span id="S4.F3.sf1.1.p1.1.3.2.3.1" class="ltx_text" style="font-size:80%;">26.8</span></span>
<span id="S4.F3.sf1.1.p1.1.3.2.4" class="ltx_td ltx_align_center" style="padding:0.4pt 5.0pt;"><span id="S4.F3.sf1.1.p1.1.3.2.4.1" class="ltx_text" style="font-size:80%;">27.6</span></span>
<span id="S4.F3.sf1.1.p1.1.3.2.5" class="ltx_td ltx_align_center" style="padding:0.4pt 5.0pt;"><span id="S4.F3.sf1.1.p1.1.3.2.5.1" class="ltx_text ltx_font_bold" style="font-size:80%;">28.3</span></span></span>
<span id="S4.F3.sf1.1.p1.1.4.3" class="ltx_tr">
<span id="S4.F3.sf1.1.p1.1.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b" style="padding:0.4pt 5.0pt;"><span id="S4.F3.sf1.1.p1.1.4.3.1.1" class="ltx_text" style="font-size:80%;">0.1</span></span>
<span id="S4.F3.sf1.1.p1.1.4.3.2" class="ltx_td ltx_align_center ltx_border_b" style="padding:0.4pt 5.0pt;"><span id="S4.F3.sf1.1.p1.1.4.3.2.1" class="ltx_text" style="font-size:80%;">26.3</span></span>
<span id="S4.F3.sf1.1.p1.1.4.3.3" class="ltx_td ltx_align_center ltx_border_b" style="padding:0.4pt 5.0pt;"><span id="S4.F3.sf1.1.p1.1.4.3.3.1" class="ltx_text" style="font-size:80%;">26.8</span></span>
<span id="S4.F3.sf1.1.p1.1.4.3.4" class="ltx_td ltx_align_center ltx_border_b" style="padding:0.4pt 5.0pt;"><span id="S4.F3.sf1.1.p1.1.4.3.4.1" class="ltx_text" style="font-size:80%;">27.2</span></span>
<span id="S4.F3.sf1.1.p1.1.4.3.5" class="ltx_td ltx_align_center ltx_border_b" style="padding:0.4pt 5.0pt;"><span id="S4.F3.sf1.1.p1.1.4.3.5.1" class="ltx_text" style="font-size:80%;">28.0</span></span></span>
</span>
</span>
</span></span>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F3.sf1.3.1.1" class="ltx_text" style="font-size:90%;">(a)</span> </span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell 
                  ltx_flex_size_1">
<figure id="S4.F3.sf2" class="ltx_figure ltx_flex_size_1 ltx_align_center"><span id="S4.F3.sf2.1" class="ltx_inline-para ltx_minipage ltx_align_middle" style="width:130.1pt;">
<span id="S4.F3.sf2.1.p1" class="ltx_para ltx_align_center">
<span id="S4.F3.sf2.1.p1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<span class="ltx_thead">
<span id="S4.F3.sf2.1.p1.1.1.1" class="ltx_tr">
<span id="S4.F3.sf2.1.p1.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t" style="padding:0.4pt 5.0pt;"><span id="S4.F3.sf2.1.p1.1.1.1.1.1" class="ltx_text" style="font-size:80%;">Dimension</span></span>
<span id="S4.F3.sf2.1.p1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding:0.4pt 5.0pt;"><span id="S4.F3.sf2.1.p1.1.1.1.2.1" class="ltx_text" style="font-size:80%;">mIoU</span></span></span>
</span>
<span class="ltx_tbody">
<span id="S4.F3.sf2.1.p1.1.2.1" class="ltx_tr">
<span id="S4.F3.sf2.1.p1.1.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding:0.4pt 5.0pt;"><span id="S4.F3.sf2.1.p1.1.2.1.1.1" class="ltx_text" style="font-size:80%;">384</span></span>
<span id="S4.F3.sf2.1.p1.1.2.1.2" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.4pt 5.0pt;"><span id="S4.F3.sf2.1.p1.1.2.1.2.1" class="ltx_text" style="font-size:80%;">28.3</span></span></span>
<span id="S4.F3.sf2.1.p1.1.3.2" class="ltx_tr">
<span id="S4.F3.sf2.1.p1.1.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding:0.4pt 5.0pt;"><span id="S4.F3.sf2.1.p1.1.3.2.1.1" class="ltx_text" style="font-size:80%;">512</span></span>
<span id="S4.F3.sf2.1.p1.1.3.2.2" class="ltx_td ltx_align_center" style="padding:0.4pt 5.0pt;"><span id="S4.F3.sf2.1.p1.1.3.2.2.1" class="ltx_text" style="font-size:80%;">28.6</span></span></span>
<span id="S4.F3.sf2.1.p1.1.4.3" class="ltx_tr">
<span id="S4.F3.sf2.1.p1.1.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b" style="padding:0.4pt 5.0pt;"><span id="S4.F3.sf2.1.p1.1.4.3.1.1" class="ltx_text" style="font-size:80%;">1024</span></span>
<span id="S4.F3.sf2.1.p1.1.4.3.2" class="ltx_td ltx_align_center ltx_border_b" style="padding:0.4pt 5.0pt;"><span id="S4.F3.sf2.1.p1.1.4.3.2.1" class="ltx_text ltx_font_bold" style="font-size:80%;">28.8</span></span></span>
</span>
</span>
</span></span>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F3.sf2.3.1.1" class="ltx_text" style="font-size:90%;">(b)</span> </span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell 
                  ltx_flex_size_1">
<figure id="S4.F3.sf3" class="ltx_figure ltx_flex_size_1 ltx_align_center"><span id="S4.F3.sf3.1" class="ltx_inline-para ltx_minipage ltx_align_middle" style="width:130.1pt;">
<span id="S4.F3.sf3.1.p1" class="ltx_para ltx_align_center">
<span id="S4.F3.sf3.1.p1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<span class="ltx_thead">
<span id="S4.F3.sf3.1.p1.1.1.1" class="ltx_tr">
<span id="S4.F3.sf3.1.p1.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t" style="padding:0.4pt 5.0pt;"><span id="S4.F3.sf3.1.p1.1.1.1.1.1" class="ltx_text" style="font-size:80%;">Similarity</span></span>
<span id="S4.F3.sf3.1.p1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding:0.4pt 5.0pt;"><span id="S4.F3.sf3.1.p1.1.1.1.2.1" class="ltx_text" style="font-size:80%;">mIoU</span></span></span>
</span>
<span class="ltx_tbody">
<span id="S4.F3.sf3.1.p1.1.2.1" class="ltx_tr">
<span id="S4.F3.sf3.1.p1.1.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding:0.4pt 5.0pt;"><span id="S4.F3.sf3.1.p1.1.2.1.1.1" class="ltx_text" style="font-size:80%;">identity</span></span>
<span id="S4.F3.sf3.1.p1.1.2.1.2" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.4pt 5.0pt;"><span id="S4.F3.sf3.1.p1.1.2.1.2.1" class="ltx_text ltx_font_bold" style="font-size:80%;">28.8</span></span></span>
<span id="S4.F3.sf3.1.p1.1.3.2" class="ltx_tr">
<span id="S4.F3.sf3.1.p1.1.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b" style="padding:0.4pt 5.0pt;"><span id="S4.F3.sf3.1.p1.1.3.2.1.1" class="ltx_text" style="font-size:80%;">tf-idf</span></span>
<span id="S4.F3.sf3.1.p1.1.3.2.2" class="ltx_td ltx_align_center ltx_border_b" style="padding:0.4pt 5.0pt;"><span id="S4.F3.sf3.1.p1.1.3.2.2.1" class="ltx_text" style="font-size:80%;">28.4</span></span></span>
</span>
</span>
</span></span>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F3.sf3.3.1.1" class="ltx_text" style="font-size:90%;">(c)</span> </span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell 
                  ltx_flex_size_1">
<figure id="S4.F3.sf4" class="ltx_figure ltx_flex_size_1 ltx_align_center"><span id="S4.F3.sf4.1" class="ltx_inline-para ltx_minipage ltx_align_middle" style="width:130.1pt;">
<span id="S4.F3.sf4.1.p1" class="ltx_para ltx_align_center">
<span id="S4.F3.sf4.1.p1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<span class="ltx_thead">
<span id="S4.F3.sf4.1.p1.1.1.1" class="ltx_tr">
<span id="S4.F3.sf4.1.p1.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t" style="padding:0.4pt 5.0pt;"><span id="S4.F3.sf4.1.p1.1.1.1.1.1" class="ltx_text" style="font-size:80%;">Dataset Size</span></span>
<span id="S4.F3.sf4.1.p1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding:0.4pt 5.0pt;"><span id="S4.F3.sf4.1.p1.1.1.1.2.1" class="ltx_text" style="font-size:80%;">mIoU</span></span></span>
</span>
<span class="ltx_tbody">
<span id="S4.F3.sf4.1.p1.1.2.1" class="ltx_tr">
<span id="S4.F3.sf4.1.p1.1.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding:0.4pt 5.0pt;"><span id="S4.F3.sf4.1.p1.1.2.1.1.1" class="ltx_text" style="font-size:80%;">10%</span></span>
<span id="S4.F3.sf4.1.p1.1.2.1.2" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.4pt 5.0pt;"><span id="S4.F3.sf4.1.p1.1.2.1.2.1" class="ltx_text" style="font-size:80%;">16.2</span></span></span>
<span id="S4.F3.sf4.1.p1.1.3.2" class="ltx_tr">
<span id="S4.F3.sf4.1.p1.1.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding:0.4pt 5.0pt;"><span id="S4.F3.sf4.1.p1.1.3.2.1.1" class="ltx_text" style="font-size:80%;">50%</span></span>
<span id="S4.F3.sf4.1.p1.1.3.2.2" class="ltx_td ltx_align_center" style="padding:0.4pt 5.0pt;"><span id="S4.F3.sf4.1.p1.1.3.2.2.1" class="ltx_text" style="font-size:80%;">25.3</span></span></span>
<span id="S4.F3.sf4.1.p1.1.4.3" class="ltx_tr">
<span id="S4.F3.sf4.1.p1.1.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b" style="padding:0.4pt 5.0pt;"><span id="S4.F3.sf4.1.p1.1.4.3.1.1" class="ltx_text" style="font-size:80%;">100%</span></span>
<span id="S4.F3.sf4.1.p1.1.4.3.2" class="ltx_td ltx_align_center ltx_border_b" style="padding:0.4pt 5.0pt;"><span id="S4.F3.sf4.1.p1.1.4.3.2.1" class="ltx_text" style="font-size:80%;">28.8</span></span></span>
</span>
</span>
</span></span>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F3.sf4.3.1.1" class="ltx_text" style="font-size:90%;">(d)</span> </span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell 
                  ltx_flex_size_1">
<figure id="S4.F3.sf5" class="ltx_figure ltx_flex_size_1 ltx_align_center"><span id="S4.F3.sf5.1" class="ltx_inline-para ltx_minipage ltx_align_middle" style="width:130.1pt;">
<span id="S4.F3.sf5.1.p1" class="ltx_para ltx_align_center">
<span id="S4.F3.sf5.1.p1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<span class="ltx_thead">
<span id="S4.F3.sf5.1.p1.1.1.1" class="ltx_tr">
<span id="S4.F3.sf5.1.p1.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t" style="padding:0.4pt 5.0pt;"><span id="S4.F3.sf5.1.p1.1.1.1.1.1" class="ltx_text" style="font-size:80%;">Dataset</span></span>
<span id="S4.F3.sf5.1.p1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding:0.4pt 5.0pt;"><span id="S4.F3.sf5.1.p1.1.1.1.2.1" class="ltx_text" style="font-size:80%;">mIoU</span></span></span>
</span>
<span class="ltx_tbody">
<span id="S4.F3.sf5.1.p1.1.2.1" class="ltx_tr">
<span id="S4.F3.sf5.1.p1.1.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding:0.4pt 5.0pt;"><span id="S4.F3.sf5.1.p1.1.2.1.1.1" class="ltx_text" style="font-size:80%;">ImageNet</span></span>
<span id="S4.F3.sf5.1.p1.1.2.1.2" class="ltx_td ltx_align_center ltx_border_t" style="padding:0.4pt 5.0pt;"><span id="S4.F3.sf5.1.p1.1.2.1.2.1" class="ltx_text" style="font-size:80%;">28.8</span></span></span>
<span id="S4.F3.sf5.1.p1.1.3.2" class="ltx_tr">
<span id="S4.F3.sf5.1.p1.1.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b" style="padding:0.4pt 5.0pt;"><span id="S4.F3.sf5.1.p1.1.3.2.1.1" class="ltx_text" style="font-size:80%;">COCO</span></span>
<span id="S4.F3.sf5.1.p1.1.3.2.2" class="ltx_td ltx_align_center ltx_border_b" style="padding:0.4pt 5.0pt;"><span id="S4.F3.sf5.1.p1.1.3.2.2.1" class="ltx_text ltx_font_bold" style="font-size:80%;">31.7</span></span></span>
</span>
</span>
</span></span>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F3.sf5.3.1.1" class="ltx_text" style="font-size:90%;">(e)</span> </span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S4.T2.2.1.1" class="ltx_text" style="font-size:90%;">Table 2</span>: </span><span id="S4.T2.3.2" class="ltx_text" style="font-size:90%;">Ablations of TSEG with ViT-S/16 as the image encoder and Bert-Small as the language model on PhraseCut validation set.</span></figcaption>
</figure>
<div id="S4.SS4.p1" class="ltx_para">
<p id="S4.SS4.p1.1" class="ltx_p">We now perform weakly-supervised referring expression segmentation. At train
time the model has to maximize the score of the image and text embeddings of
correct pairings while minimizing the score of incorrect pairings. At test time,
following the standard visual grounding setting, the model is given as input the
set of referring expressions present in the image and outputs a mask for each
referring expression. TSEG uses the proposed MPA to compute scores from
patch-text similarities.
<br class="ltx_break"></p>
</div>
<div id="S4.SS4.p2" class="ltx_para">
<p id="S4.SS4.p2.10" class="ltx_p">Table <a href="#S4.T2" title="Table 2 ‣ 4.4 TSEG ablations ‣ 4 Experiments ‣ Weakly-supervised segmentation of referring expressions" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> reports ablations of our TSEG model on the PhraseCut
validation set. First, we ablate over the size penalty parameters <math id="S4.SS4.p2.1.m1.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S4.SS4.p2.1.m1.1a"><mi id="S4.SS4.p2.1.m1.1.1" xref="S4.SS4.p2.1.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.1.m1.1b"><ci id="S4.SS4.p2.1.m1.1.1.cmml" xref="S4.SS4.p2.1.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.1.m1.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p2.1.m1.1d">italic_λ</annotation></semantics></math> and
<math id="S4.SS4.p2.2.m2.1" class="ltx_Math" alttext="p" display="inline"><semantics id="S4.SS4.p2.2.m2.1a"><mi id="S4.SS4.p2.2.m2.1.1" xref="S4.SS4.p2.2.m2.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.2.m2.1b"><ci id="S4.SS4.p2.2.m2.1.1.cmml" xref="S4.SS4.p2.2.m2.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.2.m2.1c">p</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p2.2.m2.1d">italic_p</annotation></semantics></math> from Eq. <a href="#S3.E7" title="(7) ‣ 3.2 Global Pooling Mechanisms ‣ 3 Method ‣ Weakly-supervised segmentation of referring expressions" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a> in Table <a href="#S4.T2" title="Table 2 ‣ 4.4 TSEG ablations ‣ 4 Experiments ‣ Weakly-supervised segmentation of referring expressions" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>a. Smaller <math id="S4.SS4.p2.3.m3.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S4.SS4.p2.3.m3.1a"><mi id="S4.SS4.p2.3.m3.1.1" xref="S4.SS4.p2.3.m3.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.3.m3.1b"><ci id="S4.SS4.p2.3.m3.1.1.cmml" xref="S4.SS4.p2.3.m3.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.3.m3.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p2.3.m3.1d">italic_λ</annotation></semantics></math>
values induce a larger penalty for masks with a small size and larger <math id="S4.SS4.p2.4.m4.1" class="ltx_Math" alttext="p" display="inline"><semantics id="S4.SS4.p2.4.m4.1a"><mi id="S4.SS4.p2.4.m4.1.1" xref="S4.SS4.p2.4.m4.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.4.m4.1b"><ci id="S4.SS4.p2.4.m4.1.1.cmml" xref="S4.SS4.p2.4.m4.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.4.m4.1c">p</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p2.4.m4.1d">italic_p</annotation></semantics></math> values
increase the focal penalty term, see <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib39" title="" class="ltx_ref">39</a>]</cite> for more details.
We find TSEG is quite robust to the objective hyperparameters <math id="S4.SS4.p2.5.m5.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S4.SS4.p2.5.m5.1a"><mi id="S4.SS4.p2.5.m5.1.1" xref="S4.SS4.p2.5.m5.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.5.m5.1b"><ci id="S4.SS4.p2.5.m5.1.1.cmml" xref="S4.SS4.p2.5.m5.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.5.m5.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p2.5.m5.1d">italic_λ</annotation></semantics></math> and <math id="S4.SS4.p2.6.m6.1" class="ltx_Math" alttext="p" display="inline"><semantics id="S4.SS4.p2.6.m6.1a"><mi id="S4.SS4.p2.6.m6.1.1" xref="S4.SS4.p2.6.m6.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.6.m6.1b"><ci id="S4.SS4.p2.6.m6.1.1.cmml" xref="S4.SS4.p2.6.m6.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.6.m6.1c">p</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p2.6.m6.1d">italic_p</annotation></semantics></math>.
The best values are <math id="S4.SS4.p2.7.m7.1" class="ltx_Math" alttext="\lambda=0.01" display="inline"><semantics id="S4.SS4.p2.7.m7.1a"><mrow id="S4.SS4.p2.7.m7.1.1" xref="S4.SS4.p2.7.m7.1.1.cmml"><mi id="S4.SS4.p2.7.m7.1.1.2" xref="S4.SS4.p2.7.m7.1.1.2.cmml">λ</mi><mo id="S4.SS4.p2.7.m7.1.1.1" xref="S4.SS4.p2.7.m7.1.1.1.cmml">=</mo><mn id="S4.SS4.p2.7.m7.1.1.3" xref="S4.SS4.p2.7.m7.1.1.3.cmml">0.01</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.7.m7.1b"><apply id="S4.SS4.p2.7.m7.1.1.cmml" xref="S4.SS4.p2.7.m7.1.1"><eq id="S4.SS4.p2.7.m7.1.1.1.cmml" xref="S4.SS4.p2.7.m7.1.1.1"></eq><ci id="S4.SS4.p2.7.m7.1.1.2.cmml" xref="S4.SS4.p2.7.m7.1.1.2">𝜆</ci><cn type="float" id="S4.SS4.p2.7.m7.1.1.3.cmml" xref="S4.SS4.p2.7.m7.1.1.3">0.01</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.7.m7.1c">\lambda=0.01</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p2.7.m7.1d">italic_λ = 0.01</annotation></semantics></math> and <math id="S4.SS4.p2.8.m8.1" class="ltx_Math" alttext="p=5" display="inline"><semantics id="S4.SS4.p2.8.m8.1a"><mrow id="S4.SS4.p2.8.m8.1.1" xref="S4.SS4.p2.8.m8.1.1.cmml"><mi id="S4.SS4.p2.8.m8.1.1.2" xref="S4.SS4.p2.8.m8.1.1.2.cmml">p</mi><mo id="S4.SS4.p2.8.m8.1.1.1" xref="S4.SS4.p2.8.m8.1.1.1.cmml">=</mo><mn id="S4.SS4.p2.8.m8.1.1.3" xref="S4.SS4.p2.8.m8.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.8.m8.1b"><apply id="S4.SS4.p2.8.m8.1.1.cmml" xref="S4.SS4.p2.8.m8.1.1"><eq id="S4.SS4.p2.8.m8.1.1.1.cmml" xref="S4.SS4.p2.8.m8.1.1.1"></eq><ci id="S4.SS4.p2.8.m8.1.1.2.cmml" xref="S4.SS4.p2.8.m8.1.1.2">𝑝</ci><cn type="integer" id="S4.SS4.p2.8.m8.1.1.3.cmml" xref="S4.SS4.p2.8.m8.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.8.m8.1c">p=5</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p2.8.m8.1d">italic_p = 5</annotation></semantics></math>; we fix <math id="S4.SS4.p2.9.m9.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S4.SS4.p2.9.m9.1a"><mi id="S4.SS4.p2.9.m9.1.1" xref="S4.SS4.p2.9.m9.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.9.m9.1b"><ci id="S4.SS4.p2.9.m9.1.1.cmml" xref="S4.SS4.p2.9.m9.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.9.m9.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p2.9.m9.1d">italic_λ</annotation></semantics></math>
and <math id="S4.SS4.p2.10.m10.1" class="ltx_Math" alttext="p" display="inline"><semantics id="S4.SS4.p2.10.m10.1a"><mi id="S4.SS4.p2.10.m10.1.1" xref="S4.SS4.p2.10.m10.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.10.m10.1b"><ci id="S4.SS4.p2.10.m10.1.1.cmml" xref="S4.SS4.p2.10.m10.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.10.m10.1c">p</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p2.10.m10.1d">italic_p</annotation></semantics></math> to these values in the remaining of the paper.
Table <a href="#S4.T2" title="Table 2 ‣ 4.4 TSEG ablations ‣ 4 Experiments ‣ Weakly-supervised segmentation of referring expressions" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>b reports performance for different cross-modal
embedding dimension, increasing the embedding size improves results overall. In
Table <a href="#S4.T2" title="Table 2 ‣ 4.4 TSEG ablations ‣ 4 Experiments ‣ Weakly-supervised segmentation of referring expressions" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>c, we consider different definitions for the ground
truth. In the <span id="S4.SS4.p2.10.1" class="ltx_text ltx_font_italic">identity</span> setup, two referring expressions of a batch are
considered the same if they exactly match. In the <span id="S4.SS4.p2.10.2" class="ltx_text ltx_font_italic">tf-idf</span> setup, the
similarity between two referring expressions if computed according to a tf-idf
score. If a <span id="S4.SS4.p2.10.3" class="ltx_text ltx_font_italic">tabby cat</span> is present in an image, and
there is a <span id="S4.SS4.p2.10.4" class="ltx_text ltx_font_italic">brown cat</span> in a second image, the ground truth score for
<span id="S4.SS4.p2.10.5" class="ltx_text ltx_font_italic">brown cat</span> in the first image will be positive because both referring
expression share the word <span id="S4.SS4.p2.10.6" class="ltx_text ltx_font_italic">cat</span>. Using tf-idf performed slightly worse
than the identity score and we thus use <span id="S4.SS4.p2.10.7" class="ltx_text ltx_font_italic">identity</span> to define the ground
truth. Table <a href="#S4.T2" title="Table 2 ‣ 4.4 TSEG ablations ‣ 4 Experiments ‣ Weakly-supervised segmentation of referring expressions" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>d reports the validation score for an
increasing training dataset size. We observe that TSEG improves with the dataset
size, a desirable property of weakly-supervised segmentation approach where
annotations are much cheaper to collect than in the fully-supervised case.
Finally, Table <a href="#S4.T2" title="Table 2 ‣ 4.4 TSEG ablations ‣ 4 Experiments ‣ Weakly-supervised segmentation of referring expressions" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>e reports results when pretraining the visual
backbone on only ImageNet for classification or by additionally pretraining the
visual and language model on RefCOCO for visual grounding. For pretraining on
COCO we use box ground truth annotations as follows. The model is given as input
an image and referring expressions to detect, for each referring expressions the
model predicts patches that are within the object bounding box. We observe that
leveraging detection related information as pretraining improves the result by
3%. In the following we report results with ImageNet pretraining only,
following standard practice from the weakly-supervised semantic segmentation
literature.</p>
</div>
</section>
<section id="S4.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.5 </span>Weakly supervised referring expression segmentation</h3>

<figure id="S4.F4" class="ltx_figure"><img src="/html/2205.04725/assets/x4.png" id="S4.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="830" height="433" alt="">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F4.2.1.1" class="ltx_text" style="font-size:90%;">Figure 4</span>: </span><span id="S4.F4.3.2" class="ltx_text" style="font-size:90%;">Comparison of different pooling mechanisms for weakly supervised segmentation from referring expressions on example images from the PhraseCut dataset:
(a) Global average pooling (GAP), (b) Global max pooling (GMP),
(c) Single-label patch assignment (SPA), (d) TSEG with multi-label patch assignment (TSEG). (e) Fully supervised results.</span></figcaption>
</figure>
<figure id="S4.T3" class="ltx_table">
<table id="S4.T3.2" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T3.2.1.1" class="ltx_tr">
<th id="S4.T3.2.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" style="padding-left:2.7pt;padding-right:2.7pt;"><span id="S4.T3.2.1.1.1.1" class="ltx_text" style="font-size:90%;">Method</span></th>
<td id="S4.T3.2.1.1.2" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:2.7pt;padding-right:2.7pt;"><span id="S4.T3.2.1.1.2.1" class="ltx_text" style="font-size:90%;">PhraseCut</span></td>
<td id="S4.T3.2.1.1.3" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:2.7pt;padding-right:2.7pt;"><span id="S4.T3.2.1.1.3.1" class="ltx_text" style="font-size:90%;">RefCOCO</span></td>
<td id="S4.T3.2.1.1.4" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:2.7pt;padding-right:2.7pt;"><span id="S4.T3.2.1.1.4.1" class="ltx_text" style="font-size:90%;">RefCOCO+</span></td>
<td id="S4.T3.2.1.1.5" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:2.7pt;padding-right:2.7pt;"><span id="S4.T3.2.1.1.5.1" class="ltx_text" style="font-size:90%;">RefCOCOg</span></td>
</tr>
<tr id="S4.T3.2.2.2" class="ltx_tr">
<th id="S4.T3.2.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:2.7pt;padding-right:2.7pt;">
<span id="S4.T3.2.2.2.1.1" class="ltx_text" style="font-size:90%;">GMP </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T3.2.2.2.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib68" title="" class="ltx_ref">68</a><span id="S4.T3.2.2.2.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite><sup id="S4.T3.2.2.2.1.4" class="ltx_sup"><span id="S4.T3.2.2.2.1.4.1" class="ltx_text" style="font-size:90%;">†</span></sup>
</th>
<td id="S4.T3.2.2.2.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.7pt;padding-right:2.7pt;"><span id="S4.T3.2.2.2.2.1" class="ltx_text" style="font-size:90%;">5.77</span></td>
<td id="S4.T3.2.2.2.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.7pt;padding-right:2.7pt;"><span id="S4.T3.2.2.2.3.1" class="ltx_text" style="font-size:90%;">6.54</span></td>
<td id="S4.T3.2.2.2.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.7pt;padding-right:2.7pt;"><span id="S4.T3.2.2.2.4.1" class="ltx_text" style="font-size:90%;">5.12</span></td>
<td id="S4.T3.2.2.2.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.7pt;padding-right:2.7pt;"><span id="S4.T3.2.2.2.5.1" class="ltx_text" style="font-size:90%;">6.54</span></td>
</tr>
<tr id="S4.T3.2.3.3" class="ltx_tr">
<th id="S4.T3.2.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:2.7pt;padding-right:2.7pt;">
<span id="S4.T3.2.3.3.1.1" class="ltx_text" style="font-size:90%;">GAP </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T3.2.3.3.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib2" title="" class="ltx_ref">2</a><span id="S4.T3.2.3.3.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite><sup id="S4.T3.2.3.3.1.4" class="ltx_sup"><span id="S4.T3.2.3.3.1.4.1" class="ltx_text" style="font-size:90%;">†</span></sup>
</th>
<td id="S4.T3.2.3.3.2" class="ltx_td ltx_align_center" style="padding-left:2.7pt;padding-right:2.7pt;"><span id="S4.T3.2.3.3.2.1" class="ltx_text" style="font-size:90%;">9.35</span></td>
<td id="S4.T3.2.3.3.3" class="ltx_td ltx_align_center" style="padding-left:2.7pt;padding-right:2.7pt;"><span id="S4.T3.2.3.3.3.1" class="ltx_text" style="font-size:90%;">6.65</span></td>
<td id="S4.T3.2.3.3.4" class="ltx_td ltx_align_center" style="padding-left:2.7pt;padding-right:2.7pt;"><span id="S4.T3.2.3.3.4.1" class="ltx_text" style="font-size:90%;">7.21</span></td>
<td id="S4.T3.2.3.3.5" class="ltx_td ltx_align_center" style="padding-left:2.7pt;padding-right:2.7pt;"><span id="S4.T3.2.3.3.5.1" class="ltx_text" style="font-size:90%;">6.07</span></td>
</tr>
<tr id="S4.T3.2.4.4" class="ltx_tr">
<th id="S4.T3.2.4.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:2.7pt;padding-right:2.7pt;">
<span id="S4.T3.2.4.4.1.1" class="ltx_text" style="font-size:90%;">SPA </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T3.2.4.4.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib3" title="" class="ltx_ref">3</a><span id="S4.T3.2.4.4.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite><sup id="S4.T3.2.4.4.1.4" class="ltx_sup"><span id="S4.T3.2.4.4.1.4.1" class="ltx_text" style="font-size:90%;">†</span></sup>
</th>
<td id="S4.T3.2.4.4.2" class="ltx_td ltx_align_center" style="padding-left:2.7pt;padding-right:2.7pt;"><span id="S4.T3.2.4.4.2.1" class="ltx_text" style="font-size:90%;">21.12</span></td>
<td id="S4.T3.2.4.4.3" class="ltx_td ltx_align_center" style="padding-left:2.7pt;padding-right:2.7pt;"><span id="S4.T3.2.4.4.3.1" class="ltx_text" style="font-size:90%;">10.32</span></td>
<td id="S4.T3.2.4.4.4" class="ltx_td ltx_align_center" style="padding-left:2.7pt;padding-right:2.7pt;"><span id="S4.T3.2.4.4.4.1" class="ltx_text" style="font-size:90%;">9.16</span></td>
<td id="S4.T3.2.4.4.5" class="ltx_td ltx_align_center" style="padding-left:2.7pt;padding-right:2.7pt;"><span id="S4.T3.2.4.4.5.1" class="ltx_text" style="font-size:90%;">8.35</span></td>
</tr>
<tr id="S4.T3.2.5.5" class="ltx_tr">
<th id="S4.T3.2.5.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:2.7pt;padding-right:2.7pt;"><span id="S4.T3.2.5.5.1.1" class="ltx_text" style="font-size:90%;">TSEG</span></th>
<td id="S4.T3.2.5.5.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.7pt;padding-right:2.7pt;"><span id="S4.T3.2.5.5.2.1" class="ltx_text" style="font-size:90%;">28.77</span></td>
<td id="S4.T3.2.5.5.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.7pt;padding-right:2.7pt;"><span id="S4.T3.2.5.5.3.1" class="ltx_text" style="font-size:90%;">25.44</span></td>
<td id="S4.T3.2.5.5.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.7pt;padding-right:2.7pt;"><span id="S4.T3.2.5.5.4.1" class="ltx_text" style="font-size:90%;">22.01</span></td>
<td id="S4.T3.2.5.5.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.7pt;padding-right:2.7pt;"><span id="S4.T3.2.5.5.5.1" class="ltx_text" style="font-size:90%;">22.05</span></td>
</tr>
<tr id="S4.T3.2.6.6" class="ltx_tr">
<th id="S4.T3.2.6.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" style="padding-left:2.7pt;padding-right:2.7pt;"><span id="S4.T3.2.6.6.1.1" class="ltx_text" style="font-size:90%;">TSEG (CRF)</span></th>
<td id="S4.T3.2.6.6.2" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:2.7pt;padding-right:2.7pt;"><span id="S4.T3.2.6.6.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">30.12</span></td>
<td id="S4.T3.2.6.6.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:2.7pt;padding-right:2.7pt;"><span id="S4.T3.2.6.6.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">25.95</span></td>
<td id="S4.T3.2.6.6.4" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:2.7pt;padding-right:2.7pt;"><span id="S4.T3.2.6.6.4.1" class="ltx_text ltx_font_bold" style="font-size:90%;">22.62</span></td>
<td id="S4.T3.2.6.6.5" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:2.7pt;padding-right:2.7pt;"><span id="S4.T3.2.6.6.5.1" class="ltx_text ltx_font_bold" style="font-size:90%;">23.41</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 3: </span>Comparison of different weakly-supervised methods for referring expression segmentation on
Phrasecut and RefCOCO validation set. <sup id="S4.T3.8.1" class="ltx_sup">†</sup>  denotes our implementation,
validated in Table <a href="#S4.T1" title="Table 1 ‣ 4.3 State-of-the-art methods for weakly-supervised semantic segmentation ‣ 4 Experiments ‣ Weakly-supervised segmentation of referring expressions" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.</figcaption>
</figure>
<div id="S4.SS5.p1" class="ltx_para">
<p id="S4.SS5.p1.1" class="ltx_p">We now compare TSEG on referring expression datasets to
weakly supervised <span id="S4.SS5.p1.1.1" class="ltx_text ltx_font_italic">state-of-the-art</span> methods presented in Section <a href="#S4.SS3" title="4.3 State-of-the-art methods for weakly-supervised semantic segmentation ‣ 4 Experiments ‣ Weakly-supervised segmentation of referring expressions" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.3</span></a>, we
report results in Table <a href="#S4.T3" title="Table 3 ‣ 4.5 Weakly supervised referring expression segmentation ‣ 4 Experiments ‣ Weakly-supervised segmentation of referring expressions" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> and show qualitative results in Figure
<a href="#S4.F4" title="Figure 4 ‣ 4.5 Weakly supervised referring expression segmentation ‣ 4 Experiments ‣ Weakly-supervised segmentation of referring expressions" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>.
<br class="ltx_break"></p>
</div>
<div id="S4.SS5.p2" class="ltx_para ltx_noindent">
<p id="S4.SS5.p2.1" class="ltx_p"><span id="S4.SS5.p2.1.1" class="ltx_text ltx_font_bold">PhraseCut:</span> GMP and GAP achieve an mIoU of 5.7 and 9.3
respectively, showing that it is possible to learn meaningful masks using
referring expressions as labels. However, GAP averages patch-text similarity
scores and depends on the instance mask size which tends to generate
over-saturated activation maps (Fig. <a href="#S4.F4" title="Figure 4 ‣ 4.5 Weakly supervised referring expression segmentation ‣ 4 Experiments ‣ Weakly-supervised segmentation of referring expressions" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>a). GMP exhibits
complementary properties focusing on the most discriminative object parts
(Fig. <a href="#S4.F4" title="Figure 4 ‣ 4.5 Weakly supervised referring expression segmentation ‣ 4 Experiments ‣ Weakly-supervised segmentation of referring expressions" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>b). SPA outperforms GAP and GMP with a mIoU of 21.1,
consistent with results on Pascal VOC 2012, see Table <a href="#S4.T1" title="Table 1 ‣ 4.3 State-of-the-art methods for weakly-supervised semantic segmentation ‣ 4 Experiments ‣ Weakly-supervised segmentation of referring expressions" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.
MPA further improves SPA by 7%, with 28.77% mIoU on Phrasecut, showing its
crucial importance for referring expression segmentation. This improvement can
partly be explained by the fact that our objective allows multiple masks to
overlap by design, a highly desirable property that is not satisfied by GMP, GAP
and SPA. From Figure <a href="#S4.F4" title="Figure 4 ‣ 4.5 Weakly supervised referring expression segmentation ‣ 4 Experiments ‣ Weakly-supervised segmentation of referring expressions" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>d we observe that MPA generates more
complete masks with both higher recall, e.g. the <span id="S4.SS5.p2.1.2" class="ltx_text ltx_font_italic">thumb on bun</span> instance
is detected, and we obtain higher precision, e.g. masks achieve better
completeness as for the <span id="S4.SS5.p2.1.3" class="ltx_text ltx_font_italic">sitting woman</span> instance. Using CRF
<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> further improves the performance to 30.12 mIoU. Qualitative
results are presented in Figure <a href="#S4.F5" title="Figure 5 ‣ 4.5 Weakly supervised referring expression segmentation ‣ 4 Experiments ‣ Weakly-supervised segmentation of referring expressions" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>.
<br class="ltx_break"></p>
</div>
<figure id="S4.F5" class="ltx_figure"><img src="/html/2205.04725/assets/x5.png" id="S4.F5.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="830" height="229" alt="">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F5.2.1.1" class="ltx_text" style="font-size:90%;">Figure 5</span>: </span><span id="S4.F5.3.2" class="ltx_text" style="font-size:90%;">TSEG segmentation results on the PhraseCut test set. Our method segments
a rich set of open-vocabulary concepts without using pixel-level supervision at the training.</span></figcaption>
</figure>
<div id="S4.SS5.p3" class="ltx_para">
<p id="S4.SS5.p3.1" class="ltx_p">To obtain an upper-bound, we also train TSEG with full supervision and obtain a
49.6 mIoU. This is close to the best fully supervised method MDETR
<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite>, which obtains 53.1 mIoU while pretraining on a much large
dataset annotated for visual grounding and higher training resolution. While
there is still a gap compared to full supervision, we believe our proposed
results to be promising and the first step towards large-scale weakly supervised
referring expression segmentation. Additional qualitative results and comparison
to the fully-supervised model are presented in the appendix.
<br class="ltx_break"></p>
</div>
<div id="S4.SS5.p4" class="ltx_para ltx_noindent">
<p id="S4.SS5.p4.1" class="ltx_p"><span id="S4.SS5.p4.1.1" class="ltx_text ltx_font_bold">RefCOCO:</span> We also evaluate our method on the three RefCOCO
datasets and report results on the <span id="S4.SS5.p4.1.2" class="ltx_text ltx_font_italic">val</span> split in Table <a href="#S4.T3" title="Table 3 ‣ 4.5 Weakly supervised referring expression segmentation ‣ 4 Experiments ‣ Weakly-supervised segmentation of referring expressions" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>.
Again, MPA outperforms GMP, GAP and SPA by a large margin. Training TSEG with full
supervision we obtain 66.00 mIoU on RefCOCO, 55.35 on RefCOCO+ and 54.71 on
RefCOCOg. This is slightly better than the best fully supervised method VLT
<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>, which obtains 65.65, 55.50 and 52.99 mIoU respectively. There is
a larger gain from using full supervision than on PhraseCut. This could be
explained by more fine-grained referring expressions such as <span id="S4.SS5.p4.1.3" class="ltx_text ltx_font_italic">broccoli
stalk that is pointing up and is touching a sliced carrot</span> or <span id="S4.SS5.p4.1.4" class="ltx_text ltx_font_italic">a darker
brown teddy bear in a row of lighter teddy bears</span> that are harder to localize
without pixel-level supervision.</p>
</div>
<figure id="S4.F6" class="ltx_figure"><img src="/html/2205.04725/assets/x6.png" id="S4.F6.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="830" height="284" alt="">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F6.2.1.1" class="ltx_text" style="font-size:90%;">Figure 6</span>: </span><span id="S4.F6.3.2" class="ltx_text" style="font-size:90%;">Zero-shot transfer of our approach TSEG trained from text supervision
on PhraseCut and evaluated on Pascal VOC 2012. The method has not been explicitly trained for PASCAL classes and has never obtained pixel-level supervision.</span></figcaption>
</figure>
</section>
<section id="S4.SS6" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.6 </span>Zero-shot transfer on Pascal VOC</h3>

<div id="S4.SS6.p1" class="ltx_para">
<p id="S4.SS6.p1.1" class="ltx_p">We evaluate the ability of TSEG to detect and localize visual concepts from text
supervision by performing zero-shot experiments on Pascal VOC 2012 dataset, see
Fig. <a href="#S4.F6" title="Figure 6 ‣ 4.5 Weakly supervised referring expression segmentation ‣ 4 Experiments ‣ Weakly-supervised segmentation of referring expressions" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>. We take our TSEG model trained on the PhraseCut
dataset, i.e., with the text supervision based on the referring expressions from
PhraseCut. We, then, pass the names of Pascal classes as input to the text
encoder and obtain segmentation masks and confidence scores for all 20 object
classes in each image. We filter classes by thresholding with the model
confidence scores then use argmax between the remaining masks to determine the
class of each pixel. We set the threshold to 0.5.
<br class="ltx_break"></p>
</div>
<div id="S4.SS6.p2" class="ltx_para">
<p id="S4.SS6.p2.1" class="ltx_p">In the zero-shot setting, our TSEG model achieves an mIoU of 48.5 while the SPA
baseline achieves an mIoU of 43.5. Interestingly, TSEG performs well on all
classes except the <span id="S4.SS6.p2.1.1" class="ltx_text ltx_font_italic">person</span> class. As can be observed from
Figure <a href="#S4.F7" title="Figure 7 ‣ 4.6 Zero-shot transfer on Pascal VOC ‣ 4 Experiments ‣ Weakly-supervised segmentation of referring expressions" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>, the model does not detect the <span id="S4.SS6.p2.1.2" class="ltx_text ltx_font_italic">person</span>
label, but can be improved with label engineering by using more specific labels
for the text encoder, such as <span id="S4.SS6.p2.1.3" class="ltx_text ltx_font_italic">woman</span> and <span id="S4.SS6.p2.1.4" class="ltx_text ltx_font_italic">rider</span>. This bias
partly comes from the annotations of PhraseCut training set and we believe that
the need for label engineering may be reduced by training TSEG on a larger
dataset with richer text annotations. On the person class, by passing
<span id="S4.SS6.p2.1.5" class="ltx_text ltx_font_italic">person</span> as input to the text encoder we obtain an IoU of 0.6 while by
merging masks for the words <span id="S4.SS6.p2.1.6" class="ltx_text ltx_font_italic">man, woman, men, women, child, boy, girl,
baby</span> we improve the IoU to 30.4. By performing label engineering, TSEG reaches
50.3 mIoU. In comparison, GroupViT <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib61" title="" class="ltx_ref">61</a>]</cite> reports an mIoU of
51.2, but it has been trained on a much larger dataset of 30M image-text pairs
and was designed for zero-shot segmentation. TSEG performs comparably to
GroupViT, while trained on 350k image-text pairs. This demonstrates the ability
of our approach to learn general visual concepts accurately.</p>
</div>
<figure id="S4.F7" class="ltx_figure"><img src="/html/2205.04725/assets/x7.png" id="S4.F7.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="497" height="270" alt="">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F7.5.1.1" class="ltx_text" style="font-size:90%;">Figure 7</span>: </span><span id="S4.F7.6.2" class="ltx_text" style="font-size:90%;">Failure cases on the person class for zero-shot results on Pascal
VOC 2012. While the horse (violet) or bicycle (green) are well localized, the class person (pink) is not detected with the <span id="S4.F7.6.2.1" class="ltx_text ltx_font_italic">person</span> label (column 2). The model detects it by using
more specific labels such as <span id="S4.F7.6.2.2" class="ltx_text ltx_font_italic">rider</span> or <span id="S4.F7.6.2.3" class="ltx_text ltx_font_italic">woman</span> (column 3, pink). Column 4 shows the ground truth.</span></figcaption>
</figure>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Acknowledgements</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">This work was partially supported by the HPC resources from GENCI-IDRIS (Grant
2021-AD011011163R1), the Louis Vuitton ENS Chair on Artificial Intelligence, and
the French government under management of Agence Nationale de la Recherche as
part of the ”Investissements d’avenir” program, reference ANR-19-P3IA-0001
(PRAIRIE 3IA Institute).</p>
</div>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusion</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">This work introduces TSEG for weakly-supervised referring expression
segmentation. We propose a multi-label patch assignment (MPA) mechanism that
improves previous methods by a margin on this task. We believe our work makes
an important step towards scalable image segmentation from natural language.
Future work will address how to reduce the performance gap between weakly
supervised and fully supervised methods and segment regions directly from
image captions.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
Ahn, J., Cho, S., Kwak, S.: Weakly supervised learning of instance segmentation
with inter-pixel relations. In: CVPR (2019)

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
Ahn, J., Kwak, S.: Learning pixel-level semantic affinity with image-level
supervision for weakly supervised semantic segmentation. In: CVPR (2018)

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
Araslanov, N., Roth, S.: Single-stage semantic segmentation from image labels.
In: CVPR (2020)

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
Arnab, A., Dehghani, M., Heigold, G., Sun, C., Lucic, M., Schmid, C.:
ViViT: A video vision transformer. ICCV (2021)

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
Bilen, H., Pedersoli, M., Tuytelaars, T.: Weakly supervised object detection
with posterior regularization. In: BMVC (2014)

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
Bojanowski, P., Lajugie, R., Bach, F., Laptev, I., Ponce, J., Schmid, C.,
Sivic, J.: Weakly supervised action labeling in videos under ordering
constraints. In: ECCV (2014)

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
Chen, K., Gao, J., Nevatia, R.: Knowledge aided consistency for weakly
supervised phrase grounding. In: CVPR (2018)

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Chen, L., Papandreou, G., Kokkinos, I., Murphy, K., Yuille, A.L.: Deeplab:
Semantic image segmentation with deep convolutional nets, atrous convolution,
and fully connected crfs. IEEE Trans. Pattern Anal. Mach. Intell.
<span id="bib.bib8.1.1" class="ltx_text ltx_font_bold">40</span>(4), 834–848 (2018)

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
Chen, L., Zhu, Y., Papandreou, G., Schroff, F., Adam, H.: Encoder-decoder with
atrous separable convolution for semantic image segmentation. In: ECCV
(2018)

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
Chen, T., Kornblith, S., Norouzi, M., Hinton, G.E.: A simple framework for
contrastive learning of visual representations. In: ICML (2020)

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
Cheng, B., Schwing, A.G., Kirillov, A.: Per-pixel classification is not all you
need for semantic segmentation. In: NIPS (2021)

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
Devlin, J., Chang, M., Lee, K., Toutanova, K.: BERT: pre-training of deep
bidirectional transformers for language understanding. In: NAACL-HLT (2019)

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
Ding, H., Liu, C., Wang, S., Jiang, X.: Vision-language transformer and query
generation for referring segmentation. In: ICCV (2021)

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
Doersch, C., Gupta, A., Efros, A.A.: Unsupervised visual representation
learning by context prediction. In: ICCV (2015)

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
Dosovitskiy, A., Beyer, L., Kolesnikov, A., Weissenborn, D., Zhai, X.,
Unterthiner, T., Dehghani, M., Minderer, M., Heigold, G., Gelly, S.,
Uszkoreit, J., Houlsby, N.: An image is worth 16x16 words: Transformers for
image recognition at scale. In: ICLR (2021)

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
Everingham, M., Gool, L.V., Williams, C.K.I., Winn, J.M., Zisserman, A.: The
pascal visual object classes (VOC) challenge. IJCV <span id="bib.bib16.1.1" class="ltx_text ltx_font_bold">88</span>(2),
303–338 (2010)

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
Fan, R., Cheng, M., Hou, Q., Mu, T., Wang, J., Hu, S.: S4Net: Single stage
salient-instance segmentation. In: CVPR (2019)

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
Fan, R., Hou, Q., Cheng, M., Yu, G., Martin, R.R., Hu, S.: Associating
inter-image salient instances for weakly supervised semantic segmentation.
In: ECCV (2018)

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
Ghadiyaram, D., Tran, D., Mahajan, D.: Large-scale weakly-supervised
pre-training for video action recognition. In: CVPR (2019)

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
Ghiasi, G., Gu, X., Cui, Y., Lin, T.: Open-vocabulary image segmentation. CoRR
(2021)

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
Gupta, T., Vahdat, A., Chechik, G., Yang, X., Kautz, J., Hoiem, D.: Contrastive
learning for weakly supervised phrase grounding. In: ECCV (2020)

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
Hariharan, B., Arbelaez, P., Bourdev, L.D., Maji, S., Malik, J.: Semantic
contours from inverse detectors. In: ICCV (2011)

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
He, K., Gkioxari, G., Dollár, P., Girshick, R.B.: Mask R-CNN. In:
ICCV (2017)

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
Hu, R., Rohrbach, M., Darrell, T.: Segmentation from natural language
expressions. In: ECCV (2016)

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
Hu, Z., Feng, G., Sun, J., Zhang, L., Lu, H.: Bi-directional relationship
inferring network for referring image segmentation. In: CVPR (2020)

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
Huang, G., Sun, Y., Liu, Z., Sedra, D., Weinberger, K.Q.: Deep networks with
stochastic depth. In: ECCV (2016)

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
Huang, Z., Wang, X., Wang, J., Liu, W., Wang, J.: Weakly-supervised semantic
segmentation network with deep seeded region growing. In: CVPR (2018)

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
Jia, C., Yang, Y., Xia, Y., Chen, Y., Parekh, Z., Pham, H., Le, Q.V., Sung, Y.,
Li, Z., Duerig, T.: Scaling up visual and vision-language representation
learning with noisy text supervision. In: ICML (2021)

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
Kamath, A., Singh, M., LeCun, Y., Misra, I., Synnaeve, G., Carion, N.: MDETR
- modulated detection for end-to-end multi-modal understanding. ICCV
(2021)

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
Kantorov, V., Oquab, M., Cho, M., Laptev, I.: Contextlocnet: Context-aware deep
network models for weakly supervised localization. In: ECCV (2016)

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
Kim, B., Han, S., Kim, J.: Discriminative region suppression for
weakly-supervised semantic segmentation. In: AAAI (2021)

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
Kingma, D.P., Ba, J.: Adam: A method for stochastic optimization. In: ICLR
(2015)

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
Kolesnikov, A., Lampert, C.H.: Seed, expand and constrain: Three principles for
weakly-supervised image segmentation. In: ECCV (2016)

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
Krishna, R., Zhu, Y., Groth, O., Johnson, J., Hata, K., Kravitz, J., Chen, S.,
Kalantidis, Y., Li, L., Shamma, D.A., Bernstein, M.S., Fei-Fei, L.: Visual
genome: Connecting language and vision using crowdsourced dense image
annotations. IJCV <span id="bib.bib34.1.1" class="ltx_text ltx_font_bold">123</span>(1), 32–73 (2017)

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock">
Lee, J., Kim, E., Lee, S., Lee, J., Yoon, S.: Frame-to-frame aggregation of
active regions in web videos for weakly supervised semantic segmentation. In:
ICCV (2019)

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock">
Lee, S., Lee, M., Lee, J., Shim, H.: Railroad is not a train: Saliency as
pseudo-pixel supervision for weakly supervised semantic segmentation. In:
CVPR (2021)

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock">
Li, D., Huang, J.B., Li, Y., Wang, S., Yang, M.H.: Weakly supervised object
localization with progressive domain adaptation. In: CVPR (2016)

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock">
Li, L.H., Yatskar, M., Yin, D., Hsieh, C., Chang, K.: VisualBERT: A simple
and performant baseline for vision and language. arXiv preprint
arXiv:1908.03557 (2019)

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock">
Lin, T., Goyal, P., Girshick, R.B., He, K., Dollár, P.: Focal loss for
dense object detection. IEEE Trans. Pattern Anal. Mach. Intell.
<span id="bib.bib39.1.1" class="ltx_text ltx_font_bold">42</span>(2), 318–327 (2020)

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock">
Liu, X., Li, L., Wang, S., Zha, Z., Meng, D., Huang, Q.: Adaptive
reconstruction network for weakly supervised referring expression grounding.
In: ICCV (2019)

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock">
Liu, Y., Wan, B., Ma, L., He, X.: Relation-aware instance refinement for weakly
supervised visual grounding. In: CVPR (2021)

</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[42]</span>
<span class="ltx_bibblock">
Liu, Z., Lin, Y., Cao, Y., Hu, H., Wei, Y., Zhang, Z., Lin, S., Guo, B.: Swin
transformer: Hierarchical vision transformer using shifted windows. In:
ICCV (2021)

</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[43]</span>
<span class="ltx_bibblock">
Loshchilov, I., Hutter, F.: Decoupled weight decay regularization. In: ICLR
(2019)

</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[44]</span>
<span class="ltx_bibblock">
Miech, A., Alayrac, J.B., Smaira, L., Laptev, I., Sivic, J., Zisserman, A.:
End-to-end learning of visual representations from uncurated instructional
videos. In: CVPR (2020)

</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[45]</span>
<span class="ltx_bibblock">
Papandreou, G., Chen, L., Murphy, K.P., Yuille, A.L.: Weakly-and
semi-supervised learning of a deep convolutional network for semantic image
segmentation. In: ICCV (2015)

</span>
</li>
<li id="bib.bib46" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[46]</span>
<span class="ltx_bibblock">
Pinheiro, P.H.O., Collobert, R.: From image-level to pixel-level labeling with
convolutional networks. In: CVPR (2015)

</span>
</li>
<li id="bib.bib47" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[47]</span>
<span class="ltx_bibblock">
Radford, A., Kim, J.W., Hallacy, C., Ramesh, A., Goh, G., Agarwal, S., Sastry,
G., Askell, A., Mishkin, P., Clark, J., Krueger, G., Sutskever, I.: Learning
transferable visual models from natural language supervision. In: ICML
(2021)

</span>
</li>
<li id="bib.bib48" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[48]</span>
<span class="ltx_bibblock">
Ramesh, A., Pavlov, M., Goh, G., Gray, S., Voss, C., Radford, A., Chen, M.,
Sutskever, I.: Zero-shot text-to-image generation. In: ICML (2021)

</span>
</li>
<li id="bib.bib49" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[49]</span>
<span class="ltx_bibblock">
Ren, S., He, K., Girshick, R.B., Sun, J.: Faster R-CNN: towards real-time
object detection with region proposal networks. PAMI <span id="bib.bib49.1.1" class="ltx_text ltx_font_bold">39</span>(6),
1137–1149 (2017)

</span>
</li>
<li id="bib.bib50" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[50]</span>
<span class="ltx_bibblock">
Robbins, H., Monro, S.: A stochastic approximation method. Annals of
Mathematical Statistics (1951)

</span>
</li>
<li id="bib.bib51" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[51]</span>
<span class="ltx_bibblock">
Sennrich, R., Haddow, B., Birch, A.: Neural machine translation of rare words
with subword units. In: ACL (2016)

</span>
</li>
<li id="bib.bib52" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[52]</span>
<span class="ltx_bibblock">
Steiner, A., Kolesnikov, A., Zhai, X., Wightman, R., Uszkoreit, J., Beyer, L.:
How to train your ViT? data, augmentation, and regularization in vision
transformers. arXiv preprint arXiv:2106.10270 (2021)

</span>
</li>
<li id="bib.bib53" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[53]</span>
<span class="ltx_bibblock">
Strudel, R., Pinel, R.G., Laptev, I., Schmid, C.: Segmenter: Transformer for
semantic segmentation. ICCV (2021)

</span>
</li>
<li id="bib.bib54" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[54]</span>
<span class="ltx_bibblock">
Turc, I., Chang, M., Lee, K., Toutanova, K.: Well-read students learn better:
The impact of student initialization on knowledge distillation. arXiv
preprint arXiv:1908.08962 (2019)

</span>
</li>
<li id="bib.bib55" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[55]</span>
<span class="ltx_bibblock">
Vaswani, A., Shazeer, N., Parmar, N., Uszkoreit, J., Jones, L., Gomez, A.N.,
Kaiser, L., Polosukhin, I.: Attention is all you need. In: NIPS (2017)

</span>
</li>
<li id="bib.bib56" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[56]</span>
<span class="ltx_bibblock">
Wang, J., Jiang, H., Yuan, Z., Cheng, M., Hu, X., Zheng, N.: Salient object
detection: A discriminative regional feature integration approach. IJCV
<span id="bib.bib56.1.1" class="ltx_text ltx_font_bold">123</span>(2), 251–268 (2017)

</span>
</li>
<li id="bib.bib57" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[57]</span>
<span class="ltx_bibblock">
Wei, Y., Feng, J., Liang, X., Cheng, M., Zhao, Y., Yan, S.: Object region
mining with adversarial erasing: A simple classification to semantic
segmentation approach. In: CVPR (2017)

</span>
</li>
<li id="bib.bib58" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[58]</span>
<span class="ltx_bibblock">
Wei, Y., Xiao, H., Shi, H., Jie, Z., Feng, J., Huang, T.S.: Revisiting dilated
convolution: A simple approach for weakly- and semi-supervised semantic
segmentation. In: CVPR (2018)

</span>
</li>
<li id="bib.bib59" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[59]</span>
<span class="ltx_bibblock">
Wu, C., Lin, Z., Cohen, S., Bui, T., Maji, S.: Phrasecut: Language-based image
segmentation in the wild. In: CVPR (2020)

</span>
</li>
<li id="bib.bib60" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[60]</span>
<span class="ltx_bibblock">
Xiao, F., Sigal, L., Lee, Y.J.: Weakly-supervised visual grounding of phrases
with linguistic structures. In: CVPR (2017)

</span>
</li>
<li id="bib.bib61" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[61]</span>
<span class="ltx_bibblock">
Xu, J., Mello, S.D., Liu, S., Byeon, W., Breuel, T.M., Kautz, J., Wang, X.:
Groupvit: Semantic segmentation emerges from text supervision. CoRR (2022)

</span>
</li>
<li id="bib.bib62" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[62]</span>
<span class="ltx_bibblock">
Xu, M., Zhang, Z., Wei, F., Lin, Y., Cao, Y., Hu, H., Bai, X.: A simple
baseline for zero-shot semantic segmentation with pre-trained vision-language
model. CoRR (2021)

</span>
</li>
<li id="bib.bib63" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[63]</span>
<span class="ltx_bibblock">
Ye, L., Rochan, M., Liu, Z., Wang, Y.: Cross-modal self-attention network for
referring image segmentation. In: CVPR (2019)

</span>
</li>
<li id="bib.bib64" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[64]</span>
<span class="ltx_bibblock">
Yu, L., Lin, Z., Shen, X., Yang, J., Lu, X., Bansal, M., Berg, T.L.: Mattnet:
Modular attention network for referring expression comprehension. In: CVPR
(2018)

</span>
</li>
<li id="bib.bib65" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[65]</span>
<span class="ltx_bibblock">
Yu, L., Poirson, P., Yang, S., Berg, A.C., Berg, T.L.: Modeling context in
referring expressions. In: ECCV (2016)

</span>
</li>
<li id="bib.bib66" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[66]</span>
<span class="ltx_bibblock">
Yu, Z., Zhuge, Y., Lu, H., Zhang, L.: Joint learning of saliency detection and
weakly supervised semantic segmentation. In: ICCV (2019)

</span>
</li>
<li id="bib.bib67" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[67]</span>
<span class="ltx_bibblock">
Zabari, N., Hoshen, Y.: Semantic segmentation in-the-wild without seeing any
segmentation examples. CoRR (2021)

</span>
</li>
<li id="bib.bib68" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[68]</span>
<span class="ltx_bibblock">
Zhou, B., Khosla, A., Lapedriza, À., Oliva, A., Torralba, A.: Learning
deep features for discriminative localization. In: CVPR (2016)

</span>
</li>
<li id="bib.bib69" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[69]</span>
<span class="ltx_bibblock">
Zhou, C., Loy, C.C., Dai, B.: Denseclip: Extract free dense labels from CLIP.
CoRR (2021)

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section id="S7" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7 </span>Appendix</h2>

<div id="S7.p1" class="ltx_para">
<p id="S7.p1.1" class="ltx_p"><span id="S7.p1.1.1" class="ltx_text ltx_font_bold">Qualitative results.</span>
We present additional qualitative results in
Figures <a href="#S7.F8" title="Figure 8 ‣ 7 Appendix ‣ Weakly-supervised segmentation of referring expressions" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a> and <a href="#S7.F9" title="Figure 9 ‣ 7 Appendix ‣ Weakly-supervised segmentation of referring expressions" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a>.
In particular, we compare TSEG trained with weak supervision to the same
model trained with full supervision in Figure <a href="#S7.F8" title="Figure 8 ‣ 7 Appendix ‣ Weakly-supervised segmentation of referring expressions" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>.
TSEG captures cloth related concepts, animals and parts of the bodies
reasonably well, however it can fail at capturing colors, distinguish between
a book and a laptop, or between a blue jean and different type of trousers.
In Figure <a href="#S7.F9" title="Figure 9 ‣ 7 Appendix ‣ Weakly-supervised segmentation of referring expressions" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a>, we observe that TSEG captures a
rich variety of visual concepts, even rarely occurring ones quite accurately.</p>
</div>
<figure id="S7.F8" class="ltx_figure"><img src="/html/2205.04725/assets/x8.png" id="S7.F8.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="830" height="413" alt="">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S7.F8.2.1.1" class="ltx_text" style="font-size:90%;">Figure 8</span>: </span><span id="S7.F8.3.2" class="ltx_text" style="font-size:90%;">Comparison of TSEG to fully-supervised results on PhraseCut
validation set. (a) Both methods perform well. (b) Both
approaches do not distinguish well man and woman. (c-d) TSEG captures
coarse semantic meaning such as legs (c) or surfboards (d) but misses the
difference between a book and a laptop (c) or color attributes (d). (e) TSEG
distinguishes the teddy bear and dog better than the fully-supervised model.</span></figcaption>
</figure>
<figure id="S7.F9" class="ltx_figure"><img src="/html/2205.04725/assets/x9.png" id="S7.F9.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="829" height="276" alt="">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S7.F9.2.1.1" class="ltx_text" style="font-size:90%;">Figure 9</span>: </span><span id="S7.F9.3.2" class="ltx_text" style="font-size:90%;">Additional qualitative results of our approach TSEG. Our approach
captures rarely occurring visual concepts such as a komodo dragon or a
banana-made hat.</span></figcaption>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2205.04723" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="56" alt="ar5iv homepage" class="ar5iv_logo" src="/assets/ar5iv_halloween.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2205.04725" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2205.04725">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2205.04725" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2205.04726" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Sun Jun  5 19:50:51 2022 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/">LaTeXML <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="[LOGO]"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
